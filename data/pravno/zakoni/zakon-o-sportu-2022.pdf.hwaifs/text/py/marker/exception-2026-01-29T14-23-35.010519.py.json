Exception reading tables from PDF document source = ../../../../../../../data/pravno/zakoni/zakon-o-sportu-2022.pdf : index 7252 is out of bounds: 2, range 0 to 1692Traceback (most recent call last):
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/api_text_extraction_marker_PdfConverter.py", line 32, in extract_text_to_file_from_pdf_document
    rendered = converter(source)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/marker/converters/pdf.py", line 195, in __call__
    document = self.build_document(temp_path)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/marker/converters/pdf.py", line 182, in build_document
    document = DocumentBuilder(self.config)(
        provider, layout_builder, line_builder, ocr_builder
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/marker/builders/document.py", line 36, in __call__
    ocr_builder(document, provider)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/marker/builders/ocr.py", line 87, in __call__
    self.ocr_extraction(
    ~~~~~~~~~~~~~~~~~~~^
        document,
        ^^^^^^^^^
    ...<4 lines>...
        block_original_texts,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/marker/builders/ocr.py", line 178, in ocr_extraction
    recognition_results: List[OCRResult] = self.recognition_model(
                                           ~~~~~~~~~~~~~~~~~~~~~~^
        images=images,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        max_tokens=2048
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/recognition/__init__.py", line 431, in __call__
    predicted_tokens, batch_bboxes, scores, _ = self.foundation_predictor.prediction_loop(
                                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        images=flat["slices"],
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<8 lines>...
        tqdm_desc="Recognizing Text"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/foundation/__init__.py", line 780, in prediction_loop
    updated_inputs, outputs, merge_idxs = self.prefill(
                                          ~~~~~~~~~~~~^
        current_inputs, max_lookahead_tokens=0
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/foundation/__init__.py", line 556, in prefill
    image_embeddings = self.model.get_image_embeddings(
        pixel_values=image_tiles,
    ...<3 lines>...
        max_batch_size=self.kv_cache.max_batch_size,
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/__init__.py", line 258, in get_image_embeddings
    chunk_embeddings = self.vision_encoder.embed_images(
        image_batch=chunk_pixels.unsqueeze(0).to(device=self.device),
        grid_thw=chunk_grid_thw.unsqueeze(0).to(device=self.device),
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/encoder/__init__.py", line 798, in embed_images
    return super().forward(
           ~~~~~~~~~~~~~~~^
        hidden_states=image_batch,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
        grid_thw=grid_thw,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/encoder/__init__.py", line 765, in forward
    hidden_states = blk(
        hidden_states,
        cu_seqlens=cu_seqlens,
        position_embeddings=position_embeddings,
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/encoder/__init__.py", line 595, in forward
    hidden_states = hidden_states + self.attn(
                                    ~~~~~~~~~^
        self.norm1(hidden_states),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        position_embeddings=position_embeddings,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/encoder/__init__.py", line 544, in forward
    self.unpack_qkv_with_mask(q, k, v, cu_seqlens)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/pdf/marker/.venv/lib/python3.14/site-packages/surya/common/surya/encoder/__init__.py", line 438, in unpack_qkv_with_mask
    max_seq_len = seq_lengths.max().item()  # Use .max() on tensor
torch.AcceleratorError: index 7252 is out of bounds: 2, range 0 to 1692
