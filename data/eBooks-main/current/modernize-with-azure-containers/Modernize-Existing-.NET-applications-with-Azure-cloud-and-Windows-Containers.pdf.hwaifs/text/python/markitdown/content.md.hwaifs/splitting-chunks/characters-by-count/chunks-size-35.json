"[\"\\n\\n\\fEDITION v7.0\\n\\nRefer changelog for the book updates and community contributions.\\n\\nPUBLISHED BY Mic\", \"rosoft Press and Microsoft DevDiv Divisions of Microsoft Corporation One\\nMicrosoft Way Redmond, Wash\", \"ington 98052-6399\\n\\nCopyright \\u00a9 2023 by Microsoft Corporation\\n\\nAll rights reserved. No part of the co\", \"ntents of this book may be reproduced in any form or by any\\nmeans without the written permission of \", \"the publisher.\\n\\nThis book is available for free in the form of an electronic book (e-book) available\", \" through multiple\\nchannels at Microsoft such as https://dot.net/architecture.\\n\\nIf you have questions\", \" related to this book, email at dotnet-architecture-ebooks-\\nfeedback@service.microsoft.com.\\n\\nThis bo\", \"ok is provided \\u201cas-is\\u201d and expresses the author\\u2019s views and opinions. The views, opinions, and\\ninfor\", \"mation expressed in this book, including URL and other Internet website references, may change\\nwitho\", \"ut notice.\\n\\nSome examples depicted herein are provided for illustration only and are fictitious. No \", \"real association\\nor connection is intended or should be inferred.\\n\\nMicrosoft and the trademarks list\", \"ed at https://www.microsoft.com on the \\u201cTrademarks\\u201d webpage are\\ntrademarks of the Microsoft group of\", \" companies. All other marks are property of their respective\\nowners.\\n\\nAuthor: > Cesar de la Torre, S\", \"r. PM, .NET Product Team, Microsoft Corp.\\n\\nParticipants and reviewers: > Scott Hunter, Partner Direc\", \"tor PM, .NET team, Microsoft > Paul\\nYuknewicz, Principal PM Manager, Visual Studio Tools team, Micro\", \"soft > Lisa Guthrie, Sr. PM, Visual\\nStudio Tools team, Microsoft > Ankit Asthana, Principal PM Manag\", \"er, .NET team, Microsoft > Unai\\nZorrilla, Developer Lead, Plain Concepts > Javier Valero, Chief Oper\", \"ating Officer at Grupo Solutio >\\nSteve Smith, Architect, NimblePros\\n\\nIntroduction\\n\\nWhen you decide t\", \"o modernize your web applications or services and move them to the cloud, you\\ndon\\u2019t necessarily have\", \" to fully rearchitect your apps. Rearchitecting an application by using an\\nadvanced approach like mi\", \"croservices isn\\u2019t always an option because of cost and time restraints.\\nDepending on the type of app\", \"lication, rearchitecting an app also might not be necessary. To optimize\\nthe cost-effectiveness of y\", \"our organization\\u2019s cloud migration strategy, it\\u2019s important to consider the\\nneeds of your business a\", \"nd the requirements of your apps. You\\u2019ll need to determine:\\n\\n\\u2022  Which apps require a transformation \", \"or rearchitecting.\\n\\n\\u2022  Which apps need to be only partially modernized.\\n\\n\\u2022  Which apps you can \\u201clift\", \" and shift\\u201d directly to the cloud.\\n\\n\\fAbout this guide\\n\\nThis guide focuses primarily on the initial m\", \"odernization of existing Microsoft .NET Framework web or\\nservice-oriented applications, meaning the \", \"action of moving a workload to a newer or more modern\\nenvironment without significantly altering the\", \" application\\u2019s code and basic architecture.\\n\\nThis guide also highlights the benefits of moving your \", \"apps to the cloud and partially modernizing\\napps by using a specific set of new technologies and app\", \"roaches, like Windows Containers and\\nrelated compute-platforms in Azure supporting Windows Container\", \"s.\\n\\nPath to the cloud for existing .NET applications\\n\\nOrganizations typically choose to move to the \", \"cloud for the agility and speed they can get for their\\napplications. You can set up thousands of ser\", \"vers (VMs) in the cloud in minutes, compared to the\\nweeks it typically takes to set up on-premises s\", \"ervers.\\n\\nThere isn\\u2019t a single, one-size-fits-all strategy for migrating applications to the cloud. T\", \"he right\\nmigration strategy for you will depend on your organization\\u2019s needs and priorities, and the\", \" kind of\\napplications you are migrating. Not all applications warrant the investment of moving to a \", \"platform as\\na service (PaaS) model or developing a cloud-native application model. In many cases, yo\", \"u can take a\\nphased or incremental approach to invest in moving your assets to the cloud, based on y\", \"our business\\nneeds.\\n\\nFor modern applications with the best long-term agility and value for the organ\", \"ization, you might\\nbenefit from investing in cloud-native application architectures. However, for ap\", \"plications that are\\nexisting or legacy assets, the key is to spend minimal time and money (no rearch\", \"itecting or code\\nchanges) while moving them to the cloud, to realize significant benefits.\\n\\nFigure 1\", \"-1 shows the possible paths you can take when you move existing .NET applications to the\\ncloud in in\", \"cremental phases.\\n\\n\\fFigure 1-1. Modernization paths for existing .NET applications and services\\n\\nEac\", \"h migration approach has different benefits and reasons for using it. You can choose a single\\napproa\", \"ch when you migrate apps to the cloud, or choose certain components from multiple\\napproaches. Indivi\", \"dual applications aren\\u2019t limited to a single approach or maturity state. For instance,\\na common hybr\", \"id approach would have certain on-premises components plus other components in\\nthe cloud.\\n\\nThe defin\", \"ition and short explanation for each application maturity level are the following:\\n\\nLevel 1: Cloud I\", \"nfrastructure-Ready applications: In this migration approach, you just migrate or\\nrehost your curren\", \"t on-premises applications to an infrastructure as a service (IaaS) platform. Your\\napps have almost \", \"the same composition as before, but now you deploy them to VMs in the cloud.\\nThis simple type of mig\", \"ration is typically known in the industry as \\u201cLift & Shift.\\u201d\\n\\nLevel 2: Cloud Optimized applications:\", \" At this level and still without rearchitecting or altering\\nsignificant code, you can gain additiona\", \"l benefits from running your app in the cloud with modern\\ntechnologies like containers and additiona\", \"l cloud-managed services. You improve the agility of your\\napplications to ship faster by refining yo\", \"ur enterprise development operations (DevOps) processes.\\nYou achieve this functionality by using tec\", \"hnologies like Windows Containers, which is based on\\nDocker Engine. Containers remove the friction t\", \"hat\\u2019s caused by application dependencies when you\\ndeploy in multiple stages. In this maturity model,\", \" you can deploy containers on IaaS or PaaS while\\nusing additional cloud-managed services related to \", \"databases, cache as a service, monitoring, and\\ncontinuous integration/continuous deployment (CI/CD) \", \"pipelines.\\n\\nThe third level of maturity is the ultimate goal in the cloud, but it\\u2019s optional for man\", \"y apps and not the\\nmain focus of this guide:\\n\\n\\fLevel 3: Cloud-Native applications: This migration ap\", \"proach typically is driven by business need and\\ntargets modernizing your mission-critical applicatio\", \"ns. At this level, you use PaaS services to move\\nyour apps to PaaS computing platforms. You implemen\", \"t cloud-native applications and microservices\\narchitecture to evolve applications with long-term agi\", \"lity, and to scale to new limits. This type of\\nmodernization usually requires architecting specifica\", \"lly for the cloud. New code often must be written,\\nespecially when you move to cloud-native applicat\", \"ion and microservice-based models. This approach\\ncan help you gain benefits that are difficult to ac\", \"hieve in your monolithic and on-premises application\\nenvironment.\\n\\nTable 1-1 describes the main bene\", \"fits of and reasons for choosing each migration or modernization\\napproach.\\n\\nCloud Infrastructure-Rea\", \"dy\\nLift and shift\\n\\nCloud-Optimized\\nModernize\\n\\nCloud-Native\\nModernize, rearchitect, and\\nrewrite\\n\\nAppl\", \"ication\\u2019s compute target\\n\\nApplications deployed to VMs\\nin Azure\\n\\nData target\\n\\nSQL or any relational \", \"database\\non a VM\\n\\nAdvantages\\n\\nChallenges\\n\\nMonolithic or N-Tier apps\\ndeployed to Azure App Service,\\nA\", \"zure Container Instance (ACI),\\nVMs with containers, or AKS\\n(Azure Kubernetes Service)\\n\\nContainerized\", \" microservices on\\nAzure Kubernetes Service (AKS)\\nand/or serverless microservices\\nbased on Azure Func\", \"tions.\\n\\nAzure SQL Database Managed\\nInstance or another managed\\ndatabase in the cloud.\\n\\nFined-grain d\", \"atabases per\\nmicroservice, based on Azure\\nSQL Database, Azure Cosmos\\nDB, or another managed\\ndatabase\", \" in the cloud\\n\\nTable 1-1. Benefits and challenges of modernization paths for existing .NET applicati\", \"ons and services\\n\\nKey technologies and architectures by maturity level\\n\\n.NET Framework applications \", \"initially started with .NET Framework version 1.0, which was released in\\nlate 2001. Then, companies \", \"moved towards newer versions (such as 2.0, 3.5 and .NET Framework 4.x).\\nMost of those applications r\", \"an on Windows Server and Internet Information Server (IIS), and used a\\nrelational database, like SQL\", \" Server, Oracle, MySQL, or any other RDBMS.\\n\\nMost existing .NET applications might nowadays be based\", \" on .NET Framework 4.x, or even on .NET\\nFramework 3.5, and use web frameworks like ASP.NET MVC, ASP.\", \"NET Web Forms, ASP.NET Web API,\\nWindows Communication Foundation (WCF), ASP.NET SignalR, and ASP.NET\", \" Web Pages. These\\nestablished .NET Framework technologies depend on Windows. That dependency is impo\", \"rtant to\\n\\n\\fconsider if you are simply migrating legacy apps and you want to make minimal changes to \", \"your\\napplication infrastructure.\\n\\nFigure 1-2 shows the primary technologies and architecture styles \", \"used at each of the three cloud\\nmaturity levels:\\n\\nFigure 1-2. Primary technologies for each maturity\", \" level for modernizing existing .NET web applications\\n\\nFigure 1-2 highlights the most common scenari\", \"os, but many hybrid and mixed variations are possible\\nwhen it comes to architecture. For example, th\", \"e maturity models apply not only to monolithic\\narchitectures in existing web apps, but also to servi\", \"ce orientation, N-Tier, and other architecture style\\nvariations. The higher focus or percentage on o\", \"ne or another architecture type and related\\ntechnologies determines the overall maturity level of yo\", \"ur applications.\\n\\nEach maturity level in the modernization process is associated with the following \", \"key technologies and\\napproaches:\\n\\n\\u2022\\n\\nCloud Infrastructure-Ready (rehost or basic lift & shift): As a\", \" first step, many organizations\\nwant only to quickly execute a cloud-migration strategy. In this cas\", \"e, applications are\\nrehosted. Most rehosting can be automated by using Azure Migrate, a service that\", \" provides\\nthe guidance, insights, and mechanisms needed to assist you in migrating to Azure based on\", \"\\ncloud tools like Azure Site Recovery and Azure Database Migration Service. You can also set\\nup reho\", \"sting manually, so that you can learn infrastructure details about your assets when\\nyou move legacy \", \"apps to the cloud. For example, you can move your applications to VMs in\\nAzure with little modificat\", \"ion-probably with only minor configuration changes. The\\nnetworking in this case is similar to an on-\", \"premises environment, especially if you create\\nvirtual networks in Azure.\\n\\n\\u2022\\n\\nCloud-Optimized (Manag\", \"ed Services and Windows Containers): This model is about making\\na few important deployment optimizat\", \"ions to gain some significant benefits from the cloud,\\n\\n\\fwithout changing the core architecture of t\", \"he application. The fundamental step here is to\\nadd Windows Containers support to your existing .NET\", \" Framework applications. This\\nimportant step (containerization) doesn\\u2019t require touching the code, s\", \"o the overall lift and\\nshift effort is light. You can use tools like Image2Docker or Visual Studio, \", \"with its tools for\\nDocker. Visual Studio automatically chooses smart defaults for ASP.NET applicatio\", \"ns and\\nWindows Containers images. These tools offer both a rapid inner loop, and a fast path to get\\n\", \"the containers to Azure. Your agility is improved when you deploy to multiple environments.\\nThen, mo\", \"ving to production, you can deploy your Windows Containers to Azure Web App for\\nContainers, Azure Co\", \"ntainer Instances (ACI), and Azure VMs with Windows Server 2016 and\\ncontainers if you prefer an IaaS\", \" approach. For more complex multi-container applications,\\nconsider using orchestrators like Azure Ku\", \"bernetes Service (AKS/ACS).\\n\\nDuring this initial modernization, you can also add assets from the clo\", \"ud, such as monitoring with\\ntools like Azure Application Insights; CI/CD pipelines for your app life\", \"cycles with Azure DevOps\\nServices; and many more data resource services that are available in Azure.\", \" For instance, you can\\nmodify a monolithic web app that was originally developed by using traditiona\", \"l ASP.NET Web Forms\\nor ASP.NET MVC, but now you deploy it by using Windows Containers. When you use \", \"Windows\\nContainers, you should also migrate your data to a database in Azure SQL Database Managed\\nIn\", \"stance, all without changing the core architecture of your application.\\n\\n\\u2022\\n\\nCloud-Native: As introdu\", \"ced, you should think about architecting cloud-native applications\\nwhen you are targeting large and \", \"complex applications with multiple independent\\ndevelopment teams working on different microservices \", \"that can be developed and deployed\\nautonomously. Also, due to granularized and independent scalabili\", \"ty per microservice. These\\narchitectural approaches face very important challenges and complexities \", \"but can be greatly\\nsimplified by using cloud PaaS and orchestrators like Azure Kubernetes Service (A\", \"KS/ACS)\\n(managed Kubernetes), and Azure Functions for a serverless approach. All these approaches\\n(l\", \"ike microservices and Serverless) typically require you to architect for the cloud and write\\nnew cod\", \"e\\u2014code that is adapted to specific PaaS platforms, or code that aligns with specific\\narchitectures, \", \"like microservices.\\n\\nFigure 1-3 shows the internal technologies that you can use for each maturity l\", \"evel:\\n\\n\\fFigure 1-3. Internal technologies for each modernization maturity level\\n\\nLift and shift scen\", \"ario\\n\\nFor lift and shift migrations, keep in mind that you can use many different variations of lift\", \" and shift in\\nyour application scenarios. If you only rehost your application, you might have a scen\", \"ario like the one\\nshown in Figure 1-4, where you use VMs in the cloud only for your application and \", \"for your database\\nserver.\\n\\n\\fFigure 1-4. Example of a pure IaaS scenario in the cloud\\n\\nModernization \", \"scenarios\\n\\nFor modernization scenarios, you might have a pure Cloud-Optimized application that uses \", \"elements\\nonly from that maturity level. Or, you might have an intermediate-state application with so\", \"me\\nelements from Cloud Infrastructure-Ready and other elements from Cloud-Optimized (a \\u201cpick and\\ncho\", \"ose\\u201d or mixed model), like in Figure 1-5.\\n\\n\\fFigure 1-5. Example \\u201cpick and choose\\u201d scenario, with dat\", \"abase on IaaS, DevOps, and containerization assets\\n\\nNext, as the ideal scenario for many existing .N\", \"ET Framework applications to migrate, you could\\nmigrate to a Cloud-Optimized application, to get sig\", \"nificant benefits from little work. This approach\\nalso sets you up for Cloud-Native as a possible fu\", \"ture evolution. Figure 1-6 shows an example.\\n\\n\\fFigure 1-6. Example Cloud-Optimized apps scenario, wi\", \"th Windows Containers and managed services\\n\\nGoing even further, you could extend your existing Cloud\", \"-Optimized application by adding a few\\nmicroservices for specific scenarios. This approach would mov\", \"e you partially to the level of Cloud-\\nNative model, which is not the main focus of the present guid\", \"ance.\\n\\nWhat this guide does not cover\\n\\nThis guide covers a specific subset of the example scenarios,\", \" as shown in Figure 1-7. This guide\\nfocuses only on the lift and shift scenarios, and ultimately, on\", \" the Cloud-Optimized model. In the\\nCloud-Optimized model, a .NET Framework application is modernized\", \" by using Windows Containers,\\nplus additional components like monitoring and CI/CD pipelines. Each c\", \"omponent is fundamental to\\ndeploying applications to the cloud, faster, and with agility.\\n\\n\\fFigure 1\", \"-7. Cloud-Native is not covered in this guide\\n\\nThe focus of this guide is specific. It shows you the\", \" path you can take to achieve a lift and shift of your\\nexisting .NET applications, without rearchite\", \"cting, and with no code changes. Ultimately, it shows you\\nhow to make your application Cloud-Optimiz\", \"ed.\\n\\nThis guide doesn\\u2019t show you how to create Cloud-Native applications, such as how to evolve to a\", \"\\nmicroservices architecture. To rearchitect your applications or to create brand-new applications th\", \"at\\nare based on microservices, see the e-book .NET Microservices: Architecture for containerized .NE\", \"T\\napplications.\\n\\nAdditional resources\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nContainerized Docker application lifecycle with Micr\", \"osoft platform and tools\\n(downloadable e-book)\\nhttps://aka.ms/dockerlifecycleebook\\n\\n.NET Microservic\", \"es: Architecture for containerized .NET applications (downloadable e-\\nbook)\\nhttps://aka.ms/microserv\", \"icesebook\\n\\nArchitecting modern web applications with ASP.NET Core and Azure (downloadable e-\\nbook)\\nh\", \"ttps://aka.ms/webappebook\\n\\nWho should use this guide\\n\\n\\fThis guide was written for developers and sol\", \"ution architects who want to modernize existing\\nASP.NET web applications or WCF services that are ba\", \"sed on .NET Framework, for improved agility in\\nshipping and releasing applications.\\n\\nYou also might \", \"find this guide useful if you are a technical decision maker, such as an enterprise\\narchitect or a d\", \"evelopment lead/director who just wants an overview of the benefits that you can get\\nby using Window\", \"s Containers, and by deploying to the cloud when using Microsoft Azure.\\n\\nHow to use this guide\\n\\nThis\", \" guide addresses the \\u201cwhy\\u201d-why you might want to modernize your existing applications, and the\\nspeci\", \"fic benefits you get from using Windows Containers when you move your apps to the cloud. The\\ncontent\", \" in the first few chapters of the guide is designed for architects and technical decision makers\\nwho\", \" want an overview, but who don\\u2019t need to focus on implementation and technical, step-by-step\\ndetails\", \".\\n\\nThe last chapter of this guide introduces multiple walkthroughs that focus on specific deployment\", \"\\nscenarios. This guide offers shorter versions of the walkthroughs, to summarize the scenarios and\\nh\", \"ighlight their benefits. The full walkthroughs drill down into setup and implementation details, and\", \"\\nare published as a set of wiki posts in the same public GitHub repo where related sample apps resid\", \"e\\n(discussed in the next section). The last chapter and the step-by-step wiki walkthroughs on GitHub\", \" will\\nbe of more interest to developers and architects who want to focus on implementation details.\\n\", \"\\nSample apps for modernizing legacy apps:\\neShopModernizing\\n\\nThe eShopModernizing repo on GitHub offe\", \"rs two sample applications that simulate legacy\\nmonolithic web applications. One web app is develope\", \"d by using ASP.NET MVC; the second web app\\nis developed by using ASP.NET Web Forms and the third app\", \" is an N-Tier app with a WinForms client\\ndesktop app consuming a WCF service backend. All these apps\", \" are based on the traditional .NET\\nFramework. These sample apps don\\u2019t use .NET Core/.NET 7 or ASP.NE\", \"T Core as they are supposed to\\nbe existing/legacy .NET Framework applications to be modernized.\\n\\nThe\", \"se sample apps have a second version, with modernized code, and which are fairly straightforward.\\nTh\", \"e most important difference between the app versions is that the second versions use Windows\\nContain\", \"ers as the deployment choice. There also are a few additions to the second versions, like Azure\\nStor\", \"age Blobs for managing images, Azure Active Directory for managing security, and Azure\\nApplication I\", \"nsights for monitoring and auditing the applications.\\n\\n\\fContents\\n\\nLift and shift existing .NET apps \", \"to Azure IaaS (Cloud Infrastructure-Ready) ................. 1\\n\\nWhy migrate existing .NET web applic\", \"ations to Azure IaaS ...............................................................................\", \".... 2\\n\\nWhen to migrate to IaaS instead of to PaaS .................................................\", \"................................................................ 2\\n\\nUse Azure Migrate to analyze and\", \" migrate your existing applications to Azure ........................................... 2\\n\\nUse Azur\", \"e Site Recovery to migrate your existing VMs to Azure VMs ..........................................\", \".................... 3\\n\\nAdditional resources .......................................................\", \"................................................................................................... \", \"4\\n\\nMigrate your relational databases to Azure ......................................................\", \"................... 6\\n\\nWhen to migrate to Azure SQL Database Managed Instance ......................\", \"......................................................... 7\\n\\nWhen to migrate to Azure SQL Database .\", \"....................................................................................................\", \"................. 8\\n\\nWhen to move your original RDBMS to a VM (IaaS) ...............................\", \".................................................................. 8\\n\\nWhen to migrate to SQL Server \", \"as a VM (IaaS) .....................................................................................\", \"...................... 9\\n\\nUse Azure Database Migration Service to migrate your relational databases \", \"to Azure ............................. 9\\n\\nAdditional resources .....................................\", \"....................................................................................................\", \"................... 10\\n\\nModernize existing .NET apps to Cloud-Optimized applications ...............\", \"..................... 11\\n\\nReasons to modernize existing .NET apps to Cloud-Optimized applications ..\", \"............................................ 12\\n\\nCloud-Optimized application principles and tenets .\", \"......................................................................................... 12\\n\\nBenefi\", \"ts of a Cloud-Optimized application ................................................................\", \"........................................... 14\\n\\nMicrosoft technologies in cloud-optimized applicatio\", \"ns ..................................................................................... 14\\n\\nMonolit\", \"hic applications can be Cloud-Optimized ............................................................\", \".................................. 15\\n\\nWhat about Cloud-Native applications? .......................\", \".............................................................................................. 16\\n\\nC\", \"loud-native applications details ...................................................................\", \"........................................................... 17\\n\\nWhat about microservices? ..........\", \"....................................................................................................\", \"............................ 18\\n\\nDeploy existing .NET apps as Windows containers ...................\", \".............................................................................. 19\\n\\nWhat are containe\", \"rs? (Linux or Windows)..............................................................................\", \"................................ 19\\n\\nBenefits of containers (Docker Engine on Linux or Windows) ....\", \"................................................................... 19\\n\\nWhat is Docker? ............\", \"....................................................................................................\", \"................................................ 20\\n\\nBenefits of Windows Containers for your existin\", \"g .NET applications ......................................................... 21\\n\\nChoose an OS to ta\", \"rget with .NET-based containers ....................................................................\", \".................... 22\\n\\ni\\n\\nContents\\n\\n\\fWindows container types .....................................\", \"....................................................................................................\", \".... 23\\n\\nThe container ecosystem in Azure ..........................................................\", \".................................................................. 24\\n\\nWhen not to deploy to Windows\", \" Containers ........................................................................................\", \".................... 26\\n\\nWhen to deploy Windows Containers in your on-premises IaaS VM infrastructur\", \"e ................................. 26\\n\\nWhen to deploy Windows Containers to Azure VMs (IaaS cloud) \", \".................................................................... 26\\n\\nWhen to deploy Windows Cont\", \"ainers to Azure Container Instances (ACI) ................................................... 27\\n\\nWh\", \"en to deploy Windows Containers to Azure Kubernetes Service (AKS) ..................................\", \"................. 28\\n\\nChoosing Azure compute platforms for container-based applications ............\", \".............................................. 28\\n\\nBuild resilient services ready for the cloud: Emb\", \"race transient failures in the cloud................................. 29\\n\\nHandling partial failure .\", \"....................................................................................................\", \"............................................. 29\\n\\nModernize your apps with monitoring and telemetry \", \"........................................................................................... 31\\n\\nMoni\", \"tor your application with Application Insights .....................................................\", \"...................................... 31\\n\\nMonitor your Docker infrastructure with Log Analytics and\", \" its Container Monitoring solution...... 32\\n\\nModernize your app\\u2019s lifecycle with CI/CD pipelines and\", \" DevOps tools in the cloud .............................. 34\\n\\nMigrate to hybrid cloud scenarios ....\", \"....................................................................................................\", \"......................... 35\\n\\nAzure Stack ..........................................................\", \"....................................................................................................\", \"........... 35\\n\\nWalkthroughs and technical get started overview ....................................\", \"........................ 38\\n\\nTechnical walkthrough list ............................................\", \"....................................................................................................\", \". 38\\n\\nWalkthrough 1: Tour of eShop legacy apps .....................................................\", \".......................................................... 39\\n\\nTechnical walkthrough availability ..\", \"....................................................................................................\", \"...................... 39\\n\\nOverview ................................................................\", \"....................................................................................................\", \".......... 39\\n\\nGoals ...............................................................................\", \"....................................................................................................\", \"... 39\\n\\nScenario 1: ASP.NET Web apps ...............................................................\", \"................................................................... 39\\n\\nScenario 2: WCF service and \", \"WinForms client app (3-Tier app) ...................................................................\", \". 40\\n\\nBenefits .....................................................................................\", \"............................................................................................ 41\\n\\nNex\", \"t steps ............................................................................................\", \"............................................................................... 41\\n\\nWalkthrough 2: C\", \"ontainerize your existing .NET applications with Windows Containers ....................... 41\\n\\nOver\", \"view ...............................................................................................\", \"............................................................................... 41\\n\\nGoals ..........\", \"....................................................................................................\", \"........................................................................ 41\\n\\nScenario 1: Containeriz\", \"ed ASP.NET web apps ................................................................................\", \"...................... 42\\n\\nScenario 2: Containerized WCF service ...................................\", \"................................................................................ 42\\n\\nBenefits ......\", \"....................................................................................................\", \"....................................................................... 43\\n\\nii\\n\\nContents\\n\\n\\fNext step\", \"s ..................................................................................................\", \"......................................................................... 43\\n\\nWalkthrough 3: Deploy \", \"your Windows Containers-based app to Azure VMs ............................................. 44\\n\\nTec\", \"hnical walkthrough availability ....................................................................\", \"........................................................ 44\\n\\nOverview ..............................\", \"....................................................................................................\", \"............................................ 44\\n\\nGoals .............................................\", \"....................................................................................................\", \"..................................... 44\\n\\nScenarios.................................................\", \"....................................................................................................\", \"......................... 44\\n\\nAzure VMs for Windows Containers .....................................\", \".................................................................................... 46\\n\\nBenefits ..\", \"....................................................................................................\", \"........................................................................... 46\\n\\nNext steps .........\", \"....................................................................................................\", \".............................................................. 46\\n\\nWalkthrough 4: Deploy your Window\", \"s Containers-based apps to Azure Container Instances (ACI) . 47\\n\\nTechnical walkthrough availability \", \"....................................................................................................\", \"........................ 47\\n\\nOverview ..............................................................\", \"....................................................................................................\", \"............ 47\\n\\nGoals .............................................................................\", \"....................................................................................................\", \"..... 47\\n\\nScenarios.................................................................................\", \"............................................................................................. 47\\n\\nBe\", \"nefits .............................................................................................\", \".................................................................................... 47\\n\\nConsiderati\", \"ons.................................................................................................\", \".................................................................. 48\\n\\nNext steps ..................\", \"....................................................................................................\", \"..................................................... 48\\n\\nWalkthrough 5: Deploy your Windows Contain\", \"ers-based apps to Kubernetes in Azure Container\\nService ............................................\", \"....................................................................................................\", \"....................................... 48\\n\\nTechnical walkthrough availability .....................\", \"....................................................................................................\", \"... 48\\n\\nOverview ...................................................................................\", \"........................................................................................... 48\\n\\nGoal\", \"s ..................................................................................................\", \".................................................................................... 49\\n\\nScenarios..\", \"....................................................................................................\", \"........................................................................ 49\\n\\nBenefits ..............\", \"....................................................................................................\", \"............................................................... 50\\n\\nNext steps .....................\", \"....................................................................................................\", \".................................................. 51\\n\\nWalkthrough 6: Deploy your Windows Containers\", \"-based apps to Azure App Service for Containers\\n ...................................................\", \"....................................................................................................\", \"............................................... 51\\n\\nTechnical walkthrough availability .............\", \"....................................................................................................\", \"........... 51\\n\\nOverview ...........................................................................\", \"................................................................................................... \", \"51\\n\\nGoals ..........................................................................................\", \"............................................................................................ 51\\n\\nSce\", \"nario ..............................................................................................\", \"................................................................................. 52\\n\\nBenefits .....\", \"....................................................................................................\", \"........................................................................ 52\\n\\niii\\n\\nContents\\n\\n\\fNext st\", \"eps ................................................................................................\", \"........................................................................... 52\\n\\nConclusions ........\", \"....................................................................................................\", \"................ 53\\n\\niv\\n\\nContents\\n\\n\\fCHAPTER  1\\n\\nLift and shift existing .NET\\napps to Azure IaaS (Clo\", \"ud\\nInfrastructure-Ready)\\n\\nVision: As a first step, to reduce your on-premises investment and total c\", \"ost of hardware and\\nnetworking maintenance, simply rehost your existing applications in the cloud.\\n\\n\", \"Before getting into how to migrate your existing applications to the Azure infrastructure as a servi\", \"ce\\n(IaaS) platform, it\\u2019s important to analyze the reasons why you\\u2019d want to migrate directly to IaaS\", \" in\\nAzure. The scenario at this modernization maturity level essentially is to start using VMs in th\", \"e cloud,\\ninstead of continuing to use your current, on-premises infrastructure.\\n\\nAnother point to an\", \"alyze is why you might want to migrate to pure IaaS cloud instead of just adding\\nmore advanced manag\", \"ed services in Azure. Determine what cases might require IaaS in the first place.\\n\\nFigure 2-1 positi\", \"ons Cloud Infrastructure-Ready applications in the modernization maturity levels:\\n\\nFigure 2-1. Posit\", \"ioning Cloud Infrastructure-Ready applications\\n\\n1\\n\\nCHAPTER 1 | Lift and shift existing .NET apps to \", \"Azure IaaS (Cloud Infrastructure-Ready)\\n\\n\\fWhy migrate existing .NET web applications to\\nAzure IaaS\\n\\n\", \"The main reason to migrate to the cloud, even at an initial IaaS level, is to achieve cost reduction\", \"s. By\\nusing more managed infrastructure services, your organization can lower its investment in hard\", \"ware\\nmaintenance, server or VM provisioning and deployment, and infrastructure management.\\n\\nAfter yo\", \"u make the decision to move your apps to the cloud, the main reason why you might choose\\nIaaS instea\", \"d of more advanced options like PaaS is simply that the IaaS environment will be more\\nfamiliar. Movi\", \"ng to an environment that\\u2019s similar to your current, on-premises environment offers a\\nlower learning\", \" curve, which makes it the quickest path to the cloud.\\n\\nHowever, taking the quickest path to the clo\", \"ud doesn\\u2019t mean that you will gain the most benefit from\\nhaving your applications running in the clo\", \"ud. Any organization will gain the most significant benefits\\nfrom a cloud migration at the already i\", \"ntroduced Cloud-Optimized and Cloud-Native maturity levels.\\n\\nIt also has become evident that applica\", \"tions are easier to modernize and rearchitect in the future\\nwhen they are already running in the clo\", \"ud, even on IaaS. Application data migration has already been\\nachieved. Also, your organization will\", \" have gained the skills required for working in the cloud and\\nmade the shift to operating in a \\u201cclou\", \"d culture.\\u201d\\n\\nWhen to migrate to IaaS instead of to PaaS\\n\\nThe next sections discuss Cloud-Optimized a\", \"pplications that are mostly based on PaaS platforms and\\nservices. These apps give you the most benef\", \"its from migrating to the cloud.\\n\\nIf your goal is simply to move existing applications to the cloud,\", \" first, identify existing applications that\\nwould not require substantial modification to run in Azu\", \"re App Service. These apps should be the first\\ncandidates for Cloud-Optimized.\\n\\nThen, for the apps t\", \"hat still cannot move to Windows Containers and PaaS such as App Service or\\norchestrators like Azure\", \" Kubernetes Service, migrate those apps to simple plain VMs (IaaS).\\n\\nBut, keep in mind that correctl\", \"y configuring, securing, and maintaining VMs requires much more time\\nand IT expertise compared to us\", \"ing PaaS services in Azure. If you are considering Azure Virtual\\nMachines, make sure that you take i\", \"nto account the ongoing maintenance effort required to patch,\\nupdate, and manage your VM environment\", \". Azure Virtual Machines is IaaS.\\n\\nUse Azure Migrate to analyze and migrate your\\nexisting applicatio\", \"ns to Azure\\n\\nMigrating to the cloud doesn\\u2019t have to be difficult. But many organizations struggle to\", \" get started - to\\nget deep visibility into the environment and the tight interdependencies between a\", \"pplications,\\nworkloads, and data. Without that visibility, it can be difficult to plan the path forw\", \"ard. Without\\ndetailed information on what\\u2019s required for a successful migration, you can\\u2019t have the \", \"right\\n\\n2\\n\\nCHAPTER 1 | Lift and shift existing .NET apps to Azure IaaS (Cloud Infrastructure-Ready)\\n\\n\", \"\\fconversations within your organization. You don\\u2019t know enough about the potential cost benefits, or\", \"\\nwhether workloads could just lift-and-shift or would require significant rework to migrate successf\", \"ully.\\nNo wonder many organizations hesitate.\\n\\nAzure Migrate is a new service that provides the guida\", \"nce, insights, and mechanisms needed to assist\\nyou in migrating to Azure. Azure Migrate provides:\\n\\n\\u2022\", \"\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nDiscovery and assessment for on-premises virtual machines\\n\\nInbuilt dependency mapping \", \"for high-confidence discovery of multi-tier applications\\n\\nIntelligent right sizing to Azure virtual \", \"machines\\n\\nCompatibility reporting with guidelines for remediating potential issues\\n\\nIntegration with\", \" Azure Database Management Service for database discovery and migration\\n\\nAzure Migrate gives you con\", \"fidence that your workloads can migrate with minimal impact to the\\nbusiness and run as expected in A\", \"zure. With the right tools and guidance, you can achieve maximum\\nreturn on investment while assuring\", \" that critical performance and reliability needs are met.\\n\\nFigure 2-2 shows you the built-in depende\", \"ncy mapping for all server and application connections\\nperformed by Azure Migrate.\\n\\nFigure 2-2. Posi\", \"tioning Cloud Infrastructure-Ready applications\\n\\nUse Azure Site Recovery to migrate your existing\\nVM\", \"s to Azure VMs\\n\\nAs part of the end-to-end Azure Migrate, Azure Site Recovery is a tool that you can \", \"use to easily\\nmigrate your web apps to VMs in Azure. You can use Site Recovery to replicate on-premi\", \"ses VMs and\\nphysical servers to Azure, or to replicate them to a secondary on-premises location. You\", \" can even\\nreplicate a workload that\\u2019s running on a supported Azure VM, on an on-premises Hyper-V VM,\", \" on a\\nVMware VM, or on a Windows or Linux physical server. Replication to Azure eliminates the cost \", \"and\\ncomplexity of maintaining a secondary datacenter.\\n\\n3\\n\\nCHAPTER 1 | Lift and shift existing .NET a\", \"pps to Azure IaaS (Cloud Infrastructure-Ready)\\n\\n\\fSite Recovery is also made specifically for hybrid \", \"environments that are partly on-premises and partly\\non Azure. Site Recovery helps ensure business co\", \"ntinuity by keeping your apps that are running on\\nVMs and on-premises physical servers available if \", \"a site goes down. It replicates workloads that are\\nrunning on VMs and physical servers so that they \", \"remain available in a secondary location if the\\nprimary site isn\\u2019t available. It recovers workloads \", \"to the primary site when it\\u2019s up and running again.\\n\\nFigure 2-3 shows the execution of multiple VM m\", \"igrations by using Azure Site Recovery.\\n\\nFigure 2-3. Positioning Cloud Infrastructure-Ready applicat\", \"ions\\n\\nAdditional resources\\n\\n\\u2022\\n\\nAzure Migrate Datasheet\\n\\nhttps://aka.ms/azuremigration\\\\_datasheet\\n\\n\\u2022\\n\", \"\\nAzure Migrate\\n\\nhttps://aka.ms/azuremigrate\\n\\n\\u2022\\n\\nAzure migration and modernization center\\n\\nhttps://az\", \"ure.microsoft.com/migration/\\n\\n\\u2022  Migrate to Azure with Site Recovery\\n\\nhttps://learn.microsoft.com/az\", \"ure/site-recovery/site-recovery-migrate-to-azure\\n\\n\\u2022\\n\\nAzure Site Recovery service overview\\n\\n4\\n\\nCHAPTE\", \"R 1 | Lift and shift existing .NET apps to Azure IaaS (Cloud Infrastructure-Ready)\\n\\n\\fhttps://learn.m\", \"icrosoft.com/azure/site-recovery/site-recovery-overview\\n\\n\\u2022  Migrating VMs in AWS to Azure VMs\\n\\nhttps\", \"://learn.microsoft.com/azure/site-recovery/site-recovery-migrate-aws-to-azure\\n\\n5\\n\\nCHAPTER 1 | Lift a\", \"nd shift existing .NET apps to Azure IaaS (Cloud Infrastructure-Ready)\\n\\n\\fCHAPTER  2\\n\\nMigrate your re\", \"lational\\ndatabases to Azure\\n\\nVision: Azure offers the most comprehensive database migration.\\n\\nIn Azu\", \"re, you can migrate your database servers directly to IaaS VMs (pure lift and shift), or you can\\nmig\", \"rate to Azure SQL Database, for additional benefits. Azure SQL Database offers the managed\\ninstance \", \"and full database-as-a-service (DBaaS) options. Figure 3-1 shows the multiple relational\\ndatabase mi\", \"gration paths available in Azure.\\n\\nFigure 3-1. Database migration paths in Azure\\n\\n6\\n\\nCHAPTER 2 | Mig\", \"rate your relational databases to Azure\\n\\n\\fWhen to migrate to Azure SQL Database Managed\\nInstance\\n\\nIn\", \" most cases, Azure SQL Database Managed Instance will be your best option to consider when you\\nmigra\", \"te your data to Azure. If you are migrating SQL Server databases and need nearly 100%\\nassurance that\", \" you won\\u2019t need to rearchitect your application or make changes to your data or data\\naccess code, ch\", \"oose the Managed Instance feature of Azure SQL Database.\\n\\nAzure SQL Database Managed Instance is the\", \" best option if you have additional requirements for SQL\\nServer instance-level functionality, or iso\", \"lation requirements beyond the features provided in a\\nstandard Azure SQL Database (single database m\", \"odel). This last one is the most PaaS-oriented choice,\\nbut it doesn\\u2019t offer the same features as tha\", \"t of a traditional SQL server. Migration might surface\\nfrictions.\\n\\nFor example, an organization that\", \" has made deep investments in instance-level SQL Server capabilities\\nwould benefit from migrating to\", \" SQL Managed Instance. Examples of instance-level SQL Server\\ncapabilities include SQL common languag\", \"e runtime (CLR) integration, SQL Server Agent, and cross-\\ndatabase querying. Support for these featu\", \"res is not available in standard Azure SQL Database (a\\nsingle-database model).\\n\\nAn organization that\", \" operates in a highly regulated industry, and which needs to maintain isolation for\\nsecurity purpose\", \"s, also might benefit from choosing the SQL Managed Instance model.\\n\\nManaged Instance in Azure SQL D\", \"atabase has the following characteristics:\\n\\n\\u2022\\n\\n\\u2022\\n\\nSecurity isolation through Azure Virtual Network\\n\\n\", \"Application surface compatibility, with these features:\\n\\n\\u2013\\n\\n\\u2013\\n\\nSQL Server Agent and SQL Server Profi\", \"ler\\n\\nCross-database references and queries, SQL CLR, replication, change data capture\\n(CDC), and Ser\", \"vice Broker\\n\\n\\u2022\\n\\nDatabase sizes up to 35 TB\\n\\n\\u2022  Minimum-downtime migration, with these features:\\n\\n\\u2013\\n\\n\", \"\\u2013\\n\\nAzure Database Migration Service\\n\\nNative backup and restore, and log shipping\\n\\nWith these capabil\", \"ities, when you migrate existing application databases to Azure SQL Database, the\\nManaged Instance m\", \"odel offers nearly 100% of the benefits of PaaS for SQL Server. Managed Instance\\nis a SQL Server env\", \"ironment where you continue using instance-level capabilities without changing\\nyour application desi\", \"gn.\\n\\nManaged Instance is probably the best fit for enterprises that currently are using SQL Server, \", \"and\\nwhich require flexibility in their network security in the cloud. It\\u2019s like having a private vir\", \"tual network\\nfor your SQL databases.\\n\\n7\\n\\nCHAPTER 2 | Migrate your relational databases to Azure\\n\\n\\fWh\", \"en to migrate to Azure SQL Database\\n\\nAs mentioned, the standard Azure SQL Database is a fully manage\", \"d, relational DBaaS. SQL Database\\ncurrently manages millions of production databases, across 38 data\", \"centers, around the world. It\\nsupports a broad range of applications and workloads, from managing st\", \"raightforward transactional\\ndata, to driving the most data-intensive, mission-critical applications \", \"that require advanced data\\nprocessing at a global scale.\\n\\nBecause of its full PaaS features, better \", \"pricing-and ultimately lower cost-you should move to the\\nstandard Azure SQL Database as your \\u201cby-def\", \"ault choice\\u201d if you have an application that uses basic,\\nstandard SQL databases, and no additional i\", \"nstance features. SQL Server features like SQL CLR\\nintegration, SQL Server Agent, and cross-database\", \" querying are not supported in the standard Azure\\nSQL Database. Those features are available only in\", \" the Azure SQL Database Managed Instance model.\\n\\nAzure SQL Database is the only intelligent cloud da\", \"tabase service that\\u2019s built for app developers. It\\u2019s\\nalso the only cloud database service that scale\", \"s on-the-fly, without downtime, to help you efficiently\\ndeliver multitenant apps. Ultimately, Azure \", \"SQL Database leaves you more time to innovate, and it\\naccelerates your time to market. You can build\", \" secure apps and connect to your SQL database by\\nusing the languages and platforms that you prefer.\\n\", \"\\nAzure SQL Database offers the following benefits:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nBuilt-in intelligence (mach\", \"ine learning) that learns and adapts to your app\\n\\nOn-demand database provisioning\\n\\nA range of offers\", \", for all workloads\\n\\n99.99% availability SLA, zero maintenance\\n\\nGeo-replication and restore services\", \" for data protection\\n\\nAzure SQL Database Point in Time Restore feature\\n\\nCompatibility with SQL Serve\", \"r 2016, including hybrid and migration\\n\\nThe standard Azure SQL Database is closer to PaaS than Azure\", \" SQL Database Managed Instance.\\nPrefer the standard Azure SQL Database because you\\u2019ll get more benef\", \"its from a managed cloud.\\nHowever, Azure SQL Database has some key differences from regular and on-p\", \"remises SQL Server\\ninstances. Depending on your existing application\\u2019s database requirements, and yo\", \"ur enterprise\\nrequirements and policies, it might not be the best choice when you are planning your \", \"migration to\\nthe cloud.\\n\\nWhen to move your original RDBMS to a VM (IaaS)\\n\\nOne of your migration opti\", \"ons is to move your original relational database management system\\n(RDBMS), including Oracle, IBM DB\", \"2, MySQL, PostgreSQL, or SQL Server, to a similar server that\\u2019s\\nrunning on an Azure VM. If you have \", \"existing applications that require the fastest migration to the\\ncloud with minimal changes, or no ch\", \"anges at all, a direct migration to IaaS in the cloud might be a\\n\\n8\\n\\nCHAPTER 2 | Migrate your relati\", \"onal databases to Azure\\n\\n\\ffair option. It might not be the best way to take advantage of all the clo\", \"ud\\u2019s benefits, but it\\u2019s probably\\nthe fastest initial path.\\n\\nCurrently, Microsoft Azure supports up t\", \"o 331 different database servers deployed as IaaS VMs. These\\ninclude popular RDBMS like SQL Server, \", \"Oracle, MySQL, PostgreSQL, and IBM DB2, and many other\\nNoSQL databases like MongoDB, Cassandra, Data\", \"Stax, MariaDB, and Cloudera.\\n\\nNote\\n\\nAlthough moving your RDBMS to an Azure VM might be the fastest w\", \"ay to migrate your data to the\\ncloud (because it is IaaS), this approach requires a significant inve\", \"stment in your IT teams (database\\nadministrators and IT pros). Enterprise teams need to be able to s\", \"et up and manage high availability,\\ndisaster recovery, and patching for SQL Server. This context als\", \"o needs a customized environment,\\nwith full administrative rights.\\n\\nWhen to migrate to SQL Server as\", \" a VM (IaaS)\\n\\nThere might be a few cases where you still need to migrate to SQL Server as a regular \", \"VM. An\\nexample scenario is if you need to use SQL Server Reporting Services. In most cases, though, \", \"Azure\\nSQL Database Managed Instance can provide everything you need to migrate from on-premises SQL\\n\", \"servers, so migration to a SQL Server VM should be your last resort to try.\\n\\nUse Azure Database Migr\", \"ation Service to migrate\\nyour relational databases to Azure\\n\\nYou can use Azure Database Migration Se\", \"rvice to migrate relational databases like SQL Server, and\\nMySQL to Azure, whether your target datab\", \"ase is Azure SQL Database, Azure SQL Database Managed\\nInstance, or SQL Server on an Azure VM.\\n\\nThe a\", \"utomated workflow, with assessment reporting, guides you through the changes you need to\\nmake before\", \" you migrate the database. When you are ready, the service migrates the source database\\nto Azure.\\n\\nW\", \"henever you change an original RDBMS, you might need to retest. You also might need to change\\nthe SQ\", \"L sentences or Object-Relational Mapping (ORM) code in your application, depending on\\ntesting result\", \"s.\\n\\nIf you have any other database (for example, IBM DB2) and you opt for a lift and shift approach,\", \" you\\nmight want to continue using those databases as IaaS VMs in Azure, unless you are willing to pe\", \"rform\\na more complex data migration. A more complex data migration will require additional effort be\", \"cause\\nyou\\u2019d be migrating to a different database type with the new schema and different programming\\n\", \"libraries.\\n\\n9\\n\\nCHAPTER 2 | Migrate your relational databases to Azure\\n\\n\\fAdditional resources\\n\\n\\u2022\\n\\nCho\", \"ose a cloud SQL Server option: Azure SQL Database (PaaS) or SQL Server on Azure\\nVM (IaaS)\\n\\nhttps://l\", \"earn.microsoft.com/azure/sql-database/sql-database-paas-vs-sql-server-iaas\\n\\n\\u2022\\n\\nSQL Server database m\", \"igration to SQL Database in the cloud\\n\\nhttps://learn.microsoft.com/azure/sql-database/sql-database-c\", \"loud-migrate\\n\\n\\u2022\\n\\nAzure SQL Database\\n\\nhttps://azure.microsoft.com/services/sql-database/?v=16.50\\n\\n\\u2022\\n\\n\", \"SQL Server on virtual machines\\n\\nhttps://azure.microsoft.com/services/virtual-machines/sql-server/\\n\\n1\", \"0\\n\\nCHAPTER 2 | Migrate your relational databases to Azure\\n\\n\\fCHAPTER  3\\n\\nModernize existing .NET\\napps\", \" to Cloud-Optimized\\napplications\\n\\nVision: Modernize your existing .NET Framework applications to Clo\", \"ud-Optimized applications to\\ndrastically improve your deployment agility, so you can ship faster and\", \" lower application\\u2019s delivery\\ncosts.\\n\\nTo take advantage of the benefits of the cloud and new technol\", \"ogies like containers, you should at\\nleast partially modernize your existing .NET applications. Ulti\", \"mately, modernizing your enterprise\\napplications will lower your total cost of ownership.\\n\\nPartially\", \" modernizing an app doesn\\u2019t necessarily mean a full migration and rearchitecture. You can\\ninitially \", \"modernize your existing applications with important but easy to do modernization. You can\\nmaintain y\", \"our current code base, written in existing .NET Framework versions, with any Windows and\\nIIS depende\", \"ncies. Figure 4-1 highlights how Cloud-Optimized apps are positioned in Azure\\napplication modernizat\", \"ion maturity models.\\n\\nFigure 4-1. Positioning Cloud-Optimized applications\\n\\n11\\n\\nCHAPTER 3 | Moderniz\", \"e existing .NET apps to Cloud-Optimized applications\\n\\n\\fReasons to modernize existing .NET apps to Cl\", \"oud-\\nOptimized applications\\n\\nWith a Cloud-Optimized application, you can rapidly and repeatedly deli\", \"ver reliable applications to\\nyour customers. You gain essential agility and reliability by deferring\", \" much of the operational\\ncomplexity of your app to the platform.\\n\\nIf you can\\u2019t get your applications\", \" to market quickly, by the time you ship your app, the market you\\nwere targeting will have evolved. \", \"You might be too late, no matter how well the application was\\narchitected or engineered. You might b\", \"e failing or not reaching your full potential because you can\\u2019t\\nsync app delivery with the needs of \", \"the market.\\n\\nThe need for continuous business innovation pushes development and operations teams to \", \"the limit.\\nThe only way to achieve the agility you need in continuous business innovation is by mode\", \"rnizing\\nyour applications with technologies like containers and specific Cloud-Optimized application\", \"\\nprinciples.\\n\\nThe bottom line is that when an organization builds and manages applications that are \", \"Cloud-\\nOptimized, it can put solutions in the hands of customers sooner and bring new ideas to marke\", \"t when\\nthey are relevant.\\n\\nCloud-Optimized application principles and tenets\\n\\nImprovements in the cl\", \"oud are mostly focused on meeting two goals: Reduce costs and improve\\nbusiness growth by improving a\", \"gility. These goals are achieved by simplifying processes and reducing\\nfriction when you release and\", \" ship applications.\\n\\nYour application is Cloud-Optimized if you can-in an agile manner-develop your \", \"app autonomously\\nfrom other on-premises apps, and then release, deploy, autoscale, monitor, and trou\", \"bleshoot your\\napp in the cloud.\\n\\nThe key is agility. You can\\u2019t ship with agility unless you reduce t\", \"o an absolute minimum any\\ndeployment-to-production issues and dev/test environment issues. Container\", \"s (specifically, Docker, as\\na de facto standard) and managed services were designed specifically for\", \" this purpose.\\n\\nTo achieve agility, you also need automated DevOps processes that are based on CI/CD\", \" pipelines that\\nrelease to scalable platforms in the cloud. CI/CD platforms (like Azure DevOps Servi\", \"ces or Jenkins) that\\ndeploy to a scalable and resilient cloud platform (like Azure App Service or Az\", \"ure Kubernetes Service)\\nare key technologies for achieving agility in the cloud.\\n\\nThe following list\", \" describes the main tenets or practices for Cloud-Optimized applications. Note that\\nyou can adopt al\", \"l or only some of these principles, in a progressive or incremental approach:\\n\\n\\u2022\\n\\nContainers. Contai\", \"ners give you the ability to include application dependencies with the\\napplication itself. Container\", \"ization significantly reduces the number of issues you might\\nencounter when you deploy to production\", \" environments or test in staging environments.\\nUltimately, containers improve the agility of applica\", \"tion delivery.\\n\\n12\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\f\\u2022\\n\\nRe\", \"silient and scalable cloud. The cloud provides a platform that is managed, elastic,\\nscalable, and re\", \"silient. These characteristics are fundamental to gain cost improvements and\\nship highly available a\", \"nd reliable applications in a continuous delivery. Managed services like\\nmanaged databases, managed \", \"cache as a service (CaaS), and managed storage are\\nfundamental pieces in alleviating the maintenance\", \" costs of your application.\\n\\n\\u2022  Monitoring. You can\\u2019t have a reliable application without having a g\", \"ood way to detect and\\n\\ndiagnose exceptions and application performance issues. You need to get actio\", \"nable insights\\nthrough application performance management and instant analytics.\\n\\n\\u2022\\n\\nDevOps culture \", \"and continuous delivery. Adopting DevOps practices requires a cultural\\nchange in which teams no long\", \"er work in independent silos. CI/CD pipelines are possible only\\nwhen there is an increased collabora\", \"tion between development and IT operations teams,\\nsupported by containers and CI/CD tools.\\n\\nFigure 4\", \"-2 shows the main optional pillars of a Cloud-Optimized application. The more pillars you\\nimplement,\", \" the readier your application will be to succeed in meeting your customers\\u2019 expectations.\\n\\nFigure 4-\", \"2. Main pillars of a Cloud-Optimized application\\n\\nTo summarize, a Cloud-Optimized application is an \", \"approach to building and managing applications\\nthat takes advantage of the cloud computing model, wh\", \"ile using a combination of containers,\\nmanaged cloud infrastructure, resilient application technique\", \"s, monitoring, continuous delivery, and\\nDevOps, all without the need to rearchitect and recode your \", \"existing applications.\\n\\nYour organization can adopt these technologies and approaches gradually. You\", \" don\\u2019t have to\\nembrace all of them, all at once. You can adopt them incrementally, depending on ente\", \"rprise priorities\\nand user needs.\\n\\n13\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized a\", \"pplications\\n\\n\\fBenefits of a Cloud-Optimized application\\n\\nYou can get the following benefits by conve\", \"rting an existing application to a Cloud-Optimized\\napplication (without rearchitecting or coding):\\n\\n\", \"\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nLower costs, because the managed infrastructure is handled by the cloud provider.\\nCloud-\", \"Optimized applications get the benefits of the cloud by using the cloud\\u2019s out-of-the-\\nbox elasticity\", \", autoscale, and high availability. Benefits are related not only to the compute\\nfeatures (VMs and c\", \"ontainers), but also depend on the resources in the cloud, like DBaaS,\\nCaaS, and any infrastructure \", \"an application might needed.\\n\\nResilient application and infrastructure. When you migrate to the clou\", \"d, you need to\\nembrace transient failures; failures will occur in the cloud. Also, cloud infrastruct\", \"ure and\\nhardware are \\u201creplaceable,\\u201d which increases opportunities for transient downtime. At the\\nsam\", \"e time, inner cloud capabilities and certain application development techniques that\\nimplement resil\", \"iency and automate recovery make it much easier to recover from unexpected\\nfailures in the cloud.\\n\\nD\", \"eeper insights into application performance. Cloud monitoring tools like Azure\\nApplication Insights \", \"provide visualization for health management, logging, and notifications.\\nAudit logs make application\", \"s easy to debug and audit, fundamental for a reliable cloud\\napplication.\\n\\nApplication portability, w\", \"ith agile deployments. Containers (either Linux or Windows\\ncontainers based on Docker Engine) offer \", \"the best solution to avoiding a cloud-locked\\napplication. By using containers, Docker hosts, and mul\", \"ti-cloud orchestrators, you can easily\\nmove from one environment or cloud to another. Containers eli\", \"minate the friction that\\ntypically occurs in deployments to any environment (stage/test/production).\", \"\\n\\nAll of these benefits ultimately provide key cost reductions for your end-to-end application lifec\", \"ycle.\\n\\nIn the following sections, these benefits are explained in more detail, and are linked to spe\", \"cific\\ntechnologies.\\n\\nMicrosoft technologies in cloud-optimized\\napplications\\n\\nThe following list desc\", \"ribes the tools, technologies, and solutions that are recognized as requirements\\nfor Cloud-Optimized\", \" apps. You can adopt Cloud-Optimized elements selectively or gradually,\\ndepending on your priorities\", \".\\n\\n\\u2022\\n\\n\\u2022\\n\\nCloud infrastructure: The infrastructure that provides the compute platform, operating\\nsyst\", \"em, network, and storage. Microsoft Azure is positioned at this level.\\n\\nRuntime: This layer provides\", \" the environment for the application to run. If you are using\\ncontainers, this layer usually is base\", \"d on Docker Engine, running either on Linux hosts or on\\nWindows hosts. (Windows Containers are suppo\", \"rted beginning with Windows Server 2016.\\n\\n14\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Opti\", \"mized applications\\n\\n\\fWindows Containers is the best choice for existing .NET Framework applications \", \"that run on\\nWindows.)\\n\\n\\u2022  Managed cloud: When you choose a managed cloud option, you can avoid the e\", \"xpense and\\ncomplexity of managing and supporting the underlying infrastructure, VMs, OS patches, and\", \"\\nnetworking configuration. If you choose to migrate by using IaaS, you are responsible for all\\nof th\", \"ese tasks, and for associated costs. In a managed cloud option, you manage only the\\napplications and\", \" services that you develop. The cloud service provider typically manages\\neverything else. Examples o\", \"f managed cloud services in Azure include Azure SQL Database,\\nAzure Redis Cache, Azure Cosmos DB, Az\", \"ure Storage, Azure Database for MySQL, Azure\\nDatabase for PostgreSQL, Azure Active Directory, and ma\", \"naged compute services like VM\\nscale sets, Azure App Service, and Azure Kubernetes Service.\\n\\n\\u2022\\n\\nAppl\", \"ication development: You can choose from many languages when you build\\napplications that run in cont\", \"ainers. This guide focuses on .NET, but, you can develop\\ncontainer-based apps by using other languag\", \"es, like Node.js, Python, Spring/Java, or Go.\\n\\n\\u2022  Monitoring, telemetry, logging, and auditing: The \", \"ability to monitor and audit applications\\n\\nand containers that are running in the cloud is critical \", \"for any Cloud-Optimized application.\\nAzure Application Insights and Microsoft Operations Management \", \"Suite are the main\\nMicrosoft tools that provide monitoring and auditing for Cloud-Optimized apps.\\n\\n\\u2022\", \"\\n\\nProvisioning: Automation tools help you provision the infrastructure and deploy an\\napplication to \", \"multiple environments (production, testing, staging). You can use tools like\\nChef and Puppet to mana\", \"ge an application\\u2019s configuration and environment. This layer also\\ncan be implemented by using simpl\", \"er and more direct approaches. For example, you can\\ndeploy directly by using Azure command-line inte\", \"rface (Azure CLI) tooling, and then use the\\ncontinuous deployment and release management pipelines i\", \"n Azure DevOps Services.\\n\\n\\u2022\\n\\nApplication lifecycle: Azure DevOps Services and other tools, like Jenk\", \"ins, are built\\nautomation servers that help you implement CI/CD pipelines, including release managem\", \"ent.\\n\\nThe next sections of this chapter, and the related walkthroughs, focus specifically on details\", \" about the\\nruntime layer (Windows Containers). The guidance describes the ways you can deploy Window\", \"s\\nContainers on Windows Server 2016 (and later versions) VMs and Azure Container Instances. It also\\n\", \"covers more advanced PaaS platforms like Azure App Service and orchestrator like Azure Kubernetes\\nSe\", \"rvice.\\n\\nMonolithic applications can be Cloud-Optimized\\n\\nIt\\u2019s important to highlight that monolithic \", \"applications (applications that are not based on\\nmicroservices) can be Cloud-Optimized applications.\", \" You can build and operate monolithic\\napplications that take advantage of the cloud computing model \", \"by using a combination of containers,\\ncontinuous delivery, and DevOps. If an existing monolithic app\", \"lication is right for your business goals,\\nyou can modernize it and make it Cloud-Optimized.\\n\\nSimila\", \"rly, if monolithic applications can be Cloud-Optimized applications, other, more complex\\narchitectur\", \"es like N-Tier applications can also be modernized as Cloud-Optimized applications.\\n\\n15\\n\\nCHAPTER 3 |\", \" Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fWhat about Cloud-Native applications\", \"?\\n\\nAlthough Cloud-Native applications are not the main focus of this guide, it\\u2019s helpful to have an\\n\", \"understanding of this modernization maturity level, and to distinguish it from Cloud-Optimized\\nappli\", \"cations.\\n\\nFigure 4-3 positions Cloud-Native apps in the application modernization maturity levels:\\n\\n\", \"Figure 4-3. Positioning Cloud-Native applications\\n\\nThe Cloud-Native modernization maturity level usu\", \"ally requires new development investments.\\nMoving to the Cloud-Native level typically is driven by b\", \"usiness need to modernize applications as\\nmuch as possible to drastically improve scale in large app\", \"lications by creating autonomous\\nsubsystems (microservices) that can be deployed and scale independe\", \"ntly from other areas of the\\napplication while lowering costs in the long term and increase evolutio\", \"n agility of those autonomous\\napp\\u2019s parts that provide significant compete advantages.\\n\\nThe main pil\", \"lars of Cloud-Native applications are based on microservices architecture approaches,\\nwhich can evol\", \"ve with agility and scale to limits that would be difficult to achieve in a monolithic\\narchitecture,\", \" deployed to either on-premises or cloud environment.\\n\\nFigure 4-4 shows the main characteristics of \", \"the Cloud-Native model.\\n\\n16\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized application\", \"s\\n\\n\\fFigure 4-4. Cloud-Native characteristics\\n\\nIn addition, you can extend basic modern web apps and \", \"cloud-native apps by adding other services,\\nlike artificial intelligence (AI), machine learning (ML)\", \", and IoT. You might use any of these services to\\nextend any of the possible Cloud-Optimized approac\", \"hes.\\n\\nThe fundamental difference in applications at the Cloud-Native level is in the application arc\", \"hitecture.\\nCloud-native applications are, by definition, apps that are based on microservices. Cloud\", \"-native apps\\nrequire special architectures, technologies, and platforms, compared to a monolithic we\", \"b application\\nor traditional N-Tier application.\\n\\nCloud-native applications details\\n\\nCloud-Native is\", \" a more advanced or mature state for large and mission-critical applications. Cloud-\\nNative applicat\", \"ions usually require architecture and design that are created from scratch instead of by\\nmodernizing\", \" existing applications. The key difference between a Cloud-Native application and a\\nsimpler Cloud-Op\", \"timized web app is the recommendation to use microservices architectures in a\\ncloud-native approach.\", \" Cloud-Optimized apps can also be monolithic web apps or N-Tier apps.\\n\\nThe Twelve-Factor App (a coll\", \"ection of patterns that are closely related to microservices approaches)\\nis also considered a requir\", \"ement for cloud-native application architectures.\\n\\nThe Cloud Native Computing Foundation (CNCF) is a\", \" primary promoter of cloud-native principles.\\nMicrosoft is a member of the CNCF.\\n\\nFor detailed guida\", \"nce on how to design and develop cloud-native applications, read the following\\nfree e-books:\\n\\n17\\n\\nCH\", \"APTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\f\\u2022\\n\\n\\u2022\\n\\nArchitecting Cloud-Na\", \"tive .NET Applications for Azure\\n\\n.NET Microservices: Architecture for containerized .NET applicatio\", \"ns.\\n\\nThe most important factor to consider if you migrate a full application to the cloud-native mod\", \"el is\\nthat you must rearchitect to a microservices-based architecture. This approach clearly require\", \"s a\\nsignificant investment in development because of the large refactoring process involved. This op\", \"tion\\nusually is chosen for mission-critical applications that need new levels of scalability and lon\", \"g-term\\nagility. But, you could start moving toward cloud-native by adding microservices for just a f\", \"ew new\\nscenarios, and eventually refactor the application fully as microservices. This step is an in\", \"cremental\\napproach that is the best option for some scenarios.\\n\\nWhat about microservices?\\n\\nUnderstan\", \"ding microservices and how they work is important when you are considering cloud-native\\napplications\", \" for your organization.\\n\\nThe microservices architecture is an advanced approach that you can use for\", \" applications that are\\ncreated from scratch or when you evolve existing applications toward cloud-na\", \"tive applications. You\\ncan start by adding a few microservices to existing applications to learn abo\", \"ut the new microservices\\nparadigms. But clearly, you need to architect and code, especially for this\", \" type of architectural\\napproach.\\n\\nHowever, microservices are not mandatory for any new or modern app\", \"lication. Microservices are not a\\n\\u201cmagic bullet,\\u201d and they aren\\u2019t the single, best way to create eve\", \"ry application. How and when you use\\nmicroservices depends on the type of application that you need \", \"to build.\\n\\nThe microservices architecture is becoming the preferred approach for distributed and lar\", \"ge or\\ncomplex mission-critical applications that are based on multiple, independent subsystems in th\", \"e form\\nof autonomous services. In a microservices-based architecture, an application is built as a c\", \"ollection of\\nservices that can be independently developed, tested, versioned, deployed, and scaled. \", \"This approach\\ncan include any related, autonomous database per microservice.\\n\\nFor a detailed look at\", \" a microservices architecture that you can implement by using .NET, see the\\ndownloadable PDF e-book \", \".NET microservices: Architecture for containerized .NET applications. The\\nguide also is available on\", \"line.\\n\\nBut even in scenarios in which microservices offer powerful capabilities-independent deployme\", \"nt,\\nstrong subsystem boundaries, and technology diversity-they also raise many new challenges. The\\nc\", \"hallenges are related to distributed application development, such as fragmented and independent\\ndat\", \"a models; achieving resilient communication between microservices; the need for eventual\\nconsistency\", \"; and operational complexity. Microservices introduce a higher level of complexity\\ncompared to tradi\", \"tional monolithic applications.\\n\\nBecause of the complexity of a microservices architecture, only spe\", \"cific scenarios and certain\\napplication types are suitable for microservice-based applications. Thes\", \"e include large and complex\\napplications that have multiple, evolving subsystems. In these cases, it\", \"\\u2019s worth investing in a more\\ncomplex software architecture, for increased long-term agility and more\", \" efficient application\\nmaintenance. But for less complex scenarios, it might be better to continue w\", \"ith a monolithic\\napplication approach or simpler N-Tier approaches.\\n\\n18\\n\\nCHAPTER 3 | Modernize exist\", \"ing .NET apps to Cloud-Optimized applications\\n\\n\\fAs a final note, even at the risk of being repetitiv\", \"e about this concept, you shouldn\\u2019t look at using\\nmicroservices in your applications as \\u201call-in or n\", \"othing at all.\\u201d You can extend and evolve existing\\nmonolithic applications by adding new, small scen\", \"arios based on microservices. You don\\u2019t need to\\nstart from scratch to start working with a microserv\", \"ices architecture approach. In fact, we recommend\\nthat you evolve from using an existing monolithic \", \"or N-Tier application by adding new scenarios.\\nEventually, you can break down the application into a\", \"utonomous components or microservices. You\\ncan start evolving your monolithic applications in a micr\", \"oservices direction, step by step.\\n\\nIn any case, the rest of this present guidance focuses most of a\", \"ll on \\u201cno microservices-based apps\\u201d\\nbecause this guidance is mainly targeting the modernization of e\", \"xisting apps that usually have\\nmonolithic or N-Tier architectures.\\n\\nDeploy existing .NET apps as Win\", \"dows containers\\n\\nDeployments that are based on Windows Containers are applicable to Cloud-Optimized \", \"applications\\nand Cloud-Native applications.\\n\\nHowever, in this guide and especially in the following \", \"sections, it mostly focuses on using Windows\\nContainers for Cloud-Optimized applications where you d\", \"on\\u2019t need to rearchitect your application.\\n\\nWhat are containers? (Linux or Windows)\\n\\nContainers are \", \"a way to wrap up an application into its own isolated package. In its container, the\\napplication is \", \"not affected by applications or processes that exist outside of the container. Everything\\nthe applic\", \"ation depends on to run successfully as a process is inside the container. Wherever the\\ncontainer mi\", \"ght move, the requirements of the application will always be met, in terms of direct\\ndependencies, b\", \"ecause it is bundled with everything that it needs to run (library dependencies,\\nruntimes, and so on\", \").\\n\\nThe main characteristic of a container is that it makes the environment the same across differen\", \"t\\ndeployments because the container itself comes with all the dependencies it needs. You can debug\\nt\", \"he application on your machine, and then deploy it to another machine, with the same environment\\ngua\", \"ranteed.\\n\\nA container is an instance of a container image. A container image is a way to package an \", \"app or\\nservice (like a snapshot), and then deploy it in a reliable and reproducible way. You could s\", \"ay that\\nDocker is not only a technology-it\\u2019s also a philosophy and a process.\\n\\nAs containers daily b\", \"ecome more common, they are becoming an industry-wide \\u201cunit of deployment.\\u201d\\n\\nBenefits of containers \", \"(Docker Engine on Linux or Windows)\\n\\nBuilding applications by using containers-which also might be d\", \"efined as lightweight building blocks-\\noffers a significant increase in agility for building, shippi\", \"ng, and running any application, across any\\ninfrastructure.\\n\\nWith containers, you can take any app f\", \"rom development to production with little or no code change,\\nthanks to Docker integration across Mic\", \"rosoft developer tools, operating systems, and the cloud.\\n\\n19\\n\\nCHAPTER 3 | Modernize existing .NET a\", \"pps to Cloud-Optimized applications\\n\\n\\fWhen you deploy to plain VMs, you probably already have a meth\", \"od in place for deploying ASP.NET\\napps to your VMs. It\\u2019s likely, though, that your method involves m\", \"ultiple manual steps or complex\\nautomated processes by using a deployment tool like Puppet, or a sim\", \"ilar tool. You might need to\\nperform tasks like modifying configuration items, copying application c\", \"ontent between servers, and\\nrunning interactive setup programs based on .msi setups, followed by tes\", \"ting. All those steps in the\\ndeployment add time and risk to deployments. You will get failures when\", \"ever a dependency is not\\npresent in the target environment.\\n\\nIn Windows Containers, the process of p\", \"ackaging applications is fully automated. Windows Containers\\nis based on the Docker platform, which \", \"offers automatic updates and rollbacks for container\\ndeployments. The main improvement you get from \", \"using the Docker engine is that you create images,\\nwhich are like snapshots of your application, wit\", \"h all its dependencies. The images are Docker images\\n(a Windows container image, in this case). The \", \"images run ASP.NET apps in containers, without going\\nback to source code. The container snapshot bec\", \"omes the unit of deployment.\\n\\nMany organizations are containerizing existing monolithic applications\", \" for the following reasons:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nRelease agility through improved deployment. Containers off\", \"er a consistent deployment\\ncontract between development and operations. When you use containers, you\", \" won\\u2019t hear\\ndevelopers say, \\u201cIt works on my machine, why not in production?\\u201d They can say, \\u201cIt runs \", \"as a\\ncontainer, so it will run in production.\\u201d The packaged application, with all its dependencies,\\n\", \"can be executed in any supported container-based environment. It will run the way it was\\nintended to\", \" run in all deployment targets (dev, QA, staging, production). Containers eliminate\\nmost frictions w\", \"hen they move from one stage to the next, which greatly improves\\ndeployment, and you can ship faster\", \".\\n\\nCost reductions. Containers lead to lower costs, either by the consolidation and removal of\\nexist\", \"ing hardware, or from running applications at a higher density per unit of hardware.\\n\\nPortability. C\", \"ontainers are modular and portable. Docker containers are supported on any\\nserver operating system (\", \"Linux and Windows), in any major public cloud (Microsoft Azure,\\nAmazon AWS, Google, IBM), and in on-\", \"premises and private or hybrid cloud environments.\\n\\nControl. Containers offer a flexible and secure \", \"environment that\\u2019s controlled at the container\\nlevel. A container can be secured, isolated, and even\", \" limited by setting execution constraint\\npolicies on the container. As detailed in the section about\", \" Windows Containers, Windows\\nServer 2016 and Hyper-V containers offer additional enterprise support \", \"options.\\n\\nSignificant improvements in agility, portability, and control ultimately lead to significa\", \"nt cost\\nreductions when you use containers to develop and maintain applications.\\n\\nWhat is Docker?\\n\\nD\", \"ocker is an open-source project that automates the deployment of applications as portable, self-\\nsuf\", \"ficient containers that can run in the cloud or on-premises. Docker is also a company that\\npromotes \", \"and evolves this technology. The company works in collaboration with cloud, Linux, and\\nWindows vendo\", \"rs, including Microsoft.\\n\\n20\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applicatio\", \"ns\\n\\n\\fFigure 4-6. Docker deploys containers at all layers of the hybrid cloud\\n\\nTo someone familiar wi\", \"th virtual machines, containers might appear to be remarkably similar. A\\ncontainer runs an operating\", \" system, has a file system, and can be accessed over a network, just like a\\nphysical or virtual comp\", \"uter system. However, the technology and concepts behind containers are\\nvastly different from virtua\", \"l machines. From a developer point of view, a container must be treated\\nmore like a single process. \", \"In fact, a container has a single entry point for one process.\\n\\nDocker containers (for simplicity, c\", \"ontainers) can run natively on Linux and Windows. When running\\nregular containers, Windows container\", \"s can run only on Windows hosts (a host server or a VM), and\\nLinux containers can run only on Linux \", \"hosts. However, in recent versions of Windows Server and\\nHyper-V containers, a Linux container can a\", \"lso run natively on Windows Server by using the Hyper-V\\nisolation technology that currently is avail\", \"able only in Windows Server Containers.\\n\\nIn the near future, mixed environments that have both Linux\", \" and Windows containers will be possible\\nand even common.\\n\\nBenefits of Windows Containers for your e\", \"xisting .NET applications\\n\\nThe benefits of using Windows Containers are fundamentally the same benef\", \"its you get from\\ncontainers in general. Using Windows Containers is about greatly improving agility,\", \" portability, and\\ncontrol.\\n\\nExisting .NET applications refer to those applications that were created\", \" using the .NET Framework. For\\nexample, they might be traditional ASP.NET web applications-they don\\u2019\", \"t use .NET Core or .NET 5+,\\nwhich is newer and runs cross-platform on Linux, Windows, and MacOS.\\n\\nTh\", \"e main dependency in the .NET Framework is Windows. It also has secondary dependencies, like IIS,\\nan\", \"d System.Web in traditional ASP.NET.\\n\\nA .NET Framework application must run on Windows, period. If y\", \"ou want to containerize existing .NET\\nFramework applications and you can\\u2019t or don\\u2019t want to invest i\", \"n a migration to .NET Core or later(\\u201cIf it\\n\\n21\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Op\", \"timized applications\\n\\n\\fworks properly, don\\u2019t migrate it\\u201d), the only choice you have for containers i\", \"s to use Windows\\nContainers.\\n\\nSo, one of the main benefits of Windows Containers is that they offer \", \"you a way to modernize your\\nexisting .NET Framework applications that are running on Windows-through\", \" containerization.\\nUltimately, Windows Containers gets you the benefits that you are looking for by \", \"using containers-\\nagility, portability, and better control.\\n\\nChoose an OS to target with .NET-based \", \"containers\\n\\nGiven the diversity of operating systems that are supported by Docker, as well as the di\", \"fferences\\nbetween .NET Framework and .NET Core, you should target a specific OS and specific version\", \"s based\\non the framework you are using.\\n\\nFor Windows, you can use Windows Server Core or Windows Nan\", \"o Server. These Windows versions\\nprovide different characteristics (like IIS versus a self-hosted we\", \"b server like Kestrel) that might be\\nneeded by .NET Framework or .NET applications.\\n\\nFor Linux, mult\", \"iple distros are available and supported in official .NET Docker images (like Debian).\\n\\nFigure 4-7 s\", \"hows OS versions that you can target, depending on the app\\u2019s version of the .NET\\nFramework.\\n\\nFigure \", \"4-7. Operating systems to target based on .NET Framework version\\n\\nIn migration scenarios for existin\", \"g or legacy applications that are based on .NET Framework\\napplications, the main dependencies are on\", \" Windows and IIS. Your only option is to use Docker\\nimages based on Windows Server Core and the .NET\", \" Framework.\\n\\nWhen you add the image name to your Dockerfile file, you can select the operating syste\", \"m and\\nversion by using a tag, as in the following examples for .NET Framework-based Windows containe\", \"r\\nimages:\\n\\n22\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fTag\\n\\nSyste\", \"m and version\\n\\nmcr.microsoft.com/dotnet/framework/runti\\nme:4.x-windowsservercore-20H2\\n\\n.NET Framewor\", \"k 4.x on Windows Server Core\\n\\nmcr.microsoft.com/dotnet/framework/aspne\\nt:4.x-windowsservercore-20H2\\n\", \"\\n.NET Framework 4.x with additional ASP.NET\\ncustomization, on Windows Server Core\\n\\nFor .NET (cross-p\", \"latform for Linux and Windows), the tags would look like the following:\\n\\nTag\\n\\nSystem and version\\n\\nmc\", \"r.microsoft.com/dotnet/runtime:7.0\\n\\n.NET runtime-only on Linux\\n\\nmcr.microsoft.com/dotnet/runtime:7.0\", \"-\\nnanoserver-ltsc2022\\n\\n.NET runtime-only on Windows Nano Server\\n\\nMulti-arch images\\n\\nSince 2017, Dock\", \"er has had a feature called multi-arch images. .NET Docker images can use multi-arch\\ntags. Your Dock\", \"erfile files no longer need to define the operating system that you are targeting. The\\nmulti-arch fe\", \"ature allows a single tag to be used across multiple machine configurations. For instance,\\nwith mult\", \"i-arch, you can use one common tag: mcr.microsoft.com/dotnet/runtime:7.0. If you pull\\nthat tag from \", \"a Linux container environment, you get the Debian-based image. If you pull that tag\\nfrom a Windows c\", \"ontainer environment, you get the Nano Server-based image.\\n\\nFor .NET Framework images, because the t\", \"raditional .NET Framework supports only Windows, you\\ncannot use the multi-arch feature.\\n\\nWindows con\", \"tainer types\\n\\nLike Linux containers, Windows Server containers are managed by using Docker Engine. U\", \"nlike Linux\\ncontainers, Windows containers include two different container types, or run times-Windo\", \"ws Server\\ncontainers and Hyper-V isolation.\\n\\nWindows Server containers: Provides application isolati\", \"on through process and namespace isolation\\ntechnology. A Windows Server container shares a kernel wi\", \"th the container host and all containers\\nthat are running on the host. These containers do not provi\", \"de a hostile security boundary and should\\nnot be used to isolate untrusted code. Because of the shar\", \"ed kernel space, these containers require\\nthe same kernel version and configuration.\\n\\nHyper-V isolat\", \"ion: Expands on the isolation provided by Windows Server Containers by running each\\ncontainer on a h\", \"ighly optimized VM. In this configuration, the kernel of the container host is not\\nshared with other\", \" containers on the same host. These containers are designed for hostile multitenant\\nhosting, with th\", \"e same security assurances of a VM. Because these containers don\\u2019t share the kernel\\nwith the host or\", \" other containers on the host, they can run kernels with different versions and\\nconfigurations (with\", \" supported versions). For example, all Windows containers on Windows 10 use\\nHyper-V isolation to uti\", \"lize the Windows Server kernel version and configuration.\\n\\n23\\n\\nCHAPTER 3 | Modernize existing .NET a\", \"pps to Cloud-Optimized applications\\n\\n\\fRunning a container on Windows with or without Hyper-V isolati\", \"on is a run-time decision. You might\\nchoose to create the container with Hyper-V isolation initially\", \", and at run time, choose to run it as a\\nWindows Server container instead.\\n\\nAdditional resources\\n\\n\\u2022 \", \" Windows Containers documentation\\n\\nhttps://learn.microsoft.com/virtualization/windowscontainers/\\n\\n\\u2022 \", \" Windows Containers fundamentals\\n\\nhttps://learn.microsoft.com/virtualization/windowscontainers/about\", \"/\\n\\n\\u2022\\n\\nInfographic: Microsoft and containers\\n\\nhttps://info.microsoft.com/rs/157-GQE-382/images/Contai\", \"ner%20infographic%201.4.17.pdf\\n\\nThe container ecosystem in Azure\\n\\nIn previous sections, it\\u2019s been ex\", \"plained what the benefits of Docker containers are as well as details\\non the specific container imag\", \"es for .NET applications. All that generic information is fundamental in\\norder to develop or contain\", \"erize an application. However, when thinking about the production\\ndeployment environment or even QA \", \"and Dev/Test environments, Microsoft Azure provides an open\\nand broad variety of choices, a full con\", \"tainer ecosystem in the cloud (shown in the diagram below).\\nDepending on your specific application\\u2019s\", \" needs, you should choose one or another Azure product.\\n\\n24\\n\\nCHAPTER 3 | Modernize existing .NET app\", \"s to Cloud-Optimized applications\\n\\n\\fFigure 4-7.5. The container ecosystem in Azure\\n\\nFrom the contain\", \"er ecosystem in Azure, the following products supporting containers that are\\nconsidered infrastructu\", \"re:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nAzure Container Instances (ACI)\\n\\nAzure Virtual Machines (With container\\u2019s support)\\n\\nAz\", \"ure Virtual Machine Scale Sets (With container\\u2019s support)\\n\\nFrom those three, ACI provides a great be\", \"nefit, which is the fact that you don\\u2019t need to maintain the\\nunderlying OS, no need for you to upgra\", \"de/patch, etc. but ACI still is positioned in the infrastructure\\nlevel, as better explained in the u\", \"pcoming sections of this book.\\n\\nThe products in Azure supporting containers that are at the same tim\", \"e positioned more in the PaaS\\n(Platform as a Service) level are:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nAzure App Service\\n\\nAzure \", \"Kubernetes Service (AKS and ACS)\\n\\nAzure Batch\\n\\nThen, Azure Container Registry is a high scalable con\", \"tainer registry hosted in Azure that you can use\\nfrom all the previous products when registering and\", \" deploying your custom container images.\\n\\nIn addition, from your containers, you can consume other m\", \"anaged services in Azure like Azure SQL\\nDatabase, Azure Redis cache, Azure Cosmos DB, etc. plus ther\", \"e are third-party solutions/platforms\\n\\n25\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimiz\", \"ed applications\\n\\n\\favailable in Azure Marketplace like Cloud Foundry and OpenShift where you can also\", \" use containers\\nwithin Azure.\\n\\nIn the next sections, you can explore Microsoft\\u2019s recommendations on \", \"when to use each of those\\nAzure products and solutions specifically when targeting Windows Container\", \"s.\\n\\nWhen not to deploy to Windows Containers\\n\\nSome Windows technologies are not supported by Windows\", \" Containers. In those cases, you still need\\nto migrate to the standards VMs, usually with just Windo\", \"ws and IIS.\\n\\nFor more information, see the list of Applications not supported by Windows containers.\", \"\\n\\nAdditional resources\\n\\n\\u2022\\n\\nVirtual machines and containers in Azure\\n\\nhttps://azure.microsoft.com/ove\", \"rview/containers/\\n\\nWhen to deploy Windows Containers in your on-\\npremises IaaS VM infrastructure\\n\\n\\u2022\\n\", \"\\n\\u2022\\n\\n\\u2022\\n\\nYour organization might not be ready to move to the cloud, or it might not be able to move\\nto\", \" the cloud for a business reason. But, you can still get the benefits of using Windows\\nContainers in\", \" your own datacenters.\\n\\nYou might have other artifacts that are being used on-premises, and which mi\", \"ght slow you\\ndown when you try to move to the cloud. For example, security or authentication\\ndepende\", \"ncies with on-premises Windows Server Active Directory, or any other on-premises\\nasset.\\n\\nIf you star\", \"t using Windows Containers today, you can make a phased migration to the cloud\\ntomorrow from a much \", \"better position. Windows Containers is becoming a unit of\\ndeployment for any cloud, with no lock-in.\", \"\\n\\nWhen to deploy Windows Containers to Azure VMs\\n(IaaS cloud)\\n\\nIf your organization is using Azure V\", \"Ms, even if you are also using Windows Containers, you are still\\ndealing with IaaS. That means that \", \"dealing with infrastructure operations, VM OS patches, and\\ninfrastructure complexity for highly scal\", \"able applications when you need to deploy to multiple VMs in\\na load-balanced infrastructure. The mai\", \"n scenarios for using Windows Containers in an Azure VM are:\\n\\n\\u2022\\n\\nDev/test environment: A VM in the c\", \"loud is perfect for development and testing in the\\ncloud. You can rapidly create or stop the environ\", \"ment depending on your needs.\\n\\n26\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized appli\", \"cations\\n\\n\\f\\u2022\\n\\n\\u2022\\n\\nSmall and medium scalability needs: In scenarios where you might need just a couple \", \"of\\nVMs for your production environment, managing a few VMs might be affordable until you\\ncan move to\", \" more advanced PaaS environments, like orchestrators.\\n\\nProduction environment with existing deployme\", \"nt tools: You might be moving from an\\non-premises environment in which you have invested in tools to\", \" make complex deployments\\nto VMs or bare-metal servers (like Puppet or similar tools). To move to th\", \"e cloud with minimal\\nchanges to production environment deployment procedures, you might continue to \", \"use\\nthose tools to deploy to Azure VMs. However, you\\u2019ll want to use Windows Containers as the\\nunit o\", \"f deployment to improve the deployment experience.\\n\\nWhen to deploy Windows Containers to Azure\\nConta\", \"iner Instances (ACI)\\n\\nThe main value proposition of Azure Container Instances is that you can right \", \"away deploy containers\\nto it and you don\\u2019t need to maintain that environment, you don\\u2019t need to upgr\", \"ade/patch the\\nunderlying operating system or VMs, all that is transparent and you just deploy contai\", \"ners into a\\nready-to-use environment.\\n\\nThe reasons and scenarios when you would want to use ACI are \", \"similar to the main scenarios when\\nyou use Azure VMs with containers, so basically, the main scenari\", \"os for using Azure Container\\nInstances are:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nDev/Test scenarios\\n\\nTask automation\\n\\nCI/\", \"CD agents\\n\\nSmall/scale batch processing\\n\\nSimple web apps\\n\\nThe simple web apps scenario is a fair sce\", \"nario for ACI but take into account that since in ACI you can\\nonly have a single container instance \", \"per container image, you won\\u2019t have high availability and only\\nhave limited scalability.\\n\\nHowever, e\", \"ven when ACI is considered infrastructure because it just provides single container\\ninstances, there\", \" is a huge benefit compared to regular Azure VMs with Windows Server. With ACI, you\\njust deploy the \", \"containers into a self-maintained environment and you just pay for those containers.\\nYou don\\u2019t need \", \"to maintain/update/patch VMs, so it is a much better platform for most scenarios\\nwhere you might be \", \"using VMs with containers. Using ACI is straight forward, you just deploy a\\ncontainer, there\\u2019s no ne\", \"ed to create a VM environment you just deploy containers.\\n\\nThe main benefits of Azure Container Inst\", \"ances (ACI) are:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n27\\n\\nRun containers without managing servers\\n\\nIncrease agility with contai\", \"ners on demand\\n\\nDeploy containers to the cloud with unprecedented simplicity and speed\\u2014with a single\", \"\\ncommand.\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\f\\u2022\\n\\nSecure appl\", \"ications with hypervisor isolation\\n\\nIn short, with ACI you can develop apps fast without managing vi\", \"rtual machines or having to learn\\nnew tools. It\\u2019s just your application, in a container, running in \", \"the cloud.\\n\\nWhen to deploy Windows Containers to Azure\\nKubernetes Service (AKS)\\n\\nAzure Kubernetes Se\", \"rvice (AKS) simplifies deploying a managed Kubernetes cluster in Azure by\\noffloading the operational\", \" overhead to Azure. You get an open solution that offers portability both for\\nyour containers and fo\", \"r your application configuration. You select the size, the number of hosts, and\\nthe orchestrator too\", \"ls. Azure Kubernetes Service handles the infrastructure for you. It also supports\\nWindows Server con\", \"tainers alongside Linux containers. For more details on Windows OS support and\\nthe feature differenc\", \"es between Windows and Linux, read the FAQ.\\n\\nThe main benefits of Azure Kubernetes Service (AKS) are\", \":\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nIdentity and security management\\n\\nIntegrated logging and monitoring\\n\\nCluster node \", \"and pod scaling.\\n\\nIngress with HTTP application routing\\n\\nAKS supports the Docker image format. For p\", \"rivate storage of your Docker images, you can\\nintegrate AKS with Azure Container Registry (ACR).\\n\\nIf\", \" you are already working with open-source orchestrators like Kubernetes, Docker Swarm, or DC/OS,\\nyou\", \" don\\u2019t need to change your existing management practices to move container workloads to the\\ncloud. U\", \"se the application management tools that you\\u2019re already familiar with and connect via the\\nstandard A\", \"PI endpoints for the orchestrator of your choice.\\n\\nChoosing Azure compute platforms for container-\\nb\", \"ased applications\\n\\nAs you have noticed after reading the previous sections, Azure is an open cloud t\", \"hat offers multiple\\nchoices. You can use the best fit for your needs, however, it also surfaces ques\", \"tions about what\\nproduct/technology you should use for your containerized applications.\\n\\nAs a by-def\", \"ault recommendation, the following is the main criteria recommended in this guidance:\\n\\n\\u2022\\n\\n\\u2022\\n\\nSingle \", \"monolithic app: Choose Azure App Service\\n\\nN-Tier app: Choose orchestrators such as Azure Kubernetes \", \"Service (AKS) or App Service if\\nyou have a single or a few back-end services\\n\\n\\u2022  Microservices: Choo\", \"se AKS or Azure Web Apps for Containers\\n\\n\\u2022\\n\\n\\u2022\\n\\n28\\n\\nServerless functions & event handlers: Choose Azu\", \"re Functions\\n\\nLarge-scale Batch: Choose Azure Batch\\n\\nCHAPTER 3 | Modernize existing .NET apps to Clo\", \"ud-Optimized applications\\n\\n\\fHowever, this recommendation should be taken with a pinch of salt, as th\", \"e product\\u2019s selection will\\ndepend on your specific application\\u2019s needs and characteristics. Not all \", \"applications are the same even\\nwhen initially they might look similar types.\\n\\nAfter a deeper analysi\", \"s of the application\\u2019s needs, the product selected could be different. But, as a\\nstarting point, it \", \"is good to have initial guidance from where you can start evaluating and testing\\nbased on certain pr\", \"iority.\\n\\nAdditional resources\\n\\n\\u2022\\n\\nChoose an Azure compute service for your application\\n\\nhttps://lear\", \"n.microsoft.com/azure/architecture/guide/technology-choices/compute-decision-\\ntree\\n\\nBuild resilient \", \"services ready for the cloud: Embrace\\ntransient failures in the cloud\\n\\nResiliency is the ability to \", \"recover from failures and continue to function. Resiliency is not about\\navoiding failures, but accep\", \"ting the fact that failures will occur, and then responding to them in a way\\nthat avoids downtime or\", \" data loss. The goal of resiliency is to return the application to a fully\\nfunctioning state after a\", \" failure.\\n\\nYour application is ready for the cloud when, at a minimum, it implements a software-base\", \"d model of\\nresiliency, rather than a hardware-based model. Your cloud application must embrace the p\", \"artial\\nfailures that will certainly occur. Design or partially refactor your application to achieve \", \"resiliency with\\nexpected partial failures. It should be designed to cope with partial failures, like\", \" transient network\\noutages and nodes, or VMs crashing in the cloud. Even containers being moved to a\", \" different node\\nwithin an orchestrator cluster can cause intermittent short failures within the appl\", \"ication.\\n\\nHandling partial failure\\n\\nIn a cloud-based application, there\\u2019s an ever-present risk of pa\", \"rtial failure. For instance, a single\\nwebsite instance or a container might fail, or it might be una\", \"vailable or unresponsive for a short time.\\nOr, a single VM or server might crash.\\n\\nBecause clients a\", \"nd services are separate processes, a service might not be able to respond in a timely\\nmanner to a c\", \"lient\\u2019s request. The service might be overloaded and respond slowly to requests, or it\\nmight not be \", \"accessible for a short time because of network issues.\\n\\nFor example, consider a monolithic .NET appl\", \"ication that accesses a database in Azure SQL Database.\\nIf the Azure SQL database or any other third\", \"-party service is unresponsive for a brief time (an Azure\\nSQL database might be moved to a different\", \" node or server, and be unresponsive for a few seconds),\\nwhen the user tries to do any action, the a\", \"pplication might crash and show an exception at the same\\nmoment.\\n\\n29\\n\\nCHAPTER 3 | Modernize existing\", \" .NET apps to Cloud-Optimized applications\\n\\n\\fA similar scenario might occur in an app that consumes \", \"HTTP services. The network or the service\\nitself might not be available in the cloud during a short,\", \" transient failure.\\n\\nA resilient application like the one shown in Figure 4-9 should implement techn\", \"iques like \\u201cretries with\\nexponential backoff\\u201d to give the application an opportunity to handle trans\", \"ient failures in resources.\\nYou also should use \\u201ccircuit breakers\\u201d in your applications. A circuit b\", \"reaker stops an application from\\ntrying to access a resource when it\\u2019s actually a long-term failure.\", \" By using a circuit breaker, the\\napplication avoids provoking a denial of service to itself.\\n\\nFigure\", \" 4-9. Partial failures handled by retries with exponential backoff\\n\\nYou can use these techniques bot\", \"h in HTTP resources and in database resources. In Figure 4-9, the\\napplication is based on a 3-tier a\", \"rchitecture, so you need these techniques at the services level (HTTP)\\nand at the data tier level (T\", \"CP). In a monolithic application that uses only a single app tier in addition\\nto the database (no ad\", \"ditional services or microservices), handling transient failures at the database\\nconnection level mi\", \"ght be enough. In that scenario, just a particular configuration of the database\\nconnection is requi\", \"red.\\n\\nWhen implementing resilient communications that access the database, depending on the version \", \"of\\n.NET you are using, it can be straightforward (for example, with Entity Framework 6 or later. It\\u2019\", \"s just a\\nmatter of configuring the database connection). Or, you might need to use additional librar\", \"ies like the\\nTransient Fault Handling Application Block (for earlier versions of .NET), or even impl\", \"ement your own\\nlibrary.\\n\\nWhen implementing HTTP retries and circuit breakers, the recommendation for\", \" .NET is to use the\\nPolly library, which targets .NET Standard 1.1 (coverage: .NET Core 1.0, Mono, X\", \"amarin, UWP, WP8.1+)\\nand .NET Standard 2.0+ (coverage: .NET Core 2.0+, .NET Core 3.0 and later, Mono\", \", Xamarin and UWP\\ntargets). The nuget package also includes direct targets for .NET Framework 4.6.1 \", \"and 4.7.2.\\n\\nTo learn how to implement strategies for handling partial failures in the cloud, see the\", \" following\\nreferences.\\n\\nAdditional resources\\n\\n\\u2022\\n\\nImplementing resilient communication to handle part\", \"ial failure\\n\\n30\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fhttps://\", \"learn.microsoft.com/dotnet/architecture/microservices/implement-resilient-\\napplications/partial-fail\", \"ure-strategies\\n\\n\\u2022\\n\\nEntity Framework connection resiliency and retry logic (version 6 and later)\\n\\nhtt\", \"ps://learn.microsoft.com/ef/ef6/fundamentals/connection-resiliency/retry-logic\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nThe Transie\", \"nt Fault Handling Application Block\\n\\nhttps://learn.microsoft.com/previous-versions/msp-n-p/hh680934(\", \"v=pandp.50)\\n\\nPolly library for resilient HTTP communication\\n\\nhttps://github.com/App-vNext/Polly\\n\\nMod\", \"ernize your apps with monitoring and telemetry\\n\\nWhen you run an application in production, it\\u2019s crit\", \"ical that you have insights about how your\\napplication is performing. Is it performing at a high lev\", \"el? Are users getting errors, or is the application\\nstable and reliable? You need rich performance m\", \"onitoring, powerful alerting, and dashboards to help\\nensure that your application is available and p\", \"erforming as expected. You also need to be able to see\\nquickly if there\\u2019s a problem, determine how m\", \"any customers are affected, and perform a root-cause\\nanalysis to find and fix the issue.\\n\\nMonitor yo\", \"ur application with Application Insights\\n\\nApplication Insights is an extensible Application Performa\", \"nce Management (APM) service for web\\ndevelopers who work on multiple platforms. Use it to monitor yo\", \"ur live web application. Application\\nInsights automatically detects performance anomalies. It includ\", \"es powerful analytics tools to help you\\ndiagnose issues, and to help you understand what users actua\", \"lly do with your app. Application\\nInsights is designed to help you continuously improve performance \", \"and usability. It works for apps on\\na wide variety of platforms, including .NET, Node.js, and J2EE, \", \"whether hosted on-premises or in the\\ncloud. Application Insights integrates with your DevOps process\", \"es, and has connection points to\\nvarious development tools.\\n\\nFigure 4-10 shows an example of how App\", \"lication Insights monitors your application and how it\\nsurfaces those insights to a dashboard.\\n\\n31\\n\\n\", \"CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fFigure 4-10. Application \", \"Insights monitoring dashboard\\n\\nMonitor your Docker infrastructure with Log Analytics and its\\nContain\", \"er Monitoring solution\\n\\nAzure Log Analytics is part of the Microsoft Azure overall monitoring soluti\", \"on. It\\u2019s also a service in\\nOperations Management Suite (OMS). Log Analytics monitors cloud and on-pr\", \"emises environments\\n(OMS for on-premises) to help maintain availability and performance. It collects\", \" data generated by\\nresources in your cloud and on-premises environments and from other monitoring to\", \"ols to provide\\nanalysis across multiple sources.\\n\\nIn relation to Azure infrastructure logs, Log Anal\", \"ytics, as an Azure service, ingests log and metric data\\nfrom other Azure services (via Azure Monitor\", \"), Azure VMs, Docker containers, and on-premises or\\nother cloud infrastructures. Log Analytics offer\", \"s flexible log search and out-of-the box analytics on top\\nof this data. It provides rich tools that \", \"you can use to analyze data across sources, it allows complex\\nqueries across all logs, and it can pr\", \"oactively alert based on specified conditions. You can even collect\\ncustom data in the central Log A\", \"nalytics repository, where you can query and visualize it. You can also\\ntake advantage of the Log An\", \"alytics built-in solutions to immediately gain insights into the security\\nand functionality of your \", \"infrastructure.\\n\\nYou can access Log Analytics through the OMS portal or the Azure portal, which run \", \"in any browser,\\nand provide you with access to configuration settings and multiple tools to analyze \", \"and act on\\ncollected data.\\n\\nThe Container Monitoring solution in Log Analytics helps you view and ma\", \"nage your Docker and\\nWindows Container hosts in a single location. The solution shows which containe\", \"rs are running, what\\n\\n32\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\", \"\\fcontainer image they\\u2019re running, and where containers are running. You can view detailed audit\\ninfo\", \"rmation, including commands that are being used with containers. You can also troubleshoot\\ncontainer\", \"s by viewing and searching centralized logs, without needing to remotely view Docker or\\nWindows host\", \"s. You can find containers that might be noisy and consuming excess resources on a\\nhost. Additionall\", \"y, you can view centralized CPU, memory, storage, and network usage, and\\nperformance information, fo\", \"r containers. On computers running Windows, you can centralize and\\ncompare logs from Windows Server,\", \" Hyper-V, and Docker containers. The solution supports the\\nfollowing container orchestrators:\\n\\n\\u2022\\n\\n\\u2022\\n\", \"\\n\\u2022\\n\\n\\u2022\\n\\nDocker Swarm\\n\\nDC/OS\\n\\nKubernetes\\n\\nRed Hat OpenShift\\n\\nFigure 4-11 shows the relationships betwe\", \"en various container hosts and agents and OMS.\\n\\nFigure 4-11. Log Analytics Container Monitoring solu\", \"tion\\n\\nYou can use the Log Analytics Container Monitoring solution to:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nSee informatio\", \"n about all container hosts in a single location.\\n\\nKnow which containers are running, what image the\", \"y\\u2019re running, and where they\\u2019re running.\\n\\nSee an audit trail for actions on containers.\\n\\nTroubleshoo\", \"t by viewing and searching centralized logs without remote login to the Docker\\nhosts.\\n\\nFind containe\", \"rs that might be \\u201cnoisy neighbors,\\u201d and be consuming excess resources on a\\nhost.\\n\\n33\\n\\nCHAPTER 3 | Mo\", \"dernize existing .NET apps to Cloud-Optimized applications\\n\\n\\f\\u2022\\n\\nView centralized CPU, memory, storag\", \"e, and network usage, and performance information, for\\ncontainers.\\n\\nAdditional resources\\n\\n\\u2022\\n\\nOvervie\", \"w of monitoring in Microsoft Azure\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/overview\\n\\n\\u2022  Wha\", \"t is Application Insights?\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/app/app-insights-overvie\", \"w\\n\\n\\u2022  What is Log Analytics?\\n\\nhttps://learn.microsoft.com/azure/log-analytics/log-analytics-overview\", \"\\n\\n\\u2022\\n\\nContainer Monitoring solution in Azure Monitor\\n\\nhttps://learn.microsoft.com/azure/azure-monitor\", \"/insights/containers\\n\\n\\u2022\\n\\nOverview of Azure Monitor\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/\", \"overview\\n\\n\\u2022  What is Operations Management Suite (OMS)?\\n\\nhttps://learn.microsoft.com/azure/operation\", \"s-management-suite/operations-management-suite-\\noverview\\n\\nModernize your app\\u2019s lifecycle with CI/CD \", \"pipelines\\nand DevOps tools in the cloud\\n\\nToday\\u2019s businesses need to innovate at a rapid pace to be c\", \"ompetitive in the marketplace. Delivering\\nhigh-quality, modern applications requires DevOps tools an\", \"d processes that are critical to implement\\nthis constant cycle of innovation. With the right DevOps \", \"tools, developers can streamline continuous\\ndeployment and get innovative applications into the hand\", \"s of users more quickly.\\n\\nAlthough continuous integration and deployment practices are well establis\", \"hed, the introduction of\\ncontainers introduces new considerations, particularly when you are working\", \" with multi-container\\napplications.\\n\\nAzure DevOps Services supports continuous integration and deplo\", \"yment of multi-container\\napplications to various environments through the official Azure DevOps Serv\", \"ices deployment tasks:\\n\\n\\u2022\\n\\n\\u2022\\n\\nDeploy to an Azure Web App for Containers\\n\\nDeploy to Azure Kubernetes \", \"Service\\n\\nBut you can also deploy to Docker Swarm or DC/OS by using Azure DevOps Services script-base\", \"d\\ntasks.\\n\\n34\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fTo continue\", \" facilitating deployment agility, these tools provide excellent dev-to-test-to-production\\ndeployment\", \" experiences for container workloads, with a choice of development and CI/CD solutions.\\n\\nFigure 4-12\", \" shows a continuous deployment pipeline that deploys to a Kubernetes cluster in Azure\\nContainer Serv\", \"ice.\\n\\nFigure 4-12. Azure DevOps Services continuous deployment pipeline, deploying to a Kubernetes c\", \"luster\\n\\nMigrate to hybrid cloud scenarios\\n\\nSome organizations and enterprises can\\u2019t migrate some of \", \"their applications to public clouds like\\nMicrosoft Azure or any other public cloud due to regulation\", \"s or their own policies. However, it\\u2019s likely\\nthat any organization might benefit from having some o\", \"f their applications in the public cloud and\\nother applications on-premises. But a mixed environment\", \" can lead to excessive complexity in\\nenvironments due to different platforms and technologies used i\", \"n public clouds versus on-premises\\nenvironments.\\n\\nMicrosoft provides the best hybrid cloud solution,\", \" one in which you can optimize your existing assets\\non-premises and in the public cloud, while you e\", \"nsure consistency in an Azure hybrid cloud. You can\\nmaximize existing skills, and get a flexible, un\", \"ified approach to building apps that can run in the cloud\\nor on-premises, thanks to Azure Stack (on-\", \"premises) and Azure (public cloud).\\n\\nWhen it comes to security, you can centralize management and se\", \"curity across your hybrid cloud. You\\ncan get control over all assets, from your datacenter to the cl\", \"oud, by providing single sign-on to on-\\npremises and cloud apps. You accomplish this functionality b\", \"y extending Active Directory to a hybrid\\ncloud, and by using identity management.\\n\\nFinally, you can \", \"distribute and analyze data seamlessly, use the same query languages for cloud and\\non-premises asset\", \"s, and apply analytics and deep learning in Azure to enrich your data, regardless of\\nits source.\\n\\nAz\", \"ure Stack\\n\\nAzure Stack is a hybrid cloud platform that lets you deliver Azure services from your org\", \"anization\\u2019s\\ndatacenter. Azure Stack is designed to support new options for your modern applications \", \"in key\\n\\n35\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fscenarios, li\", \"ke edge and unconnected environments, or meeting specific security and compliance\\nrequirements.\\n\\nFig\", \"ure 4-13 shows an overview of the true hybrid cloud platform that Microsoft offers.\\n\\nFigure 4-13. Mi\", \"crosoft hybrid cloud platform with Azure Stack and Azure\\n\\nAzure Stack is offered in two deployment o\", \"ptions, to meet your needs:\\n\\n\\u2022\\n\\n\\u2022\\n\\nAzure Stack integrated systems\\n\\nAzure Stack Development Kit\\n\\nAzur\", \"e Stack integrated systems\\n\\nAzure Stack integrated systems are offered through a partnership of Micr\", \"osoft and hardware partners.\\nThe partnership creates a solution that offers cloud-paced innovation t\", \"hat is balanced with simplicity\\nin management. Because Azure Stack is offered as an integrated syste\", \"m of hardware and software,\\nyou get the right amount of flexibility and control, while still adoptin\", \"g innovation from the cloud.\\nAzure Stack integrated systems range in size from 4 to 12 nodes, and ar\", \"e jointly supported by the\\nhardware partner and Microsoft. Use Azure Stack integrated systems to imp\", \"lement new scenarios for\\nyour production workloads.\\n\\nAzure Stack Development Kit\\n\\nMicrosoft Azure St\", \"ack Development Kit is a single-node deployment of Azure Stack, which you can\\nuse to evaluate and le\", \"arn about Azure Stack. You can also use Azure Stack Development Kit as a\\n\\n36\\n\\nCHAPTER 3 | Modernize \", \"existing .NET apps to Cloud-Optimized applications\\n\\n\\fdeveloper environment, where you can develop us\", \"ing APIs and tooling that are consistent with Azure.\\nAzure Stack Development Kit is not intended to \", \"be used as a production environment.\\n\\nAdditional resources\\n\\n\\u2022\\n\\nAzure hybrid cloud\\n\\nhttps://azure.mic\", \"rosoft.com/overview/hybrid-cloud/\\n\\n\\u2022\\n\\nAzure Stack\\n\\nhttps://azure.microsoft.com/overview/azure-stack/\", \"\\n\\n\\u2022\\n\\nActive Directory Service Accounts for Windows Containers\\n\\nhttps://learn.microsoft.com/virtualiz\", \"ation/windowscontainers/manage-containers/manage-\\nserviceaccounts\\n\\n\\u2022\\n\\nCreate a container with Active\", \" Directory support\\n\\nhttps://learn.microsoft.com/archive/blogs/containerstuff/create-a-container-with\", \"-active-\\ndirectory-support\\n\\n\\u2022\\n\\nAzure Hybrid Benefit licensing\\n\\nhttps://azure.microsoft.com/pricing/h\", \"ybrid-benefit/\\n\\n37\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\n\\fCHAPT\", \"ER  4\\n\\nWalkthroughs and\\ntechnical get started\\noverview\\n\\nTo limit the size of this e-book, additional\", \" technical documentation and the full walkthroughs were\\nmade available in a GitHub repository. The o\", \"nline series of walkthroughs that is described in this\\nchapter covers the step-by-step setup of the \", \"multiple environments that are based on Windows\\nContainers, and deployment to Azure.\\n\\nThe following \", \"sections explain what each walkthrough is about, its objectives and high-level vision,\\nand provides \", \"a diagram of the tasks that are involved. You can get the walkthroughs themselves in the\\neShopModern\", \"izing apps GitHub repo wiki at https://github.com/dotnet-\\narchitecture/eShopModernizing/wiki.\\n\\nTechn\", \"ical walkthrough list\\n\\nThe following get-started walkthroughs provide consistent and comprehensive t\", \"echnical guidance for\\nsample apps that you can lift and shift by using containers, and then move by \", \"using multiple\\ndeployment choices in Azure.\\n\\nEach of the following walkthroughs uses the new sample \", \"eShopLegacy and eShopModernizing apps,\\nwhich are available on GitHub at https://github.com/dotnet-ar\", \"chitecture/eShopModernizing.\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nTour of eShop legacy apps (baseline apps to modernize)\\n\", \"\\nContainerize your existing ASP.NET web apps (WebForms & MVC) with Windows\\nContainers\\n\\nContainerize \", \"your existing WCF services (N-Tier apps) with Windows Containers\\n\\nDeploy your Windows Containers-bas\", \"ed app to Azure VMs\\n\\nDeploy your Windows Containers-based apps to Kubernetes in Azure Container Serv\", \"ice\\n\\n38\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\\n\\n\\fWalkthrough 1: Tour of eShop \", \"legacy apps\\n\\nTechnical walkthrough availability\\n\\nThe full technical walkthrough is available in the \", \"eShopModernizing GitHub repo wiki:\\n\\neShopModernizing wiki walkthroughs\\n\\nOverview\\n\\nIn this walkthroug\", \"h, you can explore the initial implementation of three sample legacy applications.\\nThe first two sam\", \"ple web apps have a monolithic architecture, and were created by using classic\\nASP.NET. One applicat\", \"ion is based on ASP.NET 4.x MVC; the second application is based on ASP.NET\\n4.x Web Forms. The third\", \" app is a 3-Tier app composed by a client WinForms app and a server-side\\nWindows Communication Found\", \"ation (WCF) service.\\n\\nAll these applications are available at the eShopModernizing GitHub repo.\\n\\nGoa\", \"ls\\n\\nThe main goal of this walkthrough is simply to get familiar with these apps, and with their code\", \" and\\nconfiguration. You can configure the apps so that they generate and use mock data, without usin\", \"g the\\nSQL database, for testing purposes. This optional config is based on dependency injection, in \", \"a\\ndecoupled way.\\n\\nScenario 1: ASP.NET Web apps\\n\\nThe figure below shows the simple scenario of the or\", \"iginal legacy ASP.NET web applications.\\n\\n39\\n\\nCHAPTER 4 | Walkthroughs and technical get started over\", \"view\\n\\n\\fFrom a business domain perspective, both apps offer the same catalog management features.\\nMem\", \"bers of the eShop enterprise team would use the app to view and edit the product catalog.\\n\\nThe next \", \"figure shows the initial app screenshots.\\n\\nDependencies in ASP.NET 4.x or earlier versions (either f\", \"or MVC or for Web Forms) means that these\\napplications won\\u2019t run on .NET Core unless the code is ful\", \"ly rewritten by using ASP.NET Core MVC.\\n\\nScenario 2: WCF service and WinForms client app (3-Tier app\", \")\\n\\nThe figure below shows the simple scenario of the original 3-Tier legacy application.\\n\\n40\\n\\nCHAPTE\", \"R 4 | Walkthroughs and technical get started overview\\n\\n\\fBenefits\\n\\nThe benefits of this walkthrough a\", \"re simple: Just get familiar with the code and initial apps.\\n\\nNext steps\\n\\nExplore this content more \", \"in-depth on the GitHub wiki:\\n\\n\\u2022\\n\\n\\u2022\\n\\nTour on the baseline ASP.NET MVC and Web Forms \\u201clegacy\\u201d apps\\n\\nTo\", \"ur on the baseline WCF service and WinForms (3-Tier) \\u201clegacy\\u201d app\\n\\nWalkthrough 2: Containerize your \", \"existing .NET\\napplications with Windows Containers\\n\\nOverview\\n\\nUse Windows Containers to improve depl\", \"oyment of existing .NET applications, like those based on\\nMVC, Web Forms, or WCF, to production, dev\", \"elopment, and test environments.\\n\\nGoals\\n\\nThe goal of this walkthrough is to show you several options\", \" for containerizing an existing .NET\\nFramework application. You can:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n41\\n\\nContainerize your\", \" application by using Visual Studio 2022 Tools for Docker (Visual Studio\\n2017 or later versions).\\n\\nC\", \"ontainerize your application by manually adding a Dockerfile, and then using the Docker CLI.\\n\\nContai\", \"nerize your application by using the Img2Docker tool (an open-source tool from\\nDocker).\\n\\nCHAPTER 4 |\", \" Walkthroughs and technical get started overview\\n\\n\\fThis walkthrough focuses on the Visual Studio 202\", \"2 Tools for Docker approach, but the other two\\napproaches are fairly similar in regard to using Dock\", \"erfiles.\\n\\nScenario 1: Containerized ASP.NET web apps\\n\\nFigure below shows the scenario for containeri\", \"zed eShop legacy web apps applications.\\n\\nScenario 2: Containerized WCF service\\n\\nFigure below shows t\", \"he scenario for a 3-Tier app with a containerized WCF service.\\n\\n42\\n\\nCHAPTER 4 | Walkthroughs and tec\", \"hnical get started overview\\n\\n\\fBenefits\\n\\nThere are advantages to running your monolithic application \", \"in a container. First, you create an image\\nfor the application. From that point on, every deployment\", \" runs in the same environment. Every\\ncontainer uses the same OS version, has the same version of dep\", \"endencies installed, uses the same\\n.NET framework version, and is built by using the same process. B\", \"asically, you control the\\ndependencies of your application by using a Docker image. The dependencies\", \" travel with the\\napplication when you deploy the containers.\\n\\nAn additional benefit is that develope\", \"rs can run the application in the consistent environment that\\u2019s\\nprovided by Windows Containers. Issu\", \"es that appear only with certain versions can be spotted\\nimmediately, instead of surfacing in a stag\", \"ing or production environment. Differences in development\\nenvironments used by members of the develo\", \"pment team matter less when applications run in\\ncontainers.\\n\\nContainerized applications also have a \", \"flatter scale-out curve. Containerized apps enable you to have\\nmore application and service instance\", \"s (based on containers) in a VM or physical machine compared\\nto regular application deployments per \", \"machine. This approach translates to higher density and fewer\\nrequired resources, especially when yo\", \"u use orchestrators like Kubernetes.\\n\\nContainerization, in ideal situations, does not require making\", \" any changes to the application code\\n(C#). In most scenarios, you just need the Docker deployment me\", \"tadata files (Dockerfiles and Docker\\nCompose files).\\n\\nNext steps\\n\\nExplore this content more in-depth\", \" on the GitHub wiki:\\n\\n\\u2022\\n\\n\\u2022\\n\\n43\\n\\nHow to containerize the .NET Framework web apps with Windows Contain\", \"ers and Docker\\n\\nAdding Docker Support to a WCF service\\n\\nCHAPTER 4 | Walkthroughs and technical get s\", \"tarted overview\\n\\n\\fWalkthrough 3: Deploy your Windows Containers-\\nbased app to Azure VMs\\n\\nTechnical w\", \"alkthrough availability\\n\\nThe full technical walkthrough is available in the eShopModernizing GitHub \", \"repo wiki:\\nhttps://github.com/dotnet-architecture/eShopModernizing/wiki/06.-Deploying-your-Windows-\\n\", \"Containers-based-app-into-Azure-VMs-(Including-CI-CD)\\n\\nOverview\\n\\nDeploying to a Docker host on a Win\", \"dows Server 2016 Virtual Machine (VM) in Azure lets you quickly\\nset up development/test/staging envi\", \"ronments. It also gives you a common place for testers or\\nbusiness users to validate the app. VMs al\", \"so can be valid Infrastructure as a Service (IaaS) production\\nenvironments.\\n\\nGoals\\n\\nThe goal of this\", \" walkthrough is to show you the multiple alternatives you have when you deploy\\nWindows Containers to\", \" Azure VMs that are based on Windows Server 2016 or later versions.\\n\\nScenarios\\n\\nSeveral scenarios ar\", \"e covered in this walkthrough.\\n\\n44\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\\n\\n\\fSc\", \"enario A: Deploy to an Azure VM from a dev PC through Docker Engine\\nconnection\\n\\nFigure 5-4. Deploy t\", \"o an Azure VM from a dev PC through a Docker Engine connection\\n\\nScenario B: Deploy to an Azure VM th\", \"rough a Docker Registry\\n\\nFigure 5-5. Deploy to an Azure VM through a Docker Registry\\n\\n45\\n\\nCHAPTER 4 \", \"| Walkthroughs and technical get started overview\\n\\n\\fScenario C: Deploy to an Azure VM from CI/CD pip\", \"elines in Azure DevOps Services\\n\\nFigure 5-6. Deploy to an Azure VM from CI/CD pipelines in Azure Dev\", \"Ops Services\\n\\nAzure VMs for Windows Containers\\n\\nAzure VMs for Windows Containers are VMs based on Wi\", \"ndows Server 2016, Windows 10, or later\\nversions, both with Docker Engine set up. In most cases, Win\", \"dows Server 2016 is used in the Azure\\nVMs.\\n\\nAzure currently provides a VM named Windows Server 2016 \", \"with Containers. You can use this VM\\nto try the new Windows Server Container feature, with either Wi\", \"ndows Server Core or Windows Nano\\nServer. Container OS images are installed, and then the VM is read\", \"y to use with Docker.\\n\\nBenefits\\n\\nAlthough Windows Containers can be deployed to on-premises Windows \", \"Server 2016 VMs, when you\\ndeploy to Azure, you get an easier way to get started, with ready-to-use W\", \"indows Server Container\\nVMs. You also get a common online location that\\u2019s accessible to testers, and\", \" automatic scalability\\nthrough Azure virtual machine scale sets.\\n\\nNext steps\\n\\nExplore this content m\", \"ore in-depth on the GitHub wiki:\\n\\nhttps://github.com/dotnet-architecture/eShopModernizing/wiki/06.-D\", \"eploying-your-Windows-\\nContainers-based-app-into-Azure-VMs-(Including-CI-CD)\\n\\n46\\n\\nCHAPTER 4 | Walkth\", \"roughs and technical get started overview\\n\\n\\fWalkthrough 4: Deploy your Windows Containers-\\nbased app\", \"s to Azure Container Instances (ACI)\\n\\nTechnical walkthrough availability\\n\\nThe full technical walkthr\", \"ough is available in the eShopModernizing GitHub repo wiki:\\n\\nDeploying the Apps to ACI (Azure Contai\", \"ner Instances)\\n\\nOverview\\n\\nAzure Container Instances (ACI) is the quickest way to have a Containers d\", \"ev/test/staging\\nenvironment where you can deploy single instances of containers.\\n\\nGoals\\n\\nThis walkth\", \"rough shows you the main scenarios when deploying Windows Containers to Azure\\nContainer Instances (A\", \"CI) and how you can deploy eShopModernizing Apps into ACI.\\n\\nScenarios\\n\\nThere can be variations about\", \" deploying the eShopModernizing apps into ACI such as deploying just\\none or all of the apps (MVC app\", \", WebForms app or WCF service). In the following scenario shown\\nbelow, you can see the ASP.NET MVC a\", \"pp plus the SQL Server container both of them deployed as\\ncontainers into ACI (Azure Container Insta\", \"nces).\\n\\nBenefits\\n\\nAzure Container Instances makes it easy to create and manage Docker containers in \", \"Azure, without\\nhaving to provision virtual machines or adopt a higher-level service. With ACI, you c\", \"an directly deploy\\na Windows container in Azure and expose it to the internet with a fully qualified\", \" domain name (FQDN)\\n\\n47\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\\n\\n\\fin a matter o\", \"f seconds (Provided that you have the Windows Container image ready in a Docker\\nregistry like Docker\", \" Hub or Azure Container Registry).\\n\\nConsiderations\\n\\nDeploying Windows Containers with either full .N\", \"ET Framework / ASP.NET or SQL Server into Azure\\nContainer Instances (ACI) is not quite as fast as de\", \"ploying to a regular Docker Host (like a Windows\\nServer 2016 with Windows Containers) because the Do\", \"cker image has to be downloaded (pulled from\\nthe Docker registry) every time and the sizes of the SQ\", \"L container image (15.1 GB) and the ASP.NET\\ncontainer image (13.9 GB) are significantly large, howev\", \"er it is much cheaper than maintaining your\\nown docker host (permanently on-line Windows Server 2016\", \" with Windows Containers VM in Azure)\\nnot to mention a whole orchestrator like Kubernetes in Azure (\", \"AKS) which is, on the other hand, a\\ngreat choice for production deployments.\\n\\nAs the main conclusion\", \", using Azure Container Instances is a very compelling option for Dev/Test\\nscenarios and for CI/CD p\", \"ipelines.\\n\\nNext steps\\n\\nExplore this content more in-depth on the GitHub wiki:\\n\\nhttps://github.com/do\", \"tnet-architecture/eShopModernizing/wiki/05.-Deploying-the-Apps-to-ACI-\\n(Azure-Container-Instances)\\n\\n\", \"Walkthrough 5: Deploy your Windows Containers-\\nbased apps to Kubernetes in Azure Container\\nService\\n\\n\", \"Technical walkthrough availability\\n\\nThe full technical walkthrough is available in the eShopModerniz\", \"ing GitHub repo wiki:\\n\\nhttps://github.com/dotnet-architecture/eShopModernizing/wiki/04.-How-to-deplo\", \"y-your-Windows-\\nContainers-based-apps-into-Kubernetes-in-Azure-Container-Service-(Including-CI-CD)\\n\\n\", \"Overview\\n\\nAn application that\\u2019s based on Windows Containers will quickly need to use platforms, movi\", \"ng even\\nfurther away from IaaS VMs. This approach is needed to easily achieve high scalability and b\", \"etter\\nautomated scalability, and for a significant improvement in automated deployments and versioni\", \"ng.\\nYou can achieve these goals by using the orchestrator Kubernetes, available in Azure Container\\nS\", \"ervices.\\n\\n48\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\\n\\n\\fGoals\\n\\nThe goal of this \", \"walkthrough is to learn how to deploy a Windows Container\\u2013based application to\\nKubernetes (also call\", \"ed K8s) in Azure Container Service. Deploying to Kubernetes from scratch is a\\ntwo-step process:\\n\\n1. \", \" Deploy a Kubernetes cluster to Azure Container Service.\\n\\n2.  Deploy the application and related res\", \"ources to the Kubernetes cluster.\\n\\nScenarios\\n\\nScenario A: Deploy directly to a Kubernetes cluster fr\", \"om a dev environment\\n\\nFigure 5-7. Deploy directly to a Kubernetes cluster from a development environ\", \"ment\\n\\n49\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\\n\\n\\fScenario B: Deploy to a Kube\", \"rnetes cluster from CI/CD pipelines in Azure DevOps\\nServices\\n\\nFigure 5-8. Deploy to a Kubernetes clu\", \"ster from CI/CD pipelines in Azure DevOps Services\\n\\nBenefits\\n\\nThere are many benefits to deploying t\", \"o a cluster in Kubernetes. The biggest benefit is that you get a\\nproduction-ready environment in whi\", \"ch you can scale out the application based on the number of\\ncontainer instances you want to use (inn\", \"er-scalability in the existing nodes), and based on the number\\nof nodes or VMs in the cluster (globa\", \"l scalability of the cluster).\\n\\nAzure Container Service optimizes popular open-source tools and tech\", \"nologies specifically for Azure.\\nYou get an open solution that offers portability, both for your con\", \"tainers and for your application\\nconfiguration. You select the size, the number of hosts, and the or\", \"chestrator tools-Container Service\\nhandles everything else.\\n\\nWith Kubernetes, developers can progres\", \"s from thinking about physical and virtual machines, to\\nplanning a container-centric infrastructure \", \"that facilitates the following capabilities, among others:\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n50\\n\\nApplications based on mu\", \"ltiple containers\\n\\nReplicating container instances and horizontal autoscaling\\n\\nNaming and discoverin\", \"g (for example, internal DNS)\\n\\nBalancing loads\\n\\nCHAPTER 4 | Walkthroughs and technical get started o\", \"verview\\n\\n\\f\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nRolling updates\\n\\nDistributing secrets\\n\\nApplication health checks\\n\\nNext steps\\n\\nExp\", \"lore this content more in-depth on the GitHub wiki: https://github.com/dotnet-\\narchitecture/eShopMod\", \"ernizing/wiki/04.-How-to-deploy-your-Windows-Containers-based-apps-into-\\nKubernetes-in-Azure-Contain\", \"er-Service-(Including-CI-CD)\\n\\nWalkthrough 6: Deploy your Windows Containers-\\nbased apps to Azure App\", \" Service for Containers\\n\\nTechnical walkthrough availability\\n\\nThe full technical walkthrough is avail\", \"able in the eShopModernizing GitHub repo wiki:\\n\\nhttps://github.com/dotnet-architecture/eShopModerniz\", \"ing/wiki/Deploy-Windows-Container-to-\\nAzure-App-Service\\n\\nOverview\\n\\nA simple containerized applicatio\", \"n using Windows Containers can easily be deployed to Azure App\\nService for Containers. This approach\", \" is the recommended approach for most Windows Container-\\nbased applications.\\n\\nGoals\\n\\nThe goal of thi\", \"s walkthrough is to learn how to deploy a Windows Container\\u2013based application to\\nAzure App Service f\", \"or Containers from a registry (Docker Hub or Azure Container Registry).\\n\\n51\\n\\nCHAPTER 4 | Walkthrough\", \"s and technical get started overview\\n\\n\\fScenario\\n\\nBenefits\\n\\nDeploying to Azure App Service for Contai\", \"ners offers the benefits of containers paired with the PaaS\\nbenefits of Azure App Service. The app s\", \"ervice can easily be scaled both vertically and horizontally,\\nand can be configured to autoscale to \", \"meet changing demands. Updates can be performed with zero\\ndowntime and the configuration of continuo\", \"us deployment from a registry is easily configured as well.\\n\\nNext steps\\n\\nExplore this content more i\", \"n-depth on the GitHub wiki: https://github.com/dotnet-\\narchitecture/eShopModernizing/wiki/Deploy-Win\", \"dows-Container-to-Azure-App-Service\\n\\n52\\n\\nCHAPTER 4 | Walkthroughs and technical get started overview\", \"\\n\\n\\fCHAPTER  5\\n\\nConclusions\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\n\\u2022\\n\\nContainer-based solutions ultimately provide cost savi\", \"ngs benefits. Containers are a solution\\nto deployment problems because they remove the friction caus\", \"ed by an absence of\\ndependencies in production environments. By removing those issues, it improves D\", \"ev/Test,\\nDevOps, and production operations significantly.\\n\\nA Docker container is becoming the standa\", \"rd unit of deployment for any server-based\\napplication or service.\\n\\nFor production environments, you\", \" should use an orchestrator (like Kubernetes) to host\\nscalable containers\\u2013based applications.\\n\\nAzure\", \" VMs hosting containers are a fast and simple way to create small Dev/Test\\nenvironments in the cloud\", \".\\n\\nAzure SQL Database Managed Instance is recommended by default when migrating your\\nrelational data\", \"bases from existing applications to Azure.\\n\\nVisual Studio 2022 and Image2Docker are basic tools for \", \"you to start modernizing your\\nexisting .NET applications with Windows Containers by accelerating the\", \" getting started\\nlearning curve.\\n\\n\\u2022  When placing containerized applications in production you will \", \"always create or adopt a\\n\\nDevOps culture and DevOps tools for CI/CD pipelines, like Azure DevOps Ser\", \"vices or Jenkins.\\n\\n\\u2022  Microsoft Azure provides the most comprehensive and complete environment to mo\", \"dernize\\n\\nyour existing .NET Framework applications with Windows Containers, cloud infrastructure and\", \"\\nPaaS services.\\n\\n53\\n\\nCHAPTER 5 | Conclusions\\n\\n\"]"