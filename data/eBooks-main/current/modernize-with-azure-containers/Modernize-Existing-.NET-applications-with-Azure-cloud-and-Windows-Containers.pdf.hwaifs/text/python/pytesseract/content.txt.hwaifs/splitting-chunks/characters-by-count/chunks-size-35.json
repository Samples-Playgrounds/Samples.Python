"[\"_& Microsoft\\n\\nModernize existing\\nNET applications with\\nAzure cloud and\\n\\nWindows Containers\\n\\nCesar de\", \" la Torre\\nMicrosoft Corp.\\nmE Microsoft\\n\\nEDITION v7.0\\nRefer changelog for the book updates and commun\", \"ity contributions.\\n\\nPUBLISHED BY Microsoft Press and Microsoft DevDiv Divisions of Microsoft Corpora\", \"tion One\\nMicrosoft Way Redmond, Washington 98052-6399\\n\\nCopyright \\u00a9 2023 by Microsoft Corporation\\n\\nAl\", \"l rights reserved. No part of the contents of this book may be reproduced in any form or by any\\nmean\", \"s without the written permission of the publisher.\\n\\nThis book is available for free in the form of a\", \"n electronic book (e-book) available through multiple\\n\\nchannels at Microsoft such as https://dot.net\", \"/architecture.\\n\\nIf you have questions related to this book, email at dotnet-architecture-ebooks-\\n\\nfe\", \"edback@service.microsoft.com.\\n\\nThis book is provided \\u201cas-is\\u201d and expresses the author's views and op\", \"inions. The views, opinions, and\\ninformation expressed in this book, including URL and other Interne\", \"t website references, may change\\nwithout notice.\\n\\nSome examples depicted herein are provided for ill\", \"ustration only and are fictitious. No real association\\nor connection is intended or should be inferr\", \"ed.\\n\\nMicrosoft and the trademarks listed at https://www.microsoft.com on the \\u201cTrademarks\\u201d webpage ar\", \"e\\ntrademarks of the Microsoft group of companies. All other marks are property of their respective\\no\", \"wners.\\n\\nAuthor: > Cesar de la Torre, Sr. PM, .NET Product Team, Microsoft Corp.\\n\\nParticipants and re\", \"viewers: > Scott Hunter, Partner Director PM, .NET team, Microsoft > Paul\\nYuknewicz, Principal PM Ma\", \"nager, Visual Studio Tools team, Microsoft > Lisa Guthrie, Sr. PM, Visual\\nStudio Tools team, Microso\", \"ft > Ankit Asthana, Principal PM Manager, .NET team, Microsoft > Unai\\nZorrilla, Developer Lead, Plai\", \"n Concepts > Javier Valero, Chief Operating Officer at Grupo Solutio >\\nSteve Smith, Architect, Nimbl\", \"ePros\\n\\nIntroduction\\n\\nWhen you decide to modernize your web applications or services and move them to\", \" the cloud, you\\ndon't necessarily have to fully rearchitect your apps. Rearchitecting an application\", \" by using an\\nadvanced approach like microservices isn\\u2019t always an option because of cost and time re\", \"straints.\\nDepending on the type of application, rearchitecting an app also might not be necessary. T\", \"o optimize\\nthe cost-effectiveness of your organization's cloud migration strategy, it\\u2019s important to\", \" consider the\\nneeds of your business and the requirements of your apps. You'll need to determine:\\n\\n\\u00b0\", \" Which apps require a transformation or rearchitecting.\\n. Which apps need to be only partially moder\", \"nized.\\n\\n. Which apps you can \\u201clift and shift\\u201d directly to the cloud.\\nmE Microsoft\\n\\nAbout this guide\\n\", \"\\nThis guide focuses primarily on the initial modernization of existing Microsoft .NET Framework web \", \"or\\nservice-oriented applications, meaning the action of moving a workload to a newer or more modern\\n\", \"environment without significantly altering the application's code and basic architecture.\\n\\nThis guid\", \"e also highlights the benefits of moving your apps to the cloud and partially modernizing\\napps by us\", \"ing a specific set of new technologies and approaches, like Windows Containers and\\nrelated compute-p\", \"latforms in Azure supporting Windows Containers.\\n\\nPath to the cloud for existing .NET applications\\n\\n\", \"Organizations typically choose to move to the cloud for the agility and speed they can get for their\", \"\\napplications. You can set up thousands of servers (VMs) in the cloud in minutes, compared to the\\nwe\", \"eks it typically takes to set up on-premises servers.\\n\\nThere isn\\u2019t a single, one-size-fits-all strat\", \"egy for migrating applications to the cloud. The right\\nmigration strategy for you will depend on you\", \"r organization's needs and priorities, and the kind of\\napplications you are migrating. Not all appli\", \"cations warrant the investment of moving to a platform as\\na service (PaaS) model or developing a clo\", \"ud-native application model. In many cases, you can take a\\nphased or incremental approach to invest \", \"in moving your assets to the cloud, based on your business\\nneeds.\\n\\nFor modern applications with the \", \"best long-term agility and value for the organization, you might\\nbenefit from investing in cloud-nat\", \"ive application architectures. However, for applications that are\\nexisting or legacy assets, the key\", \" is to spend minimal time and money (no rearchitecting or code\\nchanges) while moving them to the clo\", \"ud, to realize significant benefits.\\n\\nFigure 1-1 shows the possible paths you can take when you move\", \" existing .NET applications to the\\ncloud in incremental phases.\\nmE Microsoft\\n\\nThe Journey to the Clo\", \"ud\\n\\nMigrate Modernize\\nContainerize\\n+ cloud managed services\\n\\nExisting Cloud Cloud\\napps & services Re\", \"host_ Fiiernatedtce Optimized\\nNET Framework Ready apps\\non-premises apps\\n\\nCloud-Native\\napps\\n\\nRearchit\", \"ect/Rebuild\\n\\nCO\\n\\nneal =o a\\nOn-Premises laaS Containers Microservices Architecture\\nInfrastructure Pla\", \"tform \\u201cLift & shift\\\" & PaaS & Serverless\\nNo code changes Minimal code changes Architected for the cl\", \"oud\\n\\nmodernized/rewrite\\n\\nFigure 1-1. Modernization paths for existing .NET applications and services\", \"\\n\\nEach migration approach has different benefits and reasons for using it. You can choose a single\\na\", \"pproach when you migrate apps to the cloud, or choose certain components from multiple\\napproaches. I\", \"ndividual applications aren't limited to a single approach or maturity state. For instance,\\na common\", \" hybrid approach would have certain on-premises components plus other components in\\nthe cloud.\\n\\nThe \", \"definition and short explanation for each application maturity level are the following:\\n\\nLevel 1: Cl\", \"oud Infrastructure-Ready applications: In this migration approach, you just migrate or\\nrehost your c\", \"urrent on-premises applications to an infrastructure as a service (laaS) platform. Your\\napps have al\", \"most the same composition as before, but now you deploy them to VMs in the cloud.\\nThis simple type o\", \"f migration is typically known in the industry as \\u201cLift & Shift.\\u201d\\n\\nLevel 2: Cloud Optimized applicat\", \"ions: At this level and still without rearchitecting or altering\\nsignificant code, you can gain addi\", \"tional benefits from running your app in the cloud with modern\\ntechnologies like containers and addi\", \"tional cloud-managed services. You improve the agility of your\\napplications to ship faster by refini\", \"ng your enterprise development operations (DevOps) processes.\\nYou achieve this functionality by usin\", \"g technologies like Windows Containers, which is based on\\nDocker Engine. Containers remove the frict\", \"ion that\\u2019s caused by application dependencies when you\\ndeploy in multiple stages. In this maturity m\", \"odel, you can deploy containers on laaS or PaaS while\\nusing additional cloud-managed services relate\", \"d to databases, cache as a service, monitoring, and\\ncontinuous integration/continuous deployment (CI\", \"/CD) pipelines.\\n\\nThe third level of maturity is the ultimate goal in the cloud, but it\\u2019s optional fo\", \"r many apps and not the\\nmain focus of this guide:\\nm= Microsoft\\n\\nLevel 3: Cloud-Native applications: \", \"This migration approach typically is driven by business need and\\ntargets modernizing your mission-cr\", \"itical applications. At this level, you use PaaS services to move\\nyour apps to PaaS computing platfo\", \"rms. You implement cloud-native applications and microservices\\narchitecture to evolve applications w\", \"ith long-term agility, and to scale to new limits. This type of\\nmodernization usually requires archi\", \"tecting specifically for the cloud. New code often must be written,\\nespecially when you move to clou\", \"d-native application and microservice-based models. This approach\\ncan help you gain benefits that ar\", \"e difficult to achieve in your monolithic and on-premises application\\nenvironment.\\n\\nTable 1-1 descri\", \"bes the main benefits of and reasons for choosing each migration or modernization\\napproach.\\n\\nCloud-N\", \"ative\\nModernize, rearchitect, and\\nrewrite\\n\\nApplications deployed to VMs__| Monolithic or N-Tier apps\", \" Containerized microservices on\\n\\nin Azure deployed to Azure App Service, | Azure Kubernetes Service \", \"(AKS)\\nAzure Container Instance (ACI), | and/or serverless microservices\\nVMs with containers, or AKS \", \"based on Azure Functions.\\n(Azure Kubernetes Service)\\n\\nSQL or any relational database | Azure SQL Dat\", \"abase Managed _ | Fined-grain databases per\\nonaVM Instance or another managed microservice, based on\", \" Azure\\ndatabase in the cloud. SQL Database, Azure Cosmos\\nDB, or another managed\\ndatabase in the clou\", \"d\\n\\na\\n\\nTable 1-1. Benefits and challenges of modernization paths for existing .NET applications and s\", \"ervices\\n\\nCloud Infrastructure-Ready Cloud-Optimized\\nLift and shift Modernize\\n\\nKey technologies and a\", \"rchitectures by maturity level\\n\\n.NET Framework applications initially started with .NET Framework ve\", \"rsion 1.0, which was released in\\nlate 2001. Then, companies moved towards newer versions (such as 2.\", \"0, 3.5 and .NET Framework 4.x).\\nMost of those applications ran on Windows Server and Internet Inform\", \"ation Server (IIS), and used a\\nrelational database, like SQL Server, Oracle, MySQL, or any other RDB\", \"MS.\\n\\nMost existing .NET applications might nowadays be based on .NET Framework 4.x, or even on .NET\\n\", \"Framework 3.5, and use web frameworks like ASP.NET MVC, ASP.NET Web Forms, ASP.NET Web API,\\nWindows \", \"Communication Foundation (WCF), ASP.NET SignalR, and ASP.NET Web Pages. These\\nestablished .NET Frame\", \"work technologies depend on Windows. That dependency is important to\\nmE Microsoft\\n\\nconsider if you a\", \"re simply migrating legacy apps and you want to make minimal changes to your\\napplication infrastruct\", \"ure.\\n\\nFigure 1-2 shows the primary technologies and architecture styles used at each of the three cl\", \"oud\\nmaturity levels:\\n\\nMaturity model for NET applications modernization Microsoft\\n\\nExisting apps Clo\", \"ud Cloud-Optimized Cloud-Native\\n.NET web apps (on-premises) Infrastructure-Ready PaaS PaaS for micro\", \"services and serverless\\n\\nMicroservices and serverless architectures\\n\\nMonolithic or N-Tier Monolithic\", \" or N-Tier Monolithic or N-Tier\\n\\narchitectures architectures architectures\\n\\nNet Pe NET\\nal al\\nP laaS \", \"M d servi \\u2014\\n\\u201cRelational: (Infrastructure as a Service) oe rT\\nDatabase a\\n\\n\\u00bb EH Rees\\n\\nPaaS for contain\", \"erized microservices\\n\\nx : a\\u201c ee + Serverless computing\\nEp Windows Containers + Managed services\\nOn-p\", \"remises TAN TAN Nw\\nAzure Azure Azure\\n\\nBase Cloud Environment and cross-cutting concerns: Network, Hy\", \"brid-cloud, Identity/Auth, Cost control and Operations model\\n\\nMigrate / Rehost\\n\\nModernize\\n\\nMinimal c\", \"ode changes Architected for the cloud, needs new code\\n\\nFigure 1-2. Primary technologies for each mat\", \"urity level for modernizing existing .NET web applications\\n\\nFigure 1-2 highlights the most common sc\", \"enarios, but many hybrid and mixed variations are possible\\nwhen it comes to architecture. For exampl\", \"e, the maturity models apply not only to monolithic\\narchitectures in existing web apps, but also to \", \"service orientation, N-Tier, and other architecture style\\nvariations. The higher focus or percentage\", \" on one or another architecture type and related\\ntechnologies determines the overall maturity level \", \"of your applications.\\n\\nEach maturity level in the modernization process is associated with the follo\", \"wing key technologies and\\napproaches:\\n\\n. Cloud Infrastructure-Ready (rehost or basic lift & shift): \", \"As a first step, many organizations\\nwant only to quickly execute a cloud-migration strategy. In this\", \" case, applications are\\nrehosted. Most rehosting can be automated by using Azure Migrate, a service \", \"that provides\\nthe guidance, insights, and mechanisms needed to assist you in migrating to Azure base\", \"d on\\ncloud tools like Azure Site Recovery and Azure Database Migration Service. You can also set\\nup \", \"rehosting manually, so that you can learn infrastructure details about your assets when\\nyou move leg\", \"acy apps to the cloud. For example, you can move your applications to VMs in\\nAzure with little modif\", \"ication-probably with only minor configuration changes. The\\nnetworking in this case is similar to an\", \" on-premises environment, especially if you create\\nvirtual networks in Azure.\\n\\n. Cloud-Optimized (Ma\", \"naged Services and Windows Containers): This model is about making\\na few important deployment optimi\", \"zations to gain some significant benefits from the cloud,\\nmE Microsoft\\n\\nwithout changing the core ar\", \"chitecture of the application. The fundamental step here is to\\nadd Windows Containers support to you\", \"r existing .NET Framework applications. This\\nimportant step (containerization) doesn't require touch\", \"ing the code, so the overall lift and\\nshift effort is light. You can use tools like Image2Docker or \", \"Visual Studio, with its tools for\\nDocker. Visual Studio automatically chooses smart defaults for ASP\", \".NET applications and\\nWindows Containers images. These tools offer both a rapid inner loop, and a fa\", \"st path to get\\nthe containers to Azure. Your agility is improved when you deploy to multiple environ\", \"ments.\\nThen, moving to production, you can deploy your Windows Containers to Azure Web App for\\nConta\", \"iners, Azure Container Instances (ACI), and Azure VMs with Windows Server 2016 and\\ncontainers if you\", \" prefer an laaS approach. For more complex multi-container applications,\\n\\nconsider using orchestrato\", \"rs like Azure Kubernetes Service (AKS/ACS).\\n\\nDuring this initial modernization, you can also add ass\", \"ets from the cloud, such as monitoring with\\ntools like Azure Application Insights; CI/CD pipelines f\", \"or your app lifecycles with Azure DevOps\\nServices; and many more data resource services that are ava\", \"ilable in Azure. For instance, you can\\nmodify a monolithic web app that was originally developed by \", \"using traditional ASP.NET Web Forms\\nor ASP.NET MVC, but now you deploy it by using Windows Container\", \"s. When you use Windows\\nContainers, you should also migrate your data to a database in Azure SQL Dat\", \"abase Managed\\nInstance, all without changing the core architecture of your application.\\n\\n\\u00b0 Cloud-Nat\", \"ive: As introduced, you should think about architecting cloud-native applications\\nwhen you are targe\", \"ting large and complex applications with multiple independent\\ndevelopment teams working on different\", \" microservices that can be developed and deployed\\nautonomously. Also, due to granularized and indepe\", \"ndent scalability per microservice. These\\narchitectural approaches face very important challenges an\", \"d complexities but can be greatly\\nsimplified by using cloud PaaS and orchestrators like Azure Kubern\", \"etes Service (AKS/ACS)\\n(managed Kubernetes), and Azure Functions for a serverless approach. All thes\", \"e approaches\\n(like microservices and Serverless) typically require you to architect for the cloud an\", \"d write\\nnew code\\u2014code that is adapted to specific PaaS platforms, or code that aligns with specific\\n\", \"architectures, like microservices.\\n\\nFigure 1-3 shows the internal technologies that you can use for \", \"each maturity level:\\nm= Microsoft\\n\\neL Existing TAN Cloud w Cloud-Optimized w Cloud-Native\\n\\n.NET appl\", \"ications (on-prem.) Infrastructure-Ready Existing .NET apps Re-architect / new code\\n\\nMonolithic or N\", \"-Tier Monolithic or N-Tier Monolithic or N-Tier\\n\\nASP.NET VMs (laaS Azure)\\n\\nMicroservices Architectur\", \"e\\n\\nLinux Containers\\non AKS (Managed Kubernetes)\\n\\nAzure App Service\\n\\nMVC\\n\\nSQL Server VM Azure Contain\", \"er Instance\\n\\nWeb API\\n\\nAzure Web App for\\nContainers\\n\\nAzure Web App for\\nContainers\\n\\nServerless service\", \"s\\n(Azure Functions\\n\\nOther RDBMS VMs\\n\\nSignalR\\nYour current laaS Windows Containers\\n\\nWeb Pages Monitor\", \"ing Tools On VMs\\n\\nYour current Deployment Azure SQL DB\\n\\nTools (Puppet, Chef, etc.)\\n\\nAzure middleware\", \",\\nmessaging, events\\n\\nSQL-DB / No-SQL / Big Data\\n\\nMonitoring (App Insights) Monitoring (App Insights)\", \"\\n\\nCI/CD (Azure DevOps)\\n\\non 4\\n\\nRelational Database\\n\\n(SQL, Oracle, MySQL, etc.)\\na\\u201d a\\u201d\\nal el\\n\\nFigure 1-\", \"3. Internal technologies for each modernization maturity level\\n\\nLift and shift scenario\\n\\nFor lift an\", \"d shift migrations, keep in mind that you can use many different variations of lift and shift in\\nyou\", \"r application scenarios. If you only rehost your application, you might have a scenario like the one\", \"\\n\\nshown in Figure 1-4, where you use VMs in the cloud only for your application and for your databas\", \"e\\nserver.\\nmE Microsoft\\n\\naD Existing TAN Cloud\\n\\n.NET applications (on-prem.) Infrastructure-Ready\\n\\nMo\", \"nolithic Architecture Monolithic Architecture\\n\\nASP.NET VMs (laaS Azure)\\n\\nSQL Server VM\\n\\nWebForms\\n\\nWe\", \"b API Other RDBMS VMs\\n\\nSignalR\\nYour current laaS\\nWeb Pages Monitoring Tools\\n\\nYour current Deployment\", \"\\nTools (Puppet, Chef, etc.)\\n\\nRelational Database\\n(SQL, Oracle, MySQL, etc.)\\n\\nFigure 1-4. Example of \", \"a pure laaS scenario in the cloud\\n\\nModernization scenarios\\n\\nFor modernization scenarios, you might h\", \"ave a pure Cloud-Optimized application that uses elements\\nonly from that maturity level. Or, you mig\", \"ht have an intermediate-state application with some\\nelements from Cloud Infrastructure-Ready and oth\", \"er elements from Cloud-Optimized (a \\u201cpick and\\nchoose\\u201d or mixed model), like in Figure 1-5.\\nMicrosoft\", \"\\n\\na Existing rh Cloud hN Cloud-Optimized\\n\\n.NET applications (on-prem.) Infrastructure-Ready Existing\", \" .NET apps\\n\\nMonolithic or N-Tier Monolithic or N-Tier Monolithic or N-Tier\\nASP.NET VMs (laaS Azure) \", \"Azure App Service\\nMVC nen\\n\\nWebFoas 2 SQL Server VM Azure Container Instance\\nWeb API Othe RESMS_VMs A\", \"zure Web App for\\nContainers\\n\\nSignalR\\nYour current laaS Windows Containers\\nWeb Pages Monitoring Tools\", \" On VMs\\nYour current Deployment Azure SQL DB\\n\\nMonitoring (App Insights)\\n\\nRelational Database\\n(SQL, O\", \"racle, MySQL, etc.) CI/CD (Azure DevOps)\\n\\nom\\n\\ngy + =\\n\\nFigure 1-5. Example \\u201cpick and choose\\u201d scenario\", \", with database on laaS, DevOps, and containerization assets\\n\\nNext, as the ideal scenario for many e\", \"xisting .NET Framework applications to migrate, you could\\nmigrate to a Cloud-Optimized application, \", \"to get significant benefits from little work. This approach\\nalso sets you up for Cloud-Native as a p\", \"ossible future evolution. Figure 1-6 shows an example.\\nm= Microsoft\\n\\nel Existing rhN Cloud ww Cloud-\", \"Optimized\\n\\n.NET applications (on-prem.) Infrastructure-Ready Existing .NET apps\\n\\nMonolithic or N-Tie\", \"r Monolithic or N-Tier Monolithic or N-Tier\\n\\nASP.NET VMs (laaS Azure) Azure App Service\\nMVC\\n\\nSQL Ser\", \"ver VM Azure Container Instance\\n\\nWindows Containers\\n\\nWeb API Baber RDBMS VMs siietes ,\\non Service Fa\", \"bric\\n\\nSignalR\\nYour current Peas Windows Containers\\nWeb Pages Monitoring Tools On VMs\\n\\nYour current D\", \"eployment Azure SQL DB\\n\\nWCF Tools (Puppet, Chef, etc.) Nt\\nMonitoring (App Insights)\\nRelational Datab\", \"ase \\\\ : :\\n(SQL, Oracle, MySQL, etc.) CI/CD (VSTS/Jenkins)\\n\\nMicrosoft\\n\\nFigure 1-6. Example Cloud-Opti\", \"mized apps scenario, with Windows Containers and managed services\\n\\nGoing even further, you could ext\", \"end your existing Cloud-Optimized application by adding a few\\nmicroservices for specific scenarios. \", \"This approach would move you partially to the level of Cloud-\\nNative model, which is not the main fo\", \"cus of the present guidance.\\n\\nWhat this guide does not cover\\n\\nThis guide covers a specific subset of\", \" the example scenarios, as shown in Figure 1-7. This guide\\nfocuses only on the lift and shift scenar\", \"ios, and ultimately, on the Cloud-Optimized model. In the\\nCloud-Optimized model, a .NET Framework ap\", \"plication is modernized by using Windows Containers,\\nplus additional components like monitoring and \", \"CI/CD pipelines. Each component is fundamental to\\ndeploying applications to the cloud, faster, and w\", \"ith agility.\\nm= Microsoft\\n\\nap Existing w Cloud AN Cloud-Optimized AN Cloud-Native\\n\\n.NET applications\", \" (on-prem.) Infrastructure-Ready Existing .NET apps (Microservices Architecture)\\n\\nMonolithic or N-Ti\", \"er\\n\\nMonolithic or N-Tier\\n\\nMonolithic or N-Tier\\n\\nASP.NET\\nMVC\\n\\nVMs (laaS Azure) Azure App Service\\n\\nSQL\", \" Server VM\\n\\nAzure Container Instance\\n\\nWebForms\\n\\nWeb API Azure Web App for\\n\\nContainers\\n\\nNot covered i\", \"n\\nthis guide (*)\\n\\nOther RDBMS VMs\\n\\nSignalR ly\\nWindows Containers\\n\\nOn VMs\\n\\nYour current laaS\\nWeb Page\", \"s Monitoring Tools\\n\\nYour current Deployment\\nTools (Puppet, Chef, etc.)\\n\\nAzure SQL DB (*) Microservic\", \"es guidance is\\n\\ncovered in this other eBook:\\n\\nMonitoring (App Insights) httos://aka.ms/microservic k\", \"\\n\\nRelational Database\\n\\n(SQL, Oracle, MySQL, etc.) CI/CD (Azure DevOps)\\n\\nNET\\n\\nMigrate / Rehost\\n\\nFigur\", \"e 1-7. Cloud-Native ts not covered in this guide\\n\\nModernize\\n\\nThe focus of this guide Is specific. It\", \" shows you the path you can take to achieve a lift and shift of your\\nexisting .NET applications, wit\", \"hout rearchitecting, and with no code changes. Ultimately, it shows you\\nhow to make your application\", \" Cloud-Optimized.\\n\\nThis guide doesn't show you how to create Cloud-Native applications, such as how \", \"to evolve to a\\nmicroservices architecture. To rearchitect your applications or to create brand-new a\", \"pplications that\\nare based on microservices, see the e-book .NET Microservices: Architecture for con\", \"tainerized .NET\\n\\napplications.\\n\\nAdditional resources\\n\\n. Containerized Docker application lifecycle w\", \"ith Microsoft platform and tools\\n(downloadable e-book)\\n\\nhttps://aka.ms/dockerlifecycleebook\\n\\n. -NET \", \"Microservices: Architecture for containerized .NET applications (downloadable e-\\nbook)\\n\\nhttps://aka.\", \"ms/microservicesebook\\n\\n\\u00b0 Architecting modern web applications with ASP.NET Core and Azure (downloada\", \"ble e-\\nbook)\\n\\nhttps://aka.ms/webappebook\\n\\nWho should use this guide\\nmE Microsoft\\n\\nThis guide was wri\", \"tten for developers and solution architects who want to modernize existing\\nASP.NET web applications \", \"or WCF services that are based on .NET Framework, for improved agility in\\nshipping and releasing app\", \"lications.\\n\\nYou also might find this guide useful if you are a technical decision maker, such as an \", \"enterprise\\narchitect or a development lead/director who just wants an overview of the benefits that \", \"you can get\\nby using Windows Containers, and by deploying to the cloud when using Microsoft Azure.\\n\\n\", \"How to use this guide\\n\\nThis guide addresses the \\u201cwhy\\\"-why you might want to modernize your existing \", \"applications, and the\\nspecific benefits you get from using Windows Containers when you move your app\", \"s to the cloud. The\\ncontent in the first few chapters of the guide is designed for architects and te\", \"chnical decision makers\\nwho want an overview, but who don't need to focus on implementation and tech\", \"nical, step-by-step\\ndetails.\\n\\nThe last chapter of this guide introduces multiple walkthroughs that f\", \"ocus on specific deployment\\nscenarios. This guide offers shorter versions of the walkthroughs, to su\", \"mmarize the scenarios and\\nhighlight their benefits. The full walkthroughs drill down into setup and \", \"implementation details, and\\nare published as a set of wiki posts in the same public GitHub repo wher\", \"e related sample apps reside\\n(discussed in the next section). The last chapter and the step-by-step \", \"wiki walkthroughs on GitHub will\\nbe of more interest to developers and architects who want to focus \", \"on implementation details.\\n\\nSample apps for modernizing legacy apps:\\neShopModernizing\\n\\nThe eShopMode\", \"rnizing repo on GitHub offers two sample applications that simulate legacy\\nmonolithic web applicatio\", \"ns. One web app is developed by using ASP.NET MVC; the second web app\\nis developed by using ASP.NET \", \"Web Forms and the third app is an N-Tier app with a WinForms client\\ndesktop app consuming a WCF serv\", \"ice backend. All these apps are based on the traditional .NET\\nFramework. These sample apps don\\u2019t use\", \" .NET Core/.NET 7 or ASP.NET Core as they are supposed to\\nbe existing/legacy .NET Framework applicat\", \"ions to be modernized.\\n\\nThese sample apps have a second version, with modernized code, and which are\", \" fairly straightforward.\\nThe most important difference between the app versions is that the second v\", \"ersions use Windows\\nContainers as the deployment choice. There also are a few additions to the secon\", \"d versions, like Azure\\nStorage Blobs for managing images, Azure Active Directory for managing securi\", \"ty, and Azure\\nApplication Insights for monitoring and auditing the applications.\\nContents\\n\\nLift and \", \"shift existing .NET apps to Azure laaS (Cloud Infrastructure-Ready) ................. 1\\nWhy migrate \", \"existing .NET web applications to AZUre aa oo... ececcsessesssessssesessesessssessesessesessesessese\", \"ssesesseseeseseeneens 2\\nWhen to migrate to laaS instead Of to PaaS. ccccecsssesssssssessesesssssesss\", \"essecsssesssssesussessseussesssesesessesseeussesseesesesseeseenssess 2\\nUse Azure Migrate to analyze \", \"and migrate your existing aPplicatiONSs tO AZUL uu... eecesessesessesesteseseeseeseees 2\\nUse Azure S\", \"ite Recovery to migrate your existing VMS to AZUre VMS uu... cesssssssssesessesesscsessssessssessese\", \"ssesteneens 3\\n\\nACditional rESOULCES ......essessesesssssessesessessessesessecucsucsecsesucsecsecsesu\", \"csessecuescsecsesucsessecuesesecuesuesecsecuesessecuesussessesueaeeaeeseeeaeeneeenees 4\\n\\nMigrate you\", \"r relational databases to AZUIEC..................sssssssscsssssssssssccscccccecccccccccscccssscsess\", \"ceees 6\\nWhen to migrate to Azure SQL Database Managed Instance uu... eeccesssssssesssesessesessesess\", \"esessesessesessesssscseesesesneens 7\\nWhen to migrate to AZUre SQL Database ou... eccessessssessssess\", \"ssessssessssessssesessesessesessssessesessesessesessesessesessesesseaesseseeseaeeneans 8\\nWhen to mov\", \"e your Original RDBMS to a VM (laaAS) oc ceesessessssessssesessesessesessesessesessesessesessesesses\", \"essesessesesseseeseseeseees 8\\nWhen to migrate to SQL Server aS a VM (laaS) we cccesesessessssesssses\", \"sssesessesessesessesessesessesessesessesessesessesessesessesesseseeseseeneees 9\\nUse Azure Database M\", \"igration Service to migrate your relational databases to AZUIE ues 9\\nACditional rESOULCES ......eees\", \"eesessessesseseeseesecsesessessecucsessecsesuesessesucsucsesuesscsessesuesscsesuesucsessesuescsesnes\", \"uesessecueseesecueeusaesseeteneeneeneeneaes 10\\n\\nModernize existing .NET apps to Cloud-Optimized appl\", \"ications ...............ccccccccccssssseeeees 11\\nReasons to modernize existing .NET apps to Cloud-Op\", \"tiMiZed applications ue eeceecesseseseseseseeeseeseees 12\\n\\nCloud-Optimized application Principles AN\", \" tenets uu... ceccesesessesesesessessssessssesesseseesesssseseesesesssseessseeeeeeseees 12\\nBenefits \", \"of a ClOUd-OptiMiZed APPlICAtION uo. eeesessessssessessesesessecsesesseesecucsessecsessssessecussess\", \"eenesesseeseeneseeseeneeeesees 14\\nMicrosoft technologies In ClOUd-OPtiMIZEd APPLICATIONS ou... ececs\", \"essessesessecsesessessesseseesecsesessssseesesesseenssesseeseeneseess 14\\nMonolithic applications Can\", \" be ClOUd-OptiMiZed ....... ee eccsessesessesessesesesessessssssessesecsssecessesessesesseessseeeese\", \"eseseenees 15\\nWhat about CloUd-Native applications? oc cessessssessssssessscsssssessscessesssecessec\", \"sssesessecessecessesessecessecessecesseeeseesaeenses 16\\nClOUC-Native Applications Aetalls oe ccscsss\", \"sesssesesscsssssssssesssssssssesessesessesessessssesessesssseseeseseesssesssseessseessseeeseeeeees 1\", \"7\\nWhat about MICrOSErVICES? ....eeeecessessesseseesesseseesecsecscssesessecsesecsecuesucsessecuescse\", \"sucsucseenecuesessesucsecsecsesueseesesussesaeeueeeeaeeneenenes 18\\nDeploy existing .NET apps aS WING\", \"OWS CONTAINETS.......cecesscsessessssesessessssesessesessesessesessesessesessesessesessesessesessese\", \"eseseeseens 19\\nWhat are containers? (LINUX OF WINGOWS).... cc cccccccsscscscsscscscsscscscsscscscssc\", \"scscsssscscsscscscsesscscsessvacsesacassesaeaseaeaes 19\\nBenefits of containers (Docker Engine ON LIN\", \"UX OF WINKOWS) .....ccesessesessessesesessessesssesseesesessesseeeseeseeeeeesees 19\\nWhaat 1S DOCKEr?\", \" 0... eeeseesessesssssessesessessssessesscsueaessecucsucsesuesucsessesucsscsesuesucsessesuesssesucss\", \"csesuesueaessesucsucsessesucseesesesaessesueeeeaeeneanenees 20\\nBenefits of Windows Containers for yo\", \"ur existing .NET applications .....ccecesesessessessesessesseeteseeseeneeesee 21\\nChoose an OS to tar\", \"get with .NET-based CONtAINETS oe cceesessessesesesessesessesessesessesessesessesesscsesseseeseseene\", \"aeeneens 22\\n\\ni Contents\\nWINCOWS CONTAINED TYPES ou... cececcsessesessesessesessesessesssesessesusses\", \"sssesussesussessssesuesecussesussesussessssesussesussessseeessesesseeesaesesseeeeseeess 23\\n\\nThe CONT\", \"AINEL ECOSYSTEM IN AZUL ...ceeccccessesessessssessssesessesessesessesssesussesscsesussesussesussesus\", \"sesussessseaessecussesesseeesaesnsseeeeseeess 24\\nWhen not to deploy to WINdOWS CONtAINELS ......cece\", \"sessesessesessesessecessecessecussesussesussesessecessecessesussecusseenssecessecesseeneseeeees 26\\nW\", \"hen to deploy Windows Containers in your on-premises laaS VM infrastructure uu... cesses 26\\nWhen to \", \"deploy Windows Containers to Azure VMS (laaS ClOU) oc cecesssessesessesessesessecessecsssecesseeeese\", \"ensseenees 26\\nWhen to deploy Windows Containers to Azure Container Instances (ACI)......cceesssssecs\", \"ssessssesesseeeeseeteseenees 27\\nWhen to deploy Windows Containers to Azure Kubernetes Service (AKS) \", \"....cceccesesessesessesessesesseeesseeneseenees 28\\nChoosing Azure compute platforms for container-ba\", \"sed Applications ........cccsessessesessessesesessessestesseseeeseeees 28\\nBuild resilient services r\", \"eady for the cloud: Embrace transient failures in the ClOU....... ee cceeesesseeeeseees 29\\n\\nHandling\", \" Partial faiUre oe cssscsessessesessessecscsessesscsussessecussessessecussesssenssussessecussssecucs\", \"ussessecussesseesesessesseeeseeseeneeeeaees 29\\nModernize your apps with Monitoring and teleMetry....\", \"..ccccccessessssessssesessesessessssesssscsessesessesessesessesesseseeseseeneees 31\\n\\nMonitor your ap\", \"plication with Application INSIGNtS........ccceesessssessessssssescsessssssssscessecsssecssseseseens\", \"seeesseeeseenees 31\\n\\nMonitor your Docker infrastructure with Log Analytics and its Container Monitor\", \"ing solution...... 32\\nModernize your app\\u2019s lifecycle with CI/CD pipelines and DevOps tools in the Cl\", \"OU ..... ce eeeeeseeteeeees 34\\nMigrate to hybrid ClOUd SCENASIOS ou... eeeesessesessessssesessesssse\", \"sessesessessssessssesssesssesessesessesessesussesessesessesessesessesessesessesesseseeneens 35\\n\\nAZUL\", \"C Stack w.eeeecesecsessessesseseesessessssessecscsssesucsucsessecucsessesuesucsessesucsessecuesucses\", \"sesuesecsesucsucsessesuesessesucsucsessesucsessesesaesaeeneeeeseeneenenee 35\\n\\nWalkthroughs and techn\", \"ical get started OVeErview.......................cccccccssssscsssssssssessssssssses 38\\nTechnical wal\", \"kthrough list... ccesssssssssssesesseccssesessssessessssessssesessessssesussecessessssesussecusseses\", \"secessecessesessececsesessecesseceeseensaeenees 38\\nWalkthrough 1: Tour of CSHOpP legacy APPS... cess\", \"sesessessesesessesseseesessecsesessecsesussessssusscsessecessesseenesesseeseeneseeseeneeeesees 39\\n\\nT\", \"echnical walkthrough availability 0... esessesssssssssessssessssesessessssessssessssesessessseseesec\", \"essesessecesseeessesesseeesseeesseeesseees 39\\n\\nOVEIVICW oo. eseccessessessesessessesscscsesucsucsecs\", \"ecucsscsecucsucsecuesucsessecucsscsesuesucsecuecuesscsesuesuescnecucaucsecucaucsecsesucseenecuesucse\", \"cnecueaeeneeneaeeneeneaneass 39\\n\\nGOAIS oo. eeeecessessessssessessesscsecsesncsecsessesucsessesucsscs\", \"esucsucsecsesussecsecuesucsesuesussecsecucsucsesuesuesecnecucacsecucsucsessesucsecsecuesecsecuecuese\", \"sneeneateneeneaneass 39\\n\\nScenario 1: ASP.NET Web app wu... ceecccsessssessesessesessesessesessesesse\", \"sussesussesussesussesussessssesussesussesussecussesessesussesnsseessseeneseenees 39\\n\\nScenario 2: WCF\", \" service and WinForms client app (3-Tie@r APP)... esesessesessesessecessecesseeesseesseessseeeseenee\", \"s 40\\n\\nB@MePits.....ceececsessssssssssssssssssscsussucsussucsucsscsucsucsssecsessesscsessecsecsecsecs\", \"ecuecsecuscuscuccussussucsussucsussussucsucsussesseeseeaeeaeeseeaeeaeeaeeaeeaeeneenee A1\\n\\nN@Xt STOPS\", \" oo eececesesessesesseseseseesesessscsessssesesuesssesussesesussesesscuesesscsesesesussesssussesesuc\", \"sssesscussescueseseenesesecuesesesussesessueseaeeneseateneaees 41\\nWalkthrough 2: Containerize your e\", \"xisting .NET applications with Windows Containers...........ccee 41\\n\\nOVEIVICW oo. eseccessessesseses\", \"sessesscscsesucsucsecsecucsscsecucsucsecuesucsessecucsscsesuesucsecuecuesscsesuesuescnecucaucsecucau\", \"csecsesucseenecuesucsecnecueaeeneeneaeeneeneaneass 41\\n\\nGOAIS oo. eeeecessessessssessessesscsecsesncs\", \"ecsessesucsessesucsscsesucsucsecsesussecsecuesucsesuesussecsecucsucsesuesuesecnecucacsecucsucsessesu\", \"csecsecuesecsecuecuesesneeneateneeneaneass 41\\n\\nScenario 1: Containerized ASP.NET WeD app... cceesses\", \"essessssssessessssesessesessessssssssesussecessesssecessecussecesseesseesseenees 42\\n\\nScenario 2: Con\", \"taineriZed WCE Service uu... ..cececsessessessessssessesessessesscsssessesucsessecucsussecsecuescsec\", \"uesucaessesucaeeaecneesaeeneenensens 42\\n\\nB@MePits.....ceececsessssssssssssssssssscsussucsussucsucssc\", \"sucsucsssecsessesscsessecsecsecsecsecuecsecuscuscuccussussucsussucsussussucsucsussesseeseeaeeaeeseea\", \"eeaeeaeeaeeaeeneenee 43\\n\\nContents\\nNeXt STOPS ..eeeeccsesessssesesesesesessesesesesesessesesesesesesu\", \"ssesesesesesesussesesesesesussesesesesesesusussesesesesesucsesesesesesessuseeseseseceseeeesesesesese\", \"eeeeeeess 43\\n\\nWalkthrough 3: Deploy your Windows Containers-based app to AZUre VMS... ececessesesses\", \"esecesseseeseeeeseenees 44\\nTechnical walkthrough availability 0... esessesssssssssessssessssesessess\", \"ssessssessssesessessseseesecessesessecesseeessesesseeesseeesseeesseees 44\\nOVEIVICW oo. eseccessesses\", \"sesessessesscscsesucsucsecsecucsscsecucsucsecuesucsessecucsscsesuesucsecuecuesscsesuesuescnecucaucse\", \"cucaucsecsesucseenecuesucsecnecueaeeneeneaeeneeneaneass 44\\nGOAIS oo. eeeecessessessssessessesscsecse\", \"sncsecsessesucsessesucsscsesucsucsecsesussecsecuesucsesuesussecsecucsucsesuesuesecnecucacsecucsucses\", \"sesucsecsecuesecsecuecuesesneeneateneeneaneass 44\\nSCOMAL IOS... ecessessssessessecsesesessesscsessec\", \"scsscscnesucsscsesucsucsesnesucsecsesuesucsessesucsecsesuesucsecsesueascsecsesussecsesucsucsecuesucs\", \"essesucsesaesneseeaeeneeneasens 44\\nAzure VMS for WINdOWS CONtAINELS........cccessessessesseesesseese\", \"esessessecsscsecsecsecsecsecsecuecsseuccussucsucsussusseesesseeseeseeseeateneeneeseenes 46\\nB@MePits.\", \"....ceececsessssssssssssssssssscsussucsussucsucsscsucsucsssecsessesscsessecsecsecsecsecuecsecuscuscu\", \"ccussussucsussucsussussucsucsussesseeseeaeeaeeseeaeeaeeaeeaeeaeeneenee 46\\nNeXt STOPS ..eeeeccsesesss\", \"sesesesesesessesesesesesessesesesesesesussesesesesesesussesesesesesussesesesesesesusussesesesesesucs\", \"esesesesesessuseeseseseceseeeeseseseseseeeeeeeess 46\\n\\nWalkthrough 4: Deploy your Windows Containers-\", \"based apps to Azure Container Instances (ACI). 47\\n\\nTechnical walkthrough availability 0... esessesss\", \"ssssssessssessssesessessssessssessssesessessseseesecessesessecesseeessesesseeesseeesseeesseees 47\\nOV\", \"EIVICW oo. eseccessessessesessessesscscsesucsucsecsecucsscsecucsucsecuesucsessecucsscsesuesucsecuecu\", \"esscsesuesuescnecucaucsecucaucsecsesucseenecuesucsecnecueaeeneeneaeeneeneaneass 47\\nGOAIS oo. eeeeces\", \"sessessssessessesscsecsesncsecsessesucsessesucsscsesucsucsecsesussecsecuesucsesuesussecsecucsucsesue\", \"suesecnecucacsecucsucsessesucsecsecuesecsecuecuesesneeneateneeneaneass 47\\nSCOMAL IOS... ecessesssses\", \"sessecsesesessesscsessecscsscscnesucsscsesucsucsesnesucsecsesuesucsessesucsecsesuesucsecsesueascsecs\", \"esussecsesucsucsecuesucsessesucsesaesneseeaeeneeneasens 47\\nB@MePits.....ceececsesssssssssssssssssssc\", \"sussucsussucsucsscsucsucsssecsessesscsessecsecsecsecsecuecsecuscuscuccussussucsussucsussussucsucsuss\", \"esseeseeaeeaeeseeaeeaeeaeeaeeaeeneenee 47\\nCONMSICELATIONS.......eeseeesseseesessessesessecsecscsesse\", \"cuesscsecuecuesscsecucsucsesuesucsscsecuesucsesnesucsesnecuesscsecucsucsecuesuesessecuesecsecuesueae\", \"ssecucaeeneenenneass 48\\nNeXt STOPS ..eeeeccsesessssesesesesesessesesesesesessesesesesesesusseseseses\", \"esesussesesesesesussesesesesesesusussesesesesesucsesesesesesessuseeseseseceseeeeseseseseseeeeeeeess \", \"48\\nWalkthrough 5: Deploy your Windows Containers-based apps to Kubernetes in Azure Container\\nSOIVICE\", \" .occcessessessesessesscsuesecsessesucsessesucsecsessesucsecnesucsscsesuesucsesucsucsucsesuesucsecse\", \"susaucsesucsscsesuecusacsecuesucsessesucaessecuescsesuecueaeenecueaeeneenenseass 48\\nTechnical walkth\", \"rough availability 0... esessesssssssssessssessssesessessssessssessssesessessseseesecessesessecessee\", \"essesesseeesseeesseeesseees 48\\nOVEIVICW oo. eseccessessessesessessesscscsesucsucsecsecucsscsecucsucs\", \"ecuesucsessecucsscsesuesucsecuecuesscsesuesuescnecucaucsecucaucsecsesucseenecuesucsecnecueaeeneeneae\", \"eneeneaneass 48\\nGOAIS oo. eeeecessessessssessessesscsecsesncsecsessesucsessesucsscsesucsucsecsesusse\", \"csecuesucsesuesussecsecucsucsesuesuesecnecucacsecucsucsessesucsecsecuesecsecuecuesesneeneateneeneane\", \"ass 49\\nSCOMAL IOS... ecessessssessessecsesesessesscsessecscsscscnesucsscsesucsucsesnesucsecsesuesucs\", \"essesucsecsesuesucsecsesueascsecsesussecsesucsucsecuesucsessesucsesaesneseeaeeneeneasens 49\\nB@MePits\", \".....ceececsessssssssssssssssssscsussucsussucsucsscsucsucsssecsessesscsessecsecsecsecsecuecsecuscusc\", \"uccussussucsussucsussussucsucsussesseeseeaeeaeeseeaeeaeeaeeaeeaeeneenee 50\\nN@Xt STOPS oo eececeseses\", \"sesesseseseseesesessscsessssesesuesssesussesesussesesscuesesscsesesesussesssussesesucsssesscussescue\", \"seseenesesecuesesesussesessueseaeeneseateneaees 51\\nWalkthrough 6: Deploy your Windows Containers-bas\", \"ed apps to Azure App Service for Containers\\nsassuscuscuceuccuccucsucsussussussussussucsucsscsucsscse\", \"sassnssnecsesuecuscussuscussucaucaucsussussussucsucsucsucsucsessecsessecnecuecuecuseuscussuscuccussu\", \"caucsucaussucsessesaeeneeneeaseneeneeneens 51\\nTechnical walkthrough availability 0... esessessssssss\", \"sessssessssesessessssessssessssesessessseseesecessesessecesseeessesesseeesseeesseeesseees 51\\nOVEIVIC\", \"W oo. eseccessessessesessessesscscsesucsucsecsecucsscsecucsucsecuesucsessecucsscsesuesucsecuecuesscs\", \"esuesuescnecucaucsecucaucsecsesucseenecuesucsecnecueaeeneeneaeeneeneaneass 51\\nGOAIS oo. eeeecessesse\", \"ssssessessesscsecsesncsecsessesucsessesucsscsesucsucsecsesussecsecuesucsesuesussecsecucsucsesuesuese\", \"cnecucacsecucsucsessesucsecsecuesecsecuecuesesneeneateneeneaneass 51\\nSCOMALIO we esecsessesessesesse\", \"ssesscsecsesucscsesscsscsesnecucsscsesuesscsesnesucsscsesucsucscsesscsucsesuesucsecsesucascsecucsuss\", \"ecsecucsucsecuesucseesesucaeesesuseueaeeneeneasens 52\\nB@MePits.....ceececsessssssssssssssssssscsussu\", \"csussucsucsscsucsucsssecsessesscsessecsecsecsecsecuecsecuscuscuccussussucsussucsussussucsucsussessee\", \"seeaeeaeeseeaeeaeeaeeaeeaeeneenee 52\\n\\nContents\\nNeXt STOPS ..eeeeccsesessssesesesesesessesesesesesess\", \"esesesesesesussesesesesesesussesesesesesussesesesesesesusussesesesesesucsesesesesesessuseesesesecese\", \"eeeseseseseseeeeeeeess 52\\n\\nCONCIUSIONS ................ccccccccccccccccsccsccccccccsccccccccccccccsc\", \"esccsceccecceccescecccsceccesceccesceccescescesceccesceccescess 53\\n\\niV Contents\\nCHAPTER\\n\\nLitt and sh\", \"ift existing .NET\\napps to Azure laaS (Cloud\\nIntrastructure-Ready\\n\\nVision: As a first step, to reduce\", \" your on-premises investment and total cost of hardware and\\nnetworking maintenance, simply rehost yo\", \"ur existing applications in the cloud.\\n\\nBefore getting into how to migrate your existing application\", \"s to the Azure infrastructure as a service\\n(laaS) platform, it's important to analyze the reasons wh\", \"y you'd want to migrate directly to laaS in\\nAzure. The scenario at this modernization maturity level\", \" essentially is to start using VMs in the cloud,\\ninstead of continuing to use your current, on-premi\", \"ses infrastructure.\\n\\nAnother point to analyze is why you might want to migrate to pure laaS cloud in\", \"stead of just adding\\nmore advanced managed services in Azure. Determine what cases might require laa\", \"S in the first place.\\n\\nFigure 2-1 positions Cloud Infrastructure-Ready applications in the moderniza\", \"tion maturity levels:\\n\\nExisting .NET application modernization: Maturity models\\n\\nExisting apps Cloud\", \" Cloud-Optimized Cloud-Native\\n.NET web apps (on-premises) Infrastructure-Ready Containerized & Manag\", \"ed Microservice architecture\\nMonolithic architecture Monolithic & N-Tier Monolithic & N-Tier Microse\", \"rvices architectures\\nOn-premises Azure Azure\\n\\nMinimal code changes Architected for the cloud, needs \", \"new code\\n\\nFigure 2-17. Positioning Cloud Infrastructure-Ready applications\\n\\n1 CHAPTER 1 | Lift and s\", \"hift existing .NET apps to Azure laaS (Cloud Infrastructure-Ready)\\nWhy migrate existing .NET web app\", \"lications to\\nAzure laaS\\n\\nThe main reason to migrate to the cloud, even at an initial laaS level, is \", \"to achieve cost reductions. By\\nusing more managed infrastructure services, your organization can low\", \"er its investment in hardware\\nmaintenance, server or VM provisioning and deployment, and infrastruct\", \"ure management.\\n\\nAfter you make the decision to move your apps to the cloud, the main reason why you\", \" might choose\\nlaaS instead of more advanced options like PaaS is simply that the laaS environment wi\", \"ll be more\\nfamiliar. Moving to an environment that's similar to your current, on-premises environmen\", \"t offers a\\nlower learning curve, which makes it the quickest path to the cloud.\\n\\nHowever, taking the\", \" quickest path to the cloud doesn\\u2019t mean that you will gain the most benefit from\\nhaving your applic\", \"ations running in the cloud. Any organization will gain the most significant benefits\\nfrom a cloud m\", \"igration at the already introduced Cloud-Optimized and Cloud-Native maturity levels.\\n\\nIt also has be\", \"come evident that applications are easier to modernize and rearchitect in the future\\nwhen they are a\", \"lready running in the cloud, even on laaS. Application data migration has already been\\nachieved. Als\", \"o, your organization will have gained the skills required for working in the cloud and\\nmade the shif\", \"t to operating in a \\u201ccloud culture.\\u201d\\n\\nWhen to migrate to laaS instead of to PaaS\\n\\nThe next sections \", \"discuss Cloud-Optimized applications that are mostly based on PaaS platforms and\\nservices. These app\", \"s give you the most benefits from migrating to the cloud.\\n\\nIf your goal is simply to move existing a\", \"pplications to the cloud, first, identify existing applications that\\nwould not require substantial m\", \"odification to run in Azure App Service. These apps should be the first\\ncandidates for Cloud-Optimiz\", \"ed.\\n\\nThen, for the apps that still cannot move to Windows Containers and PaaS such as App Service or\", \"\\norchestrators like Azure Kubernetes Service, migrate those apps to simple plain VMs (laaS).\\n\\nBut, k\", \"eep in mind that correctly configuring, securing, and maintaining VMs requires much more time\\nand IT\", \" expertise compared to using PaaS services in Azure. If you are considering Azure Virtual\\nMachines, \", \"make sure that you take into account the ongoing maintenance effort required to patch,\\nupdate, and m\", \"anage your VM environment. Azure Virtual Machines Is laaS.\\n\\nUse Azure Migrate to analyze and migrate\", \" your\\nexisting applications to Azure\\n\\nMigrating to the cloud doesn't have to be difficult. But many \", \"organizations struggle to get started - to\\nget deep visibility into the environment and the tight in\", \"terdependencies between applications,\\nworkloads, and data. Without that visibility, it can be diffic\", \"ult to plan the path forward. Without\\ndetailed information on what's required for a successful migra\", \"tion, you can't have the right\\n\\n2 CHAPTER 1 | Lift and shift existing .NET apps to Azure laaS (Cloud\", \" Infrastructure-Ready)\\nconversations within your organization. You don\\u2019t know enough about the poten\", \"tial cost benefits, or\\nwhether workloads could just lift-and-shift or would require significant rewo\", \"rk to migrate successfully.\\nNo wonder many organizations hesitate.\\n\\nAzure Migrate is a new service t\", \"hat provides the guidance, insights, and mechanisms needed to assist\\nyou in migrating to Azure. Azur\", \"e Migrate provides:\\n\\n\\u00b0 Discovery and assessment for on-premises virtual machines\\n. Inbuilt dependenc\", \"y mapping for high-confidence discovery of multi-tier applications\\n\\u00b0 Intelligent right sizing to Azu\", \"re virtual machines\\n\\n. Compatibility reporting with guidelines for remediating potential issues\\n. In\", \"tegration with Azure Database Management Service for database discovery and migration\\n\\nAzure Migrate\", \" gives you confidence that your workloads can migrate with minimal impact to the\\nbusiness and run as\", \" expected in Azure. With the right tools and guidance, you can achieve maximum\\nreturn on investment \", \"while assuring that critical performance and reliability needs are met.\\n\\nFigure 2-2 shows you the bu\", \"ilt-in dependency mapping for all server and application connections\\nperformed by Azure Migrate.\\n\\n( \", \"=) @ Dependencies-Microx X + Vv = Fe x\\n\\n\\u2014 7 0 @ |6 xy \\u00a2e he\\n\\nchine(s)\\n\\nLegend \\u00a9. \\u00ae\\n\\nFigure 2-2. Posi\", \"tioning Cloud Infrastructure-Ready applications\\n\\nUse Azure Site Recovery to migrate your existing\\nVM\", \"s to Azure VMs\\n\\nAs part of the end-to-end Azure Migrate, Azure Site Recovery Is a tool that you can \", \"use to easily\\nmigrate your web apps to VMs in Azure. You can use Site Recovery to replicate on-premi\", \"ses VMs and\\nphysical servers to Azure, or to replicate them to a secondary on-premises location. You\", \" can even\\nreplicate a workload that\\u2019s running on a supported Azure VM, on an on-premises Hyper-V VM,\", \" on a\\nVMware VM, or on a Windows or Linux physical server. Replication to Azure eliminates the cost \", \"and\\ncomplexity of maintaining a secondary datacenter.\\n\\n3 CHAPTER 1 | Lift and shift existing .NET ap\", \"ps to Azure laaS (Cloud Infrastructure-Ready)\\nSite Recovery is also made specifically for hybrid env\", \"ironments that are partly on-premises and partly\\non Azure. Site Recovery helps ensure business conti\", \"nuity by keeping your apps that are running on\\nVMs and on-premises physical servers available if a s\", \"ite goes down. It replicates workloads that are\\nrunning on VMs and physical servers so that they rem\", \"ain available in a secondary location if the\\nprimary site isn't available. It recovers workloads to \", \"the primary site when it's up and running again.\\n\\nFigure 2-3 shows the execution of multiple VM migr\", \"ations by using Azure Site Recovery.\\n\\nReplicated items\\n\\nre) Refresh + Replicate 35 Columns\\n\\nLast ref\", \"reshed at: 10/13/2016, 2:59:17 PM\\n\\ni) Finished loading data from service.\\n\\nFilter items\\nNAME HEALTH \", \"STATUS ACTIVE LOCATION REPLICATION POLICY\\n\\nyer2012 v . Microsoft Azur AWSRep! nPolicy\\nAWSServer201 @\", \" ox Unplanned failover comp Aicrosoft Azure WSReplicationPolicy Pin to dashboard \\u00a2\\nAWSWordPressRedHa\", \"t @ OK Protected AWSGATEWAY AWSReplicationPolicy\\nFabrikamMarketing iv) OK Unplanned failover comp. M\", \"icrosoft Azure ContosoReplicationPolicy\\n\\nee - Change PIT\\nFabrikamFinance @ ox Protected CONTOSOGATEW\", \"AY ContosoReplicationPolicy\\nCommit\\n\\n> ContosoReplicationGr..\\n\\nComplete Migration\\n\\nRe-protect\\n\\nDelete\", \"\\n\\nFigure 2-3. Positioning Cloud Infrastructure-Ready applications\\n\\nAdditional resources\\n\\n. Azure Mig\", \"rate Datasheet\\n\\nhttps://aka.ms/azuremigration\\\\ datasheet\\n\\n. Azure Migrate\\n\\nhttps://aka.ms/azuremigra\", \"te\\n\\n\\u00b0 Azure migration and modernization center\\n\\nhttps://azure.microsoft.com/migration/\\n\\n\\u00b0 Migrate to\", \" Azure with Site Recovery\\n\\nhttps://learn.microsoft.com/azure/site-recovery/site-recovery-migrate-to-\", \"azure\\n\\n. Azure Site Recovery service overview\\n\\n4 CHAPTER 1 | Lift and shift existing .NET apps to Az\", \"ure laaS (Cloud Infrastructure-Ready)\\nhttps://learn.microsoft.com/azure/site-recovery/site-recovery-\", \"overview\\n\\nMigrating VMs in AWS to Azure VMs\\n\\nhttps://learn.microsoft.com/azure/site-recovery/site-re\", \"covery-migrate-aws-to-azure\\n\\nCHAPTER 1 | Lift and shift existing .NET apps to Azure laaS (Cloud Infr\", \"astructure-Ready)\\nCHAPTER\\n\\nMigrate your relational\\ndatabases to Azure\\n\\nVision: Azure offers the most\", \" comprehensive database migration.\\n\\nIn Azure, you can migrate your database servers directly to laaS\", \" VMs (pure lift and shift), or you can\\nmigrate to Azure SQL Database, for additional benefits. Azure\", \" SQL Database offers the managed\\ninstance and full database-as-a-service (DBaaS) options. Figure 3-1\", \" shows the multiple relational\\ndatabase migration paths available in Azure.\\n\\n=)p On-premises\\n\\nInstan\", \"ce\\u2014 em Service\\n\\n~~~. Instance\\nmigration\\n\\nInstance}\\nmigration\\n\\n(*) ADMS: Azure Database\\nMigration Ser\", \"vice\\n\\nFigure 3-1. Database migration paths in Azure\\n\\nADMS @\\n\\nSQL Server\\nVM\\n\\n\\u2018\\u00a2 Database\\nmigration\\n\\nV\", \"EN Microsoft Azure\\n\\nAzure SQL Database Services\\n\\nse set Database\\n\\n7 migration\\n&\\n&\\n\\nManaged Instance \", \"Single database\\n\\nmodel\\n\\nAzure Database Services\\n\\nAzure Database Azure Database\\nfor MySQL\\n\\nSingle dat\", \"abase\\nmodel\\n\\nfor PostgreSQL\\n\\nCHAPTER 2 | Migrate your relational databases to Azure\\nWhen to migrate \", \"to Azure SQL Database Managed\\nInstance\\n\\nIn most cases, Azure SQL Database Managed Instance will be y\", \"our best option to consider when you\\nmigrate your data to Azure. If you are migrating SQL Server dat\", \"abases and need nearly 100%\\nassurance that you won't need to rearchitect your application or make ch\", \"anges to your data or data\\naccess code, choose the Managed Instance feature of Azure SQL Database.\\n\\n\", \"Azure SQL Database Managed Instance is the best option if you have additional requirements for SQL\\nS\", \"erver instance-level functionality, or isolation requirements beyond the features provided in a\\nstan\", \"dard Azure SQL Database (single database model). This last one is the most PaaS-oriented choice,\\nbut\", \" it doesn\\u2019t offer the same features as that of a traditional SQL server. Migration might surface\\nfri\", \"ctions.\\n\\nFor example, an organization that has made deep investments in instance-level SQL Server ca\", \"pabilities\\nwould benefit from migrating to SQL Managed Instance. Examples of instance-level SQL Serv\", \"er\\ncapabilities include SQL common language runtime (CLR) integration, SQL Server Agent, and cross-\\n\", \"database querying. Support for these features is not available in standard Azure SQL Database (a\\nsin\", \"gle-database model).\\n\\nAn organization that operates in a highly regulated industry, and which needs \", \"to maintain isolation for\\nsecurity purposes, also might benefit from choosing the SQL Managed Instan\", \"ce model.\\n\\nManaged Instance in Azure SQL Database has the following characteristics:\\n\\n. Security iso\", \"lation through Azure Virtual Network\\n. Application surface compatibility, with these features:\\n- SQL\", \" Server Agent and SQL Server Profiler\\n\\n- Cross-database references and queries, SQL CLR, replication\", \", change data capture\\n(CDC), and Service Broker\\n\\n\\u00b0 Database sizes up to 35 TB\\n\\n\\u00b0 Minimum-downtime mi\", \"gration, with these features:\\n\\u2014 Azure Database Migration Service\\n- Native backup and restore, and lo\", \"g shipping\\n\\nWith these capabilities, when you migrate existing application databases to Azure SQL Da\", \"tabase, the\\nManaged Instance model offers nearly 100% of the benefits of PaaS for SQL Server. Manage\", \"d Instance\\nis a SQL Server environment where you continue using instance-level capabilities without \", \"changing\\nyour application design.\\n\\nManaged Instance is probably the best fit for enterprises that cu\", \"rrently are using SQL Server, and\\nwhich require flexibility in their network security in the cloud. \", \"It's like having a private virtual network\\nfor your SQL databases.\\n\\n7 CHAPTER 2 | Migrate your relat\", \"ional databases to Azure\\nWhen to migrate to Azure SQL Database\\n\\nAs mentioned, the standard Azure SQL\", \" Database is a fully managed, relational DBaaS. SQL Database\\ncurrently manages millions of productio\", \"n databases, across 38 datacenters, around the world. It\\nsupports a broad range of applications and \", \"workloads, from managing straightforward transactional\\ndata, to driving the most data-intensive, mis\", \"sion-critical applications that require advanced data\\nprocessing at a global scale.\\n\\nBecause of its \", \"full PaaS features, better pricing-and ultimately lower cost-you should move to the\\nstandard Azure S\", \"QL Database as your \\u201cby-default choice\\u201d if you have an application that uses basic,\\nstandard SQL dat\", \"abases, and no additional instance features. SQL Server features like SQL CLR\\nintegration, SQL Serve\", \"r Agent, and cross-database querying are not supported in the standard Azure\\nSQL Database. Those fea\", \"tures are available only in the Azure SQL Database Managed Instance model.\\n\\nAzure SQL Database is th\", \"e only intelligent cloud database service that's built for app developers. It's\\nalso the only cloud \", \"database service that scales on-the-fly, without downtime, to help you efficiently\\ndeliver multitena\", \"nt apps. Ultimately, Azure SQL Database leaves you more time to innovate, and it\\naccelerates your ti\", \"me to market. You can build secure apps and connect to your SQL database by\\nusing the languages and \", \"platforms that you prefer.\\n\\nAzure SQL Database offers the following benefits:\\n. Built-in intelligenc\", \"e (machine learning) that learns and adapts to your app\\n\\u00b0 On-demand database provisioning\\n\\u00b0 A range \", \"of offers, for all workloads\\n. 99.99% availability SLA, zero maintenance\\n. Geo-replication and resto\", \"re services for data protection\\n. Azure SQL Database Point in Time Restore feature\\n\\u00b0 Compatibility w\", \"ith SQL Server 2016, including hybrid and migration\\n\\nThe standard Azure SQL Database is closer to Pa\", \"aS than Azure SQL Database Managed Instance.\\nPrefer the standard Azure SQL Database because you'll g\", \"et more benefits from a managed cloud.\\nHowever, Azure SQL Database has some key differences from reg\", \"ular and on-premises SQL Server\\ninstances. Depending on your existing application\\u2019s database require\", \"ments, and your enterprise\\nrequirements and policies, it might not be the best choice when you are p\", \"lanning your migration to\\nthe cloud.\\n\\nWhen to move your original RDBMS to a VM (laaS)\\n\\nOne of your m\", \"igration options is to move your original relational database management system\\n(RDBMS), including O\", \"racle, IBM DB2, MySQL, PostgreSQL, or SQL Server, to a similar server that\\u2019s\\nrunning on an Azure VM.\", \" If you have existing applications that require the fastest migration to the\\ncloud with minimal chan\", \"ges, or no changes at all, a direct migration to laaS in the cloud might be a\\n\\n8 CHAPTER 2 | Migrate\", \" your relational databases to Azure\\nfair option. It might not be the best way to take advantage of a\", \"ll the cloud\\u2019s benefits, but it's probably\\nthe fastest initial path.\\n\\nCurrently, Microsoft Azure sup\", \"ports up to 331 different database servers deployed as laaS VMs. These\\ninclude popular RDBMS like SQ\", \"L Server, Oracle, MySQL, PostgreSQL, and IBM DB2, and many other\\nNoSQL databases like MongoDB, Cassa\", \"ndra, DataStax, MariaDB, and Cloudera.\\n\\nNote\\n\\nAlthough moving your RDBMS to an Azure VM might be the\", \" fastest way to migrate your data to the\\ncloud (because it is laaS), this approach requires a signif\", \"icant investment in your IT teams (database\\n\\nadministrators and IT pros). Enterprise teams need to b\", \"e able to set up and manage high availability,\\ndisaster recovery, and patching for SQL Server. This \", \"context also needs a customized environment,\\nwith full administrative rights.\\n\\nWhen to migrate to SQ\", \"L Server as a VM (laaS)\\n\\nThere might be a few cases where you still need to migrate to SQL Server as\", \" a regular VM. An\\nexample scenario is if you need to use SQL Server Reporting Services. In most case\", \"s, though, Azure\\nSQL Database Managed Instance can provide everything you need to migrate from on-pr\", \"emises SQL\\nservers, SO migration to a SQL Server VM should be your last resort to try.\\n\\nUse Azure Da\", \"tabase Migration Service to migrate\\nyour relational databases to Azure\\n\\nYou can use Azure Database M\", \"igration Service to migrate relational databases like SQL Server, and\\nMySQL to Azure, whether your t\", \"arget database is Azure SQL Database, Azure SQL Database Managed\\nInstance, or SQL Server on an Azure\", \" VM.\\n\\nThe automated workflow, with assessment reporting, guides you through the changes you need to\\n\", \"make before you migrate the database. When you are ready, the service migrates the source database\\nt\", \"o Azure.\\n\\nWhenever you change an original RDBMS, you might need to retest. You also might need to ch\", \"ange\\nthe SQL sentences or Object-Relational Mapping (ORM) code in your application, depending on\\ntes\", \"ting results.\\n\\nIf you have any other database (for example, IBM DB2) and you opt for a lift and shif\", \"t approach, you\\nmight want to continue using those databases as laaS VMs in Azure, unless you are wi\", \"lling to perform\\na more complex data migration. A more complex data migration will require additiona\", \"l effort because\\nyou'd be migrating to a different database type with the new schema and different p\", \"rogramming\\nlibraries.\\n\\n9 CHAPTER 2 | Migrate your relational databases to Azure\\nAdditional resources\", \"\\n\\n\\u00b0 Choose a cloud SQL Server option: Azure SQL Database (PaaS) or SQL Server on Azure\\nVM (laaS)\\n\\n. \", \"SQL Server database migration to SQL Database in the cloud\\n\\nhttps://learn.microsoft.com/azure/sql-da\", \"tabase/sql-database-cloud-migrate\\n\\u00b0 Azure SQL Database\\n\\nhttps://azure.microsoft.com/services/sq|-dat\", \"abase/?v= 16.50\\n\\n\\u00b0 SQL Server on virtual machines\\n\\nhttps://azure.microsoft.com/services/virtual-mach\", \"ines/sql-server/\\n\\n10 CHAPTER 2 | Migrate your relational databases to Azure\\nCHAPTER\\n\\nModernize exist\", \"ing .NET\\napps to Cloud-Optimized\\napplications\\n\\nVision: Modernize your existing .NET Framework applic\", \"ations to Cloud-Optimized applications to\\ndrastically improve your deployment agility, so you can sh\", \"ip faster and lower application's delivery\\ncosts.\\n\\nTo take advantage of the benefits of the cloud an\", \"d new technologies like containers, you should at\\nleast partially modernize your existing .NET appli\", \"cations. Ultimately, modernizing your enterprise\\napplications will lower your total cost of ownershi\", \"p.\\n\\nPartially modernizing an app doesn't necessarily mean a full migration and rearchitecture. You c\", \"an\\ninitially modernize your existing applications with important but easy to do modernization. You c\", \"an\\nmaintain your current code base, written in existing .NET Framework versions, with any Windows an\", \"d\\nIIS dependencies. Figure 4-1 highlights how Cloud-Optimized apps are positioned in Azure\\napplicati\", \"on modernization maturity models.\\n\\nExisting .NET application modernization: Maturity models\\n\\nExistin\", \"g apps Cloud Cloud-Optimized Cloud-Native\\n.NET web apps (on-premises) Infrastructure-Ready Container\", \"ized & Managed Microservice architecture\\nMonolithic architecture Monolithic & N-Tier Monolithic & N-\", \"Tier Microservices architectures\\nOn-premises Azure Azure\\n\\nMinimal code changes Architected for the c\", \"loud, needs new code\\n\\nFigure 4-1. Positioning Cloud-Optimized applications\\n\\n11 CHAPTER 3 | Modernize\", \" existing .NET apps to Cloud-Optimized applications\\nReasons to modernize existing .NET apps to Cloud\", \"-\\nOptimized applications\\n\\nWith a Cloud-Optimized application, you can rapidly and repeatedly deliver\", \" reliable applications to\\nyour customers. You gain essential agility and reliability by deferring mu\", \"ch of the operational\\ncomplexity of your app to the platform.\\n\\nIf you can't get your applications to\", \" market quickly, by the time you ship your app, the market you\\nwere targeting will have evolved. You\", \" might be too late, no matter how well the application was\\narchitected or engineered. You might be f\", \"ailing or not reaching your full potential because you can't\\nsync app delivery with the needs of the\", \" market.\\n\\nThe need for continuous business innovation pushes development and operations teams to the\", \" limit.\\nThe only way to achieve the agility you need in continuous business innovation is by moderni\", \"zing\\nyour applications with technologies like containers and specific Cloud-Optimized application\\npr\", \"inciples.\\n\\nThe bottom line is that when an organization builds and manages applications that are Clo\", \"ud-\\nOptimized, it can put solutions in the hands of customers sooner and bring new ideas to market w\", \"hen\\nthey are relevant.\\n\\nCloud-Optimized application principles and tenets\\n\\nImprovements in the cloud\", \" are mostly focused on meeting two goals: Reduce costs and improve\\nbusiness growth by improving agil\", \"ity. These goals are achieved by simplifying processes and reducing\\nfriction when you release and sh\", \"ip applications.\\n\\nYour application is Cloud-Optimized if you can-in an agile manner-develop your app\", \" autonomously\\nfrom other on-premises apps, and then release, deploy, autoscale, monitor, and trouble\", \"shoot your\\napp in the cloud.\\n\\nThe key is agility. You can't ship with agility unless you reduce to a\", \"n absolute minimum any\\ndeployment-to-production issues and dev/test environment issues. Containers (\", \"specifically, Docker, as\\na de facto standard) and managed services were designed specifically for th\", \"is purpose.\\n\\nTo achieve agility, you also need automated DevOps processes that are based on CI/CD pi\", \"pelines that\\nrelease to scalable platforms in the cloud. CI/CD platforms (like Azure DevOps Services\", \" or Jenkins) that\\ndeploy to a scalable and resilient cloud platform (like Azure App Service or Azure\", \" Kubernetes Service)\\nare key technologies for achieving agility in the cloud.\\n\\nThe following list de\", \"scribes the main tenets or practices for Cloud-Optimized applications. Note that\\nyou can adopt all o\", \"r only some of these principles, in a progressive or incremental approach:\\n\\n\\u00b0 Containers. Containers\", \" give you the ability to include application dependencies with the\\napplication itself. Containerizat\", \"ion significantly reduces the number of issues you might\\nencounter when you deploy to production env\", \"ironments or test in staging environments.\\nUltimately, containers improve the agility of application\", \" delivery.\\n\\n12 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n. Resilient \", \"and scalable cloud. The cloud provides a platform that is managed, elastic,\\nscalable, and resilient.\", \" These characteristics are fundamental to gain cost improvements and\\nship highly available and relia\", \"ble applications in a continuous delivery. Managed services like\\nmanaged databases, managed cache as\", \" a service (CaaS), and managed storage are\\nfundamental pieces in alleviating the maintenance costs o\", \"f your application.\\n\\n. Monitoring. You can't have a reliable application without having a good way t\", \"o detect and\\ndiagnose exceptions and application performance issues. You need to get actionable insi\", \"ghts\\nthrough application performance management and instant analytics.\\n\\n. DevOps culture and continu\", \"ous delivery. Adopting DevOps practices requires a cultural\\nchange in which teams no longer work in \", \"independent silos. CI/CD pipelines are possible only\\nwhen there Is an increased collaboration betwee\", \"n development and IT operations teams,\\nsupported by containers and CI/CD tools.\\n\\nFigure 4-2 shows th\", \"e main optional pillars of a Cloud-Optimized application. The more pillars you\\nimplement, the readie\", \"r your application will be to succeed in meeting your customers\\u2019 expectations.\\n\\nCloud-Optimized appl\", \"ication\\n\\nContainerized\\nResilient & high available cloud\\n\\nMonitored/Insights\\n\\nDevOps and continuous d\", \"elivery\\n\\nFigure 4-2. Main pillars of a Cloud-Optimized application\\n\\nTo summarize, a Cloud-Optimized \", \"application is an approach to building and managing applications\\nthat takes advantage of the cloud c\", \"omputing model, while using a combination of containers,\\nmanaged cloud infrastructure, resilient app\", \"lication techniques, monitoring, continuous delivery, and\\nDevOps, all without the need to rearchitec\", \"t and recode your existing applications.\\n\\nYour organization can adopt these technologies and approac\", \"hes gradually. You don't have to\\nembrace all of them, all at once. You can adopt them incrementally,\", \" depending on enterprise priorities\\nand user needs.\\n\\n13 CHAPTER 3 | Modernize existing .NET apps to \", \"Cloud-Optimized applications\\nBenefits of a Cloud-Optimized application\\n\\nYou can get the following be\", \"nefits by converting an existing application to a Cloud-Optimized\\n\\napplication (without rearchitecti\", \"ng or coding):\\n\\nLower costs, because the managed infrastructure is handled by the cloud provider.\\nCl\", \"oud-Optimized applications get the benefits of the cloud by using the cloud\\u2019s out-of-the-\\nbox elasti\", \"city, autoscale, and high availability. Benefits are related not only to the compute\\nfeatures (VMs a\", \"nd containers), but also depend on the resources in the cloud, like DBaaS,\\nCaaS, and any infrastruct\", \"ure an application might needed.\\n\\nResilient application and infrastructure. When you migrate to the \", \"cloud, you need to\\nembrace transient failures; failures will occur in the cloud. Also, cloud infrast\", \"ructure and\\nhardware are \\u201creplaceable,\\u201d which increases opportunities for transient downtime. At the\", \"\\nsame time, inner cloud capabilities and certain application development techniques that\\nimplement r\", \"esiliency and automate recovery make it much easier to recover from unexpected\\nfailures in the cloud\", \".\\n\\nDeeper insights into application performance. Cloud monitoring tools like Azure\\nApplication Insig\", \"hts provide visualization for health management, logging, and notifications.\\nAudit logs make applica\", \"tions easy to debug and audit, fundamental for a reliable cloud\\napplication.\\n\\nApplication portabilit\", \"y, with agile deployments. Containers (either Linux or Windows\\ncontainers based on Docker Engine) of\", \"fer the best solution to avoiding a cloud-locked\\napplication. By using containers, Docker hosts, and\", \" multi-cloud orchestrators, you can easily\\nmove from one environment or cloud to another. Containers\", \" eliminate the friction that\\ntypically occurs in deployments to any environment (stage/test/producti\", \"on).\\n\\nAll of these benefits ultimately provide key cost reductions for your end-to-end application l\", \"ifecycle.\\n\\nIn the following sections, these benefits are explained in more detail, and are linked to\", \" specific\\ntechnologies.\\n\\nMicrosoft technologies in cloud-optimized\\napplications\\n\\nThe following list \", \"describes the tools, technologies, and solutions that are recognized as requirements\\nfor Cloud-Optim\", \"ized apps. You can adopt Cloud-Optimized elements selectively or gradually,\\ndepending on your priori\", \"ties.\\n\\n14\\n\\nCloud infrastructure: The infrastructure that provides the compute platform, operating\\nsy\", \"stem, network, and storage. Microsoft Azure is positioned at this level.\\n\\nRuntime: This layer provid\", \"es the environment for the application to run. If you are using\\ncontainers, this layer usually is ba\", \"sed on Docker Engine, running either on Linux hosts or on\\nWindows hosts. (Windows Containers are sup\", \"ported beginning with Windows Server 2016.\\n\\nCHAPTER 3 | Modernize existing .NET apps to Cloud-Optimi\", \"zed applications\\nWindows Containers is the best choice for existing .NET Framework applications that\", \" run on\\nWindows.)\\n\\n. Managed cloud: When you choose a managed cloud option, you can avoid the expens\", \"e and\\ncomplexity of managing and supporting the underlying infrastructure, VMs, OS patches, and\\nnetw\", \"orking configuration. If you choose to migrate by using laaS, you are responsible for all\\nof these t\", \"asks, and for associated costs. In a managed cloud option, you manage only the\\napplications and serv\", \"ices that you develop. The cloud service provider typically manages\\neverything else. Examples of man\", \"aged cloud services in Azure include Azure SQL Database,\\nAzure Redis Cache, Azure Cosmos DB, Azure S\", \"torage, Azure Database for MySQL, Azure\\n\\nDatabase for PostgreSQL, Azure Active Directory, and manage\", \"d compute services like VM\\nscale sets, Azure App Service, and Azure Kubernetes Service.\\n\\n. Applicati\", \"on development: You can choose from many languages when you build\\napplications that run in container\", \"s. This guide focuses on .NET, but, you can develop\\ncontainer-based apps by using other languages, l\", \"ike Node.js, Python, Spring/Java, or Go.\\n\\n\\u00b0 Monitoring, telemetry, logging, and auditing: The abilit\", \"y to monitor and audit applications\\nand containers that are running in the cloud is critical for any\", \" Cloud-Optimized application.\\n\\nAzure Application Insights and Microsoft Operations Management Suite \", \"are the main\\nMicrosoft tools that provide monitoring and auditing for Cloud-Optimized apps.\\n\\n. Provi\", \"sioning: Automation tools help you provision the infrastructure and deploy an\\napplication to multipl\", \"e environments (production, testing, staging). You can use tools like\\nChef and Puppet to manage an a\", \"pplication's configuration and environment. This layer also\\ncan be implemented by using simpler and \", \"more direct approaches. For example, you can\\ndeploy directly by using Azure command-line interface (\", \"Azure CLI) tooling, and then use the\\ncontinuous deployment and release management pipelines in Azure\", \" DevOps Services.\\n\\n. Application lifecycle: Azure DevOps Services and other tools, like Jenkins, are\", \" built\\nautomation servers that help you implement CI/CD pipelines, including release management.\\n\\nTh\", \"e next sections of this chapter, and the related walkthroughs, focus specifically on details about t\", \"he\\nruntime layer (Windows Containers). The guidance describes the ways you can deploy Windows\\nContai\", \"ners on Windows Server 2016 (and later versions) VMs and Azure Container Instances. It also\\ncovers m\", \"ore advanced PaaS platforms like Azure App Service and orchestrator like Azure Kubernetes\\nService.\\n\\n\", \"Monolithic applications can be Cloud-Optimized\\n\\nIt's important to highlight that monolithic applicat\", \"ions (applications that are not based on\\nmicroservices) can be Cloud-Optimized applications. You can\", \" build and operate monolithic\\napplications that take advantage of the cloud computing model by using\", \" a combination of containers,\\ncontinuous delivery, and DevOps. If an existing monolithic application\", \" is right for your business goals,\\nyou can modernize it and make it Cloud-Optimized.\\n\\nSimilarly, if \", \"monolithic applications can be Cloud-Optimized applications, other, more complex\\narchitectures like \", \"N-Tier applications can also be modernized as Cloud-Optimized applications.\\n\\n15 CHAPTER 3 | Moderniz\", \"e existing .NET apps to Cloud-Optimized applications\\nWhat about Cloud-Native applications?\\n\\nAlthough\", \" Cloud-Native applications are not the main focus of this guide, it's helpful to have an\\nunderstandi\", \"ng of this modernization maturity level, and to distinguish it from Cloud-Optimized\\napplications.\\n\\nF\", \"igure 4-3 positions Cloud-Native apps in the application modernization maturity levels:\\n\\nExisting .N\", \"ET application modernization: Maturity models\\n\\nExisting apps Cloud Cloud-Optimized Cloud-Native\\n.NET\", \" web apps (on-premises) Infrastructure-Ready Containerized & Managed Microservice architecture\\n\\nMono\", \"lithic & N-Tier\\n\\nMonolithic & N-Tier\\n\\nMonolithic architecture Microservices architectures\\n\\nap yh rh\\n\", \"\\nOn-premises Azure Azure\\n\\nMinimal code changes Architected for the cloud, needs new code\\n\\nFigure 4-3\", \". Positioning Cloud-Native applications\\n\\nThe Cloud-Native modernization maturity level usually requi\", \"res new development investments.\\nMoving to the Cloud-Native level typically is driven by business ne\", \"ed to modernize applications as\\nmuch as possible to drastically improve scale in large applications \", \"by creating autonomous\\nsubsystems (microservices) that can be deployed and scale independently from \", \"other areas of the\\napplication while lowering costs in the long term and increase evolution agility \", \"of those autonomous\\napp\\u2019s parts that provide significant compete advantages.\\n\\nThe main pillars of Cl\", \"oud-Native applications are based on microservices architecture approaches,\\nwhich can evolve with ag\", \"ility and scale to limits that would be difficult to achieve in a monolithic\\narchitecture, deployed \", \"to either on-premises or cloud environment.\\n\\nFigure 4-4 shows the main characteristics of the Cloud-\", \"Native model.\\n\\n16 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\nCloud-Nat\", \"ive in Azure\\nMain characteristics\\n\\nIAN\\n\\nCloud-native\\nMicroservices\\nDocker containers\\nOrchestrators (\", \"AKS/Kubernetes, Service Fabric)\\n\\nServerless (Azure Functions)\\nCloud-resilient\\n\\n.NET Core (cross-plat\", \"form, Linux/Windows)\\nOther languages\\n\\nFigure 4-4. Cloud-Native characteristics\\n\\nIn addition, you can\", \" extend basic modern web apps and cloud-native apps by adding other services,\\nlike artificial intell\", \"igence (Al), machine learning (ML), and loT. You might use any of these services to\\nextend any of th\", \"e possible Cloud-Optimized approaches.\\n\\nThe fundamental difference in applications at the Cloud-Nati\", \"ve level is in the application architecture.\\nCloud-native applications are, by definition, apps that\", \" are based on microservices. Cloud-native apps\\nrequire special architectures, technologies, and plat\", \"forms, compared to a monolithic web application\\nor traditional N-Tier application.\\n\\nCloud-native app\", \"lications details\\n\\nCloud-Native is a more advanced or mature state for large and mission-critical ap\", \"plications. Cloud-\\nNative applications usually require architecture and design that are created from\", \" scratch instead of by\\nmodernizing existing applications. The key difference between a Cloud-Native \", \"application and a\\nsimpler Cloud-Optimized web app is the recommendation to use microservices archite\", \"ctures in a\\ncloud-native approach. Cloud-Optimized apps can also be monolithic web apps or N-Tier ap\", \"ps.\\n\\nThe Twelve-Factor App (a collection of patterns that are closely related to microservices appro\", \"aches)\\nis also considered a requirement for cloud-native application architectures.\\n\\nThe Cloud Nativ\", \"e Computing Foundation (CNCF) is a primary promoter of cloud-native principles.\\nMicrosoft is a membe\", \"r of the CNCF.\\n\\nFor detailed guidance on how to design and develop cloud-native applications, read t\", \"he following\\nfree e-books:\\n\\n17 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applicati\", \"ons\\n\\u00b0 Architecting Cloud-Native .NET Applications for Azure\\n\\u00b0 .NET Microservices: Architecture for c\", \"ontainerized .NET applications.\\n\\nThe most important factor to consider if you migrate a full applica\", \"tion to the cloud-native model is\\nthat you must rearchitect to a microservices-based architecture. T\", \"his approach clearly requires a\\nsignificant investment in development because of the large refactori\", \"ng process involved. This option\\nusually is chosen for mission-critical applications that need new l\", \"evels of scalability and long-term\\nagility. But, you could start moving toward cloud-native by addin\", \"g microservices for just a few new\\nscenarios, and eventually refactor the application fully as micro\", \"services. This step is an incremental\\napproach that is the best option for some scenarios.\\n\\nWhat abo\", \"ut microservices?\\n\\nUnderstanding microservices and how they work is important when you are consideri\", \"ng cloud-native\\napplications for your organization.\\n\\nThe microservices architecture is an advanced a\", \"pproach that you can use for applications that are\\ncreated from scratch or when you evolve existing \", \"applications toward cloud-native applications. You\\ncan start by adding a few microservices to existi\", \"ng applications to learn about the new microservices\\nparadigms. But clearly, you need to architect a\", \"nd code, especially for this type of architectural\\napproach.\\n\\nHowever, microservices are not mandato\", \"ry for any new or modern application. Microservices are not a\\n\\u201cmagic bullet,\\u201d and they aren't the si\", \"ngle, best way to create every application. How and when you use\\nmicroservices depends on the type o\", \"f application that you need to build.\\n\\nThe microservices architecture is becoming the preferred appr\", \"oach for distributed and large or\\ncomplex mission-critical applications that are based on multiple, \", \"independent subsystems in the form\\nof autonomous services. In a microservices-based architecture, an\", \" application is built as a collection of\\nservices that can be independently developed, tested, versi\", \"oned, deployed, and scaled. This approach\\ncan include any related, autonomous database per microserv\", \"ice.\\n\\nFor a detailed look at a microservices architecture that you can implement by using .NET, see \", \"the\\n\\ndownloadable PDF e-book .NET microservices: Architecture for containerized .NET applications. T\", \"he\\nguide also is available online.\\n\\nBut even in scenarios in which microservices offer powerful capa\", \"bilities-independent deployment,\\nstrong subsystem boundaries, and technology diversity-they also rai\", \"se many new challenges. The\\nchallenges are related to distributed application development, such as f\", \"ragmented and independent\\ndata models; achieving resilient communication between microservices; the \", \"need for eventual\\nconsistency; and operational complexity. Microservices introduce a higher level of\", \" complexity\\ncompared to traditional monolithic applications.\\n\\nBecause of the complexity of a microse\", \"rvices architecture, only specific scenarios and certain\\napplication types are suitable for microser\", \"vice-based applications. These include large and complex\\napplications that have multiple, evolving s\", \"ubsystems. In these cases, it's worth investing in a more\\ncomplex software architecture, for increas\", \"ed long-term agility and more efficient application\\nmaintenance. But for less complex scenarios, it \", \"might be better to continue with a monolithic\\napplication approach or simpler N-Tier approaches.\\n\\n18\", \" CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\nAs a final note, even at t\", \"he risk of being repetitive about this concept, you shouldn't look at using\\nmicroservices in your ap\", \"plications as \\u201call-in or nothing at all.\\u201d You can extend and evolve existing\\nmonolithic applications\", \" by adding new, small scenarios based on microservices. You don't need to\\nstart from scratch to star\", \"t working with a microservices architecture approach. In fact, we recommend\\nthat you evolve from usi\", \"ng an existing monolithic or N-Tier application by adding new scenarios.\\nEventually, you can break d\", \"own the application into autonomous components or microservices. You\\ncan start evolving your monolit\", \"hic applications in a microservices direction, step by step.\\n\\nIn any case, the rest of this present \", \"guidance focuses most of all on \\u201cno microservices-based apps\\u201d\\nbecause this guidance Is mainly target\", \"ing the modernization of existing apps that usually have\\nmonolithic or N-Tier architectures.\\n\\nDeploy\", \" existing .NET apps as Windows containers\\n\\nDeployments that are based on Windows Containers are appl\", \"icable to Cloud-Optimized applications\\nand Cloud-Native applications.\\n\\nHowever, in this guide and es\", \"pecially in the following sections, it mostly focuses on using Windows\\nContainers for Cloud-Optimize\", \"d applications where you don't need to rearchitect your application.\\n\\nWhat are containers? (Linux or\", \" Windows)\\n\\nContainers are a way to wrap up an application into its own isolated package. In its cont\", \"ainer, the\\napplication is not affected by applications or processes that exist outside of the contai\", \"ner. Everything\\nthe application depends on to run successfully as a process is inside the container.\", \" Wherever the\\ncontainer might move, the requirements of the application will always be met, in terms\", \" of direct\\ndependencies, because it is bundled with everything that it needs to run (library depende\", \"ncies,\\nruntimes, and so on).\\n\\nThe main characteristic of a container is that it makes the environmen\", \"t the same across different\\ndeployments because the container itself comes with all the dependencies\", \" it needs. You can debug\\nthe application on your machine, and then deploy it to another machine, wit\", \"h the same environment\\nguaranteed.\\n\\nA container is an instance of a container image. A container ima\", \"ge is a way to package an app or\\nservice (like a snapshot), and then deploy it in a reliable and rep\", \"roducible way. You could say that\\nDocker is not only a technology-it\\u2019s also a philosophy and a proce\", \"ss.\\n\\nAs containers daily become more common, they are becoming an industry-wide \\u201cunit of deployment.\", \"\\\"\\n\\nBenefits of containers (Docker Engine on Linux or Windows)\\n\\nBuilding applications by using contai\", \"ners-which also might be defined as lightweight building blocks-\\noffers a significant increase in ag\", \"ility for building, shipping, and running any application, across any\\ninfrastructure.\\n\\nWith containe\", \"rs, you can take any app from development to production with little or no code change,\\nthanks to Doc\", \"ker integration across Microsoft developer tools, operating systems, and the cloud.\\n\\n19 CHAPTER 3 | \", \"Modernize existing .NET apps to Cloud-Optimized applications\\nWhen you deploy to plain VMs, you proba\", \"bly already have a method in place for deploying ASP.NET\\napps to your VMs. It's likely, though, that\", \" your method involves multiple manual steps or complex\\nautomated processes by using a deployment too\", \"l like Puppet, or a similar tool. You might need to\\nperform tasks like modifying configuration items\", \", copying application content between servers, and\\nrunning interactive setup programs based on .msi \", \"setups, followed by testing. All those steps in the\\ndeployment add time and risk to deployments. You\", \" will get failures whenever a dependency is not\\npresent in the target environment.\\n\\nIn Windows Conta\", \"iners, the process of packaging applications Is fully automated. Windows Containers\\nis based on the \", \"Docker platform, which offers automatic updates and rollbacks for container\\ndeployments. The main im\", \"provement you get from using the Docker engine is that you create images,\\nwhich are like snapshots o\", \"f your application, with all its dependencies. The images are Docker images\\n(a Windows container ima\", \"ge, in this case). The images run ASP.NET apps in containers, without going\\nback to source code. The\", \" container snapshot becomes the unit of deployment.\\n\\nMany organizations are containerizing existing \", \"monolithic applications for the following reasons:\\n\\n. Release agility through improved deployment. C\", \"ontainers offer a consistent deployment\\ncontract between development and operations. When you use co\", \"ntainers, you won't hear\\ndevelopers say, \\u201cIt works on my machine, why not in production?\\u201d They can s\", \"ay, \\u201cIt runs as a\\ncontainer, so it will run in production.\\u201d The packaged application, with all its d\", \"ependencies,\\ncan be executed in any supported container-based environment. It will run the way it wa\", \"s\\nintended to run in all deployment targets (dev, QA, staging, production). Containers eliminate\\nmos\", \"t frictions when they move from one stage to the next, which greatly improves\\ndeployment, and you ca\", \"n ship faster.\\n\\n. Cost reductions. Containers lead to lower costs, either by the consolidation and r\", \"emoval of\\nexisting hardware, or from running applications at a higher density per unit of hardware.\\n\", \"\\n\\u00b0 Portability. Containers are modular and portable. Docker containers are supported on any\\nserver o\", \"perating system (Linux and Windows), in any major public cloud (Microsoft Azure,\\nAmazon AWS, Google,\", \" IBM), and in on-premises and private or hybrid cloud environments.\\n\\n. Control. Containers offer a f\", \"lexible and secure environment that's controlled at the container\\nlevel. A container can be secured,\", \" isolated, and even limited by setting execution constraint\\npolicies on the container. As detailed i\", \"n the section about Windows Containers, Windows\\nServer 2016 and Hyper-V containers offer additional \", \"enterprise support options.\\n\\nSignificant improvements in agility, portability, and control ultimatel\", \"y lead to significant cost\\nreductions when you use containers to develop and maintain applications.\\n\", \"\\nWhat is Docker?\\n\\nDocker is an Open-source project that automates the deployment of applications as \", \"portable, self-\\nsufficient containers that can run in the cloud or on-premises. Docker is also a com\", \"pany that\\npromotes and evolves this technology. The company works in collaboration with cloud, Linux\", \", and\\nWindows vendors, including Microsoft.\\n\\n20 CHAPTER 3 | Modernize existing .NET apps to Cloud-Op\", \"timized applications\\nRun anywhere\\n\\nWindows Server\\nContainer\\n\\nFigure 4-6. Docker deploys containers a\", \"t all layers of the hybrid cloud\\n\\nTo someone familiar with virtual machines, containers might appear\", \" to be remarkably similar. A\\ncontainer runs an operating system, has a file system, and can be acces\", \"sed over a network, just like a\\nphysical or virtual computer system. However, the technology and con\", \"cepts behind containers are\\nvastly different from virtual machines. From a developer point of view, \", \"a container must be treated\\nmore like a single process. In fact, a container has a single entry poin\", \"t for one process.\\n\\nDocker containers (for simplicity, containers) can run natively on Linux and Win\", \"dows. When running\\nregular containers, Windows containers can run only on Windows hosts (a host serv\", \"er or a VM), and\\nLinux containers can run only on Linux hosts. However, in recent versions of Window\", \"s Server and\\nHyper-V containers, a Linux container can also run natively on Windows Server by using \", \"the Hyper-V\\nisolation technology that currently is available only in Windows Server Containers.\\n\\nIn \", \"the near future, mixed environments that have both Linux and Windows containers will be possible\\nand\", \" even common.\\n\\nBenefits of Windows Containers for your existing .NET applications\\n\\nThe benefits of u\", \"sing Windows Containers are fundamentally the same benefits you get from\\ncontainers in general. Usin\", \"g Windows Containers is about greatly improving agility, portability, and\\ncontrol.\\n\\nExisting .NET ap\", \"plications refer to those applications that were created using the .NET Framework. For\\nexample, they\", \" might be traditional ASP.NET web applications-they don\\u2019t use .NET Core or .NET 5+,\\nwhich is newer a\", \"nd runs cross-platform on Linux, Windows, and MacOS.\\n\\nThe main dependency in the .NET Framework is W\", \"indows. It also has secondary dependencies, like IIS,\\nand System.Web in traditional ASP.NET.\\n\\nA .NET\", \" Framework application must run on Windows, period. If you want to containerize existing .NET\\nFramew\", \"ork applications and you can\\u2019t or don\\u2019t want to invest in a migration to .NET Core or later(\\u201cIf it\\n\\n\", \"21 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\nworks properly, don't mi\", \"grate it\\u201d), the only choice you have for containers is to use Windows\\nContainers.\\n\\nSo, one of the ma\", \"in benefits of Windows Containers is that they offer you a way to modernize your\\nexisting .NET Frame\", \"work applications that are running on Windows-through containerization.\\nUltimately, Windows Containe\", \"rs gets you the benefits that you are looking for by using containers-\\nagility, portability, and bet\", \"ter control.\\n\\nChoose an OS to target with .NET-based containers\\n\\nGiven the diversity of operating sy\", \"stems that are supported by Docker, as well as the differences\\nbetween .NET Framework and .NET Core,\", \" you should target a specific OS and specific versions based\\non the framework you are using.\\n\\nFor Wi\", \"ndows, you can use Windows Server Core or Windows Nano Server. These Windows versions\\nprovide differ\", \"ent characteristics (like IIS versus a self-hosted web server like Kestrel) that might be\\nneeded by \", \".NET Framework or .NET applications.\\n\\nFor Linux, multiple distros are available and supported in off\", \"icial .NET Docker images (like Debian).\\n\\nFigure 4-7 shows OS versions that you can target, depending\", \" on the app\\u2019s version of the .NET\\nFramework.\\n\\nWhat OS to target with .NET containers\\n\\nCompatible wit\", \"h\\n\\nExisting \\u2018NET Framework Windows existing apps\\nIIS\\n\\n-NET\\n\\napps 3.5, 4.x Server Core\\n\\nLarger Image\\n\", \"\\nCloud Optimized,\\nWindows Container OS\\nKestrel\\n\\nNano Server Smaller, Faster Start\\nTime\\n\\nDebian, Alpi\", \"ne, etc.\\nKestrel\\n\\nSmaller, Faster Start\\nTime\\n\\nFigure 4-7. Operating systems to target based on .NET \", \"Framework version\\n\\nIn migration scenarios for existing or legacy applications that are based on .NET\", \" Framework\\napplications, the main dependencies are on Windows and IIS. Your only option is to use Do\", \"cker\\nimages based on Windows Server Core and the .NET Framework.\\n\\nWhen you add the image name to you\", \"r Dockerfile file, you can select the operating system and\\nversion by using a tag, as in the followi\", \"ng examples for .NET Framework-based Windows container\\nimages:\\n\\n22 CHAPTER 3 | Modernize existing .N\", \"ET apps to Cloud-Optimized applications\\nmcr.microsoft.com/dotnet/framework/runti .NET Framework 4.x \", \"on Windows Server Core\\nme:4.x-windowsservercore-20H2\\n\\nmcr.microsoft.com/dotnet/framework/aspne | .NE\", \"T Framework 4.x with additional ASP.NET\\nt:4.x-windowsservercore-20H2 customization, on Windows Serve\", \"r Core\\n\\nFor .NET (cross-platform for Linux and Windows), the tags would look like the following:\\n\\nmc\", \"r.microsoft.com/dotnet/runtime:7.0 .NET runtime-only on Linux\\n\\nmcr.microsoft.com/dotnet/runtime:7.0-\", \" .NET runtime-only on Windows Nano Server\\nnanoserver-Itsc2022\\n\\nMulti-arch images\\n\\nSince 2017, Docker\", \" has had a feature called multi-arch images. .NET Docker images can use multi-arch\\ntags. Your Docker\", \"file files no longer need to define the operating system that you are targeting. The\\nmulti-arch feat\", \"ure allows a single tag to be used across multiple machine configurations. For instance,\\nwith multi-\", \"arch, you can use one common tag: mcr.microsoft.com/dotnet/runtime:7.0. If you pull\\nthat tag from a \", \"Linux container environment, you get the Debian-based image. If you pull that tag\\nfrom a Windows con\", \"tainer environment, you get the Nano Server-based image.\\n\\nFor .NET Framework images, because the tra\", \"ditional .NET Framework supports only Windows, you\\ncannot use the multi-arch feature.\\n\\nWindows conta\", \"iner types\\n\\nLike Linux containers, Windows Server containers are managed by using Docker Engine. Unl\", \"ike Linux\\ncontainers, Windows containers include two different container types, or run times-Windows\", \" Server\\ncontainers and Hyper-V isolation.\\n\\nWindows Server containers: Provides application isolation\", \" through process and namespace isolation\\ntechnology. A Windows Server container shares a kernel with\", \" the container host and all containers\\nthat are running on the host. These containers do not provide\", \" a hostile security boundary and should\\nnot be used to isolate untrusted code. Because of the shared\", \" kernel space, these containers require\\nthe same kernel version and configuration.\\n\\nHyper-V isolatio\", \"n: Expands on the isolation provided by Windows Server Containers by running each\\ncontainer on a hig\", \"hly optimized VM. In this configuration, the kernel of the container host is not\\nshared with other c\", \"ontainers on the same host. These containers are designed for hostile multitenant\\nhosting, with the \", \"same security assurances of a VM. Because these containers don\\u2019t share the kernel\\nwith the host or o\", \"ther containers on the host, they can run kernels with different versions and\\nconfigurations (with s\", \"upported versions). For example, all Windows containers on Windows 10 use\\nHyper-V isolation to utili\", \"ze the Windows Server kernel version and configuration.\\n\\n23 CHAPTER 3 | Modernize existing .NET apps\", \" to Cloud-Optimized applications\\nRunning a container on Windows with or without Hyper-V isolation is\", \" a run-time decision. You might\\nchoose to create the container with Hyper-V isolation initially, and\", \" at run time, choose to run it as a\\nWindows Server container instead.\\n\\nAdditional resources\\n\\n\\u00b0 Windo\", \"ws Containers documentation\\n\\nhttps://learn.microsoft.com/virtualization/windowscontainers/\\n\\n\\u00b0 Window\", \"s Containers fundamentals\\n\\nhttps://learn.microsoft.com/virtualization/windowscontainers/about/\\n\\n\\u00b0 In\", \"fographic: Microsoft and containers\\n\\nhttps://info.microsoft.com/rs/157-GQE-382/images/Container%20in\", \"fographic%201.4.17.pdf\\n\\nThe container ecosystem in Azure\\n\\nIn previous sections, it's been explained \", \"what the benefits of Docker containers are as well as details\\non the specific container images for .\", \"NET applications. All that generic information is fundamental in\\norder to develop or containerize an\", \" application. However, when thinking about the production\\ndeployment environment or even QA and Dev/\", \"Test environments, Microsoft Azure provides an open\\nand broad variety of choices, a full container e\", \"cosystem in the cloud (shown in the diagram below).\\nDepending on your specific application\\u2019s needs, \", \"you should choose one or another Azure product.\\n\\n24 CHAPTER 3 | Modernize existing .NET apps to Clou\", \"d-Optimized applications\\nAzure container ecosystem\\n\\nAzure\\nContainer\\n\\nApp Service\\n\\nRegistry\\n(ACR)\\n\\nse\", \"ed\\n\\nPartner services Azure services\\n\\nOpenShift is: SQL Database souk\\nAzure Kubernetes Service Fabric\", \" Batch\\n\\nService (AKS)\\n\\nPivotal Cloud Redis Cache\\n\\nFoundry B\\n\\n; +\\nDocker Enterprise CosmosDB TF Virtu\", \"al kubelet\\n\\nEdition ns ;\\n\\nh Azure Container Virtual Machine\\nMesosphere And more! Instances (ACI) Vir\", \"tual Machines Scale Sets (VMSS)\\nDC/OS & OY\\n\\nw a\\n\\nFigure 4-7.5. The container ecosystem in Azure\\n\\nsee\", \"|\\n\\n;\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n\\nFrom the container ecosystem in Azure, the following products supporti\", \"ng containers that are\\nconsidered infrastructure:\\n\\n\\u00b0 Azure Container Instances (ACI)\\n. Azure Virtual\", \" Machines (With container\\u2019s support)\\n. Azure Virtual Machine Scale Sets (With container\\u2019s support)\\nF\", \"rom those three, ACI provides a great benefit, which is the fact that you don\\u2019t need to maintain the\", \"\\n\\nunderlying OS, no need for you to upgrade/patch, etc. but ACI still is positioned in the infrastru\", \"cture\\nlevel, as better explained in the upcoming sections of this book.\\n\\nThe products in Azure suppo\", \"rting containers that are at the same time positioned more in the PaaS\\n(Platform as a Service) level\", \" are:\\n\\n. Azure App Service\\n\\u00b0 Azure Kubernetes Service (AKS and ACS)\\n\\u00b0 Azure Batch\\n\\nThen, Azure Conta\", \"iner Registry is a high scalable container registry hosted in Azure that you can use\\nfrom all the pr\", \"evious products when registering and deploying your custom container images.\\n\\nIn addition, from your\", \" containers, you can consume other managed services in Azure like Azure SQL\\nDatabase, Azure Redis ca\", \"che, Azure Cosmos DB, etc. plus there are third-party solutions/platforms\\n\\n25 CHAPTER 3 | Modernize \", \"existing .NET apps to Cloud-Optimized applications\\navailable in Azure Marketplace like Cloud Foundry\", \" and OpenShift where you can also use containers\\nwithin Azure.\\n\\nIn the next sections, you can explor\", \"e Microsoft's recommendations on when to use each of those\\nAzure products and solutions specifically\", \" when targeting Windows Containers.\\n\\nWhen not to deploy to Windows Containers\\n\\nSome Windows technolo\", \"gies are not supported by Windows Containers. In those cases, you still need\\nto migrate to the stand\", \"ards VMs, usually with just Windows and IIS.\\n\\nFor more information, see the list of Applications not\", \" supported by Windows containers.\\n\\nAdditional resources\\n\\n\\u00b0 Virtual machines and containers in Azure\\n\", \"\\nhttps://azure.microsoft.com/overview/containers/\\n\\nWhen to deploy Windows Containers in your on-\\npre\", \"mises laaS VM infrastructure\\n\\n. Your organization might not be ready to move to the cloud, or it mig\", \"ht not be able to move\\nto the cloud for a business reason. But, you can still get the benefits of us\", \"ing Windows\\nContainers in your own datacenters.\\n\\n. You might have other artifacts that are being use\", \"d on-premises, and which might slow you\\ndown when you try to move to the cloud. For example, securit\", \"y or authentication\\ndependencies with on-premises Windows Server Active Directory, or any other on-p\", \"remises\\nasset.\\n\\n. If you start using Windows Containers today, you can make a phased migration to th\", \"e cloud\\ntomorrow from a much better position. Windows Containers is becoming a unit of\\ndeployment fo\", \"r any cloud, with no lock-in.\\n\\nWhen to deploy Windows Containers to Azure VMs\\n(laaS cloud)\\n\\nIf your \", \"organization Is using Azure VMs, even if you are also using Windows Containers, you are still\\ndealin\", \"g with laaS. That means that dealing with infrastructure operations, VM OS patches, and\\ninfrastructu\", \"re complexity for highly scalable applications when you need to deploy to multiple VMs in\\na load-bal\", \"anced infrastructure. The main scenarios for using Windows Containers in an Azure VM are:\\n\\n\\u00b0 Dev/tes\", \"t environment: A VM in the cloud is perfect for development and testing in the\\ncloud. You can rapidl\", \"y create or stop the environment depending on your needs.\\n\\n26 CHAPTER 3 | Modernize existing .NET ap\", \"ps to Cloud-Optimized applications\\n. Small and medium scalability needs: In scenarios where you migh\", \"t need just a couple of\\nVMs for your production environment, managing a few VMs might be affordable \", \"until you\\ncan move to more advanced PaaS environments, like orchestrators.\\n\\n. Production environment\", \" with existing deployment tools: You might be moving from an\\non-premises environment in which you ha\", \"ve invested in tools to make complex deployments\\nto VMs or bare-metal servers (like Puppet or simila\", \"r tools). To move to the cloud with minimal\\nchanges to production environment deployment procedures,\", \" you might continue to use\\nthose tools to deploy to Azure VMs. However, you'll want to use Windows C\", \"ontainers as the\\nunit of deployment to improve the deployment experience.\\n\\nWhen to deploy Windows Co\", \"ntainers to Azure\\nContainer Instances (ACI)\\n\\nThe main value proposition of Azure Container Instances\", \" is that you can right away deploy containers\\nto it and you don't need to maintain that environment,\", \" you don\\u2019t need to upgrade/patch the\\nunderlying operating system or VMs, all that is transparent and\", \" you just deploy containers into a\\nready-to-use environment.\\n\\nThe reasons and scenarios when you wou\", \"ld want to use ACI are similar to the main scenarios when\\nyou use Azure VMs with containers, so basi\", \"cally, the main scenarios for using Azure Container\\nInstances are:\\n\\n. Dev/Test scenarios\\n\\n\\u00b0 Task aut\", \"omation\\n\\n\\u00b0 CI/CD agents\\n\\n\\u00b0 Small/scale batch processing\\n\\n. Simple web apps\\n\\nThe simple web apps scen\", \"ario is a fair scenario for ACI but take into account that since in ACI you can\\nonly have a single c\", \"ontainer instance per container image, you won't have high availability and only\\nhave limited scalab\", \"ility.\\n\\nHowever, even when ACI is considered infrastructure because it just provides single containe\", \"r\\ninstances, there is a huge benefit compared to regular Azure VMs with Windows Server. With ACI, yo\", \"u\\njust deploy the containers into a self-maintained environment and you just pay for those container\", \"s.\\nYou don't need to maintain/update/patch VMs, so it is a much better platform for most scenarios\\nw\", \"here you might be using VMs with containers. Using ACI is straight forward, you just deploy a\\ncontai\", \"ner, there's no need to create a VM environment you just deploy containers.\\n\\nThe main benefits of Az\", \"ure Container Instances (ACI) are:\\n\\n. Run containers without managing servers\\n\\n\\u00b0 Increase agility wi\", \"th containers on demand\\n\\n. Deploy containers to the cloud with unprecedented simplicity and soeed\\u2014wi\", \"th a single\\ncommand.\\n\\n27 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n\\u00b0 \", \"Secure applications with hypervisor isolation\\n\\nIn short, with ACI you can develop apps fast without \", \"managing virtual machines or having to learn\\nnew tools. It\\u2019s just your application, in a container, \", \"running in the cloud.\\n\\nWhen to deploy Windows Containers to Azure\\nKubernetes Service (AKS)\\n\\nAzure Ku\", \"bernetes Service (AKS) simplifies deploying a managed Kubernetes cluster in Azure by\\noffloading the \", \"operational overhead to Azure. You get an open solution that offers portability both for\\nyour contai\", \"ners and for your application configuration. You select the size, the number of hosts, and\\nthe orche\", \"strator tools. Azure Kubernetes Service handles the infrastructure for you. It also supports\\nWindows\", \" Server containers alongside Linux containers. For more details on Windows OS support and\\nthe featur\", \"e differences between Windows and Linux, read the FAQ.\\n\\nThe main benefits of Azure Kubernetes Servic\", \"e (AKS) are:\\n\\n. Identity and security management\\n\\n. Integrated logging and monitoring\\n\\n\\u00b0 Cluster nod\", \"e and pod scaling.\\n\\n\\u00b0 Ingress with HTTP application routing\\n\\n. AKS supports the Docker image format.\", \" For private storage of your Docker images, you can\\nintegrate AKS with Azure Container Registry (ACR\", \").\\n\\nIf you are already working with open-source orchestrators like Kubernetes, Docker Swarm, or DC/O\", \"S,\\nyou don't need to change your existing management practices to move container workloads to the\\ncl\", \"oud. Use the application management tools that you're already familiar with and connect via the\\nstan\", \"dard API endpoints for the orchestrator of your choice.\\n\\nChoosing Azure compute platforms for contai\", \"ner-\\nbased applications\\n\\nAs you have noticed after reading the previous sections, Azure is an open c\", \"loud that offers multiple\\nchoices. You can use the best fit for your needs, however, it also surface\", \"s questions about what\\nproduct/technology you should use for your containerized applications.\\n\\nAs a \", \"by-default recommendation, the following is the main criteria recommended in this guidance:\\n\\n. Singl\", \"e monolithic app: Choose Azure App Service\\n\\n. N-Tier app: Choose orchestrators such as Azure Kuberne\", \"tes Service (AKS) or App Service if\\nyou have a single or a few back-end services\\n\\n. Microservices: C\", \"hoose AKS or Azure Web Apps for Containers\\n\\u00b0 Serverless functions & event handlers: Choose Azure Fun\", \"ctions\\n\\n\\u00b0 Large-scale Batch: Choose Azure Batch\\n\\n28 CHAPTER 3 | Modernize existing .NET apps to Clou\", \"d-Optimized applications\\nHowever, this recommendation should be taken with a pinch of salt, as the p\", \"roduct's selection will\\ndepend on your specific application's needs and characteristics. Not all app\", \"lications are the same even\\nwhen initially they might look similar types.\\n\\nAfter a deeper analysis o\", \"f the application's needs, the product selected could be different. But, as a\\nStarting point, it is \", \"good to have initial guidance from where you can start evaluating and testing\\nbased on certain prior\", \"ity.\\n\\nAdditional resources\\n\\n\\u00b0 Choose an Azure compute service for your application\\n\\nBuild resilient \", \"services ready for the cloud: Embrace\\ntransient failures in the cloud\\n\\nResiliency is the ability to \", \"recover from failures and continue to function. Resiliency is not about\\navoiding failures, but accep\", \"ting the fact that failures will occur, and then responding to them in a way\\nthat avoids downtime or\", \" data loss. The goal of resiliency is to return the application to a fully\\nfunctioning state after a\", \" failure.\\n\\nYour application is ready for the cloud when, at a minimum, it implements a software-base\", \"d model of\\nresiliency, rather than a hardware-based model. Your cloud application must embrace the p\", \"artial\\nfailures that will certainly occur. Design or partially refactor your application to achieve \", \"resiliency with\\nexpected partial failures. It should be designed to cope with partial failures, like\", \" transient network\\noutages and nodes, or VMs crashing in the cloud. Even containers being moved to a\", \" different node\\nwithin an orchestrator cluster can cause intermittent short failures within the appl\", \"ication.\\n\\nHandling partial failure\\n\\nIn a cloud-based application, there\\u2019s an ever-present risk of pa\", \"rtial failure. For instance, a single\\nwebsite instance or a container might fail, or it might be una\", \"vailable or unresponsive for a short time.\\nOr, a single VM or server might crash.\\n\\nBecause clients a\", \"nd services are separate processes, a service might not be able to respond in a timely\\nmanner to a c\", \"lient's request. The service might be overloaded and respond slowly to requests, or it\\nmight not be \", \"accessible for a short time because of network issues.\\n\\nFor example, consider a monolithic .NET appl\", \"ication that accesses a database in Azure SQL Database.\\nIf the Azure SQL database or any other third\", \"-party service is unresponsive for a brief time (an Azure\\nSQL database might be moved to a different\", \" node or server, and be unresponsive for a few seconds),\\nwhen the user tries to do any action, the a\", \"pplication might crash and show an exception at the same\\nmoment.\\n\\n29 CHAPTER 3 | Modernize existing \", \".NET apps to Cloud-Optimized applications\\nA similar scenario might occur in an app that consumes HTT\", \"P services. The network or the service\\nitself might not be available in the cloud during a short, tr\", \"ansient failure.\\n\\nA resilient application like the one shown in Figure 4-9 should implement techniqu\", \"es like \\u201cretries with\\nexponential backoff\\u201d to give the application an opportunity to handle transien\", \"t failures in resources.\\nYou also should use \\u201ccircuit breakers\\u201d in your applications. A circuit brea\", \"ker stops an application from\\ntrying to access a resource when it's actually a long-term failure. By\", \" using a circuit breaker, the\\napplication avoids provoking a denial of service to itself.\\n\\nResilient\", \" communication in cloud applications\\n\\nASP.NET app (MVC or WebForms) on ASP.NET Web API or WCF on SQL\", \" database\\nWindows Server Core Container Windows Server Core Container\\n\\nHTTP\\nP|\\nASPNET app aay\\nHTTP r\", \"etries TCP retries\\nwith exponential backoff with exponential backoff\\nand Circuit Breaker and Circuit\", \" Breaker\\n\\nFigure 4-9. Partial failures handled by retries with exponential backoff\\n\\nYou can use thes\", \"e techniques both in HTTP resources and in database resources. In Figure 4-9, the\\napplication is bas\", \"ed on a 3-tier architecture, so you need these techniques at the services level (HTTP)\\nand at the da\", \"ta tier level (TCP). In a monolithic application that uses only a single app tier in addition\\nto the\", \" database (no additional services or microservices), handling transient failures at the database\\ncon\", \"nection level might be enough. In that scenario, just a particular configuration of the database\\ncon\", \"nection Is required.\\n\\nWhen implementing resilient communications that access the database, depending\", \" on the version of\\n.NET you are using, it can be straightforward (for example, with Entity Framework\", \" 6 or later. It's just a\\nmatter of configuring the database connection). Or, you might need to use a\", \"dditional libraries like the\\nTransient Fault Handling Application Block (for earlier versions of .NE\", \"T), or even implement your own\\nlibrary.\\n\\nWhen implementing HTTP retries and circuit breakers, the re\", \"commendation for .NET is to use the\\nPolly library, which targets .NET Standard 1.1 (coverage: .NET C\", \"ore 1.0, Mono, Xamarin, UWP, WP8.1 +)\\nand .NET Standard 2.0+ (coverage: .NET Core 2.0+, .NET Core 3.\", \"0 and later, Mono, Xamarin and UWP\\ntargets). The nuget package also includes direct targets for .NET\", \" Framework 4.6.1 and 4.7.2.\\n\\nTo learn how to implement strategies for handling partial failures in t\", \"he cloud, see the following\\nreferences.\\n\\nAdditional resources\\n\\n\\u00b0 Implementing resilient communicatio\", \"n to handle partial failure\\n\\n30 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applicat\", \"ions\\napplications/partial-failure-strategies\\n\\n\\u00b0 Entity Framework connection resiliency and retry log\", \"ic (version 6 and later)\\nhttps://learn.microsoft.com/et/ef6/fundamentals/connection-resiliency/retry\", \"-logic\\n\\u00b0 The Transient Fault Handling Application Block\\n\\n\\u00b0 https://learn.microsoft.com/previous-vers\", \"ions/msp-n-p/hh680934(v=pandp.50\\n\\n\\u00b0 Polly library for resilient HTTP communication\\n\\nhttps://github.c\", \"om/App-vNext/Polly\\n\\nModernize your apps with monitoring and telemetry\\n\\nWhen you run an application i\", \"n production, it\\u2019s critical that you have insights about how your\\napplication is performing. Is it p\", \"erforming at a high level? Are users getting errors, or is the application\\nstable and reliable? You \", \"need rich performance monitoring, powerful alerting, and dashboards to help\\nensure that your applica\", \"tion is available and performing as expected. You also need to be able to see\\nquickly if there\\u2019s a p\", \"roblem, determine how many customers are affected, and perform a root-cause\\nanalysis to find and fix\", \" the issue.\\n\\nMonitor your application with Application Insights\\n\\nApplication Insights is an extensib\", \"le Application Performance Management (APM) service for web\\ndevelopers who work on multiple platform\", \"s. Use it to monitor your live web application. Application\\nInsights automatically detects performan\", \"ce anomalies. It includes powerful analytics tools to help you\\ndiagnose issues, and to help you unde\", \"rstand what users actually do with your app. Application\\nInsights is designed to help you continuous\", \"ly improve performance and usability. It works for apps on\\na wide variety of platforms, including .N\", \"ET, Node.js, and J2EE, whether hosted on-premises or in the\\ncloud. Application Insights integrates w\", \"ith your DevOps processes, and has connection points to\\nvarious development tools.\\n\\nFigure 4-10 show\", \"s an example of how Application Insights monitors your application and how it\\nsurfaces those insight\", \"s to a dashboard.\\n\\n31 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\n@ myp\", \"ackagesearch\\n\\nEssenizls ~\\n\\n; CUENT PROCRZoRe T... I\\nApplication haath 346.88 ns\\nCherie\\u2019 tinea MD BEQ\", \"UEST Tear @\\nWAT\\nBECHVING HERE\\nTis\\nPAE LOAD META\\n\\n217.25 ms\\n\\nWPVIF RePoee Te i SRM EEGPCGE TRE\\n\\n57.16\", \" m \\u2014 Vo webs\\n\\nee\\n\\nGROVER, PARE LAD.\\n\\na263=| AA A AAD A lt\\n\\nAwerage of browser page load time by wel \", \"base\\nMEV REQUESTS\\n| 59 UR, ma AWE RACE\\n\\nFARE RQ!\\niA\\n\\nTotal of braver excep iain. bry proider ici\\nPRE\", \"LE A 1D \\u2018THEE Ad POR\\n\\n[freetScopedaprog) bitipe ferro anguil.. Po 2 OOS\\n\\nFigure 4-10. Application In\", \"sights monitoring dashboard\\n\\nis part of the _ It's also a service in\\n. Log Analytics monitors cloud \", \"and on-premises environments\\n(OMS for on-premises) to help maintain availability and performance. It\", \" collects data generated by\\nresources in your cloud and on-premises environments and from other moni\", \"toring tools to provide\\nanalysis across multiple sources.\\n\\nIn relation to Azure infrastructure logs,\", \" Log Analytics, as an Azure service, ingests log and metric data\\nfrom other Azure services (via ), A\", \"zure VMs, Docker containers, and on-premises or\\nother cloud infrastructures. Log Analytics offers fl\", \"exible log search and out-of-the box analytics on top\\nof this data. It provides rich tools that you \", \"can use to analyze data across sources, it allows complex\\nqueries across all logs, and it can proact\", \"ively alert based on specified conditions. You can even collect\\ncustom data in the central Log Analy\", \"tics repository, where you can query and visualize it. You can also\\ntake advantage of the Log Analyt\", \"ics built-in solutions to immediately gain insights into the security\\nand functionality of your infr\", \"astructure.\\n\\nYou can access Log Analytics through the OMS portal or the Azure portal, which run in a\", \"ny browser,\\nand provide you with access to configuration settings and multiple tools to analyze and \", \"act on\\ncollected data.\\n\\nThe in Log Analytics helps you view and manage your Docker and\\nWindows Conta\", \"iner hosts in a single location. The solution shows which containers are running, what\\ncontainer ima\", \"ge they're running, and where containers are running. You can view detailed audit\\ninformation, inclu\", \"ding commands that are being used with containers. You can also troubleshoot\\ncontainers by viewing a\", \"nd searching centralized logs, without needing to remotely view Docker or\\nWindows hosts. You can fin\", \"d containers that might be noisy and consuming excess resources On a\\nhost. Additionally, you can vie\", \"w centralized CPU, memory, storage, and network usage, and\\nperformance information, for containers. \", \"On computers running Windows, you can centralize and\\ncompare logs from Windows Server, Hyper-V, and \", \"Docker containers. The solution supports the\\nfollowing container orchestrators:\\n\\n\\u00b0 Docker Swarm\\n\\u00b0 DC\", \"/OS\\n\\u00b0 Kubernetes\\n\\n. Red Hat OpenShift\\n\\nFigure 4-11 shows the relationships between various container\", \" hosts and agents and OMS.\\n\\njy DO.\\nois nl a\\n| Ob Op\\nwe! | Azure Azure\\n. VM with agent } Service Fabr\", \"ic Container Service\\nAzure Container | & pc/0s s'\\n\\nMonitoring\\n\\nie A) \\u2014\\nRL\\n\\n\\\\ VM with agent / VM with\", \" agent | MA\\n\\nOPENSHIFT\\n\\nPortal\\nAzure\\nFigure 4-117. Log Analytics Container Monitoring solution\\nYou c\", \"an use the Log Analytics Container Monitoring solution to:\\n\\u00b0 See information about all container hos\", \"ts in a single location.\\n\\u00b0 Know which containers are running, what image they're running, and where \", \"they're running.\\n\\n\\u00b0 See an audit trail for actions on containers.\\n\\n. Troubleshoot by viewing and sea\", \"rching centralized logs without remote login to the Docker\\nhosts.\\n\\n. Find containers that might be \\u201c\", \"noisy neighbors,\\u201d and be consuming excess resources on a\\nhost.\\n\\n33 CHAPTER 3 | Modernize existing .N\", \"ET apps to Cloud-Optimized applications\\n. View centralized CPU, memory, storage, and network usage, \", \"and performance information, for\\ncontainers.\\n\\nAdditional resources\\n\\n\\u00b0 Overview of monitoring in Micr\", \"osoft Azure\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/overview\\n\\u00b0 What is Application Insights\", \"?\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/a app-insights-overview\\n\\n. What is Log Analytics?\", \"\\nhttps://learn.microsoft.com/azure/log-analytics/log-analytics-overview\\n\\u00b0 Container Monitoring solut\", \"ion in Azure Monitor\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/insights/containers\\n\\n\\u00b0 Overvie\", \"w of Azure Monitor\\n\\nhttps://learn.microsoft.com/azure/azure-monitor/overview\\n\\u00b0 What is Operations Ma\", \"nagement Suite (OMS)?\\n\\nhttps://learn.microsoft.com/azure/operations-management-suite/operations-mana\", \"gement-suite-\\n\\noverview\\n\\nModernize your app\\u2019s lifecycle with CI/CD pipelines\\nand DevOps tools in the\", \" cloud\\n\\nToday\\u2019s businesses need to innovate at a rapid pace to be competitive in the marketplace. De\", \"livering\\nhigh-quality, modern applications requires DevOps tools and processes that are critical to \", \"implement\\nthis constant cycle of innovation. With the right DevOps tools, developers can streamline \", \"continuous\\ndeployment and get innovative applications into the hands of users more quickly.\\n\\nAlthoug\", \"h continuous integration and deployment practices are well established, the introduction of\\ncontaine\", \"rs introduces new considerations, particularly when you are working with multi-container\\napplication\", \"s.\\n\\nAzure DevOps Services supports continuous integration and deployment of multi-container\\napplicat\", \"ions to various environments through the official Azure DevOps Services deployment tasks:\\n\\n\\u00b0 Deploy \", \"to an Azure Web App for Containers\\n\\n\\u00b0 Deploy to Azure Kubernetes Service\\n\\nBut you can also deploy to\", \" Docker Swarm or DC/OS by using Azure DevOps Services script-based\\ntasks.\\n\\n34 CHAPTER 3 | Modernize \", \"existing .NET apps to Cloud-Optimized applications\\nTo continue facilitating deployment agility, thes\", \"e tools provide excellent dev-to-test-to-production\\ndeployment experiences for container workloads, \", \"with a choice of development and CI/CD solutions.\\n\\nFigure 4-12 shows a continuous deployment pipelin\", \"e that deploys to a Kubernetes cluster in Azure\\nContainer Service.\\n\\nBuilds Releases Library Task Gro\", \"ups Deployment Groups*\\n\\nAll definitions > eShopModernizingMVC-Kubernetes-PROD-ENV\\n\\nPipeline Tasks ~ \", \"Variables Retention Options \\u2014 History\\n\\nPROD eShopModernizing Kubernetes\\n\\neplaymnent proc Deploy to K\", \"ubernetes \\u00a9 * Remove\\nVersion o* v\\n\\nAgent phase +\\n\\n& Run en agent\\nDisplay name *\\n\\non Deploy SQL conta\", \"iner\\n\\nDeploy to Kubemetes Deploy MVC app container\\nS Deploy MVC app container @ 3 Kubernetes Service\", \" Connection @ | Manage 2\\ntes =\\n\\nDeploy to Kubemet\\n\\nPROD Kubernetes Conn Prod Environment v () + New\\n\", \"S Refresh MVC pod\\n\\nDeploy to Kubemetes\\n\\nContainer Registry Details ~\\n\\nContainer Registry type * @\\n\\nC\", \"ontainer Registry v\\n\\nDocker Registry Connection @ | Manage\\n\\ncesard|@DockerHub v ro) + New\\n\\nFigure 4-\", \"12. Azure DevOps Services continuous deployment pipeline, deploying to a Kubernetes cluster\\n\\nMigrate\", \" to hybrid cloud scenarios\\n\\nSome organizations and enterprises can't migrate some of their applicati\", \"ons to public clouds like\\nMicrosoft Azure or any other public cloud due to regulations or their own \", \"policies. However, it\\u2019s likely\\nthat any organization might benefit from having some of their applica\", \"tions in the public cloud and\\nother applications on-premises. But a mixed environment can lead to ex\", \"cessive complexity in\\nenvironments due to different platforms and technologies used in public clouds\", \" versus on-premises\\nenvironments.\\n\\nMicrosoft provides the best hybrid cloud solution, one in which y\", \"ou can optimize your existing assets\\non-premises and in the public cloud, while you ensure consisten\", \"cy in an Azure hybrid cloud. You can\\nmaximize existing skills, and get a flexible, unified approach \", \"to building apps that can run in the cloud\\nor on-premises, thanks to Azure Stack (on-premises) and A\", \"zure (public cloud).\\n\\nWhen it comes to security, you can centralize management and security across y\", \"our hybrid cloud. You\\ncan get control over all assets, from your datacenter to the cloud, by providi\", \"ng single sign-on to on-\\npremises and cloud apps. You accomplish this functionality by extending Act\", \"ive Directory to a hybrid\\ncloud, and by using identity management.\\n\\nFinally, you can distribute and \", \"analyze data seamlessly, use the same query languages for cloud and\\non-premises assets, and apply an\", \"alytics and deep learning in Azure to enrich your data, regardless of\\nits source.\\n\\nAzure Stack\\n\\nAzur\", \"e Stack is a hybrid cloud platform that lets you deliver Azure services from your organization's\\ndat\", \"acenter. Azure Stack is designed to support new options for your modern applications in key\\n\\n35 CHAP\", \"TER 3 | Modernize existing .NET apps to Cloud-Optimized applications\\nscenarios, like edge and unconn\", \"ected environments, or meeting specific security and compliance\\nrequirements.\\n\\nFigure 4-13 shows an \", \"overview of the true hybrid cloud platform that Microsoft offers.\\n\\nMicrosoft's hybrid cloud platform\", \"\\n\\nPower of Azure in your datacenter\\n\\na a\\n\\nPortal | PowerShell | Dev-ops tools Portal | PowerShell | \", \"Dev-ops tools\\n\\nAzure Resource Manager y Azure Resource Manager\\n\\nAzure laaS | Azure PaaS\\ntice\\u2019) | Sto\", \"r acre\\n\\nAzure laaS | Azure PaaS\\n\\nCloucd infrastructure Cloud-insoired infrastructure\\n\\nMicrosoft Azur\", \"e Microsoft Azure Stack\\n\\nPublic Private | Hosted\\n\\nFigure 4-13. Microsoft hybrid cloud platform with \", \"Azure Stack and Azure\\n\\nAzure Stack is offered in two deployment options, to meet your needs:\\n\\n. Azur\", \"e Stack integrated systems\\n\\n. Azure Stack Development Kit\\n\\nAzure Stack integrated systems\\n\\nAzure Sta\", \"ck integrated systems are offered through a partnership of Microsoft and hardware partners.\\nThe part\", \"nership creates a solution that offers cloud-paced innovation that is balanced with simplicity\\nin ma\", \"nagement. Because Azure Stack is offered as an integrated system of hardware and software,\\nyou get t\", \"he right amount of flexibility and control, while still adopting innovation from the cloud.\\nAzure St\", \"ack integrated systems range in size from 4 to 12 nodes, and are jointly supported by the\\nhardware p\", \"artner and Microsoft. Use Azure Stack integrated systems to implement new scenarios for\\nyour product\", \"ion workloads.\\n\\nAzure Stack Development Kit\\n\\nMicrosoft Azure Stack Development Kit is a single-node \", \"deployment of Azure Stack, which you can\\nuse to evaluate and learn about Azure Stack. You can also u\", \"se Azure Stack Development Kit as a\\n\\n36 CHAPTER 3 | Modernize existing .NET apps to Cloud-Optimized \", \"applications\\ndeveloper environment, where you can develop using APIs and tooling that are consistent\", \" with Azure.\\nAzure Stack Development Kit is not intended to be used as a production environment.\\n\\nAd\", \"ditional resources\\n\\n37\\n\\nAzure hybrid cloud\\nhttps://azure.microsoft.com/overview/hybrid-cloud/\\n\\nAzure\", \" Stack\\n\\nhttps://azure.microsoft.com/overview/azure-stack/\\n\\nActive Directory Service Accounts for Win\", \"dows Containers\\n\\nhttos://learn.microsoft.com/virtualization/windowscontainers/manage-containers/mana\", \"ge-\\n\\nserviceaccounts\\n\\nCreate a container with Active Directory support\\n\\nhttos://learn.microsoft.com/\", \"archive/blogs/containerstuff/create-a-container-with-active-\\n\\ndirectory-support\\n\\nAzure Hybrid Benefi\", \"t licensing\\n\\nhttps://azure.microsoft.com/pricing/hybrid-benefit/\\n\\nCHAPTER 3 | Modernize existing .NE\", \"T apps to Cloud-Optimized applications\\nCHAPTER |\\n\\nWalkthrougns and\\ntecnnical get started\\noverview\\n\\nT\", \"o limit the size of this e-book, additional technical documentation and the full walkthroughs were\\nm\", \"ade available in a GitHub repository. The online series of walkthroughs that is described in this\\nch\", \"apter covers the step-by-step setup of the multiple environments that are based on Windows\\nContainer\", \"s, and deployment to Azure.\\n\\nThe following sections explain what each walkthrough is about, its obje\", \"ctives and high-level vision,\\nand provides a diagram of the tasks that are involved. You can get the\", \" walkthroughs themselves in the\\n\\neShopModernizing apps GitHub repo wiki at https://github.com/dotnet\", \"-\\narchitecture/eShopModernizing/wiki.\\n\\nTechnical walkthrough list\\n\\nThe following get-started walkthr\", \"oughs provide consistent and comprehensive technical guidance for\\nsample apps that you can lift and \", \"shift by using containers, and then move by using multiple\\ndeployment choices in Azure.\\n\\nEach of the\", \" following walkthroughs uses the new sample eShopLegacy and eShopModernizing apps,\\n\\nwhich are availa\", \"ble on GitHub at https://github.com/dotnet-architecture/eShopModernizing.\\n\\n. Tour of eShop legacy ap\", \"ps (baseline apps to modernize)\\n\\n. Containerize your existing ASP.NET web apps (WebForms & MVC) with\", \" Windows\\nContainers\\n\\n\\u00b0 Containerize your existing WCF services (N-Tier apps) with Windows Containers\", \"\\n. Deploy your Windows Containers-based app to Azure VMs\\n\\n. Deploy your Windows Containers-based app\", \"s to Kubernetes in Azure Container Service\\n\\n38 CHAPTER 4 | Walkthroughs and technical get started ov\", \"erview\\nWalkthrough 1: Tour of eShop legacy apps\\n\\nTechnical walkthrough availability\\n\\nThe full techni\", \"cal walkthrough is available in the eshopModernizing GitHub repo wiki:\\n\\neShopModernizing wiki walkth\", \"roughs\\n\\nOverview\\n\\nIn this walkthrough, you can explore the initial implementation of three sample le\", \"gacy applications.\\nThe first two sample web apps have a monolithic architecture, and were created by\", \" using classic\\nASP.NET. One application is based on ASP.NET 4.x MVC; the second application is based\", \" on ASP.NET\\n4.x Web Forms. The third app is a 3-Tier app composed by a client WinForms app and a ser\", \"ver-side\\n\\nWindows Communication Foundation (WCF) service.\\nAll these applications are available at th\", \"e eshopModernizing GitHub repo.\\n\\nGoals\\n\\nThe main goal of this walkthrough Is simply to get familiar \", \"with these apps, and with their code and\\nconfiguration. You can configure the apps so that they gene\", \"rate and use mock data, without using the\\nSQL database, for testing purposes. This optional config i\", \"s based on dependency injection, in a\\ndecoupled way.\\n\\nScenario 1: ASP.NET Web apps\\n\\nThe figure below\", \" shows the simple scenario of the original legacy ASP.NET web applications.\\n\\n39 CHAPTER 4 | Walkthro\", \"ughs and technical get started overview\\nA Browser with Mock\\n. MVC app Windows Server | data\\nHS\\neShop\", \"\\nProduct\\nCatalog\\ndatabase\\nASP.NET MVC SQL Server\\napp\\nB Browser with\\n\\u00b0 Web Forms app Windows Server\\n-\", \" lS | eShop\\n= Product\\na: Catalog\\nG database\\nr 7 ASP.NET ig Forms te) Server\\n\\n[evn\\n\\nFrom a business d\", \"omain perspective, both apps offer the same catalog management features.\\nMembers of the eShop enterp\", \"rise team would use the app to view and edit the product catalog.\\n\\nThe next figure shows the initial\", \" app screenshots.\\n\\n(e] SACONTAINERS\\n\\n\\u00a2 ! \\\" '\\nGatalogiediior FA (ASP.MET 4.x MVC) Catalog editor (ASP\", \".NET 4x Web Forms)\\n\\nDependencies in ASP.NET 4.x or earlier versions (either for MVC or for Web Forms\", \") means that these\\napplications won't run on .NET Core unless the code is fully rewritten by using A\", \"SP.NET Core MVC.\\n\\nScenario 2: WCF service and WinForms client app (3-Tier app)\\n\\nThe figure below sho\", \"ws the simple scenario of the original 3-Tier legacy application.\\n\\n40 CHAPTER 4 | Walkthroughs and t\", \"echnical get started overview\\nWinForms\\nDesktop app\\n\\nDuy\\nme Mock\\nWindows Server data\\n\\nIIS\\n=> eShop\\nHT\", \"TP Product\\n\\u2014\\u2014_>\\nCatalog\\ndatabase\\nWCF service SQL Server\\n\\ne-ShopOnContainers. By Microsoft Corp.\\n\\nBen\", \"efits\\n\\nThe benefits of this walkthrough are simple: Just get familiar with the code and initial apps\", \".\\n\\nNext steps\\n\\nExplore this content more in-depth on the GitHub wiki:\\n\\n\\u00b0 Tour on the baseline ASP.NE\", \"T MVC and Web Forms \\u201clegacy\\u201d apps\\n\\u00b0 Tour on the baseline WCF service and WinForms (3-Tier) \\u201clegacy\\u201d \", \"app\\n\\nWalkthrough 2: Containerize your existing .NET\\napplications with Windows Containers\\n\\nOverview\\n\\n\", \"Use Windows Containers to improve deployment of existing .NET applications, like those based on\\nMVC,\", \" Web Forms, or WCF, to production, development, and test environments.\\n\\nGoals\\n\\nThe goal of this walk\", \"through is to show you several options for containerizing an existing .NET\\nFramework application. Yo\", \"u can:\\n\\n. Containerize your application by using Visual Studio 2022 Tools for Docker (Visual Studio\\n\", \"2017 or later versions).\\n\\n. Containerize your application by manually adding a Dockerfile, and then \", \"using the Docker CLI.\\n\\n. Containerize your application by using the Img2Docker tool (an open-source \", \"tool from\\nDocker).\\n\\nA1 CHAPTER 4 | Walkthroughs and technical get started overview\\nThis walkthrough \", \"focuses on the Visual Studio 2022 Tools for Docker approach, but the other two\\n\\napproaches are fairl\", \"y similar in regard to using Dockerfiles.\\n\\nScenario 1: Containerized ASP.NET web apps\\n\\nFigure below \", \"shows the scenario for containerized eShop legacy web apps applications.\\n\\n~~ Docker host (PC dev env\", \"ironment)\\nth / Windows 10 or later\\nA Browser wit Docker for Windows\\n\\u2018 MVC app\\n\\nASPNET MVC app\\naplica\", \"tion\\n\\nASPNET (.NET Framework)\\nWindows Server Core Containers\\n\\nRB Browser with\\n. Web Forms app\\n\\n[\\n|\\n|\", \"\\n|\\n|\\n|\\n|\\n|\\n|\\n|\\n\\nScenario 2: Containerized WCF service\\n\\noo\\n\\nSQL Server\\nWindows Container\\n\\n(*)\\n\\nshould\", \" be used only for dev/test\\nenvironments.\\n\\nMove to a highly available\\nsystem like Azure SOL Database\\n\", \"for production environments.\\n\\n(*) SQL Server in a container |\\n\\nFigure below shows the scenario for a\", \" 3-Tier app with a containerized WCF service.\\n\\n42 CHAPTER 4 | Walkthroughs and technical get started\", \" overview\\ny, \\u2014 ~~\\\" Docker host (PC dev environment) _ [ss]\\nWindows 10 or later\\n\\nWinForm\\nOFS Docker f\", \"or Windows\\n\\nDesktop app\\n|\\n|\\n|\\n\\nWCF service (.NET Framework) on |\\nWindows Server Core Container\\nSQL S\", \"erver\\n\\nWindows Container\\n\\n= <> aly\\nProduct\\nSQL Catalog\\n\\ndatabase\\n\\n\\u2014_ ee\\n\\nBenefits\\n\\nThere are advanta\", \"ges to running your monolithic application in a container. First, you create an image\\nfor the applic\", \"ation. From that point on, every deployment runs in the same environment. Every\\ncontainer uses the s\", \"ame OS version, has the same version of dependencies installed, uses the same\\n.NET framework version\", \", and is built by using the same process. Basically, you control the\\ndependencies of your applicatio\", \"n by using a Docker image. The dependencies travel with the\\napplication when you deploy the containe\", \"rs.\\n\\nAn additional benefit is that developers can run the application in the consistent environment \", \"that's\\nprovided by Windows Containers. Issues that appear only with certain versions can be spotted\\n\", \"immediately, instead of surfacing in a staging or production environment. Differences in development\", \"\\nenvironments used by members of the development team matter less when applications run in\\ncontainer\", \"s.\\n\\nContainerized applications also have a flatter scale-out curve. Containerized apps enable you to\", \" have\\nmore application and service instances (based on containers) in a VM or physical machine compa\", \"red\\nto regular application deployments per machine. This approach translates to higher density and f\", \"ewer\\nrequired resources, especially when you use orchestrators like Kubernetes.\\n\\nContainerization, i\", \"n ideal situations, does not require making any changes to the application code\\n(C#). In most scenar\", \"ios, you just need the Docker deployment metadata files (Dockerfiles and Docker\\nCompose files).\\n\\nNex\", \"t steps\\n\\nExplore this content more in-depth on the GitHub wiki:\\n\\n\\u00b0 How to containerize the .NET Fram\", \"ework web apps with Windows Containers and Docker\\n\\u00b0 Adding Docker Support to a WCF service\\n\\n43 CHAPT\", \"ER 4 | Walkthroughs and technical get started overview\\nWalkthrough 3: Deploy your Windows Containers\", \"-\\nbased app to Azure VMs\\n\\nTechnical walkthrough availability\\n\\nThe full technical walkthrough Is avai\", \"lable in the eshopModernizing GitHub repo wiki:\\n\\nContainers- based-app-into-Azure-VMs-(Including-Cl-\", \"CD)\\n\\nOverview\\n\\nDeploying to a Docker host on a Windows Server 2016 Virtual Machine (VM) in Azure let\", \"s you quickly\\nset up development/test/staging environments. It also gives you a common place for tes\", \"ters or\\nbusiness users to validate the app. VMs also can be valid Infrastructure as a Service (laaS)\", \" production\\nenvironments.\\n\\nGoals\\n\\nThe goal of this walkthrough is to show you the multiple alternati\", \"ves you have when you deploy\\nWindows Containers to Azure VMs that are based on Windows Server 2016 o\", \"r later versions.\\n\\nScenarios\\n\\nSeveral scenarios are covered in this walkthrough.\\n\\n44 CHAPTER 4 | Wal\", \"kthroughs and technical get started overview\\nScenario A: Deploy to an Azure VM from a dev PC through\", \" Docker Engine\\nconnection\\n\\nScenario: Deploy to Azure VM through Docker Engine connection\\n\\nMicrosoft \", \"Azure\\n\\nWindows 10 or later ( Windows Server 2016 or later\\neis\\u201d EE) Docker for Windows Vi) [Penns nn \", \"aa. Docker Engine\\nASP.NET (.NET Framework) on | ASP.NET (.NET Framework) on\\n\\nWindows Server Core Con\", \"tainer | Windows Server Core Container\\n\\nClea =\\u2014\\u2014--\\u2014-\\u2014\\nPC dev environment \\\\ Cf Le] VM for test enviro\", \"nment\\n\\nDocker engine and Docker engine and\\ndocker-compose\\n\\nDocker CLI ls\\n\\noy\\n\\nlls Docker CLI\\n\\noy\\n\\ndo\", \"cker run\\n\\nSQL Server on\\n\\nLocal SQL Server on\\nWindows Server Core Container |\\n\\nReyer-||\\n\\n; : Windows \", \"Server Core Container\\nDocker image | Docker image\\n\\nrepository repository\\n\\n|\\n\\n|\\n\\nann ann |\\n\\nASPNET ap\", \"p 4 PTT } + > PTT} w ASPNET app |\\n|\\n\\n|\\n\\n|\\n\\n$ENV:DOCKER_HOST =\\n\\\"tcp: //13.91.44.153:2375 \\\\\\n\\neee eee\\n\\n\", \"/\\n\\n(*) SQL Server in a container should be used only in dev/test environments.\\nMove to a highly avai\", \"lable system like Azure SQL Database for production environments.\\n\\nFigure 5-4. Deploy to an Azure VM\", \" from a dev PC through a Docker Engine connection\\n\\nScenario B: Deploy to an Azure VM through a Docke\", \"r Registry\\n\\nScenario: Deploy to Azure VM through the Docker Registry\\n\\n[ == ] PC dev environment \\u2122~\\n\\n\", \"Windows 10 or later \\\\\\nip\\u201d Ee] Docker for Windows\\n\\nASP.NET (.NET Framework) on\\nWindows Server Core Co\", \"ntainer\\n\\nDocker Registry Azure\\n\\n\\u2014_ Del el SEE bel Ll bel \\u2014\\u2014 f\\na VM for test environment\\nWindows Serv\", \"er 2016 or later \\\\\\nDocker Hub (\\nor\\nContainer Registry\\n\\nDocker Engine\\n\\nDocker engine and\\nDocker CLI\\n\\n\", \"Docker engine and\\nDocker CLI\\n\\n|\\n\\n|\\n\\n| |\\n\\ny Seee8\\n|\\n\\n|\\n\\n|\\n\\ndocker pull\\n\\nSQL Server on\\nWindows Server \", \"Core Container\\n\\nrepository repository\\n\\ndocker-compose build\\n\\nDocker image | Docker image\\n\\nor\\ndocker \", \"build /\\n(*) SQL Server in a container should be only used for dev/test environments.\\n\\nMove to a high\", \"ly available system like Azure SQL Database for production environments.\\n\\nFigure 5-5. Deploy to an A\", \"zure VM through a Docker Registry\\n\\n45 CHAPTER 4 | Walkthroughs and technical get started overview\\nSc\", \"enario C: Deploy to an Azure VM from CI/CD pipelines in Azure DevOps Services\\n\\nScenario: Deploy to A\", \"zure VM through CI/CD pipelines\\n\\nVEN Vicrosort 5. Test/staging\\n\\nAzure VM\\nWindows Server 2016\\nDocker \", \"Engine\\n\\n3.\\n\\u2018 Build, Cl\\n\\n2.\\nApplication\\ncode repo\\n(SCC)\\n\\nrs s\\nASPNET ap\\n\\ndocker push\\n\\nCode \\u2014 ell\\na\\n\\nP\", \"USH Custom } ;\\nimage Docker Azure Container Registry (Azure)\\n| Registry\\ngit push\\n\\n(*) SQL Server in \", \"a container should be used only for dev/test environments.\\nMove to a highly available system like Az\", \"ure SQL Database for production environments.\\n\\nDev environment\\n\\nFigure 5-6. Deploy to an Azure VM fr\", \"om CI/CD pipelines in Azure DevOps Services\\n\\nAzure VMs for Windows Containers\\n\\nAzure VMs for Windows\", \" Containers are VMs based on Windows Server 2016, Windows 10, or later\\nversions, both with Docker En\", \"gine set up. In most cases, Windows Server 2016 is used in the Azure\\nVMs.\\n\\nAzure currently provides \", \"a VM named Windows Server 2016 with Containers. You can use this VM\\nto try the new Windows Server Co\", \"ntainer feature, with either Windows Server Core or Windows Nano\\nServer. Container OS images are ins\", \"talled, and then the VM is ready to use with Docker.\\n\\nBenefits\\n\\nAlthough Windows Containers can be d\", \"eployed to on-premises Windows Server 2016 VMs, when you\\ndeploy to Azure, you get an easier way to g\", \"et started, with ready-to-use Windows Server Container\\nVMs. You also get a common online location th\", \"at\\u2019s accessible to testers, and automatic scalability\\nthrough Azure virtual machine scale sets.\\n\\nNex\", \"t steps\\n\\nExplore this content more in-depth on the GitHub wiki:\\n\\nhttps://github.com/dotnet-architect\", \"ure/eShooModernizing/wiki/06.-Deploying-your-Windows-\\nContainers-based-app-into-Azure-VMs-(Including\", \"-Cl-CD)\\n46 CHAPTER 4 | Walkthroughs and technical get started overview\\n\\nWalkthrough 4: Deploy your W\", \"indows Containers-\\nbased apps to Azure Container Instances (ACI)\\n\\nTechnical walkthrough availability\", \"\\n\\nThe full technical walkthrough is available in the eshopModernizing GitHub repo wiki:\\n\\nDeploying t\", \"he Apps to ACI (Azure Container Instances)\\n\\nOverview\\n\\nAzure Container Instances (ACI) is the quickes\", \"t way to have a Containers dev/test/staging\\nenvironment where you can deploy single instances of con\", \"tainers.\\n\\nGoals\\n\\nThis walkthrough shows you the main scenarios when deploying Windows Containers to \", \"Azure\\nContainer Instances (ACI) and how you can deploy eShopModernizing Apps into ACI.\\n\\nScenarios\\n\\nT\", \"here can be variations about deploying the eShopModernizing apps into ACI such as deploying just\\none\", \" or all of the apps (MVC app, WebForms app or WCF service). In the following scenario shown\\nbelow, y\", \"ou can see the ASP.NET MVC app plus the SQL Server container both of them deployed as\\ncontainers int\", \"o ACI (Azure Container Instances).\\n\\nDocker Registry\\n[ss] MZ Azure\\n~~ bg 3 Azure Container Instances\\n\", \"\\n(ACI)\\n\\nPC Dev Environment\\nWindows 10 or later\\nDocker for Windows\\n\\nDocker Hub\\nor\\n\\nAzure Container Re\", \"gistry\\n\\nASP.NET (.NET Framework) on .\\nWindows Server Core Container End pol nts\\nDocker engine and\\n\\nD\", \"ocker CLI\\n\\nLocal\\nDocker Image\\n\\nPublic\\nIP &\\nDNS name\\n\\nASP.NET app\\n\\nSQL Server on\\nWindows Server Core \", \"Container\\n\\nRepository\\n\\n= <<.\\nSQL docker-compose build\\n\\ndocker. build (*) SQL Server in a container s\", \"hould only be used for dev/test environments.\\nMove to high available systems, like Azure SQL Databas\", \"e, for production\\nenvironments\\n\\nBenefits\\n\\nAzure Container Instances makes it easy to create and mana\", \"ge Docker containers in Azure, without\\nhaving to provision virtual machines or adopt a higher-level \", \"service. With ACI, you can directly deploy\\na Windows container in Azure and expose it to the interne\", \"t with a fully qualified domain name (FQDN)\\n\\n47 CHAPTER 4 | Walkthroughs and technical get started o\", \"verview\\nin a matter of seconds (Provided that you have the Windows Container image ready in a Docker\", \"\\nregistry like Docker Hub or Azure Container Registry).\\n\\nConsiderations\\n\\nDeploying Windows Container\", \"s with either full .NET Framework / ASP.NET or SQL Server into Azure\\nContainer Instances (ACI) is no\", \"t quite as fast as deploying to a regular Docker Host (like a Windows\\nServer 2016 with Windows Conta\", \"iners) because the Docker image has to be downloaded (pulled from\\nthe Docker registry) every time an\", \"d the sizes of the SQL container image (15.1 GB) and the ASP.NET\\ncontainer image (13.9 GB) are signi\", \"ficantly large, however it is much cheaper than maintaining your\\nown docker host (permanently on-lin\", \"e Windows Server 2016 with Windows Containers VM in Azure)\\nnot to mention a whole orchestrator like \", \"Kubernetes in Azure (AKS) which is, on the other hand, a\\ngreat choice for production deployments.\\n\\nA\", \"s the main conclusion, using Azure Container Instances is a very compelling option for Dev/Test\\n\\nsce\", \"narios and for CI/CD pipelines.\\n\\nNext steps\\n\\nExplore this content more in-depth on the GitHub wiki:\\n\", \"\\nhttps://github.com/dotnet-architecture/eShopModernizing/wiki/05.-Deploying-the-Apps-to-ACl-\\n(Azure-\", \"Container-Instances)\\n\\nWalkthrough 5: Deploy your Windows Containers-\\nbased apps to Kubernetes in Azu\", \"re Container\\nService\\n\\nTechnical walkthrough availability\\n\\nThe full technical walkthrough is availabl\", \"e in the eshopModernizing GitHub repo wiki:\\n\\nhttps://github.com/dotnet-architecture/eShopModernizing\", \"/wiki/04.-How-to-deploy-your-Windows-\\nContainers-based-apps-into-Kubernetes-in-Azure-Container-Servi\", \"ce-(Including-Cl-CD\\n\\nOverview\\n\\nAn application that\\u2019s based on Windows Containers will quickly need t\", \"o use platforms, moving even\\nfurther away from laaS VMs. This approach is needed to easily achieve h\", \"igh scalability and better\\nautomated scalability, and for a significant improvement in automated dep\", \"loyments and versioning.\\nYou can achieve these goals by using the orchestrator Kubernetes, available\", \" in Azure Container\\nServices.\\n\\n48 CHAPTER 4 | Walkthroughs and technical get started overview\\nGoals\\n\", \"\\nThe goal of this walkthrough is to learn how to deploy a Windows Container\\u2014based application to\\nKub\", \"ernetes (also called K8s) in Azure Container Service. Deploying to Kubernetes from scratch is a\\ntwo-\", \"step process:\\n\\n1. Deploy a Kubernetes cluster to Azure Container Service.\\n\\n2. Deploy the application\", \" and related resources to the Kubernetes cluster.\\n\\nScenarios\\n\\nScenario A: Deploy directly to a Kuber\", \"netes cluster from a dev environment\\n\\nScenario: Direct deployment to a Kubernetes cluster in Azure C\", \"ontainer Service\\n\\nAzure\\nPC dev environment (\\u201c ae Kubernetes cluster \\u2014 Production\\n\\nWindows 10 or late\", \"r a i .\\n\\n- Windows Server 2016 nodes\\nDocker for Windows ACS K8s Cluster\\n\\nKubectl (K8s CLI) |\\n5 a_2re\", \"eeeeeeeeeee\\n/ \\\\\\ndocker build ty\\n\\nLocal \\u201cte push _\\u2014 sestoe\\u2122*\\nDocker Image\\n\\n: and Nr acer\\nRepository C\", \"omme\\u201d ig cust\\n\\nKubectl (K8s CLI)\\n\\n|\\nwy Docker host |\\n|\\n\\noe ,\\na) 1\\n\\n- DNS |\\n\\n(kes y - Scheduler |\\nom \", \"~ Proxy |\\n\\n- . |\\n\\n|\\n\\n|\\n\\n|\\n\\n/\\n\\n[|\\ncl!\\n\\\\\\n\\ncreate Azure\\np-deploy.yml Load\\n\\u201c@\\u00ae.\\n\\nkubectl\\n-fa\\n\\n\\u2014s.\\n\\nee ee\", \"e eee\\n\\n(*) SQL Server in a container should be used only in dev/test environments.\\nMove to a highly \", \"available system like Azure SQL Database for production environments.\\n\\nFigure 5-7. Deploy directly t\", \"o a Kubernetes cluster from a development environment\\n\\n49 CHAPTER 4 | Walkthroughs and technical get\", \" started overview\\nScenario B: Deploy to a Kubernetes cluster from CI/CD pipelines in Azure DevOps\\nSe\", \"rvices\\n\\nScenario: Deploy to Kubernetes through Cl/CD pipelines\\n\\n/ Microsoft\\nAzure Container Service \", \"\\u2014\\n\\nKubernetes\\n\\n4.\\nCD, deploy\\n\\n3.\\n. Build, Cl\\n\\n> Docker host\\n\\n2.\\nApplication\\ncode repo\\n\\naa\\\")\\n\\n(SCC)\\n\\n\", \"\\u00a9\\n\\ndocker push\\n\\nas \\u00ae\\nDocker Hub (internet)\\n\\nCustom or . .\\nimage Docker Azure Container Registry (Azu\", \"re)\\n\\nRegistry\\n\\n(*) SQL Server in a container should be used only in dev/test environments.\\nMove to a\", \" highly available system like Azure SQL Database for production environments.\\n\\nDev environment\\n\\nFigu\", \"re 5-8. Deploy to a Kubernetes cluster from CI/CD pipelines in Azure DevOps Services\\n\\nBenefits\\n\\nTher\", \"e are many benefits to deploying to a cluster in Kubernetes. The biggest benefit is that you get a\\np\", \"roduction-ready environment in which you can scale out the application based on the number of\\ncontai\", \"ner instances you want to use (inner-scalability in the existing nodes), and based on the number\\nof \", \"nodes or VMs in the cluster (global scalability of the cluster).\\n\\nAzure Container Service optimizes \", \"popular open-source tools and technologies specifically for Azure.\\nYou get an open solution that off\", \"ers portability, both for your containers and for your application\\nconfiguration. You select the siz\", \"e, the number of hosts, and the orchestrator tools-Container Service\\nhandles everything else.\\n\\nWith \", \"Kubernetes, developers can progress from thinking about physical and virtual machines, to\\nplanning a\", \" container-centric infrastructure that facilitates the following capabilities, among others:\\n\\n\\u00b0 Appl\", \"ications based on multiple containers\\n\\n. Replicating container instances and horizontal autoscaling\\n\", \"\\u00b0 Naming and discovering (for example, internal DNS)\\n. Balancing loads\\n\\n50 CHAPTER 4 | Walkthroughs \", \"and technical get started overview\\n. Rolling updates\\n. Distributing secrets\\n\\n. Application health ch\", \"ecks\\n\\nNext steps\\nExplore this content more in-depth on the GitHub wiki: https://github.com/dotnet-\\n\\n\", \"Kubernetes-in-Azure-Container-Service-(Including-Cl-CD)\\n\\nWalkthrough 6: Deploy your Windows Containe\", \"rs-\\nbased apps to Azure App Service for Containers\\n\\nTechnical walkthrough availability\\n\\nThe full tec\", \"hnical walkthrough is available in the eSshopModernizing GitHub repo wiki:\\n\\nhttps://github.com/dotne\", \"t-architecture/eShopModernizing/wiki/Deploy-Windows-Container-to-\\n\\nAzure-App-Service\\n\\nOverview\\n\\nA si\", \"mple containerized application using Windows Containers can easily be deployed to Azure App\\nService \", \"for Containers. This approach is the recommended approach for most Windows Container-\\nbased applicat\", \"ions.\\n\\nGoals\\n\\nThe goal of this walkthrough is to learn how to deploy a Windows Container\\u2014based appli\", \"cation to\\nAzure App Service for Containers from a registry (Docker Hub or Azure Container Registry).\", \"\\n\\n51 CHAPTER 4 | Walkthroughs and technical get started overview\\nScenario\\n\\nScenario: Deploy to Azure\", \" App Service (Windows Containers)\\n\\n] . Azure App Service\\nPC Dev Environment (With support for Window\", \"s Containers)\\nWindows 10\\nDocker for Windows\\n\\nASP.NET (.NET Framework) on\\nWindows Server Core Contain\", \"er et eee ee\\n\\nDocker engine and\\nDocker CLI mir \\u2014\\n\\ni es\\n\\nAzure portal\\n\\nSQL Server on\\nWindows Server C\", \"ore Container\\n\\nBenefits\\n\\nLocal Py\\nDocker Image Ol\\n\\nViic = + J:\\n\\nRepository Visual Studio\\n\\ndocker-com\", \"pose build\\nor\\ndocker build\\n\\nDeploying to Azure App Service for Containers offers the benefits of con\", \"tainers paired with the PaaS\\nbenefits of Azure App Service. The app service can easily be scaled bot\", \"h vertically and horizontally,\\nand can be configured to autoscale to meet changing demands. Updates \", \"can be performed with zero\\ndowntime and the configuration of continuous deployment from a registry i\", \"s easily configured as well.\\n\\nNext steps\\n\\nExplore this content more in-depth on the GitHub wiki: htt\", \"ps://github.com/dotnet-\\narchitecture/eShopModernizing/wiki/Deploy-Windows-Container-to-Azure-App-Ser\", \"vice\\n\\n52 CHAPTER 4 | Walkthroughs and technical get started overview\\nCHAPTER\\n\\nConclusions\\n\\n. Contain\", \"er-based solutions ultimately provide cost savings benefits. Containers are a solution\\nto deployment\", \" problems because they remove the friction caused by an absence of\\ndependencies in production enviro\", \"nments. By removing those issues, it improves Dev/Test,\\nDevOps, and production operations significan\", \"tly.\\n\\n. A Docker container is becoming the standard unit of deployment for any server-based\\napplicat\", \"ion or service.\\n\\n. For production environments, you should use an orchestrator (like Kubernetes) to \", \"host\\nscalable containers\\u2014based applications.\\n\\n. Azure VMs hosting containers are a fast and simple w\", \"ay to create small Dev/Test\\nenvironments in the cloud.\\n\\n. Azure SQL Database Managed Instance is rec\", \"ommended by default when migrating your\\nrelational databases from existing applications to Azure.\\n\\n.\", \" Visual Studio 2022 and Image2Docker are basic tools for you to start modernizing your\\nexisting .NET\", \" applications with Windows Containers by accelerating the getting started\\nlearning curve.\\n\\n. When pl\", \"acing containerized applications in production you will always create or adopt a\\nDevOps culture and \", \"DevOps tools for CI/CD pipelines, like Azure DevOps Services or Jenkins.\\n\\n. Microsoft Azure provides\", \" the most comprehensive and complete environment to modernize\\nyour existing .NET Framework applicati\", \"ons with Windows Containers, cloud infrastructure and\\nPaaS services.\\n\\n53 CHAPTER 5 | Conclusions\\n\"]"