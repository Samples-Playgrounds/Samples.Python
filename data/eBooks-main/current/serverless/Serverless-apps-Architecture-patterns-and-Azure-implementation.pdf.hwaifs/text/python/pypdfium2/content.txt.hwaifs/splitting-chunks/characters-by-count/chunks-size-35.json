"[\"EDITION v4.0 - Updated to Azure Functions v4\\nDOWNLOAD available at: https://aka.ms/serverlessbookpdf\", \"\\nPUBLISHED BY\\nMicrosoft Developer Division, .NET, and Visual Studio product teams\\nA division of Micr\", \"osoft Corporation\\nOne Microsoft Way\\nRedmond, Washington 98052-6399\\nCopyright \\u00a9 2018-2023 by Microsof\", \"t Corporation\\nAll rights reserved. No part of the contents of this book may be reproduced or transmi\", \"tted in any \\nform or by any means without the written permission of the publisher.\\nThis book is prov\", \"ided \\u201cas-is\\u201d and expresses the author\\u2019s views and opinions. The views, opinions and \\ninformation exp\", \"ressed in this book, including URL and other Internet website references, may change \\nwithout notice\", \".\\nSome examples depicted herein are provided for illustration only and are fictitious. No real assoc\", \"iation \\nor connection is intended or should be inferred.\\nMicrosoft and the trademarks listed at http\", \"s://www.microsoft.com on the \\u201cTrademarks\\u201d webpage are \\ntrademarks of the Microsoft group of companie\", \"s.\\nMac and macOS are trademarks of Apple Inc.\\nAll other marks and logos are property of their respec\", \"tive owners.\\nAuthor:\\nJeremy Likness, Senior .NET Data Program Manager, Microsoft Corp.\\nContributor:\\n\", \"Cecil Phillip, Senior Cloud Advocate, Microsoft Corp.\\nEditors:\\nBill Wagner, Senior Content Developer\", \", Microsoft Corp.\\nMaira Wenzel, Senior Content Developer, Microsoft Corp.\\nParticipants and reviewers\", \":\\nSteve Smith, Architect/Trainer, NimblePros.\\nIntroduction\\nServerless is the evolution of cloud plat\", \"forms in the direction of pure cloud native code. Serverless \\nbrings developers closer to business l\", \"ogic while insulating them from infrastructure concerns. It\\u2019s a \\npattern that doesn\\u2019t imply \\u201cno serv\", \"er\\u201d but rather, \\u201cless server.\\u201d Serverless code is event-driven. Code may be triggered by anything fr\", \"om a traditional HTTP web request to a timer or the result of \\nuploading a file. The infrastructure \", \"behind serverless allows for instant scale to meet elastic demands \\nand offers micro-billing to trul\", \"y \\u201cpay for what you use.\\u201d Serverless requires a new way of thinking and \\napproach to building applic\", \"ations and isn\\u2019t the right solution for every problem. As a developer, you \\nmust decide:\\n\\u2022 What are \", \"the pros and cons of serverless?\\n\\u2022 Why should you consider serverless for your own applications?\\n\\u2022 H\", \"ow can you build, test, deploy, and maintain your serverless code?\\n\\u2022 Where does it make sense to mig\", \"rate code to serverless in existing applications, and what is the \\nbest way to accomplish this trans\", \"formation?\\nAbout this guide\\nThis guide focuses on cloud native development of applications that use \", \"serverless. The book \\nhighlights the benefits and exposes the potential drawbacks of developing serv\", \"erless apps and \\nprovides a survey of serverless architectures. Many examples of how serverless can \", \"be used are \\nillustrated along with various serverless design patterns.\\nThis guide explains the comp\", \"onents of the Azure serverless platform and focuses specifically on \\nimplementation of serverless us\", \"ing Azure Functions. You\\u2019ll learn about triggers and bindings as well as \\nhow to implement serverles\", \"s apps that rely on state using durable functions. Finally, business \\nexamples and case studies will\", \" help provide context and a frame of reference to determine whether \\nserverless is the right approac\", \"h for your projects.\\nEvolution of cloud platforms\\nServerless is the culmination of several iteration\", \"s of cloud platforms. The evolution began with \\nphysical metal in the data center and progressed thr\", \"ough Infrastructure as a Service (IaaS) and \\nPlatform as a Service (PaaS).\\nBefore the cloud, a disce\", \"rnible boundary existed between development and operations. Deploying an \\napplication meant answerin\", \"g myriad questions like:\\n\\u2022 What hardware should be installed?\\n\\u2022 How is physical access to the machin\", \"e secured?\\u2022 Does the data center require an Uninterruptible Power Supply (UPS)?\\n\\u2022 Where are storage \", \"backups sent?\\n\\u2022 Should there be redundant power?\\nThe list goes on and the overhead was enormous. In \", \"many situations, IT departments were forced to \\ndeal with incredible waste. The waste was due to ove\", \"r-allocation of servers as backup machines for \\ndisaster recovery and standby servers to enable scal\", \"e-out. Fortunately, the introduction of \\nvirtualization technology (like Hyper-V) with Virtual Machi\", \"nes (VMs) gave rise to Infrastructure as a \\nService (IaaS). Virtualized infrastructure allowed opera\", \"tions to set up a standard set of servers as the \\nbackbone, leading to a flexible environment capabl\", \"e of provisioning unique servers \\u201con demand.\\u201d \\nMore important, virtualization set the stage for usin\", \"g the cloud to provide virtual machines \\u201cas a \\nservice.\\u201d Companies could easily get out of the busin\", \"ess of worrying about redundant power or \\nphysical machines. Instead, they focused on the virtual en\", \"vironment.\\nIaaS still requires heavy overhead because operations is still responsible for various ta\", \"sks. These tasks \\ninclude:\\n\\u2022 Patching and backing up servers.\\n\\u2022 Installing packages.\\n\\u2022 Keeping the o\", \"perating system up-to-date.\\n\\u2022 Monitoring the application.\\nThe next evolution reduced the overhead by\", \" providing Platform as a Service (PaaS). With PaaS, the \\ncloud provider handles operating systems, s\", \"ecurity patches, and even the required packages to \\nsupport a specific platform. Instead of building\", \" a VM then configuring .NET and standing up Internet \\nInformation Services (IIS) servers, developers\", \" simply choose a \\u201cplatform target\\u201d such as \\u201cweb \\napplication\\u201d or \\u201cAPI endpoint\\u201d and deploy code dire\", \"ctly. The infrastructure questions are reduced to:\\n\\u2022 What size services are needed?\\n\\u2022 How do the ser\", \"vices scale out (add more servers or nodes)?\\n\\u2022 How do the services scale up (increase the capacity o\", \"f hosting servers or nodes)?\\nServerless further abstracts servers by focusing on event-driven code. \", \"Instead of a platform, \\ndevelopers can focus on a microservice that does one thing. The two key ques\", \"tions for building the \\nserverless code are:\\n\\u2022 What triggers the code?\\n\\u2022 What does the code do?\\nWith\", \" serverless, infrastructure is abstracted. In some cases, the developer no longer worries about the \", \"\\nhost at all. Whether or not an instance of IIS, Kestrel, Apache, or some other web server is runnin\", \"g to \\nmanage web requests, the developer focuses on an HTTP trigger. The trigger provides the standa\", \"rd, \\ncross-platform payload for the request. The payload not only simplifies the development process\", \", but \\nfacilitates testing and in some cases, makes the code easily portable across platforms.\\nAnoth\", \"er feature of serverless is micro-billing. It\\u2019s common for web applications to host Web API \\nendpoin\", \"ts. In traditional bare metal, IaaS and even PaaS implementations, the resources to host the \\nAPIs a\", \"re paid for continuously. That means you pay to host the endpoints even when they aren\\u2019t \\nbeing acce\", \"ssed. Often you\\u2019ll find one API is called more than others, so the entire system is scaled based on \", \"supporting the popular endpoints. Serverless enables you to scale each endpoint \\nindependently and p\", \"ay for usage, so no costs are incurred when the APIs aren\\u2019t being called. \\nMigration may in many cir\", \"cumstances dramatically reduce the ongoing cost to support the endpoints.\\nWhat this guide doesn\\u2019t co\", \"ver\\nThis guide specifically emphasizes architecture approaches and design patterns and isn\\u2019t a deep \", \"dive \\ninto the implementation details of Azure Functions, Logic Apps, or other serverless platforms.\", \" This \\nguide doesn\\u2019t cover, for example, advanced workflows with Logic Apps or features of Azure Fun\", \"ctions \\nsuch as configuring Cross-Origin Resource Sharing (CORS), applying custom domains, or upload\", \"ing \\nSSL certificates. These details are available through the online Azure Functions documentation.\", \"\\nAdditional resources\\n\\u2022 Azure Architecture center\\n\\u2022 Best practices for cloud applications\\nWho should\", \" use the guide\\nThis guide was written for developers and solution architects who want to build enter\", \"prise \\napplications with .NET that may use serverless components either on premises or in the cloud.\", \" It\\u2019s \\nuseful to developers, architects, and technical decision makers interested in:\\n\\u2022 Understandin\", \"g the pros and cons of serverless development\\n\\u2022 Learning how to approach serverless architecture\\n\\u2022 E\", \"xample implementations of serverless apps\\nHow to use the guide\\nThe first part of this guide examines\", \" why serverless is a viable option by comparing several different \\narchitecture approaches. It exami\", \"nes both the technology and development lifecycle, because all \\naspects of software development are \", \"impacted by architecture decisions. The guide then examines \\nuse cases and design patterns and inclu\", \"des reference implementations using Azure Functions. Each \\nsection contains additional resources to \", \"learn more about a particular area. The guide concludes with \\nresources for walkthroughs and hands-o\", \"n exploration of serverless implementation.\\nSend your feedback\\nThe guide and related samples are con\", \"stantly evolving, so your feedback is welcomed! If you have \\ncomments about how this guide can be im\", \"proved, use the feedback section at the bottom of any \\npage built on GitHub issues.i Contents\\nConten\", \"ts\\nArchitecture approaches..........................................................................\", \"............................................................. 1\\nArchitecture patterns...............\", \"....................................................................................................\", \"...........................................1\\nMonoliths .............................................\", \"....................................................................................................\", \"...................................1\\nN-Layer applications...........................................\", \"....................................................................................................\", \"................2\\nMicroservices ....................................................................\", \"....................................................................................................\", \".....3\\nArchitecture deployment approaches ..........................................................\", \"...................................................................4\\nN-Tier applications ...........\", \"....................................................................................................\", \"..............................................5\\nOn-premises and Infrastructure as a Service (IaaS)..\", \".............................................................................................6\\nPlatf\", \"orm as a Service (PaaS).............................................................................\", \"...............................................................7\\nSoftware as a Service (SaaS) ......\", \"....................................................................................................\", \".................................7\\nContainers and Functions as a Service (FaaS).....................\", \".....................................................................................8\\nServerless...\", \"....................................................................................................\", \".........................................................................9\\nSummary..................\", \"....................................................................................................\", \"........................................................ 10\\nRecommended resources ..................\", \"....................................................................................................\", \"....................... 11\\nServerless architecture..................................................\", \".......................................................................................12\\nFull serve\", \"rless back end......................................................................................\", \"................................................................ 13\\nMonoliths and \\u201cstarving the beas\", \"t\\u201d..................................................................................................\", \"............................. 13\\nWeb apps ..........................................................\", \"....................................................................................................\", \"................... 14\\nMobile back ends.............................................................\", \"....................................................................................................\", \". 14\\nInternet of Things (IoT).......................................................................\", \"................................................................................ 15\\nServerless archi\", \"tecture considerations .............................................................................\", \"............................................ 16\\nManaging state .....................................\", \"....................................................................................................\", \"........................ 16\\nLong-running processes..................................................\", \".............................................................................................. 16\\nSt\", \"artup time..........................................................................................\", \".............................................................................. 17\\nDatabase updates a\", \"nd migrations ......................................................................................\", \"...................................... 17\\nScaling ..................................................\", \"....................................................................................................\", \"............................ 17\\nMonitoring, tracing, and logging....................................\", \"........................................................................................... 18\\nInter\", \"-service dependencies ..............................................................................\", \"............................................................ 18ii Contents\\nManaging failure and prov\", \"iding resiliency ...................................................................................\", \"......................... 18\\nVersioning and green/blue deployments..................................\", \"............................................................................. 19\\nServerless design e\", \"xamples ............................................................................................\", \".................................................. 19\\nScheduling ...................................\", \"....................................................................................................\", \"................................... 19\\nCommand and Query Responsibility Segregation (CQRS)..........\", \".................................................................... 19\\nEvent-based processing .....\", \"....................................................................................................\", \"....................................... 20\\nFile triggers and transformations........................\", \"....................................................................................................\", \"... 20\\nAsynchronous background processing and messaging.............................................\", \"...................................... 21\\nWeb apps and APIs ........................................\", \"....................................................................................................\", \"............. 21\\nData pipeline......................................................................\", \"................................................................................................ 22\\n\", \"Stream processing ..................................................................................\", \"......................................................................... 22\\nAPI gateway............\", \"....................................................................................................\", \"........................................................ 23\\nRecommended resources ..................\", \"....................................................................................................\", \"....................... 23\\nAzure serverless platform................................................\", \"...................................................................................24\\nAzure Function\", \"s ..................................................................................................\", \"................................................................... 24\\nProgramming language support \", \"....................................................................................................\", \"........................... 25\\nApp service plans ...................................................\", \"....................................................................................................\", \"...... 25\\nCreate your first function ...............................................................\", \"............................................................................... 25\\nUnderstand trigge\", \"rs and bindings ....................................................................................\", \"........................................ 26\\nTelemetry with Application Insights ....................\", \"....................................................................................................\", \"...... 27\\nAzure Logic Apps .........................................................................\", \"......................................................................................... 29\\nEvent G\", \"rid.................................................................................................\", \"................................................................................ 31\\nScenarios.......\", \"....................................................................................................\", \"................................................................... 32\\nEvent Grid vs. other Azure me\", \"ssaging services ...................................................................................\", \"................. 33\\nPerformance targets............................................................\", \"............................................................................................ 34\\nEven\", \"t Grid schema ......................................................................................\", \"..................................................................... 34\\nAzure resources ...........\", \"....................................................................................................\", \"................................................. 35\\nConclusion ....................................\", \"....................................................................................................\", \".................................. 36\\nRecommended resources ........................................\", \"....................................................................................................\", \". 36\\nDurable Azure Functions .......................................................................\", \".............................................................37\\nTriggering a stateful workflow......\", \"....................................................................................................\", \"............................... 37\\nWorking with the Orchestration client ...........................\", \"......................................................................................... 37iii Cont\", \"ents\\nThe orchestrator function .....................................................................\", \"........................................................................ 38\\nThe activity functions..\", \"....................................................................................................\", \"................................................ 39\\nRecommended resources ..........................\", \"....................................................................................................\", \".................... 39\\nOrchestration patterns......................................................\", \".................................................................................................. 3\", \"9\\nFunction chaining.................................................................................\", \"............................................................................ 40\\nAsynchronous HTTP AP\", \"Is .................................................................................................\", \"............................................. 40\\nMonitoring.........................................\", \"....................................................................................................\", \"............................. 41\\nRecommended resources .............................................\", \"................................................................................................ 42\\n\", \"Serverless business scenarios and use cases ........................................................\", \"......................................43\\nBig data processing........................................\", \"....................................................................................................\", \".................. 43\\nCreate serverless applications: hands-on lab .................................\", \"........................................................................... 43\\nCustomer reviews.....\", \"....................................................................................................\", \"......................................................... 43\\nFile processing and validation ........\", \"....................................................................................................\", \"............................. 44\\nGame data visualization ...........................................\", \"....................................................................................................\", \"...... 44\\nGraphQL ..................................................................................\", \"................................................................................................. 44\", \"\\nInternet of Things (IoT) reliable edge relay ......................................................\", \".......................................................... 44\\nMicroservices reference architecture .\", \"....................................................................................................\", \"....................... 44\\nServerless for mobile....................................................\", \"....................................................................................................\", \"... 45\\nServerless messaging ........................................................................\", \".................................................................................. 45\\nRecommended re\", \"sources ............................................................................................\", \"...................................................... 45\\nConclusion................................\", \"....................................................................................................\", \"............................461 CHAPTER 1 | Architecture approaches\\nCHAPTER 1\\nArchitecture approache\", \"s\\nUnderstanding existing approaches to architecting enterprise apps helps clarify the role played by\", \" \\nserverless. There are many approaches and patterns that evolved over decades of software \\ndevelopm\", \"ent, and all have their own pros and cons. In many cases, the ultimate solution may not \\ninvolve dec\", \"iding on a single approach but may integrate several approaches. Migration scenarios \\noften involve \", \"shifting from one architecture approach to another through a hybrid approach.\\nThis chapter provides \", \"an overview of both logical and physical architecture patterns for enterprise \\napplications.\\nArchite\", \"cture patterns\\nModern business applications follow a variety of architecture patterns. This section \", \"represents a survey \\nof common patterns. The patterns listed here aren\\u2019t necessarily all best practi\", \"ces, but illustrate \\ndifferent approaches.\\nFor more information, see Azure application architecture \", \"guide.\\nMonoliths\\nMany business applications follow a monolith pattern. Legacy applications are often\", \" implemented as \\nmonoliths. In the monolith pattern, all application concerns are contained in a sin\", \"gle deployment. \\nEverything from user interface to database calls is included in the same codebase.2\", \" CHAPTER 1 | Architecture approaches\\nThere are several advantages to the monolith approach. It\\u2019s oft\", \"en easy to pull down a single code \\nbase and start working. Ramp up time may be less, and creating t\", \"est environments is as simple as \\nproviding a new copy. The monolith may be designed to include mult\", \"iple components and \\napplications.\\nUnfortunately, the monolith pattern tends to break down at scale.\", \" Major disadvantages of the \\nmonolith approach include:\\n\\u2022 Difficult to work in parallel in the same \", \"code base.\\n\\u2022 Any change, no matter how trivial, requires deploying a new version of the entire appli\", \"cation.\\n\\u2022 Refactoring potentially impacts the entire application.\\n\\u2022 Often the only solution to scale\", \" is to create multiple, resource-intensive copies of the monolith.\\n\\u2022 As systems expand or other syst\", \"ems are acquired, integration can be difficult.\\n\\u2022 It may be difficult to test due to the need to con\", \"figure the entire monolith.\\n\\u2022 Code reuse is challenging and often other apps end up having their own\", \" copies of code.\\nMany businesses look to the cloud as an opportunity to migrate monolith application\", \"s and at the \\nsame time refactor them to more usable patterns. It\\u2019s common to break out the individu\", \"al \\napplications and components to allow them to be maintained, deployed, and scaled separately.\\nN-L\", \"ayer applications\\nN-layer application partition application logic into specific layers. The most com\", \"mon layers include:\\n\\u2022 User interface\\n\\u2022 Business logic\\n\\u2022 Data access3 CHAPTER 1 | Architecture approa\", \"ches\\nOther layers may include middleware, batch processing, and API. It\\u2019s important to note the laye\", \"rs are \\nlogical. Although they\\u2019re developed in isolation, they may all be deployed to the same targe\", \"t platform.\\nThere are several advantages to the N-Layer approach, including:\\n\\u2022 Refactoring is isolat\", \"ed to a layer.\\n\\u2022 Teams can independently build, test, deploy, and maintain separate layers.\\n\\u2022 Layers\", \" can be swapped out, for example the data layer may access multiple databases without \\nrequiring cha\", \"nges to the UI layer.\\nServerless may be used to implement one or more layers.\\nMicroservices\\nMicroser\", \"vices architectures contain common characteristics that include:\\n\\u2022 Applications are composed of seve\", \"ral small services.\\n\\u2022 Each service runs in its own process.\\n\\u2022 Services are aligned around business d\", \"omains.\\n\\u2022 Services communicate over lightweight APIs, typically using HTTP as the transport.\\n\\u2022 Servi\", \"ces can be deployed and upgraded independently.\\n\\u2022 Services aren\\u2019t dependent on a single data store.\\n\", \"\\u2022 The system is designed with failure in mind, and the app may still run even when certain services \", \"\\nfail.\\nMicroservices don\\u2019t have to be mutually exclusive to other architecture approaches. For examp\", \"le, an \\nN-Tier architecture may use microservices for the middle tier. It\\u2019s also possible to impleme\", \"nt 4 CHAPTER 1 | Architecture approaches\\nmicroservices in a variety of ways, from virtual directorie\", \"s on IIS hosts to containers. The characteristics \\nof microservices make them especially ideal for s\", \"erverless implementations.\\nThe pros of microservices architectures include:\\n\\u2022 Refactoring is often i\", \"solated to a single service.\\n\\u2022 Services can be upgraded independently of each other.\\n\\u2022 Resiliency an\", \"d elasticity can be tuned to the demands of individual services.\\n\\u2022 Development can happen in paralle\", \"l across disparate teams and platforms.\\n\\u2022 It\\u2019s easier to write comprehensive tests for isolated serv\", \"ices.\\nMicroservices come with their own challenges, including:\\n\\u2022 Determining what services are avail\", \"able and how to call them.\\n\\u2022 Managing the lifecycle of services.\\n\\u2022 Understanding how services fit to\", \"gether in the overall application.\\n\\u2022 Full system testing of calls made across disparate services.\\nUl\", \"timately there are solutions to address all of these challenges, including tapping into the benefits\", \" of \\nserverless that are discussed later.\\nArchitecture deployment approaches\\nRegardless of the archi\", \"tecture approach used to design a business application, the implementation, or \\ndeployment of those \", \"applications may vary. Businesses host applications on everything from physical \\nhardware to serverl\", \"ess functions.5 CHAPTER 1 | Architecture approaches\\nN-Tier applications\\nThe N-Tier architecture patt\", \"ern is a mature architecture and simply refers to applications that separate \\nvarious logical layers\", \" into separate physical tiers. N-Tier architecture is a physical implementation of \\nN-Layer architec\", \"ture. The most common implementation of this architecture includes:\\n\\u2022 A presentation tier, for examp\", \"le a web app.\\n\\u2022 An API or data access tier, such as a REST API.\\n\\u2022 A data tier, such as a SQL databas\", \"e.\\nN-tier solutions have the following characteristics:\\n\\u2022 Projects are typically aligned with tiers.\", \"\\n\\u2022 Testing may be approached differently by tier.\\n\\u2022 Tiers provide layers of abstraction, for example\", \" the presentation tier is typically ignorant of the \\nimplementation details of the data tier.\\n\\u2022 Typi\", \"cally, layers only interact with adjacent layers.\\n\\u2022 Releases are often managed at the project, and t\", \"herefore tier, level. A simple API change may \\nrequire a new release of an entire middle tier.\\nThis \", \"approach provides several benefits, including:\\n\\u2022 Isolation of the database (often the front end does\", \"n\\u2019t have direct access to the database back \\nend).\\n\\u2022 Reuse of the API (for example, mobile, desktop,\", \" and web app clients can all reuse the same APIs).6 CHAPTER 1 | Architecture approaches\\n\\u2022 Ability to\", \" scale out tiers independent of each other.\\n\\u2022 Refactoring isolation: one tier may be refactored with\", \"out impacting other tiers.\\nOn-premises and Infrastructure as a Service (IaaS)\\nThe traditional approa\", \"ch to hosting applications requires buying hardware and managing all of the \\nsoftware installations,\", \" including the operating system. Originally this involved expensive data centers \\nand physical hardw\", \"are. The challenges that come with operating physical hardware are many, \\nincluding:\\n\\u2022 The need to b\", \"uy excess for \\u201cjust in case\\u201d or peak demand scenarios.\\n\\u2022 Securing physical access to the hardware.\\n\\u2022\", \" Responsibility for hardware failure (such as disk failure).\\n\\u2022 Cooling.\\n\\u2022 Configuring routers and lo\", \"ad balancers.\\n\\u2022 Power redundancy.\\n\\u2022 Securing software access.\\nVirtualization of hardware, via \\u201cvirtu\", \"al machines\\u201d enables Infrastructure as a Service (IaaS). Host \\nmachines are effectively partitioned \", \"to provide resources to instances with allocations for their own \\nmemory, CPU, and storage. The team\", \" provisions the necessary VMs and configures the associated \\nnetworks and access to storage.\\nFor mor\", \"e information, see virtual machine N-tier reference architecture.\\nAlthough virtualization and Infras\", \"tructure as a Service (IaaS) address many concerns, it still leaves \\nmuch responsibility in the hand\", \"s of the infrastructure team. The team maintains operating system \\nversions, applies security patche\", \"s, and installs third-party dependencies on the target machines. Apps \\noften behave differently on p\", \"roduction machines compared to the test environment. Issues arise due \\nto different dependency versi\", \"ons and/or OS SKU levels. Although many organizations deploy N-Tier \\napplications to these targets, \", \"many companies benefit from deploying to a more cloud native model 7 CHAPTER 1 | Architecture approa\", \"ches\\nsuch as Platform as a Service. Architectures with microservices are more challenging because of\", \" the \\nrequirements to scale out for elasticity and resiliency.\\nFor more information, see virtual mac\", \"hines.\\nPlatform as a Service (PaaS)\\nPlatform as a Service (PaaS) offers configured solutions that de\", \"velopers can plug into directly. PaaS is \\nanother term for managed hosting. It eliminates the need t\", \"o manage the base operating system, \\nsecurity patches and in many cases any third-party dependencies\", \". Examples of platforms include web \\napplications, databases, and mobile back ends.\\nPaaS addresses t\", \"he challenges common to IaaS. PaaS allows the developer to focus on the code or \\ndatabase schema rat\", \"her than how it gets deployed. Benefits of PaaS include:\\n\\u2022 Pay for use models that eliminate the ove\", \"rhead of investing in idle machines.\\n\\u2022 Direct deployment and improved DevOps, continuous integration\", \" (CI), and continuous delivery \\n(CD) pipelines.\\n\\u2022 Automatic upgrades, updates, and security patches.\", \"\\n\\u2022 Push-button scale out and scale up (elastic scale).\\nThe main disadvantage of PaaS traditionally h\", \"as been vendor lock-in. For example, some PaaS \\nproviders only support ASP.NET, Node.js, or other sp\", \"ecific languages and platforms. Products like \\nAzure App Service have evolved to address multiple pl\", \"atforms and support a variety of languages and \\nframeworks for hosting web apps.\\nSoftware as a Servi\", \"ce (SaaS)\\nSoftware as a Service or SaaS is centrally hosted and available without local installation\", \" or \\nprovisioning. SaaS often is hosted on top of PaaS as a platform for deploying software. SaaS pr\", \"ovides \\nservices to run and connect with existing software. SaaS is often industry and vertical spec\", \"ific. SaaS is \\noften licensed and typically provides a client/server model. Most modern SaaS offerin\", \"gs use web-8 CHAPTER 1 | Architecture approaches\\nbased apps for the client. Companies typically cons\", \"ider SaaS as a business solution to license \\nofferings. It isn\\u2019t often implemented as architecture c\", \"onsideration for scalability and maintainability of \\nan application. Indeed, most SaaS solutions are\", \" built on IaaS, PaaS, and/or serverless back ends.\\nLearn more about SaaS through a sample applicatio\", \"n.\\nContainers and Functions as a Service (FaaS)\\nContainers are an interesting solution that enables \", \"PaaS-like benefits without the IaaS overhead. A \\ncontainer is essentially a runtime that contains th\", \"e bare essentials needed to run a unique application. \\nThe kernel or core part of the host operating\", \" system and services such as storage are shared across a \\nhost. The shared kernel enables containers\", \" to be lightweight (some are mere megabytes in size, \\ncompared to the gigabyte size of typical virtu\", \"al machines). With hosts already running, containers can \\nbe started quickly, facilitating high avai\", \"lability. The ability to spin up containers quickly also provides \\nextra layers of resiliency. Docke\", \"r is one of the more popular implementations of containers.\\nBenefits of containers include:\\n\\u2022 Lightw\", \"eight and portable\\n\\u2022 Self-contained so no need to install dependencies\\n\\u2022 Provide a consistent enviro\", \"nment regardless of the host (runs exactly same on a laptop as on a \\ncloud server)\\n\\u2022 Can be provisio\", \"ned quickly for scale-out\\n\\u2022 Can be restarted quickly to recover from failure\\nA container runs on a c\", \"ontainer host (that in turn may run on a bare metal machine or a virtual \\nmachine). Multiple contain\", \"ers or instances of the same containers may run on a single host. For true \\nfailover and resiliency,\", \" containers must be scaled across hosts.\\nFor more information about Docker containers, see What is D\", \"ocker.\\nManaging containers across hosts typically requires an orchestration tool such as Kubernetes.\", \" \\nConfiguring and managing orchestration solutions may add additional overhead and complexity to \\npr\", \"ojects. Fortunately, many cloud providers provide orchestration services through PaaS solutions to \\n\", \"simplify the management of containers.\\nThe following image illustrates an example Kubernetes install\", \"ation. Nodes in the installation address \\nscale out and failover. They run Docker container instance\", \"s that are managed by the primary server. \\nThe kubelet is the client that relays commands from Kuber\", \"netes to Docker.9 CHAPTER 1 | Architecture approaches\\nFor more information about orchestration, see \", \"Kubernetes on Azure.\\nFunctions as a Service (FaaS) is a specialized container service that is simila\", \"r to serverless. A specific \\nimplementation of FaaS, called OpenFaaS, sits on top of containers to p\", \"rovide serverless capabilities. \\nOpenFaaS provides templates that package all of the container depen\", \"dencies necessary to run a piece \\nof code. Using templates simplifies the process of deploying code \", \"as a functional unit. OpenFaaS \\ntargets architectures that already include containers and orchestrat\", \"ors because it can use the existing \\ninfrastructure. Although it provides serverless functionality, \", \"it specifically requires you to use Docker \\nand an orchestrator.\\nServerless\\nA serverless architectur\", \"e provides a clear separation between the code and its hosting environment. \\nYou implement code in a\", \" function that is invoked by a trigger. After that function exits, all its needed \\nresources may be \", \"freed. The trigger might be manual, a timed process, an HTTP request, or a file \\nupload. The result \", \"of the trigger is the execution of code. Although serverless platforms vary, most \\nprovide access to\", \" pre-defined APIs and bindings to streamline tasks such as writing to a database or \\nqueueing result\", \"s.\\nServerless is an architecture that relies heavily on abstracting away the host environment to foc\", \"us on \\ncode. It can be thought of as less server.\\nContainer solutions provide developers existing bu\", \"ild scripts to publish code to serverless-ready \\nimages. Other implementations use existing PaaS sol\", \"utions to provide a scalable architecture.\\nThe abstraction means the DevOps team doesn\\u2019t have to pro\", \"vision or manage servers, nor specific \\ncontainers. The serverless platform hosts code, either as sc\", \"ript or packaged executables built with a \\nrelated SDK, and allocates the necessary resources for th\", \"e code to scale.\\nThe following diagram illustrates four serverless components. An HTTP request cause\", \"s the Checkout \\nAPI code to run. The Checkout API inserts code into a database, and the insert trigg\", \"ers several other \\nfunctions to run to perform tasks like computing tasks and fulfilling the order.1\", \"0 CHAPTER 1 | Architecture approaches\\nThe advantages of serverless include:\\n\\u2022 High density. Many ins\", \"tances of the same serverless code can run on the same host compared \\nto containers or virtual machi\", \"nes. The instances scale across multiple hosts addressing scale out \\nand resiliency.\\n\\u2022 Micro-billing\", \". Most serverless providers bill based on serverless executions, enabling massive \\ncost savings in c\", \"ertain scenarios.\\n\\u2022 Instant scale. Serverless can scale to match workloads automatically and quickly\", \".\\n\\u2022 Faster time to market. Developers focus on code and deploy directly to the serverless platform. \", \"\\nComponents can be released independently of each other.\\nServerless is most often discussed in the c\", \"ontext of compute, but can also apply to data. For example, \\nAzure SQL and Cosmos DB both provide cl\", \"oud databases that don\\u2019t require you to configure host \\nmachines or clusters. This book focuses on s\", \"erverless compute.\\nSummary\\nThere\\u2019s a broad spectrum of available choices for architecture, including\", \" a hybrid approach. Serverless \\nsimplifies the approach, management, and cost of application feature\", \"s at the expense of control and \\nportability. However, many serverless platforms do expose configura\", \"tion to help fine-tune the \\nsolution. Good programming practices can also lead to more portable code\", \" and less serverless \\nplatform lock-in. The following table illustrates the architecture approaches \", \"side by side. Choose \\nserverless based on your scale needs, whether or not you want to manage the ru\", \"ntime, and how well \\nyou can break your workloads into small components. You\\u2019ll learn about potentia\", \"l challenges with \\nserverless and other decision points in the next chapter.\\nIaaS PaaS Container Ser\", \"verless\\nScale VM Instance App Function\\nAbstracts Hardware Platform OS Host Runtime\\nUnit VM Project I\", \"mage Code11 CHAPTER 1 | Architecture approaches\\nIaaS PaaS Container Serverless\\nLifetime Months Days \", \"to Months Minutes to Days Milliseconds \\nto Minutes\\nResponsibility Applications, \\ndependencies, runti\", \"me, \\nand operating system\\nApplications and \\ndependencies\\nApplications, \\ndependencies, and \\nruntime\\nF\", \"unction\\n\\u2022 Scale refers to the unit that is used to scale the application\\n\\u2022 Abstracts refers to the l\", \"ayer that is abstracted by the implementation\\n\\u2022 Unit refers to the scope of what is deployed\\n\\u2022 Lifet\", \"ime refers to the typical runtime of a specific instance\\n\\u2022 Responsibility refers to the overhead to \", \"build, deploy, and maintain the application\\nThe next chapter will focus on serverless architecture, \", \"use cases, and design patterns.\\nRecommended resources\\n\\u2022 Azure application architecture guide\\n\\u2022 Azure\", \" Cosmos DB\\n\\u2022 Azure SQL\\n\\u2022 N-Tier architecture pattern\\n\\u2022 Kubernetes on Azure\\n\\u2022 Microservices\\n\\u2022 Virtual\", \" machine N-tier reference architecture\\n\\u2022 Virtual machines\\n\\u2022 What is Docker?\\n\\u2022 Wingtip Tickets SaaS a\", \"pplication12 CHAPTER 2 | Serverless architecture\\nCHAPTER 2\\nServerless architecture\\nThere are many ap\", \"proaches to using serverless architectures. This chapter explores examples of \\ncommon architectures \", \"that integrate serverless. It also covers concerns that may pose additional \\nchallenges or require e\", \"xtra consideration when implementing serverless. Finally, several design \\nexamples are provided that\", \" illustrate various serverless use cases.\\nServerless hosts often use an existing container-based or \", \"PaaS layer to manage the serverless \\ninstances. For example, Azure Functions is based on Azure App S\", \"ervice. The App Service is used to \\nscale out instances and manage the runtime that executes Azure F\", \"unctions code. For Windows-based \\nfunctions, the host runs as PaaS and scales out the .NET runtime. \", \"For Linux-based functions, the host \\nleverages containers.\\nThe WebJobs Core provides an execution co\", \"ntext for the function. The Language Runtime runs scripts, \\nexecutes libraries and hosts the framewo\", \"rk for the target language. For example, Node.js is used to \\nrun JavaScript functions and the .NET F\", \"ramework is used to run C# functions. You\\u2019ll learn more about \\nlanguage and platform options later i\", \"n this chapter.\\nSome projects may benefit from taking an \\u201call-in\\u201d approach to serverless. Applicatio\", \"ns that rely heavily \\non microservices may implement all microservices using serverless technology. \", \"The majority of apps \\nare hybrid, following an N-tier design and using serverless for the components\", \" that make sense 13 CHAPTER 2 | Serverless architecture\\nbecause the components are modular and indep\", \"endently scalable. To help make sense of these \\nscenarios, this section walks through some common ar\", \"chitecture examples that use serverless.\\nFull serverless back end\\nThe full serverless back end is id\", \"eal for several types of scenarios, especially when building new or \\n\\u201cgreen field\\u201d applications. An \", \"application with a large surface area of APIs may benefit from \\nimplementing each API as a serverles\", \"s function. Apps that are based on microservices architecture are \\nanother example that could be imp\", \"lemented as a full serverless back end. The microservices \\ncommunicate over various protocols with e\", \"ach other. Specific scenarios include:\\n\\u2022 API-based SaaS products (example: financial payments proces\", \"sor).\\n\\u2022 Message-driven applications (example: device monitoring solution).\\n\\u2022 Apps focused on integra\", \"tion between services (example: airline booking application).\\n\\u2022 Processes that run periodically (exa\", \"mple: timer-based database clean-up).\\n\\u2022 Apps focused on data transformation (example: import trigger\", \"ed by file upload).\\n\\u2022 Extract Transform and Load (ETL) processes.\\nThere are other, more specific use\", \" cases that are covered later in this document.\\nMonoliths and \\u201cstarving the beast\\u201d\\nA common challeng\", \"e is migrating an existing monolithic application to the cloud. The least risky \\napproach is to \\u201clif\", \"t and shift\\u201d entirely onto virtual machines. Many shops prefer to use the migration as \\nan opportuni\", \"ty to modernize their code base. A practical approach to migration is called \\u201cstarving the \\nbeast.\\u201d \", \"In this scenario, the monolith is migrated \\u201cas is\\u201d to start with. Then, selected services are \\nmoder\", \"nized. In some cases, the signature of the service is identical to the original: it simply is hosted\", \" \\nas a function. Clients are updated to use the new service rather than the monolith endpoint. In th\", \"e \\ninterim, steps such as database replication enable microservices to host their own storage even w\", \"hen \\ntransactions are still handled by the monolith. Eventually, all clients are migrated onto the n\", \"ew \\nservices. The monolith is \\u201cstarved\\u201d (its services no longer called) until all functionality has \", \"been \\nreplaced. The combination of serverless and proxies can facilitate much of this migration.14 C\", \"HAPTER 2 | Serverless architecture\\nTo learn more about this approach, watch the video: Bring your ap\", \"p to the cloud with serverless Azure \\nFunctions.\\nWeb apps\\nWeb apps are great candidates for serverle\", \"ss applications. There are two common approaches to web \\napps today: server-driven, and client-drive\", \"n (such as Single Page Application or SPA). Server-driven \\nweb apps typically use a middleware layer\", \" to issue API calls to render the web UI. SPA applications \\nmake REST API calls directly from the br\", \"owser. In both scenarios, serverless can accommodate the \\nmiddleware or REST API request by providin\", \"g the necessary business logic. A common architecture is \\nto stand up a lightweight static web serve\", \"r. The Single Page Application (SPA) serves HTML, CSS, \\nJavaScript, and other browser assets. The we\", \"b app then connects to a microservices back end.\\nMobile back ends\\nThe event-driven paradigm of serve\", \"rless apps makes them ideal as mobile back ends. The mobile \\ndevice triggers the events and the serv\", \"erless code executes to satisfy requests. Taking advantage of a \\nserverless model enables developers\", \" to enhance business logic without having to deploy a full \\napplication update. The serverless appro\", \"ach also enables teams to share endpoints and work in \\nparallel.\\nMobile developers can build busines\", \"s logic without becoming experts on the server side. Traditionally, \\nmobile apps connected to on-pre\", \"mises services. Building the service layer required understanding the \\nserver platform and programmi\", \"ng paradigm. Developers worked with operations to provision servers 15 CHAPTER 2 | Serverless archit\", \"ecture\\nand configure them appropriately. Sometimes days or even weeks were spent on building a \\ndepl\", \"oyment pipeline. All of these challenges are addressed by serverless.\\nServerless abstracts the serve\", \"r-side dependencies and enables the developer to focus on business \\nlogic. For example, a mobile dev\", \"eloper who builds apps using a JavaScript framework can build \\nserverless functions with JavaScript \", \"as well. The serverless host manages the operating system, a \\nNode.js instance to host the code, pac\", \"kage dependencies, and more. The developer is provided a \\nsimple set of inputs and a standard templa\", \"te for outputs. They then can focus on building and testing \\nthe business logic. They\\u2019re therefore a\", \"ble to use existing skills to build the back-end logic for the \\nmobile app without having to learn n\", \"ew platforms or become a \\u201cserver-side developer.\\u201d\\nMost cloud providers offer mobile-based serverless\", \" products that simplify the entire mobile \\ndevelopment lifecycle. The products may automate the prov\", \"isioning of databases to persist data, \\nhandle DevOps concerns, provide cloud-based builds and testi\", \"ng frameworks and the ability to script \\nbusiness processes using the developer\\u2019s preferred language\", \". Following a mobile-centric serverless \\napproach can streamline the process. Serverless removes the\", \" tremendous overhead of provisioning, \\nconfiguring, and maintaining servers for the mobile back end.\", \"\\nInternet of Things (IoT)\\nIoT refers to physical objects that are networked together. They\\u2019re someti\", \"mes referred to as \\n\\u201cconnected devices\\u201d or \\u201csmart devices.\\u201d Everything from cars and vending machine\", \"s may be \\nconnected and send information ranging from inventory to sensor data such as temperature a\", \"nd \\nhumidity. In the enterprise, IoT provides business process improvements through monitoring and \\n\", \"automation. IoT data may be used to regulate the climate in a large warehouse or track inventory \\nth\", \"rough the supply chain. IoT can sense chemical spills and call the fire department when smoke is \\nde\", \"tected.\\nThe sheer volume of devices and information often dictates an event-driven architecture to r\", \"oute and \\nprocess messages. Serverless is an ideal solution for several reasons:\\n\\u2022 Enables scale as \", \"the volume of devices and data increases.\\n\\u2022 Accommodates adding new endpoints to support new devices\", \" and sensors.\\n\\u2022 Facilitates independent versioning so developers can update the business logic for a\", \" specific \\ndevice without having to deploy the entire system.\\n\\u2022 Resiliency and less downtime.16 CHAP\", \"TER 2 | Serverless architecture\\nThe pervasiveness of IoT has resulted in several serverless products\", \" that focus specifically on IoT \\nconcerns, such as Azure IoT Hub. Serverless automates tasks such as\", \" device registration, policy \\nenforcement, tracking, and even deployment of code to devices at the e\", \"dge. The edge refers to \\ndevices like sensors and actuators that are connected to, but not an active\", \" part of, the Internet.\\nServerless architecture considerations\\nAdopting a serverless architecture do\", \"es come with certain challenges. This section explores some of \\nthe more common considerations to be\", \" aware of. All of these challenges have solutions. As with all \\narchitecture choices, the decision t\", \"o go serverless should be made only after carefully considering the \\npros and cons. Depending on the\", \" needs of your application, you may decide a serverless \\nimplementation isn\\u2019t the right solution for\", \" certain components.\\nManaging state\\nServerless functions, as with microservices in general, are stat\", \"eless by default. Avoiding state enables \\nserverless to be ephemeral, to scale out, and to provide r\", \"esiliency without a central point of failure. In \\nsome circumstances, business processes require sta\", \"te. If your process requires state, you have two \\noptions. You can adopt a model other than serverle\", \"ss, or interact with a separate service that provides \\nstate. Adding state can complicate the soluti\", \"on and make it harder to scale, and potentially create a \\nsingle point of failure. Carefully conside\", \"r whether your function absolutely requires state. If the answer \\nis \\u201cyes,\\u201d determine whether it sti\", \"ll makes sense to implement it with serverless.\\nThere are several solutions to adopt state without c\", \"ompromising the benefits of serverless. Some of \\nthe more popular solutions include:\\n\\u2022 Use a tempora\", \"ry data store or distributed cache, like Redis\\n\\u2022 Store state in a database, like SQL or CosmosDB\\n\\u2022 H\", \"andle state through a workflow engine like durable functions\\nThe bottom line is that you should be a\", \"ware of the need for any state management within processes \\nyou\\u2019re considering to implement with ser\", \"verless.\\nLong-running processes\\nMany benefits of serverless rely on the processes being ephemeral. S\", \"hort run times make it easier for \\nthe serverless provider to free up resources as functions end and\", \" share functions across hosts. Most \\ncloud providers limit the total time your function can run to a\", \"round 10 minutes. If your process may \\ntake longer, you might consider an alternative implementation\", \".\\nThere are a few exceptions and solutions. One solution may be to break your process into smaller \\n\", \"components that individually take less time to run. If your process runs long because of dependencie\", \"s, \\nyou can also consider an asynchronous workflow using a solution like durable functions. Durable \", \"\\nfunctions pause and maintain the state of your process while it\\u2019s waiting on an external process to\", \" \\nfinish. Asynchronous handling reduces the time the actual process runs.17 CHAPTER 2 | Serverless a\", \"rchitecture\\nStartup time\\nOne potential concern with serverless implementations is startup time. To c\", \"onserve resources, many \\nserverless providers create infrastructure \\u201con demand.\\u201d When a serverless f\", \"unction is triggered after a \\nperiod of time, the resources to host the function may need to be crea\", \"ted or restarted. In some \\nsituations, cold starts may result in delays of several seconds. Startup \", \"time varies across providers and \\nservice levels. There are a few approaches to address startup time\", \" if it\\u2019s important to minimize for the \\nsuccess of the app.\\n\\u2022 Some providers allow users to pay for \", \"service levels that guarantee infrastructure is \\u201calways on\\u201d.\\n\\u2022 Implement a keep-alive mechanism (pin\", \"g the endpoint to keep it \\u201cawake\\u201d).\\n\\u2022 Use orchestration like Kubernetes with a containerized functio\", \"n approach (the host is already \\nrunning so spinning up new instances is extremely fast).\\nDatabase u\", \"pdates and migrations\\nAn advantage of serverless code is that you can release new functions without \", \"having to redeploy the \\nentire application. This advantage can become a disadvantage when there\\u2019s a \", \"relational database \\ninvolved. Changes to database schemas are difficult to synchronize with serverl\", \"ess updates. Additional \\nchallenges are posed when things go wrong and the changes must be rolled ba\", \"ck. Data integrity is \\none reason that a best practice for microservices and serverless functions is\", \" that they own their own \\ndata. It is possible to deploy changes as a single unit of compute and dat\", \"a. The reality is that many \\nlegacy systems feature a large back-end database that must be reconcile\", \"d with the serverless \\narchitecture.\\nA popular approach to solve schema versioning is to never modif\", \"y existing properties and columns, \\nbut instead add new information. For example, consider a change \", \"to move from a Boolean \\n\\u201ccompleted\\u201d flag for a todo list to a \\u201ccompleted date.\\u201d Instead of removing \", \"the old field, the database \\nchange will:\\n1. Add a new \\u201ccompleted date\\u201d field.\\n2. Transform the \\u201ccom\", \"pleted\\u201d Boolean field to a computed function that evaluates whether the \\ncompleted date is after the\", \" current date.\\n3. Add a trigger to set the completed date to the current date when the completed Boo\", \"lean is set \\nto true.\\nThe sequence of changes ensures that legacy code continues to run \\u201cas is\\u201d whil\", \"e newer serverless \\nfunctions can take advantage of the new field.\\nFor more information about data i\", \"n serverless architectures, see Challenges and solutions for \\ndistributed data management.\\nScaling\\nI\", \"t\\u2019s a common misconception that serverless means \\u201cno server.\\u201d It\\u2019s in fact \\u201cless server.\\u201d The fact t\", \"here \\nis a backing infrastructure is important to understand when it comes to scaling. Most serverle\", \"ss \\nplatforms provide a set of controls to handle how the infrastructure should scale when event den\", \"sity \\nincreases. You can choose from a variety of options, but your strategy may vary depending on t\", \"he 18 CHAPTER 2 | Serverless architecture\\nfunction. Furthermore, functions are typically run under a\", \" related host, so that functions on the same \\nhost have the same scale options. Therefore it is nece\", \"ssary to organize and strategize which functions \\nare hosted together based on scale requirements.\\nR\", \"ules often specify how to scale-up (increase the host resources) and scale-out (increase the number \", \"\\nof host instances) based on varying parameters. Triggers for scales may include schedule, request \\n\", \"rates, CPU utilization, and memory usage. Higher performance often comes at a greater cost. The less\", \" \\nexpensive, consumption-based approaches may not scale as quickly when the request rate suddenly \\ni\", \"ncreases. There is a trade-off between paying up front \\u201cinsurance cost\\u201d versus paying strictly \\u201cas y\", \"ou \\ngo\\u201d and risking slower responses due to sudden increases in demand.\\nMonitoring, tracing, and log\", \"ging\\nAn often overlooked aspect of DevOps is monitoring applications once deployed. It\\u2019s important t\", \"o \\nhave a strategy for monitoring serverless functions. The biggest challenge is often correlation, \", \"or \\nrecognizing when a user calls multiple functions as part of the same interaction. Most serverles\", \"s \\nplatforms allow console logging that can be imported into third-party tools. There are also optio\", \"ns to \\nautomate collection of telemetry, generate and track correlation IDs, and monitor specific ac\", \"tions to \\nprovide detailed insights. Azure provides the advanced Application Insights platform for m\", \"onitoring \\nand analytics.\\nInter-service dependencies\\nA serverless architecture may include functions\", \" that rely on other functions. In fact, it isn\\u2019t uncommon \\nin a serverless architecture to have mult\", \"iple services call each other as part of an interaction or \\ndistributed transaction. To avoid strong\", \" coupling, it\\u2019s recommended that services don\\u2019t reference each \\nother directly. When the endpoint fo\", \"r a service needs to change, direct references could result in \\nmajor refactoring. A suggested solut\", \"ion is to provide a service discovery mechanism, such as a \\nregistry, that provides the appropriate \", \"end point for a request type. Another solution is to leverage \\nmessaging services like queues or top\", \"ics for communication between services.\\nManaging failure and providing resiliency\\nIt\\u2019s also importan\", \"t to consider the circuit-breaker pattern: If, for some reason, a service continues to \\nfail, it isn\", \"\\u2019t advisable to call that service repeatedly. Instead, an alternative service is called or a \\nmessag\", \"e returned until the health of the dependent service is re-established. The serverless \\narchitecture\", \" needs to take into account the strategy for resolving and managing inter-service \\ndependencies.\\nTo \", \"continue the circuit-breaker pattern, services need to be fault tolerant and resilient. Fault tolera\", \"nce \\nrefers to the ability of your application to continue running even after unexpected exceptions \", \"or \\ninvalid states are encountered. Fault tolerance is typically a function of the code itself and h\", \"ow it\\u2019s \\nwritten to handle exceptions. Resiliency refers to how capable the app is at recovering fro\", \"m failures. \\nResiliency is often managed by the serverless platform. The platform should be able to \", \"spin up a new \\nserverless function instance when the existing one fails. The platform should also be\", \" intelligent \\nenough to stop spinning up new instances when every new instance fails.19 CHAPTER 2 | \", \"Serverless architecture\\nFor more information, see Implementing the Circuit Breaker pattern.\\nVersioni\", \"ng and green/blue deployments\\nA major benefit of serverless is the ability to upgrade a specific fun\", \"ction without having to redeploy \\nthe entire application. For upgrades to be successful, functions m\", \"ust be versioned so that services \\ncalling them are routed to the correct version of code. A strateg\", \"y for deploying new versions is also \\nimportant. A common approach is to use \\u201cgreen/blue deployments\", \".\\u201d The green deployment is the \\ncurrent function. A new \\u201cblue\\u201d version is deployed to production and\", \" tested. When testing passes, the \\ngreen and blue versions are swapped so the new version comes live\", \". If any issues are encountered, \\nthey can be swapped back. Supporting versioning and green/blue dep\", \"loyments requires a \\ncombination of authoring the functions to accommodate version changes and worki\", \"ng with the \\nserverless platform to handle deployments.\\nServerless design examples\\nThere are many de\", \"sign patterns that exist for serverless. This section captures some common \\nscenarios that use serve\", \"rless. What all of the examples have in common is the fundamental \\ncombination of an event trigger a\", \"nd business logic.\\nScheduling\\nScheduling tasks is a common function. The following diagram shows a l\", \"egacy database that doesn\\u2019t \\nhave appropriate integrity checks. The database must be scrubbed period\", \"ically. The serverless \\nfunction finds invalid data and cleans it. The trigger is a timer that runs \", \"the code on a schedule.\\nCommand and Query Responsibility Segregation (CQRS)\\nCommand and Query Respon\", \"sibility Segregation (CQRS) is a pattern that provides different interfaces \\nfor reading (or queryin\", \"g) data and operations that modify data. It addresses several common \\nproblems. In traditional Creat\", \"e Read Update Delete (CRUD) based systems, conflicts can arise from \\nhigh volume of both reads and w\", \"rites to the same data store. Locking may frequently occur and \\ndramatically slow down reads. Often,\", \" data is presented as a composite of several domain objects and \\nread operations must combine data f\", \"rom different entities.\\nUsing CQRS, a read might involve a special \\u201cflattened\\u201d entity that models da\", \"ta the way it\\u2019s consumed. \\nThe read is handled differently than how it\\u2019s stored. For example, althou\", \"gh the database may store a \\ncontact as a header record with a child address record, the read could \", \"involve an entity with both 20 CHAPTER 2 | Serverless architecture\\nheader and address properties. Th\", \"ere are myriad approaches to creating the read model. It might be \\nmaterialized from views. Update o\", \"perations could be encapsulated as isolated events that then trigger \\nupdates to two different model\", \"s. Separate models exist for reading and writing.\\nServerless can accommodate the CQRS pattern by pro\", \"viding the segregated endpoints. One serverless \\nfunction accommodates queries or reads, and a diffe\", \"rent serverless function or set of functions \\nhandles update operations. A serverless function may a\", \"lso be responsible for keeping the read model \\nup-to-date, and can be triggered by the database\\u2019s ch\", \"ange feed. Front-end development is simplified \\nto connecting to the necessary endpoints. Processing\", \" of events is handled on the back end. This \\nmodel also scales well for large projects because diffe\", \"rent teams may work on different operations.\\nEvent-based processing\\nIn message-based systems, events\", \" are often collected in queues or publisher/subscriber topics to be \\nacted upon. These events can tr\", \"igger serverless functions to execute a piece of business logic. An \\nexample of event-based processi\", \"ng is event-sourced systems. An \\u201cevent\\u201d is raised to mark a task as \\ncomplete. A serverless function\", \" triggered by the event updates the appropriate database document. A \\nsecond serverless function may\", \" use the event to update the read model for the system. Azure Event \\nGrid provides a way to integrat\", \"e events with functions as subscribers.\\nEvents are informational messages. For more information, see\", \" Event Sourcing pattern.\\nFile triggers and transformations\\nExtract, Transform, and Load (ETL) is a c\", \"ommon business function. Serverless is a great solution for ETL \\nbecause it allows code to be trigge\", \"red as part of a pipeline. Individual code components can address \\nvarious aspects. One serverless f\", \"unction may download the file, another applies the transformation, \\nand another loads the data. The \", \"code can be tested and deployed independently, making it easier to \\nmaintain and scale where needed.\", \"21 CHAPTER 2 | Serverless architecture\\nIn the diagram, \\u201ccool storage\\u201d provides data that is parsed i\", \"n Azure Stream Analytics. Any issues \\nencountered in the data stream trigger an Azure Function to ad\", \"dress the anomaly.\\nAsynchronous background processing and messaging\\nAsynchronous messaging and backg\", \"round processing allow applications to kick off processes without \\nhaving to wait. An example of asy\", \"nchronous processing is an OCR app. An image is submitted and \\nqueued for processing. Scanning the i\", \"mage to extract text may take time, and once it\\u2019s finished a \\nnotification is sent. Serverless can h\", \"andle both the invocation and the result in this scenario.\\nWeb apps and APIs\\nA popular scenario for \", \"serverless is N-tier applications, most commonly ones where the UI layer is a \\nweb app. The populari\", \"ty of Single Page Applications (SPA) has surged recently. SPA apps render a \\nsingle page, then rely \", \"on API calls and the returned data to dynamically render new UI without \\nreloading a full page. Clie\", \"nt-side rendering provides a much faster, more responsive application to the \\nend user.\\nServerless e\", \"ndpoints triggered by HTTP calls can be used to handle the API requests. For example, an \\nad service\", \"s company may call a serverless function with user profile information to request custom \\nadvertisin\", \"g. The serverless function returns the custom ad and the web page renders it.22 CHAPTER 2 | Serverle\", \"ss architecture\\nData pipeline\\nServerless functions can be used to facilitate a data pipeline. In thi\", \"s example, a file triggers a function \\nto translate data in a CSV file to data rows in a table. The \", \"organized table allows a Power BI dashboard \\nto present analytics to the end user.\\nStream processing\", \"\\nDevices and sensors often generate streams of data that must be processed in real time. There are a\", \" \\nnumber of technologies that can capture messages and streams from Event Hubs and IoT Hub to \\nServi\", \"ce Bus. Regardless of transport, serverless is an ideal mechanism for processing the messages \\nand s\", \"treams of data as they come in. Serverless can scale quickly to meet the demand of large \\nvolumes of\", \" data. The serverless code can apply business logic to parse the data and output in a \\nstructured fo\", \"rmat for action and analytics.23 CHAPTER 2 | Serverless architecture\\nAPI gateway\\nAn API gateway prov\", \"ides a single point of entry for clients and then intelligently routes requests to \\nback-end service\", \"s. It\\u2019s useful to manage large sets of services. It can also handle versioning and \\nsimplify develop\", \"ment by easily connecting clients to disparate environments. Serverless can handle \\nback-end scaling\", \" of individual microservices while presenting a single front end via an API gateway.\\nRecommended res\", \"ources\\n\\u2022 Azure Event Grid\\n\\u2022 Azure IoT Hub\\n\\u2022 Challenges and solutions for distributed data management\", \"\\n\\u2022 Designing microservices: identifying microservice boundaries\\n\\u2022 Event Hubs\\n\\u2022 Event Sourcing patter\", \"n\\n\\u2022 Implementing the Circuit Breaker pattern\\n\\u2022 IoT Hub\\n\\u2022 Service Bus\\n\\u2022 Working with the change feed \", \"support in Azure Cosmos DB24 CHAPTER 3 | Azure serverless platform\\nCHAPTER 3CHAPTER 3\\nAzure serverle\", \"ss platform\\nThe Azure serverless platform includes Azure Functions, Logic Apps, and Event Grid. Thes\", \"e services \\nwork together and connect with myriad other resources. The serverless platform works wit\", \"h \\neverything from databases and storage to analytics and machine learning/artificial intelligence.\\n\", \"You can also use Application Insights, a serverless platform for capturing diagnostic traces and \\nte\", \"lemetry. Application Insights are available to applications of all types (desktop, mobile, or web) a\", \"s \\nwell as serverless implementations. The platform is visualized in the following diagram:\\nThis cha\", \"pter breaks down the fundamentals of each component.\\nAzure Functions\\nAzure Functions provide a serve\", \"rless compute experience. A function is invoked by a trigger (such as \\naccess to an HTTP endpoint or\", \" a timer) and executes a block of code or business logic. Functions also \\nsupport specialized bindin\", \"gs that connect to resources like storage and queues.25 CHAPTER 3 | Azure serverless platform\\nThe cu\", \"rrent runtime version 4.0 supports cross-platform .NET 7.0 applications. Additional languages \\nbesid\", \"es C# such as JavaScript, F#, and Java are supported. Functions created in the portal provide a \\nric\", \"h scripting syntax. Functions created as standalone projects can be deployed with full platform \\nsup\", \"port and capabilities.\\nFor more information, see Azure Functions documentation.\\nProgramming language\", \" support\\nThe following languages are all supported in general availability (GA).\\nLanguage Supported \", \"runtimes for 4.x\\nC# .NET 6.0, 7.0, .NET Framework 4.8\\nJavaScript Node 14, 16, 18\\nF# .NET 6.0, 7.0\\nJa\", \"va Java 8, 11, 17\\nPython Python 3.7, 3.8, 3.9, 3.10\\nTypeScript Node 14, 16, 18 (via JavaScript)\\nPowe\", \"rShell PowerShell Core 7.2\\nFor more information on other runtime versions, see Supported languages.\\n\", \"App service plans\\nFunctions are backed by an app service plan. The plan defines the resources used b\", \"y the functions \\napp. You can assign plans to a region, determine the size and number of virtual mac\", \"hines that will be \\nused, and pick a pricing tier. For a true serverless approach, function apps may\", \" use the consumption\\nplan. The consumption plan will scale the back end automatically based on load.\", \"\\nAnother hosting option for function apps is the Premium plan. This plan provides an \\u201calways on\\u201d \\nin\", \"stance to avoid cold start, supports advanced features like VNet connectivity, and runs on premium \\n\", \"hardware.\\nFor more information, see App service plans.\\nCreate your first function\\nThere are three co\", \"mmon ways you can create function apps.\\n\\u2022 Script functions in the portal.\\n\\u2022 Create the necessary res\", \"ources using the Azure CLI.\\n\\u2022 Build functions locally using your favorite IDE and publish them to Az\", \"ure.26 CHAPTER 3 | Azure serverless platform\\nFor more information on creating a scripted function in\", \" the portal, see Create your first function in the \\nAzure portal.\\nTo build from the Azure CLI, see C\", \"reate your first function using the Azure CLI.\\nTo create a function from Visual Studio, see Create y\", \"our first function using Visual Studio.\\nUnderstand triggers and bindings\\nFunctions are invoked by a \", \"trigger and can have exactly one. In addition to invoking the function, \\ncertain triggers also serve\", \" as bindings. You may also define multiple bindings in addition to the \\ntrigger. Bindings provide a \", \"declarative way to connect data to your code. They can be passed in (input) \\nor receive data (output\", \"). Triggers and bindings make functions easy to work with. Bindings remove the \\noverhead of manually\", \" creating database or file system connections. All of the information needed for \\nthe bindings is co\", \"ntained in a special functions.json file for scripts or declared with attributes in code.\\nSome commo\", \"n triggers include:\\n\\u2022 Blob Storage: invoke your function when a file or folder is uploaded or change\", \"d in storage.\\n\\u2022 HTTP: invoke your function like a REST API.\\n\\u2022 Queue: invoke your function when items\", \" exist in a queue.\\n\\u2022 Timer: invoke your function on a regular cadence.\\nExamples of bindings include:\", \"\\n\\u2022 CosmosDB: easily connect to the database to load or save files.\\n\\u2022 Table Storage: work with key/va\", \"lue storage from your function app.\\n\\u2022 Queue Storage: easily retrieve items from a queue, or place ne\", \"w items on the queue.\\nThe following example functions.json file defines a trigger and a binding:\\n{\\n \", \"\\\"bindings\\\": [\\n {\\n \\\"name\\\": \\\"myBlob\\\",\\n \\\"type\\\": \\\"blobTrigger\\\",\\n \\\"direction\\\": \\\"in\\\",\\n \\\"path\\\": \\\"images/{na\", \"me}\\\",\\n \\\"connection\\\": \\\"AzureWebJobsStorage\\\"\\n },\\n {\\n \\\"name\\\": \\\"$return\\\",\\n \\\"type\\\": \\\"queue\\\",\\n \\\"direction\\\"\", \": \\\"out\\\",\\n \\\"queueName\\\": \\\"images\\\",\\n \\\"connection\\\": \\\"AzureWebJobsStorage\\\"\\n }\\n ],\\n \\\"disabled\\\": false\\n}\\nIn\", \" this example, the function is triggered by a change to blob storage in the images container. The \\ni\", \"nformation for the file is passed in, so the trigger also acts as a binding. Another binding exists \", \"to put \\ninformation onto a queue named images.27 CHAPTER 3 | Azure serverless platform\\nHere is the C\", \"# script for the function:\\npublic static string Run(Stream myBlob, string name, TraceWriter log)\\n{\\n \", \"log.Info($\\\"C# Blob trigger function Processed blob\\\\n Name:{name} \\\\n Size: \\n{myBlob.Length} Bytes\\\");\\n\", \" return name;\\n}\\nThe example is a simple function that takes the name of the file that was modified o\", \"r uploaded to \\nblob storage, and places it on a queue for later processing.\\nFor a full list of trigg\", \"ers and bindings, see Azure Functions triggers and bindings concepts.\\nTelemetry with Application Ins\", \"ights\\nApplication Insights is a serverless diagnostics platform that enables developers to detect, t\", \"riage, and \\ndiagnose issues in web apps, mobile apps, desktop apps, and microservices. You can turn \", \"on \\nApplication Insights for function apps simply by flipping a switch in the portal. Application In\", \"sights \\nprovides all of these capabilities without you having to configure a server or set up your o\", \"wn \\ndatabase. All of Application Insights\\u2019 capabilities are provided as a service that automatically\", \" \\nintegrates with your apps.\\nAdding Application Insights to existing apps is as easy as adding an in\", \"strumentation key to your \\napplication\\u2019s settings. With Application Insights you can:\\n\\u2022 Create custo\", \"m charts and alerts based on metrics such as number of function invocations, the \\ntime it takes to r\", \"un a function, and exceptions\\n\\u2022 Analyze failures and server exceptions\\n\\u2022 Drill into performance by o\", \"peration and measure the time it takes to call third-party \\ndependencies\\n\\u2022 Monitor CPU usage, memory\", \", and rates across all servers that host your function apps\\n\\u2022 View a live stream of metrics includin\", \"g request count and latency for your function apps\\n\\u2022 Use Analytics to search, query, and create cust\", \"om charts over your function data28 CHAPTER 3 | Azure serverless platform\\nIn addition to built-in te\", \"lemetry, it\\u2019s also possible to generate custom telemetry. The following code \\nsnippet creates a cust\", \"om telemetry client using the instrumentation key set for the function app:\\npublic static TelemetryC\", \"lient telemetry = new TelemetryClient()\\n{\\n InstrumentationKey = \\nEnvironment.GetEnvironmentVariable(\", \"\\\"APPINSIGHTS_INSTRUMENTATIONKEY\\\")\\n};\\nThe following code measures how long it takes to insert a new r\", \"ow into an Azure Table Storage\\ninstance:\\nvar startTime = DateTime.UtcNow;\\nvar timer = System.Diagnos\", \"tics.Stopwatch.StartNew();\\nawait tableClient.AddEntityAsync(entry);\\ntelemetry.TrackDependency(\\\"Azure\", \"TableStorageInsert\\\", \\\"Insert\\\", startTime, timer.Elapsed, \\ntrue);\\nThe resulting performance graph is \", \"shown:29 CHAPTER 3 | Azure serverless platform\\nThe custom telemetry reveals the average time to inse\", \"rt a new row is 32.6 milliseconds.\\nApplication Insights provides a powerful, convenient way to log d\", \"etailed telemetry about your \\nserverless applications. You have full control over the level of traci\", \"ng and logging that is provided. \\nYou can track custom statistics such as events, dependencies, and \", \"page view. Finally, the powerful \\nanalytics enable you to write queries that ask important questions\", \" and generate charts and advanced \\ninsights.\\nFor more information, see Monitor Azure Functions.\\nAzur\", \"e Logic Apps\\nAzure Logic Apps provides a serverless engine to build automated workflows to integrate\", \" apps and \\ndata between cloud services and on-premises systems. You build workflows using a visual d\", \"esigner. \\nYou can trigger workflows based on events or timers and leverage connectors to integration\", \" \\napplications and facilitate business-to-business (B2B) communication. Logic Apps integrates \\nseaml\", \"essly with Azure Functions.\\nLogic Apps can do more than just connect your cloud services (like funct\", \"ions) with cloud resources \\n(like queues and databases). You can also orchestrate on-premises workfl\", \"ows with the on-premises \\ngateway. For example, you can use the Logic App to trigger an on-premises \", \"SQL stored procedure in \\nresponse to a cloud-based event or conditional logic in your workflow. Lear\", \"n more about Connecting \\nto on-premises data sources with Azure On-premises Data Gateway.30 CHAPTER \", \"3 | Azure serverless platform\\nLike Azure Functions, you kick off Logic App workflows with a trigger.\", \" There are many triggers for you \\nto choose from. The following capture shows just a few of the more\", \" popular ones out of hundreds \\nthat are available.\\nOnce the app is triggered, you can use the visual\", \" designer to build out steps, loops, conditions, and \\nactions. Any data ingested in a previous step \", \"is available for you to use in subsequent steps. The \\nfollowing workflow loads URLs from a CosmosDB \", \"database. It finds the ones with a host of t.co then \\nsearches for them on Twitter. If it finds corr\", \"esponding tweets, it updates the documents with the \\nrelated tweets by calling a function.31 CHAPTER\", \" 3 | Azure serverless platform\\nThe Logic Apps dashboard shows the history of running your workflows \", \"and whether each run \\ncompleted successfully or not. You can navigate into any given run and inspect\", \" the data used by each \\nstep for troubleshooting. Logic Apps also provides existing templates you ca\", \"n edit and are well suited \\nfor complex enterprise workflows.\\nTo learn more, see Azure Logic Apps.\\nE\", \"vent Grid\\nAzure Event Grid provides serverless infrastructure for event-based applications. You can \", \"publish to \\nEvent Grid from any source and consume messages from any platform. Event Grid also has b\", \"uilt-in \\nsupport for events from Azure resources to streamline integration with your applications. F\", \"or example, \\nyou can subscribe to blob storage events to notify your app when a file is uploaded. Yo\", \"ur application \\ncan then publish a custom event grid message that is consumed by other cloud or on-p\", \"remises \\napplications. Event Grid was built to reliably handle massive scale. You get the benefits o\", \"f publishing \\nand subscribing to messages without the overhead of setting up the necessary infrastru\", \"cture.32 CHAPTER 3 | Azure serverless platform\\nThe major features of event grid include:\\n\\u2022 Fully man\", \"aged event routing.\\n\\u2022 Near real-time event delivery at scale.\\n\\u2022 Broad coverage both inside and outsi\", \"de of Azure.\\nScenarios\\nEvent Grid addresses several different scenarios. This section covers three o\", \"f the most common ones.\\nOps automation\\nEvent Grid can help speed automation and simplify policy enfo\", \"rcement by notifying Azure \\nAutomation when infrastructure is provisioned.33 CHAPTER 3 | Azure serve\", \"rless platform\\nApplication integration\\nYou can use Event Grid to connect your app to other services.\", \" Using standard HTTP protocols, even \\nlegacy apps can be easily modified to publish Event Grid messa\", \"ges. Web hooks are available for other \\nservices and platforms to consume Event Grid messages.\\nServe\", \"rless apps\\nEvent Grid can trigger Azure Functions, Logic Apps, or your own custom code. A major bene\", \"fit of \\nusing Event Grid is that it uses a push mechanism to send messages when events occur. The pu\", \"sh \\narchitecture consumes fewer resources and scales better than polling mechanisms. Polling must ch\", \"eck \\nfor updates on a regular interval.\\nEvent Grid vs. other Azure messaging services\\nAzure provides\", \" several messaging services, including Event Hubs and Service Bus. Each is designed to \\naddress a sp\", \"ecific set of use cases. The following diagram provides a high-level overview of the \\ndifferences be\", \"tween the services.34 CHAPTER 3 | Azure serverless platform\\nFor a more in-depth comparison, see Comp\", \"are messaging services.\\nPerformance targets\\nUsing Event Grid you can take advantage of the following\", \" performance guarantees:\\n\\u2022 Subsecond end-to-end latency in the 99th percentile.\\n\\u2022 99.99% availabilit\", \"y.\\n\\u2022 10 million events per second per region.\\n\\u2022 100 million subscriptions per region.\\n\\u2022 50-ms publis\", \"her latency.\\n\\u2022 24-hour retry with exponential back-off for guaranteed delivery in the 1-day window.\\n\", \"\\u2022 Transparent regional failover.\\nEvent Grid schema\\nEvent Grid uses a standard schema to wrap custom \", \"events. The schema is like an envelope that wraps \\nyour custom data element. Here is an example Even\", \"t Grid message:\\n[{\\n \\\"id\\\": \\\"03e24f21-a955-43cc-8921-1f61a6081ce0\\\",\\n \\\"eventType\\\": \\\"myCustomEvent\\\",\\n \\\"s\", \"ubject\\\": \\\"foo/bar/12\\\",\\n \\\"eventTime\\\": \\\"2018-09-22T10:36:01+00:00\\\",\\n \\\"data\\\": {\\n \\\"favoriteColor\\\": \\\"blue\", \"\\\",\\n \\\"favoriteAnimal\\\": \\\"panther\\\",\\n \\\"favoritePlanet\\\": \\\"Jupiter\\\"\\n },\\n \\\"dataVersion\\\": \\\"1.0\\\"\\n}]\\nEverythin\", \"g about the message is standard except the data property. You can inspect the message and \\nuse the e\", \"ventType and dataVersion to de-serialize the custom portion of the payload.35 CHAPTER 3 | Azure serv\", \"erless platform\\nAzure resources\\nA major benefit of using Event Grid is the automatic messages produc\", \"ed by Azure. In Azure, resources \\nautomatically publish to a topic that allows you to subscribe for \", \"various events. The following table \\nlists the resource types, message types, and events that are av\", \"ailable automatically.\\nAzure \\nresource Event type Description\\nAzure \\nsubscription\\nMicrosoft.Resource\", \"s.ResourceWriteSuccess Raised when a resource create or \\nupdate operation succeeds.\\nMicrosoft.Resour\", \"ces.ResourceWriteFailure Raised when a resource create or \\nupdate operation fails.\\nMicrosoft.Resourc\", \"es.ResourceWriteCancel Raised when a resource create or \\nupdate operation is canceled.\\nMicrosoft.Res\", \"ources.ResourceDeleteSuccess Raised when a resource delete \\noperation succeeds.\\nMicrosoft.Resources.\", \"ResourceDeleteFailure Raised when a resource delete \\noperation fails.\\nMicrosoft.Resources.ResourceDe\", \"leteCancel Raised when a resource delete \\noperation is canceled. This event \\nhappens when a template\", \" deployment \\nis canceled.\\nBlob storage Microsoft.Storage.BlobCreated Raised when a blob is created.\\n\", \"Microsoft.Storage.BlobDeleted Raised when a blob is deleted.\\nEvent hubs Microsoft.EventHub.CaptureFi\", \"leCreated Raised when a capture file is created.\\nIoT Hub Microsoft.Devices.DeviceCreated Published w\", \"hen a device is registered \\nto an IoT hub.\\nMicrosoft.Devices.DeviceDeleted Published when a device i\", \"s deleted \\nfrom an IoT hub.\\nResource \\ngroups\\nMicrosoft.Resources.ResourceWriteSuccess Raised when a \", \"resource create or \\nupdate operation succeeds.\\nMicrosoft.Resources.ResourceWriteFailure Raised when \", \"a resource create or \\nupdate operation fails.\\nMicrosoft.Resources.ResourceWriteCancel Raised when a \", \"resource create or \\nupdate operation is canceled.\\nMicrosoft.Resources.ResourceDeleteSuccess Raised w\", \"hen a resource delete \\noperation succeeds.\\nMicrosoft.Resources.ResourceDeleteFailure Raised when a r\", \"esource delete \\noperation fails.36 CHAPTER 3 | Azure serverless platform\\nAzure \\nresource Event type \", \"Description\\nMicrosoft.Resources.ResourceDeleteCancel Raised when a resource delete \\noperation is can\", \"celed. This event \\nhappens when a template deployment \\nis canceled.\\nFor more information, see Azure \", \"Event Grid event schema.\\nYou can access Event Grid from any type of application, even one that runs \", \"on-premises.\\nConclusion\\nIn this chapter you learned about the Azure serverless platform that is comp\", \"osed of Azure Functions, \\nLogic Apps, and Event Grid. You can use these resources to build an entire\", \"ly serverless app \\narchitecture, or create a hybrid solution that interacts with other cloud resourc\", \"es and on-premises \\nservers. Combined with a serverless data platform such as Azure SQL or CosmosDB,\", \" you can build fully \\nmanaged cloud native applications.\\nRecommended resources\\n\\u2022 App service plans\\n\\u2022\", \" Application Insights\\n\\u2022 Application Insights Analytics\\n\\u2022 Azure: Bring your app to the cloud with ser\", \"verless Azure Functions\\n\\u2022 Azure Event Grid\\n\\u2022 Azure Event Grid event schema\\n\\u2022 Azure Event Hubs\\n\\u2022 Azur\", \"e Functions documentation\\n\\u2022 Azure Functions triggers and bindings concepts\\n\\u2022 Azure Logic Apps\\n\\u2022 Azur\", \"e Service Bus\\n\\u2022 Azure Table Storage\\n\\u2022 Connecting to on-premises data sources with Azure On-premises \", \"Data Gateway\\n\\u2022 Create your first function in the Azure portal\\n\\u2022 Create your first function using the\", \" Azure CLI\\n\\u2022 Create your first function using Visual Studio\\n\\u2022 Functions supported languages\\n\\u2022 Monito\", \"r Azure Functions37 CHAPTER 4 | Durable Azure Functions\\nCHAPTER 4CHAPTER 4\\nDurable Azure Functions\\nW\", \"hen creating serverless applications with Azure Functions, your operations will typically be designe\", \"d \\nto run in a stateless manner. The reason for this design choice is because as the platform scales\", \", it \\nbecomes difficult to know what servers the code is running on. It also becomes difficult to kn\", \"ow how \\nmany instances are active at any given point. However, there are classes of applications tha\", \"t require \\nthe current state of a process to be known. Consider the process of submitting an order t\", \"o an online \\nstore. The checkout operation might be a workflow that is composed of multiple operatio\", \"ns that need \\nto know the state of the process. Such information may include the product inventory, \", \"if the customer \\nhas any credits on their account, and also the results of processing the credit car\", \"d. These operations \\ncould easily be their own internal workflows or even services from third-party \", \"systems.\\nVarious patterns exist today that assist with the coordination of application state between\", \" internal and \\nexternal systems. It\\u2019s common to come across solutions that rely on centralized queui\", \"ng systems, \\ndistributed key-value stores, or shared databases to manage that state. However, these \", \"are all \\nadditional resources that now need to be provisioned and managed. In a serverless environme\", \"nt, your \\ncode could become cumbersome trying to coordinate with these resources manually. Azure Fun\", \"ctions \\noffers an alternative for creating stateful functions called Durable Functions.\\nDurable Func\", \"tions is an extension to the Azure Functions runtime that enables the definition of \\nstateful workfl\", \"ows in code. By breaking down workflows into activities, the Durable Functions \\nextension can manage\", \" state, create progress checkpoints, and handle the distribution of function calls \\nacross servers. \", \"In the background, it makes use of an Azure Storage account to persist execution \\nhistory, schedule \", \"activity functions and retrieve responses. Your serverless code should never interact \\nwith persiste\", \"d information in that storage account, and is typically not something with which \\ndevelopers need to\", \" interact.\\nTriggering a stateful workflow\\nStateful workflows in Durable Functions can be broken down\", \" into two intrinsic components; \\norchestration and activity triggers. Triggers and bindings are core\", \" components used by Azure \\nFunctions to enable your serverless functions to be notified when to star\", \"t, receive input, and return \\nresults.\\nWorking with the Orchestration client\\nOrchestrations are uniq\", \"ue when compared to other styles of triggered operations in Azure Functions. \\nDurable Functions enab\", \"les the execution of functions that may take hours or even days to complete. \\nThat type of behavior \", \"comes with the need to able to check the status of a running orchestration, \\npreemptively terminate,\", \" or send notifications of external events.38 CHAPTER 4 | Durable Azure Functions\\nFor such cases, the\", \" Durable Functions extension provides the DurableOrchestrationClient class that \\nallows you to inter\", \"act with orchestrated functions. You get access to the orchestration client by using \\nthe Orchestrat\", \"ionClientAttribute binding. Generally, you would include this attribute with another \\ntrigger type, \", \"such as an HttpTrigger or ServiceBusTrigger. Once the source function has been \\ntriggered, the orche\", \"stration client can be used to start an orchestrator function.\\n[FunctionName(\\\"KickOff\\\")]\\npublic stat\", \"ic async Task<HttpResponseMessage> Run(\\n [HttpTrigger(AuthorizationLevel.Function, \\\"POST\\\")]HttpReque\", \"stMessage req,\\n [OrchestrationClient ] DurableOrchestrationClient<orchestrationClient>)\\n{\\n OrderRequ\", \"estData data = await req.Content.ReadAsAsync<OrderRequestData>();\\n string instanceId = await orchest\", \"rationClient.StartNewAsync(\\\"PlaceOrder\\\", data);\\n return orchestrationClient.CreateCheckStatusRespons\", \"e(req, instanceId);\\n}\\nThe orchestrator function\\nAnnotating a function with the OrchestrationTriggerA\", \"ttribute in Azure Functions marks that function \\nas an orchestrator function. It\\u2019s responsible for m\", \"anaging the various activities that make up your \\nstateful workflow.\\nOrchestrator functions are unab\", \"le to make use of bindings other than the \\nOrchestrationTriggerAttribute. This attribute can only be\", \" used with a parameter type of \\nDurableOrchestrationContext. No other inputs can be used since deser\", \"ialization of inputs in the \\nfunction signature isn\\u2019t supported. To get inputs provided by the orche\", \"stration client, the \\nGetInput<T> method must be used.\\nAlso, the return types of orchestration funct\", \"ions must be either void, Task, or a JSON serializable \\nvalue.\\nError handling code has been left out\", \" for brevity\\n[FunctionName(\\\"PlaceOrder\\\")]\\npublic static async Task<string> PlaceOrder([Orchestration\", \"Trigger] \\nDurableOrchestrationContext context)\\n{\\n OrderRequestData orderData = context.GetInput<Orde\", \"rRequestData>();\\n await context.CallActivityAsync<bool>(\\\"CheckAndReserveInventory\\\", orderData);\\n awa\", \"it context.CallActivityAsync<string>(\\\"ProcessPayment\\\", orderData);\\n string trackingNumber = await co\", \"ntext.CallActivityAsync<string>(\\\"ScheduleShipping\\\", \\norderData);\\n await context.CallActivityAsync<st\", \"ring>(\\\"EmailCustomer\\\", trackingNumber);\\n return trackingNumber;\\n}\\nMultiple instances of an orchestra\", \"tion can be started and running at the same time. Calling the \\nStartNewAsync method on the DurableOr\", \"chestrationClient launches a new instance of the \\norchestration. The method returns a Task<string> t\", \"hat completes when the orchestration has started. 39 CHAPTER 4 | Durable Azure Functions\\nAn exceptio\", \"n of type TimeoutException gets thrown if the orchestration hasn\\u2019t started within 30 \\nseconds.\\nThe c\", \"ompleted Task<string> from StartNewAsync should contain the unique ID of the orchestration \\ninstance\", \". This instance ID can be used to invoke operations on that specific orchestration. The \\norchestrati\", \"on can be queried for the status or sent event notifications.\\nThe activity functions\\nActivity functi\", \"ons are the discrete operations that get composed together within an orchestration \\nfunction to crea\", \"te the workflow. Here is where most of actual work would take place. They represent \\nthe business lo\", \"gic, long running processes, and the puzzle pieces to a larger solution.\\nThe ActivityTriggerAttribut\", \"e is used to annotate a function parameter of type \\nDurableActivityContext. Using the annotation inf\", \"orms the runtime that the function is intended to \\nbe used as an activity function. Input values to \", \"activity functions are retrieved using the GetInput<T>\\nmethod of the DurableActivityContext paramete\", \"r.\\nSimilar to orchestration functions, the return types of activity functions must be either void, T\", \"ask, or a \\nJSON serializable value.\\nAny unhandled exceptions that get thrown within activity functio\", \"ns will get sent up to the calling \\norchestrator function and presented as a TaskFailedException. At\", \" this point, the error can be caught \\nand logged in the orchestrator, and the activity can be retrie\", \"d.\\n[FunctionName(\\\"CheckAndReserveInventory\\\")]\\npublic static bool CheckAndReserveInventory([ActivityT\", \"rigger] DurableActivityContext \\ncontext)\\n{\\n OrderRequestData orderData = context.GetInput<OrderReque\", \"stData>();\\n // Connect to inventory system and try to reserve items\\n return true;\\n}\\nRecommended reso\", \"urces\\n\\u2022 Durable Functions\\n\\u2022 Bindings for Durable Functions\\n\\u2022 Manage instances in Durable Functions\\nO\", \"rchestration patterns\\nDurable Functions makes it easier to create stateful workflows that are compos\", \"ed of discrete, long \\nrunning activities in a serverless environment. Since Durable Functions can tr\", \"ack the progress of your \\nworkflows and periodically checkpoints the execution history, it lends its\", \"elf to implementing some \\ninteresting patterns.40 CHAPTER 4 | Durable Azure Functions\\nFunction chain\", \"ing\\nIn a typical sequential process, activities need to execute one after the other in a particular \", \"order. \\nOptionally, the upcoming activity may require some output from the previous function. This \\n\", \"dependency on the ordering of activities creates a function chain of execution.\\nThe benefit of using\", \" Durable Functions to implement this workflow pattern comes from its ability to \\ndo checkpointing. I\", \"f the server crashes, the network times out or some other issue occurs, Durable \\nfunctions can resum\", \"e from the last known state and continue running your workflow even if it\\u2019s on \\nanother server.\\n[Fun\", \"ctionName(\\\"PlaceOrder\\\")]\\npublic static async Task<string> PlaceOrder([OrchestrationTrigger] \\nDurable\", \"OrchestrationContext context)\\n{\\n OrderRequestData orderData = context.GetInput<OrderRequestData>();\\n\", \" await context.CallActivityAsync<bool>(\\\"CheckAndReserveInventory\\\", orderData);\\n await context.CallAc\", \"tivityAsync<bool>(\\\"ProcessPayment\\\", orderData);\\n string trackingNumber = await context.CallActivityA\", \"sync<string>(\\\"ScheduleShipping\\\", \\norderData);\\n await context.CallActivityAsync<string>(\\\"EmailCustome\", \"r\\\", trackingNumber);\\n return trackingNumber;\\n}\\nIn the preceding code sample, the CallActivityAsync f\", \"unction is responsible for running a given \\nactivity on a virtual machine in the data center. When t\", \"he await returns and the underlying Task \\ncompletes, the execution will be recorded to the history t\", \"able. The code in the orchestrator function \\ncan make use of any of the familiar constructs of the T\", \"ask Parallel Library and the async/await \\nkeywords.\\nThe following code is a simplified example of wh\", \"at the ProcessPayment method may look like:\\n[FunctionName(\\\"ProcessPayment\\\")]\\npublic static bool Proc\", \"essPayment([ActivityTrigger] DurableActivityContext context)\\n{\\n OrderRequestData orderData = context\", \".GetInput<OrderRequestData>();\\n ApplyCoupons(orderData);\\n if(IssuePaymentRequest(orderData)) {\\n retu\", \"rn true;\\n }\\n return false;\\n}\\nAsynchronous HTTP APIs\\nIn some cases, workflows may contain activities \", \"that take a relatively long period of time to complete. \\nImagine a process that kicks off the backup\", \" of media files into blob storage. Depending on the size \\nand quantity of the media files, this back\", \"up process may take hours to complete.41 CHAPTER 4 | Durable Azure Functions\\nIn this scenario, the D\", \"urableOrchestrationClient\\u2019s ability to check the status of a running workflow \\nbecomes useful. When \", \"using an HttpTrigger to start a workflow, the CreateCheckStatusResponse\\nmethod can be used to return\", \" an instance of HttpResponseMessage. This response provides the client \\nwith a URI in the payload th\", \"at can be used to check the status of the running process.\\n[FunctionName(\\\"OrderWorkflow\\\")]\\npublic st\", \"atic async Task<HttpResponseMessage> Run(\\n [HttpTrigger(AuthorizationLevel.Function, \\\"POST\\\")]HttpReq\", \"uestMessage req,\\n [OrchestrationClient ] DurableOrchestrationClient orchestrationClient)\\n{\\n OrderReq\", \"uestData data = await req.Content.ReadAsAsync<OrderRequestData>();\\n string instanceId = await orches\", \"trationClient.StartNewAsync(\\\"PlaceOrder\\\", data);\\n return orchestrationClient.CreateCheckStatusRespon\", \"se(req, instanceId);\\n}\\nThe sample result below shows the structure of the response payload.\\n{\\n \\\"id\\\":\", \" \\\"instanceId\\\",\\n \\\"statusQueryGetUri\\\": \\\"http://host/statusUri\\\",\\n \\\"sendEventPostUri\\\": \\\"http://host/even\", \"tUri\\\",\\n \\\"terminatePostUri\\\": \\\"http://host/terminateUri\\\"\\n}\\nUsing your preferred HTTP client, GET reque\", \"sts can be made to the URI in statusQueryGetUri to \\ninspect the status of the running workflow. The \", \"returned status response should resemble the \\nfollowing code.\\n{\\n \\\"runtimeStatus\\\": \\\"Running\\\",\\n \\\"input\", \"\\\": {\\n \\\"$type\\\": \\\"DurableFunctionsDemos.OrderRequestData, DurableFunctionsDemos\\\"\\n },\\n \\\"output\\\": null,\\n\", \" \\\"createdTime\\\": \\\"2018-01-01T00:22:05Z\\\",\\n \\\"lastUpdatedTime\\\": \\\"2018-01-01T00:22:09Z\\\"\\n}\\nAs the process \", \"continues, the status response will change to either Failed or Completed. On \\nsuccessful completion,\", \" the output property in the payload will contain any returned data.\\nMonitoring\\nFor simple recurring \", \"tasks, Azure Functions provides the TimerTrigger that can be scheduled based \\non a CRON expression. \", \"The timer works well for simple, short-lived tasks, but there might be scenarios \\nwhere more flexibl\", \"e scheduling is needed. This scenario is when the monitoring pattern and Durable \\nFunctions can help\", \".\\nDurable Functions allows for flexible scheduling intervals, lifetime management, and the creation \", \"of \\nmultiple monitor processes from a single orchestration function. One use case for this functiona\", \"lity \\nmight be to create watchers for stock price changes that complete once a certain threshold is \", \"met.42 CHAPTER 4 | Durable Azure Functions\\n[FunctionName(\\\"CheckStockPrice\\\")]\\npublic static async Tas\", \"k CheckStockPrice([OrchestrationTrigger] DurableOrchestrationContext \\ncontext)\\n{\\n StockWatcherInfo s\", \"tockInfo = context.GetInput<StockWatcherInfo>();\\n const int checkIntervalSeconds = 120;\\n StockPrice \", \"initialStockPrice = null;\\n DateTime fireAt;\\n DateTime exitTime = context.CurrentUtcDateTime.Add(stoc\", \"kInfo.TimeLimit);\\n while (context.CurrentUtcDateTime < exitTime)\\n {\\n StockPrice currentStockPrice = \", \"await \\ncontext.CallActivityAsync<StockPrice>(\\\"GetStockPrice\\\", stockInfo);\\n if (initialStockPrice == \", \"null)\\n {\\n initialStockPrice = currentStockPrice;\\n fireAt = context.CurrentUtcDateTime.AddSeconds(che\", \"ckIntervalSeconds);\\n await context.CreateTimer(fireAt, CancellationToken.None);\\n continue;\\n }\\n decim\", \"al percentageChange = (initialStockPrice.Price - currentStockPrice.Price) /\\n ((initialStockPrice.Pri\", \"ce + currentStockPrice.Price) / 2);\\n if (Math.Abs(percentageChange) >= stockInfo.PercentageChange)\\n \", \"{\\n // Change threshold detected\\n await context.CallActivityAsync(\\\"NotifyStockPercentageChange\\\", \\ncur\", \"rentStockPrice);\\n break;\\n }\\n // Sleep til next polling interval\\n fireAt = context.CurrentUtcDateTime\", \".AddSeconds(checkIntervalSeconds);\\n await context.CreateTimer(fireAt, CancellationToken.None);\\n }\\n}\\n\", \"DurableOrchestrationContext\\u2019s CreateTimer method sets up the schedule for the next invocation \\nof th\", \"e loop to check for stock price changes. DurableOrchestrationContext also has a \\nCurrentUtcDateTime \", \"property to get the current DateTime value in UTC. It\\u2019s better to use this \\nproperty instead of Date\", \"Time.UtcNow because it\\u2019s easily mocked for testing.\\nRecommended resources\\n\\u2022 Azure Durable Functions\\n\", \"\\u2022 Unit Testing in .NET Core and .NET Standard43 CHAPTER 5 | Serverless business scenarios and use ca\", \"ses\\nCHAPTER 5CHAPTER 5\\nServerless business \\nscenarios and use cases\\nThere are many use cases and sce\", \"narios for serverless applications. This chapter includes samples that \\nillustrate the different sce\", \"narios. The scenarios include links to related documentation and public \\nsource code repositories. T\", \"he samples in this chapter enable you to get started on your own building \\nand implementing serverle\", \"ss solutions.\\nBig data processing\\nThis example uses serverless to do a map/reduce operation on a big\", \" data set. It determines the \\naverage speed of New York Yellow taxi trips per day in 2017.\\nBig Data \", \"Processing: Serverless MapReduce on Azure\\nCreate serverless applications: hands-on lab\\nLearn how to \", \"use functions to execute server-side logic and build serverless architectures.\\n\\u2022 Choosing the best A\", \"zure service for your business\\n\\u2022 Creating Azure Functions\\n\\u2022 Using triggers\\n\\u2022 Chaining functions\\n\\u2022 Lo\", \"ng-running workflows\\n\\u2022 Monitoring\\n\\u2022 Development, testing, and deployment\\nCreate serverless applicati\", \"ons\\nCustomer reviews\\nThis sample showcases the new Azure Functions tooling for C# Class Libraries in\", \" Visual Studio. Create \\na website where customers submit product reviews that are stored in Azure st\", \"orage blobs and 44 CHAPTER 5 | Serverless business scenarios and use cases\\nCosmosDB. Add an Azure Fu\", \"nction to perform automated moderation of the customer reviews using \\nAzure Cognitive Services. Use \", \"an Azure storage queue to decouple the website from the function.\\nCustomer Reviews App with Cognitiv\", \"e Services\\nFile processing and validation\\nThis example parses a set of CSV files from hypothetical c\", \"ustomers. It ensures that all files required for \\na customer \\u201cbatch\\u201d are ready, then validates the s\", \"tructure of each file. Different solutions are \\npresented using Azure Functions, Logic Apps, and Dur\", \"able Functions.\\nFile processing and validation using Azure Functions, Logic Apps, and Durable Functi\", \"ons\\nGame data visualization\\nAn example of how a developer could implement an in-editor data visualiz\", \"ation solution for their \\ngame. In fact, an Unreal Engine 4 Plugin and Unity Plugin were developed u\", \"sing this sample as its \\nbackend. The service component is game engine agnostic.\\nIn-editor game tele\", \"metry visualization\\nGraphQL\\nCreate a serverless function that exposes a GraphQL API.\\nServerless func\", \"tions for GraphQL\\nInternet of Things (IoT) reliable edge relay\\nThis sample implements a new communic\", \"ation protocol to enable reliable upstream communication \\nfrom IoT devices. It automates data gap de\", \"tection and backfill.\\nIoT Reliable Edge Relay\\nMicroservices reference architecture\\nA reference archi\", \"tecture that walks you through the decision-making process involved in designing, \\ndeveloping, and d\", \"elivering the Rideshare by Relecloud application (a fictitious company). It includes \\nhands-on instr\", \"uctions for configuring and deploying all of the architecture\\u2019s components.45 CHAPTER 5 | Serverless\", \" business scenarios and use cases\\nServerless Microservices reference architecture\\nServerless for mob\", \"ile\\nAzure Functions are easy to implement and maintain, and accessible through HTTP. They are a grea\", \"t \\nway to implement an API for a mobile application. Microsoft offers great cross-platform tools for\", \" iOS, \\nAndroid, and Windows with Xamarin. As such, Xamarin and Azure Functions are working great \\nto\", \"gether. This article shows how to implement an Azure Function in the Azure portal or in Visual \\nStud\", \"io at first, and build a cross-platform client with Xamarin.Forms running on Android, iOS, and \\nWind\", \"ows.\\nImplementing a simple Azure Function with a Xamarin.Forms client\\nServerless messaging\\nThis samp\", \"le shows how to utilize Durable Functions\\u2019 fan-out pattern to load an arbitrary number of \\nmessages \", \"across any number of sessions/partitions. It targets Service Bus, Event Hubs, or Storage \\nQueues. Th\", \"e sample also adds the ability to consume those messages with another Azure Function \\nand load the r\", \"esulting timing data in to another Event Hub. The data is then ingested into analytics \\nservices lik\", \"e Azure Data Explorer.\\nProduce and Consume messages through Service Bus, Event Hubs, and Storage Que\", \"ues with Azure \\nFunctions\\nRecommended resources\\n\\u2022 Big Data Processing: Serverless MapReduce on Azure\", \"\\n\\u2022 Create serverless applications\\n\\u2022 Customer Reviews App with Cognitive Services\\n\\u2022 File processing a\", \"nd validation using Azure Functions, Logic Apps, and Durable Functions\\n\\u2022 Implementing a simple Azure\", \" Function with a Xamarin.Forms client\\n\\u2022 In-editor game telemetry visualization\\n\\u2022 IoT Reliable Edge R\", \"elay\\n\\u2022 Produce and Consume messages through Service Bus, Event Hubs, and Storage Queues with \\nAzure \", \"Functions\\n\\u2022 Serverless functions for GraphQL\\n\\u2022 Serverless Microservices reference architecture46 CHA\", \"PTER 6 | Conclusion\\nCHAPTER 6CHAPTER 6\\nConclusion\\nThe following key takeaways are the most important\", \" conclusions from this guide.\\nBenefits of using serverless. Serverless solutions provide the importa\", \"nt benefit of cost savings \\nbecause serverless is implemented in a pay-per-use model. Serverless mak\", \"es it possible to \\nindependently scale, test, and deploy individual components of your application. \", \"Serverless is uniquely \\nsuited to implement microservices architectures and integrates fully into a \", \"DevOps pipeline.\\nCode as a unit of deployment. Serverless abstracts the hardware, OS, and runtime aw\", \"ay from the \\napplication. Serverless enables focusing on business logic in code as the unit of deplo\", \"yment.\\nTriggers and bindings. Serverless eases integration with storage, APIs, and other cloud resou\", \"rces. \\nAzure Functions provides triggers to execute code and bindings to interact with resources.\\nMi\", \"croservices. The microservices architecture is becoming the preferred approach for distributed and \\n\", \"large or complex mission-critical applications that are based on multiple independent subsystems in \", \"\\nthe form of autonomous services. In a microservice-based architecture, the application is built as \", \"a \\ncollection of services that can be developed, tested, versioned, deployed, and scaled independent\", \"ly. \\nServerless is an architecture well-suited for building these services.\\nServerless platforms. Se\", \"rverless isn\\u2019t just about the code. Platforms that support serverless \\narchitectures include serverl\", \"ess workflows and orchestration, serverless messaging and event services, \\nand serverless databases.\", \"\\nServerless challenges. Serverless introduces challenges related to distributed application \\ndevelop\", \"ment, such as fragmented and independent data models, resiliency, versioning, and service \\ndiscovery\", \". Serverless may not be ideally suited to long running processes or components that benefit \\nfrom ti\", \"ghter coupling.\\nServerless as a tool, not the toolbox. Serverless is not the exclusive solution to a\", \"pplication \\narchitecture. It is a tool that can be leveraged as part of a hybrid application that ma\", \"y contain \\ntraditional tiers, monolith back ends, and containers. Serverless can be used to enhance \", \"existing \\nsolutions and is not an all-or-nothing approach to application development.\"]"