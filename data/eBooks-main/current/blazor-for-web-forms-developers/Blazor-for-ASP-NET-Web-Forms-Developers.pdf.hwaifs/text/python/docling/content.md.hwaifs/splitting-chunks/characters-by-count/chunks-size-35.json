"[\"<!-- image -->\\n\\n## Blazor for ASP.NET Web Forms Developers\\n\\n<!-- image -->\\n\\nDaniel Roth Jeff Fritz T\", \"aylor Southwick\\n\\nEDITION v8.0 - Updated to .NET 8\\n\\nRefer to changelog for the book updates and commu\", \"nity contributions.\\n\\nPUBLISHED BY\\n\\nMicrosoft Developer Division, .NET, and Visual Studio product tea\", \"ms\\n\\nA division of Microsoft Corporation\\n\\nOne Microsoft Way\\n\\nRedmond, Washington 98052-6399\\n\\nCopyrigh\", \"t \\u00a9 2023 by Microsoft Corporation\\n\\nAll rights reserved. No part of the contents of this book may be \", \"reproduced or transmitted in any form or by any means without the written permission of the publishe\", \"r.\\n\\nThis book is provided 'as -is' and expresses the author's views and opinions. The views, opinion\", \"s, and information expressed in this book, including URL and other Internet website references, may \", \"change without notice.\\n\\nSome examples depicted herein are provided for illustration only and are fic\", \"titious. No real association or connection is intended or should be inferred.\\n\\nMicrosoft and the tra\", \"demarks listed at https://www.microsoft.com on the 'Trademarks' webpage are trademarks of the Micros\", \"oft group of companies.\\n\\nMac and macOS are trademarks of Apple Inc.\\n\\nAll other marks and logos are p\", \"roperty of their respective owners.\\n\\nAuthors:\\n\\nDaniel Roth , Principal Program Manager, Microsoft Co\", \"rp.\\n\\nJeff Fritz , Senior Program Manager, Microsoft Corp.\\n\\nTaylor Southwick , Senior Software Engine\", \"er, Microsoft Corp.\\n\\nScott Addie , Senior Content Developer, Microsoft Corp.\\n\\nSteve '@ardalis' Smith\", \" , Software Architect and Trainer, NimblePros.com\\n\\n## Introduction\\n\\n.NET has long supported web app \", \"development through ASP.NET, a comprehensive set of frameworks and tools for building any kind of we\", \"b app. ASP.NET has its own lineage of web frameworks and technologies starting all the way back with\", \" classic Active Server Pages (ASP). Frameworks like ASP.NET Web Forms, ASP.NET MVC, ASP.NET Web Page\", \"s, and more recently ASP.NET Core, provide a productive and powerful way to build server-rendered we\", \"b apps, where UI content is dynamically generated on the server in response to HTTP requests. Each A\", \"SP.NET framework caters to a different audience and app building philosophy. ASP.NET Web Forms shipp\", \"ed with the original release of the .NET Framework and enabled web development using many of the pat\", \"terns familiar to desktop developers, like reusable UI controls with simple event handling. However,\", \" none of the ASP.NET offerings provide a way to run code that executed in the user's browser. To do \", \"that requires writing JavaScript and using any of the many JavaScript frameworks and tools that have\", \" phased in and out of popularity over the years: jQuery, Knockout, Angular, React, and so on.\\n\\nBlazo\", \"r is a new web framework that changes what is possible when building web apps with .NET. Blazor is a\", \" client-side web UI framework based on C# instead of JavaScript. With Blazor you can write your clie\", \"nt-side logic and UI components in C#, compile them into normal .NET assemblies, and then run them d\", \"irectly in the browser using a new open web standard called WebAssembly. Or alternatively, Blazor ca\", \"n run your .NET UI components on the server and handle all UI interactions fluidly over a real-time \", \"connection with the browser. When paired with .NET running on the server, Blazor enables full-stack \", \"web development with .NET. While Blazor shares many commonalities with ASP.NET Web Forms, like havin\", \"g a reusable component model and a simple way to handle user events, it also builds on the foundatio\", \"ns of .NET to provide a modern and high-performance web development experience.\\n\\nThis book introduce\", \"s ASP.NET Web Forms developers to Blazor in a way that is familiar and convenient. It introduces Bla\", \"zor concepts in parallel with analogous concepts in ASP.NET Web Forms while also explaining new conc\", \"epts that may be less familiar. It covers a broad range of topics and concerns including component a\", \"uthoring, routing, layout, configuration, and security. And while the content of this book is primar\", \"ily for enabling new development, it also covers guidelines and strategies for migrating existing AS\", \"P.NET Web Forms to Blazor for when you want to modernize an existing app.\\n\\n## Who should use the boo\", \"k\\n\\nThis book is for ASP.NET Web Forms developers looking for an introduction to Blazor that relates \", \"to their existing knowledge and skills. This book can help with quickly getting started on a new Bla\", \"zorbased project or to help chart a roadmap for modernizing an existing ASP.NET Web Forms applicatio\", \"n.\\n\\n## How to use the book\\n\\nThe first part of this book covers what Blazor is and compares it to web\", \" app development with ASP.NET Web Forms. The book then covers a variety of Blazor topics, chapter by\", \" chapter, and relates each Blazor concept to the corresponding concept in ASP.NET Web Forms, or expl\", \"ains fully any completely new concepts. The book also refers regularly to a complete sample app impl\", \"emented in both ASP.NET Web Forms and Blazor to demonstrate Blazor features and to provide a case st\", \"udy for migrating from ASP.NET Web Forms to Blazor. You can find both implementations of the sample \", \"app (ASP.NET Web Forms and Blazor versions) on GitHub.\\n\\n## What this book doesn't cover\\n\\nThis book i\", \"s an introduction to Blazor, not a comprehensive migration guide. While it does include guidance on \", \"how to approach migrating a project from ASP.NET Web Forms to Blazor, it does not attempt to cover e\", \"very nuance and detail. For more general guidance on migrating from ASP.NET to ASP.NET Core, refer t\", \"o the migration guidance in the ASP.NET Core documentation.\\n\\n## Additional resources\\n\\nYou can find t\", \"he official Blazor home page and documentation at https://blazor.net.\\n\\n## Contents\\n\\n| An introductio\", \"n to Blazor for ASP.NET Web Forms developers ........................................ 1             \", \"                                                                                  |\\n|---------------\", \"----------------------------------------------------------------------------------------------------\", \"----------------------------------------------------------------------------------|\\n| An open-source\", \" and cross-platform .NET ...........................................................................\", \"..........................................2                                       |\\n| Client-side we\", \"b development.......................................................................................\", \"......................................................3                           |\\n| WebAssembly fu\", \"lfills a need ......................................................................................\", \".........................................................3                        |\\n| Blazor: full-s\", \"tack web development with .NET......................................................................\", \".......................................4                                          |\\n| Get started wi\", \"th Blazor ..........................................................................................\", \"................................................................4                 |\\n| Architecture c\", \"omparison of ASP.NET Web Forms and Blazor............................................ 5             \", \"                                                                                  |\\n| ASP.NET Web Fo\", \"rms.................................................................................................\", \"..............................................................5                   |\\n| Blazor........\", \"....................................................................................................\", \"................................................................................6 |\\n| Blazor app hos\", \"ting models.........................................................................................\", \"............ 8                                                                    |\\n| Blazor WebAsse\", \"mbly apps...........................................................................................\", \"........................................................8                         |\\n| Blazor Server \", \"apps................................................................................................\", \"...................................................................9              |\\n| How to choose \", \"the right Blazor hosting model .....................................................................\", \".................................. 10                                             |\\n| Deploy your ap\", \"p...................................................................................................\", \"................................................................. 11              |\\n| Project struct\", \"ure for Blazor apps.................................................................................\", \"........ 12                                                                       |\\n| Project file .\", \"....................................................................................................\", \"........................................................................... 12    |\\n| Entry point ..\", \"....................................................................................................\", \"......................................................................... 13      |\\n| Static files .\", \"....................................................................................................\", \"............................................................................ 15   |\\n| Configuration.\", \"....................................................................................................\", \"..................................................................... 15          |\\n| Razor componen\", \"ts .................................................................................................\", \".............................................................. 15                 |\\n| Pages.........\", \"....................................................................................................\", \"............................................................................. 16  |\\n| Layout........\", \"....................................................................................................\", \"............................................................................ 16   |\\n| Bootstrap Blaz\", \"or..................................................................................................\", \".................................................................. 16             |\\n| Run the app wi\", \"th Hot Reload.......................................................................................\", \".................................................... 18                           |\\n| App startup...\", \"....................................................................................................\", \"..................... 21                                                          |\\n| Application_St\", \"art and Web Forms ..................................................................................\", \"............................................... 21                                |\\n\\n| Upgrading the\", \" BundleConfig Process ..............................................................................\", \"............................................                              | 23   |\\n|----------------\", \"----------------------------------------------------------------------------------------------------\", \"------------------------------------------------------------------------|------|\\n| Build reusable UI\", \" components with Blazor.........................................................................    \", \"                                                                      | 24   |\\n| An introduction to \", \"Razor ..............................................................................................\", \".....................................................               | 24   |\\n| Use components ......\", \"....................................................................................................\", \".........................................................         | 28   |\\n| Modify page title from \", \"components..........................................................................................\", \"...................................                             | 28   |\\n| Component parameters.....\", \"....................................................................................................\", \"............................................                  | 29   |\\n| Query string parameters ...\", \"....................................................................................................\", \"........................................29                  |      |\\n| Components and error boundari\", \"es..................................................................................................\", \".............................                             | 30   |\\n| Event handlers.................\", \"....................................................................................................\", \"...................................................     | 30   |\\n| Data binding ....................\", \"....................................................................................................\", \"...................................................   | 32   |\\n| State changes......................\", \"....................................................................................................\", \"...............................................     | 33   |\\n| Component lifecycle..................\", \"....................................................................................................\", \"......................................            | 34   |\\n| OnInitialized .........................\", \"....................................................................................................\", \"..........................................34    |      |\\n| OnParametersSet .........................\", \"....................................................................................................\", \"................................35            |      |\\n| OnAfterRender..............................\", \"....................................................................................................\", \"................................35          |      |\\n| IDisposable .................................\", \"....................................................................................................\", \"....................................35    |      |\\n| Capture component references ..................\", \"....................................................................................................\", \"................                        | 36   |\\n| Capture element references ......................\", \"....................................................................................................\", \"...................                   | 36   |\\n| Templated components...............................\", \"....................................................................................................\", \"..................                  | 36   |\\n| Child content........................................\", \"....................................................................................................\", \"..........................37      |      |\\n| Template parameters....................................\", \"....................................................................................................\", \"..............37                |      |\\n| Code-behind..............................................\", \"....................................................................................................\", \".........................     | 38   |\\n| Additional resources.......................................\", \"....................................................................................................\", \".................           | 39   |\\n| Pages, routing, and layouts..................................\", \"................................................................                                    \", \"                          | 40   |\\n| Create pages...................................................\", \"....................................................................................................\", \"....................    | 41   |\\n| Router component.................................................\", \"....................................................................................................\", \"..........            | 42   |\\n| Navigation ........................................................\", \"....................................................................................................\", \"................... | 42   |\\n| Base URLs............................................................\", \"....................................................................................................\", \"................. | 43   |\\n| Page layout............................................................\", \"....................................................................................................\", \"..............  | 43   |\\n| State management.........................................................\", \".......................................................                                             \", \"              | 46   |\\n| Request state management with ViewState ...................................\", \"...........................................................................                         \", \"            | 46   |\\n\\n| Maintain state with Session ................................................\", \"..............................................................................................      \", \"               | 47   |\\n|---------------------------------------------------------------------------\", \"----------------------------------------------------------------------------------------------------\", \"-----------------|------|\\n| Application state ......................................................\", \"....................................................................................................\", \".........          | 47   |\\n| In the browser .......................................................\", \"....................................................................................................\", \".............        | 48   |\\n| Forms and validation ...............................................\", \".............................................................                                       \", \"                       | 49   |\\n| Additional resources..............................................\", \"....................................................................................................\", \"..........               | 51   |\\n| Work with data..................................................\", \"....................................................................                                \", \"                           | 52   |\\n| Entity Framework .............................................\", \"....................................................................................................\", \".................            | 52   |\\n| EF Code First...............................................\", \"....................................................................................................\", \"....................53         |      |\\n| EF Database First ........................................\", \"....................................................................................................\", \"..................54             |      |\\n| Interact with web services .............................\", \"....................................................................................................\", \"................                   | 54   |\\n| Modules, handlers, and middleware.....................\", \"..............................................................                                      \", \"                                     | 56   |\\n| Overview............................................\", \"....................................................................................................\", \"...................................    | 56   |\\n| Katana............................................\", \"....................................................................................................\", \"........................................ | 57   |\\n| Common middleware...............................\", \"....................................................................................................\", \".......................                    | 57   |\\n| Custom middleware.............................\", \"....................................................................................................\", \"............................                 | 58   |\\n| App configuration...........................\", \"......................................................................................              \", \"                                               | 60   |\\n| Configuration sources.....................\", \"....................................................................................................\", \"................................                 | 60   |\\n| appsettings.json format and access .....\", \"....................................................................................................\", \".....................                              | 61   |\\n| User secrets..........................\", \"....................................................................................................\", \"...............................................      | 61   |\\n| Environment variables...............\", \"....................................................................................................\", \"......................................                 | 61   |\\n| Command-line arguments............\", \"....................................................................................................\", \"................................                         | 62   |\\n| The return of web.config .......\", \"....................................................................................................\", \"........................................                   | 62   |\\n| Read configuration in the app.\", \"....................................................................................................\", \"....................................                         | 63   |\\n| Strongly typed configuration\", \"....................................................................................................\", \".......................................                        | 63   |\\n| Security: Authentication a\", \"nd Authorization in ASP.NET Web Forms and Blazor...........                                         \", \"                                                                 | 65   |\\n| ASP.NET universal provid\", \"ers.................................................................................................\", \"............................................                       | 65   |\\n| Authorization configur\", \"ation in Web Forms..................................................................................\", \".........................66                                          |      |\\n| Authorization code i\", \"n Web Forms ........................................................................................\", \"....................................67                                 |      |\\n| ASP.NET Core Ident\", \"ity.................................................................................................\", \"........................................................                 | 68   |\\n| Roles, claims, a\", \"nd policies ........................................................................................\", \"....................................................68                     |      |\\n| Migration guid\", \"e...................................................................................................\", \".............................................................70              |      |\\n\\n| Creating th\", \"e ASP.NET Core Identity schema......................................................................\", \"...................................70                                          |\\n|------------------\", \"----------------------------------------------------------------------------------------------------\", \"-------------------------------------------------------------------------|\\n| Migrating data from uni\", \"versal providers to ASP.NET Core Identity ..........................................................\", \"..73                                                               |\\n| Migrating security settings f\", \"rom web.config to app startup.......................................................................\", \"...74                                                        |\\n| Updating individual pages to use AS\", \"P.NET Core Identity abstractions .....................................................75            \", \"                                                       |\\n| Summary..................................\", \"....................................................................................................\", \"............................................ 76  |\\n| References ....................................\", \"....................................................................................................\", \"....................................... 77 |\\n| Migrate from ASP.NET Web Forms to Blazor.............\", \"........................................................ 78                                         \", \"                                     |\\n| Server-side versus client-side hosting.....................\", \"....................................................................................................\", \". 78                           |\\n| Create a new project.............................................\", \"....................................................................................................\", \"........... 79           |\\n| Enable startup process.................................................\", \"....................................................................................................\", \"... 80             |\\n| Migrate HTTP modules and handlers to middleware .............................\", \"............................................................... 83                                  \", \"             |\\n| Migrate static files ..............................................................\", \".................................................................................................. 8\", \"4      |\\n| Migrate runtime bundling and minification setup .........................................\", \"......................................................... 84                                        \", \" |\\n| Migrate ASPX pages.............................................................................\", \"............................................................................... 84             |\\n| M\", \"odel validation in Blazor...........................................................................\", \".................................................................88                      |\\n| Migrate\", \" configuration......................................................................................\", \"................................................................... 89             |\\n| Migrate data \", \"access..............................................................................................\", \"............................................................... 91           |\\n| Architectural chang\", \"es..................................................................................................\", \"........................................................ 91            |\\n| Migration conclusion.....\", \"....................................................................................................\", \".................................................. 92            |\\n\\n## An introduction to Blazor for\", \" ASP.NET Web Forms developers\\n\\nThe ASP.NET Web Forms framework has been a staple of .NET web develop\", \"ment since the .NET Framework first shipped in 2002. Back when the Web was still largely in its infa\", \"ncy, ASP.NET Web Forms made building web apps simple and productive by adopting many of the patterns\", \" that were used for desktop development. In ASP.NET Web Forms, web pages can be quickly composed fro\", \"m reusable UI controls. User interactions are handled naturally as events. There's a rich ecosystem \", \"of Web Forms UI controls provided by Microsoft and control vendors. The controls ease the efforts of\", \" connecting to data sources and displaying rich data visualizations. For the visually inclined, the \", \"Web Forms designer provides a simple drag-and-drop interface for managing controls.\\n\\nOver the years,\", \" Microsoft has introduced new ASP.NET-based web frameworks to address web development trends. Some s\", \"uch web frameworks include ASP.NET MVC, ASP.NET Web Pages, and more recently ASP.NET Core. With each\", \" new framework, some have predicted the imminent decline of ASP.NET Web Forms and criticized it as a\", \"n outdated, outmoded web framework. Despite these predictions, many .NET web developers continue to \", \"find ASP.NET Web Forms a simple, stable, and productive way to get their work done.\\n\\nAt the time of \", \"writing, almost half a million web developers use ASP.NET Web Forms every month. The ASP.NET Web For\", \"ms framework is stable to the point that docs, samples, books, and blog posts from a decade ago rema\", \"in useful and relevant. For many .NET web developers, 'ASP.NET' is still synonymous with 'ASP.NET We\", \"b Forms' as it was when .NET was first conceived. Arguments on the pros and cons of ASP.NET Web Form\", \"s compared to the other new .NET web frameworks may rage on. ASP.NET Web Forms remains a popular fra\", \"mework for creating web apps.\\n\\nEven so, innovations in software development aren't slowing. All soft\", \"ware developers need to stay abreast of new technologies and trends. Two trends in particular are wo\", \"rth considering:\\n\\n1. The shift to open-source and cross-platform\\n2. The shift of app logic to the cl\", \"ient\\n\\n## An open-source and cross-platform .NET\\n\\nWhen .NET and ASP.NET Web Forms first shipped, the \", \"platform ecosystem looked much different than it does today. The desktop and server markets were dom\", \"inated by Windows. Alternative platforms like macOS and Linux were still struggling to gain traction\", \". ASP.NET Web Forms ships with the .NET Framework as a Windows-only component, which means ASP.NET W\", \"eb Forms apps can only run on Windows Server machines. Many modern environments now use different ki\", \"nds of platforms for servers and development machines such that cross-platform support for many user\", \"s is an absolute requirement.\\n\\nMost modern web frameworks are now also open-source, which has a numb\", \"er of benefits. Users aren't beheld to a single project owner to fix bugs and add features. Open -so\", \"urce projects provide improved transparency on development progress and upcoming changes. Open-sourc\", \"e projects enjoy contributions from an entire community, and they foster a supportive open-source ec\", \"osystem. Despite the risks of open-source, many consumers and contributors have found suitable mitig\", \"ations that enable them to enjoy the benefits of an open-source ecosystem in a safe and reasonable w\", \"ay. Examples of such mitigations include contributor license agreements, friendly licenses, pedigree\", \" scans, and supporting foundations.\\n\\nThe .NET community has embraced both cross-platform support and\", \" open-source. .NET Core is an open-source and cross-platform implementation of .NET that runs on a p\", \"lethora of platforms, including Windows, macOS, and various Linux distributions. Xamarin provides Mo\", \"no, an open-source version of .NET. Mono runs on Android, iOS, and a variety of other form factors, \", \"including watches and smart TVs. In 2020, Microsoft released .NET 5 that reconciled .NET Core and Mo\", \"no into 'a single .NET runtime and framework that can be used everywhere and that has uniform runtim\", \"e behaviors and developer experiences.'\\n\\nWill ASP.NET Web Forms benefit from the move to open-source\", \" and cross-platform support? The answer, unfortunately, is no, or at least not to the same extent as\", \" the rest of the platform. The .NET team made it clear that ASP.NET Web Forms won't be ported to .NE\", \"T Core or .NET 8. Why is that?\\n\\nThere were efforts in the early days of .NET Core to port ASP.NET We\", \"b Forms. The number of breaking changes required were found to be too drastic. There's also an admis\", \"sion here that even for Microsoft, there's a limit to the number of web frameworks that it can suppo\", \"rt simultaneously. Perhaps someone in the community will take up the cause of creating an open-sourc\", \"e and cross-platform version of ASP.NET Web Forms. The source code for ASP.NET Web Forms has been ma\", \"de available publicly in reference form. But for the time being, it seems ASP.NET Web Forms will rem\", \"ain Windows-only and without an open-source contribution model. If cross-platform support or open-so\", \"urce become important for your scenarios, then you'll need to look for something new.\\n\\nDoes this mea\", \"n ASP.NET Web Forms is dead and should no longer be used? Of course not! As long as the .NET Framewo\", \"rk ships as part of Windows, ASP.NET Web Forms will be a supported framework. For many Web Forms dev\", \"elopers, the lack of cross-platform and open-source support is a non-issue. If you don't have a requ\", \"irement for cross -platform support, open-source, or any of the other new features in .NET Core or .\", \"NET 8, then sticking with ASP.NET Web Forms on Windows is fine. ASP.NET Web Forms will continue to b\", \"e a productive way to write web apps for many years to come.\\n\\nBut there's another trend worth consid\", \"ering, and that's the shift to the client.\\n\\n## Client-side web development\\n\\nAll of the .NET-based we\", \"b frameworks, including ASP.NET Web Forms, have historically had one thing in common: they're server\", \"-rendered . In server-rendered web apps, the browser makes a request to the server, which executes s\", \"ome code (.NET code in ASP.NET apps) to produce a response. That response is sent back to the browse\", \"r to handle. In this model, the browser is used as a thin rendering engine. The hard work of produci\", \"ng the UI, running the business logic, and managing state occurs on the server.\\n\\nHowever, browsers h\", \"ave become versatile platforms. They implement an ever-increasing number of open web standards that \", \"grant access to the capabilities of the user's machine. Why not take advantage of the compute power,\", \" storage, memory, and other resources of the client device? UI interactions in particular can benefi\", \"t from a richer and more interactive feel when handled at least partially or completely client-side.\", \" Logic and data that should be handled on the server can still be handled server-side. Web API calls\", \" or even real-time protocols, like WebSockets, can be used. These benefits are available to web deve\", \"lopers for free if they're willing to write JavaScript. Client -side UI frameworks, such as Angular,\", \" React, and Vue, simplify client-side web development and have grown in popularity. ASP.NET Web Form\", \"s developers can also benefit from leveraging the client, and even have some out-of-the-box support \", \"with integrated JavaScript frameworks like ASP.NET AJAX.\\n\\nBut bridging two different platforms and e\", \"cosystems (.NET and JavaScript) comes with a cost. Expertise is required in two parallel worlds with\", \" different languages, frameworks, and tools. Code and logic can't be easily shared between client an\", \"d server, resulting in duplication and engineering overhead. It can also be difficult to keep up wit\", \"h the JavaScript ecosystem, which has a history of evolving at breakneck speed. Front-end framework \", \"and build tool preferences change quickly. The industry has observed the progression from Grunt to G\", \"ulp to Webpack, and so on. The same restless churn has occurred with front-end frameworks such as jQ\", \"uery, Knockout, Angular, React, and Vue. But given JavaScript's browser monopoly, there was little c\", \"hoice in the matter. That is, until the web community got together and caused a miracle to happen!\\n\\n\", \"## WebAssembly fulfills a need\\n\\nIn 2015, the major browser vendors joined forces in a W3C Community \", \"Group to create a new open web standard called WebAssembly. WebAssembly is a byte code for the Web. \", \"If you can compile your code to WebAssembly, it can then run on any browser on any platform at near \", \"native speed. Initial efforts focused on C/C++. The result was a dramatic demonstration of running n\", \"ative 3D graphics engines directly in the browser without plugins. WebAssembly has since been standa\", \"rdized and implemented by all major browsers.\\n\\nWork on running .NET on WebAssembly was announced in \", \"late 2017 and released in 2020, including support in .NET 5 and beyond. The ability to run .NET code\", \" directly in the browser enables full-stack web development with .NET.\\n\\n## Blazor: full-stack web de\", \"velopment with .NET\\n\\nOn its own, the ability to run .NET code in a browser doesn't provide an end -t\", \"o-end experience for creating clientside web apps. That's where Blazor comes in. Blazor is a client \", \"-side web UI framework based on C# instead of JavaScript. Blazor can run directly in the browser via\", \" WebAssembly. No browser plugins are required. Alternatively, Blazor apps can run server-side on .NE\", \"T and handle all user interactions over a real-time connection with the browser.\\n\\nBlazor has great t\", \"ooling support in Visual Studio and Visual Studio Code. The framework also includes a full UI compon\", \"ent model and has built-in facilities for:\\n\\n- Forms and validation\\n- Dependency injection\\n- Client-s\", \"ide routing\\n- Layouts\\n- In-browser debugging\\n- JavaScript interop\\n\\nBlazor has a lot in common with A\", \"SP.NET Web Forms. Both frameworks offer component-based, event-driven, stateful UI programming model\", \"s. The main architectural difference is that ASP.NET Web Forms runs only on the server. Blazor can r\", \"un on the client in the browser. But if you're coming from an ASP.NET Web Forms background, there's \", \"a lot in Blazor that will feel familiar. Blazor is a natural solution for ASP.NET Web Forms develope\", \"rs looking for a way to take advantage of client-side development and the open-source, cross-platfor\", \"m future of .NET.\\n\\nThis book provides an introduction to Blazor that is catered specifically to ASP.\", \"NET Web Forms developers. Each Blazor concept is presented in the context of analogous ASP.NET Web F\", \"orms features and practices. By the end of this book, you'll have an understanding of:\\n\\n- How to bui\", \"ld Blazor apps.\\n- How Blazor works.\\n- How Blazor relates to .NET.\\n- Reasonable strategies for migrat\", \"ing existing ASP.NET Web Forms apps to Blazor where appropriate.\\n\\n## Get started with Blazor\\n\\nGettin\", \"g started with Blazor is easy. Go to https://blazor.net and follow the links to install the appropri\", \"ate .NET SDK and Blazor project templates. You'll also find instructions for setting up the Blazor t\", \"ooling in Visual Studio or Visual Studio Code.\\n\\n## Architecture comparison of ASP.NET Web Forms and \", \"Blazor\\n\\nWhile ASP.NET Web Forms and Blazor have many similar concepts, there are differences in how \", \"they work. This chapter examines the inner workings and architectures of ASP.NET Web Forms and Blazo\", \"r.\\n\\n## ASP.NET Web Forms\\n\\nThe ASP.NET Web Forms framework is based on a page-centric architecture. E\", \"ach HTTP request for a location in the app is a separate page with which ASP.NET responds. As pages \", \"are requested, the contents of the browser are replaced with the results of the page requested.\\n\\nPag\", \"es consist of the following components:\\n\\n- HTML markup\\n- C# or Visual Basic code\\n- A code-behind cla\", \"ss containing logic and event-handling capabilities\\n- Controls\\n\\nControls are reusable units of web U\", \"I that can be programmatically placed and interacted with on a page. Pages are composed of files tha\", \"t end with .aspx containing markup, controls, and some code. The code-behind classes are in files wi\", \"th the same base name and an .aspx.cs or .aspx.vb extension, depending on the programming language u\", \"sed. Interestingly, the web server interprets contents of the .aspx files and compiles them whenever\", \" they change. This recompilation occurs even if the web server is already running.\\n\\nControls can be \", \"built with markup and delivered as user controls. A user control derives from the UserControl class \", \"and has a similar structure to the Page. Markup for user controls is stored in an .ascx file. An acc\", \"ompanying code-behind class resides in an .ascx.cs or .ascx.vb file. Controls can also be built comp\", \"letely with code, by inheriting from either the WebControl or CompositeControl base class.\\n\\nPages al\", \"so have an extensive event lifecycle. Each page raises events for the initialization, load, prerende\", \"r, and unload events that occur as the ASP.NET runtime executes the page's code for each request.\\n\\n&\", \"lt;html&gt;\\n\\n&lt;head\\u203a...\\u2039/head&gt;\\n\\n&lt; body&gt;\\n\\nControls on a Page typically post-back to the sa\", \"me page that presented the control, and carry along with them a payload from a hidden form field cal\", \"led ViewState. The ViewState field contains information about the state of the controls at the time \", \"they were rendered and presented on the page, allowing the ASP.NET runtime to compare and identify c\", \"hanges in the content submitted to the server.\\n\\n## Blazor\\n\\nBlazor is a client-side web UI framework \", \"similar in nature to JavaScript front-end frameworks like Angular or React. Blazor handles user inte\", \"ractions and renders the necessary UI updates. Blazor isn't based on a requestreply model. User inte\", \"ractions are handled as events that aren't in the context of any particular HTTP request.\\n\\nBlazor ap\", \"ps consist of one or more root components that are rendered on an HTML page.\\n\\n<!-- image -->\\n\\nHow th\", \"e user specifies where components should render and how the components are then wired up for user in\", \"teractions is hosting model specific.\\n\\nBlazor components are .NET classes that represent a reusable \", \"piece of UI. Each component maintains its own state and specifies its own rendering logic, which can\", \" include rendering other components. Components specify event handlers for specific user interaction\", \"s to update the component's state.\\n\\nAfter a component handles an event, Blazor renders the component\", \" and keeps track of what changed in the rendered output. Components don't render directly to the Doc\", \"ument Object Model (DOM). They instead render to an in-memory representation of the DOM called a Ren\", \"derTree so that Blazor can track the changes. Blazor compares the newly rendered output with the pre\", \"vious output to calculate a UI diff that it then applies efficiently to the DOM.\\n\\n&lt;/html&gt;\\n\\nCom\", \"ponents\\n\\nUl events\\n\\nRenderTree\\n\\nUl events\\n\\n<!-- image -->\\n\\nComponents can also manually indicate tha\", \"t they should be rendered if their state changes outside of a normal UI event. Blazor uses a Synchro\", \"nizationContext to enforce a single logical thread of execution. A component's lifecycle methods and\", \" any event callbacks that are raised by Blazor are executed on this SynchronizationContext.\\n\\n## Blaz\", \"or app hosting models\\n\\nBlazor apps can be hosted in one of the following ways:\\n\\n- Client-side in the\", \" browser on WebAssembly.\\n- Server-side in an ASP.NET Core app.\\n\\n## Blazor WebAssembly apps\\n\\nBlazor W\", \"ebAssembly apps execute directly in the browser on a WebAssembly-based .NET runtime. Blazor WebAssem\", \"bly apps function in a similar way to front-end JavaScript frameworks like Angular or React. However\", \", instead of writing JavaScript you write C#. The .NET runtime is downloaded with the app along with\", \" the app assembly and any required dependencies. No browser plugins or extensions are required.\\n\\nThe\", \" downloaded assemblies are normal .NET assemblies, like you would use in any other .NET app. Because\", \" the runtime supports .NET Standard, you can use existing .NET Standard libraries with your Blazor W\", \"ebAssembly app. However, these assemblies will still execute in the browser security sandbox. Some f\", \"unctionality may throw a PlatformNotSupportedException, like trying to access the file system or ope\", \"ning arbitrary network connections.\\n\\nWhen the app loads, the .NET runtime is started and pointed at \", \"the app assembly. The app startup logic runs, and the root components are rendered. Blazor calculate\", \"s the UI updates based on the rendered output from the components. The DOM updates are then applied.\", \"\\n\\n1 https://...\\n\\nblazor\\n\\nRazor Components\\n\\nWebAssembly\\n\\n<!-- image -->\\n\\nBlazor WebAssembly apps run \", \"purely client-side. Such apps can be deployed to static site hosting solutions like GitHub Pages or \", \"Azure Static Website Hosting. .NET isn't required on the server at all. Deep linking to parts of the\", \" app typically requires a routing solution on the server. The routing solution redirects requests to\", \" the root of the app. For example, this redirection can be handled using URL rewrite rules in IIS.\\n\\n\", \"To get all the benefits of Blazor and full-stack .NET web development, host your Blazor WebAssembly \", \"app with ASP.NET Core. By using .NET on both the client and server, you can easily share code and bu\", \"ild your app using one consistent set of languages, frameworks, and tools. Blazor provides convenien\", \"t templates for setting up a solution that contains both a Blazor WebAssembly app and an ASP.NET Cor\", \"e host project. When the solution is built, the built static files from the Blazor app are hosted by\", \" the ASP.NET Core app with fallback routing already setup.\\n\\n## Blazor Server apps\\n\\nRecall from the B\", \"lazor architecture discussion that Blazor components render their output to an intermediate abstract\", \"ion called a RenderTree. The Blazor framework then compares what was rendered with what was previous\", \"ly rendered. The differences are applied to the DOM. Blazor components are decoupled from how their \", \"rendered output is applied. Consequently, the components themselves don't have to run in the same pr\", \"ocess as the process updating the UI. In fact, they don't even have to run on the same machine.\\n\\nIn \", \"Blazor Server apps, the components run on the server instead of client-side in the browser. UI event\", \"s that occur in the browser are sent to the server over a real-time connection. The events are dispa\", \"tched to the correct component instances. The components render, and the calculated UI diff is seria\", \"lized and sent to the browser where it's applied to the DOM.\\n\\nX\\n\\n- \\u2022\\n\\n\\u2039 https..\\n\\n<!-- image -->\\n\\nThe\", \" Blazor Server hosting model may sound familiar if you've used ASP.NET AJAX and the UpdatePanel cont\", \"rol. The UpdatePanel control handles applying partial page updates in response to trigger events on \", \"the page. When triggered, the UpdatePanel requests a partial update and then applies it without need\", \"ing to refresh the page. The state of the UI is managed using ViewState. Blazor Server apps are slig\", \"htly different in that the app requires an active connection with the client. Additionally, all UI s\", \"tate is maintained on the server. Aside from those differences, the two models are conceptually simi\", \"lar.\\n\\n## How to choose the right Blazor hosting model\\n\\nAs described in the Blazor hosting model docs\", \", the different Blazor hosting models have different tradeoffs.\\n\\nThe Blazor WebAssembly hosting mode\", \"l has the following benefits:\\n\\n- There's no .NET server -side dependency. The app is fully functioni\", \"ng after downloaded to the client.\\n- Client resources and capabilities are fully leveraged.\\n- Work i\", \"s offloaded from the server to the client.\\n- An ASP.NET Core web server isn't required to host the a\", \"pp. Serverless deployment scenarios are possible (for example, serving the app from a CDN).\\n\\nThe dow\", \"nsides of the Blazor WebAssembly hosting model are:\\n\\n- Browser capabilities restrict the app.\\n- Capa\", \"ble client hardware and software (for example, WebAssembly support) is required.\\n- Download size is \", \"larger, and apps take longer to load.\\n\\n- .NET runtime and tooling support is less mature. For exampl\", \"e, there are limitations in .NET Standard support and debugging.\\n\\nConversely, the Blazor Server host\", \"ing model offers the following benefits:\\n\\n- Download size is much smaller than a client-side app, an\", \"d the app loads much faster.\\n- The app takes full advantage of server capabilities, including use of\", \" any .NET compatible APIs.\\n- .NET on the server is used to run the app, so existing .NET tooling, su\", \"ch as debugging, works as expected.\\n- Thin clients are supported. For example, serverside apps work \", \"with browsers that don't support WebAssembly and on resource-constrained devices.\\n- The app's .NET/C\", \"# code base, including the app's component code, isn't served to clients.\\n\\nThe downsides to the Blaz\", \"or Server hosting model are:\\n\\n- Higher UI latency. Every user interaction involves a network hop.\\n- \", \"There's no offline support. If the client connection fails, the app stops working.\\n- Scalability is \", \"challenging for apps with many users. The server must manage multiple client connections and handle \", \"client state.\\n- An ASP.NET Core server is required to serve the app. Serverless deployment scenarios\", \" aren't possible. For example, you can't serve the app from a CDN.\\n\\nThe preceding list of trade-offs\", \" may be intimidating, but your hosting model can be changed later. Regardless of the Blazor hosting \", \"model selected, the component model is the same . In principle, the same components can be used with\", \" either hosting model. Your app code doesn't change; however, it's a good practice to introduce abst\", \"ractions so that your components stay hosting model -agnostic. The abstractions allow your app to mo\", \"re easily adopt a different hosting model.\\n\\n## Deploy your app\\n\\nASP.NET Web Forms apps are typically\", \" hosted on IIS on a Windows Server machine or cluster. Blazor apps can also:\\n\\n- Be hosted on IIS, ei\", \"ther as static files or as an ASP.NET Core app.\\n- Leverage ASP.NET Core's flexibility to be hosted o\", \"n various platforms and server infrastructures. For example, you can host a Blazor App using Nginx o\", \"r Apache on Linux. For more information about how to publish and deploy Blazor apps, see the Blazor \", \"Hosting and deployment documentation.\\n\\nIn the next section, we'll look at how the projects for Blazo\", \"r WebAssembly and Blazor Server apps are set up.\\n\\n## Project structure for Blazor apps\\n\\nDespite thei\", \"r significant project structure differences, ASP.NET Web Forms and Blazor share many similar concept\", \"s. Here, we'll look at the structure of a Blazor project and compare it to an ASP.NET Web Forms proj\", \"ect.\\n\\nTo create your first Blazor app, follow the instructions in the Blazor getting started steps. \", \"You can follow the instructions to create either a Blazor Server app or a Blazor WebAssembly app hos\", \"ted in ASP.NET Core. Except for the hosting model-specific logic, most of the code in both projects \", \"is the same.\\n\\n## Project file\\n\\nBlazor Server apps are .NET projects. The project file for the Blazor\", \" Server app is about as simple as it can get:\\n\\n```\\n< Project Sdk=\\\"Microsoft.NET.Sdk.Web\\\"> < Property\", \"Group > < TargetFramework >net8.0</ TargetFramework > </ PropertyGroup > </ Project > The project fi\", \"le for a Blazor WebAssembly app looks slightly more involved (exact version numbers may vary): < Pro\", \"ject Sdk=\\\"Microsoft.NET.Sdk.BlazorWebAssembly\\\"> < PropertyGroup > < TargetFramework >net8.0</ Target\", \"Framework > < ImplicitUsings >enable</ ImplicitUsings > </ PropertyGroup > < ItemGroup > < PackageRe\", \"ference Include=\\\"Microsoft.AspNetCore.Components.WebAssembly\\\" Version=\\\"8.0.0\\\" /> < PackageReference \", \"Include=\\\"Microsoft.AspNetCore.Components.WebAssembly.DevServer\\\" Version=\\\"8.0.0\\\" PrivateAssets=\\\"all\\\" \", \"/> </ ItemGroup > </ Project >\\n```\\n\\nBlazor WebAssembly project targets Microsoft.NET.Sdk.BlazorWebAs\", \"sembly instead of Microsoft.NET.Sdk.Web sdk because they run in the browser on a WebAssembly-based .\", \"NET runtime. You can't install .NET into a web browser like you can on a server or developer machine\", \". Consequently, the project references the Blazor framework using individual package references.\\n\\nBy\", \" comparison, a default ASP.NET Web Forms project includes almost 300 lines of XML in its .csproj fil\", \"e, most of which is explicitly listing the various code and content files in the project. Since the \", \"release of .NET 5, both Blazor Server and Blazor WebAssembly apps can easily share one unified runti\", \"me.\\n\\nAlthough they're supported, individual assembly references are less common in .NET projects. Mo\", \"st project dependencies are handled as NuGet package references. You only need to reference top-leve\", \"l package dependencies in .NET projects. Transitive dependencies are included automatically. Instead\", \" of using the packages.config file commonly found in ASP.NET Web Forms projects to reference package\", \"s, package references are added to the project file using the &lt;PackageReference&gt; element.\\n\\n```\", \"\\n< ItemGroup > < PackageReference Include=\\\"Newtonsoft.Json\\\" Version=\\\"13.0.2\\\" /> </ ItemGroup >\\n```\\n\\n\", \"## Entry point\\n\\nThe Blazor Server app's entry point is defined in the Program.cs file, as you would \", \"see in a Console app. When the app executes, it creates and runs a web host instance using defaults \", \"specific to web apps. The web host manages the Blazor Server app's lifecycle and sets up host -level\", \" services. Examples of such services are configuration, logging, dependency injection, and the HTTP \", \"server. This code is mostly boilerplate and is often left unchanged.\\n\\n```\\nusing BlazorApp3.Areas.Ide\", \"ntity; using BlazorApp3.Data; using Microsoft.AspNetCore.Components.Authorization; using Microsoft.A\", \"spNetCore.Identity; using Microsoft.EntityFrameworkCore; var builder = WebApplication.CreateBuilder(\", \"args); // Add services to the container. var connectionString = builder.Configuration.GetConnectionS\", \"tring(\\\"DefaultConnection\\\"); builder.Services.AddDbContext<ApplicationDbContext>(options => options.U\", \"seSqlServer(connectionString)); builder.Services.AddDatabaseDeveloperPageExceptionFilter(); builder.\", \"Services.AddDefaultIdentity<IdentityUser>(options => options.SignIn.RequireConfirmedAccount = true )\", \" .AddEntityFrameworkStores<ApplicationDbContext>(); builder.Services.AddRazorPages(); builder.Servic\", \"es.AddServerSideBlazor(); builder.Services.AddScoped<AuthenticationStateProvider, RevalidatingIdenti\", \"tyAuthenticationStateProvider<IdentityUser>>(); builder.Services.AddSingleton<WeatherForecastService\", \">(); var app = builder.Build(); // Configure the HTTP request pipeline.\\n```\\n\\n```\\nif (app.Environment\", \".IsDevelopment()) { app.UseMigrationsEndPoint(); } else { app.UseExceptionHandler(\\\"/Error\\\"); // The \", \"default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka\", \".ms/aspnetcore-hsts. app.UseHsts(); } app.UseHttpsRedirection(); app.UseStaticFiles(); app.UseRoutin\", \"g(); app.UseAuthorization(); app.MapControllers(); app.MapBlazorHub(); app.MapFallbackToPage(\\\"/_Host\", \"\\\"); app.Run();\\n```\\n\\nBlazor WebAssembly apps also define an entry point in Program.cs . The code look\", \"s slightly different. The code is similar in that it's setting up the app host to provide the same h\", \"ost-level services to the app. The WebAssembly app host doesn't, however, set up an HTTP server beca\", \"use it executes directly in the browser.\\n\\nBlazor apps don't use a Global.asax file to define the sta\", \"rtup logic for the app. Instead, this logic is contained in Program.cs or in a related Startup class\", \" that is referenced from Program.cs . Either way, this code is used to configure the app and any app\", \"-specific services.\\n\\nIn a Blazor Server app, the Program.cs file shown is used to set up the endpoin\", \"t for the real-time connection used by Blazor between the client browsers and the server.\\n\\nIn a Blaz\", \"or WebAssembly app, the Program.cs file defines the root components for the app and where they shoul\", \"d be rendered:\\n\\n```\\nusing BlazorApp1; using Microsoft.AspNetCore.Components.Web; using Microsoft.Asp\", \"NetCore.Components.WebAssembly.Hosting; var builder = WebAssemblyHostBuilder.CreateDefault(args); bu\", \"ilder.RootComponents.Add<App>(\\\"#app\\\"); builder.RootComponents.Add<HeadOutlet>(\\\"head::after\\\"); builde\", \"r.Services.AddScoped(sp => new HttpClient { BaseAddress = new Uri(builder.HostEnvironment.BaseAddres\", \"s) }); await builder.Build().RunAsync();\\n```\\n\\n## Static files\\n\\nUnlike ASP.NET Web Forms projects, no\", \"t all files in a Blazor project can be requested as static files. Only the files in the wwwroot fold\", \"er are webaddressable. This folder is referred to as the app's 'web root'. Anything outside of the a\", \"pp's web root isn't web-addressable. This setup provides an additional level of security that preven\", \"ts accidental exposure of project files over the web.\\n\\n## Configuration\\n\\nConfiguration in ASP.NET We\", \"b Forms apps is typically handled using one or more web.config files. Blazor apps don't typically ha\", \"ve web.config files. If they do, the file is only used to configure IISspecific settings when hosted\", \" on IIS. Instead, Blazor Server apps use the ASP.NET Core configuration abstractions. (Blazor WebAss\", \"embly apps don't currently support the same configuration abstractions, but that may be a feature ad\", \"ded in the future.) For example, the default Blazor Server app stores some settings in appsettings.j\", \"son .\\n\\n```\\n{ \\\"Logging\\\": { \\\"LogLevel\\\": { \\\"Default\\\": \\\"Information\\\", \\\"Microsoft\\\": \\\"Warning\\\", \\\"Microsoft\", \".Hosting.Lifetime\\\": \\\"Information\\\" } }, \\\"AllowedHosts\\\": \\\"*\\\" }\\n```\\n\\nYou'll learn more about configurat\", \"ion in ASP.NET Core projects in the Configuration section.\\n\\n## Razor components\\n\\nMost files in Blazo\", \"r projects are .razor files. Razor is a templating language based on HTML and C# that is used to dyn\", \"amically generate web UI. The .razor files define components that make up the UI of the app. For the\", \" most part, the components are identical for both the Blazor Server and Blazor WebAssembly apps. Com\", \"ponents in Blazor are analogous to user controls in ASP.NET Web Forms.\\n\\nEach Razor component file is\", \" compiled into a .NET class when the project is built. The generated class captures the component's \", \"state, rendering logic, lifecycle methods, event handlers, and other logic. You'll learn more about \", \"authoring components in the Building reusable UI components with Blazor section.\\n\\nThe *\\\\_Imports.raz\", \"or* files aren't Razor component files. Instead, they define a set of Razor directives to import int\", \"o other .razor files within the same folder and in its subfolders. For example, a *\\\\_Imports.razor* \", \"file is a conventional way to add using directives for commonly used namespaces:\\n\\n```\\n@using System.\", \"Net.Http @using System.Net.Http.Json @using Microsoft.AspNetCore.Components.Forms @using Microsoft.A\", \"spNetCore.Components.Routing\\n```\\n\\n```\\n@using Microsoft.AspNetCore.Components.Web @using Microsoft.As\", \"pNetCore.Components.Web.Virtualization @using Microsoft.AspNetCore.Components.WebAssembly.Http @usin\", \"g Microsoft.JSInterop @using BlazorApp1 @using BlazorApp1.Shared\\n```\\n\\n## Pages\\n\\nWhere are the pages \", \"in the Blazor apps? Blazor doesn't define a separate file extension for addressable pages, like the \", \".aspx files in ASP.NET Web Forms apps. Instead, pages are defined by assigning routes to components.\", \" A route is typically assigned using the @page Razor directive. For example, the Counter component a\", \"uthored in the Pages/Counter.razor file defines the following route:\\n\\n@page \\\"/counter\\\"\\n\\nRouting in B\", \"lazor is handled client-side, not on the server. As the user navigates in the browser, Blazor interc\", \"epts the navigation and then renders the component with the matching route.\\n\\nThe component routes ar\", \"en't currently inferred by the component's file location like they are with .aspx pages or ASP.NET C\", \"ore Razor Pages. This feature may be added in the future. Each route must be specified explicitly on\", \" the component. Storing routable components in a Pages folder has no special meaning and is purely a\", \" convention.\\n\\nYou'll learn more about routing in Blazor in the Pages, routing, and layouts section.\\n\", \"\\n## Layout\\n\\nIn ASP.NET Web Forms apps, a common page layout is handled using master pages ( Site.Mas\", \"ter ). In Blazor apps, the page layout is handled using layout components ( Shared/MainLayout.razor \", \"). Layout components are discussed in more detail in the Page, routing, and layouts section.\\n\\n## Boo\", \"tstrap Blazor\\n\\nTo bootstrap Blazor, the app must:\\n\\n- Specify where on the page the root component ( \", \"App.Razor ) should be rendered.\\n- Add the corresponding Blazor framework script.\\n\\nIn the Blazor Serv\", \"er app, the root component's host page is defined in the *\\\\_Host.cshtml* file. This file defines a R\", \"azor Page, not a component. Razor Pages use Razor syntax to define a server-addressable page, very m\", \"uch like an .aspx page.\\n\\n```\\n@page \\\"/\\\" @namespace BlazorApp3.Pages @addTagHelper *, Microsoft.AspNet\", \"Core.Mvc.TagHelpers @{ Layout = \\\"_Layout\\\"; }\\n```\\n\\n```\\n<component type=\\\"typeof(App)\\\" render-mode=\\\"Ser\", \"verPrerendered\\\" />\\n```\\n\\nThe render-mode attribute is used to define where a root-level component sho\", \"uld be rendered. The RenderMode option indicates the manner in which the component should be rendere\", \"d. The following table outlines the supported RenderMode options.\\n\\n| Option                       | \", \"Description                                                              |\\n|------------------------\", \"------|--------------------------------------------------------------------------|\\n| RenderMode.Serv\", \"er            | Rendered interactively once a connection with the browser is established |\\n| RenderM\", \"ode.ServerPrerendered | First prerendered and then rendered interactively                        |\\n|\", \" RenderMode.Static            | Rendered as static content                                          \", \"     |\\n\\nThe *\\\\_Layout.cshtml* file includes the default HTML for the app and its components.\\n\\n```\\n@u\", \"sing Microsoft.AspNetCore.Components.Web @namespace BlazorApp3.Pages @addTagHelper *, Microsoft.AspN\", \"etCore.Mvc.TagHelpers <!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"utf-8\\\" /> <meta name=\\\"v\", \"iewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" /> <base href=\\\"~/\\\" /> <link rel=\\\"stylesheet\", \"\\\" href=\\\"css/bootstrap/bootstrap.min.css\\\" /> <link href=\\\"css/site.css\\\" rel=\\\"stylesheet\\\" /> <link href\", \"=\\\"BlazorApp3.styles.css\\\" rel=\\\"stylesheet\\\" /> <component type=\\\"typeof(HeadOutlet)\\\" render-mode=\\\"Serve\", \"rPrerendered\\\" /> </head> <body> @RenderBody() <div id=\\\"blazor-error-ui\\\"> <environment include=\\\"Stagi\", \"ng,Production\\\"> An error has occurred. This application may no longer respond until reloaded. </envi\", \"ronment> <environment include=\\\"Development\\\"> An unhandled exception has occurred. See browser dev to\", \"ols for details. </environment> <a href=\\\"\\\" class=\\\"reload\\\">Reload</a> <a class=\\\"dismiss\\\"> \\ud83d\\uddd9 </a> </di\", \"v> <script src=\\\"_framework/blazor.server.js\\\"></script> </body> </html>\\n```\\n\\nThe script reference to \", \"*\\\\_framework/blazor.server.js* establishes the real-time connection with the server and then deals w\", \"ith all user interactions and UI updates.\\n\\nIn the Blazor WebAssembly app, the host page is a simple \", \"static HTML file under wwwroot/index.html . The &lt;div&gt; element with id named app is used to ind\", \"icate where the root component should be rendered.\\n\\n```\\n<!DOCTYPE html> < html lang =\\\"en\\\"> < head > \", \"< meta charset =\\\"utf-8\\\" /> < meta name =\\\"viewport\\\" content =\\\"width=device-width, initial-scale=1.0, \", \"maximumscale=1.0, user-scalable=no\\\" /> < title >BlazorApp1</ title > < base href =\\\"/\\\" /> < link href\", \" =\\\"css/bootstrap/bootstrap.min.css\\\" rel =\\\"stylesheet\\\" /> < link href =\\\"css/app.css\\\" rel =\\\"stylesheet\", \"\\\" /> < link href =\\\"BlazorApp1.styles.css\\\" rel =\\\"stylesheet\\\" /> </ head > < body > < div id =\\\"app\\\">Lo\", \"ading...</ div > < div id =\\\"blazor-error-ui\\\"> An unhandled error has occurred. < a href =\\\"\\\" class =\\\"\", \"reload\\\">Reload</ a > < a class =\\\"dismiss\\\"> \\ud83d\\uddd9 </ a > </ div > < script src =\\\"_framework/blazor.webass\", \"embly.js\\\"></ script > </ body > </ html >\\n```\\n\\nThe root component to render is specified in the app'\", \"s Program.cs file with the flexibility to register services through dependency injection. For more i\", \"nformation, see ASP.NET Core Blazor dependency injection.\\n\\n```\\nvar builder = WebAssemblyHostBuilder.\", \"CreateDefault(args); builder.RootComponents.Add<App>(\\\"#app\\\"); builder.RootComponents.Add<HeadOutlet>\", \"(\\\"head::after\\\");\\n```\\n\\n## Build output\\n\\nWhen a Blazor project is built, all Razor component and code \", \"files are compiled into a single assembly. Unlike ASP.NET Web Forms projects, Blazor doesn't support\", \" runtime compilation of the UI logic.\\n\\n## Run the app with Hot Reload\\n\\nTo run the Blazor Server app,\", \" press F5 in Visual Studio to run with the debugger attached, or Ctrl + F5 to run without the debugg\", \"er attached.\\n\\nTo run the Blazor WebAssembly app, choose one of the following approaches:\\n\\n- Run the \", \"client project directly using the development server.\\n\\n00\\n\\nFile\\n\\nTest Analyze Tools\\n\\n\\u2022 -\\n\\nEdit View \", \"Git Project Build Debug\\n\\nExtensions\\n\\nWindow\\n\\nHelp\\n\\n\\u2022 HotReloadDemo - D\\n\\nArchitecture Test Analyze To\", \"ols Extensions\\n\\n9-9-\\n\\nDebug -\\n\\nU\\n\\nHot Reload\\n\\nCounter.razor + x HotReloadDemo: Overview\\n\\n1\\n\\n2\\n\\n4\\n\\n5\\n\", \"\\n6\\n\\n- Run the server project when hosting the app with ASP.NET Core.\\n\\nBlazor WebAssembly apps can be\", \" debugged in both browser and Visual Studio. See Debug ASP.NET Core Blazor WebAssembly for details.\\n\", \"\\nBoth Blazor Server and Blazor WebAssembly apps support Hot Reload in Visual Studio. Hot Reload is a\", \" feature that automatically updates changes made to a Blazor app live, in the browser. You can toggl\", \"e whether Hot Reload is enabled from its icon in the toolbar:\\n\\n<!-- image -->\\n\\nSelecting the caret b\", \"eside the icon reveals additional options. You can toggle Hot Reload on or off, restart the applicat\", \"ion, and toggle whether Hot Reload should occur whenever a file is saved.\\n\\n<!-- image -->\\n\\nYou can a\", \"lso access additional configuration options. The configuration dialog lets you specify whether Hot R\", \"eload should be enabled when debugging (along with Edit and Continue), when starting without debuggi\", \"ng, or when a file is saved.\\n\\nSearch\\n\\nAny CPU\\n\\nHotReloadDemo -\\n\\nServer Explorer\\n\\nToolbox\\n\\nOptions\\n\\nS\", \"earch Options (CtrI+E)\\n\\n\\u2022 Source Control\\n\\n\\u2022 Work Items\\n\\n\\u2022 Text Editor\\n\\n\\u2022 Debugging\\n\\nGeneral\\n\\nNET / C\", \"++ Hot Reload\\n\\nJust-In- Time\\n\\nOutput Window\\n\\nSymbols\\n\\nXAML Hot Reload\\n\\n\\u2022 IntelliTrace\\n\\n\\u2022 Performance\", \" Tools\\n\\n\\u2022 .NET Core Debugging with WSL\\n\\n\\u2022 Azure Data Lake\\n\\n\\u2022 Azure Service Authentication\\n\\n\\u2022 Contain\", \"er Tools\\n\\n\\u2022 Cross Platform\\n\\nA\\n\\n/ Enable Hot Reload and Edit and Continue when debugging\\n\\n/ Enable Ho\", \"t Reload when starting without debugging\\n\\n/ Apply Hot Reload on File Save\\n\\n<!-- image -->\\n\\nThe 'deve\", \"loper inner loop' has been greatly streamlined with Hot Reload. Without Hot Reload, a Blazor develop\", \"er would typically need to restart and rerun the app after every change, navigating to the appropria\", \"te part of the app as required. With Hot Reload, changes can be made to the running app without the \", \"need to restart in most cases. Hot Reload even retains the state of pages, so there's no need to hav\", \"e to re-enter form values or otherwise get the app back where you need it.\\n\\n?\\n\\nX\\n\\n## App startup\\n\\nAp\", \"plications that are written for ASP.NET typically have a global.asax.cs file that defines the Applic\", \"ation\\\\_Start event that controls which services are configured and made available for both HTML rend\", \"ering and .NET processing. This chapter looks at how things are slightly different with ASP.NET Core\", \" and Blazor Server.\\n\\n## Application\\\\_Start and Web Forms\\n\\nThe default web forms Application\\\\_Start m\", \"ethod has grown in purpose over years to handle many configuration tasks. A fresh web forms project \", \"with the default template in Visual Studio 2022 now contains the following configuration logic:\\n\\n- R\", \"outeConfig - Application URL routing\\n- BundleConfig - CSS and JavaScript bundling and minification\\n\\n\", \"Each of these individual files resides in the App\\\\_Start folder and run only once at the start of ou\", \"r application. RouteConfig in the default project template adds the FriendlyUrlSettings for web form\", \"s to allow application URLs to omit the .ASPX file extension. The default template also contains a d\", \"irective that provides permanent HTTP redirect status codes (HTTP 301) for the .ASPX pages to the fr\", \"iendly URL with the file name that omits the extension.\\n\\nWith ASP.NET Core and Blazor, these methods\", \" are either simplified and consolidated into the Startup class or they are eliminated in favor of co\", \"mmon web technologies.\\n\\n## Blazor Server Startup Structure\\n\\nBlazor Server applications reside on top\", \" of an ASP.NET Core 3.0 or later version. ASP.NET Core web applications are configured in Program.cs\", \" , or through a pair of methods in the Startup.cs class. A sample Program.cs file is shown below:\\n\\n`\", \"``\\nusing BlazorApp1.Data; using Microsoft.AspNetCore.Components; using Microsoft.AspNetCore.Componen\", \"ts.Web; var builder = WebApplication.CreateBuilder(args); // Add services to the container. builder.\", \"Services.AddRazorPages(); builder.Services.AddServerSideBlazor(); builder.Services.AddSingleton<Weat\", \"herForecastService>();\\n```\\n\\n```\\nvar app = builder.Build(); // Configure the HTTP request pipeline. i\", \"f (!app.Environment.IsDevelopment()) { app.UseExceptionHandler(\\\"/Error\\\"); // The default HSTS value \", \"is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts\", \". app.UseHsts(); } app.UseHttpsRedirection(); app.UseStaticFiles(); app.UseRouting(); app.MapBlazorH\", \"ub(); app.MapFallbackToPage(\\\"/_Host\\\"); app.Run();\\n```\\n\\nThe app's required services are added to the \", \"WebApplicationBuilder instance's Services collection. This is how the various ASP.NET Core framework\", \" services are configured with the framework's built -in dependency injection container. The various \", \"builder.Services.Add* methods add services that enable features such as authentication, razor pages,\", \" MVC controller routing, SignalR, and Blazor Server interactions among many others. This method was \", \"not needed in web forms, as the parsing and handling of the ASPX, ASCX, ASHX, and ASMX files were de\", \"fined by referencing ASP.NET in the web.config configuration file. More information about dependency\", \" injection in ASP.NET Core is available in the online documentation.\\n\\nAfter the app has been built b\", \"y the builder, the rest of the calls on app configure its HTTP pipeline. With these calls, we declar\", \"e from top to bottom the Middleware that will handle every request sent to our application. Most of \", \"these features in the default configuration were scattered across the web forms configuration files \", \"and are now in one place for ease of reference.\\n\\nNo longer is the configuration of the custom error \", \"page placed in a web.config file, but now is configured to always be shown if the application enviro\", \"nment is not labeled Development. Additionally, ASP.NET Core applications are now configured to serv\", \"e secure pages with TLS by default with the UseHttpsRedirection method call.\\n\\nNext, an unexpected co\", \"nfiguration method call is made to UseStaticFiles. In ASP.NET Core, support for requests for static \", \"files (like JavaScript, CSS, and image files) must be explicitly enabled, and only files in the app'\", \"s wwwroot folder are publicly addressable by default.\\n\\nThe next line is the first that replicates on\", \"e of the configuration options from web forms: UseRouting. This method adds the ASP.NET Core router \", \"to the pipeline and it can be either configured here or in the individual files that it can consider\", \" routing to. More information about routing configuration can be found in the Routing section.\\n\\nThe \", \"final app.Map* calls in this section define the endpoints that ASP.NET Core is listening on. These r\", \"outes are the web accessible locations that you can access on the web server and receive some conten\", \"t handled by .NET and returned to you. The first entry, MapBlazorHub configures a SignalR hub for us\", \"e in providing the real-time and persistent connection to the server where the state and rendering o\", \"f Blazor components is handled. The MapFallbackToPage method call indicates the webaccessible locati\", \"on of the page that starts the Blazor application and also configures the application to\\n\\nhandle dee\", \"p-linking requests from the client-side. You will see this feature at work if you open a browser and\", \" navigate directly to Blazor handled route in your application, such as /counter in the default proj\", \"ect template. The request gets handled by the *\\\\_Host.cshtml* fallback page, which then runs the Bla\", \"zor router and renders the counter page.\\n\\nThe very last line starts the application, something that \", \"wasn't required in web forms (since it relied on IIS to be running).\\n\\n## Upgrading the BundleConfig \", \"Process\\n\\nTechnologies for bundling assets like CSS stylesheets and JavaScript files have changed sig\", \"nificantly, with other technologies providing quickly evolving tools and techniques for managing the\", \"se resources. To this end, we recommend using a Node command-line tool such as Grunt / Gulp / WebPac\", \"k to package your static assets.\\n\\nThe Grunt, Gulp, and WebPack command-line tools and their associat\", \"ed configurations can be added to your application and ASP.NET Core will quietly ignore those files \", \"during the application build process. You can add a call to run their tasks by adding a Target insid\", \"e your project file with syntax similar to the following that would trigger a gulp script and the mi\", \"n target inside that script:\\n\\n```\\n< Target Name=\\\"MyPreCompileTarget\\\" BeforeTargets=\\\"Build\\\"> < Exec C\", \"ommand=\\\"gulp min\\\" /> </ Target >\\n```\\n\\nMore details about both strategies to manage your CSS and Java\", \"Script files are available in the Bundle and minify static assets in ASP.NET Core documentation.\\n\\n##\", \" Build reusable UI components with Blazor\\n\\nOne of the beautiful things about ASP.NET Web Forms is ho\", \"w it enables encapsulation of reusable pieces of user interface (UI) code into reusable UI controls.\", \" Custom user controls can be defined in markup using .ascx files. You can also build elaborate serve\", \"r controls in code with full designer support.\\n\\nBlazor also supports UI encapsulation through compon\", \"ents . A component:\\n\\n- Is a self-contained chunk of UI.\\n- Maintains its own state and rendering logi\", \"c.\\n- Can define UI event handlers, bind to input data, and manage its own lifecycle.\\n- Is typically \", \"defined in a .razor file using Razor syntax.\\n\\n## An introduction to Razor\\n\\nRazor is a light-weight m\", \"arkup templating language based on HTML and C#. With Razor, you can seamlessly transition between ma\", \"rkup and C# code to define your component rendering logic. When the .razor file is compiled, the ren\", \"dering logic is captured in a structured way in a .NET class. The name of the compiled class is take\", \"n from the .razor file name. The namespace is taken from the default namespace for the project and t\", \"he folder path, or you can explicitly specify the namespace using the @namespace directive (more on \", \"Razor directives below).\\n\\nA component's rendering logic is authored using normal HTML markup with dy\", \"namic logic added using C#. The @ character is used to transition to C#. Razor is typically smart ab\", \"out figuring out when you've switched back to HTML. For example, the following component renders a &\", \"lt;p&gt; tag with the current time:\\n\\n## &lt;p&gt;@DateTime.Now&lt;/p&gt;\\n\\nTo explicitly specify the \", \"beginning and ending of a C# expression, use parentheses:\\n\\n## &lt;p&gt;@(DateTime.Now)&lt;/p&gt;\\n\\nRa\", \"zor also makes it easy to use C# control flow in your rendering logic. For example, you can conditio\", \"nally render some HTML like this:\\n\\n```\\n@if (value % 2 == 0) { <p>The value was even.</p> }\\n```\\n\\nOr y\", \"ou can generate a list of items using a normal C# foreach loop like this:\\n\\n```\\n<ul> @foreach (var it\", \"em in items) { <li>@item.Text</li> } </ul>\\n```\\n\\nRazor directives, like directives in ASP.NET Web For\", \"ms, control many aspects of how a Razor component is compiled. Examples include the component's:\\n\\n- \", \"Namespace\\n- Base class\\n- Implemented interfaces\\n- Generic parameters\\n- Imported namespaces\\n- Routes\\n\", \"\\nRazor directives start with the @ character and are typically used at the start of a new line at th\", \"e start of the file. For example, the @namespace directive defines the component's namespace:\\n\\n@name\", \"space MyComponentNamespace\\n\\nThe following table summarizes the various Razor directives used in Blaz\", \"or and their ASP.NET Web Forms equivalents, if they exist.\\n\\n| Directive   | Description             \", \"                      | Example                    | Web Forms equivalent                        |\\n|\", \"-------------|-----------------------------------------------|----------------------------|---------\", \"------------------------------------|\\n| @attribute  | Adds a class-level attribute to the component \", \"| @attribute [Authorize]     | None                                        |\\n| @code       | Adds cl\", \"ass members to the component           | @code { ... }              | <script runat=\\\"server\\\">...</sc\", \"ript>         |\\n| @implements | Implements the specified interface            | @impleme nts IDispos\", \"able   | Use code-behind                             |\\n| @inherits   | Inherits from the specified b\", \"ase class        | @inherits MyCompon entBase | <%@ Control Inherits=\\\"MyUserControlBase\\\" %> |\\n| @inj\", \"ect     | Injects a service into the component          | @inject IJSRuntime JS      | None         \", \"                               |\\n\\n| Directive   | Description                                       \", \"   | Example                       | Web Forms equivalent                       |\\n|-------------|---\", \"---------------------------------------------------|-------------------------------|----------------\", \"----------------------------|\\n| @layout     | Specifies a layout component for the component       |\", \" @layout MainLayout            | <%@ Page MasterPageFile=\\\"~/Site.Master\\\" %> |\\n| @namespace  | Sets t\", \"he namespace for the component                 | @namespa ce MyNamesp ace      | None               \", \"                        |\\n| @page       | Specifies the route for the component                | @pa\", \"ge \\\"/product/{i d}\\\"        | <%@ Page %>                                |\\n| @typeparam  | Specifies \", \"a generic type parameter for the component | @typepara mTItem              | Use code-behind        \", \"                    |\\n| @using      | Specifies a namespace to bring into scope            | @using \", \"MyCompon entNamesp ace | Add namespace in web.config                |\\n\\nRazor components also make ex\", \"tensive use of directive attributes on elements to control various aspects of how components get com\", \"piled (event handling, data binding, component &amp; element references, and so on). Directive attri\", \"butes all follow a common generic syntax where the values in parenthesis are optional:\\n\\n@directive(-\", \"suffix(:name))(=\\\"value\\\")\\n\\nThe following table summarizes the various attributes for Razor directives\", \" used in Blazor.\\n\\n| Attribute   | Description                                                       \", \"                          | Example                                                   |\\n|-----------\", \"--|---------------------------------------------------------------------------------------------|---\", \"--------------------------------------------------------|\\n| @attributes | Renders a dictionary of at\", \"tributes                                                          | <input @attributes=\\\"ExtraA ttrib\", \"utes\\\" />                  |\\n| @bind       | Creates a two-way data binding                          \", \"                                    | <input @bind=\\\"username\\\" @bind:event=\\\"oninp ut\\\" />         |\\n| \", \"@on{event}  | Adds an event handler for the specified event                                         \", \"      | <button @onclick=\\\"Incremen tCount\\\">Click me!</button>     |\\n| @key        | Specifies a key \", \"to be used by the diffing algorithm for preserving elements in a collection | <DetailsEditor @key=\\\"p\", \"erson\\\" Details=\\\"person.Det ails\\\" /> |\\n\\n| Attribute   | Description                                  \", \"         | Example                      |\\n|-------------|-------------------------------------------\", \"------------|------------------------------|\\n| @ref        | Captures a reference to the component o\", \"r HTML element | <MyDialog @ref=\\\"myDialog\\\" /> |\\n\\nThe various directive attributes used by Blazor (@o\", \"nclick, @bind, @ref, and so on) are covered in the sections below and later chapters.\\n\\nMany of the s\", \"yntaxes used in .aspx and .ascx files have parallel syntaxes in Razor. Below is a simple comparison \", \"of the syntaxes for ASP.NET Web Forms and Razor.\\n\\n| Feature                    | Web Forms          \", \"| Syntax               | Razor                    | Synt ax                             |\\n|---------\", \"-------------------|--------------------|----------------------|--------------------------|---------\", \"----------------------------|\\n| Directives                 | <%@ [directive] %> | <%@ Page %>       \", \"   | @[directive]             | @pa ge                              |\\n| Code blocks                |\", \" <% %>              | <% int x = 123; %>   | @{ }                     | @{ int x = 123; }           \", \"        |\\n| Expressions (HTML-encoded) | <%: %>             | <%:DateTime.Now %>   | Implicit:@ Expl\", \"icit: @() | @Da teTi me.N ow @(Da teTi me.N ow) |\\n| Comments                   | <%-- --%>          \", \"| <%-- Commented -- %> | @* *@                    | @* Com ment ed *@                   |\\n| Data bin\", \"ding               | <%# %>             | <%# Bind(\\\"Name\\\") %>  | @bind                    | <inp ut \", \"@bin d=\\\"u serna me\\\" />      |\\n\\nTo add members to the Razor component class, use the @code directive.\", \" This technique is similar to using a &lt;script runat=\\\"server\\\"&gt;...&lt;/script&gt; block in an AS\", \"P.NET Web Forms user control or page.\\n\\n```\\n@code { int count = 0; void IncrementCount() { count++;\\n`\", \"``\\n\\n}\\n\\n}\\n\\nBecause Razor is based on C#, it must be compiled from within a C# project ( .csproj ). Yo\", \"u can't compile .razor files from a Visual Basic project ( .vbproj ). You can still reference Visual\", \" Basic projects from your Blazor project. The opposite is true too.\\n\\nFor a full Razor syntax referen\", \"ce, see Razor syntax reference for ASP.NET Core.\\n\\n## Use components\\n\\nAside from normal HTML, compone\", \"nts can also use other components as part of their rendering logic. The syntax for using a component\", \" in Razor is similar to using a user control in an ASP.NET Web Forms app. Components are specified u\", \"sing an element tag that matches the type name of the component. For example, you can add a Counter \", \"component like this:\\n\\n## &lt;Counter /&gt;\\n\\nUnlike ASP.NET Web Forms, components in Blazor:\\n\\n- Don't\", \" use an element prefix (for example, asp:).\\n- Don't require registration on the page or in the web.c\", \"onfig .\\n\\nThink of Razor components like you would .NET types, because that's exactly what they are. \", \"If the assembly containing the component is referenced, then the component is available for use. To \", \"bring the component's namespace into scope, apply the @using directive:\\n\\n```\\n@using MyComponentLib <\", \"Counter />\\n```\\n\\nAs seen in the default Blazor projects, it's common to put @using directives into a \", \"*\\\\_Imports.razor* file so that they're imported into all .razor files in the same directory and in c\", \"hild directories.\\n\\nIf the namespace for a component isn't in scope, you can specify a component usin\", \"g its full type name, as you can in C#:\\n\\n&lt;MyComponentLib.Counter /&gt;\\n\\n## Modify page title from\", \" components\\n\\nWhen building SPAstyle apps, it's common for parts of a page to reload without reloadin\", \"g the entire page. Even so, it can be useful to have the title of the page change based on which com\", \"ponent is currently loaded. This can be accomplished by including the &lt;PageTitle&gt; tag in the c\", \"omponent's Razor page:\\n\\n```\\n@page \\\"/\\\"\\n```\\n\\n&lt;PageTitle&gt;Home&lt;/PageTitle&gt;\\n\\nThe contents of \", \"this element can be dynamic, for instance showing the current count of messages:\\n\\n&lt;PageTitle&gt;@\", \"MessageCount messages&lt;/PageTitle&gt;\\n\\nNote that if several components on a particular page includ\", \"e &lt;PageTitle&gt; tags, only the last one will be displayed (since each one will overwrite the pre\", \"vious one).\\n\\n## Component parameters\\n\\nIn ASP.NET Web Forms, you can flow parameters and data to cont\", \"rols using public properties. These properties can be set in markup using attributes or set directly\", \" in code. Razor components work in a similar fashion, although the component properties must also be\", \" marked with the [Parameter] attribute to be considered component parameters.\\n\\nThe following Counter\", \" component defines a component parameter called IncrementAmount that can be used to specify the amou\", \"nt that the Counter should be incremented each time the button is clicked.\\n\\n```\\n<h1>Counter</h1> <p>\", \"Current count: @currentCount</p> <button class=\\\"btn btn-primary\\\" @onclick=\\\"IncrementCount\\\">Click me<\", \"/button> @code { int currentCount = 0; [Parameter] public int IncrementAmount { get; set; } = 1; voi\", \"d IncrementCount() { currentCount+=IncrementAmount; } }\\n```\\n\\nTo specify a component parameter in Bla\", \"zor, use an attribute as you would in ASP.NET Web Forms:\\n\\n```\\n<Counter IncrementAmount=\\\"10\\\" />\\n```\\n\\n\", \"## Query string parameters\\n\\nRazor components can also leverage values from the query string of the p\", \"age they're rendered on as a parameter source. To enable this, add the [SupplyParameterFromQuery] at\", \"tribute to the parameter. For example, the following parameter definition would get its value from t\", \"he request in the form ?IncBy=2:\\n\\n```\\n[Parameter] [SupplyParameterFromQuery(Name = \\\"IncBy\\\")] public \", \"int IncrementAmount { get ; set ; } = 1;\\n```\\n\\nIf you don't supply a custom Name in the [SupplyParame\", \"terFromQuery] attribute, by default it will match the property name (IncrementAmount in this case).\\n\", \"\\n## Components and error boundaries\\n\\nBy default, Blazor apps will detect unhandled exceptions and sh\", \"ow an error message at the bottom of the page with no additional detail. To constrain the parts of t\", \"he app that are impacted by an unhandled error, for instance to limit the impact to a single compone\", \"nt, the &lt;ErrorBoundary&gt; tag can be wrapped around component declarations.\\n\\nFor example, to pro\", \"tect against possible exceptions thrown from the Counter component, declare it within an &lt;ErrorBo\", \"undary&gt; and optionally specify a message to display if there is an exception:\\n\\n```\\n<ErrorBoundary\", \"> <ChildContent> <Counter /> </ChildContent> <ErrorContent> Oops! The counter isn't working right no\", \"w; please try again later. </ErrorContent> </ErrorBoundary> If you don't need to specify custom erro\", \"r content, you can just wrap the component directly: <ErrorBoundary> <Counter /> </ErrorBoundary>\\n``\", \"`\\n\\nA default message stating 'An error as occurred.' will be displayed if an unhandled exception occ\", \"urs in the wrapped component.\\n\\n## Event handlers\\n\\nBoth ASP.NET Web Forms and Blazor provide an event\", \"-based programming model for handling UI events. Examples of such events include button clicks and t\", \"ext input. In ASP.NET Web Forms, you use HTML server controls to handle UI events exposed by the DOM\", \", or you can handle events exposed by web server controls. The events are surfaced on the server thr\", \"ough form post-back requests. Consider the following Web Forms button click example:\\n\\nCounter.ascx\\n\\n\", \"```\\n<asp:Button ID=\\\"ClickMeButton\\\" runat=\\\"server\\\" Text=\\\"Click me!\\\" OnClick=\\\"ClickMeButton_Click\\\" /> \", \"Counter.ascx.cs public partial class Counter : System.Web.UI.UserControl { protected void ClickMeBut\", \"ton_Click(object sender, EventArgs e) { Console.WriteLine(\\\"The button was clicked!\\\"); } }\\n```\\n\\nIn Bl\", \"azor, you can register handlers for DOM UI events directly using directive attributes of the form @o\", \"n{event}. The {event} placeholder represents the name of the event. For example, you can listen for \", \"button clicks like this:\\n\\n```\\n<button @onclick=\\\"OnClick\\\">Click me!</button> @code { void OnClick() {\", \" Console.WriteLine(\\\"The button was clicked!\\\"); } }\\n```\\n\\nEvent handlers can accept an optional, event\", \"-specific argument to provide more information about the event. For example, mouse events can take a\", \" MouseEventArgs argument, but it isn't required.\\n\\n```\\n<button @onclick=\\\"OnClick\\\">Click me!</button> \", \"@code { void OnClick(MouseEventArgs e) { Console.WriteLine($\\\"Mouse clicked at {e.ScreenX}, {e.Screen\", \"Y}.\\\"); } }\\n```\\n\\nInstead of referring to a method group for an event handler, you can use a lambda ex\", \"pression. A lambda expression allows you to close over other in-scope values.\\n\\n```\\n@foreach (var but\", \"tonLabel in buttonLabels) { <button @onclick=\\\"() => Console.WriteLine($\\\"The {buttonLabel} button was\", \" clicked!\\\")\\\">@buttonLabel</button> }\\n```\\n\\nEvent handlers can execute synchronously or asynchronously\", \". For example, the following OnClick event handler executes asynchronously:\\n\\n```\\n<button @onclick=\\\"O\", \"nClick\\\">Click me!</button> @code { async Task OnClick() { var result = await Http.GetAsync(\\\"api/valu\", \"es\\\"); } }\\n```\\n\\nAfter an event is handled, the component is rendered to account for any component sta\", \"te changes. With asynchronous event handlers, the component is rendered immediately after the handle\", \"r execution completes. The component is rendered again after the asynchronous Task completes. This a\", \"synchronous execution mode provides an opportunity to render some appropriate UI while the asynchron\", \"ous Task is still in progress.\\n\\n```\\n<button @onclick=\\\"ShowMessage\\\">Get message</button> @if (showMes\", \"sage) { @if (message == null) { <p><em>Loading...</em></p> } else\\n```\\n\\n```\\n{ <p>The message is: @mes\", \"sage</p> } } @code { bool showMessage = false; string message; public async Task ShowMessage() { sho\", \"wMessage = true; message = await MessageService.GetMessageAsync(); } }\\n```\\n\\nComponents can also defi\", \"ne their own events by defining a component parameter of type EventCallback&lt;TValue&gt;. Event cal\", \"lbacks support all the variations of DOM UI event handlers: optional arguments, synchronous or async\", \"hronous, method groups, or lambda expressions.\\n\\n```\\n<button class=\\\"btn btn-primary\\\" @onclick=\\\"OnClic\", \"k\\\">Click me!</button> @code { [Parameter] public EventCallback<MouseEventArgs> OnClick { get; set; }\", \" }\\n```\\n\\n## Data binding\\n\\nBlazor provides a simple mechanism to bind data from a UI component to the \", \"component's state. This approach differs from the features in ASP.NET Web Forms for binding data fro\", \"m data sources to UI controls. We'll cover handling data from different data sources in the Dealing \", \"with data section.\\n\\nTo create a twoway data binding from a UI component to the component's state, us\", \"e the @bind directive attribute. In the following example, the value of the check box is bound to th\", \"e isChecked field.\\n\\n```\\n<input type=\\\"checkbox\\\" @bind=\\\"isChecked\\\" /> @code { bool isChecked; }\\n```\\n\\nW\", \"hen the component is rendered, the value of the checkbox is set to the value of the isChecked field.\", \" When the user toggles the checkbox, the onchange event is fired and the isChecked field is set to t\", \"he new value. The @bind syntax in this case is equivalent to the following markup:\\n\\n```\\n<input value\", \"=\\\"@isChecked\\\" @onchange=\\\"(UIChangeEventArgs e) => isChecked = e.Value\\\" />\\n```\\n\\nTo change the event u\", \"sed for the bind, use the @bind:event attribute.\\n\\n```\\n<input @bind=\\\"text\\\" @bind:event=\\\"oninput\\\" /> <\", \"p>@text</p>\\n```\\n\\n```\\n@code { string text; }\\n```\\n\\nComponents can also support data binding to their p\", \"arameters. To data bind, define an event callback parameter with the same name as the bindable param\", \"eter. The 'Changed' suffix is added to the name.\\n\\nPasswordBox.razor\\n\\n```\\nPassword: <input value=\\\"@Pa\", \"ssword\\\" @oninput=\\\"OnPasswordChanged\\\" type=\\\"@(showPassword ? \\\"text\\\" : \\\"password\\\")\\\" /> <label><input t\", \"ype=\\\"checkbox\\\" @bind=\\\"showPassword\\\" />Show password</label> @code { private bool showPassword; [Para\", \"meter] public string Password { get; set; } [Parameter] public EventCallback<string> PasswordChanged\", \" { get; set; } private Task OnPasswordChanged(ChangeEventArgs e) { Password = e.Value.ToString(); re\", \"turn PasswordChanged.InvokeAsync(Password); } }\\n```\\n\\nTo chain a data binding to an underlying UI ele\", \"ment, set the value and handle the event directly on the UI element instead of using the @bind attri\", \"bute.\\n\\nTo bind to a component parameter, use a @bind-{Parameter} attribute to specify the parameter \", \"to which you want to bind.\\n\\n```\\n<PasswordBox @bind-Password=\\\"password\\\" /> @code { string password; }\", \"\\n```\\n\\n## State changes\\n\\nIf the component's state has changed outside of a normal UI event or event c\", \"allback, then the component must manually signal that it needs to be rendered again. To signal that \", \"a component's state has changed, call the StateHasChanged method on the component.\\n\\nIn the example b\", \"elow, a component displays a message from an AppState service that can be updated by other parts of \", \"the app. The component registers its StateHasChanged method with the AppState.OnChange event so that\", \" the component is rendered whenever the message gets updated.\\n\\n```\\npublic class AppState { public st\", \"ring Message { get ; } // Lets components receive change notifications public event Action OnChange;\", \" public void UpdateMessage(string message) { Message = message; NotifyStateChanged(); } private void\", \" NotifyStateChanged() => OnChange?.Invoke(); } @inject AppState AppState <p>App message: @AppState.M\", \"essage</p> @code { protected override void OnInitialized() { AppState.OnChange += StateHasChanged } \", \"}\\n```\\n\\n## Component lifecycle\\n\\nThe ASP.NET Web Forms framework has well-defined lifecycle methods fo\", \"r modules, pages, and controls. For example, the following control implements event handlers for the\", \" Init, Load, and UnLoad lifecycle events:\\n\\nCounter.ascx.cs\\n\\n```\\npublic partial class Counter : Syste\", \"m.Web.UI.UserControl { protected void Page_Init(object sender, EventArgs e) { ... } protected void P\", \"age_Load(object sender, EventArgs e) { ... } protected void Page_UnLoad(object sender, EventArgs e) \", \"{ ... } }\\n```\\n\\nRazor components also have a well-defined lifecycle. A component's lifecycle can be u\", \"sed to initialize component state and implement advanced component behaviors.\\n\\nAll of Blazor's compo\", \"nent lifecycle methods have both synchronous and asynchronous versions. Component rendering is synch\", \"ronous. You can't run asynchronous logic as part of the component rendering. All asynchronous logic \", \"must execute as part of an async lifecycle method.\\n\\n## OnInitialized\\n\\nThe OnInitialized and OnInitia\", \"lizedAsync methods are used to initialize the component. A component is typically initialized after \", \"it's first rendered. After a component is initialized, it may be rendered\\n\\nmultiple times before it'\", \"s eventually disposed. The OnInitialized method is similar to the Page\\\\_Load event in ASP.NET Web Fo\", \"rms pages and controls.\\n\\n```\\nprotected override void OnInitialized() { ... } protected override asyn\", \"c Task OnInitializedAsync() { await ... }\\n```\\n\\n## OnParametersSet\\n\\nThe OnParametersSet and OnParamet\", \"ersSetAsync methods are called when a component has received parameters from its parent and the valu\", \"e are assigned to properties. These methods are executed after component initialization and each tim\", \"e the component is rendered .\\n\\n```\\nprotected override void OnParametersSet() { ... } protected overr\", \"ide async Task OnParametersSetAsync() { await ... }\\n```\\n\\n## OnAfterRender\\n\\nThe OnAfterRender and OnA\", \"fterRenderAsync methods are called after a component has finished rendering. Element and component r\", \"eferences are populated at this point (more on these concepts below). Interactivity with the browser\", \" is enabled at this point. Interactions with the DOM and JavaScript execution can safely take place.\", \"\\n\\n```\\nprotected override void OnAfterRender(bool firstRender) { if (firstRender) { ... } } protected\", \" override async Task OnAfterRenderAsync(bool firstRender) { if (firstRender) { await ... } }\\n```\\n\\nOn\", \"AfterRender and OnAfterRenderAsync aren't called when prerendering on the server .\\n\\nThe firstRender \", \"parameter is true the first time the component is rendered; otherwise, its value is false.\\n\\n## IDisp\", \"osable\\n\\nRazor components can implement IDisposable to dispose of resources when the component is rem\", \"oved from the UI. A Razor component can implement IDispose by using the @implements directive:\\n\\n```\\n\", \"@using System @implements IDisposable ... @code { public void Dispose()\\n```\\n\\n```\\n{ ... } }\\n```\\n\\n## C\", \"apture component references\\n\\nIn ASP.NET Web Forms, it's common to manipulate a control instance dire\", \"ctly in code by referring to its ID. In Blazor, it's also possible to capture and manipulate a refer\", \"ence to a component, although it's much less common.\\n\\nTo capture a component reference in Blazor, us\", \"e the @ref directive attribute. The value of the attribute should match the name of a settable field\", \" with the same type as the referenced component.\\n\\n```\\n<MyLoginDialog @ref=\\\"loginDialog\\\" ... /> @code\", \" { MyLoginDialog loginDialog = default!; void OnSomething() { loginDialog.Show(); } }\\n```\\n\\nWhen the \", \"parent component is rendered, the field is populated with the child component instance. You can then\", \" call methods on, or otherwise manipulate, the component instance.\\n\\nManipulating component state dir\", \"ectly using component references isn't recommended. Doing so prevents the component from being rende\", \"red automatically at the correct times.\\n\\n## Capture element references\\n\\nRazor components can capture\", \" references to an element. Unlike HTML server controls in ASP.NET Web Forms, you can't manipulate th\", \"e DOM directly using an element reference in Blazor. Blazor handles most DOM interactions for you us\", \"ing its DOM diffing algorithm. Captured element references in Blazor are opaque. However, they're us\", \"ed to pass a specific element reference in a JavaScript interop call. For more information about Jav\", \"aScript interop, see ASP.NET Core Blazor JavaScript interop.\\n\\n## Templated components\\n\\nIn ASP.NET We\", \"b Forms, you can create templated controls . Templated controls enable the developer to specify a po\", \"rtion of the HTML used to render a container control. The mechanics of building templated server con\", \"trols are complex, but they enable powerful scenarios for rendering data in a user customizable way.\", \" Examples of templated controls include Repeater and DataList.\\n\\nRazor components can also be templat\", \"ed by defining component parameters of type RenderFragment or RenderFragment&lt;T&gt;. A RenderFragm\", \"ent represents a chunk of Razor markup\\n\\nthat can then be rendered by the component. A RenderFragment\", \"&lt;T&gt; is a chunk of Razor markup that takes a parameter that can be specified when the render fr\", \"agment is rendered.\\n\\n## Child content\\n\\nRazor components can capture their child content as a RenderF\", \"ragment and render that content as part of the component rendering. To capture child content, define\", \" a component parameter of type RenderFragment and name it ChildContent.\\n\\nChildContentComponent.razor\", \"\\n\\n```\\n<h1>Component with child content</h1> <div>@ChildContent</div> @code { [Parameter] public Rend\", \"erFragment ChildContent { get; set; } } A parent component can then supply child content using norma\", \"l Razor syntax. <ChildContentComponent> <ChildContent> <p>The time is @DateTime.Now</p> </ChildConte\", \"nt> </ChildContentComponent>\\n```\\n\\n## Template parameters\\n\\nA templated Razor component can also defin\", \"e multiple component parameters of type RenderFragment or RenderFragment&lt;T&gt;. The parameter for\", \" a RenderFragment&lt;T&gt; can be specified when it's invoked. To specify a generic type parameter f\", \"or a component, use the @typeparam Razor directive.\\n\\nSimpleListView.razor\\n\\n```\\n@typeparam TItem @Hea\", \"ding <ul> @foreach (var item in Items) { <li>@ItemTemplate(item)</li> } </ul> @code { [Parameter] pu\", \"blic RenderFragment Heading { get; set; } [Parameter] public RenderFragment<TItem> ItemTemplate { ge\", \"t; set; } [Parameter] public IEnumerable<TItem> Items { get; set; } }\\n```\\n\\nWhen using a templated co\", \"mponent, the template parameters can be specified using child elements that match the names of the p\", \"arameters. Component arguments of type RenderFragment&lt;T&gt; passed as elements have an implicit p\", \"arameter named context. You can change the name of this implement parameter using the Context attrib\", \"ute on the child element. Any generic type parameters can be specified using an attribute that match\", \"es the name of the type parameter. The type parameter will be inferred if possible:\\n\\n```\\n<SimpleList\", \"View Items=\\\"messages\\\" TItem=\\\"string\\\"> <Heading> <h1>My list</h1> </Heading> <ItemTemplate Context=\\\"m\", \"essage\\\"> <p>The message is: @message</p> </ItemTemplate> </SimpleListView> The output of this compon\", \"ent looks like this: < h1 >My list</ h1 > < ul > < li >< p >The message is: message1</ p ></ li > < \", \"li >< p >The message is: message2</ p ></ li > < ul >\\n```\\n\\n## Code-behind\\n\\nA Razor component is typi\", \"cally authored in a single .razor file. However, it's also possible to separate the code and markup \", \"using a code-behind file. To use a component file, add a C# file that matches the file name of the c\", \"omponent file but with a .cs extension added ( Counter.razor.cs ). Use the C# file to define a base \", \"class for the component. You can name the base class anything you'd like, but it's common to name th\", \"e class the same as the component class, but with a Base extension added (CounterBase). The componen\", \"t-based class must also derive from ComponentBase. Then, in the Razor component file, add the @inher\", \"its directive to specify the base class for the component (@inherits CounterBase).\\n\\nCounter.razor\\n\\n`\", \"``\\n@inherits CounterBase <h1>Counter</h1> <p>Current count: @currentCount</p> <button @onclick=\\\"Incr\", \"ementCount\\\">Click me</button> Counter.razor.cs public class CounterBase : ComponentBase { protected \", \"int currentCount = 0; protected void IncrementCount() { currentCount++; } }\\n```\\n\\nThe visibility of t\", \"he component's members in the base class must be protected or public to be visible to the component \", \"class.\\n\\n## Additional resources\\n\\nThe preceding isn't an exhaustive treatment of all aspects of Razor\", \" components. For more information on how to Create and use ASP.NET Core Razor components, see the Bl\", \"azor documentation.\\n\\n## Pages, routing, and layouts\\n\\nASP.NET Web Forms apps are composed of pages de\", \"fined in .aspx files. Each page's address is based on its physical file path in the project. When a \", \"browser makes a request to the page, the contents of the page are dynamically rendered on the server\", \". The rendering accounts for both the page's HTML markup and its server controls.\\n\\nIn Blazor, each p\", \"age in the app is a component, typically defined in a .razor file, with one or more specified routes\", \". Routing mostly happens client-side without involving a specific server request. The browser first \", \"makes a request to the root address of the app. A root Router component in the Blazor app then handl\", \"es intercepting navigation requests and forwards them to the correct component.\\n\\nBlazor also support\", \"s deep linking . Deep linking occurs when the browser makes a request to a specific route other than\", \" the root of the app. Requests for deep links sent to the server are routed to the Blazor app, which\", \" then routes the request client-side to the correct component.\\n\\nA simple page in ASP.NET Web Forms m\", \"ight contain the following markup:\\n\\nName.aspx\\n\\n```\\n<%@ Page Title=\\\"Name\\\" Language=\\\"C#\\\" MasterPageFil\", \"e=\\\"~/Site.Master\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Name.aspx.cs\\\" Inherits=\\\"WebApplication1.Name\\\" %\", \"> <asp:Content ID=\\\"BodyContent\\\" ContentPlaceHolderID=\\\"MainContent\\\" runat=\\\"server\\\"> <div> What is you\", \"r name?<br /> <asp:TextBox ID=\\\"TextBox1\\\" runat=\\\"server\\\"></asp:TextBox> <asp:Button ID=\\\"Button1\\\" runa\", \"t=\\\"server\\\" Text=\\\"Submit\\\" OnClick=\\\"Button1_Click\\\" /> </div> <div> <asp:Literal ID=\\\"Literal1\\\" runat=\\\"s\", \"erver\\\" /> </div> </asp:Content>\\n```\\n\\nName.aspx.cs\\n\\n```\\npublic partial class Name : System.Web.UI.Pag\", \"e { protected void Button1_Click1(object sender, EventArgs e) { Literal1.Text = \\\"Hello \\\" + TextBox1.\", \"Text; } }\\n```\\n\\nThe equivalent page in a Blazor app would look like this:\\n\\nName.razor\\n\\n```\\n@page \\\"/Na\", \"me\\\" @layout MainLayout <div> What is your name?<br /> <input @bind=\\\"text\\\" /> <button @onclick=\\\"OnCli\", \"ck\\\">Submit</button> </div> <div> @if (name != null) { @:Hello @name } </div> @code { string text; st\", \"ring name; void OnClick() { name = text; } }\\n```\\n\\n## Create pages\\n\\nTo create a page in Blazor, creat\", \"e a component and add the @page Razor directive to specify the route for the component. The @page di\", \"rective takes a single parameter, which is the route template to add to that component.\\n\\n@page \\\"/cou\", \"nter\\\"\\n\\nThe route template parameter is required. Unlike ASP.NET Web Forms, the route to a Blazor com\", \"ponent isn't inferred from its file location (although that may be a feature added in the future).\\n\\n\", \"The route template syntax is the same basic syntax used for routing in ASP.NET Web Forms. Route para\", \"meters are specified in the template using braces. Blazor will bind route values to component parame\", \"ters with the same name (case-insensitive).\\n\\n```\\n@page \\\"/product/{id}\\\" <h1>Product @Id</h1> @code { \", \"[Parameter] public string Id { get; set; } }\\n```\\n\\nYou can also specify constraints on the value of t\", \"he route parameter. For example, to constrain the product ID to be an int:\\n\\n```\\n@page \\\"/product/{id:\", \"int}\\\" <h1>Product @Id</h1> @code { [Parameter] public int Id { get; set; } }\\n```\\n\\nFor a full list of\", \" the route constraints supported by Blazor, see Route constraints.\\n\\n## Router component\\n\\nRouting in \", \"Blazor is handled by the Router component. The Router component is typically used in the app's root \", \"component ( App.razor ).\\n\\n```\\n<Router AppAssembly=\\\"@typeof(Program).Assembly\\\"> <Found Context=\\\"route\", \"Data\\\"> <RouteView RouteData=\\\"@routeData\\\" DefaultLayout=\\\"@typeof(MainLayout)\\\" /> </Found> <NotFound> \", \"<LayoutView Layout=\\\"@typeof(MainLayout)\\\"> <p>Sorry, there's nothing at this address.</p> </LayoutVie\", \"w> </NotFound> </Router>\\n```\\n\\nThe Router component discovers the routable components in the specifie\", \"d AppAssembly and in the optionally specified AdditionalAssemblies. When the browser navigates, the \", \"Router intercepts the navigation and renders the contents of its Found parameter with the extracted \", \"RouteData if a route matches the address, otherwise the Router renders its NotFound parameter.\\n\\nThe \", \"RouteView component handles rendering the matched component specified by the RouteData with its layo\", \"ut if it has one. If the matched component doesn't have a layout, then the optionally specified Defa\", \"ultLayout is used.\\n\\nThe LayoutView component renders its child content within the specified layout. \", \"We'll look at layouts more in detail later in this chapter.\\n\\n## Navigation\\n\\nIn ASP.NET Web Forms, yo\", \"u trigger navigation to a different page by returning a redirect response to the browser. For exampl\", \"e:\\n\\n```\\nprotected void NavigateButton_Click(object sender, EventArgs e) { Response.Redirect(\\\"Counter\", \"\\\"); }\\n```\\n\\nReturning a redirect response isn't typically possible in Blazor. Blazor doesn't use a re\", \"quest -reply model. You can, however, trigger browser navigations directly, as you can with JavaScri\", \"pt.\\n\\nBlazor provides a NavigationManager service that can be used to:\\n\\n- Get the current browser add\", \"ress\\n- Get the base address\\n- Trigger navigations\\n- Get notified when the address changes\\n\\nTo naviga\", \"te to a different address, use the NavigateTo method:\\n\\n```\\n@page \\\"/\\\" @inject NavigationManager Navig\", \"ationManager <button @onclick=\\\"Navigate\\\">Navigate</button> @code { void Navigate() { NavigationManag\", \"er.NavigateTo(\\\"counter\\\"); } }\\n```\\n\\nFor a description of all NavigationManager members, see URI and n\", \"avigation state helpers.\\n\\n## Base URLs\\n\\nIf your Blazor app is deployed under a base path, then you n\", \"eed to specify the base URL in the page metadata using the &lt;base&gt; tag for routing to work prop\", \"erty. If the host page for the app is serverrendered using Razor, then you can use the ~/ syntax to \", \"specify the app's base address. If the host page is static HTML, then you need to specify the base U\", \"RL explicitly.\\n\\n&lt; base href =\\\"~/\\\" /&gt;\\n\\n## Page layout\\n\\nPage layout in ASP.NET Web Forms is hand\", \"led by Master Pages. Master Pages define a template with one or more content placeholders that can t\", \"hen be supplied by individual pages. Master Pages are defined in .master files and start with the &l\", \"t;%@ Master %&gt; directive. The content of the .master files is coded as you would an .aspx page, b\", \"ut with the addition of &lt;asp:ContentPlaceHolder&gt; controls to mark where pages can supply conte\", \"nt.\\n\\nSite.master\\n\\n```\\n<%@ Master Language=\\\"C#\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Site.master.cs\\\" In\", \"herits=\\\"WebApplication1.SiteMaster\\\" %> <!DOCTYPE html> <html lang=\\\"en\\\"> <head runat=\\\"server\\\"> <meta \", \"charset=\\\"utf-8\\\" /> <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" /> <title><\", \"%: Page.Title %> - My ASP.NET Application</title> <link href=\\\"~/favicon.ico\\\" rel=\\\"shortcut icon\\\" typ\", \"e=\\\"image/x-icon\\\" /> </head>\\n```\\n\\n```\\n<body> <form runat=\\\"server\\\"> <div class=\\\"container body-content\", \"\\\"> <asp:ContentPlaceHolder ID=\\\"MainContent\\\" runat=\\\"server\\\"> </asp:ContentPlaceHolder> <hr /> <footer\", \"> <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application</p> </footer> </div> </form> </body> <\", \"/html>\\n```\\n\\nIn Blazor, you handle page layout using layout components. Layout components inherit fro\", \"m LayoutComponentBase, which defines a single Body property of type RenderFragment, which can be use\", \"d to render the contents of the page.\\n\\nMainLayout.razor\\n\\n```\\n@inherits LayoutComponentBase <h1>Main \", \"layout</h1> <div> @Body </div>\\n```\\n\\nWhen the page with a layout is rendered, the page is rendered wi\", \"thin the contents of the specified layout at the location where the layout renders its Body property\", \".\\n\\nTo apply a layout to a page, use the @layout directive:\\n\\n```\\n@layout MainLayout\\n```\\n\\nYou can spec\", \"ify the layout for all components in a folder and subfolders using an *\\\\_Imports.razor* file. You ca\", \"n also specify a default layout for all your pages using the Router component.\\n\\nMaster Pages can def\", \"ine multiple content placeholders, but layouts in Blazor only have a single Body property. This limi\", \"tation of Blazor layout components will hopefully be addressed in a future release.\\n\\nMaster Pages in\", \" ASP.NET Web Forms can be nested. That is, a Master Page may also use a Master Page. Layout componen\", \"ts in Blazor may be nested too. You can apply a layout component to a layout component. The contents\", \" of the inner layout will be rendered within the outer layout.\\n\\nChildLayout.razor\\n\\n```\\n@layout MainL\", \"ayout <h2>Child layout</h2> <div> @Body </div>\\n```\\n\\nIndex.razor\\n\\n```\\n@page \\\"/\\\" @layout ChildLayout <\", \"p>I'm in a nested layout!</p>\\n```\\n\\nThe rendered output for the page would then be:\\n\\n```\\n< h1 >Main l\", \"ayout</ h1 > < div > < h2 >Child layout</ h2 > < div > < p >I'm in a nested layout!</ p > </ div > <\", \"/ div >\\n```\\n\\nLayouts in Blazor don't typically define the root HTML elements for a page (&lt;html&gt\", \";, &lt;body&gt;, &lt;head&gt;, and so on). The root HTML elements are instead defined in a Blazor ap\", \"p's host page, which is used to render the initial HTML content for the app (see Bootstrap Blazor). \", \"The host page can render multiple root components for the app with surrounding markup.\\n\\nComponents i\", \"n Blazor, including pages, can't render &lt;script&gt; tags. This rendering restriction exists becau\", \"se &lt;script&gt; tags get loaded once and then can't be changed. Unexpected behavior may occur if y\", \"ou try to render the tags dynamically using Razor syntax. Instead, all &lt;script&gt; tags should be\", \" added to the app's host page.\\n\\n## State management\\n\\nState management is a key concept of Web Forms \", \"applications, facilitated through ViewState, Session State, Application State, and Postback features\", \". These stateful features of the framework helped to hide the state management required for an appli\", \"cation and allow application developers to focus on delivering their functionality. With ASP.NET Cor\", \"e and Blazor, some of these features have been relocated and some have been removed altogether. This\", \" chapter reviews how to maintain state and deliver the same functionality with the new features in B\", \"lazor.\\n\\n## Request state management with ViewState\\n\\nWhen discussing state management in Web Forms ap\", \"plication, many developers will immediately think of ViewState. In Web Forms, ViewState manages the \", \"state of the content between HTTP requests by sending a large encoded block of text back and forth t\", \"o the browser. The ViewState field could be overwhelmed with content from a page containing many ele\", \"ments, potentially expanding to several megabytes in size.\\n\\nWith Blazor Server, the app maintains an\", \" ongoing connection with the server. The app's state, called a circuit , is held in server memory wh\", \"ile the connection is considered active. State will only be disposed when the user navigates away fr\", \"om the app or a particular page in the app. All members of the active components are available betwe\", \"en interactions with the server.\\n\\nThere are several advantages of this feature:\\n\\n- Component state i\", \"s readily available and not rebuilt between interactions.\\n- State isn't transmitted to the browser.\\n\", \"\\nHowever, there are some disadvantages to in-memory component state persistence to be aware of:\\n\\n- I\", \"f the server restarts between request, state is lost.\\n- Your application web server load-balancing s\", \"olution must include sticky sessions to ensure that all requests from the same browser return to the\", \" same server. If a request goes to a different server, state will be lost.\\n- Persistence of componen\", \"t state on the server can lead to memory pressure on the web server.\\n\\nFor the preceding reasons, don\", \"'t rely on just the state of the component to reside in -memory on the server. Your application shou\", \"ld also include some backing data store for data between requests. Some simple examples of this stra\", \"tegy:\\n\\n- In a shopping cart application, persist the content of new items added to the cart in a dat\", \"abase record. If the state on the server is lost, you can reconstitute it from the database records.\", \"\\n\\n- In a multi-part web form, your users will expect your application to remember values between eac\", \"h request. Write the data between each of your user's posts to a data store so that they can be fetc\", \"hed and assembled into the final form response structure when the multi-part form is completed.\\n\\nFor\", \" additional details on managing state in Blazor apps, see ASP.NET Core Blazor state management.\\n\\n## \", \"Maintain state with Session\\n\\nWeb Forms developers could maintain information about the currently act\", \"ing user with the Microsoft.AspNetCore.Http.ISession dictionary object. It's easy enough to add an o\", \"bject with a string key to the Session, and that object would be available at a later time during th\", \"e user's interactions with the application. In an attempt to eliminate managing interacting with HTT\", \"P, the Session object made it easy to maintain state.\\n\\nThe signature of the .NET Framework Session o\", \"bject isn't the same as the ASP.NET Core Session object. Consider the documentation for the new ASP.\", \"NET Core Session before deciding to migrate and use the new session state feature.\\n\\nSession is avail\", \"able in ASP.NET Core and Blazor Server, but is discouraged from use in favor of storing data in a da\", \"ta repository appropriately. Session state is also not functional if visitors decline the use HTTP c\", \"ookies in your application due to privacy concerns.\\n\\nConfiguration for ASP.NET Core and Session stat\", \"e is available in the Session and state management in ASP.NET Core article.\\n\\n## Application state\\n\\nT\", \"he Application object in the Web Forms framework provides a massive, cross-request repository for in\", \"teracting with application-scope configuration and state. Application state was an ideal place to st\", \"ore various application configuration properties that would be referenced by all requests, regardles\", \"s of the user making the request. The problem with the Application object was that data didn't persi\", \"st across multiple servers. The state of the application object was lost between restarts.\\n\\nAs with \", \"Session, it's recommended that data move to a persistent backing store that could be accessed by mul\", \"tiple server instances. If there is volatile data that you would like to be able to access across re\", \"quests and users, you could easily store it in a singleton service that can be injected into compone\", \"nts that require this information or interaction.\\n\\nThe construction of an object to maintain applica\", \"tion state and its consumption could resemble the following implementation:\\n\\n```\\npublic class MyAppl\", \"icationState { public int VisitorCounter { get ; private set ; } = 0; public void IncrementCounter()\", \" => VisitorCounter += 1; }\\n```\\n\\n```\\napp.AddSingleton<MyApplicationState>(); @inject MyApplicationSta\", \"te AppState <label>Total Visitors: @AppState.VisitorCounter</label>\\n```\\n\\nThe MyApplicationState obje\", \"ct is created only once on the server, and the value VisitorCounter is fetched and output in the com\", \"ponent's label. The VisitorCounter value should be persisted and retrieved from a backing data store\", \" for durability and scalability.\\n\\n## In the browser\\n\\nApplication data can also be stored clientside \", \"on the user's device so that is available later. There are two browser features that allow for persi\", \"stence of data in different scopes of the user's browser:\\n\\n- localStorage scoped to the user's entir\", \"e browser. If the page is reloaded, the browser is closed and reopened, or another tab is opened wit\", \"h the same URL then the same localStorage is provided by the browser\\n- sessionStorage scoped to the \", \"user's current browser tab. If the tab is reloaded, the state persists. However, if the user opens a\", \"nother tab to your application or closes and reopens the browser the state is lost.\\n\\nYou can write s\", \"ome custom JavaScript code to interact with these features, or there are a number of NuGet packages \", \"that you can use that provide this functionality. One such package is Microsoft.AspNetCore.Protected\", \"BrowserStorage.\\n\\nFor instructions on utilizing this package to interact with localStorage and sessio\", \"nStorage, see the Blazor State Management article.\\n\\n## Forms and validation\\n\\nThe ASP.NET Web Forms f\", \"ramework includes a set of validation server controls that handle validating user input entered into\", \" a form (RequiredFieldValidator, CompareValidator, RangeValidator, and so on). The ASP.NET Web Forms\", \" framework also supports model binding and validating the model based on data annotations ([Required\", \"], [StringLength], [Range], and so on). The validation logic can be enforced both on the server and \", \"on the client using unobtrusive JavaScript-based validation. The ValidationSummary server control is\", \" used to display a summary of the validation errors to the user.\\n\\nBlazor supports the sharing of val\", \"idation logic between both the client and the server. ASP.NET provides pre-built JavaScript implemen\", \"tations of many common server validations. In many cases, the developer still has to write JavaScrip\", \"t to fully implement their app-specific validation logic. The same model types, data annotations, an\", \"d validation logic can be used on both the server and client.\\n\\nBlazor provides a set of input compon\", \"ents. The input components handle binding field data to a model and validating the user input when t\", \"he form is submitted.\\n\\n| Input component   | Rendered HTML element   |\\n|-------------------|--------\", \"-----------------|\\n| InputCheckbox     | <input type=\\\"checkbox\\\"> |\\n| InputDate         | <input type\", \"=\\\"date\\\">     |\\n| InputNumber       | <input type=\\\"number\\\">   |\\n| InputSelect       | <select>       \", \"         |\\n| InputText         | <input>                 |\\n| InputTextArea     | <textarea>         \", \"     |\\n\\nThe EditForm component wraps these input components and orchestrates the validation process \", \"through an EditContext. When creating an EditForm, you specify what model instance to bind to using \", \"the Model parameter. Validation is typically done using data annotations, and it's extensible. To en\", \"able data annotation-based validation, add the DataAnnotationsValidator component as a child of the \", \"EditForm. The EditForm component provides a convenient event for handling valid (OnValidSubmit) and \", \"invalid (OnInvalidSubmit) submissions. There's also a more ge neric OnSubmit event that lets you tri\", \"gger and handle the validation yourself.\\n\\nTo display a validation error summary, use the ValidationS\", \"ummary component. To display validation messages for a specific input field, use the ValidationMessa\", \"ge component, specifying a lambda expression for the For parameter that points to the appropriate mo\", \"del member.\\n\\nThe following model type defines several validation rules using data annotations:\\n\\n```\\n\", \"using System; using System.ComponentModel.DataAnnotations; public class Starship { [Required] [Strin\", \"gLength(16, ErrorMessage = \\\"Identifier too long (16 character limit).\\\")] public string Identifier { \", \"get ; set ; } public string Description { get ; set ; } [Required] public string Classification { ge\", \"t ; set ; } [Range(1, 100000, ErrorMessage = \\\"Accommodation invalid (1-100000).\\\")] public int Maximu\", \"mAccommodation { get ; set ; } [Required] [Range( typeof (bool), \\\"true\\\", \\\"true\\\", ErrorMessage = \\\"Thi\", \"s form disallows unapproved ships.\\\")] public bool IsValidatedDesign { get ; set ; } [Required] publi\", \"c DateTime ProductionDate { get ; set ; } }\\n```\\n\\nThe following component demonstrates building a for\", \"m in Blazor based on the Starship model type:\\n\\n```\\n<h1>New Ship Entry Form</h1> <EditForm Model=\\\"@st\", \"arship\\\" OnValidSubmit=\\\"@HandleValidSubmit\\\"> <DataAnnotationsValidator /> <ValidationSummary /> <p> <\", \"label for=\\\"identifier\\\">Identifier: </label> <InputText id=\\\"identifier\\\" @bind-Value=\\\"starship.Identif\", \"ier\\\" /> <ValidationMessage For=\\\"() => starship.Identifier\\\" /> </p> <p> <label for=\\\"description\\\">Desc\", \"ription (optional): </label> <InputTextArea id=\\\"description\\\" @bind-Value=\\\"starship.Description\\\" /> <\", \"/p> <p> <label for=\\\"classification\\\">Primary Classification: </label> <InputSelect id=\\\"classification\", \"\\\" @bind-Value=\\\"starship.Classification\\\"> <option value=\\\"\\\">Select classification ...</option> <option\", \" value=\\\"Exploration\\\">Exploration</option> <option value=\\\"Diplomacy\\\">Diplomacy</option> <option value\", \"=\\\"Defense\\\">Defense</option> </InputSelect> <ValidationMessage For=\\\"() => starship.Classification\\\" />\", \" </p> <p> <label for=\\\"accommodation\\\">Maximum Accommodation: </label> <InputNumber id=\\\"accommodation\\\"\", \" @bind-Value=\\\"starship.MaximumAccommodation\\\" /> <ValidationMessage For=\\\"() => starship.MaximumAccomm\", \"odation\\\" /> </p>\\n```\\n\\n```\\n<p> <label for=\\\"valid\\\">Engineering Approval: </label> <InputCheckbox id=\\\"v\", \"alid\\\" @bind-Value=\\\"starship.IsValidatedDesign\\\" /> <ValidationMessage For=\\\"() => starship.IsValidated\", \"Design\\\" /> </p> <p> <label for=\\\"productionDate\\\">Production Date: </label> <InputDate id=\\\"productionD\", \"ate\\\" @bind-Value=\\\"starship.ProductionDate\\\" /> <ValidationMessage For=\\\"() => starship.ProductionDate\\\"\", \" /> </p> <button type=\\\"submit\\\">Submit</button> </EditForm> @code { private Starship starship = new S\", \"tarship(); private void HandleValidSubmit() { // Save the data } }\\n```\\n\\nAfter the form submission, t\", \"he modelbound data hasn't been saved to any data store, like a database. In a Blazor WebAssembly app\", \", the data must be sent to the server. For example, using an HTTP POST request. In a Blazor Server a\", \"pp, the data is already on the server, but it must be persisted. Handling data access in Blazor apps\", \" is the subject of the Dealing with data section.\\n\\n## Additional resources\\n\\nFor more information on \", \"forms and validation in Blazor apps, see the Blazor documentation.\\n\\nSqlDataSource - CustomersData\\n\\nC\", \"ustomerID CompanyName FirstNameLastName\\n\\nDatabound Databound\\n\\nDatabound Databound\\n\\nDatabound Databou\", \"nd\\n\\nClick Me! Databound\\n\\nDatabound Databound\\n\\nClick Me! Databound\\n\\n## Work with data\\n\\nDatabound Data\", \"bound\\n\\nDatabound Databound\\n\\nClick Me! Databound\\n\\nData access is the backbone of an ASP.NET Web Forms\", \" app. If you're building forms for the web, what happens to that data? With Web Forms, there were mu\", \"ltiple data access techniques you could use to interact with a database:\\n\\n- Data Sources\\n- ADO.NET\\n-\", \" Entity Framework\\n\\nData Sources were controls that you could place on a Web Forms page and configure\", \" like other controls. Visual Studio provided a friendly set of dialogs to configure and bind the con\", \"trols to your Web Forms pages. Developers who enjoy a 'low code' or 'no code' approach preferred thi\", \"s technique when Web Forms was first released.\\n\\n<!-- image -->\\n\\nADO.NET is the low-level approach to\", \" interacting with a database. Your apps could create a connection to the database with Commands, Dat\", \"atables, and Datasets for interacting. The results could then be bound to fields on screen without m\", \"uch code. The drawback of this approach was that each set of ADO.NET objects (Connection, Command, a\", \"nd DataTable) was bound to libraries provided by a database vendor. Use of these components made the\", \" code rigid and difficult to migrate to a different database.\\n\\n## Entity Framework\\n\\nEntity Framework\", \" (EF) is the open source object-relational mapping framework maintained by the .NET Foundation. Init\", \"ially released with .NET Framework, EF allows for generating code for the database connections, stor\", \"age schemas, and interactions. With this abstraction, you can focus on your\\n\\n<!-- image -->\\n\\napp's b\", \"usiness rules and allow the database to be managed by a trusted database administrator. In .NET, you\", \" can use an updated version of EF called EF Core. EF Core helps generate and maintain the interactio\", \"ns between your code and the database with a series of commands that are available for you using the\", \" dotnet ef commandline tool. Let's take a look at a few samples to get you working with a database.\\n\", \"\\n## EF Code First\\n\\nA quick way to get started building your database interactions is to start with t\", \"he class objects you want to work with. EF provides a tool to help generate the appropriate database\", \" code for your classes. This approach is called 'Code First' development. Consider the following Pro\", \"duct class for a sample storefront app that we want to store in a relational database like Microsoft\", \" SQL Server.\\n\\n```\\npublic class Product { public int Id { get ; set ; } [Required] public string Name\", \" { get ; set ; } [MaxLength(4000)] public string Description { get ; set ; } [Range(0, 99999,99)] [D\", \"ataType(DataType.Currency)] public decimal Price { get ; set ; } }\\n```\\n\\nProduct has a primary key an\", \"d three additional fields that would be created in our database:\\n\\n- EF will identify the Id property\", \" as a primary key by convention.\\n- Name will be stored in a column configured for text storage. The \", \"[Required] attribute decorating this property will add a not null constraint to help enforce this de\", \"clared behavior of the property.\\n- Description will be stored in a column configured for text storag\", \"e, and have a maximum length configured of 4000 characters as dictated by the [MaxLength] attribute.\", \" The database schema will be configured with a column named MaxLength using data type varchar(4000).\", \"\\n- The Price property will be stored as currency. The [Range] attribute will generate appropriate co\", \"nstraints to prevent data storage outside of the minimum and maximum values declared.\\n\\nWe need to ad\", \"d this Product class to a database context class that defines the connection and translation operati\", \"ons with our database.\\n\\n```\\npublic class MyDbContext : DbContext { public DbSet<Product> Products { \", \"get ; set ; } }\\n```\\n\\nThe MyDbContext class provides the one property that defines the access and tra\", \"nslation for the Product class. Your application configures this class for interaction with the data\", \"base using the following entries in the Startup class's ConfigureServices method (or appropriate loc\", \"ation in Program.cs using the builder.Services property instead of services):\\n\\n| services.AddDbConte\", \"xt<MyDbContext>(options => options.UseSqlServer(\\\"MY DATABASE CONNECTION STRING\\\"));   |\\n|------------\", \"---------------------------------------------------------------------------------------------|\\n\\nThe \", \"preceding code will connect to a SQL Server database with the specified connection string. You can p\", \"lace the connection string in your appsettings.json file, environment variables, or other configurat\", \"ion storage locations and replace this embedded string appropriately.\\n\\nYou can then generate the dat\", \"abase table appropriate for this class using the following commands:\\n\\n| dotnet ef migrations add 'Cr\", \"eate Product table'   |\\n|---------------------------------------------------|\\n\\nThe first command def\", \"ines the changes you're making to the database schema as a new EF Migration called Create Product ta\", \"ble. A Migration defines how to apply and remove your new database changes.\\n\\nOnce applied, you have \", \"a simple Product table in your database and some new classes added to the project that help manage t\", \"he database schema. You can find these generated classes, by default, in a new folder called Migrati\", \"ons . When you make changes to the Product class or add more related classes you would like interact\", \"ing with your database, you need to run the command-line commands again with a new name of the migra\", \"tion. This command will generate another set of migration classes to update your database schema.\\n\\n#\", \"# EF Database First\\n\\nFor existing databases, you can generate the classes for EF Core by using the .\", \"NET command-line tools. To scaffold the classes, use a variation of the following command:\\n\\n<!-- for\", \"mula-not-decoded -->\\n\\nThe preceding command connects to the database using the specified connection \", \"string and the Microsoft.EntityFrameworkCore.SqlServer provider. Once connected, a database context \", \"class named MyDbContext is created. Additionally, supporting classes are created for the Product and\", \" Customer tables that were specified with the -t options. There are many configuration options for t\", \"his command to generate the class hierarchy appropriate for your database. For a complete reference,\", \" see the command's documentation .\\n\\nMore information about EF Core can be found on the Microsoft Doc\", \"s site.\\n\\n## Interact with web services\\n\\nWhen ASP.NET was first released, SOAP services were the pref\", \"erred way for web servers and clients to exchange data. Much has changed since that time, and the pr\", \"eferred interactions with services have shifted to direct HTTP client interactions. With ASP.NET Cor\", \"e and Blazor, you can register the configuration of your HttpClient in Program.cs or in the Startup \", \"class's ConfigureServices method. Use that configuration when you need to interact with the HTTP end\", \"point. Consider the following configuration code:\\n\\n```\\n// in Program.cs builder.Services.AddHttpClie\", \"nt(\\\"github\\\", client => { client.BaseAddress = new Uri(\\\"http://api.github.com/\\\"); // Github API versi\", \"oning client.DefaultRequestHeaders.Add(\\\"Accept\\\", \\\"application/vnd.github.v3+json\\\"); // Github requir\", \"es a user-agent client.DefaultRequestHeaders.Add(\\\"User-Agent\\\", \\\"BlazorWebForms-Sample\\\"); });\\n```\\n\\nWh\", \"enever you need to access data from GitHub, create a client with a name of github. The client is con\", \"figured with the base address, and the request headers are set appropriately. Inject the IHttpClient\", \"Factory into your Blazor components with the @inject directive or an [Inject] attribute on a propert\", \"y. Create your named client and interact with services using the following syntax:\\n\\n```\\n@inject IHtt\", \"pClientFactory factory ... @code { protected override async Task OnInitializedAsync() { var client =\", \" factory.CreateClient(\\\"github\\\"); var response = await client.GetAsync(\\\"repos/dotnet/docs/issues\\\"); r\", \"esponse.EnsureStatusCode(); var content = await response.Content.ReadAsStringAsync(); } }\\n```\\n\\nThis \", \"method returns the string describing the collection of issues in the dotnet/docs GitHub repository. \", \"It returns content in JSON format and is deserialized into appropriate GitHub issue objects. There a\", \"re many ways that you can configure the HttpClientFactory to deliver preconfigured HttpClient object\", \"s. Try configuring multiple HttpClient instances with different names and endpoints for the various \", \"web services you work with. This approach will make your interactions with those services easier to \", \"work with on each page. For more information, see Make HTTP requests using IHttpClientFactory.\\n\\n## M\", \"odules, handlers, and middleware\\n\\nAn ASP.NET Core app is built upon a series of middleware . Middlew\", \"are is handlers that are arranged into a pipeline to handle requests and responses. In a Web Forms a\", \"pp, HTTP handlers and modules solve similar problems. In ASP.NET Core, modules, handlers, Global.asa\", \"x.cs , and the app life cycle are replaced with middleware. In this chapter, you'll learn about midd\", \"leware in the context of a Blazor app.\\n\\n## Overview\\n\\nThe ASP.NET Core request pipeline consists of a\", \" sequence of request delegates, called one after the other. The following diagram demonstrates the c\", \"oncept. The thread of execution follows the black arrows.\\n\\n11\\n\\nRequest\\n\\nResponse\\n\\nMiddleware 1\\n\\n// l\", \"ogic\\n\\n<!-- image -->\\n\\nThe preceding diagram lacks a concept of lifecycle events. This concept is fou\", \"ndational to how ASP.NET Web Forms requests are handled. This system makes it easier to reason about\", \" what process is occurring and allows middleware to be inserted at any point. Middleware executes in\", \" the order in which it's added to the request pipeline. They're also added in code instead of config\", \"uration files, usually in Startup.cs .\\n\\n## Katana\\n\\nReaders familiar with Katana will feel comfortabl\", \"e in ASP.NET Core. In fact, Katana is a framework from which ASP.NET Core derives. It introduced sim\", \"ilar middleware and pipeline patterns for ASP.NET 4.x. Middleware designed for Katana can be adapted\", \" to work with the ASP.NET Core pipeline.\\n\\n## Common middleware\\n\\nASP.NET 4.x includes many modules. I\", \"n a similar fashion, ASP.NET Core has many middleware components available as well. IIS modules may \", \"be used in some cases with ASP.NET Core. In other cases, native ASP.NET Core middleware may be avail\", \"able.\\n\\nThe following table lists replacement middleware and components in ASP.NET Core.\\n\\n| Module   \", \"   | ASP.NET 4.x module   | ASP.NET Core option          |\\n|-------------|----------------------|---\", \"---------------------------|\\n| HTTP errors | CustomErrorModule    | Status Code Pages Middleware |\\n\\n\", \"Middleware 2\\n\\nMiddleware 3\\n\\n| Module                  | ASP.NET 4.x module          | ASP.NET Core o\", \"ption             |\\n|-------------------------|-----------------------------|-----------------------\", \"----------|\\n| Default document        | DefaultDocumentModule       | Default Files Middleware      \", \"  |\\n| Directory browsing      | DirectoryListingModule      | Directory Browsing Middleware   |\\n| Dy\", \"namic compression     | DynamicCompressionModule    | Response Compression Middleware |\\n| Failed req\", \"uests tracing | FailedRequestsTracingModule | ASP.NET Core Logging            |\\n| File caching      \", \"      | FileCacheModule             | Response Caching Middleware     |\\n| HTTP caching            | \", \"HttpCacheModule             | Response Caching Middleware     |\\n| HTTP logging            | HttpLogg\", \"ingModule           | ASP.NET Core Logging            |\\n| HTTP redirection        | HttpRedirectionM\", \"odule       | URL Rewriting Middleware        |\\n| ISAPI filters           | IsapiFilterModule       \", \"    | Middleware                      |\\n| ISAPI                   | IsapiModule                 | Mi\", \"ddleware                      |\\n| Request filtering       | RequestFilteringModule      | URL Rewrit\", \"ing Middleware IRule  |\\n| URL rewriting\\u2020          | RewriteModule               | URL Rewriting Midd\", \"leware        |\\n| Static compression      | StaticCompressionModule     | Response Compression Middl\", \"eware |\\n| Static content          | StaticFileModule            | Static File Middleware          |\\n\", \"| URL authorization       | UrlAuthorizationModule      | ASP.NET Core Identity           |\\n\\nThis li\", \"st isn't exhaustive but should give an idea of what mapping exists between the two frameworks. For a\", \" more detailed list, see IIS modules with ASP.NET Core.\\n\\n## Custom middleware\\n\\nBuilt-in middleware m\", \"ay not handle all scenarios needed for an app. In such cases, it makes sense to create your own midd\", \"leware. There are multiple ways of defining middleware, with the simplest being a simple delegate. C\", \"onsider the following middleware, which accepts a culture request from a query string:\\n\\n```\\npublic c\", \"lass Startup { public void Configure(IApplicationBuilder app) { app.Use(async (context, next) => { v\", \"ar cultureQuery = context.Request.Query[\\\"culture\\\"];\\n```\\n\\n```\\nif (!string.IsNullOrWhiteSpace(cultureQ\", \"uery)) { var culture = new CultureInfo(cultureQuery); CultureInfo.CurrentCulture = culture; CultureI\", \"nfo.CurrentUICulture = culture; } // Call the next delegate/middleware in the pipeline await next();\", \" }); app.Run(async (context) => await context.Response.WriteAsync( $\\\"Hello {CultureInfo.CurrentCultu\", \"re.DisplayName}\\\")); } }\\n```\\n\\nMiddleware can also be defined as class, either by implementing the IMi\", \"ddleware interface or by following middleware convention. For more information, see Write custom ASP\", \".NET Core middleware.\\n\\n## App configuration\\n\\nThe primary way to load app configuration in Web Forms \", \"is with entries in the web.config file -either on the server or a related configuration file referen\", \"ced by web.config . You can use the static ConfigurationManager object to interact with app settings\", \", data repository connection strings, and other extended configuration providers that are added into\", \" the app. It's typical to see interactions with app configuration as seen in the following code:\\n\\n``\", \"`\\nvar configurationValue = ConfigurationManager.AppSettings[\\\"ConfigurationSettingName\\\"]; var connect\", \"ionString = ConfigurationManager.ConnectionStrings[\\\"MyDatabaseConnectionName\\\"].ConnectionString;\\n```\", \"\\n\\nWith ASP.NET Core and server-side Blazor, the web.config file MAY be present if your app is hosted\", \" on a Windows IIS server. However, there's no ConfigurationManager interaction with this configurati\", \"on, and you can receive more structured app configuration from other sources. Let's take a look at h\", \"ow configuration is gathered and how you can still access configuration information from a web.confi\", \"g file.\\n\\n## Configuration sources\\n\\nASP.NET Core recognizes there are many configuration sources you \", \"may want to use for your app. The framework attempts to offer you the best of these features by defa\", \"ult. Configuration is read and aggregated from these various sources by ASP.NET Core. Later loaded v\", \"alues for the same configuration key take precedence over earlier values.\\n\\nASP.NET Core was designed\", \" to be cloud-aware and to make the configuration of apps easier for both operators and developers. A\", \"SP.NET Core is environmentaware and knows if it's running in your Production or Development environm\", \"ent. The environment indicator is set in the ASPNETCORE\\\\_ENVIRONMENT system environment variable. If\", \" no value is configured, the app defaults to running in the Production environment.\\n\\nYour app can tr\", \"igger and add configuration from several sources based on the environment's name. By default, the co\", \"nfiguration is loaded from the following resources in the order listed:\\n\\n1. appsettings.json file, i\", \"f present\\n2. appsettings.{ENVIRONMENT\\\\_NAME}.json file, if present\\n3. User secrets file on disk, if \", \"present\\n4. Environment variables\\n5. Command-line arguments\\n\\n## appsettings.json format and access\\n\\nT\", \"he appsettings.json file can be hierarchical with values structured like the following JSON:\\n\\n```\\n{ \", \"\\\"section0\\\": { \\\"key0\\\": \\\"value\\\", \\\"key1\\\": \\\"value\\\" }, \\\"section1\\\": { \\\"key0\\\": \\\"value\\\", \\\"key1\\\": \\\"value\\\" } }\", \"\\n```\\n\\nWhen presented with the preceding JSON, the configuration system flattens child values and ref\", \"erences their fully qualified hierarchical paths. A colon (:) character separates each property in t\", \"he hierarchy. For example, the configuration key section1:key0 accesses the section1 object literal'\", \"s key0 value.\\n\\n## User secrets\\n\\nUser secrets are:\\n\\n- Configuration values that are stored in a JSON \", \"file on the developer's workstation, outside of the app development folder.\\n- Only loaded when runni\", \"ng in the Development environment.\\n- Associated with a specific app.\\n- Managed with the .NET CLI's u\", \"ser -secrets command.\\n\\nConfigure your app for secrets storage by executing the user-secrets command:\", \"\\n\\n```\\ndotnet user-secrets init\\n```\\n\\nThe preceding command adds a UserSecretsId element to the projec\", \"t file. The element contains a GUID, which is used to associate secrets with the app. You can then d\", \"efine a secret with the set command. For example:\\n\\n```\\ndotnet user-secrets set \\\"Parent:ApiKey\\\" \\\"1234\", \"5\\\"\\n```\\n\\nThe preceding command makes the Parent:ApiKey configuration key available on a developer's w\", \"orkstation with the value 12345.\\n\\nFor more information about creating, storing, and managing user se\", \"crets, see the Safe storage of app secrets in development in ASP.NET Core document.\\n\\n## Environment \", \"variables\\n\\nThe next set of values loaded into your app configuration is the system's environment var\", \"iables. All of your system's environment variable settings are now accessible to you through the con\", \"figuration API.\\n\\nHierarchical values are flattened and separated by colon characters when read insid\", \"e your app. However, some operating systems don't allow the colon character environment variable nam\", \"es. ASP.NET Core addresses this limitation by converting values that have double-underscores (\\\\_\\\\_) \", \"into a colon when they're accessed. The Parent:ApiKey value from the user secrets section above can \", \"be overridden with the environment variable Parent\\\\_\\\\_ApiKey.\\n\\n## Command-line arguments\\n\\nConfigurat\", \"ion can also be provided as command-line arguments when your app is started. Use the double-dash (--\", \") or forward-slash (/) notation to indicate the name of the configuration value to set and the value\", \" to be configured. The syntax resembles the following commands:\\n\\n```\\ndotnet run CommandLineKey1=valu\", \"e1 --CommandLineKey2=value2 /CommandLineKey3=value3 dotnet run --CommandLineKey1 value1 /CommandLine\", \"Key2 value2 dotnet run Parent:ApiKey=67890\\n```\\n\\n## The return of web.config\\n\\nIf you've deployed your\", \" app to Windows on IIS, the web.config file still configures IIS to manage your app. By default, IIS\", \" adds a reference to the ASP.NET Core Module (ANCM). ANCM is a native IIS module that hosts your app\", \" in place of the Kestrel web server. This web.config section resembles the following XML markup:\\n\\n``\", \"`\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> < configuration > < location path=\\\".\\\" inheritInChildApplica\", \"tions=\\\"false\\\"> < system.webServer > < handlers > < add name=\\\"aspNetCore\\\" path=\\\"*\\\" verb=\\\"*\\\" modules=\\\"\", \"AspNetCoreModuleV2\\\" resourceType=\\\"Unspecified\\\" /> </ handlers > < aspNetCore processPath=\\\".\\\\MyApp.ex\", \"e\\\" stdoutLogEnabled=\\\"false\\\" stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" hostingModel=\\\"inprocess\\\" /> </ system.webS\", \"erver > </ location > </ configuration >\\n```\\n\\nApp-specific configuration can be defined by nesting a\", \"n environmentVariables element in the aspNetCore element. The values defined in this section are pre\", \"sented to the ASP.NET Core app as environment variables. The environment variables load appropriatel\", \"y during that segment of app startup.\\n\\n```\\n< aspNetCore processPath=\\\"dotnet\\\" arguments=\\\".\\\\MyApp.dll\\\"\", \" stdoutLogEnabled=\\\"false\\\" stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" hostingModel=\\\"inprocess\\\"> < environmentVaria\", \"bles > < environmentVariable name=\\\"ASPNETCORE_ENVIRONMENT\\\" value=\\\"Development\\\" />\\n```\\n\\n```\\n< environ\", \"mentVariable name=\\\"Parent:ApiKey\\\" value=\\\"67890\\\" /> </ environmentVariables > </ aspNetCore >\\n```\\n\\n##\", \" Read configuration in the app\\n\\nASP.NET Core provides app configuration through the IConfiguration i\", \"nterface. This configuration interface should be requested by your Blazor components, Blazor pages, \", \"and any other ASP.NET Coremanaged class that needs access to configuration. The ASP.NET Core framewo\", \"rk will automatically populate this interface with the resolved configuration configured earlier. On\", \" a Blazor page or a component's Razor markup, you can inject the IConfiguration object with an @inje\", \"ct directive at the top of the .razor file like this:\\n\\n```\\n@inject IConfiguration Configuration\\n```\\n\", \"\\nThis preceding statement makes the IConfiguration object available as the Configuration variable th\", \"roughout the rest of the Razor template.\\n\\nIndividual configuration settings can be read by specifyin\", \"g the configuration setting hierarchy sought as an indexer parameter:\\n\\n```\\nvar mySetting = Configura\", \"tion[\\\"section1:key0\\\"];\\n```\\n\\nYou can fetch entire configuration sections by using the GetSection meth\", \"od to retrieve a collection of keys at a specific location with a syntax similar to GetSection(\\\"sect\", \"ion1\\\") to retrieve the configuration for section1 from the earlier example.\\n\\n## Strongly typed confi\", \"guration\\n\\nWith Web Forms, it was possible to create a strongly typed configuration type that inherit\", \"ed from the ConfigurationSection type and associated types. A ConfigurationSection allowed you to co\", \"nfigure some business rules and processing for those configuration values.\\n\\nIn ASP.NET Core, you can\", \" specify a class hierarchy that will receive the configuration values. These classes:\\n\\n- Don't need \", \"to inherit from a parent class.\\n- Should include public properties that match the properties and typ\", \"e references for the configuration structure you wish to capture.\\n\\nFor the earlier appsettings.json \", \"sample, you could define the following classes to capture the values:\\n\\n```\\npublic class MyConfig { p\", \"ublic MyConfigSection section0 { get; set;} public MyConfigSection section1 { get ; set ;} } public \", \"class MyConfigSection {\\n```\\n\\n```\\npublic string key0 { get ; set ; } public string key1 { get ; set ;\", \" } }\\n```\\n\\nThis class hierarchy can be populated by adding the following line to the Startup.Configur\", \"eServices method (or appropriate location in Program.cs using the builder.Services property instead \", \"of services):\\n\\n```\\nservices.Configure<MyConfig>(Configuration);\\n```\\n\\nIn the rest of the app, you can\", \" add an input parameter to classes or an @inject directive in Razor templates of type IOptions&lt;My\", \"Config&gt; to receive the strongly typed configuration settings. The IOptions&lt;MyConfig&gt;.Value \", \"property will yield the MyConfig value populated from the configuration settings.\\n\\n```\\n@inject IOpti\", \"ons<MyConfig> options @code { var MyConfiguration = options.Value; var theSetting = MyConfiguration.\", \"section1.key0; }\\n```\\n\\nMore information about the Options feature can be found in the Options pattern\", \" in ASP.NET Core document.\\n\\n## Security: Authentication and Authorization in ASP.NET Web Forms and B\", \"lazor\\n\\nMigrating from an ASP.NET Web Forms application to Blazor will almost certainly require updat\", \"ing how authentication and authorization are performed, assuming the application had authentication \", \"configured. This chapter will cover how to migrate from the ASP.NET Web Forms universal provider mod\", \"el (for membership, roles, and user profiles) and how to work with ASP.NET Core Identity from Blazor\", \" apps. While this chapter will cover the high-level steps and considerations, the detailed steps and\", \" scripts may be found in the referenced documentation.\\n\\n## ASP.NET universal providers\\n\\nSince ASP.NE\", \"T 2.0, the ASP.NET Web Forms platform has supported a provider model for a variety of features, incl\", \"uding membership. The universal membership provider, along with the optional role provider, is commo\", \"nly deployed with ASP.NET Web Forms applications. It offers a robust and secure way to manage authen\", \"tication and authorization that continues to work well today. The most recent offering of these univ\", \"ersal providers is available as a NuGet package, Microsoft.AspNet.Providers.\\n\\nThe Universal Provider\", \"s work with a SQL database schema that includes tables like aspnet\\\\_Applications, aspnet\\\\_Membership\", \", aspnet\\\\_Roles, and aspnet\\\\_Users. When configured by running the aspnet\\\\_regsql.exe command, the p\", \"roviders install tables and stored procedures that provide all of the necessary queries and commands\", \" to work with the underlying data. The database schema and these stored procedures are not compatibl\", \"e with newer ASP.NET Identity and ASP.NET Core Identity systems, so existing data must be migrated i\", \"nto the new system. Figure 1 shows an example table schema configured for universal providers.\\n\\nmemb\", \"ership\\n\\nDatabase Diagrams\\n\\n\\u2022 Tables\\n\\n\\u2022 System Tables\\n\\n\\u2022 FileTables\\n\\nExternal Tables\\n\\nGraph Tables\\n\\n#\", \" dbo.aspnet\\\\_Applications\\n\\n```\\n#i dbo.aspnet_Membership # dbo.aspnet_Paths E dbo.aspnet_Personalizat\", \"ionAllUsers #i dbo.aspnet_PersonalizationPerUser E dbo.aspnet_Profile E dbo.aspnet_Roles ## dbo.aspn\", \"et_SchemaVersions :: dbo.aspnet_Users # dbo.aspnet_UserslnRoles ## dbo.aspnet_WebEvent_Events\\n```\\n\\n<\", \"!-- image -->\\n\\nThe universal provider handles users, membership, roles, and profiles. Users are assi\", \"gned globally unique identifiers and basic information like userId, userName etc. are stored in the \", \"aspnet\\\\_Users table. Authentication information, such as password, password format, password salt, l\", \"ockout counters and details, etc. are stored in the aspnet\\\\_Membership table. Roles consist simply o\", \"f names and unique identifiers, which are assigned to users via the aspnet\\\\_UsersInRoles association\", \" table, providing a many-to-many relationship.\\n\\nIf your existing system is using roles in addition t\", \"o membership, you will need to migrate the user accounts, the associated passwords, the roles, and t\", \"he role membership into ASP.NET Core Identity. You will also most likely need to update your code wh\", \"ere you're currently performing role checks using if statements to instead leverage declarative filt\", \"ers, attributes, and/or tag helpers. We will review migration considerations in greater detail at th\", \"e end of this chapter.\\n\\n## Authorization configuration in Web Forms\\n\\nTo configure authorized access \", \"to certain pages in an ASP.NET Web Forms application, typically you specify that certain pages or fo\", \"lders are inaccessible to anonymous users. This configuration is done in the web.config file:\\n\\n```\\n<\", \"?xml version=\\\"1.0\\\"?> < configuration > < system.web > < authentication mode=\\\"Forms\\\"> < forms default\", \"Url=\\\"~/home.aspx\\\" loginUrl=\\\"~/login.aspx\\\" slidingExpiration=\\\"true\\\" timeout=\\\"2880\\\"></ forms > </ auth\", \"entication > < authorization > < deny users=\\\"?\\\" /> </ authorization > </ system.web > </ configurati\", \"on >\\n```\\n\\nThe authentication configuration section sets up the forms authentication for the applicat\", \"ion. The authorization section is used to disallow anonymous users for the entire application. Howev\", \"er, you can provide more granular authorization rules on a per-location basis as well as apply role-\", \"based authorization checks.\\n\\n```\\n< location path=\\\"login.aspx\\\"> < system.web >\\n```\\n\\n+\\n\\n+\\n\\n+\\n\\n+\\n\\n+\\n\\n+\\n\", \"\\n+\\n\\n+\\n\\n+\\n\\n```\\n< authorization > < allow users=\\\"*\\\" /> </ authorization > </ system.web > </ location \", \">\\n```\\n\\nThe above configuration, when combined with the first one, would allow anonymous users to acc\", \"ess the login page, overriding the site-wide restriction on non-authenticated users.\\n\\n```\\n< location\", \" path=\\\"/admin\\\"> < system.web > < authorization > < allow roles=\\\"Administrators\\\" /> < deny users=\\\"*\\\" \", \"/> </ authorization > </ system.web > </ location >\\n```\\n\\nThe above configuration, when combined with\", \" the others, restricts access to the /admin folder and all resources within it to members of the 'Ad\", \"ministrators' role. This restriction could also be applied by placing a separate web.config file wit\", \"hin the /admin folder root.\\n\\n## Authorization code in Web Forms\\n\\nIn addition to configuring access u\", \"sing web.config, you can also programmatically configure access and behavior in your Web Forms appli\", \"cation. For instance, you can restrict the ability to perform certain operations or view certain dat\", \"a based on the user's role.\\n\\nThis code can be used both in code-behind logic as well as in the page \", \"itself:\\n\\n```\\n< % if (HttpContext.Current.User.IsInRole(\\\"Administrators\\\")) { %> < a href =\\\"/admin\\\">Go\", \" To Admin</ a > < % } %>\\n```\\n\\nIn addition to checking user role membership, you can also determine i\", \"f they are authenticated (though often this is better done using the location-based configuration co\", \"vered above). Below is an example of this approach.\\n\\n```\\nprotected void Page_Load(object sender, Eve\", \"ntArgs e) { if (!User.Identity.IsAuthenticated) { FormsAuthentication.RedirectToLoginPage(); } if (!\", \"Roles.IsUserInRole(User.Identity.Name, \\\"Administrators\\\")) { MessageLabel.Text = \\\"Only administrators\", \" can view this.\\\"; SecretPanel.Visible = false ; } }\\n```\\n\\nIn the code above, role-based access contro\", \"l (RBAC) is used to determine whether certain elements of the page, such as a SecretPanel, are visib\", \"le based on the current user's role.\\n\\nTypically, ASP.NET Web Forms applications configure security w\", \"ithin the web.config file and then add additional checks where needed in .aspx pages and their relat\", \"ed .aspx.cs code-behind files. Most applications leverage the universal membership provider, frequen\", \"tly with the additional role provider.\\n\\n## ASP.NET Core Identity\\n\\nAlthough still tasked with authent\", \"ication and authorization, ASP.NET Core Identity uses a different set of abstractions and assumption\", \"s when compared to the universal providers. For example, the new Identity model supports third party\", \" authentication, allowing users to authenticate using a social media account or other trusted authen\", \"tication provider. ASP.NET Core Identity supports UI for commonly needed pages like login, logout, a\", \"nd register. It leverages EF Core for its data access, and uses EF Core migrations to generate the n\", \"ecessary schema required to support its data model. This introduction to Identity on ASP.NET Core pr\", \"ovides a good overview of what is included with ASP.NET Core Identity and how to get started working\", \" with it. If you haven't already set up ASP.NET Core Identity in your application and its database, \", \"it will help you get started.\\n\\n## Roles, claims, and policies\\n\\nBoth the universal providers and ASP.\", \"NET Core Identity support the concept of roles. You can create roles for users and assign users to r\", \"oles. Users can belong to any number of roles, and you can verify role membership as part of your au\", \"thorization implementation.\\n\\nIn addition to roles, ASP.NET Core identity supports the concepts of cl\", \"aims and policies. While a role should specifically correspond to a set of resources a user in that \", \"role should be able to access, a claim is simply part of a user's identity. A claim is a name value \", \"pair that represents what the subject is, not what the subject can do.\\n\\nIt is possible to directly i\", \"nspect a user's claims and determine based on these values whether a user should be given access to \", \"a resource. However, such checks are often repetitive and scattered throughout the system. A better \", \"approach is to define a policy .\\n\\nAn authorization policy consists of one or more requirements. Poli\", \"cies are registered as part of the authorization service configuration in the ConfigureServices meth\", \"od of Startup.cs. For example, the following code snippet configures a policy called 'CanadiansOnly'\", \", which has the requirement that the user has the Country claim with the value of 'Canada'.\\n\\n```\\nser\", \"vices.AddAuthorization(options => { options.AddPolicy(\\\"CanadiansOnly\\\", policy => policy.RequireClaim\", \"(ClaimTypes.Country, \\\"Canada\\\")); });\\n```\\n\\nYou can learn more about how to create custom policies in \", \"the documentation.\\n\\nWhether you're using policies or roles, you can specify that a particular page i\", \"n your Blazor application requires that role or policy with the [Authorize] attribute, applied with \", \"the @attribute directive.\\n\\nRequiring a role:\\n\\n```\\n@attribute [Authorize(Roles =\\\"administrators\\\")]\\n``\", \"`\\n\\nRequiring a policy be satisfied:\\n\\n```\\n@attribute [Authorize(Policy =\\\"CanadiansOnly\\\")]\\n```\\n\\nIf you\", \" need access to a user's authentication state, roles, or claims in your code, there are two primary \", \"ways to achieve this functionality. The first is to receive the authentication state as a cascading \", \"parameter. The second is to access the state using an injected AuthenticationStateProvider. The deta\", \"ils of each of these approaches are described in the Blazor Security documentation.\\n\\nThe following c\", \"ode shows how to receive the AuthenticationState as a cascading parameter:\\n\\n```\\n[CascadingParameter]\", \" private Task<AuthenticationState> authenticationStateTask { get ; set ; }\\n```\\n\\nWith this parameter \", \"in place, you can get the user using this code:\\n\\n```\\nvar authState = await authenticationStateTask; \", \"var user = authState.User;\\n```\\n\\nThe following code shows how to inject the AuthenticationStateProvid\", \"er:\\n\\n```\\n@using Microsoft.AspNetCore.Components.Authorization @inject AuthenticationStateProvider Au\", \"thenticationStateProvider\\n```\\n\\nWith the provider in place, you can gain access to the user with the \", \"following code:\\n\\n```\\nAuthenticationState authState = await AuthenticationStateProvider.GetAuthentica\", \"tionStateAsync(); ClaimsPrincipal user = authState.User; if (user.Identity.IsAuthenticated) { // wor\", \"k with user.Claims and/or user.Roles }\\n```\\n\\nNote: The AuthorizeView component, covered later in this\", \" chapter, provides a declarative way to control what a user sees on a page or component.\\n\\nTo work wi\", \"th users and claims (in Blazor Server applications) you may also need to inject a UserManager&lt;T&g\", \"t; (use IdentityUser for default) which you can use to enumerate and modify claims for a user. First\", \" inject the type and assign it to a property:\\n\\n```\\n@inject UserManager<IdentityUser> MyUserManager\\n`\", \"``\\n\\nThen use it to work with the user's claims. The following sample shows how to add and persist a \", \"claim on a user:\\n\\n```\\nprivate async Task AddCountryClaim() { var authState = await AuthenticationSta\", \"teProvider.GetAuthenticationStateAsync(); var user = authState.User; var identityUser = await MyUser\", \"Manager.FindByNameAsync(user.Identity.Name); if (!user.HasClaim(c => c.Type == ClaimTypes.Country)) \", \"{\\n```\\n\\n```\\n// stores the claim in the cookie ClaimsIdentity id = new ClaimsIdentity(); id.AddClaim( \", \"new Claim(ClaimTypes.Country, \\\"Canada\\\")); user.AddIdentity(id); // save the claim in the database aw\", \"ait MyUserManager.AddClaimAsync(identityUser, new Claim(ClaimTypes.Country, \\\"Canada\\\")); } }\\n```\\n\\nIf \", \"you need to work with roles, follow the same approach. You may need to inject a RoleManager&lt;T&gt;\", \" (use IdentityRole for default type) to list and manage the roles themselves.\\n\\nNote: In Blazor WebAs\", \"sembly projects, you will need to provide server APIs to perform these operations (instead of using \", \"UserManager&lt;T&gt; or RoleManager&lt;T&gt; directly). A Blazor WebAssembly client application woul\", \"d manage claims and/or roles by securely calling API endpoints exposed for this purpose.\\n\\n## Migrati\", \"on guide\\n\\nMigrating from ASP.NET Web Forms and universal providers to ASP.NET Core Identity requires\", \" several steps:\\n\\n1. Create ASP.NET Core Identity database schema in the destination database\\n2. Migr\", \"ate data from universal provider schema to ASP.NET Core Identity schema\\n3. Migrate configuration fro\", \"m the web.config to middleware and services, typically in Program.cs (or a Startup class)\\n4. Update \", \"individual pages using controls and conditionals to use tag helpers and new identity APIs.\\n\\nEach of \", \"these steps is described in detail in the following sections.\\n\\n## Creating the ASP.NET Core Identity\", \" schema\\n\\nThere are several ways to create the necessary table structure used for ASP.NET Core Identi\", \"ty. The simplest is to create a new ASP.NET Core Web application. Choose Web Application and then ch\", \"ange Authentication type to use Individual Accounts.\\n\\nAdditional information\\n\\nASP.NET Core Web App c\", \"*\\n\\nFramework i\\n\\nNET 6.0 (Long-term support)\\n\\nAuthentication type O\\n\\nIndividual Accounts\\n\\n/ Configure\", \" for HTTPS O\\n\\nL Enable Docker M\\n\\nDocker OS O\\n\\nLinux\\n\\nLinux macos\\n\\nWindows\\n\\nCloud\\n\\nService\\n\\nWeb\\n\\n<!--\", \" image -->\\n\\nFrom the command line, you can do the same thing by running dotnet new webapp -au Indivi\", \"dual. Once the app has been created, run it and register on the site. You should trigger a page like\", \" the one shown below:\\n\\nX\\n\\nInternal Server Error\\n\\n+\\n\\nECR8 localhost:44343/Identity/Account/Register b\", \"y the login. The login failed. Login failed for user 'NIGHTKING\\\\steve'.\\n\\nThere are migrations for Ap\", \"plicationDbContext that have not been applied to the database\\n\\n\\u2022 00000000000000\\\\_CreateldentitySchem\", \"a\\n\\nApply Migrations\\n\\nPM&gt; Update-Database\\n\\n\\u203a dotnet ef database update\\n\\nGuest\\n\\n<!-- image -->\\n\\nCli\", \"ck on the 'Apply Migrations' button and the necessary database tables should be created for you. In \", \"addition, the migration files should appear in your project, as shown:\\n\\nX\\n\\nSolution Explorer\\n\\nSearch\", \" Solution Explorer (Ctrl+:)\\n\\nSolution 'WebApplication12' (1 of 1 project)\\n\\nWebApplication12\\n\\nConnect\", \"ed Services\\n\\nDependencies\\n\\nProperties wwwroot\\n\\nAreas\\n\\nData\\n\\nPages appsettings.json\\n\\nC# Program.cs\\n\\n<\", \"!-- image -->\\n\\nYou can run the migration yourself, without running the web application, using this c\", \"ommand-line tool:\\n\\n<!-- image -->\\n\\nIf you would rather run a script to apply the new schema to an ex\", \"isting database, you can script these migrations from the command-line. Run this command to generate\", \" the script:\\n\\n<!-- image -->\\n\\nThe above command will produce a SQL script in the output file auth.sq\", \"l, which can then be run against whatever database you like. If you have any trouble running dotnet \", \"ef commands, make sure you have the EF Core tools installed on your system.\\n\\nIn the event you have a\", \"dditional columns on your source tables, you will need to identify the best location for these colum\", \"ns in the new schema. Generally, columns found on the aspnet\\\\_Membership table should be mapped to t\", \"he AspNetUsers table. Columns on aspnet\\\\_Roles should be mapped to AspNetRoles. Any additional colum\", \"ns on the aspnet\\\\_UsersInRoles table would be added to the AspNetUserRoles table.\\n\\nIt's also worth c\", \"onsidering putting any additional columns on separate tables. So that future migrations won't need t\", \"o take into account such customizations of the default identity schema.\\n\\n## Migrating data from univ\", \"ersal providers to ASP.NET Core Identity\\n\\nOnce you have the destination table schema in place, the n\", \"ext step is to migrate your user and role records to the new schema. A complete list of the schema d\", \"ifferences, including which columns map to which new columns, can be found here.\\n\\nP\\n\\nP\\n\\nP\\n\\nP\\n\\nP\\n\\nP\\n\\n\", \"- 7 4 x\\n\\nTo migrate your users from membership to the new identity tables, you should follow the ste\", \"ps described in the documentation. After following these steps and the script provided, your users w\", \"ill need to change their password the next time they log in.\\n\\nIt is possible to migrate user passwor\", \"ds but the process is much more involved. Requiring users to update their passwords as part of the m\", \"igration process, and encouraging them to use new, unique passwords, is likely to enhance the overal\", \"l security of the application.\\n\\n## Migrating security settings from web.config to app startup\\n\\nAs no\", \"ted above, ASP.NET membership and role providers are configured in the application's web.config file\", \". Since ASP.NET Core apps are not tied to IIS and use a separate system for configuration, these set\", \"tings must be configured elsewhere. For the most part, ASP.NET Core Identity is configured in the Pr\", \"ogram.cs file. Open the web project that was created earlier (to generate the identity table schema)\", \" and review its Program.cs (or Startup.cs ) file.\\n\\nThis code adds support for EF Core and Identity:\\n\", \"\\n```\\n// Add services to the container. var connectionString = builder.Configuration.GetConnectionStr\", \"ing(\\\"DefaultConnection\\\"); builder.Services.AddDbContext<ApplicationDbContext>(options => options.Use\", \"SqlServer(connectionString)); builder.Services.AddDatabaseDeveloperPageExceptionFilter(); builder.Se\", \"rvices.AddDefaultIdentity<IdentityUser>(options => options.SignIn.RequireConfirmedAccount = true ) .\", \"AddEntityFrameworkStores<ApplicationDbContext>();\\n```\\n\\nThe AddDefaultIdentity extension method is us\", \"ed to configure Identity to use the default ApplicationDbContext and the framework's IdentityUser ty\", \"pe. If you're using a custom IdentityUser, be sure to specify its type here. If these extension meth\", \"ods aren't working in your application, check that you have the appropriate using statements and tha\", \"t you have the necessary NuGet package references. For example, your project should have some versio\", \"n of the Microsoft.AspNetCore.Identity.EntityFrameworkCore and Microsoft.AspNetCore.Identity.UI pack\", \"ages referenced.\\n\\nAlso in Program.cs you should see the necessary middleware configured for the site\", \". Specifically, UseAuthentication and UseAuthorization should be set up, and in the proper location.\", \"\\n\\n```\\n// Configure the HTTP request pipeline. if (app.Environment.IsDevelopment()) { app.UseMigratio\", \"nsEndPoint(); } else { app.UseExceptionHandler(\\\"/Error\\\"); // The default HSTS value is 30 days. You \", \"may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts. app.UseHsts();\", \" } app.UseHttpsRedirection(); app.UseStaticFiles();\\n```\\n\\n```\\napp.UseRouting(); app.UseAuthentication\", \"(); app.UseAuthorization(); //app.MapControllers(); app.MapBlazorHub(); app.MapFallbackToPage(\\\"/_Hos\", \"t\\\");\\n```\\n\\nASP.NET Identity does not configure anonymous or role-based access to locations from Progr\", \"am.cs . You will need to migrate any location-specific authorization configuration data to filters i\", \"n ASP.NET Core. Make note of which folders and pages will require such updates. You will make these \", \"changes in the next section.\\n\\n## Updating individual pages to use ASP.NET Core Identity abstractions\", \"\\n\\nIn your ASP.NET Web Forms application, if you had web.config settings to deny access to certain pa\", \"ges or folders to anonymous users, you would migrate these changes by adding the [Authorize] attribu\", \"te to such pages:\\n\\n```\\n@attribute [Authorize]\\n```\\n\\nIf you further had denied access except to those \", \"users belonging to a certain role, you would likewise migrate this behavior by adding an attribute s\", \"pecifying a role:\\n\\n```\\n@attribute [Authorize(Roles =\\\"administrators\\\")]\\n```\\n\\nThe [Authorize] attribut\", \"e only works on @page components that are reached via the Blazor Router. The attribute does not work\", \" with child components, which should instead use AuthorizeView.\\n\\nIf you have logic within page marku\", \"p for determining whether to display some code to a certain user, you can replace this with the Auth\", \"orizeView component. The AuthorizeView component selectively displays UI depending on whether the us\", \"er is authorized to see it. It also exposes a context variable that can be used to access user infor\", \"mation.\\n\\n```\\n<AuthorizeView> <Authorized> <h1>Hello, @context.User.Identity.Name!</h1> <p>You can on\", \"ly see this content if you are authenticated.</p> </Authorized> <NotAuthorized> <h1>Authentication F\", \"ailure!</h1> <p>You are not signed in.</p> </NotAuthorized> </AuthorizeView>\\n```\\n\\nYou can access the\", \" authentication state within procedural logic by accessing the user from a Task&lt;AuthenticationSta\", \"te configured with the [CascadingParameter] attribute. This configuration will get you access to the\", \" user, which can let you determine if they are authenticated and if they belong to a particular role\", \". If you need to evaluate a policy procedurally, you can inject an instance of the IAuthorizationSer\", \"vice and calls the AuthorizeAsync method on it. The following sample code demonstrates how to get us\", \"er information and allow an authorized user to perform a task restricted by the content-editor polic\", \"y.\\n\\n```\\n@using Microsoft.AspNetCore.Authorization @inject IAuthorizationService AuthorizationService\", \" <button @onclick=\\\"@DoSomething\\\">Do something important</button> @code { [CascadingParameter] privat\", \"e Task<AuthenticationState> authenticationStateTask { get; set; } private async Task DoSomething() {\", \" var user = (await authenticationStateTask).User; if (user.Identity.IsAuthenticated) { // Perform an\", \" action only available to authenticated (signed-in) users. } if (user.IsInRole(\\\"admin\\\")) { // Perfor\", \"m an action only available to users in the 'admin' role. } if ((await AuthorizationService.Authorize\", \"Async(user, \\\"content-editor\\\")) .Succeeded) { // Perform an action only available to users satisfying\", \" the // 'content-editor' policy. } } }\\n```\\n\\nThe AuthenticationState first need to be set up as a cas\", \"cading value before it can be bound to a cascading parameter like this. That's typically done using \", \"the CascadingAuthenticationState component. This configuration is typically done in App.razor:\\n\\n```\\n\", \"<CascadingAuthenticationState> <Router AppAssembly=\\\"@typeof(Program).Assembly\\\"> <Found Context=\\\"rout\", \"eData\\\"> <AuthorizeRouteView RouteData=\\\"@routeData\\\" DefaultLayout=\\\"@typeof(MainLayout)\\\" /> </Found> <\", \"NotFound> <LayoutView Layout=\\\"@typeof(MainLayout)\\\"> <p>Sorry, there's nothing at this address.</p> <\", \"/LayoutView> </NotFound> </Router> </CascadingAuthenticationState>\\n```\\n\\n## Summary\\n\\nBlazor uses the \", \"same security model as ASP.NET Core, which is ASP.NET Core Identity. Migrating from universal provid\", \"ers to ASP.NET Core Identity is relatively straightforward, assuming not too much customization was \", \"applied to the original data schema. Once the data has been migrated, working\\n\\nwith authentication a\", \"nd authorization in Blazor apps is well documented, with configurable as well as programmatic suppor\", \"t for most security requirements.\\n\\n## References\\n\\n- Introduction to Identity on ASP.NET Core\\n- Migra\", \"te from ASP.NET Membership authentication to ASP.NET Core 2.0 Identity\\n- Migrate Authentication and \", \"Identity to ASP.NET Core\\n- ASP.NET Core Blazor authentication and authorization\\n\\n## Migrate from ASP\", \".NET Web Forms to Blazor\\n\\nMigrating a code base from ASP.NET Web Forms to Blazor is a time-consuming\", \" task that requires planning. This chapter outlines the process. Something that can ease the transit\", \"ion is to ensure the app adheres to an N-tier architecture, wherein the app model (in this case, Web\", \" Forms) is separate from the business logic. This logical separation of layers makes it clear what n\", \"eeds to move to .NET Core and Blazor.\\n\\nFor this example, the eShop app available on GitHub is used. \", \"eShop is a catalog service that provides CRUD capabilities via form entry and validation.\\n\\nWhy shoul\", \"d a working app be migrated to Blazor? Many times, there's no need. ASP.NET Web Forms will continue \", \"to be supported for many years. However, many of the features that Blazor provides are only supporte\", \"d on a migrated app. Such features include:\\n\\n- Performance improvements in the framework such as Spa\", \"n&lt;T&gt;\\n- Ability to run as WebAssembly\\n- Cross-platform support for Linux and macOS\\n- App-local \", \"deployment or shared framework deployment without impacting other apps\\n\\nIf these or other new featur\", \"es are compelling enough, there may be value in migrating the app. The migration can take different \", \"shapes; it can be the entire app, or only certain endpoints that require the changes. The decision t\", \"o migrate is ultimately based on the business problems to be solved by the developer.\\n\\n## Server-sid\", \"e versus client-side hosting\\n\\nAs described in the hosting models chapter, a Blazor app can be hosted\", \" in two different ways: serverside and client-side. The server-side model uses ASP.NET Core SignalR \", \"connections to manage the DOM updates while running any actual code on the server. The client-side m\", \"odel runs as WebAssembly within a browser and requires no server connections. There are a number of \", \"differences that may affect which is best for a specific app:\\n\\n- Running as WebAssembly doesn't supp\", \"ort all features (such as threading) at the current time\\n- Chatty communication between the client a\", \"nd server may cause latency issues in server-side mode\\n\\n<!-- image -->\\n\\n- Access to databases and in\", \"ternal or protected services require a separate service with clientside hosting\\n\\nAt the time of writ\", \"ing, the server-side model more closely resembles Web Forms. Most of this chapter focuses on the ser\", \"verside hosting model, as it's production -ready.\\n\\n## Create a new project\\n\\nThis initial migration s\", \"tep is to create a new project. This project type is based on the SDK style projects of .NET and sim\", \"plifies much of the boilerplate that was used in previous project formats. For more detail, please s\", \"ee the chapter on Project Structure.\\n\\nOnce the project has been created, install the libraries that \", \"were used in the previous project. In older Web Forms projects, you may have used the packages.confi\", \"g file to list the required NuGet packages. In the new SDK-style project, packages.config has been r\", \"eplaced with &lt;PackageReference&gt; elements in the project file. A benefit to this approach is th\", \"at all dependencies are installed transitively. You only list the top-level dependencies you care ab\", \"out.\\n\\nMany of the dependencies you're using are available for .NET, including Entity Framework 6 and\", \" log4net. If there's no .NET or .NET Standard version available, the .NET Framework version can ofte\", \"n be used. Your mileage may vary. Any API used that isn't available in .NET causes a runtime error. \", \"Visual Studio notifies you of such packages. A yellow icon appears on the project's References node \", \"in Solution Explorer .\\n\\nIn the Blazor-based eShop project, you can see the packages that are install\", \"ed. Previously, the packages.config file listed every package used in the project, resulting in a fi\", \"le almost 50 lines long. A snippet of packages.config is:\\n\\n```\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?\", \"> < packages > ... < package id=\\\"Microsoft.ApplicationInsights.Agent.Intercept\\\" version=\\\"2.4.0\\\" targ\", \"etFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.ApplicationInsights.DependencyCollector\\\" version=\\\"2.\", \"9.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.ApplicationInsights.PerfCounterCollector\\\" v\", \"ersion=\\\"2.9.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.ApplicationInsights.Web\\\" version=\", \"\\\"2.9.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.ApplicationInsights.WindowsServer\\\" versi\", \"on=\\\"2.9.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.ApplicationInsights.WindowsServer.Tel\", \"emetryChannel\\\" version=\\\"2.9.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.AspNet.FriendlyUr\", \"ls\\\" version=\\\"1.0.2\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.AspNet.FriendlyUrls.Core\\\" ve\", \"rsion=\\\"1.0.2\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.AspNet.ScriptManager.MSAjax\\\" versi\", \"on=\\\"5.0.0\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Microsoft.AspNet.ScriptManager.WebForms\\\" versio\", \"n=\\\"5.0.0\\\" targetFramework=\\\"net472\\\" /> ... < package id=\\\"System.Memory\\\" version=\\\"4.5.1\\\" targetFramewo\", \"rk=\\\"net472\\\" /> < package id=\\\"System.Numerics.Vectors\\\" version=\\\"4.4.0\\\" targetFramework=\\\"net472\\\" /> < \", \"package id=\\\"System.Runtime.CompilerServices.Unsafe\\\" version=\\\"4.5.0\\\"\\n```\\n\\n```\\ntargetFramework=\\\"net472\", \"\\\" /> < package id=\\\"System.Threading.Channels\\\" version=\\\"4.5.0\\\" targetFramework=\\\"net472\\\" /> < package \", \"id=\\\"System.Threading.Tasks.Extensions\\\" version=\\\"4.5.1\\\" targetFramework=\\\"net472\\\" /> < package id=\\\"Web\", \"Grease\\\" version=\\\"1.6.0\\\" targetFramework=\\\"net472\\\" /> </ packages >\\n```\\n\\nThe &lt;packages&gt; element \", \"includes all necessary dependencies. It's difficult to identify which of these packages are included\", \" because you require them. Some &lt;package&gt; elements are listed simply to satisfy the needs of d\", \"ependencies you require.\\n\\nThe Blazor project lists the dependencies you require within an &lt;ItemGr\", \"oup&gt; element in the project file:\\n\\n```\\n< ItemGroup > < PackageReference Include=\\\"Autofac\\\" Version\", \"=\\\"4.9.3\\\" /> < PackageReference Include=\\\"EntityFramework\\\" Version=\\\"6.4.4\\\" /> < PackageReference Inclu\", \"de=\\\"log4net\\\" Version=\\\"2.0.12\\\" /> < PackageReference Include=\\\"Microsoft.Extensions.Logging.Log4Net.As\", \"pNetCore\\\" Version=\\\"2.2.12\\\" /> </ ItemGroup >\\n```\\n\\nOne NuGet package that simplifies the life of Web \", \"Forms developers is the Windows Compatibility Pack. Although .NET is cross-platform, some features a\", \"re only available on Windows. Windowsspecific features are made available by installing the compatib\", \"ility pack. Examples of such features include the Registry, WMI, and Directory Services. The package\", \" adds around 20,000 APIs and activates many services with which you may already be familiar. The eSh\", \"op project doesn't require the compatibility pack; but if your projects use Windows-specific feature\", \"s, the package eases the migration efforts.\\n\\n## Enable startup process\\n\\nThe startup process for Blaz\", \"or has changed from Web Forms and follows a similar setup for other ASP.NET Core services. When host\", \"ed server-side, Razor components are run as part of a normal ASP.NET Core app. When hosted in the br\", \"owser with WebAssembly, Razor components use a similar hosting model. The difference is the componen\", \"ts are run as a separate service from any of the backend processes. Either way, the startup is simil\", \"ar.\\n\\nThe Global.asax.cs file is the default startup page for Web Forms projects. In the eShop projec\", \"t, this file configures the Inversion of Control (IoC) container and handles the various lifecycle e\", \"vents of the app or request. Some of these events are handled with middleware (such as Application\\\\_\", \"BeginRequest). Other events require the overriding of specific services via dependency injection (DI\", \").\\n\\nBy way of example, the Global.asax.cs file for eShop, contains the following code:\\n\\n```\\npublic c\", \"lass Global : HttpApplication, IContainerProviderAccessor { private static readonly ILog _log = LogM\", \"anager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); static IContainerPr\", \"ovider _containerProvider; IContainer container;\\n```\\n\\n```\\npublic IContainerProvider ContainerProvide\", \"r { get { return _containerProvider; } } protected void Application_Start(object sender, EventArgs e\", \") { // Code that runs on app startup RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.Reg\", \"isterBundles(BundleTable.Bundles); ConfigureContainer(); ConfigDataBase(); } /// <summary> /// Track\", \" the machine name and the start time for the session inside the current session /// </summary> prote\", \"cted void Session_Start(Object sender, EventArgs e) { HttpContext.Current.Session[\\\"MachineName\\\"] = E\", \"nvironment.MachineName; HttpContext.Current.Session[\\\"SessionStartTime\\\"] = DateTime.Now; } /// <summa\", \"ry> /// https://autofaccn.readthedocs.io/en/latest/integration/webforms.html /// </summary> private \", \"void ConfigureContainer() { var builder = new ContainerBuilder(); var mockData = bool.Parse(Configur\", \"ationManager.AppSettings[\\\"UseMockData\\\"]); builder.RegisterModule( new ApplicationModule(mockData)); \", \"container = builder.Build(); _containerProvider = new ContainerProvider(container); } private void C\", \"onfigDataBase() { var mockData = bool.Parse(ConfigurationManager.AppSettings[\\\"UseMockData\\\"]); if (!m\", \"ockData) { Database.SetInitializer<CatalogDBContext>(container.Resolve<CatalogDBInitializer>()); } }\", \" protected void Application_BeginRequest(object sender, EventArgs e) { //set the property to our new\", \" object LogicalThreadContext.Properties[\\\"activityid\\\"] = new ActivityIdHelper(); LogicalThreadContext\", \".Properties[\\\"requestinfo\\\"] = new WebRequestInfo(); _log.Debug(\\\"Application_BeginRequest\\\"); } }\\n```\\n\\n\", \"The preceding file becomes the Program.cs file in server-side Blazor:\\n\\n```\\nusing eShopOnBlazor.Model\", \"s; using eShopOnBlazor.Models.Infrastructure; using eShopOnBlazor.Services; using log4net; using Sys\", \"tem.Data.Entity; using eShopOnBlazor; var builder = WebApplication.CreateBuilder(args); // add servi\", \"ces builder.Services.AddRazorPages(); builder.Services.AddServerSideBlazor(); if (builder.Configurat\", \"ion.GetValue<bool>(\\\"UseMockData\\\")) { builder.Services.AddSingleton<ICatalogService, CatalogServiceMo\", \"ck>(); } else { builder.Services.AddScoped<ICatalogService, CatalogService>(); builder.Services.AddS\", \"coped<IDatabaseInitializer<CatalogDBContext>, CatalogDBInitializer>(); builder.Services.AddSingleton\", \"<CatalogItemHiLoGenerator>(); builder.Services.AddScoped(_ => new CatalogDBContext(builder.Configura\", \"tion.GetConnectionString(\\\"CatalogDBContext\\\"))); } var app = builder.Build(); new LoggerFactory().Add\", \"Log4Net(\\\"log4Net.xml\\\"); if (app.Environment.IsDevelopment()) { app.UseDeveloperExceptionPage(); } el\", \"se { app.UseExceptionHandler(\\\"/Home/Error\\\"); } // Middleware for Application_BeginRequest app.Use((c\", \"tx, next) => { LogicalThreadContext.Properties[\\\"activityid\\\"] = new ActivityIdHelper(ctx); LogicalThr\", \"eadContext.Properties[\\\"requestinfo\\\"] = new WebRequestInfo(ctx); return next(); }); app.UseStaticFile\", \"s(); app.UseRouting(); app.UseEndpoints(endpoints => { endpoints.MapBlazorHub(); endpoints.MapFallba\", \"ckToPage(\\\"/_Host\\\"); }); ConfigDataBase(app);\\n```\\n\\n```\\nvoid ConfigDataBase(IApplicationBuilder app) {\", \" using (var scope = app.ApplicationServices.CreateScope()) { var initializer = scope.ServiceProvider\", \".GetService<IDatabaseInitializer<CatalogDBContext>>(); if (initializer != null ) { Database.SetIniti\", \"alizer(initializer); } } } app.Run();\\n```\\n\\nOne significant change you may notice from Web Forms is t\", \"he prominence of dependency injection (DI). DI has been a guiding principle in the ASP.NET Core desi\", \"gn. It supports customization of almost all aspects of the ASP.NET Core framework. There's even a bu\", \"ilt -in service provider that can be used for many scenarios. If more customization is required, it \", \"can be supported by many community projects. For example, you can carry forward your third-party DI \", \"library investment.\\n\\nIn the original eShop app, there's some configuration for session management. S\", \"ince server -side Blazor uses ASP.NET Core SignalR for communication, the session state isn't suppor\", \"ted as the connections may occur independent of an HTTP context. An app that uses the session state \", \"requires rearchitecting before running as a Blazor app.\\n\\nFor more information about app startup, see\", \" App startup.\\n\\n## Migrate HTTP modules and handlers to middleware\\n\\nHTTP modules and handlers are com\", \"mon patterns in Web Forms to control the HTTP request pipeline. Classes that implement IHttpModule o\", \"r IHttpHandler could be registered and process incoming requests. Web Forms configure modules and ha\", \"ndlers in the web.config file. Web Forms is also heavily based on app lifecycle event handling. ASP.\", \"NET Core uses middleware instead. Middleware is registered in the Configure method of the Startup cl\", \"ass. Middleware execution order is determined by the registration order.\\n\\nIn the Enable startup proc\", \"ess section, a lifecycle event was raised by Web Forms as the Application\\\\_BeginRequest method. This\", \" event isn't available in ASP.NET Core. One way to achieve this behavior is to implement middleware \", \"as seen in the Startup.cs file example. This middleware does the same logic and then transfers contr\", \"ol to the next handler in the middleware pipeline.\\n\\nFor more information on migrating modules and ha\", \"ndlers, see Migrate HTTP handlers and modules to ASP.NET Core middleware.\\n\\n## Migrate static files\\n\\n\", \"To serve static files (for example, HTML, CSS, images, and JavaScript), the files must be exposed by\", \" middleware. Calling the UseStaticFiles method enables the serving of static files from the web root\", \" path. The default web root directory is wwwroot , but it can be customized. As included in the Prog\", \"ram.cs file:\\n\\n```\\n... app.UseStaticFiles(); ...\\n```\\n\\nThe eShop project enables basic static file acc\", \"ess. There are many customizations available for static file access. For information on enabling def\", \"ault files or a file browser, see Static files in ASP.NET Core.\\n\\n## Migrate runtime bundling and min\", \"ification setup\\n\\nBundling and minification are performance optimization techniques for reducing the \", \"number and size of server requests to retrieve certain file types. JavaScript and CSS often undergo \", \"some form of bundling or minification before being sent to the client. In ASP.NET Web Forms, these o\", \"ptimizations are handled at run time. The optimization conventions are defined an App\\\\_Start/BundleC\", \"onfig.cs file. In ASP.NET Core, a more declarative approach is adopted. A file lists the files to be\", \" minified, along with specific minification settings.\\n\\nFor more information on bundling and minifica\", \"tion, see Bundle and minify static assets in ASP.NET Core.\\n\\n## Migrate ASPX pages\\n\\nA page in a Web F\", \"orms app is a file with the .aspx extension. A Web Forms page can often be mapped to a component in \", \"Blazor. A Razor component is authored in a file with the .razor extension. For the eShop project, fi\", \"ve pages are converted to a Razor page.\\n\\nFor example, the details view comprises three files in the \", \"Web Forms project: Details.aspx , Details.aspx.cs , and Details.aspx.designer.cs . When converting t\", \"o Blazor, the code-behind and markup are combined into Details.razor . Razor compilation (equivalent\", \" to what's in .designer.cs files) is stored in the obj directory and isn't, by default, viewable in \", \"Solution Explorer . The Web Forms page consists of the following markup:\\n\\n```\\n<%@ Page Title=\\\"Detail\", \"s\\\" Language=\\\"C#\\\" MasterPageFile=\\\"~/Site.Master\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Details.aspx.cs\\\" \", \"Inherits=\\\"eShopLegacyWebForms.Catalog.Details\\\" %> <asp:Content ID=\\\"Details\\\" ContentPlaceHolderID=\\\"Ma\", \"inContent\\\" runat=\\\"server\\\"> <h2 class=\\\"esh-body-title\\\">Details</h2> <div class=\\\"container\\\"> <div clas\", \"s=\\\"row\\\">\\n```\\n\\n```\\n<asp:Image runat=\\\"server\\\" CssClass=\\\"col-md-6 esh-picture\\\" ImageUrl='<%#\\\"/Pics/\\\" + \", \"product.PictureFileName%>' /> <dl class=\\\"col-md-6 dl-horizontal\\\"> <dt>Name </dt> <dd> <asp:Label run\", \"at=\\\"server\\\" Text='<%#product.Name%>' /> </dd> <dt>Description </dt> <dd> <asp:Label runat=\\\"server\\\" T\", \"ext='<%#product.Description%>' /> </dd> <dt>Brand </dt> <dd> <asp:Label runat=\\\"server\\\" Text='<%#prod\", \"uct.CatalogBrand.Brand%>' /> </dd> <dt>Type </dt> <dd> <asp:Label runat=\\\"server\\\" Text='<%#product.Ca\", \"talogType.Type%>' /> </dd> <dt>Price </dt> <dd> <asp:Label CssClass=\\\"esh-price\\\" runat=\\\"server\\\" Text=\", \"'<%#product.Price%>' /> </dd> <dt>Picture name </dt> <dd> <asp:Label runat=\\\"server\\\" Text='<%#product\", \".PictureFileName%>' /> </dd> <dt>Stock </dt> <dd> <asp:Label runat=\\\"server\\\" Text='<%#product.Availab\", \"leStock%>' /> </dd> <dt>Restock </dt> <dd> <asp:Label runat=\\\"server\\\" Text='<%#product.RestockThresho\", \"ld%>' /> </dd> <dt>Max stock </dt>\\n```\\n\\n```\\n<dd> <asp:Label runat=\\\"server\\\" Text='<%#product.MaxStock\", \"Threshold%>' /> </dd> </dl> </div> <div class=\\\"form-actions no-color esh-link-list\\\"> <a runat=\\\"serve\", \"r\\\" href='<%# GetRouteUrl(\\\"EditProductRoute\\\", new {id =product.Id}) %>' class=\\\"esh-link-item\\\">Edit </\", \"a> | <a runat=\\\"server\\\" href=\\\"~\\\" class=\\\"esh-link-item\\\">Back to list </a> </div> </div> </asp:Content>\", \"\\n```\\n\\nThe preceding markup's code -behind includes the following code:\\n\\n```\\nusing eShopLegacyWebForm\", \"s.Models; using eShopLegacyWebForms.Services; using log4net; using System; using System.Web.UI; name\", \"space eShopLegacyWebForms.Catalog { public partial class Details : System.Web.UI.Page { private stat\", \"ic readonly ILog _log = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().Declari\", \"ngType); protected CatalogItem product; public ICatalogService CatalogService { get ; set ; } protec\", \"ted void Page_Load(object sender, EventArgs e) { var productId = Convert.ToInt32(Page.RouteData.Valu\", \"es[\\\"id\\\"]); _log.Info($\\\"Now loading... /Catalog/Details.aspx?id={productId}\\\"); product = CatalogServi\", \"ce.FindCatalogItem(productId); this .DataBind(); } } }\\n```\\n\\nWhen converted to Blazor, the Web Forms \", \"page translates to the following code:\\n\\n```\\n@page \\\"/Catalog/Details/{id:int}\\\" @inject ICatalogServic\", \"e CatalogService @inject ILogger<Details> Logger <h2 class=\\\"esh-body-title\\\">Details</h2> <div class=\", \"\\\"container\\\"> <div class=\\\"row\\\">\\n```\\n\\n```\\n<img class=\\\"col-md-6 esh-picture\\\" src=\\\"@($\\\"/Pics/{_item.Pict\", \"ureFileName}\\\")\\\"> <dl class=\\\"col-md-6 dl-horizontal\\\"> <dt> Name </dt> <dd> @_item.Name </dd> <dt> Des\", \"cription </dt> <dd> @_item.Description </dd> <dt> Brand </dt> <dd> @_item.CatalogBrand.Brand </dd> <\", \"dt> Type </dt> <dd> @_item.CatalogType.Type </dd> <dt> Price </dt> <dd> @_item.Price </dd> <dt> Pict\", \"ure name </dt> <dd> @_item.PictureFileName </dd> <dt> Stock </dt> <dd> @_item.AvailableStock </dd> <\", \"dt> Restock </dt>\\n```\\n\\n```\\n<dd> @_item.RestockThreshold </dd> <dt> Max stock </dt> <dd> @_item.MaxSt\", \"ockThreshold </dd> </dl> </div> <div class=\\\"form-actions no-color esh-link-list\\\"> <a href=\\\"@($\\\"/Cata\", \"log/Edit/{_item.Id}\\\")\\\" class=\\\"esh-link-item\\\"> Edit </a> | <a href=\\\"/\\\" class=\\\"esh-link-item\\\"> Back to\", \" list </a> </div> </div> @code { private CatalogItem _item; [Parameter] public int Id { get; set; } \", \"protected override void OnInitialized() { Logger.LogInformation(\\\"Now loading... /Catalog/Details/{Id\", \"}\\\", Id); _item = CatalogService.FindCatalogItem(Id); } }\\n```\\n\\nNotice that the code and markup are in\", \" the same file. Any required services are made accessible with the @inject attribute. Per the @page \", \"directive, this page can be accessed at the Catalog/Details/{id} route. The value of the route's {id\", \"} placeholder has been constrained to an integer. As described in the routing section, unlike Web Fo\", \"rms, a Razor component explicitly states its route and any parameters that are included. Many Web Fo\", \"rms controls may not have exact counterparts in Blazor. There's often an equivalent HTML snippet tha\", \"t will serve the same purpose. For example, the &lt;asp:Label /&gt; control can be replaced with an \", \"HTML &lt;label&gt; element.\\n\\n## Model validation in Blazor\\n\\nIf your Web Forms code includes validati\", \"on, you can transfer much of what you have with little-to-no changes. A benefit to running in Blazor\", \" is that the same validation logic can be run without needing custom JavaScript. Data annotations en\", \"able easy model validation.\\n\\nFor example, the Create.aspx page has a data entry form with validation\", \". An example snippet would look like this:\\n\\n```\\n< div class =\\\"form-group\\\"> < label class =\\\"control-l\", \"abel col-md-2\\\">Name</ label > < div class =\\\"col-md-3\\\"> < asp:TextBox ID =\\\"Name\\\" runat =\\\"server\\\" CssC\", \"lass =\\\"form-control\\\"></ asp:TextBox > < asp:RequiredFieldValidator runat =\\\"server\\\" ControlToValidate\", \" =\\\"Name\\\" Display =\\\"Dynamic\\\" CssClass=\\\"field-validation-valid text-danger\\\" ErrorMessage =\\\"The Name fi\", \"eld is required.\\\" /> </ div > </ div >\\n```\\n\\nIn Blazor, the equivalent markup is provided in a Create\", \".razor file:\\n\\n```\\n<EditForm Model=\\\"_item\\\" OnValidSubmit=\\\"@...\\\"> <DataAnnotationsValidator /> <div cl\", \"ass=\\\"form-group\\\"> <label class=\\\"control-label col-md-2\\\">Name</label> <div class=\\\"col-md-3\\\"> <InputTe\", \"xt class=\\\"form-control\\\" @bind-Value=\\\"_item.Name\\\" /> <ValidationMessage For=\\\"(() => _item.Name)\\\" /> <\", \"/div> </div> ... </EditForm>\\n```\\n\\nThe EditForm context includes validation support and can be wrappe\", \"d around an input. Data annotations are a common way to add validation. Such validation support can \", \"be added via the DataAnnotationsValidator component. For more information on this mechanism, see ASP\", \".NET Core Blazor forms and validation.\\n\\n## Migrate configuration\\n\\nIn a Web Forms project, configurat\", \"ion data is most commonly stored in the web.config file. The configuration data is accessed with Con\", \"figurationManager. Services were often required to parse objects. With .NET Framework 4.7.2, composa\", \"bility was added to the configuration via ConfigurationBuilders. These builders allowed developers t\", \"o add various sources for the configuration that was then composed at run time to retrieve the neces\", \"sary values.\\n\\nASP.NET Core introduced a flexible configuration system that allows you to define the \", \"configuration source or sources used by your app and deployment. The ConfigurationBuilder infrastruc\", \"ture that you may be using in your Web Forms app was modeled after the concepts used in the ASP.NET \", \"Core configuration system.\\n\\nThe following snippet demonstrates how the Web Forms eShop project uses \", \"web.config to store configuration values:\\n\\n```\\n< configuration > < configSections > < section name=\\\"\", \"entityFramework\\\"\\n```\\n\\n```\\ntype=\\\"System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, Entit\", \"yFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\\\" requirePermission=\\\"fa\", \"lse\\\" /> </ configSections > < connectionStrings > < add name=\\\"CatalogDBContext\\\" connectionString=\\\"Da\", \"ta Source=(localdb)\\\\MSSQLLocalDB; Initial Catalog=Microsoft.eShopOnContainers.Services.CatalogDb; In\", \"tegrated Security=True; MultipleActiveResultSets=True;\\\" providerName=\\\"System.Data.SqlClient\\\" /> </ c\", \"onnectionStrings > < appSettings > < add key=\\\"UseMockData\\\" value=\\\"true\\\" /> < add key=\\\"UseCustomizati\", \"onData\\\" value=\\\"false\\\" /> </ appSettings > </ configuration >\\n```\\n\\nIt's common for secrets, such as d\", \"atabase connection strings, to be stored within the web.config . The secrets are inevitably persiste\", \"d in unsecure locations, such as source control. With Blazor on ASP.NET Core, the preceding XML-base\", \"d configuration is replaced with the following JSON:\\n\\n```\\n{ \\\"ConnectionStrings\\\": { \\\"CatalogDBContext\", \"\\\": \\\"Data Source=(localdb)\\\\\\\\MSSQLLocalDB; Initial Catalog=Microsoft.eShopOnContainers.Services.Catalo\", \"gDb; Integrated Security=True; MultipleActiveResultSets=True;\\\" }, \\\"UseMockData\\\": true , \\\"UseCustomiz\", \"ationData\\\": false }\\n```\\n\\nJSON is the default configuration format; however, ASP.NET Core supports ma\", \"ny other formats, including XML. There are also several community-supported formats.\\n\\nYou can access\", \" configuration values from the builder in Program.cs :\\n\\n```\\nif (builder.Configuration.GetValue<bool>\", \"(\\\"UseMockData\\\")) { builder.Services.AddSingleton<ICatalogService, CatalogServiceMock>(); } else { bu\", \"ilder.Services.AddScoped<ICatalogService, CatalogService>(); builder.Services.AddScoped<IDatabaseIni\", \"tializer<CatalogDBContext>, CatalogDBInitializer>(); builder.Services.AddSingleton<CatalogItemHiLoGe\", \"nerator>(); builder.Services.AddScoped(_ => new CatalogDBContext(builder.Configuration.GetConnection\", \"String(\\\"CatalogDBContext\\\"))); }\\n```\\n\\nBy default, environment variables, JSON files ( appsettings.jso\", \"n and appsettings.{Environment}.json ), and command-line options are registered as valid configurati\", \"on sources in the configuration object. The configuration sources can be accessed via Configuration[\", \"key]. A more advanced technique is to bind the configuration data to objects using the options patte\", \"rn. For more information on configuration and the options pattern, see Configuration in ASP.NET Core\", \" and Options pattern in ASP.NET Core, respectively.\\n\\n## Migrate data access\\n\\nData access is an impor\", \"tant aspect of any app. The eShop project stores catalog information in a database and retrieves the\", \" data with Entity Framework (EF) 6. Since EF 6 is supported in .NET 5, the project can continue to u\", \"se it.\\n\\nThe following EF-related changes were necessary to eShop:\\n\\n- In .NET Framework, the DbContex\", \"t object accepts a string of the form name=ConnectionString and uses the connection string from Conf\", \"igurationManager.AppSettings[ConnectionString] to connect. In .NET Core, this isn't supported. The c\", \"onnection string must be supplied.\\n- The database was accessed in a synchronous way. Though this wor\", \"ks, scalability may suffer. This logic should be moved to an asynchronous pattern.\\n\\nAlthough there i\", \"sn't the same native support for dataset binding, Blazor provides flexibility and power with its C# \", \"support in a Razor page. For example, you can perform calculations and display the result. For more \", \"information on data patterns in Blazor, see the Data access chapter.\\n\\n## Architectural changes\\n\\nFina\", \"lly, there are some important architectural differences to consider when migrating to Blazor. Many o\", \"f these changes are applicable to anything based on .NET Core or ASP.NET Core.\\n\\nBecause Blazor is bu\", \"ilt on .NET Core, there are considerations in ensuring support on .NET Core. Some of the major chang\", \"es include the removal of the following features:\\n\\n- Multiple AppDomains\\n- Remoting\\n- Code Access Se\", \"curity (CAS)\\n- Security Transparency\\n\\nFor more information on techniques to identify necessary chang\", \"es to support running on .NET Core, see Port your code from .NET Framework to .NET Core.\\n\\nASP.NET Co\", \"re is a reimagined version of ASP.NET and has some changes that may not initially seem obvious. The \", \"main changes are:\\n\\n- No synchronization context, which means there's no HttpContext.Current, Thread.\", \"CurrentPrincipal, or other static accessors\\n- No shadow copying\\n- No request queue\\n\\nMany operations \", \"in ASP.NET Core are asynchronous, which allows easier off-loading of I/O-bound tasks. It's important\", \" to never block by using Task.Wait() or Task.GetResult(), which can quickly exhaust thread pool reso\", \"urces.\\n\\n## Migration conclusion\\n\\nAt this point, you've seen many examples of what it takes to move a\", \" Web Forms project to Blazor. For a full example, see the eShopOnBlazor project.\"]"