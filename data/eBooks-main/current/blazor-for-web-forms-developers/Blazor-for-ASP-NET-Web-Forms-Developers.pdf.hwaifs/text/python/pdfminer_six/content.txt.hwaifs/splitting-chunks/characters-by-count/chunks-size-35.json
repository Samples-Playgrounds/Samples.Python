"[\" \\n\\fEDITION v8.0 - Updated to .NET 8 \\n\\nRefer to changelog for the book updates and community contribu\", \"tions. \\n\\nPUBLISHED BY \\n\\nMicrosoft Developer Division, .NET, and Visual Studio product teams \\n\\nA divi\", \"sion of Microsoft Corporation \\n\\nOne Microsoft Way \\n\\nRedmond, Washington 98052-6399 \\n\\nCopyright \\u00a9 202\", \"3 by Microsoft Corporation \\n\\nAll rights reserved. No part of the contents of this book may be reprod\", \"uced or transmitted in any \\nform or by any means without the written permission of the publisher. \\n\\n\", \"This book is provided \\u201cas-is\\u201d and expresses the author\\u2019s views and opinions. The views, opinions, an\", \"d \\ninformation expressed in this book, including URL and other Internet website references, may chan\", \"ge \\nwithout notice. \\n\\nSome examples depicted herein are provided for illustration only and are ficti\", \"tious. No real association \\nor connection is intended or should be inferred. \\n\\nMicrosoft and the tra\", \"demarks listed at https://www.microsoft.com on the \\u201cTrademarks\\u201d webpage are \\ntrademarks of the Micro\", \"soft group of companies. \\n\\nMac and macOS are trademarks of Apple Inc. \\n\\nAll other marks and logos ar\", \"e property of their respective owners. \\n\\nAuthors: \\n\\nDaniel Roth, Principal Program Manager, Microsof\", \"t Corp. \\n\\nJeff Fritz, Senior Program Manager, Microsoft Corp. \\n\\nTaylor Southwick, Senior Software En\", \"gineer, Microsoft Corp. \\n\\nScott Addie, Senior Content Developer, Microsoft Corp. \\n\\nSteve \\u201c@ardalis\\u201d \", \"Smith, Software Architect and Trainer, NimblePros.com \\n\\nIntroduction \\n\\n.NET has long supported web a\", \"pp development through ASP.NET, a comprehensive set of frameworks \\nand tools for building any kind o\", \"f web app. ASP.NET has its own lineage of web frameworks and \\ntechnologies starting all the way back\", \" with classic Active Server Pages (ASP). Frameworks like ASP.NET \\nWeb Forms, ASP.NET MVC, ASP.NET We\", \"b Pages, and more recently ASP.NET Core, provide a \\nproductive and powerful way to build server-rend\", \"ered web apps, where UI content is dynamically \\ngenerated on the server in response to HTTP requests\", \". Each ASP.NET framework caters to a different \\naudience and app building philosophy. ASP.NET Web Fo\", \"rms shipped with the original release of the \\n.NET Framework and enabled web development using many \", \"of the patterns familiar to desktop \\n\\n\\fdevelopers, like reusable UI controls with simple event handl\", \"ing. However, none of the ASP.NET \\nofferings provide a way to run code that executed in the user\\u2019s b\", \"rowser. To do that requires writing \\nJavaScript and using any of the many JavaScript frameworks and \", \"tools that have phased in and out of \\npopularity over the years: jQuery, Knockout, Angular, React, a\", \"nd so on. \\n\\nBlazor is a new web framework that changes what is possible when building web apps with \", \".NET. \\nBlazor is a client-side web UI framework based on C# instead of JavaScript. With Blazor you c\", \"an write \\nyour client-side logic and UI components in C#, compile them into normal .NET assemblies, \", \"and then \\nrun them directly in the browser using a new open web standard called WebAssembly. Or \\nalt\", \"ernatively, Blazor can run your .NET UI components on the server and handle all UI interactions \\nflu\", \"idly over a real-time connection with the browser. When paired with .NET running on the server, \\nBla\", \"zor enables full-stack web development with .NET. While Blazor shares many commonalities with \\nASP.N\", \"ET Web Forms, like having a reusable component model and a simple way to handle user \\nevents, it als\", \"o builds on the foundations of .NET to provide a modern and high-performance web \\ndevelopment experi\", \"ence. \\n\\nThis book introduces ASP.NET Web Forms developers to Blazor in a way that is familiar and \\nc\", \"onvenient. It introduces Blazor concepts in parallel with analogous concepts in ASP.NET Web Forms \\nw\", \"hile also explaining new concepts that may be less familiar. It covers a broad range of topics and \\n\", \"concerns including component authoring, routing, layout, configuration, and security. And while the \", \"\\ncontent of this book is primarily for enabling new development, it also covers guidelines and \\nstra\", \"tegies for migrating existing ASP.NET Web Forms to Blazor for when you want to modernize an \\nexistin\", \"g app. \\n\\nWho should use the book \\n\\nThis book is for ASP.NET Web Forms developers looking for an intr\", \"oduction to Blazor that relates to \\ntheir existing knowledge and skills. This book can help with qui\", \"ckly getting started on a new Blazor-\\nbased project or to help chart a roadmap for modernizing an ex\", \"isting ASP.NET Web Forms \\napplication. \\n\\nHow to use the book \\n\\nThe first part of this book covers wh\", \"at Blazor is and compares it to web app development with \\nASP.NET Web Forms. The book then covers a \", \"variety of Blazor topics, chapter by chapter, and relates \\neach Blazor concept to the corresponding \", \"concept in ASP.NET Web Forms, or explains fully any \\ncompletely new concepts. The book also refers r\", \"egularly to a complete sample app implemented in \\nboth ASP.NET Web Forms and Blazor to demonstrate B\", \"lazor features and to provide a case study for \\nmigrating from ASP.NET Web Forms to Blazor. You can \", \"find both implementations of the sample app \\n(ASP.NET Web Forms and Blazor versions) on GitHub. \\n\\nWh\", \"at this book doesn\\u2019t cover \\n\\nThis book is an introduction to Blazor, not a comprehensive migration g\", \"uide. While it does include \\nguidance on how to approach migrating a project from ASP.NET Web Forms \", \"to Blazor, it does not \\n\\n\\fattempt to cover every nuance and detail. For more general guidance on mig\", \"rating from ASP.NET to \\nASP.NET Core, refer to the migration guidance in the ASP.NET Core documentat\", \"ion. \\n\\nAdditional resources \\n\\nYou can find the official Blazor home page and documentation at https:\", \"//blazor.net. \\n\\n\\fContents \\n\\nAn introduction to Blazor for ASP.NET Web Forms developers .............\", \"........................... 1 \\n\\nAn open-source and cross-platform .NET .............................\", \"........................................................................................ 2 \\n\\nClient-\", \"side web development ...............................................................................\", \".............................................................. 3 \\n\\nWebAssembly fulfills a need .....\", \"....................................................................................................\", \"...................................... 3 \\n\\nBlazor: full-stack web development with .NET ............\", \"................................................................................................. 4 \", \"\\n\\nGet started with Blazor ..........................................................................\", \"................................................................................ 4 \\n\\nArchitecture co\", \"mparison of ASP.NET Web Forms and Blazor ............................................ 5 \\n\\nASP.NET We\", \"b Forms ............................................................................................\", \"................................................................... 5 \\n\\nBlazor .....................\", \"....................................................................................................\", \"................................................................... 6 \\n\\nBlazor app hosting models ..\", \"................................................................................................... \", \"8 \\n\\nBlazor WebAssembly apps ........................................................................\", \"........................................................................... 8 \\n\\nBlazor Server apps .\", \"....................................................................................................\", \".............................................................. 9 \\n\\nHow to choose the right Blazor ho\", \"sting model ........................................................................................\", \"............... 10 \\n\\nDeploy your app ...............................................................\", \"....................................................................................................\", \". 11 \\n\\nProject structure for Blazor apps ...........................................................\", \".............................. 12 \\n\\nProject file ...................................................\", \"....................................................................................................\", \"......................... 12 \\n\\nEntry point .........................................................\", \"....................................................................................................\", \".................. 13 \\n\\nStatic files ...............................................................\", \"....................................................................................................\", \".............. 15 \\n\\nConfiguration...................................................................\", \"....................................................................................................\", \"... 15 \\n\\nRazor components ..........................................................................\", \"..................................................................................... 15 \\n\\nPages ...\", \"....................................................................................................\", \"................................................................................... 16 \\n\\nLayout ....\", \"....................................................................................................\", \"................................................................................ 16 \\n\\nBootstrap Blaz\", \"or .................................................................................................\", \"................................................................... 16 \\n\\nBuild output ..............\", \"....................................................................................................\", \".......................................................... 18 \\n\\nRun the app with Hot Reload.........\", \"....................................................................................................\", \".............................. 18 \\n\\nApp startup ....................................................\", \"........................................................................ 21 \\n\\nApplication_Start and \", \"Web Forms ..........................................................................................\", \"....................................... 21 \\n\\nBlazor Server Startup Structure .......................\", \"....................................................................................................\", \"............ 21 \\n\\ni \\n\\nContents \\n\\n \\n \\n\\fUpgrading the BundleConfig Process ...........................\", \"............................................................................................... 23 \\n\", \"\\nBuild reusable UI components with Blazor...........................................................\", \".............. 24 \\n\\nAn introduction to Razor .......................................................\", \"............................................................................................ 24 \\n\\nUs\", \"e components .......................................................................................\", \"............................................................................ 28 \\n\\nModify page title \", \"from components ....................................................................................\", \"......................................... 28 \\n\\nComponent parameters ................................\", \"....................................................................................................\", \"................. 29 \\n\\nQuery string parameters .....................................................\", \".......................................................................................... 29 \\n\\nComp\", \"onents and error boundaries ........................................................................\", \"....................................................... 30 \\n\\nEvent handlers ........................\", \"....................................................................................................\", \"............................................ 30 \\n\\nData binding .....................................\", \"....................................................................................................\", \".................................. 32 \\n\\nState changes ..............................................\", \"....................................................................................................\", \"....................... 33 \\n\\nComponent lifecycle ...................................................\", \"....................................................................................................\", \"..... 34 \\n\\nOnInitialized ...........................................................................\", \"............................................................................................ 34 \\n\\nOn\", \"ParametersSet ......................................................................................\", \"....................................................................... 35 \\n\\nOnAfterRender .........\", \"....................................................................................................\", \"..................................................... 35 \\n\\nIDisposable .............................\", \"....................................................................................................\", \"........................................ 35 \\n\\nCapture component references .........................\", \"....................................................................................................\", \"......... 36 \\n\\nCapture element references ..........................................................\", \"................................................................................... 36 \\n\\nTemplated c\", \"omponents ..........................................................................................\", \"........................................................... 36 \\n\\nChild content......................\", \"....................................................................................................\", \"............................................ 37 \\n\\nTemplate parameters ..............................\", \"....................................................................................................\", \".................... 37 \\n\\nCode-behind ..............................................................\", \"....................................................................................................\", \"......... 38 \\n\\nAdditional resources ................................................................\", \"............................................................................................ 39 \\n\\nPa\", \"ges, routing, and layouts ..........................................................................\", \"........................ 40 \\n\\nCreate pages .........................................................\", \"....................................................................................................\", \".............. 41 \\n\\nRouter component ...............................................................\", \"................................................................................................ 42 \", \"\\n\\nNavigation .......................................................................................\", \"........................................................................................ 42 \\n\\nBase U\", \"RLs ................................................................................................\", \"................................................................................. 43 \\n\\nPage layout .\", \"....................................................................................................\", \"......................................................................... 43 \\n\\nState management ....\", \"....................................................................................................\", \"........ 46 \\n\\nRequest state management with ViewState ..............................................\", \"................................................................ 46 \\n\\nii \\n\\nContents \\n\\n \\n\\fMaintain st\", \"ate with Session ...................................................................................\", \"........................................................... 47 \\n\\nApplication state .................\", \"....................................................................................................\", \".............................................. 47 \\n\\nIn the browser .................................\", \"....................................................................................................\", \"................................... 48 \\n\\nForms and validation ......................................\", \"...................................................................... 49 \\n\\nAdditional resources ...\", \"....................................................................................................\", \"..................................................... 51 \\n\\nWork with data ..........................\", \"............................................................................................ 52 \\n\\nEn\", \"tity Framework .....................................................................................\", \"............................................................................. 52 \\n\\nEF Code First....\", \"....................................................................................................\", \"............................................................... 53 \\n\\nEF Database First .............\", \"....................................................................................................\", \"............................................. 54 \\n\\nInteract with web services ......................\", \"....................................................................................................\", \"....................... 54 \\n\\nModules, handlers, and middleware .....................................\", \".............................................. 56 \\n\\nOverview .......................................\", \"....................................................................................................\", \"........................................ 56 \\n\\nKatana ...............................................\", \"....................................................................................................\", \"..................................... 57 \\n\\nCommon middleware .......................................\", \"....................................................................................................\", \"............... 57 \\n\\nCustom middleware .............................................................\", \"................................................................................................ 58 \", \"\\n\\nApp configuration ................................................................................\", \"................................. 60 \\n\\nConfiguration sources .......................................\", \"....................................................................................................\", \".............. 60 \\n\\nappsettings.json format and access .............................................\", \"................................................................................. 61 \\n\\nUser secrets \", \"....................................................................................................\", \"......................................................................... 61 \\n\\nEnvironment variables\", \" ...................................................................................................\", \"...................................................... 61 \\n\\nCommand-line arguments .................\", \"....................................................................................................\", \"........................... 62 \\n\\nThe return of web.config ..........................................\", \"....................................................................................................\", \"..... 62 \\n\\nRead configuration in the app ...........................................................\", \".............................................................................. 63 \\n\\nStrongly typed c\", \"onfiguration .......................................................................................\", \".................................................... 63 \\n\\nSecurity: Authentication and Authorization\", \" in ASP.NET Web Forms and Blazor ........... 65 \\n\\nASP.NET universal providers ......................\", \"....................................................................................................\", \"................... 65 \\n\\nAuthorization configuration in Web Forms ..................................\", \"......................................................................... 66 \\n\\nAuthorization code in\", \" Web Forms .........................................................................................\", \"................................... 67 \\n\\nASP.NET Core Identity .....................................\", \"....................................................................................................\", \"................ 68 \\n\\nRoles, claims, and policies ..................................................\", \".......................................................................................... 68 \\n\\nMigr\", \"ation guide ........................................................................................\", \"........................................................................ 70 \\n\\niii \\n\\nContents \\n\\n \\n\\fCr\", \"eating the ASP.NET Core Identity schema ............................................................\", \"............................................. 70 \\n\\nMigrating data from universal providers to ASP.NE\", \"T Core Identity ............................................................ 73 \\n\\nMigrating security\", \" settings from web.config to app startup ...........................................................\", \"............... 74 \\n\\nUpdating individual pages to use ASP.NET Core Identity abstractions ...........\", \".......................................... 75 \\n\\nSummary ............................................\", \"....................................................................................................\", \".................................. 76 \\n\\nReferences .................................................\", \"....................................................................................................\", \".......................... 77 \\n\\nMigrate from ASP.NET Web Forms to Blazor ...........................\", \".......................................... 78 \\n\\nServer-side versus client-side hosting .............\", \"....................................................................................................\", \"......... 78 \\n\\nCreate a new project.................................................................\", \"........................................................................................... 79 \\n\\nEna\", \"ble startup process ................................................................................\", \"........................................................................ 80 \\n\\nMigrate HTTP modules a\", \"nd handlers to middleware ..........................................................................\", \".................. 83 \\n\\nMigrate static files .......................................................\", \"....................................................................................................\", \"..... 84 \\n\\nMigrate runtime bundling and minification setup .........................................\", \"......................................................... 84 \\n\\nMigrate ASPX pages ..................\", \"....................................................................................................\", \"...................................... 84 \\n\\nModel validation in Blazor .............................\", \"....................................................................................................\", \"........... 88 \\n\\nMigrate configuration .............................................................\", \"............................................................................................ 89 \\n\\nMi\", \"grate data access ..................................................................................\", \"........................................................................... 91 \\n\\nArchitectural chang\", \"es .................................................................................................\", \"......................................................... 91 \\n\\nMigration conclusion ................\", \"....................................................................................................\", \"....................................... 92 \\n\\niv \\n\\nContents \\n\\n \\n\\fCHAPTER  1 \\n\\nAn introduction to Blaz\", \"or \\nfor ASP.NET Web Forms \\ndevelopers \\n\\nThe ASP.NET Web Forms framework has been a staple of .NET we\", \"b development since the .NET \\nFramework first shipped in 2002. Back when the Web was still largely i\", \"n its infancy, ASP.NET Web \\nForms made building web apps simple and productive by adopting many of t\", \"he patterns that were \\nused for desktop development. In ASP.NET Web Forms, web pages can be quickly \", \"composed from \\nreusable UI controls. User interactions are handled naturally as events. There\\u2019s a ri\", \"ch ecosystem of \\nWeb Forms UI controls provided by Microsoft and control vendors. The controls ease \", \"the efforts of \\nconnecting to data sources and displaying rich data visualizations. For the visually\", \" inclined, the Web \\nForms designer provides a simple drag-and-drop interface for managing controls. \", \"\\n\\nOver the years, Microsoft has introduced new ASP.NET-based web frameworks to address web \\ndevelopm\", \"ent trends. Some such web frameworks include ASP.NET MVC, ASP.NET Web Pages, and \\nmore recently ASP.\", \"NET Core. With each new framework, some have predicted the imminent decline of \\nASP.NET Web Forms an\", \"d criticized it as an outdated, outmoded web framework. Despite these \\npredictions, many .NET web de\", \"velopers continue to find ASP.NET Web Forms a simple, stable, and \\nproductive way to get their work \", \"done. \\n\\nAt the time of writing, almost half a million web developers use ASP.NET Web Forms every mon\", \"th. The \\nASP.NET Web Forms framework is stable to the point that docs, samples, books, and blog post\", \"s from \\na decade ago remain useful and relevant. For many .NET web developers, \\u201cASP.NET\\u201d is still \\ns\", \"ynonymous with \\u201cASP.NET Web Forms\\u201d as it was when .NET was first conceived. Arguments on the \\npros a\", \"nd cons of ASP.NET Web Forms compared to the other new .NET web frameworks may rage on. \\nASP.NET Web\", \" Forms remains a popular framework for creating web apps. \\n\\nEven so, innovations in software develop\", \"ment aren\\u2019t slowing. All software developers need to stay \\nabreast of new technologies and trends. T\", \"wo trends in particular are worth considering: \\n\\n1. \\n\\n2. \\n\\nThe shift to open-source and cross-platfo\", \"rm \\n\\nThe shift of app logic to the client \\n\\n1 \\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET We\", \"b Forms developers \\n\\n \\n \\n\\fAn open-source and cross-platform .NET \\n\\nWhen .NET and ASP.NET Web Forms f\", \"irst shipped, the platform ecosystem looked much different than \\nit does today. The desktop and serv\", \"er markets were dominated by Windows. Alternative platforms like \\nmacOS and Linux were still struggl\", \"ing to gain traction. ASP.NET Web Forms ships with the .NET \\nFramework as a Windows-only component, \", \"which means ASP.NET Web Forms apps can only run on \\nWindows Server machines. Many modern environment\", \"s now use different kinds of platforms for \\nservers and development machines such that cross-platfor\", \"m support for many users is an absolute \\nrequirement. \\n\\nMost modern web frameworks are now also open\", \"-source, which has a number of benefits. Users \\naren\\u2019t beheld to a single project owner to fix bugs \", \"and add features. Open-source projects provide \\nimproved transparency on development progress and up\", \"coming changes. Open-source projects enjoy \\ncontributions from an entire community, and they foster \", \"a supportive open-source ecosystem. \\nDespite the risks of open-source, many consumers and contributo\", \"rs have found suitable mitigations \\nthat enable them to enjoy the benefits of an open-source ecosyst\", \"em in a safe and reasonable way. \\nExamples of such mitigations include contributor license agreement\", \"s, friendly licenses, pedigree scans, \\nand supporting foundations. \\n\\nThe .NET community has embraced\", \" both cross-platform support and open-source. .NET Core is an \\nopen-source and cross-platform implem\", \"entation of .NET that runs on a plethora of platforms, \\nincluding Windows, macOS, and various Linux \", \"distributions. Xamarin provides Mono, an open-source \\nversion of .NET. Mono runs on Android, iOS, an\", \"d a variety of other form factors, including watches \\nand smart TVs. In 2020, Microsoft released .NE\", \"T 5 that reconciled .NET Core and Mono into \\u201ca single \\n.NET runtime and framework that can be used e\", \"verywhere and that has uniform runtime behaviors \\nand developer experiences.\\u201d \\n\\nWill ASP.NET Web For\", \"ms benefit from the move to open-source and cross-platform support? The \\nanswer, unfortunately, is n\", \"o, or at least not to the same extent as the rest of the platform. The .NET \\nteam made it clear that\", \" ASP.NET Web Forms won\\u2019t be ported to .NET Core or .NET 8. Why is that? \\n\\nThere were efforts in the \", \"early days of .NET Core to port ASP.NET Web Forms. The number of breaking \\nchanges required were fou\", \"nd to be too drastic. There\\u2019s also an admission here that even for Microsoft, \\nthere\\u2019s a limit to th\", \"e number of web frameworks that it can support simultaneously. Perhaps someone \\nin the community wil\", \"l take up the cause of creating an open-source and cross-platform version of \\nASP.NET Web Forms. The\", \" source code for ASP.NET Web Forms has been made available publicly in \\nreference form. But for the \", \"time being, it seems ASP.NET Web Forms will remain Windows-only and \\nwithout an open-source contribu\", \"tion model. If cross-platform support or open-source become \\nimportant for your scenarios, then you\\u2019\", \"ll need to look for something new. \\n\\nDoes this mean ASP.NET Web Forms is dead and should no longer b\", \"e used? Of course not! As long as \\nthe .NET Framework ships as part of Windows, ASP.NET Web Forms wi\", \"ll be a supported framework. \\nFor many Web Forms developers, the lack of cross-platform and open-sou\", \"rce support is a non-issue. \\nIf you don\\u2019t have a requirement for cross-platform support, open-source\", \", or any of the other new \\nfeatures in .NET Core or .NET 8, then sticking with ASP.NET Web Forms on \", \"Windows is fine. ASP.NET \\nWeb Forms will continue to be a productive way to write web apps for many \", \"years to come. \\n\\nBut there\\u2019s another trend worth considering, and that\\u2019s the shift to the client. \\n\\n\", \"2 \\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET Web Forms developers \\n\\n \\n \\n\\fClient-side web de\", \"velopment \\n\\nAll of the .NET-based web frameworks, including ASP.NET Web Forms, have historically had\", \" one thing \\nin common: they\\u2019re server-rendered. In server-rendered web apps, the browser makes a req\", \"uest to the \\nserver, which executes some code (.NET code in ASP.NET apps) to produce a response. Tha\", \"t response \\nis sent back to the browser to handle. In this model, the browser is used as a thin rend\", \"ering engine. \\nThe hard work of producing the UI, running the business logic, and managing state occ\", \"urs on the \\nserver. \\n\\nHowever, browsers have become versatile platforms. They implement an ever-incr\", \"easing number of \\nopen web standards that grant access to the capabilities of the user\\u2019s machine. Wh\", \"y not take \\nadvantage of the compute power, storage, memory, and other resources of the client devic\", \"e? UI \\ninteractions in particular can benefit from a richer and more interactive feel when handled a\", \"t least \\npartially or completely client-side. Logic and data that should be handled on the server ca\", \"n still be \\nhandled server-side. Web API calls or even real-time protocols, like WebSockets, can be \", \"used. These \\nbenefits are available to web developers for free if they\\u2019re willing to write JavaScrip\", \"t. Client-side UI \\nframeworks, such as Angular, React, and Vue, simplify client-side web development\", \" and have grown in \\npopularity. ASP.NET Web Forms developers can also benefit from leveraging the cl\", \"ient, and even have \\nsome out-of-the-box support with integrated JavaScript frameworks like ASP.NET \", \"AJAX. \\n\\nBut bridging two different platforms and ecosystems (.NET and JavaScript) comes with a cost.\", \" \\nExpertise is required in two parallel worlds with different languages, frameworks, and tools. Code\", \" and \\nlogic can\\u2019t be easily shared between client and server, resulting in duplication and engineeri\", \"ng \\noverhead. It can also be difficult to keep up with the JavaScript ecosystem, which has a history\", \" of \\nevolving at breakneck speed. Front-end framework and build tool preferences change quickly. The\", \" \\nindustry has observed the progression from Grunt to Gulp to Webpack, and so on. The same restless \", \"\\nchurn has occurred with front-end frameworks such as jQuery, Knockout, Angular, React, and Vue. But\", \" \\ngiven JavaScript\\u2019s browser monopoly, there was little choice in the matter. That is, until the web\", \" \\ncommunity got together and caused a miracle to happen! \\n\\nWebAssembly fulfills a need \\n\\nIn 2015, th\", \"e major browser vendors joined forces in a W3C Community Group to create a new open \\nweb standard ca\", \"lled WebAssembly. WebAssembly is a byte code for the Web. If you can compile your \\ncode to WebAssemb\", \"ly, it can then run on any browser on any platform at near native speed. Initial \\nefforts focused on\", \" C/C++. The result was a dramatic demonstration of running native 3D graphics \\nengines directly in t\", \"he browser without plugins. WebAssembly has since been standardized and \\nimplemented by all major br\", \"owsers. \\n\\nWork on running .NET on WebAssembly was announced in late 2017 and released in 2020, inclu\", \"ding \\nsupport in .NET 5 and beyond. The ability to run .NET code directly in the browser enables ful\", \"l-stack \\nweb development with .NET. \\n\\n3 \\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET Web Form\", \"s developers \\n\\n \\n \\n\\fBlazor: full-stack web development with .NET \\n\\nOn its own, the ability to run .N\", \"ET code in a browser doesn\\u2019t provide an end-to-end experience for \\ncreating client-side web apps. Th\", \"at\\u2019s where Blazor comes in. Blazor is a client-side web UI framework \\nbased on C# instead of JavaScr\", \"ipt. Blazor can run directly in the browser via WebAssembly. No \\nbrowser plugins are required. Alter\", \"natively, Blazor apps can run server-side on .NET and handle all \\nuser interactions over a real-time\", \" connection with the browser. \\n\\nBlazor has great tooling support in Visual Studio and Visual Studio \", \"Code. The framework also includes \\na full UI component model and has built-in facilities for: \\n\\n\\u2022 \\n\\n\", \"\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nForms and validation \\n\\nDependency injection \\n\\nClient-side routing \\n\\nLayouts \\n\\nIn\", \"-browser debugging \\n\\nJavaScript interop \\n\\nBlazor has a lot in common with ASP.NET Web Forms. Both fr\", \"ameworks offer component-based, \\nevent-driven, stateful UI programming models. The main architectura\", \"l difference is that ASP.NET Web \\nForms runs only on the server. Blazor can run on the client in the\", \" browser. But if you\\u2019re coming from \\nan ASP.NET Web Forms background, there\\u2019s a lot in Blazor that w\", \"ill feel familiar. Blazor is a natural \\nsolution for ASP.NET Web Forms developers looking for a way \", \"to take advantage of client-side \\ndevelopment and the open-source, cross-platform future of .NET. \\n\\n\", \"This book provides an introduction to Blazor that is catered specifically to ASP.NET Web Forms \\ndeve\", \"lopers. Each Blazor concept is presented in the context of analogous ASP.NET Web Forms \\nfeatures and\", \" practices. By the end of this book, you\\u2019ll have an understanding of: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nHow to build\", \" Blazor apps. \\n\\nHow Blazor works. \\n\\nHow Blazor relates to .NET. \\n\\nReasonable strategies for migratin\", \"g existing ASP.NET Web Forms apps to Blazor where \\nappropriate. \\n\\nGet started with Blazor \\n\\nGetting \", \"started with Blazor is easy. Go to https://blazor.net and follow the links to install the \\nappropria\", \"te .NET SDK and Blazor project templates. You\\u2019ll also find instructions for setting up the \\nBlazor t\", \"ooling in Visual Studio or Visual Studio Code. \\n\\n4 \\n\\nCHAPTER 1 | An introduction to Blazor for ASP.N\", \"ET Web Forms developers \\n\\n \\n \\n\\fCHAPTER  2 \\n\\nArchitecture comparison \\nof ASP.NET Web Forms \\nand Blazo\", \"r \\n\\nWhile ASP.NET Web Forms and Blazor have many similar concepts, there are differences in how they\", \" \\nwork. This chapter examines the inner workings and architectures of ASP.NET Web Forms and Blazor. \", \"\\n\\nASP.NET Web Forms \\n\\nThe ASP.NET Web Forms framework is based on a page-centric architecture. Each \", \"HTTP request for a \\nlocation in the app is a separate page with which ASP.NET responds. As pages are\", \" requested, the \\ncontents of the browser are replaced with the results of the page requested. \\n\\nPage\", \"s consist of the following components: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nHTML markup \\n\\nC# or Visual Basic code \\n\\nA c\", \"ode-behind class containing logic and event-handling capabilities \\n\\nControls \\n\\nControls are reusable\", \" units of web UI that can be programmatically placed and interacted with on a \\npage. Pages are compo\", \"sed of files that end with .aspx containing markup, controls, and some code. \\nThe code-behind classe\", \"s are in files with the same base name and an .aspx.cs or .aspx.vb extension, \\ndepending on the prog\", \"ramming language used. Interestingly, the web server interprets contents of \\nthe .aspx files and com\", \"piles them whenever they change. This recompilation occurs even if the web \\nserver is already runnin\", \"g. \\n\\nControls can be built with markup and delivered as user controls. A user control derives from t\", \"he \\nUserControl class and has a similar structure to the Page. Markup for user controls is stored in\", \" an .ascx \\nfile. An accompanying code-behind class resides in an .ascx.cs or .ascx.vb file. Controls\", \" can also be \\nbuilt completely with code, by inheriting from either the WebControl or CompositeContr\", \"ol base class. \\n\\nPages also have an extensive event lifecycle. Each page raises events for the initi\", \"alization, load, \\nprerender, and unload events that occur as the ASP.NET runtime executes the page\\u2019s\", \" code for each \\nrequest. \\n\\n5 \\n\\nCHAPTER 2 | Architecture comparison of ASP.NET Web Forms and Blazor \\n\", \"\\n \\n \\n\\fControls on a Page typically post-back to the same page that presented the control, and carry \", \"along \\nwith them a payload from a hidden form field called ViewState. The ViewState field contains \\n\", \"information about the state of the controls at the time they were rendered and presented on the \\npag\", \"e, allowing the ASP.NET runtime to compare and identify changes in the content submitted to the \\nser\", \"ver. \\n\\nBlazor \\n\\nBlazor is a client-side web UI framework similar in nature to JavaScript front-end f\", \"rameworks like \\nAngular or React. Blazor handles user interactions and renders the necessary UI upda\", \"tes. Blazor isn\\u2019t \\nbased on a request-reply model. User interactions are handled as events that aren\", \"\\u2019t in the context of \\nany particular HTTP request. \\n\\nBlazor apps consist of one or more root compone\", \"nts that are rendered on an HTML page. \\n\\nHow the user specifies where components should render and h\", \"ow the components are then wired up \\nfor user interactions is hosting model specific. \\n\\nBlazor compo\", \"nents are .NET classes that represent a reusable piece of UI. Each component maintains \\nits own stat\", \"e and specifies its own rendering logic, which can include rendering other components. \\nComponents s\", \"pecify event handlers for specific user interactions to update the component\\u2019s state. \\n\\nAfter a comp\", \"onent handles an event, Blazor renders the component and keeps track of what changed \\nin the rendere\", \"d output. Components don\\u2019t render directly to the Document Object Model (DOM). \\nThey instead render \", \"to an in-memory representation of the DOM called a RenderTree so that Blazor \\ncan track the changes.\", \" Blazor compares the newly rendered output with the previous output to \\ncalculate a UI diff that it \", \"then applies efficiently to the DOM. \\n\\n6 \\n\\nCHAPTER 2 | Architecture comparison of ASP.NET Web Forms \", \"and Blazor \\n\\n \\n \\n \\n\\fComponents can also manually indicate that they should be rendered if their stat\", \"e changes outside of \\na normal UI event. Blazor uses a SynchronizationContext to enforce a single lo\", \"gical thread of \\nexecution. A component\\u2019s lifecycle methods and any event callbacks that are raised \", \"by Blazor are \\nexecuted on this SynchronizationContext. \\n\\n7 \\n\\nCHAPTER 2 | Architecture comparison of\", \" ASP.NET Web Forms and Blazor \\n\\n \\n \\n \\n\\fCHAPTER  3 \\n\\nBlazor app hosting models \\n\\nBlazor apps can be h\", \"osted in one of the following ways: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nClient-side in the browser on WebAssembly. \\n\\nServer-si\", \"de in an ASP.NET Core app. \\n\\nBlazor WebAssembly apps \\n\\nBlazor WebAssembly apps execute directly in t\", \"he browser on a WebAssembly-based .NET runtime. \\nBlazor WebAssembly apps function in a similar way t\", \"o front-end JavaScript frameworks like Angular or \\nReact. However, instead of writing JavaScript you\", \" write C#. The .NET runtime is downloaded with the \\napp along with the app assembly and any required\", \" dependencies. No browser plugins or extensions \\nare required. \\n\\nThe downloaded assemblies are norma\", \"l .NET assemblies, like you would use in any other .NET app. \\nBecause the runtime supports .NET Stan\", \"dard, you can use existing .NET Standard libraries with your \\nBlazor WebAssembly app. However, these\", \" assemblies will still execute in the browser security \\nsandbox. Some functionality may throw a Plat\", \"formNotSupportedException, like trying to access the \\nfile system or opening arbitrary network conne\", \"ctions. \\n\\nWhen the app loads, the .NET runtime is started and pointed at the app assembly. The app s\", \"tartup \\nlogic runs, and the root components are rendered. Blazor calculates the UI updates based on \", \"the \\nrendered output from the components. The DOM updates are then applied. \\n\\n8 \\n\\nCHAPTER 3 | Blazor\", \" app hosting models \\n\\n \\n \\n\\fBlazor WebAssembly apps run purely client-side. Such apps can be deployed\", \" to static site hosting \\nsolutions like GitHub Pages or Azure Static Website Hosting. .NET isn\\u2019t req\", \"uired on the server at all. \\nDeep linking to parts of the app typically requires a routing solution \", \"on the server. The routing \\nsolution redirects requests to the root of the app. For example, this re\", \"direction can be handled using \\nURL rewrite rules in IIS. \\n\\nTo get all the benefits of Blazor and fu\", \"ll-stack .NET web development, host your Blazor WebAssembly \\napp with ASP.NET Core. By using .NET on\", \" both the client and server, you can easily share code and \\nbuild your app using one consistent set \", \"of languages, frameworks, and tools. Blazor provides \\nconvenient templates for setting up a solution\", \" that contains both a Blazor WebAssembly app and an \\nASP.NET Core host project. When the solution is\", \" built, the built static files from the Blazor app are \\nhosted by the ASP.NET Core app with fallback\", \" routing already setup. \\n\\nBlazor Server apps \\n\\nRecall from the Blazor architecture discussion that B\", \"lazor components render their output to an \\nintermediate abstraction called a RenderTree. The Blazor\", \" framework then compares what was \\nrendered with what was previously rendered. The differences are a\", \"pplied to the DOM. Blazor \\ncomponents are decoupled from how their rendered output is applied. Conse\", \"quently, the \\ncomponents themselves don\\u2019t have to run in the same process as the process updating th\", \"e UI. In fact, \\nthey don\\u2019t even have to run on the same machine. \\n\\nIn Blazor Server apps, the compon\", \"ents run on the server instead of client-side in the browser. UI \\nevents that occur in the browser a\", \"re sent to the server over a real-time connection. The events are \\ndispatched to the correct compone\", \"nt instances. The components render, and the calculated UI diff is \\nserialized and sent to the brows\", \"er where it\\u2019s applied to the DOM. \\n\\n9 \\n\\nCHAPTER 3 | Blazor app hosting models \\n\\n \\n \\n \\n\\fThe Blazor Se\", \"rver hosting model may sound familiar if you\\u2019ve used ASP.NET AJAX and the \\nUpdatePanel control. The \", \"UpdatePanel control handles applying partial page updates in response to \\ntrigger events on the page\", \". When triggered, the UpdatePanel requests a partial update and then \\napplies it without needing to \", \"refresh the page. The state of the UI is managed using ViewState. Blazor \\nServer apps are slightly d\", \"ifferent in that the app requires an active connection with the client. \\nAdditionally, all UI state \", \"is maintained on the server. Aside from those differences, the two models are \\nconceptually similar.\", \" \\n\\nHow to choose the right Blazor hosting model \\n\\nAs described in the Blazor hosting model docs, the\", \" different Blazor hosting models have different \\ntradeoffs. \\n\\nThe Blazor WebAssembly hosting model h\", \"as the following benefits: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nThere\\u2019s no .NET server-side dependency. The app is fully functi\", \"oning after downloaded to the \\nclient. \\n\\nClient resources and capabilities are fully leveraged. \\n\\n\\u2022 \", \" Work is offloaded from the server to the client. \\n\\n\\u2022 \\n\\nAn ASP.NET Core web server isn\\u2019t required to\", \" host the app. Serverless deployment scenarios \\nare possible (for example, serving the app from a CD\", \"N). \\n\\nThe downsides of the Blazor WebAssembly hosting model are: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n10 \\n\\nBrowser capabili\", \"ties restrict the app. \\n\\nCapable client hardware and software (for example, WebAssembly support) is \", \"required. \\n\\nDownload size is larger, and apps take longer to load. \\n\\nCHAPTER 3 | Blazor app hosting \", \"models \\n\\n \\n \\n \\n\\f\\u2022 \\n\\n.NET runtime and tooling support is less mature. For example, there are limitati\", \"ons in .NET \\nStandard support and debugging. \\n\\nConversely, the Blazor Server hosting model offers th\", \"e following benefits: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nDownload size is much smaller than a client-side app, an\", \"d the app loads much faster. \\n\\nThe app takes full advantage of server capabilities, including use of\", \" any .NET compatible APIs. \\n\\n.NET on the server is used to run the app, so existing .NET tooling, su\", \"ch as debugging, works \\nas expected. \\n\\nThin clients are supported. For example, server-side apps wor\", \"k with browsers that don\\u2019t \\nsupport WebAssembly and on resource-constrained devices. \\n\\nThe app\\u2019s .NE\", \"T/C# code base, including the app\\u2019s component code, isn\\u2019t served to clients. \\n\\nThe downsides to the \", \"Blazor Server hosting model are: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nHigher UI latency. Every user interaction involve\", \"s a network hop. \\n\\nThere\\u2019s no offline support. If the client connection fails, the app stops working\", \". \\n\\nScalability is challenging for apps with many users. The server must manage multiple client \\ncon\", \"nections and handle client state. \\n\\nAn ASP.NET Core server is required to serve the app. Serverless \", \"deployment scenarios aren\\u2019t \\npossible. For example, you can\\u2019t serve the app from a CDN. \\n\\nThe preced\", \"ing list of trade-offs may be intimidating, but your hosting model can be changed later. \\nRegardless\", \" of the Blazor hosting model selected, the component model is the same. In principle, the \\nsame comp\", \"onents can be used with either hosting model. Your app code doesn\\u2019t change; however, \\nit\\u2019s a good pr\", \"actice to introduce abstractions so that your components stay hosting model-agnostic. \\nThe abstracti\", \"ons allow your app to more easily adopt a different hosting model. \\n\\nDeploy your app \\n\\nASP.NET Web F\", \"orms apps are typically hosted on IIS on a Windows Server machine or cluster. Blazor \\napps can also:\", \" \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nBe hosted on IIS, either as static files or as an ASP.NET Core app. \\n\\nLeverage ASP.NET Co\", \"re\\u2019s flexibility to be hosted on various platforms and server \\ninfrastructures. For example, you can\", \" host a Blazor App using Nginx or Apache on Linux. For \\nmore information about how to publish and de\", \"ploy Blazor apps, see the Blazor Hosting and \\ndeployment documentation. \\n\\nIn the next section, we\\u2019ll\", \" look at how the projects for Blazor WebAssembly and Blazor Server apps are \\nset up. \\n\\n11 \\n\\nCHAPTER \", \"3 | Blazor app hosting models \\n\\n \\n \\n\\fCHAPTER  4 \\n\\nProject structure for Blazor \\napps \\n\\nDespite their\", \" significant project structure differences, ASP.NET Web Forms and Blazor share many \\nsimilar concept\", \"s. Here, we\\u2019ll look at the structure of a Blazor project and compare it to an ASP.NET \\nWeb Forms pro\", \"ject. \\n\\nTo create your first Blazor app, follow the instructions in the Blazor getting started steps\", \". You can \\nfollow the instructions to create either a Blazor Server app or a Blazor WebAssembly app \", \"hosted in \\nASP.NET Core. Except for the hosting model-specific logic, most of the code in both proje\", \"cts is the \\nsame. \\n\\nProject file \\n\\nBlazor Server apps are .NET projects. The project file for the Bl\", \"azor Server app is about as simple as it \\ncan get: \\n\\n<Project Sdk=\\\"Microsoft.NET.Sdk.Web\\\"> \\n\\n  <Prop\", \"ertyGroup> \\n    <TargetFramework>net8.0</TargetFramework> \\n  </PropertyGroup> \\n\\n</Project> \\nThe proj\", \"ect file for a Blazor WebAssembly app looks slightly more involved (exact version \\nnumbers may vary)\", \": \\n<Project Sdk=\\\"Microsoft.NET.Sdk.BlazorWebAssembly\\\"> \\n\\n  <PropertyGroup> \\n    <TargetFramework>net\", \"8.0</TargetFramework> \\n    <ImplicitUsings>enable</ImplicitUsings> \\n  </PropertyGroup> \\n\\n  <ItemGrou\", \"p> \\n    <PackageReference Include=\\\"Microsoft.AspNetCore.Components.WebAssembly\\\" Version=\\\"8.0.0\\\" \\n/> \", \"\\n    <PackageReference Include=\\\"Microsoft.AspNetCore.Components.WebAssembly.DevServer\\\" \\nVersion=\\\"8.0\", \".0\\\" PrivateAssets=\\\"all\\\" /> \\n  </ItemGroup> \\n\\n</Project> \\n\\n12 \\n\\nCHAPTER 4 | Project structure for Bla\", \"zor apps \\n\\n \\n \\n \\n \\n \\n \\n \\n\\fBlazor WebAssembly project targets Microsoft.NET.Sdk.BlazorWebAssembly ins\", \"tead of \\nMicrosoft.NET.Sdk.Web sdk because they run in the browser on a WebAssembly-based .NET runti\", \"me. \\nYou can\\u2019t install .NET into a web browser like you can on a server or developer machine. \\nConse\", \"quently, the project references the Blazor framework using individual package references. \\n\\nBy compa\", \"rison, a default ASP.NET Web Forms project includes almost 300 lines of XML in its .csproj \\nfile, mo\", \"st of which is explicitly listing the various code and content files in the project. Since the \\nrele\", \"ase of .NET 5, both Blazor Server and Blazor WebAssembly apps can easily share one unified \\nruntime.\", \" \\n\\nAlthough they\\u2019re supported, individual assembly references are less common in .NET projects. Most\", \" \\nproject dependencies are handled as NuGet package references. You only need to reference top-level\", \" \\npackage dependencies in .NET projects. Transitive dependencies are included automatically. Instead\", \" of \\nusing the packages.config file commonly found in ASP.NET Web Forms projects to reference packag\", \"es, \\npackage references are added to the project file using the <PackageReference> element. \\n\\n<ItemG\", \"roup> \\n  <PackageReference Include=\\\"Newtonsoft.Json\\\" Version=\\\"13.0.2\\\" /> \\n</ItemGroup> \\n\\nEntry point\", \" \\n\\nThe Blazor Server app\\u2019s entry point is defined in the Program.cs file, as you would see in a Cons\", \"ole \\napp. When the app executes, it creates and runs a web host instance using defaults specific to \", \"web \\napps. The web host manages the Blazor Server app\\u2019s lifecycle and sets up host-level services. \\n\", \"Examples of such services are configuration, logging, dependency injection, and the HTTP server. Thi\", \"s \\ncode is mostly boilerplate and is often left unchanged. \\n\\nusing BlazorApp3.Areas.Identity; \\nusing\", \" BlazorApp3.Data; \\nusing Microsoft.AspNetCore.Components.Authorization; \\nusing Microsoft.AspNetCore.\", \"Identity; \\nusing Microsoft.EntityFrameworkCore; \\n\\nvar builder = WebApplication.CreateBuilder(args); \", \"\\n\\n// Add services to the container. \\nvar connectionString = builder.Configuration.GetConnectionStrin\", \"g(\\\"DefaultConnection\\\"); \\nbuilder.Services.AddDbContext<ApplicationDbContext>(options => \\n    options\", \".UseSqlServer(connectionString)); \\nbuilder.Services.AddDatabaseDeveloperPageExceptionFilter(); \\nbuil\", \"der.Services.AddDefaultIdentity<IdentityUser>(options => \\noptions.SignIn.RequireConfirmedAccount = t\", \"rue) \\n    .AddEntityFrameworkStores<ApplicationDbContext>(); \\nbuilder.Services.AddRazorPages(); \\nbui\", \"lder.Services.AddServerSideBlazor(); \\nbuilder.Services.AddScoped<AuthenticationStateProvider, \\nReval\", \"idatingIdentityAuthenticationStateProvider<IdentityUser>>(); \\nbuilder.Services.AddSingleton<WeatherF\", \"orecastService>(); \\n\\nvar app = builder.Build(); \\n\\n// Configure the HTTP request pipeline. \\n\\n13 \\n\\nCHA\", \"PTER 4 | Project structure for Blazor apps \\n\\n \\n \\n \\n \\n \\n \\n\\fif (app.Environment.IsDevelopment()) \\n{ \\n \", \"   app.UseMigrationsEndPoint(); \\n} \\nelse \\n{ \\n    app.UseExceptionHandler(\\\"/Error\\\"); \\n    // The defa\", \"ult HSTS value is 30 days. You may want to change this for production \\nscenarios, see https://aka.ms\", \"/aspnetcore-hsts. \\n    app.UseHsts(); \\n} \\n\\napp.UseHttpsRedirection(); \\n\\napp.UseStaticFiles(); \\n\\napp.\", \"UseRouting(); \\n\\napp.UseAuthorization(); \\n\\napp.MapControllers(); \\napp.MapBlazorHub(); \\napp.MapFallbac\", \"kToPage(\\\"/_Host\\\"); \\n\\napp.Run(); \\n\\nBlazor WebAssembly apps also define an entry point in Program.cs. \", \"The code looks slightly different. \\nThe code is similar in that it\\u2019s setting up the app host to prov\", \"ide the same host-level services to the \\napp. The WebAssembly app host doesn\\u2019t, however, set up an H\", \"TTP server because it executes directly \\nin the browser. \\n\\nBlazor apps don\\u2019t use a Global.asax file \", \"to define the startup logic for the app. Instead, this logic is \\ncontained in Program.cs or in a rel\", \"ated Startup class that is referenced from Program.cs. Either way, \\nthis code is used to configure t\", \"he app and any app-specific services. \\n\\nIn a Blazor Server app, the Program.cs file shown is used to\", \" set up the endpoint for the real-time \\nconnection used by Blazor between the client browsers and th\", \"e server. \\n\\nIn a Blazor WebAssembly app, the Program.cs file defines the root components for the app\", \" and where \\nthey should be rendered: \\n\\nusing BlazorApp1; \\nusing Microsoft.AspNetCore.Components.Web;\", \" \\nusing Microsoft.AspNetCore.Components.WebAssembly.Hosting; \\n\\nvar builder = WebAssemblyHostBuilder.\", \"CreateDefault(args); \\nbuilder.RootComponents.Add<App>(\\\"#app\\\"); \\nbuilder.RootComponents.Add<HeadOutle\", \"t>(\\\"head::after\\\"); \\n\\nbuilder.Services.AddScoped(sp => new HttpClient { BaseAddress = new \\nUri(builde\", \"r.HostEnvironment.BaseAddress) }); \\n\\nawait builder.Build().RunAsync(); \\n\\n14 \\n\\nCHAPTER 4 | Project st\", \"ructure for Blazor apps \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\fStatic files \\n\\nUnlike ASP.NET Web Forms projects, n\", \"ot all files in a Blazor project can be requested as static files. \\nOnly the files in the wwwroot fo\", \"lder are web-addressable. This folder is referred to as the app\\u2019s \\u201cweb \\nroot\\u201d. Anything outside of t\", \"he app\\u2019s web root isn\\u2019t web-addressable. This setup provides an additional \\nlevel of security that p\", \"revents accidental exposure of project files over the web. \\n\\nConfiguration \\n\\nConfiguration in ASP.NE\", \"T Web Forms apps is typically handled using one or more web.config files. \\nBlazor apps don\\u2019t typical\", \"ly have web.config files. If they do, the file is only used to configure IIS-\\nspecific settings when\", \" hosted on IIS. Instead, Blazor Server apps use the ASP.NET Core configuration \\nabstractions. (Blazo\", \"r WebAssembly apps don\\u2019t currently support the same configuration abstractions, \\nbut that may be a f\", \"eature added in the future.) For example, the default Blazor Server app stores some \\nsettings in app\", \"settings.json. \\n\\n{ \\n  \\\"Logging\\\": { \\n    \\\"LogLevel\\\": { \\n      \\\"Default\\\": \\\"Information\\\", \\n      \\\"Micro\", \"soft\\\": \\\"Warning\\\", \\n      \\\"Microsoft.Hosting.Lifetime\\\": \\\"Information\\\" \\n    } \\n  }, \\n  \\\"AllowedHosts\\\":\", \" \\\"*\\\" \\n} \\n\\nYou\\u2019ll learn more about configuration in ASP.NET Core projects in the Configuration sectio\", \"n. \\n\\nRazor components \\n\\nMost files in Blazor projects are .razor files. Razor is a templating langua\", \"ge based on HTML and C# \\nthat is used to dynamically generate web UI. The .razor files define compon\", \"ents that make up the UI \\nof the app. For the most part, the components are identical for both the B\", \"lazor Server and Blazor \\nWebAssembly apps. Components in Blazor are analogous to user controls in AS\", \"P.NET Web Forms. \\n\\nEach Razor component file is compiled into a .NET class when the project is built\", \". The generated class \\ncaptures the component\\u2019s state, rendering logic, lifecycle methods, event han\", \"dlers, and other logic. \\nYou\\u2019ll learn more about authoring components in the Building reusable UI co\", \"mponents with Blazor \\nsection. \\n\\nThe *_Imports.razor* files aren\\u2019t Razor component files. Instead, t\", \"hey define a set of Razor directives to \\nimport into other .razor files within the same folder and i\", \"n its subfolders. For example, a \\n*_Imports.razor* file is a conventional way to add using directive\", \"s for commonly used namespaces: \\n\\n@using System.Net.Http \\n@using System.Net.Http.Json \\n@using Micros\", \"oft.AspNetCore.Components.Forms \\n@using Microsoft.AspNetCore.Components.Routing \\n\\n15 \\n\\nCHAPTER 4 | P\", \"roject structure for Blazor apps \\n\\n \\n \\n\\f@using Microsoft.AspNetCore.Components.Web \\n@using Microsoft\", \".AspNetCore.Components.Web.Virtualization \\n@using Microsoft.AspNetCore.Components.WebAssembly.Http \\n\", \"@using Microsoft.JSInterop \\n@using BlazorApp1 \\n@using BlazorApp1.Shared \\n\\nPages \\n\\nWhere are the page\", \"s in the Blazor apps? Blazor doesn\\u2019t define a separate file extension for \\naddressable pages, like t\", \"he .aspx files in ASP.NET Web Forms apps. Instead, pages are defined by \\nassigning routes to compone\", \"nts. A route is typically assigned using the @page Razor directive. For \\nexample, the Counter compon\", \"ent authored in the Pages/Counter.razor file defines the following route: \\n\\n@page \\\"/counter\\\" \\n\\nRouti\", \"ng in Blazor is handled client-side, not on the server. As the user navigates in the browser, Blazor\", \" \\nintercepts the navigation and then renders the component with the matching route. \\n\\nThe component \", \"routes aren\\u2019t currently inferred by the component\\u2019s file location like they are with \\n.aspx pages or\", \" ASP.NET Core Razor Pages. This feature may be added in the future. Each route must \\nbe specified ex\", \"plicitly on the component. Storing routable components in a Pages folder has no \\nspecial meaning and\", \" is purely a convention. \\n\\nYou\\u2019ll learn more about routing in Blazor in the Pages, routing, and layo\", \"uts section. \\n\\nLayout \\n\\nIn ASP.NET Web Forms apps, a common page layout is handled using master page\", \"s (Site.Master). In \\nBlazor apps, the page layout is handled using layout components (Shared/MainLay\", \"out.razor). Layout \\ncomponents are discussed in more detail in the Page, routing, and layouts sectio\", \"n. \\n\\nBootstrap Blazor \\n\\nTo bootstrap Blazor, the app must: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nSpecify where on the page the r\", \"oot component (App.Razor) should be rendered. \\n\\nAdd the corresponding Blazor framework script. \\n\\nIn \", \"the Blazor Server app, the root component\\u2019s host page is defined in the *_Host.cshtml* file. This fi\", \"le \\ndefines a Razor Page, not a component. Razor Pages use Razor syntax to define a server-addressab\", \"le \\npage, very much like an .aspx page. \\n\\n@page \\\"/\\\" \\n@namespace BlazorApp3.Pages \\n@addTagHelper *, M\", \"icrosoft.AspNetCore.Mvc.TagHelpers \\n@{ \\n    Layout = \\\"_Layout\\\"; \\n} \\n\\n16 \\n\\nCHAPTER 4 | Project struct\", \"ure for Blazor apps \\n\\n \\n \\n\\f<component type=\\\"typeof(App)\\\" render-mode=\\\"ServerPrerendered\\\" /> \\n\\nThe re\", \"nder-mode attribute is used to define where a root-level component should be rendered. The \\nRenderMo\", \"de option indicates the manner in which the component should be rendered. The following \\ntable outli\", \"nes the supported RenderMode options. \\n\\nOption \\n\\nDescription \\n\\nRenderMode.Server \\n\\nRenderMode.Server\", \"Prerendered \\n\\nRenderMode.Static \\n\\nRendered interactively once a \\nconnection with the browser is \\nest\", \"ablished \\n\\nFirst prerendered and then rendered \\ninteractively \\n\\nRendered as static content \\n\\nThe *_L\", \"ayout.cshtml* file includes the default HTML for the app and its components. \\n\\n@using Microsoft.AspN\", \"etCore.Components.Web \\n@namespace BlazorApp3.Pages \\n@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHel\", \"pers \\n\\n<!DOCTYPE html> \\n<html lang=\\\"en\\\"> \\n<head> \\n    <meta charset=\\\"utf-8\\\" /> \\n    <meta name=\\\"view\", \"port\\\" content=\\\"width=device-width, initial-scale=1.0\\\" /> \\n    <base href=\\\"~/\\\" /> \\n    <link rel=\\\"sty\", \"lesheet\\\" href=\\\"css/bootstrap/bootstrap.min.css\\\" /> \\n    <link href=\\\"css/site.css\\\" rel=\\\"stylesheet\\\" /\", \"> \\n    <link href=\\\"BlazorApp3.styles.css\\\" rel=\\\"stylesheet\\\" /> \\n    <component type=\\\"typeof(HeadOutle\", \"t)\\\" render-mode=\\\"ServerPrerendered\\\" /> \\n</head> \\n<body> \\n    @RenderBody() \\n\\n    <div id=\\\"blazor-err\", \"or-ui\\\"> \\n        <environment include=\\\"Staging,Production\\\"> \\n            An error has occurred. This\", \" application may no longer respond until reloaded. \\n        </environment> \\n        <environment inc\", \"lude=\\\"Development\\\"> \\n            An unhandled exception has occurred. See browser dev tools for deta\", \"ils. \\n        </environment> \\n        <a href=\\\"\\\" class=\\\"reload\\\">Reload</a> \\n        <a class=\\\"dismis\", \"s\\\">\\ud83d\\uddd9</a> \\n    </div> \\n\\n    <script src=\\\"_framework/blazor.server.js\\\"></script> \\n</body> \\n</html> \\n\\nT\", \"he script reference to *_framework/blazor.server.js* establishes the real-time connection with the \\n\", \"server and then deals with all user interactions and UI updates. \\n\\n17 \\n\\nCHAPTER 4 | Project structur\", \"e for Blazor apps \\n\\n \\n \\n \\n \\n \\n \\n\\fIn the Blazor WebAssembly app, the host page is a simple static HTM\", \"L file under wwwroot/index.html. \\nThe <div> element with id named app is used to indicate where the \", \"root component should be \\nrendered. \\n\\n<!DOCTYPE html> \\n<html lang=\\\"en\\\"> \\n\\n<head> \\n    <meta charset=\", \"\\\"utf-8\\\" /> \\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0, maximum-\\nscale\", \"=1.0, user-scalable=no\\\" /> \\n    <title>BlazorApp1</title> \\n    <base href=\\\"/\\\" /> \\n    <link href=\\\"cs\", \"s/bootstrap/bootstrap.min.css\\\" rel=\\\"stylesheet\\\" /> \\n    <link href=\\\"css/app.css\\\" rel=\\\"stylesheet\\\" />\", \" \\n    <link href=\\\"BlazorApp1.styles.css\\\" rel=\\\"stylesheet\\\" /> \\n</head> \\n\\n<body> \\n    <div id=\\\"app\\\">Lo\", \"ading...</div> \\n\\n    <div id=\\\"blazor-error-ui\\\"> \\n        An unhandled error has occurred. \\n        <\", \"a href=\\\"\\\" class=\\\"reload\\\">Reload</a> \\n        <a class=\\\"dismiss\\\">\\ud83d\\uddd9</a> \\n    </div> \\n    <script src=\\\"\", \"_framework/blazor.webassembly.js\\\"></script> \\n</body> \\n\\n</html> \\n\\nThe root component to render is spe\", \"cified in the app\\u2019s Program.cs file with the flexibility to register \\nservices through dependency in\", \"jection. For more information, see ASP.NET Core Blazor dependency \\ninjection. \\n\\nvar builder = WebAss\", \"emblyHostBuilder.CreateDefault(args); \\nbuilder.RootComponents.Add<App>(\\\"#app\\\"); \\nbuilder.RootCompone\", \"nts.Add<HeadOutlet>(\\\"head::after\\\"); \\n\\nBuild output \\n\\nWhen a Blazor project is built, all Razor compo\", \"nent and code files are compiled into a single \\nassembly. Unlike ASP.NET Web Forms projects, Blazor \", \"doesn\\u2019t support runtime compilation of the UI \\nlogic. \\n\\nRun the app with Hot Reload \\n\\nTo run the Bla\", \"zor Server app, press F5 in Visual Studio to run with the debugger attached, or Ctrl + F5 \\nto run wi\", \"thout the debugger attached. \\n\\nTo run the Blazor WebAssembly app, choose one of the following approa\", \"ches: \\n\\n\\u2022 \\n\\nRun the client project directly using the development server. \\n\\n18 \\n\\nCHAPTER 4 | Project\", \" structure for Blazor apps \\n\\n \\n \\n \\n \\n \\n \\n\\f\\u2022 \\n\\nRun the server project when hosting the app with ASP.N\", \"ET Core. \\n\\nBlazor WebAssembly apps can be debugged in both browser and Visual Studio. See Debug ASP.\", \"NET \\nCore Blazor WebAssembly for details. \\n\\nBoth Blazor Server and Blazor WebAssembly apps support H\", \"ot Reload in Visual Studio. Hot Reload is \\na feature that automatically updates changes made to a Bl\", \"azor app live, in the browser. You can \\ntoggle whether Hot Reload is enabled from its icon in the to\", \"olbar: \\n\\nSelecting the caret beside the icon reveals additional options. You can toggle Hot Reload o\", \"n or off, \\nrestart the application, and toggle whether Hot Reload should occur whenever a file is sa\", \"ved. \\n\\nYou can also access additional configuration options. The configuration dialog lets you speci\", \"fy \\nwhether Hot Reload should be enabled when debugging (along with Edit and Continue), when \\nstarti\", \"ng without debugging, or when a file is saved. \\n\\n19 \\n\\nCHAPTER 4 | Project structure for Blazor apps \", \"\\n\\n \\n \\n \\n \\n\\fThe \\u201cdeveloper inner loop\\u201d has been greatly streamlined with Hot Reload. Without Hot Relo\", \"ad, a \\nBlazor developer would typically need to restart and rerun the app after every change, naviga\", \"ting to \\nthe appropriate part of the app as required. With Hot Reload, changes can be made to the ru\", \"nning \\napp without the need to restart in most cases. Hot Reload even retains the state of pages, so\", \" there\\u2019s \\nno need to have to re-enter form values or otherwise get the app back where you need it. \\n\", \"\\n20 \\n\\nCHAPTER 4 | Project structure for Blazor apps \\n\\n \\n \\n \\n\\fCHAPTER  5 \\n\\nApp startup \\n\\nApplications\", \" that are written for ASP.NET typically have a global.asax.cs file that defines the \\nApplication_Sta\", \"rt event that controls which services are configured and made available for both HTML \\nrendering and\", \" .NET processing. This chapter looks at how things are slightly different with ASP.NET \\nCore and Bla\", \"zor Server. \\n\\nApplication_Start and Web Forms \\n\\nThe default web forms Application_Start method has g\", \"rown in purpose over years to handle many \\nconfiguration tasks. A fresh web forms project with the d\", \"efault template in Visual Studio 2022 now \\ncontains the following configuration logic: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nRou\", \"teConfig - Application URL routing \\n\\nBundleConfig - CSS and JavaScript bundling and minification \\n\\nE\", \"ach of these individual files resides in the App_Start folder and run only once at the start of our \", \"\\napplication. RouteConfig in the default project template adds the FriendlyUrlSettings for web forms\", \" to \\nallow application URLs to omit the .ASPX file extension. The default template also contains a d\", \"irective \\nthat provides permanent HTTP redirect status codes (HTTP 301) for the .ASPX pages to the f\", \"riendly \\nURL with the file name that omits the extension. \\n\\nWith ASP.NET Core and Blazor, these meth\", \"ods are either simplified and consolidated into the Startup \\nclass or they are eliminated in favor o\", \"f common web technologies. \\n\\nBlazor Server Startup Structure \\n\\nBlazor Server applications reside on \", \"top of an ASP.NET Core 3.0 or later version. ASP.NET Core web \\napplications are configured in Progra\", \"m.cs, or through a pair of methods in the Startup.cs class. A \\nsample Program.cs file is shown below\", \": \\n\\nusing BlazorApp1.Data; \\nusing Microsoft.AspNetCore.Components; \\nusing Microsoft.AspNetCore.Compo\", \"nents.Web; \\n\\nvar builder = WebApplication.CreateBuilder(args); \\n\\n// Add services to the container. \\n\", \"builder.Services.AddRazorPages(); \\nbuilder.Services.AddServerSideBlazor(); \\nbuilder.Services.AddSing\", \"leton<WeatherForecastService>(); \\n\\n21 \\n\\nCHAPTER 5 | App startup \\n\\n \\n \\n \\n \\n \\n\\fvar app = builder.Build\", \"(); \\n\\n// Configure the HTTP request pipeline. \\nif (!app.Environment.IsDevelopment()) \\n{ \\n    app.Use\", \"ExceptionHandler(\\\"/Error\\\"); \\n    // The default HSTS value is 30 days. You may want to change this f\", \"or production \\nscenarios, see https://aka.ms/aspnetcore-hsts. \\n    app.UseHsts(); \\n} \\n\\napp.UseHttpsR\", \"edirection(); \\napp.UseStaticFiles(); \\napp.UseRouting(); \\napp.MapBlazorHub(); \\napp.MapFallbackToPage(\", \"\\\"/_Host\\\"); \\n\\napp.Run(); \\n\\nThe app\\u2019s required services are added to the WebApplicationBuilder instanc\", \"e\\u2019s Services collection. \\nThis is how the various ASP.NET Core framework services are configured wit\", \"h the framework\\u2019s built-in \\ndependency injection container. The various builder.Services.Add* method\", \"s add services that enable \\nfeatures such as authentication, razor pages, MVC controller routing, Si\", \"gnalR, and Blazor Server \\ninteractions among many others. This method was not needed in web forms, a\", \"s the parsing and \\nhandling of the ASPX, ASCX, ASHX, and ASMX files were defined by referencing ASP.\", \"NET in the \\nweb.config configuration file. More information about dependency injection in ASP.NET Co\", \"re is \\navailable in the online documentation. \\n\\nAfter the app has been built by the builder, the res\", \"t of the calls on app configure its HTTP pipeline. \\nWith these calls, we declare from top to bottom \", \"the Middleware that will handle every request sent to \\nour application. Most of these features in th\", \"e default configuration were scattered across the web \\nforms configuration files and are now in one \", \"place for ease of reference. \\n\\nNo longer is the configuration of the custom error page placed in a w\", \"eb.config file, but now is \\nconfigured to always be shown if the application environment is not labe\", \"led Development. \\nAdditionally, ASP.NET Core applications are now configured to serve secure pages w\", \"ith TLS by default \\nwith the UseHttpsRedirection method call. \\n\\nNext, an unexpected configuration me\", \"thod call is made to UseStaticFiles. In ASP.NET Core, support for \\nrequests for static files (like J\", \"avaScript, CSS, and image files) must be explicitly enabled, and only files \\nin the app\\u2019s wwwroot fo\", \"lder are publicly addressable by default. \\n\\nThe next line is the first that replicates one of the co\", \"nfiguration options from web forms: UseRouting. \\nThis method adds the ASP.NET Core router to the pip\", \"eline and it can be either configured here or in \\nthe individual files that it can consider routing \", \"to. More information about routing configuration can \\nbe found in the Routing section. \\n\\nThe final a\", \"pp.Map* calls in this section define the endpoints that ASP.NET Core is listening on. These \\nroutes \", \"are the web accessible locations that you can access on the web server and receive some \\ncontent han\", \"dled by .NET and returned to you. The first entry, MapBlazorHub configures a SignalR hub \\nfor use in\", \" providing the real-time and persistent connection to the server where the state and \\nrendering of B\", \"lazor components is handled. The MapFallbackToPage method call indicates the web-\\naccessible locatio\", \"n of the page that starts the Blazor application and also configures the application to \\n\\n22 \\n\\nCHAPT\", \"ER 5 | App startup \\n\\n \\n \\n \\n \\n \\n\\fhandle deep-linking requests from the client-side. You will see this\", \" feature at work if you open a \\nbrowser and navigate directly to Blazor handled route in your applic\", \"ation, such as /counter in the \\ndefault project template. The request gets handled by the *_Host.csh\", \"tml* fallback page, which then \\nruns the Blazor router and renders the counter page. \\n\\nThe very last\", \" line starts the application, something that wasn\\u2019t required in web forms (since it relied on \\nIIS t\", \"o be running). \\n\\nUpgrading the BundleConfig Process \\n\\nTechnologies for bundling assets like CSS styl\", \"esheets and JavaScript files have changed significantly, \\nwith other technologies providing quickly \", \"evolving tools and techniques for managing these \\nresources. To this end, we recommend using a Node \", \"command-line tool such as Grunt / Gulp / \\nWebPack to package your static assets. \\n\\nThe Grunt, Gulp, \", \"and WebPack command-line tools and their associated configurations can be added \\nto your application\", \" and ASP.NET Core will quietly ignore those files during the application build \\nprocess. You can add\", \" a call to run their tasks by adding a Target inside your project file with syntax \\nsimilar to the f\", \"ollowing that would trigger a gulp script and the min target inside that script: \\n\\n<Target Name=\\\"MyP\", \"reCompileTarget\\\" BeforeTargets=\\\"Build\\\"> \\n  <Exec Command=\\\"gulp min\\\" /> \\n</Target> \\n\\nMore details abo\", \"ut both strategies to manage your CSS and JavaScript files are available in the Bundle \\nand minify s\", \"tatic assets in ASP.NET Core documentation. \\n\\n23 \\n\\nCHAPTER 5 | App startup \\n\\n \\n \\n\\fCHAPTER  6 \\n\\nBuild\", \" reusable UI \\ncomponents with Blazor \\n\\nOne of the beautiful things about ASP.NET Web Forms is how it\", \" enables encapsulation of reusable \\npieces of user interface (UI) code into reusable UI controls. Cu\", \"stom user controls can be defined in \\nmarkup using .ascx files. You can also build elaborate server \", \"controls in code with full designer \\nsupport. \\n\\nBlazor also supports UI encapsulation through compon\", \"ents. A component: \\n\\n\\u2022 \\n\\nIs a self-contained chunk of UI. \\n\\n\\u2022  Maintains its own state and rendering\", \" logic. \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nCan define UI event handlers, bind to input data, and manage its own lifecycle. \\n\\n\", \"Is typically defined in a .razor file using Razor syntax. \\n\\nAn introduction to Razor \\n\\nRazor is a li\", \"ght-weight markup templating language based on HTML and C#. With Razor, you can \\nseamlessly transiti\", \"on between markup and C# code to define your component rendering logic. When \\nthe .razor file is com\", \"piled, the rendering logic is captured in a structured way in a .NET class. The name \\nof the compile\", \"d class is taken from the .razor file name. The namespace is taken from the default \\nnamespace for t\", \"he project and the folder path, or you can explicitly specify the namespace using the \\n@namespace di\", \"rective (more on Razor directives below). \\n\\nA component\\u2019s rendering logic is authored using normal H\", \"TML markup with dynamic logic added \\nusing C#. The @ character is used to transition to C#. Razor is\", \" typically smart about figuring out when \\nyou\\u2019ve switched back to HTML. For example, the following c\", \"omponent renders a <p> tag with the \\ncurrent time: \\n\\n<p>@DateTime.Now</p> \\n\\nTo explicitly specify th\", \"e beginning and ending of a C# expression, use parentheses: \\n\\n<p>@(DateTime.Now)</p> \\n\\nRazor also ma\", \"kes it easy to use C# control flow in your rendering logic. For example, you can \\nconditionally rend\", \"er some HTML like this: \\n\\n24 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n\\f@if (valu\", \"e % 2 == 0) \\n{ \\n    <p>The value was even.</p> \\n} \\n\\nOr you can generate a list of items using a norm\", \"al C# foreach loop like this: \\n\\n<ul> \\n@foreach (var item in items) \\n{ \\n    <li>@item.Text</li> \\n} \\n<\", \"/ul> \\n\\nRazor directives, like directives in ASP.NET Web Forms, control many aspects of how a Razor \\n\", \"component is compiled. Examples include the component\\u2019s: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nNamespace \\n\\nBase \", \"class \\n\\nImplemented interfaces \\n\\nGeneric parameters \\n\\nImported namespaces \\n\\nRoutes \\n\\nRazor directive\", \"s start with the @ character and are typically used at the start of a new line at the start \\nof the \", \"file. For example, the @namespace directive defines the component\\u2019s namespace: \\n\\n@namespace MyCompon\", \"entNamespace  \\n\\nThe following table summarizes the various Razor directives used in Blazor and their\", \" ASP.NET Web \\nForms equivalents, if they exist. \\n\\nDirective \\n\\nDescription \\n\\nExample \\n\\nWeb Forms equi\", \"valent \\n\\n@attribute \\n\\n@code \\n\\n@implements \\n\\n@inherits \\n\\n@inject \\n\\nAdds a class-level \\nattribute to t\", \"he \\ncomponent \\n\\nAdds class \\nmembers to the \\ncomponent \\n\\nImplements the \\nspecified interface \\n\\nInheri\", \"ts from the \\nspecified base class \\n\\nInjects a service \\ninto the component \\n\\n@attribute \\n[Authorize] \", \"\\n\\nNone \\n\\n@code { ... }  <script runat=\\\"server\\\">...</script> \\n\\nUse code-behind \\n\\n<%@ Control \\nInherit\", \"s=\\\"MyUserControlBase\\\" %> \\n\\nNone \\n\\n@impleme\\nnts \\nIDisposable \\n\\n@inherits \\nMyCompon\\nentBase \\n\\n@inject \", \"\\nIJSRuntime \\nJS \\n\\n25 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n\\fDirective \\n\\nDescr\", \"iption \\n\\nExample \\n\\nWeb Forms equivalent \\n\\n@layout \\n\\n@namespace \\n\\n@page \\n\\n@typeparam \\n\\n@using \\n\\nSpeci\", \"fies a layout \\ncomponent for the \\ncomponent \\n\\nSets the namespace \\nfor the component \\n\\nSpecifies the \", \"route \\nfor the component \\n\\nSpecifies a generic \\ntype parameter for \\nthe component \\n\\nSpecifies a \\nnam\", \"espace to bring \\ninto scope \\n\\n@layout \\nMainLayout \\n\\n<%@ Page \\nMasterPageFile=\\\"~/Site.Master\\\" %> \\n\\nNo\", \"ne \\n\\n<%@ Page %> \\n\\nUse code-behind \\n\\nAdd namespace in web.config \\n\\n@namespa\\nce \\nMyNamesp\\nace \\n\\n@page\", \" \\n\\\"/product/{i\\nd}\\\" \\n\\n@typepara\\nm TItem \\n\\n@using \\nMyCompon\\nentNamesp\\nace \\n\\nRazor components also make\", \" extensive use of directive attributes on elements to control various \\naspects of how components get\", \" compiled (event handling, data binding, component & element \\nreferences, and so on). Directive attr\", \"ibutes all follow a common generic syntax where the values in \\nparenthesis are optional: \\n\\n@directiv\", \"e(-suffix(:name))(=\\\"value\\\") \\n\\nThe following table summarizes the various attributes for Razor direct\", \"ives used in Blazor. \\n\\nAttribute \\n\\nDescription \\n\\nExample \\n\\n@attributes \\n\\nRenders a dictionary of att\", \"ributes \\n\\n@bind \\n\\nCreates a two-way data binding \\n\\n@on{event} \\n\\n@key \\n\\nAdds an event handler for the\", \" \\nspecified event \\n\\nSpecifies a key to be used by the \\ndiffing algorithm for preserving \\nelements in\", \" a collection \\n\\n<input \\n@attributes=\\\"ExtraA\\nttributes\\\" /> \\n\\n<input \\n@bind=\\\"username\\\" \\n@bind:event=\\\"o\", \"ninp\\nut\\\" /> \\n\\n<button \\n@onclick=\\\"Incremen\\ntCount\\\">Click \\nme!</button> \\n\\n<DetailsEditor \\n@key=\\\"person\", \"\\\" \\nDetails=\\\"person.Det\\nails\\\" /> \\n\\n26 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n\\fA\", \"ttribute \\n\\nDescription \\n\\nExample \\n\\n@ref \\n\\nCaptures a reference to the \\ncomponent or HTML element \\n\\n<\", \"MyDialog \\n@ref=\\\"myDialog\\\" /> \\n\\nThe various directive attributes used by Blazor (@onclick, @bind, @re\", \"f, and so on) are covered in the \\nsections below and later chapters. \\n\\nMany of the syntaxes used in \", \".aspx and .ascx files have parallel syntaxes in Razor. Below is a simple \\ncomparison of the syntaxes\", \" for ASP.NET Web Forms and Razor. \\n\\nFeature \\n\\nWeb Forms \\n\\nSyntax \\n\\nRazor \\n\\nSynt\\nax \\n\\nDirectives \\n\\n<%\", \"@ [directive] %>  <%@ Page %> \\n\\n@[directive]  @pa\\n\\nCode blocks \\n\\n<% %> \\n\\n<% int x = 123; %>  @{ } \\n\\n\", \"Expressions \\n(HTML-encoded) \\n\\n<%: %> \\n\\n<%:DateTime.Now \\n%> \\n\\nImplicit: @ \\nExplicit: @() \\n\\nComments \\n\", \"\\n<%-- --%> \\n\\n<%-- Commented --\\n%> \\n\\n@* *@ \\n\\nData binding \\n\\n<%# %> \\n\\n<%# Bind(\\\"Name\\\") \\n%> \\n\\n@bind \\n\\ng\", \"e \\n\\n@{ \\nint x \\n= \\n123; } \\n\\n@Da\\nteTi\\nme.N\\now \\n@(Da\\nteTi\\nme.N\\now) \\n\\n@* \\nCom\\nment\\ned \\n*@ \\n\\n<inp\\nut \\n@bi\", \"n\\nd=\\\"u\\nserna\\nme\\\" \\n/> \\n\\nTo add members to the Razor component class, use the @code directive. This te\", \"chnique is similar to \\nusing a <script runat=\\\"server\\\">...</script> block in an ASP.NET Web Forms use\", \"r control or page. \\n\\n@code { \\n    int count = 0; \\n\\n    void IncrementCount() \\n    { \\n        count++\", \"; \\n\\n27 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n\\f    } \\n} \\n\\nBecause Razor is b\", \"ased on C#, it must be compiled from within a C# project (.csproj). You can\\u2019t \\ncompile .razor files \", \"from a Visual Basic project (.vbproj). You can still reference Visual Basic projects \\nfrom your Blaz\", \"or project. The opposite is true too. \\n\\nFor a full Razor syntax reference, see Razor syntax referenc\", \"e for ASP.NET Core. \\n\\nUse components \\n\\nAside from normal HTML, components can also use other compone\", \"nts as part of their rendering logic. \\nThe syntax for using a component in Razor is similar to using\", \" a user control in an ASP.NET Web Forms \\napp. Components are specified using an element tag that mat\", \"ches the type name of the component. \\nFor example, you can add a Counter component like this: \\n\\n<Cou\", \"nter /> \\n\\nUnlike ASP.NET Web Forms, components in Blazor: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nDon\\u2019t use an element prefix (for\", \" example, asp:). \\n\\nDon\\u2019t require registration on the page or in the web.config. \\n\\nThink of Razor com\", \"ponents like you would .NET types, because that\\u2019s exactly what they are. If the \\nassembly containing\", \" the component is referenced, then the component is available for use. To bring \\nthe component\\u2019s nam\", \"espace into scope, apply the @using directive: \\n\\n@using MyComponentLib \\n\\n<Counter /> \\n\\nAs seen in th\", \"e default Blazor projects, it\\u2019s common to put @using directives into a *_Imports.razor* file \\nso tha\", \"t they\\u2019re imported into all .razor files in the same directory and in child directories. \\n\\nIf the na\", \"mespace for a component isn\\u2019t in scope, you can specify a component using its full type \\nname, as yo\", \"u can in C#: \\n\\n<MyComponentLib.Counter /> \\n\\nModify page title from components \\n\\nWhen building SPA-st\", \"yle apps, it\\u2019s common for parts of a page to reload without reloading the entire \\npage. Even so, it \", \"can be useful to have the title of the page change based on which component is \\ncurrently loaded. Th\", \"is can be accomplished by including the <PageTitle> tag in the component\\u2019s \\nRazor page: \\n\\n@page \\\"/\\\" \", \"\\n<PageTitle>Home</PageTitle> \\n\\nThe contents of this element can be dynamic, for instance showing the\", \" current count of messages: \\n\\n28 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n\\f<Pa\", \"geTitle>@MessageCount messages</PageTitle> \\n\\nNote that if several components on a particular page in\", \"clude <PageTitle> tags, only the last one will \\nbe displayed (since each one will overwrite the prev\", \"ious one). \\n\\nComponent parameters \\n\\nIn ASP.NET Web Forms, you can flow parameters and data to contro\", \"ls using public properties. These \\nproperties can be set in markup using attributes or set directly \", \"in code. Razor components work in a \\nsimilar fashion, although the component properties must also be\", \" marked with the [Parameter] \\nattribute to be considered component parameters. \\n\\nThe following Count\", \"er component defines a component parameter called IncrementAmount that can \\nbe used to specify the a\", \"mount that the Counter should be incremented each time the button is \\nclicked. \\n\\n<h1>Counter</h1> \\n\\n\", \"<p>Current count: @currentCount</p> \\n\\n<button class=\\\"btn btn-primary\\\" @onclick=\\\"IncrementCount\\\">Clic\", \"k me</button> \\n\\n@code { \\n    int currentCount = 0; \\n\\n    [Parameter] \\n    public int IncrementAmount\", \" { get; set; } = 1; \\n\\n    void IncrementCount() \\n    { \\n        currentCount+=IncrementAmount; \\n    \", \"} \\n} \\n\\nTo specify a component parameter in Blazor, use an attribute as you would in ASP.NET Web Form\", \"s: \\n\\n<Counter IncrementAmount=\\\"10\\\" /> \\n\\nQuery string parameters \\n\\nRazor components can also leverage\", \" values from the query string of the page they\\u2019re rendered on as \\na parameter source. To enable this\", \", add the [SupplyParameterFromQuery] attribute to the parameter. \\nFor example, the following paramet\", \"er definition would get its value from the request in the form \\n?IncBy=2: \\n\\n[Parameter] \\n[SupplyPara\", \"meterFromQuery(Name = \\\"IncBy\\\")] \\npublic int IncrementAmount { get; set; } = 1; \\n\\nIf you don\\u2019t supply\", \" a custom Name in the [SupplyParameterFromQuery] attribute, by default it will \\nmatch the property n\", \"ame (IncrementAmount in this case). \\n\\n29 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n\", \" \\n \\n \\n \\n \\n \\n\\fComponents and error boundaries \\n\\nBy default, Blazor apps will detect unhandled excepti\", \"ons and show an error message at the bottom of \\nthe page with no additional detail. To constrain the\", \" parts of the app that are impacted by an \\nunhandled error, for instance to limit the impact to a si\", \"ngle component, the <ErrorBoundary> tag can \\nbe wrapped around component declarations. \\n\\nFor example\", \", to protect against possible exceptions thrown from the Counter component, declare it \\nwithin an <E\", \"rrorBoundary> and optionally specify a message to display if there is an exception: \\n\\n<ErrorBoundary\", \"> \\n    <ChildContent> \\n        <Counter /> \\n    </ChildContent> \\n    <ErrorContent> \\n        Oops! T\", \"he counter isn't working right now; please try again later. \\n    </ErrorContent> \\n</ErrorBoundary> \\n\", \"If you don\\u2019t need to specify custom error content, you can just wrap the component \\ndirectly: \\n<Erro\", \"rBoundary> \\n  <Counter /> \\n</ErrorBoundary> \\n\\nA default message stating \\u201cAn error as occurred.\\u201d will\", \" be displayed if an unhandled exception occurs \\nin the wrapped component. \\n\\nEvent handlers \\n\\nBoth AS\", \"P.NET Web Forms and Blazor provide an event-based programming model for handling UI \\nevents. Example\", \"s of such events include button clicks and text input. In ASP.NET Web Forms, you use \\nHTML server co\", \"ntrols to handle UI events exposed by the DOM, or you can handle events exposed by \\nweb server contr\", \"ols. The events are surfaced on the server through form post-back requests. Consider \\nthe following \", \"Web Forms button click example: \\n\\nCounter.ascx \\n\\n<asp:Button ID=\\\"ClickMeButton\\\" runat=\\\"server\\\" Text=\", \"\\\"Click me!\\\" \\nOnClick=\\\"ClickMeButton_Click\\\" /> \\nCounter.ascx.cs \\npublic partial class Counter : Syste\", \"m.Web.UI.UserControl \\n{ \\n    protected void ClickMeButton_Click(object sender, EventArgs e) \\n    { \\n\", \"        Console.WriteLine(\\\"The button was clicked!\\\"); \\n    } \\n} \\n\\nIn Blazor, you can register handle\", \"rs for DOM UI events directly using directive attributes of the form \\n@on{event}. The {event} placeh\", \"older represents the name of the event. For example, you can listen for \\nbutton clicks like this: \\n\\n\", \"30 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n\\f<button @onclick=\\\"OnClick\\\">Click me\", \"!</button> \\n\\n@code { \\n    void OnClick() \\n    { \\n        Console.WriteLine(\\\"The button was clicked!\\\"\", \"); \\n    } \\n} \\n\\nEvent handlers can accept an optional, event-specific argument to provide more inform\", \"ation about \\nthe event. For example, mouse events can take a MouseEventArgs argument, but it isn\\u2019t r\", \"equired. \\n\\n<button @onclick=\\\"OnClick\\\">Click me!</button> \\n\\n@code { \\n    void OnClick(MouseEventArgs \", \"e) \\n    { \\n        Console.WriteLine($\\\"Mouse clicked at {e.ScreenX}, {e.ScreenY}.\\\"); \\n    } \\n} \\n\\nIns\", \"tead of referring to a method group for an event handler, you can use a lambda expression. A \\nlambda\", \" expression allows you to close over other in-scope values. \\n\\n@foreach (var buttonLabel in buttonLab\", \"els) \\n{ \\n    <button @onclick=\\\"() => Console.WriteLine($\\\"The {buttonLabel} button was \\nclicked!\\\")\\\">@\", \"buttonLabel</button> \\n} \\n\\nEvent handlers can execute synchronously or asynchronously. For example, t\", \"he following OnClick \\nevent handler executes asynchronously: \\n\\n<button @onclick=\\\"OnClick\\\">Click me!<\", \"/button> \\n\\n@code { \\n    async Task OnClick() \\n    { \\n        var result = await Http.GetAsync(\\\"api/v\", \"alues\\\"); \\n    } \\n} \\n\\nAfter an event is handled, the component is rendered to account for any compone\", \"nt state changes. \\nWith asynchronous event handlers, the component is rendered immediately after the\", \" handler \\nexecution completes. The component is rendered again after the asynchronous Task completes\", \". This \\nasynchronous execution mode provides an opportunity to render some appropriate UI while the \", \"\\nasynchronous Task is still in progress. \\n\\n<button @onclick=\\\"ShowMessage\\\">Get message</button> \\n\\n@if\", \" (showMessage) \\n{ \\n    @if (message == null) \\n    { \\n        <p><em>Loading...</em></p> \\n    } \\n    \", \"else \\n\\n31 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n \\n \\n \\n\\f    { \\n        <p>Th\", \"e message is: @message</p> \\n    } \\n} \\n\\n@code \\n{ \\n    bool showMessage = false; \\n    string message; \", \"\\n\\n    public async Task ShowMessage() \\n    { \\n        showMessage = true; \\n        message = await M\", \"essageService.GetMessageAsync(); \\n    } \\n} \\n\\nComponents can also define their own events by defining\", \" a component parameter of type \\nEventCallback<TValue>. Event callbacks support all the variations of\", \" DOM UI event handlers: optional \\narguments, synchronous or asynchronous, method groups, or lambda e\", \"xpressions. \\n\\n<button class=\\\"btn btn-primary\\\" @onclick=\\\"OnClick\\\">Click me!</button> \\n\\n@code { \\n    [\", \"Parameter] \\n    public EventCallback<MouseEventArgs> OnClick { get; set; } \\n} \\n\\nData binding \\n\\nBlazo\", \"r provides a simple mechanism to bind data from a UI component to the component\\u2019s state. This \\nappro\", \"ach differs from the features in ASP.NET Web Forms for binding data from data sources to UI \\ncontrol\", \"s. We\\u2019ll cover handling data from different data sources in the Dealing with data section. \\n\\nTo crea\", \"te a two-way data binding from a UI component to the component\\u2019s state, use the @bind \\ndirective att\", \"ribute. In the following example, the value of the check box is bound to the isChecked \\nfield. \\n\\n<in\", \"put type=\\\"checkbox\\\" @bind=\\\"isChecked\\\" /> \\n\\n@code { \\n    bool isChecked; \\n} \\n\\nWhen the component is r\", \"endered, the value of the checkbox is set to the value of the isChecked field. \\nWhen the user toggle\", \"s the checkbox, the onchange event is fired and the isChecked field is set to the \\nnew value. The @b\", \"ind syntax in this case is equivalent to the following markup: \\n\\n<input value=\\\"@isChecked\\\" @onchange\", \"=\\\"(UIChangeEventArgs e) => isChecked = e.Value\\\" /> \\n\\nTo change the event used for the bind, use the \", \"@bind:event attribute. \\n\\n<input @bind=\\\"text\\\" @bind:event=\\\"oninput\\\" /> \\n<p>@text</p> \\n\\n32 \\n\\nCHAPTER 6\", \" | Build reusable UI components with Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n\\f@code { \\n    string text; \\n} \\n\\nComponen\", \"ts can also support data binding to their parameters. To data bind, define an event callback \\nparame\", \"ter with the same name as the bindable parameter. The \\u201cChanged\\u201d suffix is added to the \\nname. \\n\\nPass\", \"wordBox.razor \\n\\nPassword: <input \\n    value=\\\"@Password\\\" \\n    @oninput=\\\"OnPasswordChanged\\\" \\n    type=\", \"\\\"@(showPassword ? \\\"text\\\" : \\\"password\\\")\\\" /> \\n\\n<label><input type=\\\"checkbox\\\" @bind=\\\"showPassword\\\" />Sh\", \"ow password</label> \\n\\n@code { \\n    private bool showPassword; \\n\\n    [Parameter] \\n    public string P\", \"assword { get; set; } \\n\\n    [Parameter] \\n    public EventCallback<string> PasswordChanged { get; set\", \"; } \\n\\n    private Task OnPasswordChanged(ChangeEventArgs e) \\n    { \\n        Password = e.Value.ToStr\", \"ing(); \\n        return PasswordChanged.InvokeAsync(Password); \\n    } \\n} \\n\\nTo chain a data binding to\", \" an underlying UI element, set the value and handle the event directly on \\nthe UI element instead of\", \" using the @bind attribute. \\n\\nTo bind to a component parameter, use a @bind-{Parameter} attribute to\", \" specify the parameter to \\nwhich you want to bind. \\n\\n<PasswordBox @bind-Password=\\\"password\\\" /> \\n\\n@co\", \"de { \\n    string password; \\n} \\n\\nState changes \\n\\nIf the component\\u2019s state has changed outside of a no\", \"rmal UI event or event callback, then the \\ncomponent must manually signal that it needs to be render\", \"ed again. To signal that a component\\u2019s \\nstate has changed, call the StateHasChanged method on the co\", \"mponent. \\n\\nIn the example below, a component displays a message from an AppState service that can be\", \" updated \\nby other parts of the app. The component registers its StateHasChanged method with the \\nAp\", \"pState.OnChange event so that the component is rendered whenever the message gets updated. \\n\\n33 \\n\\nCH\", \"APTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n\\fpublic class AppState \\n{ \\n    \", \"public string Message { get; } \\n\\n    // Lets components receive change notifications \\n    public eve\", \"nt Action OnChange; \\n\\n    public void UpdateMessage(string message) \\n    { \\n        Message = messag\", \"e; \\n        NotifyStateChanged(); \\n    } \\n\\n    private void NotifyStateChanged() => OnChange?.Invoke\", \"(); \\n} \\n\\n@inject AppState AppState \\n\\n<p>App message: @AppState.Message</p> \\n\\n@code { \\n    protected \", \"override void OnInitialized() \\n    { \\n        AppState.OnChange += StateHasChanged \\n    } \\n} \\n\\nCompo\", \"nent lifecycle \\n\\nThe ASP.NET Web Forms framework has well-defined lifecycle methods for modules, pag\", \"es, and \\ncontrols. For example, the following control implements event handlers for the Init, Load, \", \"and UnLoad \\nlifecycle events: \\n\\nCounter.ascx.cs \\n\\npublic partial class Counter : System.Web.UI.UserC\", \"ontrol \\n{ \\n    protected void Page_Init(object sender, EventArgs e) { ... } \\n    protected void Page\", \"_Load(object sender, EventArgs e) { ... } \\n    protected void Page_UnLoad(object sender, EventArgs e\", \") { ... } \\n} \\n\\nRazor components also have a well-defined lifecycle. A component\\u2019s lifecycle can be u\", \"sed to initialize \\ncomponent state and implement advanced component behaviors. \\n\\nAll of Blazor\\u2019s com\", \"ponent lifecycle methods have both synchronous and asynchronous versions. \\nComponent rendering is sy\", \"nchronous. You can\\u2019t run asynchronous logic as part of the component \\nrendering. All asynchronous lo\", \"gic must execute as part of an async lifecycle method. \\n\\nOnInitialized \\n\\nThe OnInitialized and OnIni\", \"tializedAsync methods are used to initialize the component. A component \\nis typically initialized af\", \"ter it\\u2019s first rendered. After a component is initialized, it may be rendered \\n\\n34 \\n\\nCHAPTER 6 | Bui\", \"ld reusable UI components with Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\fmultiple times before it\\u2019s eventually dis\", \"posed. The OnInitialized method is similar to the Page_Load \\nevent in ASP.NET Web Forms pages and co\", \"ntrols. \\n\\nprotected override void OnInitialized() { ... } \\nprotected override async Task OnInitializ\", \"edAsync() { await ... } \\n\\nOnParametersSet \\n\\nThe OnParametersSet and OnParametersSetAsync methods are\", \" called when a component has \\nreceived parameters from its parent and the value are assigned to prop\", \"erties. These methods are \\nexecuted after component initialization and each time the component is re\", \"ndered. \\n\\nprotected override void OnParametersSet() { ... } \\nprotected override async Task OnParamet\", \"ersSetAsync() { await ... } \\n\\nOnAfterRender \\n\\nThe OnAfterRender and OnAfterRenderAsync methods are c\", \"alled after a component has finished \\nrendering. Element and component references are populated at t\", \"his point (more on these concepts \\nbelow). Interactivity with the browser is enabled at this point. \", \"Interactions with the DOM and \\nJavaScript execution can safely take place. \\n\\nprotected override void\", \" OnAfterRender(bool firstRender) \\n{ \\n    if (firstRender) \\n    { \\n        ... \\n    } \\n} \\nprotected o\", \"verride async Task OnAfterRenderAsync(bool firstRender) \\n{ \\n    if (firstRender) \\n    { \\n        awa\", \"it ... \\n    } \\n} \\n\\nOnAfterRender and OnAfterRenderAsync aren\\u2019t called when prerendering on the serve\", \"r. \\n\\nThe firstRender parameter is true the first time the component is rendered; otherwise, its valu\", \"e is false. \\n\\nIDisposable \\n\\nRazor components can implement IDisposable to dispose of resources when \", \"the component is \\nremoved from the UI. A Razor component can implement IDispose by using the @implem\", \"ents \\ndirective: \\n\\n@using System \\n@implements IDisposable \\n\\n... \\n\\n@code { \\n    public void Dispose()\", \" \\n\\n35 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n \\n\\f    { \\n        ... \\n    } \\n}\", \" \\n\\nCapture component references \\n\\nIn ASP.NET Web Forms, it\\u2019s common to manipulate a control instance\", \" directly in code by referring to \\nits ID. In Blazor, it\\u2019s also possible to capture and manipulate a\", \" reference to a component, although it\\u2019s \\nmuch less common. \\n\\nTo capture a component reference in Bl\", \"azor, use the @ref directive attribute. The value of the \\nattribute should match the name of a setta\", \"ble field with the same type as the referenced component. \\n\\n<MyLoginDialog @ref=\\\"loginDialog\\\" ... />\", \" \\n\\n@code { \\n    MyLoginDialog loginDialog = default!; \\n\\n    void OnSomething() \\n    { \\n        login\", \"Dialog.Show(); \\n    } \\n} \\n\\nWhen the parent component is rendered, the field is populated with the ch\", \"ild component instance. \\nYou can then call methods on, or otherwise manipulate, the component instan\", \"ce. \\n\\nManipulating component state directly using component references isn\\u2019t recommended. Doing so \\n\", \"prevents the component from being rendered automatically at the correct times. \\n\\nCapture element ref\", \"erences \\n\\nRazor components can capture references to an element. Unlike HTML server controls in ASP.\", \"NET \\nWeb Forms, you can\\u2019t manipulate the DOM directly using an element reference in Blazor. Blazor \\n\", \"handles most DOM interactions for you using its DOM diffing algorithm. Captured element references \\n\", \"in Blazor are opaque. However, they\\u2019re used to pass a specific element reference in a JavaScript \\nin\", \"terop call. For more information about JavaScript interop, see ASP.NET Core Blazor JavaScript \\ninter\", \"op. \\n\\nTemplated components \\n\\nIn ASP.NET Web Forms, you can create templated controls. Templated cont\", \"rols enable the developer \\nto specify a portion of the HTML used to render a container control. The \", \"mechanics of building \\ntemplated server controls are complex, but they enable powerful scenarios for\", \" rendering data in a \\nuser customizable way. Examples of templated controls include Repeater and Dat\", \"aList. \\n\\nRazor components can also be templated by defining component parameters of type \\nRenderFrag\", \"ment or RenderFragment<T>. A RenderFragment represents a chunk of Razor markup \\n\\n36 \\n\\nCHAPTER 6 | Bu\", \"ild reusable UI components with Blazor \\n\\n \\n \\n \\n \\n\\fthat can then be rendered by the component. A Rend\", \"erFragment<T> is a chunk of Razor markup that \\ntakes a parameter that can be specified when the rend\", \"er fragment is rendered. \\n\\nChild content \\n\\nRazor components can capture their child content as a Ren\", \"derFragment and render that content as \\npart of the component rendering. To capture child content, d\", \"efine a component parameter of type \\nRenderFragment and name it ChildContent. \\n\\nChildContentComponen\", \"t.razor \\n\\n<h1>Component with child content</h1> \\n\\n<div>@ChildContent</div> \\n\\n@code { \\n    [Parameter\", \"] \\n    public RenderFragment ChildContent { get; set; } \\n} \\nA parent component can then supply child\", \" content using normal Razor syntax. \\n<ChildContentComponent> \\n    <ChildContent> \\n        <p>The tim\", \"e is @DateTime.Now</p> \\n    </ChildContent> \\n</ChildContentComponent> \\n\\nTemplate parameters \\n\\nA temp\", \"lated Razor component can also define multiple component parameters of type \\nRenderFragment or Rende\", \"rFragment<T>. The parameter for a RenderFragment<T> can be specified \\nwhen it\\u2019s invoked. To specify \", \"a generic type parameter for a component, use the @typeparam Razor \\ndirective. \\n\\nSimpleListView.razo\", \"r \\n\\n@typeparam TItem \\n\\n@Heading \\n\\n<ul> \\n@foreach (var item in Items) \\n{ \\n    <li>@ItemTemplate(item)\", \"</li> \\n} \\n</ul> \\n\\n@code { \\n    [Parameter] \\n    public RenderFragment Heading { get; set; } \\n\\n    [P\", \"arameter] \\n    public RenderFragment<TItem> ItemTemplate { get; set; } \\n\\n    [Parameter] \\n    public\", \" IEnumerable<TItem> Items { get; set; } \\n} \\n\\n37 \\n\\nCHAPTER 6 | Build reusable UI components with Blaz\", \"or \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\fWhen using a templated component, the template parameters can be specified u\", \"sing child elements \\nthat match the names of the parameters. Component arguments of type RenderFragm\", \"ent<T> passed \\nas elements have an implicit parameter named context. You can change the name of this\", \" implement \\nparameter using the Context attribute on the child element. Any generic type parameters \", \"can be \\nspecified using an attribute that matches the name of the type parameter. The type parameter\", \" will be \\ninferred if possible: \\n\\n<SimpleListView Items=\\\"messages\\\" TItem=\\\"string\\\"> \\n    <Heading> \\n \", \"       <h1>My list</h1> \\n    </Heading> \\n    <ItemTemplate Context=\\\"message\\\"> \\n        <p>The messag\", \"e is: @message</p> \\n    </ItemTemplate> \\n</SimpleListView> \\nThe output of this component looks like \", \"this: \\n<h1>My list</h1> \\n<ul> \\n    <li><p>The message is: message1</p></li> \\n    <li><p>The message \", \"is: message2</p></li> \\n<ul> \\n\\nCode-behind \\n\\nA Razor component is typically authored in a single .raz\", \"or file. However, it\\u2019s also possible to separate \\nthe code and markup using a code-behind file. To u\", \"se a component file, add a C# file that matches \\nthe file name of the component file but with a .cs \", \"extension added (Counter.razor.cs). Use the C# file \\nto define a base class for the component. You c\", \"an name the base class anything you\\u2019d like, but it\\u2019s \\ncommon to name the class the same as the compo\", \"nent class, but with a Base extension added \\n(CounterBase). The component-based class must also deri\", \"ve from ComponentBase. Then, in the Razor \\ncomponent file, add the @inherits directive to specify th\", \"e base class for the component (@inherits \\nCounterBase). \\n\\nCounter.razor \\n\\n@inherits CounterBase \\n\\n<\", \"h1>Counter</h1> \\n\\n<p>Current count: @currentCount</p> \\n\\n<button @onclick=\\\"IncrementCount\\\">Click me</\", \"button> \\nCounter.razor.cs \\npublic class CounterBase : ComponentBase \\n{ \\n    protected int currentCou\", \"nt = 0; \\n\\n    protected void IncrementCount() \\n    { \\n        currentCount++; \\n    } \\n} \\n\\n38 \\n\\nCHAPT\", \"ER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n \\n \\n \\n \\n\\fThe visibility of the component\\u2019s mem\", \"bers in the base class must be protected or public to be visible \\nto the component class. \\n\\nAddition\", \"al resources \\n\\nThe preceding isn\\u2019t an exhaustive treatment of all aspects of Razor components. For m\", \"ore information \\non how to Create and use ASP.NET Core Razor components, see the Blazor documentatio\", \"n. \\n\\n39 \\n\\nCHAPTER 6 | Build reusable UI components with Blazor \\n\\n \\n \\n\\fCHAPTER  7 \\n\\nPages, routing, a\", \"nd \\nlayouts \\n\\nASP.NET Web Forms apps are composed of pages defined in .aspx files. Each page\\u2019s addre\", \"ss is based \\non its physical file path in the project. When a browser makes a request to the page, t\", \"he contents of \\nthe page are dynamically rendered on the server. The rendering accounts for both the\", \" page\\u2019s HTML \\nmarkup and its server controls. \\n\\nIn Blazor, each page in the app is a component, typi\", \"cally defined in a .razor file, with one or more \\nspecified routes. Routing mostly happens client-si\", \"de without involving a specific server request. The \\nbrowser first makes a request to the root addre\", \"ss of the app. A root Router component in the Blazor \\napp then handles intercepting navigation reque\", \"sts and forwards them to the correct component. \\n\\nBlazor also supports deep linking. Deep linking oc\", \"curs when the browser makes a request to a specific \\nroute other than the root of the app. Requests \", \"for deep links sent to the server are routed to the \\nBlazor app, which then routes the request clien\", \"t-side to the correct component. \\n\\nA simple page in ASP.NET Web Forms might contain the following ma\", \"rkup: \\n\\nName.aspx \\n\\n<%@ Page Title=\\\"Name\\\" Language=\\\"C#\\\" MasterPageFile=\\\"~/Site.Master\\\" AutoEventWire\", \"up=\\\"true\\\" \\nCodeBehind=\\\"Name.aspx.cs\\\" Inherits=\\\"WebApplication1.Name\\\" %> \\n\\n<asp:Content ID=\\\"BodyConte\", \"nt\\\" ContentPlaceHolderID=\\\"MainContent\\\" runat=\\\"server\\\"> \\n    <div> \\n        What is your name?<br /> \", \"\\n        <asp:TextBox ID=\\\"TextBox1\\\" runat=\\\"server\\\"></asp:TextBox> \\n        <asp:Button ID=\\\"Button1\\\" \", \"runat=\\\"server\\\" Text=\\\"Submit\\\" OnClick=\\\"Button1_Click\\\" /> \\n    </div> \\n    <div> \\n        <asp:Literal\", \" ID=\\\"Literal1\\\" runat=\\\"server\\\" /> \\n    </div> \\n</asp:Content> \\n\\nName.aspx.cs \\n\\npublic partial class N\", \"ame : System.Web.UI.Page \\n{ \\n    protected void Button1_Click1(object sender, EventArgs e) \\n    { \\n \", \"       Literal1.Text = \\\"Hello \\\" + TextBox1.Text; \\n    } \\n} \\n\\n40 \\n\\nCHAPTER 7 | Pages, routing, and la\", \"youts \\n\\n \\n \\n \\n\\fThe equivalent page in a Blazor app would look like this: \\n\\nName.razor \\n\\n@page \\\"/Name\", \"\\\" \\n@layout MainLayout \\n\\n<div> \\n    What is your name?<br /> \\n    <input @bind=\\\"text\\\" /> \\n    <button\", \" @onclick=\\\"OnClick\\\">Submit</button> \\n</div> \\n<div> \\n    @if (name != null) \\n    { \\n        @:Hello @\", \"name \\n    } \\n</div> \\n\\n@code { \\n    string text; \\n    string name; \\n\\n    void OnClick() { \\n        na\", \"me = text; \\n    } \\n} \\n\\nCreate pages \\n\\nTo create a page in Blazor, create a component and add the @pa\", \"ge Razor directive to specify the \\nroute for the component. The @page directive takes a single param\", \"eter, which is the route template \\nto add to that component. \\n\\n@page \\\"/counter\\\" \\n\\nThe route template\", \" parameter is required. Unlike ASP.NET Web Forms, the route to a Blazor \\ncomponent isn\\u2019t inferred fr\", \"om its file location (although that may be a feature added in the future). \\n\\nThe route template synt\", \"ax is the same basic syntax used for routing in ASP.NET Web Forms. Route \\nparameters are specified i\", \"n the template using braces. Blazor will bind route values to component \\nparameters with the same na\", \"me (case-insensitive). \\n\\n@page \\\"/product/{id}\\\" \\n\\n<h1>Product @Id</h1> \\n\\n@code { \\n    [Parameter] \\n  \", \"  public string Id { get; set; } \\n} \\n\\nYou can also specify constraints on the value of the route par\", \"ameter. For example, to constrain the \\nproduct ID to be an int: \\n\\n41 \\n\\nCHAPTER 7 | Pages, routing, a\", \"nd layouts \\n\\n \\n \\n \\n \\n \\n \\n \\n\\f@page \\\"/product/{id:int}\\\" \\n\\n<h1>Product @Id</h1> \\n\\n@code { \\n    [Paramet\", \"er] \\n    public int Id { get; set; } \\n} \\n\\nFor a full list of the route constraints supported by Blaz\", \"or, see Route constraints. \\n\\nRouter component \\n\\nRouting in Blazor is handled by the Router component\", \". The Router component is typically used in the \\napp\\u2019s root component (App.razor). \\n\\n<Router AppAsse\", \"mbly=\\\"@typeof(Program).Assembly\\\"> \\n    <Found Context=\\\"routeData\\\"> \\n        <RouteView RouteData=\\\"@r\", \"outeData\\\" DefaultLayout=\\\"@typeof(MainLayout)\\\" /> \\n    </Found> \\n    <NotFound> \\n        <LayoutView \", \"Layout=\\\"@typeof(MainLayout)\\\"> \\n            <p>Sorry, there's nothing at this address.</p> \\n        <\", \"/LayoutView> \\n    </NotFound> \\n</Router> \\n\\nThe Router component discovers the routable components in\", \" the specified AppAssembly and in the \\noptionally specified AdditionalAssemblies. When the browser n\", \"avigates, the Router intercepts the \\nnavigation and renders the contents of its Found parameter with\", \" the extracted RouteData if a route \\nmatches the address, otherwise the Router renders its NotFound \", \"parameter. \\n\\nThe RouteView component handles rendering the matched component specified by the RouteD\", \"ata \\nwith its layout if it has one. If the matched component doesn\\u2019t have a layout, then the optiona\", \"lly \\nspecified DefaultLayout is used. \\n\\nThe LayoutView component renders its child content within th\", \"e specified layout. We\\u2019ll look at layouts \\nmore in detail later in this chapter. \\n\\nNavigation \\n\\nIn A\", \"SP.NET Web Forms, you trigger navigation to a different page by returning a redirect response to \\nth\", \"e browser. For example: \\n\\nprotected void NavigateButton_Click(object sender, EventArgs e) \\n{ \\n    Re\", \"sponse.Redirect(\\\"Counter\\\"); \\n} \\n\\nReturning a redirect response isn\\u2019t typically possible in Blazor. B\", \"lazor doesn\\u2019t use a request-reply \\nmodel. You can, however, trigger browser navigations directly, as\", \" you can with JavaScript. \\n\\n42 \\n\\nCHAPTER 7 | Pages, routing, and layouts \\n\\n \\n \\n \\n \\n\\fBlazor provides \", \"a NavigationManager service that can be used to: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nGet the current browser address \\n\", \"\\nGet the base address \\n\\nTrigger navigations \\n\\nGet notified when the address changes \\n\\nTo navigate to\", \" a different address, use the NavigateTo method: \\n\\n@page \\\"/\\\" \\n@inject NavigationManager NavigationMa\", \"nager \\n\\n<button @onclick=\\\"Navigate\\\">Navigate</button> \\n\\n@code { \\n    void Navigate() { \\n        Navi\", \"gationManager.NavigateTo(\\\"counter\\\"); \\n    } \\n} \\n\\nFor a description of all NavigationManager members,\", \" see URI and navigation state helpers. \\n\\nBase URLs \\n\\nIf your Blazor app is deployed under a base pat\", \"h, then you need to specify the base URL in the page \\nmetadata using the <base> tag for routing to w\", \"ork property. If the host page for the app is server-\\nrendered using Razor, then you can use the ~/ \", \"syntax to specify the app\\u2019s base address. If the host \\npage is static HTML, then you need to specify\", \" the base URL explicitly. \\n\\n<base href=\\\"~/\\\" /> \\n\\nPage layout \\n\\nPage layout in ASP.NET Web Forms is h\", \"andled by Master Pages. Master Pages define a template with \\none or more content placeholders that c\", \"an then be supplied by individual pages. Master Pages are \\ndefined in .master files and start with t\", \"he <%@ Master %> directive. The content of the .master files is \\ncoded as you would an .aspx page, b\", \"ut with the addition of <asp:ContentPlaceHolder> controls to \\nmark where pages can supply content. \\n\", \"\\nSite.master \\n\\n<%@ Master Language=\\\"C#\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Site.master.cs\\\" \\nInherits\", \"=\\\"WebApplication1.SiteMaster\\\" %> \\n\\n<!DOCTYPE html> \\n<html lang=\\\"en\\\"> \\n<head runat=\\\"server\\\"> \\n    <me\", \"ta charset=\\\"utf-8\\\" /> \\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" /> \", \"\\n    <title><%: Page.Title %> - My ASP.NET Application</title> \\n    <link href=\\\"~/favicon.ico\\\" rel=\\\"\", \"shortcut icon\\\" type=\\\"image/x-icon\\\" /> \\n</head> \\n\\n43 \\n\\nCHAPTER 7 | Pages, routing, and layouts \\n\\n \\n \\n\", \" \\n \\n \\n\\f<body> \\n    <form runat=\\\"server\\\"> \\n        <div class=\\\"container body-content\\\"> \\n            \", \"<asp:ContentPlaceHolder ID=\\\"MainContent\\\" runat=\\\"server\\\"> \\n            </asp:ContentPlaceHolder> \\n   \", \"         <hr /> \\n            <footer> \\n                <p>&copy; <%: DateTime.Now.Year %> - My ASP.N\", \"ET Application</p> \\n            </footer> \\n        </div> \\n    </form> \\n</body> \\n</html> \\n\\nIn Blazor\", \", you handle page layout using layout components. Layout components inherit from \\nLayoutComponentBas\", \"e, which defines a single Body property of type RenderFragment, which can be \\nused to render the con\", \"tents of the page. \\n\\nMainLayout.razor \\n\\n@inherits LayoutComponentBase \\n<h1>Main layout</h1> \\n<div> \\n\", \"    @Body \\n</div> \\n\\nWhen the page with a layout is rendered, the page is rendered within the content\", \"s of the specified \\nlayout at the location where the layout renders its Body property. \\n\\nTo apply a \", \"layout to a page, use the @layout directive: \\n\\n@layout MainLayout \\n\\nYou can specify the layout for a\", \"ll components in a folder and subfolders using an *_Imports.razor* file. \\nYou can also specify a def\", \"ault layout for all your pages using the Router component. \\n\\nMaster Pages can define multiple conten\", \"t placeholders, but layouts in Blazor only have a single Body \\nproperty. This limitation of Blazor l\", \"ayout components will hopefully be addressed in a future release. \\n\\nMaster Pages in ASP.NET Web Form\", \"s can be nested. That is, a Master Page may also use a Master \\nPage. Layout components in Blazor may\", \" be nested too. You can apply a layout component to a layout \\ncomponent. The contents of the inner l\", \"ayout will be rendered within the outer layout. \\n\\nChildLayout.razor \\n\\n@layout MainLayout \\n<h2>Child \", \"layout</h2> \\n<div> \\n    @Body \\n</div> \\n\\nIndex.razor \\n\\n@page \\\"/\\\" \\n@layout ChildLayout \\n<p>I'm in a ne\", \"sted layout!</p> \\n\\nThe rendered output for the page would then be: \\n\\n44 \\n\\nCHAPTER 7 | Pages, routing\", \", and layouts \\n\\n \\n \\n\\f<h1>Main layout</h1> \\n<div> \\n    <h2>Child layout</h2> \\n    <div> \\n        <p>I\", \"'m in a nested layout!</p> \\n    </div> \\n</div> \\n\\nLayouts in Blazor don\\u2019t typically define the root H\", \"TML elements for a page (<html>, <body>, <head>, \\nand so on). The root HTML elements are instead def\", \"ined in a Blazor app\\u2019s host page, which is used to \\nrender the initial HTML content for the app (see\", \" Bootstrap Blazor). The host page can render multiple \\nroot components for the app with surrounding \", \"markup. \\n\\nComponents in Blazor, including pages, can\\u2019t render <script> tags. This rendering restrict\", \"ion exists \\nbecause <script> tags get loaded once and then can\\u2019t be changed. Unexpected behavior may\", \" occur if \\nyou try to render the tags dynamically using Razor syntax. Instead, all <script> tags sho\", \"uld be added \\nto the app\\u2019s host page. \\n\\n45 \\n\\nCHAPTER 7 | Pages, routing, and layouts \\n\\n \\n \\n\\fCHAPTER \", \" 8 \\n\\nState management \\n\\nState management is a key concept of Web Forms applications, facilitated thr\", \"ough ViewState, Session \\nState, Application State, and Postback features. These stateful features of\", \" the framework helped to \\nhide the state management required for an application and allow applicatio\", \"n developers to focus on \\ndelivering their functionality. With ASP.NET Core and Blazor, some of thes\", \"e features have been \\nrelocated and some have been removed altogether. This chapter reviews how to m\", \"aintain state and \\ndeliver the same functionality with the new features in Blazor. \\n\\nRequest state m\", \"anagement with ViewState \\n\\nWhen discussing state management in Web Forms application, many developer\", \"s will immediately \\nthink of ViewState. In Web Forms, ViewState manages the state of the content bet\", \"ween HTTP requests \\nby sending a large encoded block of text back and forth to the browser. The View\", \"State field could be \\noverwhelmed with content from a page containing many elements, potentially exp\", \"anding to several \\nmegabytes in size. \\n\\nWith Blazor Server, the app maintains an ongoing connection \", \"with the server. The app\\u2019s state, called a \\ncircuit, is held in server memory while the connection i\", \"s considered active. State will only be disposed \\nwhen the user navigates away from the app or a par\", \"ticular page in the app. All members of the active \\ncomponents are available between interactions wi\", \"th the server. \\n\\nThere are several advantages of this feature: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nComponent state is readily \", \"available and not rebuilt between interactions. \\n\\nState isn\\u2019t transmitted to the browser. \\n\\nHowever,\", \" there are some disadvantages to in-memory component state persistence to be aware of: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nIf \", \"the server restarts between request, state is lost. \\n\\nYour application web server load-balancing sol\", \"ution must include sticky sessions to ensure \\nthat all requests from the same browser return to the \", \"same server. If a request goes to a \\ndifferent server, state will be lost. \\n\\n\\u2022 \\n\\nPersistence of comp\", \"onent state on the server can lead to memory pressure on the web server. \\n\\nFor the preceding reasons\", \", don\\u2019t rely on just the state of the component to reside in-memory on the \\nserver. Your application\", \" should also include some backing data store for data between requests. Some \\nsimple examples of thi\", \"s strategy: \\n\\n\\u2022 \\n\\nIn a shopping cart application, persist the content of new items added to the cart\", \" in a \\ndatabase record. If the state on the server is lost, you can reconstitute it from the databas\", \"e \\nrecords. \\n\\n46 \\n\\nCHAPTER 8 | State management \\n\\n \\n \\n\\f\\u2022 \\n\\nIn a multi-part web form, your users will\", \" expect your application to remember values between \\neach request. Write the data between each of yo\", \"ur user\\u2019s posts to a data store so that they \\ncan be fetched and assembled into the final form respo\", \"nse structure when the multi-part \\nform is completed. \\n\\nFor additional details on managing state in \", \"Blazor apps, see ASP.NET Core Blazor state management. \\n\\nMaintain state with Session \\n\\nWeb Forms dev\", \"elopers could maintain information about the currently acting user with the \\nMicrosoft.AspNetCore.Ht\", \"tp.ISession dictionary object. It\\u2019s easy enough to add an object with a string \\nkey to the Session, \", \"and that object would be available at a later time during the user\\u2019s interactions \\nwith the applicat\", \"ion. In an attempt to eliminate managing interacting with HTTP, the Session object \\nmade it easy to \", \"maintain state. \\n\\nThe signature of the .NET Framework Session object isn\\u2019t the same as the ASP.NET C\", \"ore Session \\nobject. Consider the documentation for the new ASP.NET Core Session before deciding to \", \"migrate \\nand use the new session state feature. \\n\\nSession is available in ASP.NET Core and Blazor Se\", \"rver, but is discouraged from use in favor of storing \\ndata in a data repository appropriately. Sess\", \"ion state is also not functional if visitors decline the use \\nHTTP cookies in your application due t\", \"o privacy concerns. \\n\\nConfiguration for ASP.NET Core and Session state is available in the Session a\", \"nd state management in \\nASP.NET Core article. \\n\\nApplication state \\n\\nThe Application object in the We\", \"b Forms framework provides a massive, cross-request repository for \\ninteracting with application-sco\", \"pe configuration and state. Application state was an ideal place to \\nstore various application confi\", \"guration properties that would be referenced by all requests, regardless \\nof the user making the req\", \"uest. The problem with the Application object was that data didn\\u2019t persist \\nacross multiple servers.\", \" The state of the application object was lost between restarts. \\n\\nAs with Session, it\\u2019s recommended \", \"that data move to a persistent backing store that could be \\naccessed by multiple server instances. I\", \"f there is volatile data that you would like to be able to access \\nacross requests and users, you co\", \"uld easily store it in a singleton service that can be injected into \\ncomponents that require this i\", \"nformation or interaction. \\n\\nThe construction of an object to maintain application state and its con\", \"sumption could resemble the \\nfollowing implementation: \\n\\npublic class MyApplicationState \\n{ \\n    pub\", \"lic int VisitorCounter { get; private set; } = 0; \\n\\n    public void IncrementCounter() => VisitorCou\", \"nter += 1; \\n} \\n\\n47 \\n\\nCHAPTER 8 | State management \\n\\n \\n \\n \\n \\n \\n\\fapp.AddSingleton<MyApplicationState>(\", \"); \\n\\n@inject MyApplicationState AppState \\n\\n<label>Total Visitors: @AppState.VisitorCounter</label> \\n\", \"\\nThe MyApplicationState object is created only once on the server, and the value VisitorCounter is \\n\", \"fetched and output in the component\\u2019s label. The VisitorCounter value should be persisted and \\nretri\", \"eved from a backing data store for durability and scalability. \\n\\nIn the browser \\n\\nApplication data c\", \"an also be stored client-side on the user\\u2019s device so that is available later. There are \\ntwo browse\", \"r features that allow for persistence of data in different scopes of the user\\u2019s browser: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nl\", \"ocalStorage - scoped to the user\\u2019s entire browser. If the page is reloaded, the browser is \\nclosed a\", \"nd reopened, or another tab is opened with the same URL then the same \\nlocalStorage is provided by t\", \"he browser \\n\\nsessionStorage - scoped to the user\\u2019s current browser tab. If the tab is reloaded, the \", \"state \\npersists. However, if the user opens another tab to your application or closes and reopens th\", \"e \\nbrowser the state is lost. \\n\\nYou can write some custom JavaScript code to interact with these fea\", \"tures, or there are a number of \\nNuGet packages that you can use that provide this functionality. On\", \"e such package is \\nMicrosoft.AspNetCore.ProtectedBrowserStorage. \\n\\nFor instructions on utilizing thi\", \"s package to interact with localStorage and sessionStorage, see the \\nBlazor State Management article\", \". \\n\\n48 \\n\\nCHAPTER 8 | State management \\n\\n \\n \\n \\n \\n \\n\\fCHAPTER  9 \\n\\nForms and validation \\n\\nThe ASP.NET W\", \"eb Forms framework includes a set of validation server controls that handle validating \\nuser input e\", \"ntered into a form (RequiredFieldValidator, CompareValidator, RangeValidator, and so on). \\nThe ASP.N\", \"ET Web Forms framework also supports model binding and validating the model based on \\ndata annotatio\", \"ns ([Required], [StringLength], [Range], and so on). The validation logic can be enforced \\nboth on t\", \"he server and on the client using unobtrusive JavaScript-based validation. The \\nValidationSummary se\", \"rver control is used to display a summary of the validation errors to the user. \\n\\nBlazor supports th\", \"e sharing of validation logic between both the client and the server. ASP.NET \\nprovides pre-built Ja\", \"vaScript implementations of many common server validations. In many cases, the \\ndeveloper still has \", \"to write JavaScript to fully implement their app-specific validation logic. The same \\nmodel types, d\", \"ata annotations, and validation logic can be used on both the server and client. \\n\\nBlazor provides a\", \" set of input components. The input components handle binding field data to a \\nmodel and validating \", \"the user input when the form is submitted. \\n\\nInput component \\n\\nRendered HTML element \\n\\nInputCheckbox\", \" \\n\\nInputDate \\n\\nInputNumber \\n\\nInputSelect \\n\\nInputText \\n\\nInputTextArea \\n\\n<input type=\\\"checkbox\\\"> \\n\\n<in\", \"put type=\\\"date\\\"> \\n\\n<input type=\\\"number\\\"> \\n\\n<select> \\n\\n<input> \\n\\n<textarea> \\n\\nThe EditForm component \", \"wraps these input components and orchestrates the validation process \\nthrough an EditContext. When c\", \"reating an EditForm, you specify what model instance to bind to using \\nthe Model parameter. Validati\", \"on is typically done using data annotations, and it\\u2019s extensible. To \\nenable data annotation-based v\", \"alidation, add the DataAnnotationsValidator component as a child of \\nthe EditForm. The EditForm comp\", \"onent provides a convenient event for handling valid \\n(OnValidSubmit) and invalid (OnInvalidSubmit) \", \"submissions. There\\u2019s also a more generic OnSubmit \\nevent that lets you trigger and handle the valida\", \"tion yourself. \\n\\nTo display a validation error summary, use the ValidationSummary component. To disp\", \"lay validation \\nmessages for a specific input field, use the ValidationMessage component, specifying\", \" a lambda \\nexpression for the For parameter that points to the appropriate model member. \\n\\nThe follo\", \"wing model type defines several validation rules using data annotations: \\n\\n49 \\n\\nCHAPTER 9 | Forms an\", \"d validation \\n\\n \\n \\n\\fusing System; \\nusing System.ComponentModel.DataAnnotations; \\n\\npublic class Stars\", \"hip \\n{ \\n    [Required] \\n    [StringLength(16, \\n        ErrorMessage = \\\"Identifier too long (16 chara\", \"cter limit).\\\")] \\n    public string Identifier { get; set; } \\n\\n    public string Description { get; s\", \"et; } \\n\\n    [Required] \\n    public string Classification { get; set; } \\n\\n    [Range(1, 100000, \\n    \", \"    ErrorMessage = \\\"Accommodation invalid (1-100000).\\\")] \\n    public int MaximumAccommodation { get;\", \" set; } \\n\\n    [Required] \\n    [Range(typeof(bool), \\\"true\\\", \\\"true\\\", \\n        ErrorMessage = \\\"This for\", \"m disallows unapproved ships.\\\")] \\n    public bool IsValidatedDesign { get; set; } \\n\\n    [Required] \\n\", \"    public DateTime ProductionDate { get; set; } \\n} \\n\\nThe following component demonstrates building \", \"a form in Blazor based on the Starship model type: \\n\\n<h1>New Ship Entry Form</h1> \\n\\n<EditForm Model=\", \"\\\"@starship\\\" OnValidSubmit=\\\"@HandleValidSubmit\\\"> \\n    <DataAnnotationsValidator /> \\n    <ValidationSu\", \"mmary /> \\n\\n    <p> \\n        <label for=\\\"identifier\\\">Identifier: </label> \\n        <InputText id=\\\"ide\", \"ntifier\\\" @bind-Value=\\\"starship.Identifier\\\" /> \\n        <ValidationMessage For=\\\"() => starship.Identi\", \"fier\\\" /> \\n    </p> \\n    <p> \\n        <label for=\\\"description\\\">Description (optional): </label> \\n    \", \"    <InputTextArea id=\\\"description\\\" @bind-Value=\\\"starship.Description\\\" /> \\n    </p> \\n    <p> \\n      \", \"  <label for=\\\"classification\\\">Primary Classification: </label> \\n        <InputSelect id=\\\"classificat\", \"ion\\\" @bind-Value=\\\"starship.Classification\\\"> \\n            <option value=\\\"\\\">Select classification ...<\", \"/option> \\n            <option value=\\\"Exploration\\\">Exploration</option> \\n            <option value=\\\"D\", \"iplomacy\\\">Diplomacy</option> \\n            <option value=\\\"Defense\\\">Defense</option> \\n        </InputS\", \"elect> \\n        <ValidationMessage For=\\\"() => starship.Classification\\\" /> \\n    </p> \\n    <p> \\n      \", \"  <label for=\\\"accommodation\\\">Maximum Accommodation: </label> \\n        <InputNumber id=\\\"accommodation\", \"\\\" @bind-Value=\\\"starship.MaximumAccommodation\\\" /> \\n        <ValidationMessage For=\\\"() => starship.Max\", \"imumAccommodation\\\" /> \\n    </p> \\n\\n50 \\n\\nCHAPTER 9 | Forms and validation \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\f    <\", \"p> \\n        <label for=\\\"valid\\\">Engineering Approval: </label> \\n        <InputCheckbox id=\\\"valid\\\" @bi\", \"nd-Value=\\\"starship.IsValidatedDesign\\\" /> \\n        <ValidationMessage For=\\\"() => starship.IsValidated\", \"Design\\\" /> \\n    </p> \\n    <p> \\n        <label for=\\\"productionDate\\\">Production Date: </label> \\n      \", \"  <InputDate id=\\\"productionDate\\\" @bind-Value=\\\"starship.ProductionDate\\\" /> \\n        <ValidationMessag\", \"e For=\\\"() => starship.ProductionDate\\\" /> \\n    </p> \\n\\n    <button type=\\\"submit\\\">Submit</button> \\n</Ed\", \"itForm> \\n\\n@code { \\n    private Starship starship = new Starship(); \\n\\n    private void HandleValidSub\", \"mit() \\n    { \\n        // Save the data \\n    } \\n} \\n\\nAfter the form submission, the model-bound data h\", \"asn\\u2019t been saved to any data store, like a \\ndatabase. In a Blazor WebAssembly app, the data must be \", \"sent to the server. For example, using an \\nHTTP POST request. In a Blazor Server app, the data is al\", \"ready on the server, but it must be persisted. \\nHandling data access in Blazor apps is the subject o\", \"f the Dealing with data section. \\n\\nAdditional resources \\n\\nFor more information on forms and validati\", \"on in Blazor apps, see the Blazor documentation. \\n\\n51 \\n\\nCHAPTER 9 | Forms and validation \\n\\n \\n \\n \\n \\n \", \"\\n\\fCHAPTER  10 \\n\\nWork with data \\n\\nData access is the backbone of an ASP.NET Web Forms app. If you\\u2019re \", \"building forms for the web, what \\nhappens to that data? With Web Forms, there were multiple data acc\", \"ess techniques you could use to \\ninteract with a database: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nData Sources \\n\\nADO.NET \\n\\nEn\", \"tity Framework \\n\\nData Sources were controls that you could place on a Web Forms page and configure l\", \"ike other \\ncontrols. Visual Studio provided a friendly set of dialogs to configure and bind the cont\", \"rols to your \\nWeb Forms pages. Developers who enjoy a \\u201clow code\\u201d or \\u201cno code\\u201d approach preferred thi\", \"s \\ntechnique when Web Forms was first released. \\n\\nADO.NET is the low-level approach to interacting w\", \"ith a database. Your apps could create a \\nconnection to the database with Commands, Datatables, and \", \"Datasets for interacting. The results \\ncould then be bound to fields on screen without much code. Th\", \"e drawback of this approach was that \\neach set of ADO.NET objects (Connection, Command, and DataTabl\", \"e) was bound to libraries provided \\nby a database vendor. Use of these components made the code rigi\", \"d and difficult to migrate to a \\ndifferent database. \\n\\nEntity Framework \\n\\nEntity Framework (EF) is t\", \"he open source object-relational mapping framework maintained by the \\n.NET Foundation. Initially rel\", \"eased with .NET Framework, EF allows for generating code for the \\ndatabase connections, storage sche\", \"mas, and interactions. With this abstraction, you can focus on your \\n\\n52 \\n\\nCHAPTER 10 | Work with da\", \"ta \\n\\n \\n \\n \\n\\fapp\\u2019s business rules and allow the database to be managed by a trusted database administ\", \"rator. In \\n.NET, you can use an updated version of EF called EF Core. EF Core helps generate and mai\", \"ntain the \\ninteractions between your code and the database with a series of commands that are availa\", \"ble for you \\nusing the dotnet ef command-line tool. Let\\u2019s take a look at a few samples to get you wo\", \"rking with a \\ndatabase. \\n\\nEF Code First \\n\\nA quick way to get started building your database interact\", \"ions is to start with the class objects you \\nwant to work with. EF provides a tool to help generate \", \"the appropriate database code for your classes. \\nThis approach is called \\u201cCode First\\u201d development. C\", \"onsider the following Product class for a sample \\nstorefront app that we want to store in a relation\", \"al database like Microsoft SQL Server. \\n\\npublic class Product \\n{ \\n    public int Id { get; set; } \\n\\n\", \"    [Required] \\n    public string Name { get; set; } \\n\\n    [MaxLength(4000)] \\n    public string Desc\", \"ription { get; set; } \\n\\n    [Range(0, 99999,99)] \\n    [DataType(DataType.Currency)] \\n    public deci\", \"mal Price { get; set; } \\n} \\n\\nProduct has a primary key and three additional fields that would be cre\", \"ated in our database: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nEF will identify the Id property as a primary key by convent\", \"ion. \\n\\nName will be stored in a column configured for text storage. The [Required] attribute \\ndecora\", \"ting this property will add a not null constraint to help enforce this declared behavior \\nof the pro\", \"perty. \\n\\nDescription will be stored in a column configured for text storage, and have a maximum \\nlen\", \"gth configured of 4000 characters as dictated by the [MaxLength] attribute. The database \\nschema wil\", \"l be configured with a column named MaxLength using data type varchar(4000). \\n\\nThe Price property wi\", \"ll be stored as currency. The [Range] attribute will generate appropriate \\nconstraints to prevent da\", \"ta storage outside of the minimum and maximum values declared. \\n\\nWe need to add this Product class t\", \"o a database context class that defines the connection and \\ntranslation operations with our database\", \". \\n\\npublic class MyDbContext : DbContext \\n{ \\n    public DbSet<Product> Products { get; set; } \\n} \\n\\nT\", \"he MyDbContext class provides the one property that defines the access and translation for the \\nProd\", \"uct class. Your application configures this class for interaction with the database using the \\nfollo\", \"wing entries in the Startup class\\u2019s ConfigureServices method (or appropriate location in \\nProgram.cs\", \" using the builder.Services property instead of services): \\n\\n53 \\n\\nCHAPTER 10 | Work with data \\n\\n \\n \\n\", \" \\n \\n \\n\\fservices.AddDbContext<MyDbContext>(options => \\n    options.UseSqlServer(\\\"MY DATABASE CONNECTI\", \"ON STRING\\\")); \\n\\nThe preceding code will connect to a SQL Server database with the specified connecti\", \"on string. You \\ncan place the connection string in your appsettings.json file, environment variables\", \", or other \\nconfiguration storage locations and replace this embedded string appropriately. \\n\\nYou ca\", \"n then generate the database table appropriate for this class using the following commands: \\n\\ndotnet\", \" ef migrations add 'Create Product table' \\ndotnet ef database update \\n\\nThe first command defines the\", \" changes you\\u2019re making to the database schema as a new EF Migration \\ncalled Create Product table. A \", \"Migration defines how to apply and remove your new database \\nchanges. \\n\\nOnce applied, you have a sim\", \"ple Product table in your database and some new classes added to the \\nproject that help manage the d\", \"atabase schema. You can find these generated classes, by default, in a \\nnew folder called Migrations\", \". When you make changes to the Product class or add more related \\nclasses you would like interacting\", \" with your database, you need to run the command-line commands \\nagain with a new name of the migrati\", \"on. This command will generate another set of migration classes \\nto update your database schema. \\n\\nE\", \"F Database First \\n\\nFor existing databases, you can generate the classes for EF Core by using the .NE\", \"T command-line \\ntools. To scaffold the classes, use a variation of the following command: \\n\\ndotnet e\", \"f dbcontext scaffold \\\"CONNECTION STRING\\\" Microsoft.EntityFrameworkCore.SqlServer -c \\nMyDbContext -t \", \"Product -t Customer \\n\\nThe preceding command connects to the database using the specified connection \", \"string and the \\nMicrosoft.EntityFrameworkCore.SqlServer provider. Once connected, a database context\", \" class named \\nMyDbContext is created. Additionally, supporting classes are created for the Product a\", \"nd Customer \\ntables that were specified with the -t options. There are many configuration options fo\", \"r this command \\nto generate the class hierarchy appropriate for your database. For a complete refere\", \"nce, see the \\ncommand\\u2019s documentation. \\n\\nMore information about EF Core can be found on the Microsof\", \"t Docs site. \\n\\nInteract with web services \\n\\nWhen ASP.NET was first released, SOAP services were the \", \"preferred way for web servers and clients to \\nexchange data. Much has changed since that time, and t\", \"he preferred interactions with services have \\nshifted to direct HTTP client interactions. With ASP.N\", \"ET Core and Blazor, you can register the \\nconfiguration of your HttpClient in Program.cs or in the S\", \"tartup class\\u2019s ConfigureServices method. Use \\nthat configuration when you need to interact with the \", \"HTTP endpoint. Consider the following \\nconfiguration code: \\n\\n54 \\n\\nCHAPTER 10 | Work with data \\n\\n \\n \\n\", \"\\f// in Program.cs \\nbuilder.Services.AddHttpClient(\\\"github\\\", client => \\n{ \\n    client.BaseAddress = n\", \"ew Uri(\\\"http://api.github.com/\\\"); \\n    // Github API versioning \\n    client.DefaultRequestHeaders.Ad\", \"d(\\\"Accept\\\", \\\"application/vnd.github.v3+json\\\"); \\n    // Github requires a user-agent \\n    client.Defa\", \"ultRequestHeaders.Add(\\\"User-Agent\\\", \\\"BlazorWebForms-Sample\\\"); \\n}); \\n\\nWhenever you need to access dat\", \"a from GitHub, create a client with a name of github. The client is \\nconfigured with the base addres\", \"s, and the request headers are set appropriately. Inject the \\nIHttpClientFactory into your Blazor co\", \"mponents with the @inject directive or an [Inject] attribute on a \\nproperty. Create your named clien\", \"t and interact with services using the following syntax: \\n\\n@inject IHttpClientFactory factory \\n\\n... \", \"\\n\\n@code { \\n    protected override async Task OnInitializedAsync() \\n    { \\n        var client = facto\", \"ry.CreateClient(\\\"github\\\"); \\n        var response = await client.GetAsync(\\\"repos/dotnet/docs/issues\\\")\", \"; \\n        response.EnsureStatusCode(); \\n        var content = await response.Content.ReadAsStringAs\", \"ync(); \\n    } \\n} \\n\\nThis method returns the string describing the collection of issues in the dotnet/\", \"docs GitHub repository. \\nIt returns content in JSON format and is deserialized into appropriate GitH\", \"ub issue objects. There are \\nmany ways that you can configure the HttpClientFactory to deliver preco\", \"nfigured HttpClient objects. \\nTry configuring multiple HttpClient instances with different names and\", \" endpoints for the various web \\nservices you work with. This approach will make your interactions wi\", \"th those services easier to work \\nwith on each page. For more information, see Make HTTP requests us\", \"ing IHttpClientFactory. \\n\\n55 \\n\\nCHAPTER 10 | Work with data \\n\\n \\n \\n \\n \\n\\fCHAPTER  11 \\n\\nModules, handler\", \"s, and \\nmiddleware \\n\\nAn ASP.NET Core app is built upon a series of middleware. Middleware is handler\", \"s that are arranged \\ninto a pipeline to handle requests and responses. In a Web Forms app, HTTP hand\", \"lers and modules \\nsolve similar problems. In ASP.NET Core, modules, handlers, Global.asax.cs, and th\", \"e app life cycle are \\nreplaced with middleware. In this chapter, you\\u2019ll learn about middleware in th\", \"e context of a Blazor \\napp. \\n\\nOverview \\n\\nThe ASP.NET Core request pipeline consists of a sequence of\", \" request delegates, called one after the \\nother. The following diagram demonstrates the concept. The\", \" thread of execution follows the black \\narrows. \\n\\n56 \\n\\nCHAPTER 11 | Modules, handlers, and middlewar\", \"e \\n\\n \\n \\n\\fThe preceding diagram lacks a concept of lifecycle events. This concept is foundational to \", \"how \\nASP.NET Web Forms requests are handled. This system makes it easier to reason about what proces\", \"s \\nis occurring and allows middleware to be inserted at any point. Middleware executes in the order \", \"in \\nwhich it\\u2019s added to the request pipeline. They\\u2019re also added in code instead of configuration fi\", \"les, \\nusually in Startup.cs. \\n\\nKatana \\n\\nReaders familiar with Katana will feel comfortable in ASP.NE\", \"T Core. In fact, Katana is a framework from \\nwhich ASP.NET Core derives. It introduced similar middl\", \"eware and pipeline patterns for ASP.NET 4.x. \\nMiddleware designed for Katana can be adapted to work \", \"with the ASP.NET Core pipeline. \\n\\nCommon middleware \\n\\nASP.NET 4.x includes many modules. In a simila\", \"r fashion, ASP.NET Core has many middleware \\ncomponents available as well. IIS modules may be used i\", \"n some cases with ASP.NET Core. In other \\ncases, native ASP.NET Core middleware may be available. \\n\\n\", \"The following table lists replacement middleware and components in ASP.NET Core. \\n\\nModule \\n\\nASP.NET \", \"4.x module \\n\\nASP.NET Core option \\n\\nHTTP errors \\n\\nCustomErrorModule \\n\\nStatus Code Pages \\nMiddleware \\n\", \"\\n57 \\n\\nCHAPTER 11 | Modules, handlers, and middleware \\n\\n \\n \\n \\n\\fModule \\n\\nASP.NET 4.x module \\n\\nASP.NET \", \"Core option \\n\\nDefault document \\n\\nDefaultDocumentModule \\n\\nDefault Files Middleware \\n\\nDirectory browsi\", \"ng \\n\\nDirectoryListingModule \\n\\nDynamic compression \\n\\nDynamicCompressionModule \\n\\nDirectory Browsing \\nM\", \"iddleware \\n\\nResponse Compression \\nMiddleware \\n\\nFailed requests tracing \\n\\nFailedRequestsTracingModule\", \" \\n\\nASP.NET Core Logging \\n\\nFile caching \\n\\nFileCacheModule \\n\\nHTTP caching \\n\\nHttpCacheModule \\n\\nResponse\", \" Caching \\nMiddleware \\n\\nResponse Caching \\nMiddleware \\n\\nHTTP logging \\n\\nHttpLoggingModule \\n\\nASP.NET Cor\", \"e Logging \\n\\nHTTP redirection \\n\\nHttpRedirectionModule \\n\\nISAPI filters \\n\\nISAPI \\n\\nIsapiFilterModule \\n\\nI\", \"sapiModule \\n\\nRequest filtering \\n\\nRequestFilteringModule \\n\\nURL rewriting\\u2020 \\n\\nRewriteModule \\n\\nStatic co\", \"mpression \\n\\nStaticCompressionModule \\n\\nStatic content \\n\\nStaticFileModule \\n\\nURL Rewriting \\nMiddleware \", \"\\n\\nMiddleware \\n\\nMiddleware \\n\\nURL Rewriting \\nMiddleware IRule \\n\\nURL Rewriting \\nMiddleware \\n\\nResponse C\", \"ompression \\nMiddleware \\n\\nStatic File Middleware \\n\\nURL authorization \\n\\nUrlAuthorizationModule \\n\\nASP.N\", \"ET Core Identity \\n\\nThis list isn\\u2019t exhaustive but should give an idea of what mapping exists between\", \" the two frameworks. \\nFor a more detailed list, see IIS modules with ASP.NET Core. \\n\\nCustom middlewa\", \"re \\n\\nBuilt-in middleware may not handle all scenarios needed for an app. In such cases, it makes sen\", \"se to \\ncreate your own middleware. There are multiple ways of defining middleware, with the simplest\", \" being \\na simple delegate. Consider the following middleware, which accepts a culture request from a\", \" query \\nstring: \\n\\npublic class Startup \\n{ \\n    public void Configure(IApplicationBuilder app) \\n    {\", \" \\n        app.Use(async (context, next) => \\n        { \\n            var cultureQuery = context.Reques\", \"t.Query[\\\"culture\\\"]; \\n\\n58 \\n\\nCHAPTER 11 | Modules, handlers, and middleware \\n\\n \\n \\n\\f            if (!st\", \"ring.IsNullOrWhiteSpace(cultureQuery)) \\n            { \\n                var culture = new CultureInfo\", \"(cultureQuery); \\n\\n                CultureInfo.CurrentCulture = culture; \\n                CultureInfo\", \".CurrentUICulture = culture; \\n            } \\n\\n            // Call the next delegate/middleware in th\", \"e pipeline \\n            await next(); \\n        }); \\n\\n        app.Run(async (context) => \\n           \", \" await context.Response.WriteAsync( \\n                $\\\"Hello {CultureInfo.CurrentCulture.DisplayName\", \"}\\\")); \\n    } \\n} \\n\\nMiddleware can also be defined as class, either by implementing the IMiddleware in\", \"terface or by \\nfollowing middleware convention. For more information, see Write custom ASP.NET Core \", \"middleware. \\n\\n59 \\n\\nCHAPTER 11 | Modules, handlers, and middleware \\n\\n \\n \\n \\n \\n \\n \\n\\fCHAPTER  12 \\n\\nApp c\", \"onfiguration \\n\\nThe primary way to load app configuration in Web Forms is with entries in the web.con\", \"fig file\\u2014either \\non the server or a related configuration file referenced by web.config. You can use\", \" the static \\nConfigurationManager object to interact with app settings, data repository connection s\", \"trings, and \\nother extended configuration providers that are added into the app. It\\u2019s typical to see\", \" interactions \\nwith app configuration as seen in the following code: \\n\\nvar configurationValue = Conf\", \"igurationManager.AppSettings[\\\"ConfigurationSettingName\\\"]; \\nvar connectionString = \\nConfigurationMana\", \"ger.ConnectionStrings[\\\"MyDatabaseConnectionName\\\"].ConnectionString; \\n\\nWith ASP.NET Core and server-s\", \"ide Blazor, the web.config file MAY be present if your app is hosted on \\na Windows IIS server. Howev\", \"er, there\\u2019s no ConfigurationManager interaction with this configuration, \\nand you can receive more s\", \"tructured app configuration from other sources. Let\\u2019s take a look at how \\nconfiguration is gathered \", \"and how you can still access configuration information from a web.config \\nfile. \\n\\nConfiguration sour\", \"ces \\n\\nASP.NET Core recognizes there are many configuration sources you may want to use for your app.\", \" The \\nframework attempts to offer you the best of these features by default. Configuration is read a\", \"nd \\naggregated from these various sources by ASP.NET Core. Later loaded values for the same \\nconfigu\", \"ration key take precedence over earlier values. \\n\\nASP.NET Core was designed to be cloud-aware and to\", \" make the configuration of apps easier for both \\noperators and developers. ASP.NET Core is environme\", \"nt-aware and knows if it\\u2019s running in your \\nProduction or Development environment. The environment i\", \"ndicator is set in the \\nASPNETCORE_ENVIRONMENT system environment variable. If no value is configure\", \"d, the app defaults \\nto running in the Production environment. \\n\\nYour app can trigger and add config\", \"uration from several sources based on the environment\\u2019s name. \\nBy default, the configuration is load\", \"ed from the following resources in the order listed: \\n\\n1. \\n\\n2. \\n\\nappsettings.json file, if present \\n\", \"\\nappsettings.{ENVIRONMENT_NAME}.json file, if present \\n\\n3.  User secrets file on disk, if present \\n\\n\", \"4. \\n\\n5. \\n\\nEnvironment variables \\n\\nCommand-line arguments \\n\\n60 \\n\\nCHAPTER 12 | App configuration \\n\\n \\n \", \"\\n\\fappsettings.json format and access \\n\\nThe appsettings.json file can be hierarchical with values str\", \"uctured like the following JSON: \\n\\n{ \\n  \\\"section0\\\": { \\n    \\\"key0\\\": \\\"value\\\", \\n    \\\"key1\\\": \\\"value\\\" \\n  \", \"}, \\n  \\\"section1\\\": { \\n    \\\"key0\\\": \\\"value\\\", \\n    \\\"key1\\\": \\\"value\\\" \\n  } \\n} \\n\\nWhen presented with the pre\", \"ceding JSON, the configuration system flattens child values and \\nreferences their fully qualified hi\", \"erarchical paths. A colon (:) character separates each property in the \\nhierarchy. For example, the \", \"configuration key section1:key0 accesses the section1 object literal\\u2019s key0 \\nvalue. \\n\\nUser secrets \\n\", \"\\nUser secrets are: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nConfiguration values that are stored in a JSON file on the develope\", \"r\\u2019s workstation, outside of \\nthe app development folder. \\n\\nOnly loaded when running in the Developme\", \"nt environment. \\n\\nAssociated with a specific app. \\n\\n\\u2022  Managed with the .NET CLI\\u2019s user-secrets comm\", \"and. \\n\\nConfigure your app for secrets storage by executing the user-secrets command: \\n\\ndotnet user-s\", \"ecrets init \\n\\nThe preceding command adds a UserSecretsId element to the project file. The element co\", \"ntains a \\nGUID, which is used to associate secrets with the app. You can then define a secret with t\", \"he set \\ncommand. For example: \\n\\ndotnet user-secrets set \\\"Parent:ApiKey\\\" \\\"12345\\\" \\n\\nThe preceding comm\", \"and makes the Parent:ApiKey configuration key available on a developer\\u2019s \\nworkstation with the value\", \" 12345. \\n\\nFor more information about creating, storing, and managing user secrets, see the Safe stor\", \"age of app \\nsecrets in development in ASP.NET Core document. \\n\\nEnvironment variables \\n\\nThe next set \", \"of values loaded into your app configuration is the system\\u2019s environment variables. All of \\nyour sys\", \"tem\\u2019s environment variable settings are now accessible to you through the configuration API. \\n\\n61 \\n\\n\", \"CHAPTER 12 | App configuration \\n\\n \\n \\n\\fHierarchical values are flattened and separated by colon chara\", \"cters when read inside your app. \\nHowever, some operating systems don\\u2019t allow the colon character en\", \"vironment variable names. \\nASP.NET Core addresses this limitation by converting values that have dou\", \"ble-underscores (__) into a \\ncolon when they\\u2019re accessed. The Parent:ApiKey value from the user secr\", \"ets section above can be \\noverridden with the environment variable Parent__ApiKey. \\n\\nCommand-line ar\", \"guments \\n\\nConfiguration can also be provided as command-line arguments when your app is started. Use\", \" the \\ndouble-dash (--) or forward-slash (/) notation to indicate the name of the configuration value\", \" to set \\nand the value to be configured. The syntax resembles the following commands: \\n\\ndotnet run C\", \"ommandLineKey1=value1 --CommandLineKey2=value2 /CommandLineKey3=value3 \\ndotnet run --CommandLineKey1\", \" value1 /CommandLineKey2 value2 \\ndotnet run Parent:ApiKey=67890 \\n\\nThe return of web.config \\n\\nIf you\\u2019\", \"ve deployed your app to Windows on IIS, the web.config file still configures IIS to manage your \\napp\", \". By default, IIS adds a reference to the ASP.NET Core Module (ANCM). ANCM is a native IIS \\nmodule t\", \"hat hosts your app in place of the Kestrel web server. This web.config section resembles the \\nfollow\", \"ing XML markup: \\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> \\n<configuration> \\n  <location path=\\\".\\\" inhe\", \"ritInChildApplications=\\\"false\\\"> \\n    <system.webServer> \\n      <handlers> \\n        <add name=\\\"aspNet\", \"Core\\\" path=\\\"*\\\" verb=\\\"*\\\" modules=\\\"AspNetCoreModuleV2\\\" \\nresourceType=\\\"Unspecified\\\" /> \\n      </handler\", \"s> \\n      <aspNetCore processPath=\\\".\\\\MyApp.exe\\\" \\n                  stdoutLogEnabled=\\\"false\\\" \\n       \", \"           stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" \\n                  hostingModel=\\\"inprocess\\\" /> \\n    </syste\", \"m.webServer> \\n  </location> \\n</configuration> \\n\\nApp-specific configuration can be defined by nesting\", \" an environmentVariables element in the \\naspNetCore element. The values defined in this section are \", \"presented to the ASP.NET Core app as \\nenvironment variables. The environment variables load appropri\", \"ately during that segment of app \\nstartup. \\n\\n<aspNetCore processPath=\\\"dotnet\\\" \\n      arguments=\\\".\\\\My\", \"App.dll\\\" \\n      stdoutLogEnabled=\\\"false\\\" \\n      stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" \\n      hostingModel=\\\"i\", \"nprocess\\\"> \\n  <environmentVariables> \\n    <environmentVariable name=\\\"ASPNETCORE_ENVIRONMENT\\\" value=\\\"\", \"Development\\\" /> \\n\\n62 \\n\\nCHAPTER 12 | App configuration \\n\\n \\n \\n\\f    <environmentVariable name=\\\"Parent:A\", \"piKey\\\" value=\\\"67890\\\" /> \\n  </environmentVariables> \\n</aspNetCore> \\n\\nRead configuration in the app \\n\\n\", \"ASP.NET Core provides app configuration through the IConfiguration interface. This configuration \\nin\", \"terface should be requested by your Blazor components, Blazor pages, and any other ASP.NET Core-\\nman\", \"aged class that needs access to configuration. The ASP.NET Core framework will automatically \\npopula\", \"te this interface with the resolved configuration configured earlier. On a Blazor page or a \\ncompone\", \"nt\\u2019s Razor markup, you can inject the IConfiguration object with an @inject directive at the \\ntop of\", \" the .razor file like this: \\n\\n@inject IConfiguration Configuration \\n\\nThis preceding statement makes \", \"the IConfiguration object available as the Configuration variable \\nthroughout the rest of the Razor \", \"template. \\n\\nIndividual configuration settings can be read by specifying the configuration setting hi\", \"erarchy sought \\nas an indexer parameter: \\n\\nvar mySetting = Configuration[\\\"section1:key0\\\"]; \\n\\nYou can\", \" fetch entire configuration sections by using the GetSection method to retrieve a collection of \\nkey\", \"s at a specific location with a syntax similar to GetSection(\\\"section1\\\") to retrieve the configurati\", \"on \\nfor section1 from the earlier example. \\n\\nStrongly typed configuration \\n\\nWith Web Forms, it was p\", \"ossible to create a strongly typed configuration type that inherited from the \\nConfigurationSection \", \"type and associated types. A ConfigurationSection allowed you to configure \\nsome business rules and \", \"processing for those configuration values. \\n\\nIn ASP.NET Core, you can specify a class hierarchy that\", \" will receive the configuration values. These \\nclasses: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nDon\\u2019t need to inherit from a paren\", \"t class. \\n\\nShould include public properties that match the properties and type references for the \\nc\", \"onfiguration structure you wish to capture. \\n\\nFor the earlier appsettings.json sample, you could def\", \"ine the following classes to capture the values: \\n\\npublic class MyConfig \\n{ \\n    public MyConfigSect\", \"ion section0 { get; set;} \\n\\n    public MyConfigSection section1 { get; set;} \\n} \\n\\npublic class MyCon\", \"figSection \\n{ \\n\\n63 \\n\\nCHAPTER 12 | App configuration \\n\\n \\n \\n \\n \\n\\f    public string key0 { get; set; } \", \"\\n\\n    public string key1 { get; set; } \\n} \\n\\nThis class hierarchy can be populated by adding the foll\", \"owing line to the Startup.ConfigureServices \\nmethod (or appropriate location in Program.cs using the\", \" builder.Services property instead of services): \\n\\nservices.Configure<MyConfig>(Configuration); \\n\\nIn\", \" the rest of the app, you can add an input parameter to classes or an @inject directive in Razor \\nte\", \"mplates of type IOptions<MyConfig> to receive the strongly typed configuration settings. The \\nIOptio\", \"ns<MyConfig>.Value property will yield the MyConfig value populated from the configuration \\nsettings\", \". \\n\\n@inject IOptions<MyConfig> options \\n@code { \\n    var MyConfiguration = options.Value; \\n    var t\", \"heSetting = MyConfiguration.section1.key0; \\n} \\n\\nMore information about the Options feature can be fo\", \"und in the Options pattern in ASP.NET Core \\ndocument. \\n\\n64 \\n\\nCHAPTER 12 | App configuration \\n\\n \\n \\n \\n\", \"\\fCHAPTER  13 \\n\\nSecurity: Authentication \\nand Authorization in \\nASP.NET Web Forms and \\nBlazor \\n\\nMigra\", \"ting from an ASP.NET Web Forms application to Blazor will almost certainly require updating \\nhow aut\", \"hentication and authorization are performed, assuming the application had authentication \\nconfigured\", \". This chapter will cover how to migrate from the ASP.NET Web Forms universal provider \\nmodel (for m\", \"embership, roles, and user profiles) and how to work with ASP.NET Core Identity from \\nBlazor apps. W\", \"hile this chapter will cover the high-level steps and considerations, the detailed steps \\nand script\", \"s may be found in the referenced documentation. \\n\\nASP.NET universal providers \\n\\nSince ASP.NET 2.0, t\", \"he ASP.NET Web Forms platform has supported a provider model for a variety of \\nfeatures, including m\", \"embership. The universal membership provider, along with the optional role \\nprovider, is commonly de\", \"ployed with ASP.NET Web Forms applications. It offers a robust and secure \\nway to manage authenticat\", \"ion and authorization that continues to work well today. The most recent \\noffering of these universa\", \"l providers is available as a NuGet package, Microsoft.AspNet.Providers. \\n\\nThe Universal Providers w\", \"ork with a SQL database schema that includes tables like \\naspnet_Applications, aspnet_Membership, as\", \"pnet_Roles, and aspnet_Users. When configured by \\nrunning the aspnet_regsql.exe command, the provide\", \"rs install tables and stored procedures that \\nprovide all of the necessary queries and commands to w\", \"ork with the underlying data. The database \\nschema and these stored procedures are not compatible wi\", \"th newer ASP.NET Identity and ASP.NET \\nCore Identity systems, so existing data must be migrated into\", \" the new system. Figure 1 shows an \\nexample table schema configured for universal providers. \\n\\n65 \\n\\n\", \"CHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor \\n\\n \\n \\n\\fThe u\", \"niversal provider handles users, membership, roles, and profiles. Users are assigned globally \\nuniqu\", \"e identifiers and basic information like userId, userName etc. are stored in the aspnet_Users \\ntable\", \". Authentication information, such as password, password format, password salt, lockout counters \\nan\", \"d details, etc. are stored in the aspnet_Membership table. Roles consist simply of names and unique \", \"\\nidentifiers, which are assigned to users via the aspnet_UsersInRoles association table, providing a\", \" \\nmany-to-many relationship. \\n\\nIf your existing system is using roles in addition to membership, you\", \" will need to migrate the user \\naccounts, the associated passwords, the roles, and the role membersh\", \"ip into ASP.NET Core Identity. \\nYou will also most likely need to update your code where you\\u2019re curr\", \"ently performing role checks \\nusing if statements to instead leverage declarative filters, attribute\", \"s, and/or tag helpers. We will review \\nmigration considerations in greater detail at the end of this\", \" chapter. \\n\\nAuthorization configuration in Web Forms \\n\\nTo configure authorized access to certain pag\", \"es in an ASP.NET Web Forms application, typically you \\nspecify that certain pages or folders are ina\", \"ccessible to anonymous users. This configuration is done in \\nthe web.config file: \\n\\n<?xml version=\\\"1\", \".0\\\"?> \\n<configuration> \\n    <system.web> \\n      <authentication mode=\\\"Forms\\\"> \\n        <forms defaul\", \"tUrl=\\\"~/home.aspx\\\" loginUrl=\\\"~/login.aspx\\\" \\n          slidingExpiration=\\\"true\\\" timeout=\\\"2880\\\"></form\", \"s> \\n      </authentication> \\n\\n      <authorization> \\n        <deny users=\\\"?\\\" /> \\n      </authorizati\", \"on> \\n    </system.web> \\n</configuration> \\n\\nThe authentication configuration section sets up the form\", \"s authentication for the application. The \\nauthorization section is used to disallow anonymous users\", \" for the entire application. However, you \\ncan provide more granular authorization rules on a per-lo\", \"cation basis as well as apply role-based \\nauthorization checks. \\n\\n<location path=\\\"login.aspx\\\"> \\n  <s\", \"ystem.web> \\n\\n66 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and B\", \"lazor \\n\\n \\n \\n \\n \\n\\f    <authorization> \\n      <allow users=\\\"*\\\" /> \\n    </authorization> \\n  </system.we\", \"b> \\n</location> \\n\\nThe above configuration, when combined with the first one, would allow anonymous u\", \"sers to access \\nthe login page, overriding the site-wide restriction on non-authenticated users. \\n\\n<\", \"location path=\\\"/admin\\\"> \\n  <system.web> \\n    <authorization> \\n      <allow roles=\\\"Administrators\\\" />\", \" \\n      <deny users=\\\"*\\\" /> \\n    </authorization> \\n  </system.web> \\n</location> \\n\\nThe above configura\", \"tion, when combined with the others, restricts access to the /admin folder and all \\nresources within\", \" it to members of the \\u201cAdministrators\\u201d role. This restriction could also be applied by \\nplacing a se\", \"parate web.config file within the /admin folder root. \\n\\nAuthorization code in Web Forms \\n\\nIn additio\", \"n to configuring access using web.config, you can also programmatically configure access \\nand behavi\", \"or in your Web Forms application. For instance, you can restrict the ability to perform \\ncertain ope\", \"rations or view certain data based on the user\\u2019s role. \\n\\nThis code can be used both in code-behind l\", \"ogic as well as in the page itself: \\n\\n<% if (HttpContext.Current.User.IsInRole(\\\"Administrators\\\")) { \", \"%> \\n  <a href=\\\"/admin\\\">Go To Admin</a> \\n<% } %> \\n\\nIn addition to checking user role membership, you \", \"can also determine if they are authenticated \\n(though often this is better done using the location-b\", \"ased configuration covered above). Below is an \\nexample of this approach. \\n\\nprotected void Page_Load\", \"(object sender, EventArgs e) \\n{ \\n    if (!User.Identity.IsAuthenticated) \\n    { \\n        FormsAuthen\", \"tication.RedirectToLoginPage(); \\n    } \\n    if (!Roles.IsUserInRole(User.Identity.Name, \\\"Administrat\", \"ors\\\")) \\n    { \\n        MessageLabel.Text = \\\"Only administrators can view this.\\\"; \\n        SecretPane\", \"l.Visible = false; \\n    } \\n} \\n\\nIn the code above, role-based access control (RBAC) is used to determ\", \"ine whether certain elements of \\nthe page, such as a SecretPanel, are visible based on the current u\", \"ser\\u2019s role. \\n\\n67 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and \", \"Blazor \\n\\n \\n \\n\\fTypically, ASP.NET Web Forms applications configure security within the web.config fil\", \"e and then add \\nadditional checks where needed in .aspx pages and their related .aspx.cs code-behind\", \" files. Most \\napplications leverage the universal membership provider, frequently with the additiona\", \"l role provider. \\n\\nASP.NET Core Identity \\n\\nAlthough still tasked with authentication and authorizati\", \"on, ASP.NET Core Identity uses a different set \\nof abstractions and assumptions when compared to the\", \" universal providers. For example, the new \\nIdentity model supports third party authentication, allo\", \"wing users to authenticate using a social media \\naccount or other trusted authentication provider. A\", \"SP.NET Core Identity supports UI for commonly \\nneeded pages like login, logout, and register. It lev\", \"erages EF Core for its data access, and uses EF Core \\nmigrations to generate the necessary schema re\", \"quired to support its data model. This introduction to \\nIdentity on ASP.NET Core provides a good ove\", \"rview of what is included with ASP.NET Core Identity \\nand how to get started working with it. If you\", \" haven\\u2019t already set up ASP.NET Core Identity in your \\napplication and its database, it will help yo\", \"u get started. \\n\\nRoles, claims, and policies \\n\\nBoth the universal providers and ASP.NET Core Identit\", \"y support the concept of roles. You can create \\nroles for users and assign users to roles. Users can\", \" belong to any number of roles, and you can verify \\nrole membership as part of your authorization im\", \"plementation. \\n\\nIn addition to roles, ASP.NET Core identity supports the concepts of claims and poli\", \"cies. While a role \\nshould specifically correspond to a set of resources a user in that role should \", \"be able to access, a \\nclaim is simply part of a user\\u2019s identity. A claim is a name value pair that r\", \"epresents what the subject \\nis, not what the subject can do. \\n\\nIt is possible to directly inspect a \", \"user\\u2019s claims and determine based on these values whether a user \\nshould be given access to a resour\", \"ce. However, such checks are often repetitive and scattered \\nthroughout the system. A better approac\", \"h is to define a policy. \\n\\nAn authorization policy consists of one or more requirements. Policies ar\", \"e registered as part of the \\nauthorization service configuration in the ConfigureServices method of \", \"Startup.cs. For example, the \\nfollowing code snippet configures a policy called \\u201cCanadiansOnly\\u201d, whi\", \"ch has the requirement that the \\nuser has the Country claim with the value of \\u201cCanada\\u201d. \\n\\nservices.A\", \"ddAuthorization(options => \\n{ \\n    options.AddPolicy(\\\"CanadiansOnly\\\", policy => policy.RequireClaim(\", \"ClaimTypes.Country, \\n\\\"Canada\\\")); \\n}); \\n\\nYou can learn more about how to create custom policies in th\", \"e documentation. \\n\\nWhether you\\u2019re using policies or roles, you can specify that a particular page in\", \" your Blazor \\napplication requires that role or policy with the [Authorize] attribute, applied with \", \"the @attribute \\ndirective. \\n\\nRequiring a role: \\n\\n68 \\n\\nCHAPTER 13 | Security: Authentication and Auth\", \"orization in ASP.NET Web Forms and Blazor \\n\\n \\n \\n\\f@attribute [Authorize(Roles =\\\"administrators\\\")] \\n\\nR\", \"equiring a policy be satisfied: \\n\\n@attribute [Authorize(Policy =\\\"CanadiansOnly\\\")] \\n\\nIf you need acce\", \"ss to a user\\u2019s authentication state, roles, or claims in your code, there are two primary \\nways to a\", \"chieve this functionality. The first is to receive the authentication state as a cascading \\nparamete\", \"r. The second is to access the state using an injected AuthenticationStateProvider. The \\ndetails of \", \"each of these approaches are described in the Blazor Security documentation. \\n\\nThe following code sh\", \"ows how to receive the AuthenticationState as a cascading parameter: \\n\\n[CascadingParameter] \\nprivate\", \" Task<AuthenticationState> authenticationStateTask { get; set; } \\n\\nWith this parameter in place, you\", \" can get the user using this code: \\n\\nvar authState = await authenticationStateTask; \\nvar user = auth\", \"State.User; \\n\\nThe following code shows how to inject the AuthenticationStateProvider: \\n\\n@using Micro\", \"soft.AspNetCore.Components.Authorization \\n@inject AuthenticationStateProvider AuthenticationStatePro\", \"vider \\n\\nWith the provider in place, you can gain access to the user with the following code: \\n\\nAuthe\", \"nticationState authState = await \\nAuthenticationStateProvider.GetAuthenticationStateAsync(); \\nClaims\", \"Principal user = authState.User; \\n\\nif (user.Identity.IsAuthenticated) \\n{ \\n  // work with user.Claims\", \" and/or user.Roles \\n} \\n\\nNote: The AuthorizeView component, covered later in this chapter, provides a\", \" declarative way to \\ncontrol what a user sees on a page or component. \\n\\nTo work with users and claim\", \"s (in Blazor Server applications) you may also need to inject a \\nUserManager<T> (use IdentityUser fo\", \"r default) which you can use to enumerate and modify claims \\nfor a user. First inject the type and a\", \"ssign it to a property: \\n\\n@inject UserManager<IdentityUser> MyUserManager \\n\\nThen use it to work with\", \" the user\\u2019s claims. The following sample shows how to add and persist a claim \\non a user: \\n\\nprivate \", \"async Task AddCountryClaim() \\n{ \\n    var authState = await AuthenticationStateProvider.GetAuthentica\", \"tionStateAsync(); \\n    var user = authState.User; \\n    var identityUser = await MyUserManager.FindBy\", \"NameAsync(user.Identity.Name); \\n\\n    if (!user.HasClaim(c => c.Type == ClaimTypes.Country)) \\n    { \\n\", \"\\n69 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor \\n\\n \\n \\n\", \" \\n \\n\\f        // stores the claim in the cookie \\n        ClaimsIdentity id = new ClaimsIdentity(); \\n \", \"       id.AddClaim(new Claim(ClaimTypes.Country, \\\"Canada\\\")); \\n        user.AddIdentity(id); \\n\\n      \", \"  // save the claim in the database \\n        await MyUserManager.AddClaimAsync(identityUser, new Cla\", \"im(ClaimTypes.Country, \\n\\\"Canada\\\")); \\n    } \\n} \\n\\nIf you need to work with roles, follow the same appr\", \"oach. You may need to inject a RoleManager<T> \\n(use IdentityRole for default type) to list and manag\", \"e the roles themselves. \\n\\nNote: In Blazor WebAssembly projects, you will need to provide server APIs\", \" to perform these \\noperations (instead of using UserManager<T> or RoleManager<T> directly). A Blazor\", \" WebAssembly \\nclient application would manage claims and/or roles by securely calling API endpoints \", \"exposed for \\nthis purpose. \\n\\nMigration guide \\n\\nMigrating from ASP.NET Web Forms and universal provid\", \"ers to ASP.NET Core Identity requires several \\nsteps: \\n\\n1. \\n\\nCreate ASP.NET Core Identity database s\", \"chema in the destination database \\n\\n2.  Migrate data from universal provider schema to ASP.NET Core \", \"Identity schema \\n\\n3.  Migrate configuration from the web.config to middleware and services, typicall\", \"y in Program.cs \\n\\n(or a Startup class) \\n\\n4.  Update individual pages using controls and conditionals\", \" to use tag helpers and new identity \\n\\nAPIs. \\n\\nEach of these steps is described in detail in the fol\", \"lowing sections. \\n\\nCreating the ASP.NET Core Identity schema \\n\\nThere are several ways to create the \", \"necessary table structure used for ASP.NET Core Identity. The \\nsimplest is to create a new ASP.NET C\", \"ore Web application. Choose Web Application and then change \\nAuthentication type to use Individual A\", \"ccounts. \\n\\n70 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Bla\", \"zor \\n\\n \\n \\n \\n\\fFrom the command line, you can do the same thing by running dotnet new webapp -au Indiv\", \"idual. \\nOnce the app has been created, run it and register on the site. You should trigger a page li\", \"ke the one \\nshown below: \\n\\n71 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET W\", \"eb Forms and Blazor \\n\\n \\n \\n \\n\\fClick on the \\u201cApply Migrations\\u201d button and the necessary database table\", \"s should be created for you. \\nIn addition, the migration files should appear in your project, as sho\", \"wn: \\n\\n72 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor \\n\", \"\\n \\n \\n \\n\\fYou can run the migration yourself, without running the web application, using this command-\", \"line \\ntool: \\n\\ndotnet ef database update \\n\\nIf you would rather run a script to apply the new schema t\", \"o an existing database, you can script these \\nmigrations from the command-line. Run this command to \", \"generate the script: \\n\\ndotnet ef migrations script -o auth.sql \\n\\nThe above command will produce a SQ\", \"L script in the output file auth.sql, which can then be run \\nagainst whatever database you like. If \", \"you have any trouble running dotnet ef commands, make sure \\nyou have the EF Core tools installed on \", \"your system. \\n\\nIn the event you have additional columns on your source tables, you will need to iden\", \"tify the best \\nlocation for these columns in the new schema. Generally, columns found on the aspnet_\", \"Membership \\ntable should be mapped to the AspNetUsers table. Columns on aspnet_Roles should be mappe\", \"d to \\nAspNetRoles. Any additional columns on the aspnet_UsersInRoles table would be added to the \\nAs\", \"pNetUserRoles table. \\n\\nIt\\u2019s also worth considering putting any additional columns on separate tables\", \". So that future \\nmigrations won\\u2019t need to take into account such customizations of the default iden\", \"tity schema. \\n\\nMigrating data from universal providers to ASP.NET Core Identity \\n\\nOnce you have the \", \"destination table schema in place, the next step is to migrate your user and role \\nrecords to the ne\", \"w schema. A complete list of the schema differences, including which columns map \\nto which new colum\", \"ns, can be found here. \\n\\n73 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web\", \" Forms and Blazor \\n\\n \\n \\n \\n\\fTo migrate your users from membership to the new identity tables, you sho\", \"uld follow the steps \\ndescribed in the documentation. After following these steps and the script pro\", \"vided, your users will \\nneed to change their password the next time they log in. \\n\\nIt is possible to\", \" migrate user passwords but the process is much more involved. Requiring users to \\nupdate their pass\", \"words as part of the migration process, and encouraging them to use new, unique \\npasswords, is likel\", \"y to enhance the overall security of the application. \\n\\nMigrating security settings from web.config \", \"to app startup \\n\\nAs noted above, ASP.NET membership and role providers are configured in the applica\", \"tion\\u2019s \\nweb.config file. Since ASP.NET Core apps are not tied to IIS and use a separate system for \\n\", \"configuration, these settings must be configured elsewhere. For the most part, ASP.NET Core Identity\", \" \\nis configured in the Program.cs file. Open the web project that was created earlier (to generate t\", \"he \\nidentity table schema) and review its Program.cs (or Startup.cs) file. \\n\\nThis code adds support \", \"for EF Core and Identity: \\n\\n// Add services to the container. \\nvar connectionString = builder.Config\", \"uration.GetConnectionString(\\\"DefaultConnection\\\"); \\nbuilder.Services.AddDbContext<ApplicationDbContex\", \"t>(options => \\n    options.UseSqlServer(connectionString)); \\nbuilder.Services.AddDatabaseDeveloperPa\", \"geExceptionFilter(); \\nbuilder.Services.AddDefaultIdentity<IdentityUser>(options => \\n    options.Sign\", \"In.RequireConfirmedAccount = true) \\n    .AddEntityFrameworkStores<ApplicationDbContext>(); \\n\\nThe Add\", \"DefaultIdentity extension method is used to configure Identity to use the default \\nApplicationDbCont\", \"ext and the framework\\u2019s IdentityUser type. If you\\u2019re using a custom IdentityUser, be \\nsure to specif\", \"y its type here. If these extension methods aren\\u2019t working in your application, check that \\nyou have\", \" the appropriate using statements and that you have the necessary NuGet package \\nreferences. For exa\", \"mple, your project should have some version of the \\nMicrosoft.AspNetCore.Identity.EntityFrameworkCor\", \"e and Microsoft.AspNetCore.Identity.UI packages \\nreferenced. \\n\\nAlso in Program.cs you should see the\", \" necessary middleware configured for the site. Specifically, \\nUseAuthentication and UseAuthorization\", \" should be set up, and in the proper location. \\n\\n// Configure the HTTP request pipeline. \\nif (app.En\", \"vironment.IsDevelopment()) \\n{ \\n    app.UseMigrationsEndPoint(); \\n} \\nelse \\n{ \\n    app.UseExceptionHan\", \"dler(\\\"/Error\\\"); \\n    // The default HSTS value is 30 days. You may want to change this for productio\", \"n \\nscenarios, see https://aka.ms/aspnetcore-hsts. \\n    app.UseHsts(); \\n} \\n\\napp.UseHttpsRedirection()\", \"; \\n\\napp.UseStaticFiles(); \\n\\n74 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET \", \"Web Forms and Blazor \\n\\n \\n \\n \\n \\n\\fapp.UseRouting(); \\n\\napp.UseAuthentication(); \\napp.UseAuthorization()\", \"; \\n\\n//app.MapControllers(); \\napp.MapBlazorHub(); \\napp.MapFallbackToPage(\\\"/_Host\\\"); \\n\\nASP.NET Identit\", \"y does not configure anonymous or role-based access to locations from Program.cs. \\nYou will need to \", \"migrate any location-specific authorization configuration data to filters in ASP.NET \\nCore. Make not\", \"e of which folders and pages will require such updates. You will make these changes in \\nthe next sec\", \"tion. \\n\\nUpdating individual pages to use ASP.NET Core Identity abstractions \\n\\nIn your ASP.NET Web Fo\", \"rms application, if you had web.config settings to deny access to certain \\npages or folders to anony\", \"mous users, you would migrate these changes by adding the [Authorize] \\nattribute to such pages: \\n\\n@a\", \"ttribute [Authorize] \\n\\nIf you further had denied access except to those users belonging to a certain\", \" role, you would likewise \\nmigrate this behavior by adding an attribute specifying a role: \\n\\n@attrib\", \"ute [Authorize(Roles =\\\"administrators\\\")] \\n\\nThe [Authorize] attribute only works on @page components \", \"that are reached via the Blazor Router. \\nThe attribute does not work with child components, which sh\", \"ould instead use AuthorizeView. \\n\\nIf you have logic within page markup for determining whether to di\", \"splay some code to a certain user, \\nyou can replace this with the AuthorizeView component. The Autho\", \"rizeView component selectively \\ndisplays UI depending on whether the user is authorized to see it. I\", \"t also exposes a context variable \\nthat can be used to access user information. \\n\\n<AuthorizeView> \\n \", \"   <Authorized> \\n        <h1>Hello, @context.User.Identity.Name!</h1> \\n        <p>You can only see t\", \"his content if you are authenticated.</p> \\n    </Authorized> \\n    <NotAuthorized> \\n        <h1>Authe\", \"ntication Failure!</h1> \\n        <p>You are not signed in.</p> \\n    </NotAuthorized> \\n</AuthorizeVie\", \"w> \\n\\nYou can access the authentication state within procedural logic by accessing the user from a \\nT\", \"ask<AuthenticationState configured with the [CascadingParameter] attribute. This configuration will \", \"\\nget you access to the user, which can let you determine if they are authenticated and if they belon\", \"g to \\na particular role. If you need to evaluate a policy procedurally, you can inject an instance o\", \"f the \\nIAuthorizationService and calls the AuthorizeAsync method on it. The following sample code \\nd\", \"emonstrates how to get user information and allow an authorized user to perform a task restricted \\nb\", \"y the content-editor policy. \\n\\n75 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.N\", \"ET Web Forms and Blazor \\n\\n \\n \\n \\n \\n \\n\\f@using Microsoft.AspNetCore.Authorization \\n@inject IAuthorizati\", \"onService AuthorizationService \\n\\n<button @onclick=\\\"@DoSomething\\\">Do something important</button> \\n\\n@\", \"code { \\n    [CascadingParameter] \\n    private Task<AuthenticationState> authenticationStateTask { ge\", \"t; set; } \\n\\n    private async Task DoSomething() \\n    { \\n        var user = (await authenticationSta\", \"teTask).User; \\n\\n        if (user.Identity.IsAuthenticated) \\n        { \\n            // Perform an act\", \"ion only available to authenticated (signed-in) users. \\n        } \\n\\n        if (user.IsInRole(\\\"admin\", \"\\\")) \\n        { \\n            // Perform an action only available to users in the 'admin' role. \\n     \", \"   } \\n\\n        if ((await AuthorizationService.AuthorizeAsync(user, \\\"content-editor\\\")) \\n            \", \".Succeeded) \\n        { \\n            // Perform an action only available to users satisfying the \\n   \", \"         // 'content-editor' policy. \\n        } \\n    } \\n} \\n\\nThe AuthenticationState first need to be\", \" set up as a cascading value before it can be bound to a \\ncascading parameter like this. That\\u2019s typi\", \"cally done using the CascadingAuthenticationState \\ncomponent. This configuration is typically done i\", \"n App.razor: \\n\\n<CascadingAuthenticationState> \\n    <Router AppAssembly=\\\"@typeof(Program).Assembly\\\"> \", \"\\n        <Found Context=\\\"routeData\\\"> \\n            <AuthorizeRouteView RouteData=\\\"@routeData\\\" \\n      \", \"          DefaultLayout=\\\"@typeof(MainLayout)\\\" /> \\n        </Found> \\n        <NotFound> \\n            \", \"<LayoutView Layout=\\\"@typeof(MainLayout)\\\"> \\n                <p>Sorry, there's nothing at this address\", \".</p> \\n            </LayoutView> \\n        </NotFound> \\n    </Router> \\n</CascadingAuthenticationState\", \"> \\n\\nSummary \\n\\nBlazor uses the same security model as ASP.NET Core, which is ASP.NET Core Identity. M\", \"igrating from \\nuniversal providers to ASP.NET Core Identity is relatively straightforward, assuming \", \"not too much \\ncustomization was applied to the original data schema. Once the data has been migrated\", \", working \\n\\n76 \\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Bl\", \"azor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n\\fwith authentication and authorization in Blazor apps is well documented, wit\", \"h configurable as well as \\nprogrammatic support for most security requirements. \\n\\nReferences \\n\\n\\u2022 \\n\\nI\", \"ntroduction to Identity on ASP.NET Core \\n\\n\\u2022  Migrate from ASP.NET Membership authentication to ASP.N\", \"ET Core 2.0 Identity \\n\\n\\u2022  Migrate Authentication and Identity to ASP.NET Core \\n\\n\\u2022 \\n\\nASP.NET Core Bla\", \"zor authentication and authorization \\n\\n77 \\n\\nCHAPTER 13 | Security: Authentication and Authorization \", \"in ASP.NET Web Forms and Blazor \\n\\n \\n \\n\\fCHAPTER  14 \\n\\nMigrate from ASP.NET \\nWeb Forms to Blazor \\n\\nMig\", \"rating a code base from ASP.NET Web Forms to Blazor is a time-consuming task that requires \\nplanning\", \". This chapter outlines the process. Something that can ease the transition is to ensure the \\napp ad\", \"heres to an N-tier architecture, wherein the app model (in this case, Web Forms) is separate \\nfrom t\", \"he business logic. This logical separation of layers makes it clear what needs to move to .NET \\nCore\", \" and Blazor. \\n\\nFor this example, the eShop app available on GitHub is used. eShop is a catalog servi\", \"ce that provides \\nCRUD capabilities via form entry and validation. \\n\\nWhy should a working app be mig\", \"rated to Blazor? Many times, there\\u2019s no need. ASP.NET Web Forms \\nwill continue to be supported for m\", \"any years. However, many of the features that Blazor provides are \\nonly supported on a migrated app.\", \" Such features include: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nPerformance improvements in the framework such as Span<T> \", \"\\n\\nAbility to run as WebAssembly \\n\\nCross-platform support for Linux and macOS \\n\\nApp-local deployment \", \"or shared framework deployment without impacting other apps \\n\\nIf these or other new features are com\", \"pelling enough, there may be value in migrating the app. The \\nmigration can take different shapes; i\", \"t can be the entire app, or only certain endpoints that require the \\nchanges. The decision to migrat\", \"e is ultimately based on the business problems to be solved by the \\ndeveloper. \\n\\nServer-side versus \", \"client-side hosting \\n\\nAs described in the hosting models chapter, a Blazor app can be hosted in two \", \"different ways: server-\\nside and client-side. The server-side model uses ASP.NET Core SignalR connec\", \"tions to manage the \\nDOM updates while running any actual code on the server. The client-side model \", \"runs as \\nWebAssembly within a browser and requires no server connections. There are a number of diff\", \"erences \\nthat may affect which is best for a specific app: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n78 \\n\\nRunning as WebAssembly doe\", \"sn\\u2019t support all features (such as threading) at the current time \\n\\nChatty communication between the\", \" client and server may cause latency issues in server-side \\nmode \\n\\nCHAPTER 14 | Migrate from ASP.NET\", \" Web Forms to Blazor \\n\\n \\n \\n\\f\\u2022 \\n\\nAccess to databases and internal or protected services require a sep\", \"arate service with client-\\nside hosting \\n\\nAt the time of writing, the server-side model more closely\", \" resembles Web Forms. Most of this chapter \\nfocuses on the server-side hosting model, as it\\u2019s produc\", \"tion-ready. \\n\\nCreate a new project \\n\\nThis initial migration step is to create a new project. This pr\", \"oject type is based on the SDK style \\nprojects of .NET and simplifies much of the boilerplate that w\", \"as used in previous project formats. For \\nmore detail, please see the chapter on Project Structure. \", \"\\n\\nOnce the project has been created, install the libraries that were used in the previous project. I\", \"n older \\nWeb Forms projects, you may have used the packages.config file to list the required NuGet p\", \"ackages. \\nIn the new SDK-style project, packages.config has been replaced with <PackageReference> el\", \"ements \\nin the project file. A benefit to this approach is that all dependencies are installed trans\", \"itively. You only \\nlist the top-level dependencies you care about. \\n\\nMany of the dependencies you\\u2019re\", \" using are available for .NET, including Entity Framework 6 and \\nlog4net. If there\\u2019s no .NET or .NET\", \" Standard version available, the .NET Framework version can often \\nbe used. Your mileage may vary. A\", \"ny API used that isn\\u2019t available in .NET causes a runtime error. Visual \\nStudio notifies you of such\", \" packages. A yellow icon appears on the project\\u2019s References node in \\nSolution Explorer. \\n\\nIn the Bl\", \"azor-based eShop project, you can see the packages that are installed. Previously, the \\npackages.con\", \"fig file listed every package used in the project, resulting in a file almost 50 lines long. A \\nsnip\", \"pet of packages.config is: \\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> \\n<packages> \\n  ... \\n  <package i\", \"d=\\\"Microsoft.ApplicationInsights.Agent.Intercept\\\" version=\\\"2.4.0\\\" \\ntargetFramework=\\\"net472\\\" /> \\n  <p\", \"ackage id=\\\"Microsoft.ApplicationInsights.DependencyCollector\\\" version=\\\"2.9.1\\\" \\ntargetFramework=\\\"net4\", \"72\\\" /> \\n  <package id=\\\"Microsoft.ApplicationInsights.PerfCounterCollector\\\" version=\\\"2.9.1\\\" \\ntargetFr\", \"amework=\\\"net472\\\" /> \\n  <package id=\\\"Microsoft.ApplicationInsights.Web\\\" version=\\\"2.9.1\\\" targetFramewo\", \"rk=\\\"net472\\\" \\n/> \\n  <package id=\\\"Microsoft.ApplicationInsights.WindowsServer\\\" version=\\\"2.9.1\\\" \\ntarget\", \"Framework=\\\"net472\\\" /> \\n  <package id=\\\"Microsoft.ApplicationInsights.WindowsServer.TelemetryChannel\\\" \", \"\\nversion=\\\"2.9.1\\\" targetFramework=\\\"net472\\\" /> \\n  <package id=\\\"Microsoft.AspNet.FriendlyUrls\\\" version=\", \"\\\"1.0.2\\\" targetFramework=\\\"net472\\\" /> \\n  <package id=\\\"Microsoft.AspNet.FriendlyUrls.Core\\\" version=\\\"1.0\", \".2\\\" targetFramework=\\\"net472\\\" \\n/> \\n  <package id=\\\"Microsoft.AspNet.ScriptManager.MSAjax\\\" version=\\\"5.0\", \".0\\\" \\ntargetFramework=\\\"net472\\\" /> \\n  <package id=\\\"Microsoft.AspNet.ScriptManager.WebForms\\\" version=\\\"5\", \".0.0\\\" \\ntargetFramework=\\\"net472\\\" /> \\n  ... \\n  <package id=\\\"System.Memory\\\" version=\\\"4.5.1\\\" targetFrame\", \"work=\\\"net472\\\" /> \\n  <package id=\\\"System.Numerics.Vectors\\\" version=\\\"4.4.0\\\" targetFramework=\\\"net472\\\" /\", \"> \\n  <package id=\\\"System.Runtime.CompilerServices.Unsafe\\\" version=\\\"4.5.0\\\" \\n\\n79 \\n\\nCHAPTER 14 | Migrat\", \"e from ASP.NET Web Forms to Blazor \\n\\n \\n \\n\\ftargetFramework=\\\"net472\\\" /> \\n  <package id=\\\"System.Threadi\", \"ng.Channels\\\" version=\\\"4.5.0\\\" targetFramework=\\\"net472\\\" /> \\n  <package id=\\\"System.Threading.Tasks.Exte\", \"nsions\\\" version=\\\"4.5.1\\\" targetFramework=\\\"net472\\\" \\n/> \\n  <package id=\\\"WebGrease\\\" version=\\\"1.6.0\\\" targ\", \"etFramework=\\\"net472\\\" /> \\n</packages> \\n\\nThe <packages> element includes all necessary dependencies. I\", \"t\\u2019s difficult to identify which of these \\npackages are included because you require them. Some <pack\", \"age> elements are listed simply to \\nsatisfy the needs of dependencies you require. \\n\\nThe Blazor proj\", \"ect lists the dependencies you require within an <ItemGroup> element in the project \\nfile: \\n\\n<ItemGr\", \"oup> \\n    <PackageReference Include=\\\"Autofac\\\" Version=\\\"4.9.3\\\" /> \\n    <PackageReference Include=\\\"Ent\", \"ityFramework\\\" Version=\\\"6.4.4\\\" /> \\n    <PackageReference Include=\\\"log4net\\\" Version=\\\"2.0.12\\\" /> \\n    <\", \"PackageReference Include=\\\"Microsoft.Extensions.Logging.Log4Net.AspNetCore\\\" \\nVersion=\\\"2.2.12\\\" /> \\n</I\", \"temGroup> \\n\\nOne NuGet package that simplifies the life of Web Forms developers is the Windows Compat\", \"ibility \\nPack. Although .NET is cross-platform, some features are only available on Windows. Windows\", \"-\\nspecific features are made available by installing the compatibility pack. Examples of such featur\", \"es \\ninclude the Registry, WMI, and Directory Services. The package adds around 20,000 APIs and activ\", \"ates \\nmany services with which you may already be familiar. The eShop project doesn\\u2019t require the \\nc\", \"ompatibility pack; but if your projects use Windows-specific features, the package eases the \\nmigrat\", \"ion efforts. \\n\\nEnable startup process \\n\\nThe startup process for Blazor has changed from Web Forms an\", \"d follows a similar setup for other \\nASP.NET Core services. When hosted server-side, Razor component\", \"s are run as part of a normal \\nASP.NET Core app. When hosted in the browser with WebAssembly, Razor \", \"components use a similar \\nhosting model. The difference is the components are run as a separate serv\", \"ice from any of the \\nbackend processes. Either way, the startup is similar. \\n\\nThe Global.asax.cs fil\", \"e is the default startup page for Web Forms projects. In the eShop project, this file \\nconfigures th\", \"e Inversion of Control (IoC) container and handles the various lifecycle events of the app \\nor reque\", \"st. Some of these events are handled with middleware (such as Application_BeginRequest). \\nOther even\", \"ts require the overriding of specific services via dependency injection (DI). \\n\\nBy way of example, t\", \"he Global.asax.cs file for eShop, contains the following code: \\n\\npublic class Global : HttpApplicati\", \"on, IContainerProviderAccessor \\n{ \\n    private static readonly ILog _log = \\nLogManager.GetLogger(Sys\", \"tem.Reflection.MethodBase.GetCurrentMethod().DeclaringType); \\n\\n    static IContainerProvider _contai\", \"nerProvider; \\n    IContainer container; \\n\\n80 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\", \" \\n\\n \\n \\n \\n \\n\\f    public IContainerProvider ContainerProvider \\n    { \\n        get { return _containerP\", \"rovider; } \\n    } \\n\\n    protected void Application_Start(object sender, EventArgs e) \\n    { \\n       \", \" // Code that runs on app startup \\n        RouteConfig.RegisterRoutes(RouteTable.Routes); \\n        B\", \"undleConfig.RegisterBundles(BundleTable.Bundles); \\n        ConfigureContainer(); \\n        ConfigData\", \"Base(); \\n    } \\n\\n    /// <summary> \\n    /// Track the machine name and the start time for the sessio\", \"n inside the current \\nsession \\n    /// </summary> \\n    protected void Session_Start(Object sender, E\", \"ventArgs e) \\n    { \\n        HttpContext.Current.Session[\\\"MachineName\\\"] = Environment.MachineName; \\n \", \"       HttpContext.Current.Session[\\\"SessionStartTime\\\"] = DateTime.Now; \\n    } \\n\\n    /// <summary> \\n \", \"   /// https://autofaccn.readthedocs.io/en/latest/integration/webforms.html \\n    /// </summary> \\n   \", \" private void ConfigureContainer() \\n    { \\n        var builder = new ContainerBuilder(); \\n        va\", \"r mockData = bool.Parse(ConfigurationManager.AppSettings[\\\"UseMockData\\\"]); \\n        builder.RegisterM\", \"odule(new ApplicationModule(mockData)); \\n        container = builder.Build(); \\n        _containerPro\", \"vider = new ContainerProvider(container); \\n    } \\n\\n    private void ConfigDataBase() \\n    { \\n       \", \" var mockData = bool.Parse(ConfigurationManager.AppSettings[\\\"UseMockData\\\"]); \\n\\n        if (!mockData\", \") \\n        { \\n\\nDatabase.SetInitializer<CatalogDBContext>(container.Resolve<CatalogDBInitializer>());\", \" \\n        } \\n    } \\n\\n    protected void Application_BeginRequest(object sender, EventArgs e) \\n    { \", \"\\n        //set the property to our new object \\n        LogicalThreadContext.Properties[\\\"activityid\\\"]\", \" = new ActivityIdHelper(); \\n\\n        LogicalThreadContext.Properties[\\\"requestinfo\\\"] = new WebRequest\", \"Info(); \\n\\n        _log.Debug(\\\"Application_BeginRequest\\\"); \\n    } \\n} \\n\\nThe preceding file becomes the\", \" Program.cs file in server-side Blazor: \\n\\n81 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\", \" \\n\\n \\n \\n \\n \\n \\n \\n \\n            \\n \\n \\n \\n\\fusing eShopOnBlazor.Models; \\nusing eShopOnBlazor.Models.Infrast\", \"ructure; \\nusing eShopOnBlazor.Services; \\nusing log4net; \\nusing System.Data.Entity; \\nusing eShopOnBla\", \"zor; \\n\\nvar builder = WebApplication.CreateBuilder(args); \\n\\n// add services \\n\\nbuilder.Services.AddRaz\", \"orPages(); \\nbuilder.Services.AddServerSideBlazor(); \\n\\nif (builder.Configuration.GetValue<bool>(\\\"UseM\", \"ockData\\\")) \\n{ \\n    builder.Services.AddSingleton<ICatalogService, CatalogServiceMock>(); \\n} \\nelse \\n{\", \" \\n    builder.Services.AddScoped<ICatalogService, CatalogService>(); \\n    builder.Services.AddScoped\", \"<IDatabaseInitializer<CatalogDBContext>, \\nCatalogDBInitializer>(); \\n    builder.Services.AddSingleto\", \"n<CatalogItemHiLoGenerator>(); \\n    builder.Services.AddScoped(_ => new \\nCatalogDBContext(builder.Co\", \"nfiguration.GetConnectionString(\\\"CatalogDBContext\\\"))); \\n} \\n\\nvar app = builder.Build(); \\n\\nnew LoggerF\", \"actory().AddLog4Net(\\\"log4Net.xml\\\"); \\n\\nif (app.Environment.IsDevelopment()) \\n{ \\n    app.UseDeveloperE\", \"xceptionPage(); \\n} \\nelse \\n{ \\n    app.UseExceptionHandler(\\\"/Home/Error\\\"); \\n} \\n\\n// Middleware for Appl\", \"ication_BeginRequest \\napp.Use((ctx, next) => \\n{ \\n    LogicalThreadContext.Properties[\\\"activityid\\\"] =\", \" new ActivityIdHelper(ctx); \\n    LogicalThreadContext.Properties[\\\"requestinfo\\\"] = new WebRequestInfo\", \"(ctx); \\n    return next(); \\n}); \\n\\napp.UseStaticFiles(); \\n\\napp.UseRouting(); \\n\\napp.UseEndpoints(endpo\", \"ints => \\n{ \\n    endpoints.MapBlazorHub(); \\n    endpoints.MapFallbackToPage(\\\"/_Host\\\"); \\n}); \\n\\nConfigD\", \"ataBase(app); \\n\\n82 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \", \"\\n \\n \\n\\fvoid ConfigDataBase(IApplicationBuilder app) \\n{ \\n    using (var scope = app.ApplicationService\", \"s.CreateScope()) \\n    { \\n        var initializer = \\nscope.ServiceProvider.GetService<IDatabaseInitia\", \"lizer<CatalogDBContext>>(); \\n\\n        if (initializer != null) \\n        { \\n            Database.SetI\", \"nitializer(initializer); \\n        } \\n    } \\n} \\n\\napp.Run(); \\n\\nOne significant change you may notice f\", \"rom Web Forms is the prominence of dependency injection \\n(DI). DI has been a guiding principle in th\", \"e ASP.NET Core design. It supports customization of almost \\nall aspects of the ASP.NET Core framewor\", \"k. There\\u2019s even a built-in service provider that can be used \\nfor many scenarios. If more customizat\", \"ion is required, it can be supported by many community \\nprojects. For example, you can carry forward\", \" your third-party DI library investment. \\n\\nIn the original eShop app, there\\u2019s some configuration for\", \" session management. Since server-side \\nBlazor uses ASP.NET Core SignalR for communication, the sess\", \"ion state isn\\u2019t supported as the \\nconnections may occur independent of an HTTP context. An app that \", \"uses the session state requires \\nrearchitecting before running as a Blazor app. \\n\\nFor more informati\", \"on about app startup, see App startup. \\n\\nMigrate HTTP modules and handlers to middleware \\n\\nHTTP modu\", \"les and handlers are common patterns in Web Forms to control the HTTP request pipeline. \\nClasses tha\", \"t implement IHttpModule or IHttpHandler could be registered and process incoming \\nrequests. Web Form\", \"s configure modules and handlers in the web.config file. Web Forms is also heavily \\nbased on app lif\", \"ecycle event handling. ASP.NET Core uses middleware instead. Middleware is \\nregistered in the Config\", \"ure method of the Startup class. Middleware execution order is determined by \\nthe registration order\", \". \\n\\nIn the Enable startup process section, a lifecycle event was raised by Web Forms as the \\nApplica\", \"tion_BeginRequest method. This event isn\\u2019t available in ASP.NET Core. One way to achieve this \\nbehav\", \"ior is to implement middleware as seen in the Startup.cs file example. This middleware does the \\nsam\", \"e logic and then transfers control to the next handler in the middleware pipeline. \\n\\nFor more inform\", \"ation on migrating modules and handlers, see Migrate HTTP handlers and modules to \\nASP.NET Core midd\", \"leware. \\n\\n83 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n \\n\\fMigrate static fil\", \"es \\n\\nTo serve static files (for example, HTML, CSS, images, and JavaScript), the files must be expos\", \"ed by \\nmiddleware. Calling the UseStaticFiles method enables the serving of static files from the we\", \"b root \\npath. The default web root directory is wwwroot, but it can be customized. As included in th\", \"e \\nProgram.cs file: \\n\\n... \\n\\napp.UseStaticFiles(); \\n\\n... \\n\\nThe eShop project enables basic static fil\", \"e access. There are many customizations available for static \\nfile access. For information on enabli\", \"ng default files or a file browser, see Static files in ASP.NET Core. \\n\\nMigrate runtime bundling and\", \" minification setup \\n\\nBundling and minification are performance optimization techniques for reducing\", \" the number and size \\nof server requests to retrieve certain file types. JavaScript and CSS often un\", \"dergo some form of \\nbundling or minification before being sent to the client. In ASP.NET Web Forms, \", \"these optimizations \\nare handled at run time. The optimization conventions are defined an App_Start/\", \"BundleConfig.cs file. \\nIn ASP.NET Core, a more declarative approach is adopted. A file lists the fil\", \"es to be minified, along \\nwith specific minification settings. \\n\\nFor more information on bundling an\", \"d minification, see Bundle and minify static assets in ASP.NET \\nCore. \\n\\nMigrate ASPX pages \\n\\nA page \", \"in a Web Forms app is a file with the .aspx extension. A Web Forms page can often be mapped \\nto a co\", \"mponent in Blazor. A Razor component is authored in a file with the .razor extension. For the \\neShop\", \" project, five pages are converted to a Razor page. \\n\\nFor example, the details view comprises three \", \"files in the Web Forms project: Details.aspx, \\nDetails.aspx.cs, and Details.aspx.designer.cs. When c\", \"onverting to Blazor, the code-behind and markup \\nare combined into Details.razor. Razor compilation \", \"(equivalent to what\\u2019s in .designer.cs files) is stored \\nin the obj directory and isn\\u2019t, by default, \", \"viewable in Solution Explorer. The Web Forms page consists \\nof the following markup: \\n\\n<%@ Page Titl\", \"e=\\\"Details\\\" Language=\\\"C#\\\" MasterPageFile=\\\"~/Site.Master\\\" \\nAutoEventWireup=\\\"true\\\" CodeBehind=\\\"Details\", \".aspx.cs\\\" \\nInherits=\\\"eShopLegacyWebForms.Catalog.Details\\\" %> \\n\\n<asp:Content ID=\\\"Details\\\" ContentPlac\", \"eHolderID=\\\"MainContent\\\" runat=\\\"server\\\"> \\n    <h2 class=\\\"esh-body-title\\\">Details</h2> \\n\\n    <div clas\", \"s=\\\"container\\\"> \\n        <div class=\\\"row\\\"> \\n\\n84 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blaz\", \"or \\n\\n \\n \\n \\n \\n \\n \\n\\f            <asp:Image runat=\\\"server\\\" CssClass=\\\"col-md-6 esh-picture\\\" ImageUrl='<%\", \"#\\\"/Pics/\\\" \\n+ product.PictureFileName%>' /> \\n            <dl class=\\\"col-md-6 dl-horizontal\\\"> \\n       \", \"         <dt>Name \\n                </dt> \\n\\n                <dd> \\n                    <asp:Label runa\", \"t=\\\"server\\\" Text='<%#product.Name%>' /> \\n                </dd> \\n\\n                <dt>Description \\n   \", \"             </dt> \\n\\n                <dd> \\n                    <asp:Label runat=\\\"server\\\" Text='<%#pr\", \"oduct.Description%>' /> \\n                </dd> \\n\\n                <dt>Brand \\n                </dt> \\n\\n\", \"                <dd> \\n                    <asp:Label runat=\\\"server\\\" Text='<%#product.CatalogBrand.Br\", \"and%>' /> \\n                </dd> \\n\\n                <dt>Type \\n                </dt> \\n\\n               \", \" <dd> \\n                    <asp:Label runat=\\\"server\\\" Text='<%#product.CatalogType.Type%>' /> \\n      \", \"          </dd> \\n                <dt>Price \\n                </dt> \\n\\n                <dd> \\n          \", \"          <asp:Label CssClass=\\\"esh-price\\\" runat=\\\"server\\\" \\nText='<%#product.Price%>' /> \\n            \", \"    </dd> \\n\\n                <dt>Picture name \\n                </dt> \\n\\n                <dd> \\n        \", \"            <asp:Label runat=\\\"server\\\" Text='<%#product.PictureFileName%>' /> \\n                </dd> \", \"\\n\\n                <dt>Stock \\n                </dt> \\n\\n                <dd> \\n                    <asp:\", \"Label runat=\\\"server\\\" Text='<%#product.AvailableStock%>' /> \\n                </dd> \\n\\n                \", \"<dt>Restock \\n                </dt> \\n\\n                <dd> \\n                    <asp:Label runat=\\\"ser\", \"ver\\\" Text='<%#product.RestockThreshold%>' /> \\n                </dd> \\n\\n                <dt>Max stock \", \"\\n                </dt> \\n\\n85 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n\", \" \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\f                <dd> \\n                    <asp:Label runat=\\\"server\\\" Text='<%#pr\", \"oduct.MaxStockThreshold%>' /> \\n                </dd> \\n\\n            </dl> \\n        </div> \\n\\n        <\", \"div class=\\\"form-actions no-color esh-link-list\\\"> \\n            <a runat=\\\"server\\\" href='<%# GetRouteUr\", \"l(\\\"EditProductRoute\\\", new {id \\n=product.Id}) %>' class=\\\"esh-link-item\\\">Edit \\n            </a> \\n     \", \"       | \\n            <a runat=\\\"server\\\" href=\\\"~\\\" class=\\\"esh-link-item\\\">Back to list \\n            </a\", \"> \\n        </div> \\n\\n    </div> \\n</asp:Content> \\n\\nThe preceding markup\\u2019s code-behind includes the fol\", \"lowing code: \\n\\nusing eShopLegacyWebForms.Models; \\nusing eShopLegacyWebForms.Services; \\nusing log4net\", \"; \\nusing System; \\nusing System.Web.UI; \\n\\nnamespace eShopLegacyWebForms.Catalog \\n{ \\n    public partia\", \"l class Details : System.Web.UI.Page \\n    { \\n        private static readonly ILog _log = \\nLogManager\", \".GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); \\n\\n        protected Catal\", \"ogItem product; \\n\\n        public ICatalogService CatalogService { get; set; } \\n\\n        protected vo\", \"id Page_Load(object sender, EventArgs e) \\n        { \\n            var productId = Convert.ToInt32(Pag\", \"e.RouteData.Values[\\\"id\\\"]); \\n            _log.Info($\\\"Now loading... /Catalog/Details.aspx?id={product\", \"Id}\\\"); \\n            product = CatalogService.FindCatalogItem(productId); \\n\\n            this.DataBind\", \"(); \\n        } \\n    } \\n} \\n\\nWhen converted to Blazor, the Web Forms page translates to the following \", \"code: \\n\\n@page \\\"/Catalog/Details/{id:int}\\\" \\n@inject ICatalogService CatalogService \\n@inject ILogger<D\", \"etails> Logger \\n\\n<h2 class=\\\"esh-body-title\\\">Details</h2> \\n\\n<div class=\\\"container\\\"> \\n    <div class=\\\"\", \"row\\\"> \\n\\n86 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\f    \", \"    <img class=\\\"col-md-6 esh-picture\\\" src=\\\"@($\\\"/Pics/{_item.PictureFileName}\\\")\\\"> \\n\\n        <dl class\", \"=\\\"col-md-6 dl-horizontal\\\"> \\n            <dt> \\n                Name \\n            </dt> \\n\\n            \", \"<dd> \\n                @_item.Name \\n            </dd> \\n\\n            <dt> \\n                Description\", \" \\n            </dt> \\n\\n            <dd> \\n                @_item.Description \\n            </dd> \\n\\n    \", \"        <dt> \\n                Brand \\n            </dt> \\n\\n            <dd> \\n                @_item.Ca\", \"talogBrand.Brand \\n            </dd> \\n\\n            <dt> \\n                Type \\n            </dt> \\n\\n  \", \"          <dd> \\n                @_item.CatalogType.Type \\n            </dd> \\n            <dt> \\n      \", \"          Price \\n            </dt> \\n\\n            <dd> \\n                @_item.Price \\n            </d\", \"d> \\n\\n            <dt> \\n                Picture name \\n            </dt> \\n\\n            <dd> \\n         \", \"       @_item.PictureFileName \\n            </dd> \\n\\n            <dt> \\n                Stock \\n        \", \"    </dt> \\n\\n            <dd> \\n                @_item.AvailableStock \\n            </dd> \\n\\n           \", \" <dt> \\n                Restock \\n            </dt> \\n\\n87 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms\", \" to Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n\\f            <dd> \\n                @_item.RestockThresh\", \"old \\n            </dd> \\n\\n            <dt> \\n                Max stock \\n            </dt> \\n\\n          \", \"  <dd> \\n                @_item.MaxStockThreshold \\n            </dd> \\n\\n        </dl> \\n    </div> \\n\\n  \", \"  <div class=\\\"form-actions no-color esh-link-list\\\"> \\n        <a href=\\\"@($\\\"/Catalog/Edit/{_item.Id}\\\")\", \"\\\" class=\\\"esh-link-item\\\"> \\n            Edit \\n        </a> \\n        | \\n        <a href=\\\"/\\\" class=\\\"esh-\", \"link-item\\\"> \\n            Back to list \\n        </a> \\n    </div> \\n\\n</div> \\n\\n@code { \\n    private Cata\", \"logItem _item; \\n\\n    [Parameter] \\n    public int Id { get; set; } \\n\\n    protected override void OnIn\", \"itialized() \\n    { \\n        Logger.LogInformation(\\\"Now loading... /Catalog/Details/{Id}\\\", Id); \\n\\n   \", \"     _item = CatalogService.FindCatalogItem(Id); \\n    } \\n} \\n\\nNotice that the code and markup are in \", \"the same file. Any required services are made accessible with \\nthe @inject attribute. Per the @page \", \"directive, this page can be accessed at the Catalog/Details/{id} \\nroute. The value of the route\\u2019s {i\", \"d} placeholder has been constrained to an integer. As described in the \\nrouting section, unlike Web \", \"Forms, a Razor component explicitly states its route and any parameters \\nthat are included. Many Web\", \" Forms controls may not have exact counterparts in Blazor. There\\u2019s often \\nan equivalent HTML snippet\", \" that will serve the same purpose. For example, the <asp:Label /> control \\ncan be replaced with an H\", \"TML <label> element. \\n\\nModel validation in Blazor \\n\\nIf your Web Forms code includes validation, you \", \"can transfer much of what you have with little-to-no \\nchanges. A benefit to running in Blazor is tha\", \"t the same validation logic can be run without needing \\ncustom JavaScript. Data annotations enable e\", \"asy model validation. \\n\\n88 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n \\n \\n \\n \", \"\\n \\n \\n \\n \\n\\fFor example, the Create.aspx page has a data entry form with validation. An example snippe\", \"t would \\nlook like this: \\n\\n<div class=\\\"form-group\\\"> \\n    <label class=\\\"control-label col-md-2\\\">Name<\", \"/label> \\n    <div class=\\\"col-md-3\\\"> \\n        <asp:TextBox ID=\\\"Name\\\" runat=\\\"server\\\" CssClass=\\\"form-co\", \"ntrol\\\"></asp:TextBox> \\n        <asp:RequiredFieldValidator runat=\\\"server\\\" ControlToValidate=\\\"Name\\\" \\n\", \"Display=\\\"Dynamic\\\" \\n            CssClass=\\\"field-validation-valid text-danger\\\" ErrorMessage=\\\"The Name \", \"field is \\nrequired.\\\" /> \\n    </div> \\n</div> \\n\\nIn Blazor, the equivalent markup is provided in a Crea\", \"te.razor file: \\n\\n<EditForm Model=\\\"_item\\\" OnValidSubmit=\\\"@...\\\"> \\n    <DataAnnotationsValidator /> \\n\\n \", \"   <div class=\\\"form-group\\\"> \\n        <label class=\\\"control-label col-md-2\\\">Name</label> \\n        <di\", \"v class=\\\"col-md-3\\\"> \\n            <InputText class=\\\"form-control\\\" @bind-Value=\\\"_item.Name\\\" /> \\n      \", \"      <ValidationMessage For=\\\"(() => _item.Name)\\\" /> \\n        </div> \\n    </div> \\n\\n    ... \\n</EditFo\", \"rm> \\n\\nThe EditForm context includes validation support and can be wrapped around an input. Data \\nann\", \"otations are a common way to add validation. Such validation support can be added via the \\nDataAnnot\", \"ationsValidator component. For more information on this mechanism, see ASP.NET Core \\nBlazor forms an\", \"d validation. \\n\\nMigrate configuration \\n\\nIn a Web Forms project, configuration data is most commonly \", \"stored in the web.config file. The \\nconfiguration data is accessed with ConfigurationManager. Servic\", \"es were often required to parse \\nobjects. With .NET Framework 4.7.2, composability was added to the \", \"configuration via \\nConfigurationBuilders. These builders allowed developers to add various sources f\", \"or the configuration \\nthat was then composed at run time to retrieve the necessary values. \\n\\nASP.NET\", \" Core introduced a flexible configuration system that allows you to define the configuration \\nsource\", \" or sources used by your app and deployment. The ConfigurationBuilder infrastructure that you \\nmay b\", \"e using in your Web Forms app was modeled after the concepts used in the ASP.NET Core \\nconfiguration\", \" system. \\n\\nThe following snippet demonstrates how the Web Forms eShop project uses web.config to sto\", \"re \\nconfiguration values: \\n\\n<configuration> \\n  <configSections> \\n    <section name=\\\"entityFramework\\\"\", \" \\n\\n89 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n \\n \\n\\ftype=\\\"System.Data.Entity.In\", \"ternal.ConfigFile.EntityFrameworkSection, EntityFramework, \\nVersion=6.0.0.0, Culture=neutral, Public\", \"KeyToken=b77a5c561934e089\\\" \\nrequirePermission=\\\"false\\\" /> \\n  </configSections> \\n  <connectionStrings>\", \" \\n    <add name=\\\"CatalogDBContext\\\" connectionString=\\\"Data Source=(localdb)\\\\MSSQLLocalDB; \\nInitial Ca\", \"talog=Microsoft.eShopOnContainers.Services.CatalogDb; Integrated Security=True; \\nMultipleActiveResul\", \"tSets=True;\\\" providerName=\\\"System.Data.SqlClient\\\" /> \\n  </connectionStrings> \\n  <appSettings> \\n    <\", \"add key=\\\"UseMockData\\\" value=\\\"true\\\" /> \\n    <add key=\\\"UseCustomizationData\\\" value=\\\"false\\\" /> \\n  </app\", \"Settings> \\n</configuration> \\n\\nIt\\u2019s common for secrets, such as database connection strings, to be st\", \"ored within the web.config. The \\nsecrets are inevitably persisted in unsecure locations, such as sou\", \"rce control. With Blazor on ASP.NET \\nCore, the preceding XML-based configuration is replaced with th\", \"e following JSON: \\n\\n{ \\n  \\\"ConnectionStrings\\\": { \\n    \\\"CatalogDBContext\\\": \\\"Data Source=(localdb)\\\\\\\\MSS\", \"QLLocalDB; Initial \\nCatalog=Microsoft.eShopOnContainers.Services.CatalogDb; Integrated Security=True\", \"; \\nMultipleActiveResultSets=True;\\\" \\n  }, \\n  \\\"UseMockData\\\": true, \\n  \\\"UseCustomizationData\\\": false \\n}\", \" \\n\\nJSON is the default configuration format; however, ASP.NET Core supports many other formats, \\ninc\", \"luding XML. There are also several community-supported formats. \\n\\nYou can access configuration value\", \"s from the builder in Program.cs: \\n\\nif (builder.Configuration.GetValue<bool>(\\\"UseMockData\\\")) \\n{ \\n   \", \" builder.Services.AddSingleton<ICatalogService, CatalogServiceMock>(); \\n} \\nelse \\n{ \\n    builder.Serv\", \"ices.AddScoped<ICatalogService, CatalogService>(); \\n    builder.Services.AddScoped<IDatabaseInitiali\", \"zer<CatalogDBContext>, \\nCatalogDBInitializer>(); \\n    builder.Services.AddSingleton<CatalogItemHiLoG\", \"enerator>(); \\n    builder.Services.AddScoped(_ => new \\nCatalogDBContext(builder.Configuration.GetCon\", \"nectionString(\\\"CatalogDBContext\\\"))); \\n} \\n\\nBy default, environment variables, JSON files (appsettings\", \".json and appsettings.{Environment}.json), and \\ncommand-line options are registered as valid configu\", \"ration sources in the configuration object. The \\nconfiguration sources can be accessed via Configura\", \"tion[key]. A more advanced technique is to bind \\nthe configuration data to objects using the options\", \" pattern. For more information on configuration \\nand the options pattern, see Configuration in ASP.N\", \"ET Core and Options pattern in ASP.NET Core, \\nrespectively. \\n\\n90 \\n\\nCHAPTER 14 | Migrate from ASP.NET\", \" Web Forms to Blazor \\n\\n \\n \\n\\fMigrate data access \\n\\nData access is an important aspect of any app. The\", \" eShop project stores catalog information in a \\ndatabase and retrieves the data with Entity Framewor\", \"k (EF) 6. Since EF 6 is supported in .NET 5, the \\nproject can continue to use it. \\n\\nThe following EF\", \"-related changes were necessary to eShop: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nIn .NET Framework, the DbContext object accepts \", \"a string of the form name=ConnectionString \\nand uses the connection string from ConfigurationManager\", \".AppSettings[ConnectionString] to \\nconnect. In .NET Core, this isn\\u2019t supported. The connection strin\", \"g must be supplied. \\n\\nThe database was accessed in a synchronous way. Though this works, scalability\", \" may suffer. \\nThis logic should be moved to an asynchronous pattern. \\n\\nAlthough there isn\\u2019t the same\", \" native support for dataset binding, Blazor provides flexibility and power \\nwith its C# support in a\", \" Razor page. For example, you can perform calculations and display the result. \\nFor more information\", \" on data patterns in Blazor, see the Data access chapter. \\n\\nArchitectural changes \\n\\nFinally, there a\", \"re some important architectural differences to consider when migrating to Blazor. Many \\nof these cha\", \"nges are applicable to anything based on .NET Core or ASP.NET Core. \\n\\nBecause Blazor is built on .NE\", \"T Core, there are considerations in ensuring support on .NET Core. Some \\nof the major changes includ\", \"e the removal of the following features: \\n\\n\\u2022  Multiple AppDomains \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nRemoting \\n\\nCode Acce\", \"ss Security (CAS) \\n\\nSecurity Transparency \\n\\nFor more information on techniques to identify necessary\", \" changes to support running on .NET Core, \\nsee Port your code from .NET Framework to .NET Core. \\n\\nAS\", \"P.NET Core is a reimagined version of ASP.NET and has some changes that may not initially seem \\nobvi\", \"ous. The main changes are: \\n\\n\\u2022 \\n\\n\\u2022 \\n\\n\\u2022 \\n\\nNo synchronization context, which means there\\u2019s no HttpCont\", \"ext.Current, \\nThread.CurrentPrincipal, or other static accessors \\n\\nNo shadow copying \\n\\nNo request qu\", \"eue \\n\\nMany operations in ASP.NET Core are asynchronous, which allows easier off-loading of I/O-bound\", \" \\ntasks. It\\u2019s important to never block by using Task.Wait() or Task.GetResult(), which can quickly e\", \"xhaust \\nthread pool resources. \\n\\n91 \\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor \\n\\n \\n \\n\\fM\", \"igration conclusion \\n\\nAt this point, you\\u2019ve seen many examples of what it takes to move a Web Forms \", \"project to Blazor. For \\na full example, see the eShopOnBlazor project. \\n\\n92 \\n\\nCHAPTER 14 | Migrate f\", \"rom ASP.NET Web Forms to Blazor \\n\\n \\n \\n\\f\"]"