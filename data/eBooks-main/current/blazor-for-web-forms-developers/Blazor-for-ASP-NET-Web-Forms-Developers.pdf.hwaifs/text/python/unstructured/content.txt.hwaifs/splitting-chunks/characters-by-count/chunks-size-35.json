"[\"EDITION v8.0 - Updated to .NET 8\\n\\nRefer to changelog for the book updates and community contribution\", \"s.\\n\\nPUBLISHED BY\\n\\nMicrosoft Developer Division, .NET, and Visual Studio product teams\\n\\nA division of\", \" Microsoft Corporation\\n\\nOne Microsoft Way\\n\\nRedmond, Washington 98052-6399\\n\\nCopyright \\u00a9 2023 by Micro\", \"soft Corporation\\n\\nAll rights reserved. No part of the contents of this book may be reproduced or tra\", \"nsmitted in any form or by any means without the written permission of the publisher.\\n\\nThis book is \", \"provided \\u201cas-is\\u201d and expresses the author\\u2019s views and opinions. The views, opinions, and information\", \" expressed in this book, including URL and other Internet website references, may change without not\", \"ice.\\n\\nSome examples depicted herein are provided for illustration only and are fictitious. No real a\", \"ssociation or connection is intended or should be inferred.\\n\\nMicrosoft and the trademarks listed at \", \"https://www.microsoft.com on the \\u201cTrademarks\\u201d webpage are trademarks of the Microsoft group of compa\", \"nies.\\n\\nMac and macOS are trademarks of Apple Inc.\\n\\nAll other marks and logos are property of their r\", \"espective owners.\\n\\nAuthors:\\n\\nDaniel Roth, Principal Program Manager, Microsoft Corp.\\n\\nJeff Fritz, Se\", \"nior Program Manager, Microsoft Corp.\\n\\nTaylor Southwick, Senior Software Engineer, Microsoft Corp.\\n\\n\", \"Scott Addie, Senior Content Developer, Microsoft Corp.\\n\\nSteve \\u201c@ardalis\\u201d Smith, Software Architect a\", \"nd Trainer, NimblePros.com\\n\\nIntroduction\\n\\n.NET has long supported web app development through ASP.NE\", \"T, a comprehensive set of frameworks and tools for building any kind of web app. ASP.NET has its own\", \" lineage of web frameworks and technologies starting all the way back with classic Active Server Pag\", \"es (ASP). Frameworks like ASP.NET Web Forms, ASP.NET MVC, ASP.NET Web Pages, and more recently ASP.N\", \"ET Core, provide a productive and powerful way to build server-rendered web apps, where UI content i\", \"s dynamically generated on the server in response to HTTP requests. Each ASP.NET framework caters to\", \" a different audience and app building philosophy. ASP.NET Web Forms shipped with the original relea\", \"se of the .NET Framework and enabled web development using many of the patterns familiar to desktop\\n\", \"\\ndevelopers, like reusable UI controls with simple event handling. However, none of the ASP.NET offe\", \"rings provide a way to run code that executed in the user\\u2019s browser. To do that requires writing Jav\", \"aScript and using any of the many JavaScript frameworks and tools that have phased in and out of pop\", \"ularity over the years: jQuery, Knockout, Angular, React, and so on.\\n\\nBlazor is a new web framework \", \"that changes what is possible when building web apps with .NET. Blazor is a client-side web UI frame\", \"work based on C# instead of JavaScript. With Blazor you can write your client-side logic and UI comp\", \"onents in C#, compile them into normal .NET assemblies, and then run them directly in the browser us\", \"ing a new open web standard called WebAssembly. Or alternatively, Blazor can run your .NET UI compon\", \"ents on the server and handle all UI interactions fluidly over a real-time connection with the brows\", \"er. When paired with .NET running on the server, Blazor enables full-stack web development with .NET\", \". While Blazor shares many commonalities with ASP.NET Web Forms, like having a reusable component mo\", \"del and a simple way to handle user events, it also builds on the foundations of .NET to provide a m\", \"odern and high-performance web development experience.\\n\\nThis book introduces ASP.NET Web Forms devel\", \"opers to Blazor in a way that is familiar and convenient. It introduces Blazor concepts in parallel \", \"with analogous concepts in ASP.NET Web Forms while also explaining new concepts that may be less fam\", \"iliar. It covers a broad range of topics and concerns including component authoring, routing, layout\", \", configuration, and security. And while the content of this book is primarily for enabling new deve\", \"lopment, it also covers guidelines and strategies for migrating existing ASP.NET Web Forms to Blazor\", \" for when you want to modernize an existing app.\\n\\nWho should use the book\\n\\nThis book is for ASP.NET \", \"Web Forms developers looking for an introduction to Blazor that relates to their existing knowledge \", \"and skills. This book can help with quickly getting started on a new Blazor- based project or to hel\", \"p chart a roadmap for modernizing an existing ASP.NET Web Forms application.\\n\\nHow to use the book\\n\\nT\", \"he first part of this book covers what Blazor is and compares it to web app development with ASP.NET\", \" Web Forms. The book then covers a variety of Blazor topics, chapter by chapter, and relates each Bl\", \"azor concept to the corresponding concept in ASP.NET Web Forms, or explains fully any completely new\", \" concepts. The book also refers regularly to a complete sample app implemented in both ASP.NET Web F\", \"orms and Blazor to demonstrate Blazor features and to provide a case study for migrating from ASP.NE\", \"T Web Forms to Blazor. You can find both implementations of the sample app (ASP.NET Web Forms and Bl\", \"azor versions) on GitHub.\\n\\nWhat this book doesn\\u2019t cover\\n\\nThis book is an introduction to Blazor, not\", \" a comprehensive migration guide. While it does include guidance on how to approach migrating a proj\", \"ect from ASP.NET Web Forms to Blazor, it does not\\n\\nattempt to cover every nuance and detail. For mor\", \"e general guidance on migrating from ASP.NET to ASP.NET Core, refer to the migration guidance in the\", \" ASP.NET Core documentation.\\n\\nAdditional resources\\n\\nYou can find the official Blazor home page and d\", \"ocumentation at https://blazor.net.\\n\\nContents\\n\\nAn introduction to Blazor for ASP.NET Web Forms devel\", \"opers ........................................ 1\\n\\nAn open-source and cross-platform .NET ...........\", \"....................................................................................................\", \"...... 2\\n\\nClient-side web development ..............................................................\", \"............................................................................... 3\\n\\nWebAssembly fulfi\", \"lls a need .........................................................................................\", \"...................................................... 3\\n\\nBlazor: full-stack web development with .N\", \"ET .................................................................................................\", \"............ 4\\n\\nGet started with Blazor ............................................................\", \".............................................................................................. 4\\n\\nAr\", \"chitecture comparison of ASP.NET Web Forms and Blazor ............................................ 5\", \"\\n\\nASP.NET Web Forms ................................................................................\", \"............................................................................... 5\\n\\nBlazor ..........\", \"....................................................................................................\", \".............................................................................. 6\\n\\nBlazor app hosting\", \" models ............................................................................................\", \"......... 8\\n\\nBlazor WebAssembly apps ...............................................................\", \".................................................................................... 8\\n\\nBlazor Serve\", \"r apps .............................................................................................\", \"...................................................................... 9\\n\\nHow to choose the right Bl\", \"azor hosting model .................................................................................\", \"...................... 10\\n\\nDeploy your app .........................................................\", \"....................................................................................................\", \"....... 11\\n\\nProject structure for Blazor apps ......................................................\", \"................................... 12\\n\\nProject file ...............................................\", \"....................................................................................................\", \"............................. 12\\n\\nEntry point ......................................................\", \"....................................................................................................\", \"..................... 13\\n\\nStatic files .............................................................\", \"....................................................................................................\", \"................ 15\\n\\nConfiguration..................................................................\", \"....................................................................................................\", \".... 15\\n\\nRazor components ..........................................................................\", \"..................................................................................... 15\\n\\nPages ....\", \"....................................................................................................\", \".................................................................................. 16\\n\\nLayout ......\", \"....................................................................................................\", \".............................................................................. 16\\n\\nBootstrap Blazor \", \"....................................................................................................\", \"................................................................ 16\\n\\nBuild output ..................\", \"....................................................................................................\", \"...................................................... 18\\n\\nRun the app with Hot Reload..............\", \"....................................................................................................\", \"......................... 18\\n\\nApp startup ..........................................................\", \".................................................................. 21\\n\\nApplication_Start and Web For\", \"ms .................................................................................................\", \"................................ 21\\n\\nBlazor Server Startup Structure ...............................\", \"....................................................................................................\", \".... 21\\n\\ni\\n\\nContents\\n\\nUpgrading the BundleConfig Process ...........................................\", \"............................................................................... 23\\n\\nBuild reusable U\", \"I components with Blazor......................................................................... 24\", \"\\n\\nAn introduction to Razor .........................................................................\", \".......................................................................... 24\\n\\nUse components ......\", \"....................................................................................................\", \"......................................................... 28\\n\\nModify page title from components ....\", \"....................................................................................................\", \"..................... 28\\n\\nComponent parameters .....................................................\", \"................................................................................................ 29\\n\", \"\\nQuery string parameters ...........................................................................\", \".................................................................... 29\\n\\nComponents and error bounda\", \"ries ...............................................................................................\", \"................................ 30\\n\\nEvent handlers ................................................\", \"....................................................................................................\", \".................... 30\\n\\nData binding ..............................................................\", \"....................................................................................................\", \"......... 32\\n\\nState changes ........................................................................\", \"................................................................................................. 33\", \"\\n\\nComponent lifecycle ..............................................................................\", \".............................................................................. 34\\n\\nOnInitialized ...\", \"....................................................................................................\", \"................................................................ 34\\n\\nOnParametersSet ...............\", \"....................................................................................................\", \".......................................... 35\\n\\nOnAfterRender .......................................\", \"....................................................................................................\", \"....................... 35\\n\\nIDisposable ............................................................\", \"....................................................................................................\", \"......... 35\\n\\nCapture component references .........................................................\", \"............................................................................. 36\\n\\nCapture element re\", \"ferences ...........................................................................................\", \".................................................. 36\\n\\nTemplated components ........................\", \"....................................................................................................\", \"......................... 36\\n\\nChild content.........................................................\", \"....................................................................................................\", \"......... 37\\n\\nTemplate parameters ..................................................................\", \".................................................................................... 37\\n\\nCode-behind\", \" ...................................................................................................\", \"........................................................................ 38\\n\\nAdditional resources ..\", \"....................................................................................................\", \"...................................................... 39\\n\\nPages, routing, and layouts .............\", \"..................................................................................... 40\\n\\nCreate pag\", \"es .................................................................................................\", \".......................................................................... 41\\n\\nRouter component ....\", \"....................................................................................................\", \"....................................................... 42\\n\\nNavigation .............................\", \"....................................................................................................\", \".............................................. 42\\n\\nBase URLs .......................................\", \"....................................................................................................\", \"...................................... 43\\n\\nPage layout .............................................\", \"....................................................................................................\", \"............................. 43\\n\\nState management .................................................\", \"............................................................... 46\\n\\nRequest state management with Vi\", \"ewState ............................................................................................\", \".................. 46\\n\\nii\\n\\nContents\\n\\nMaintain state with Session ...................................\", \"....................................................................................................\", \"....... 47\\n\\nApplication state ......................................................................\", \"............................................................................................. 47\\n\\nIn\", \" the browser .......................................................................................\", \"................................................................................. 48\\n\\nForms and vali\", \"dation .............................................................................................\", \"............... 49\\n\\nAdditional resources ...........................................................\", \"................................................................................................. 51\", \"\\n\\nWork with data ...................................................................................\", \"................................... 52\\n\\nEntity Framework ...........................................\", \"....................................................................................................\", \"................... 52\\n\\nEF Code First...............................................................\", \"....................................................................................................\", \".... 53\\n\\nEF Database First .........................................................................\", \"..................................................................................... 54\\n\\nInteract w\", \"ith web services ...................................................................................\", \".............................................................. 54\\n\\nModules, handlers, and middleware\", \" ................................................................................... 56\\n\\nOverview ..\", \"....................................................................................................\", \"............................................................................. 56\\n\\nKatana ...........\", \"....................................................................................................\", \"......................................................................... 57\\n\\nCommon middleware ....\", \"....................................................................................................\", \".................................................. 57\\n\\nCustom middleware ...........................\", \"....................................................................................................\", \".............................. 58\\n\\nApp configuration ...............................................\", \".................................................................. 60\\n\\nConfiguration sources .......\", \"....................................................................................................\", \".............................................. 60\\n\\nappsettings.json format and access ..............\", \"....................................................................................................\", \"............ 61\\n\\nUser secrets ......................................................................\", \"....................................................................................................\", \"... 61\\n\\nEnvironment variables ......................................................................\", \"................................................................................... 61\\n\\nCommand-line\", \" arguments .........................................................................................\", \"....................................................... 62\\n\\nThe return of web.config ...............\", \"....................................................................................................\", \"................................ 62\\n\\nRead configuration in the app .................................\", \"....................................................................................................\", \".... 63\\n\\nStrongly typed configuration ..............................................................\", \"............................................................................. 63\\n\\nSecurity: Authenti\", \"cation and Authorization in ASP.NET Web Forms and Blazor ........... 65\\n\\nASP.NET universal providers\", \" ...................................................................................................\", \".......................................... 65\\n\\nAuthorization configuration in Web Forms ............\", \"............................................................................................... 66\\n\\n\", \"Authorization code in Web Forms ....................................................................\", \"........................................................ 67\\n\\nASP.NET Core Identity .................\", \"....................................................................................................\", \".................................... 68\\n\\nRoles, claims, and policies ...............................\", \"....................................................................................................\", \"......... 68\\n\\nMigration guide ......................................................................\", \".......................................................................................... 70\\n\\niii\\n\\n\", \"Contents\\n\\nCreating the ASP.NET Core Identity schema ................................................\", \"......................................................... 70\\n\\nMigrating data from universal provider\", \"s to ASP.NET Core Identity ............................................................ 73\\n\\nMigratin\", \"g security settings from web.config to app startup .................................................\", \"......................... 74\\n\\nUpdating individual pages to use ASP.NET Core Identity abstractions ..\", \"................................................... 75\\n\\nSummary ....................................\", \"....................................................................................................\", \".......................................... 76\\n\\nReferences ..........................................\", \"....................................................................................................\", \"................................. 77\\n\\nMigrate from ASP.NET Web Forms to Blazor .....................\", \"................................................ 78\\n\\nServer-side versus client-side hosting ........\", \"....................................................................................................\", \".............. 78\\n\\nCreate a new project.............................................................\", \"............................................................................................... 79\\n\\n\", \"Enable startup process .............................................................................\", \"........................................................................... 80\\n\\nMigrate HTTP modules\", \" and handlers to middleware ........................................................................\", \".................... 83\\n\\nMigrate static files ......................................................\", \"....................................................................................................\", \"...... 84\\n\\nMigrate runtime bundling and minification setup .........................................\", \"......................................................... 84\\n\\nMigrate ASPX pages ...................\", \"....................................................................................................\", \"..................................... 84\\n\\nModel validation in Blazor ...............................\", \"....................................................................................................\", \"......... 88\\n\\nMigrate configuration ................................................................\", \"......................................................................................... 89\\n\\nMigrat\", \"e data access ......................................................................................\", \"....................................................................... 91\\n\\nArchitectural changes ..\", \"....................................................................................................\", \".................................................... 91\\n\\nMigration conclusion ......................\", \"....................................................................................................\", \"................................. 92\\n\\niv\\n\\nContents\\n\\nCHAPTER 1\\n\\nAn introduction to Blazor for ASP.NET\", \" Web Forms developers\\n\\nThe ASP.NET Web Forms framework has been a staple of .NET web development sin\", \"ce the .NET Framework first shipped in 2002. Back when the Web was still largely in its infancy, ASP\", \".NET Web Forms made building web apps simple and productive by adopting many of the patterns that we\", \"re used for desktop development. In ASP.NET Web Forms, web pages can be quickly composed from reusab\", \"le UI controls. User interactions are handled naturally as events. There\\u2019s a rich ecosystem of Web F\", \"orms UI controls provided by Microsoft and control vendors. The controls ease the efforts of connect\", \"ing to data sources and displaying rich data visualizations. For the visually inclined, the Web Form\", \"s designer provides a simple drag-and-drop interface for managing controls.\\n\\nOver the years, Microso\", \"ft has introduced new ASP.NET-based web frameworks to address web development trends. Some such web \", \"frameworks include ASP.NET MVC, ASP.NET Web Pages, and more recently ASP.NET Core. With each new fra\", \"mework, some have predicted the imminent decline of ASP.NET Web Forms and criticized it as an outdat\", \"ed, outmoded web framework. Despite these predictions, many .NET web developers continue to find ASP\", \".NET Web Forms a simple, stable, and productive way to get their work done.\\n\\nAt the time of writing,\", \" almost half a million web developers use ASP.NET Web Forms every month. The ASP.NET Web Forms frame\", \"work is stable to the point that docs, samples, books, and blog posts from a decade ago remain usefu\", \"l and relevant. For many .NET web developers, \\u201cASP.NET\\u201d is still synonymous with \\u201cASP.NET Web Forms\\u201d\", \" as it was when .NET was first conceived. Arguments on the pros and cons of ASP.NET Web Forms compar\", \"ed to the other new .NET web frameworks may rage on. ASP.NET Web Forms remains a popular framework f\", \"or creating web apps.\\n\\nEven so, innovations in software development aren\\u2019t slowing. All software dev\", \"elopers need to stay abreast of new technologies and trends. Two trends in particular are worth cons\", \"idering:\\n\\n1.\\n\\nThe shift to open-source and cross-platform\\n\\n2.\\n\\nThe shift of app logic to the client\\n\", \"\\n1\\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET Web Forms developers\\n\\nAn open-source and cross\", \"-platform .NET\\n\\nWhen .NET and ASP.NET Web Forms first shipped, the platform ecosystem looked much di\", \"fferent than it does today. The desktop and server markets were dominated by Windows. Alternative pl\", \"atforms like macOS and Linux were still struggling to gain traction. ASP.NET Web Forms ships with th\", \"e .NET Framework as a Windows-only component, which means ASP.NET Web Forms apps can only run on Win\", \"dows Server machines. Many modern environments now use different kinds of platforms for servers and \", \"development machines such that cross-platform support for many users is an absolute requirement.\\n\\nMo\", \"st modern web frameworks are now also open-source, which has a number of benefits. Users aren\\u2019t behe\", \"ld to a single project owner to fix bugs and add features. Open-source projects provide improved tra\", \"nsparency on development progress and upcoming changes. Open-source projects enjoy contributions fro\", \"m an entire community, and they foster a supportive open-source ecosystem. Despite the risks of open\", \"-source, many consumers and contributors have found suitable mitigations that enable them to enjoy t\", \"he benefits of an open-source ecosystem in a safe and reasonable way. Examples of such mitigations i\", \"nclude contributor license agreements, friendly licenses, pedigree scans, and supporting foundations\", \".\\n\\nThe .NET community has embraced both cross-platform support and open-source. .NET Core is an open\", \"-source and cross-platform implementation of .NET that runs on a plethora of platforms, including Wi\", \"ndows, macOS, and various Linux distributions. Xamarin provides Mono, an open-source version of .NET\", \". Mono runs on Android, iOS, and a variety of other form factors, including watches and smart TVs. I\", \"n 2020, Microsoft released .NET 5 that reconciled .NET Core and Mono into \\u201ca single .NET runtime and\", \" framework that can be used everywhere and that has uniform runtime behaviors and developer experien\", \"ces.\\u201d\\n\\nWill ASP.NET Web Forms benefit from the move to open-source and cross-platform support? The a\", \"nswer, unfortunately, is no, or at least not to the same extent as the rest of the platform. The .NE\", \"T team made it clear that ASP.NET Web Forms won\\u2019t be ported to .NET Core or .NET 8. Why is that?\\n\\nTh\", \"ere were efforts in the early days of .NET Core to port ASP.NET Web Forms. The number of breaking ch\", \"anges required were found to be too drastic. There\\u2019s also an admission here that even for Microsoft,\", \" there\\u2019s a limit to the number of web frameworks that it can support simultaneously. Perhaps someone\", \" in the community will take up the cause of creating an open-source and cross-platform version of AS\", \"P.NET Web Forms. The source code for ASP.NET Web Forms has been made available publicly in reference\", \" form. But for the time being, it seems ASP.NET Web Forms will remain Windows-only and without an op\", \"en-source contribution model. If cross-platform support or open-source become important for your sce\", \"narios, then you\\u2019ll need to look for something new.\\n\\nDoes this mean ASP.NET Web Forms is dead and sh\", \"ould no longer be used? Of course not! As long as the .NET Framework ships as part of Windows, ASP.N\", \"ET Web Forms will be a supported framework. For many Web Forms developers, the lack of cross-platfor\", \"m and open-source support is a non-issue. If you don\\u2019t have a requirement for cross-platform support\", \", open-source, or any of the other new features in .NET Core or .NET 8, then sticking with ASP.NET W\", \"eb Forms on Windows is fine. ASP.NET Web Forms will continue to be a productive way to write web app\", \"s for many years to come.\\n\\nBut there\\u2019s another trend worth considering, and that\\u2019s the shift to the \", \"client.\\n\\n2\\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET Web Forms developers\\n\\nClient-side web \", \"development\\n\\nAll of the .NET-based web frameworks, including ASP.NET Web Forms, have historically ha\", \"d one thing in common: they\\u2019re server-rendered. In server-rendered web apps, the browser makes a req\", \"uest to the server, which executes some code (.NET code in ASP.NET apps) to produce a response. That\", \" response is sent back to the browser to handle. In this model, the browser is used as a thin render\", \"ing engine. The hard work of producing the UI, running the business logic, and managing state occurs\", \" on the server.\\n\\nHowever, browsers have become versatile platforms. They implement an ever-increasin\", \"g number of open web standards that grant access to the capabilities of the user\\u2019s machine. Why not \", \"take advantage of the compute power, storage, memory, and other resources of the client device? UI i\", \"nteractions in particular can benefit from a richer and more interactive feel when handled at least \", \"partially or completely client-side. Logic and data that should be handled on the server can still b\", \"e handled server-side. Web API calls or even real-time protocols, like WebSockets, can be used. Thes\", \"e benefits are available to web developers for free if they\\u2019re willing to write JavaScript. Client-s\", \"ide UI frameworks, such as Angular, React, and Vue, simplify client-side web development and have gr\", \"own in popularity. ASP.NET Web Forms developers can also benefit from leveraging the client, and eve\", \"n have some out-of-the-box support with integrated JavaScript frameworks like ASP.NET AJAX.\\n\\nBut bri\", \"dging two different platforms and ecosystems (.NET and JavaScript) comes with a cost. Expertise is r\", \"equired in two parallel worlds with different languages, frameworks, and tools. Code and logic can\\u2019t\", \" be easily shared between client and server, resulting in duplication and engineering overhead. It c\", \"an also be difficult to keep up with the JavaScript ecosystem, which has a history of evolving at br\", \"eakneck speed. Front-end framework and build tool preferences change quickly. The industry has obser\", \"ved the progression from Grunt to Gulp to Webpack, and so on. The same restless churn has occurred w\", \"ith front-end frameworks such as jQuery, Knockout, Angular, React, and Vue. But given JavaScript\\u2019s b\", \"rowser monopoly, there was little choice in the matter. That is, until the web community got togethe\", \"r and caused a miracle to happen!\\n\\nWebAssembly fulfills a need\\n\\nIn 2015, the major browser vendors j\", \"oined forces in a W3C Community Group to create a new open web standard called WebAssembly. WebAssem\", \"bly is a byte code for the Web. If you can compile your code to WebAssembly, it can then run on any \", \"browser on any platform at near native speed. Initial efforts focused on C/C++. The result was a dra\", \"matic demonstration of running native 3D graphics engines directly in the browser without plugins. W\", \"ebAssembly has since been standardized and implemented by all major browsers.\\n\\nWork on running .NET \", \"on WebAssembly was announced in late 2017 and released in 2020, including support in .NET 5 and beyo\", \"nd. The ability to run .NET code directly in the browser enables full-stack web development with .NE\", \"T.\\n\\n3\\n\\nCHAPTER 1 | An introduction to Blazor for ASP.NET Web Forms developers\\n\\nBlazor: full-stack we\", \"b development with .NET\\n\\nOn its own, the ability to run .NET code in a browser doesn\\u2019t provide an en\", \"d-to-end experience for creating client-side web apps. That\\u2019s where Blazor comes in. Blazor is a cli\", \"ent-side web UI framework based on C# instead of JavaScript. Blazor can run directly in the browser \", \"via WebAssembly. No browser plugins are required. Alternatively, Blazor apps can run server-side on \", \".NET and handle all user interactions over a real-time connection with the browser.\\n\\nBlazor has grea\", \"t tooling support in Visual Studio and Visual Studio Code. The framework also includes a full UI com\", \"ponent model and has built-in facilities for:\\n\\n\\n\\nForms and validation\\n\\n\\n\\nDependency injection\\n\\n\\n\\nCli\", \"ent-side routing\\n\\n\\n\\nLayouts\\n\\n\\n\\nIn-browser debugging\\n\\n\\n\\nJavaScript interop\\n\\nBlazor has a lot in commo\", \"n with ASP.NET Web Forms. Both frameworks offer component-based, event-driven, stateful UI programmi\", \"ng models. The main architectural difference is that ASP.NET Web Forms runs only on the server. Blaz\", \"or can run on the client in the browser. But if you\\u2019re coming from an ASP.NET Web Forms background, \", \"there\\u2019s a lot in Blazor that will feel familiar. Blazor is a natural solution for ASP.NET Web Forms \", \"developers looking for a way to take advantage of client-side development and the open-source, cross\", \"-platform future of .NET.\\n\\nThis book provides an introduction to Blazor that is catered specifically\", \" to ASP.NET Web Forms developers. Each Blazor concept is presented in the context of analogous ASP.N\", \"ET Web Forms features and practices. By the end of this book, you\\u2019ll have an understanding of:\\n\\n\\n\\nHo\", \"w to build Blazor apps.\\n\\n\\n\\nHow Blazor works.\\n\\n\\n\\nHow Blazor relates to .NET.\\n\\n\\n\\nReasonable strategies\", \" for migrating existing ASP.NET Web Forms apps to Blazor where appropriate.\\n\\nGet started with Blazor\", \"\\n\\nGetting started with Blazor is easy. Go to https://blazor.net and follow the links to install the \", \"appropriate .NET SDK and Blazor project templates. You\\u2019ll also find instructions for setting up the \", \"Blazor tooling in Visual Studio or Visual Studio Code.\\n\\n4\\n\\nCHAPTER 1 | An introduction to Blazor for\", \" ASP.NET Web Forms developers\\n\\nCHAPTER 2\\n\\nArchitecture comparison of ASP.NET Web Forms and Blazor\\n\\nW\", \"hile ASP.NET Web Forms and Blazor have many similar concepts, there are differences in how they work\", \". This chapter examines the inner workings and architectures of ASP.NET Web Forms and Blazor.\\n\\nASP.N\", \"ET Web Forms\\n\\nThe ASP.NET Web Forms framework is based on a page-centric architecture. Each HTTP req\", \"uest for a location in the app is a separate page with which ASP.NET responds. As pages are requeste\", \"d, the contents of the browser are replaced with the results of the page requested.\\n\\nPages consist o\", \"f the following components:\\n\\n\\n\\nHTML markup\\n\\n\\n\\nC# or Visual Basic code\\n\\n\\n\\nA code-behind class contain\", \"ing logic and event-handling capabilities\\n\\n\\n\\nControls\\n\\nControls are reusable units of web UI that ca\", \"n be programmatically placed and interacted with on a page. Pages are composed of files that end wit\", \"h .aspx containing markup, controls, and some code. The code-behind classes are in files with the sa\", \"me base name and an .aspx.cs or .aspx.vb extension, depending on the programming language used. Inte\", \"restingly, the web server interprets contents of the .aspx files and compiles them whenever they cha\", \"nge. This recompilation occurs even if the web server is already running.\\n\\nControls can be built wit\", \"h markup and delivered as user controls. A user control derives from the UserControl class and has a\", \" similar structure to the Page. Markup for user controls is stored in an .ascx file. An accompanying\", \" code-behind class resides in an .ascx.cs or .ascx.vb file. Controls can also be built completely wi\", \"th code, by inheriting from either the WebControl or CompositeControl base class.\\n\\nPages also have a\", \"n extensive event lifecycle. Each page raises events for the initialization, load, prerender, and un\", \"load events that occur as the ASP.NET runtime executes the page\\u2019s code for each request.\\n\\n5\\n\\nCHAPTER\", \" 2 | Architecture comparison of ASP.NET Web Forms and Blazor\\n\\nControls on a Page typically post-back\", \" to the same page that presented the control, and carry along with them a payload from a hidden form\", \" field called ViewState. The ViewState field contains information about the state of the controls at\", \" the time they were rendered and presented on the page, allowing the ASP.NET runtime to compare and \", \"identify changes in the content submitted to the server.\\n\\nBlazor\\n\\nBlazor is a client-side web UI fra\", \"mework similar in nature to JavaScript front-end frameworks like Angular or React. Blazor handles us\", \"er interactions and renders the necessary UI updates. Blazor isn\\u2019t based on a request-reply model. U\", \"ser interactions are handled as events that aren\\u2019t in the context of any particular HTTP request.\\n\\nB\", \"lazor apps consist of one or more root components that are rendered on an HTML page.\\n\\nHow the user s\", \"pecifies where components should render and how the components are then wired up for user interactio\", \"ns is hosting model specific.\\n\\nBlazor components are .NET classes that represent a reusable piece of\", \" UI. Each component maintains its own state and specifies its own rendering logic, which can include\", \" rendering other components. Components specify event handlers for specific user interactions to upd\", \"ate the component\\u2019s state.\\n\\nAfter a component handles an event, Blazor renders the component and kee\", \"ps track of what changed in the rendered output. Components don\\u2019t render directly to the Document Ob\", \"ject Model (DOM). They instead render to an in-memory representation of the DOM called a RenderTree \", \"so that Blazor can track the changes. Blazor compares the newly rendered output with the previous ou\", \"tput to calculate a UI diff that it then applies efficiently to the DOM.\\n\\n6\\n\\nCHAPTER 2 | Architectur\", \"e comparison of ASP.NET Web Forms and Blazor\\n\\nComponents can also manually indicate that they should\", \" be rendered if their state changes outside of a normal UI event. Blazor uses a SynchronizationConte\", \"xt to enforce a single logical thread of execution. A component\\u2019s lifecycle methods and any event ca\", \"llbacks that are raised by Blazor are executed on this SynchronizationContext.\\n\\n7\\n\\nCHAPTER 2 | Archi\", \"tecture comparison of ASP.NET Web Forms and Blazor\\n\\nCHAPTER 3\\n\\nBlazor app hosting models\\n\\nBlazor app\", \"s can be hosted in one of the following ways:\\n\\n\\n\\nClient-side in the browser on WebAssembly.\\n\\n\\n\\nServe\", \"r-side in an ASP.NET Core app.\\n\\nBlazor WebAssembly apps\\n\\nBlazor WebAssembly apps execute directly in\", \" the browser on a WebAssembly-based .NET runtime. Blazor WebAssembly apps function in a similar way \", \"to front-end JavaScript frameworks like Angular or React. However, instead of writing JavaScript you\", \" write C#. The .NET runtime is downloaded with the app along with the app assembly and any required \", \"dependencies. No browser plugins or extensions are required.\\n\\nThe downloaded assemblies are normal .\", \"NET assemblies, like you would use in any other .NET app. Because the runtime supports .NET Standard\", \", you can use existing .NET Standard libraries with your Blazor WebAssembly app. However, these asse\", \"mblies will still execute in the browser security sandbox. Some functionality may throw a PlatformNo\", \"tSupportedException, like trying to access the file system or opening arbitrary network connections.\", \"\\n\\nWhen the app loads, the .NET runtime is started and pointed at the app assembly. The app startup l\", \"ogic runs, and the root components are rendered. Blazor calculates the UI updates based on the rende\", \"red output from the components. The DOM updates are then applied.\\n\\n8\\n\\nCHAPTER 3 | Blazor app hosting\", \" models\\n\\nBlazor WebAssembly apps run purely client-side. Such apps can be deployed to static site ho\", \"sting solutions like GitHub Pages or Azure Static Website Hosting. .NET isn\\u2019t required on the server\", \" at all. Deep linking to parts of the app typically requires a routing solution on the server. The r\", \"outing solution redirects requests to the root of the app. For example, this redirection can be hand\", \"led using URL rewrite rules in IIS.\\n\\nTo get all the benefits of Blazor and full-stack .NET web devel\", \"opment, host your Blazor WebAssembly app with ASP.NET Core. By using .NET on both the client and ser\", \"ver, you can easily share code and build your app using one consistent set of languages, frameworks,\", \" and tools. Blazor provides convenient templates for setting up a solution that contains both a Blaz\", \"or WebAssembly app and an ASP.NET Core host project. When the solution is built, the built static fi\", \"les from the Blazor app are hosted by the ASP.NET Core app with fallback routing already setup.\\n\\nBla\", \"zor Server apps\\n\\nRecall from the Blazor architecture discussion that Blazor components render their \", \"output to an intermediate abstraction called a RenderTree. The Blazor framework then compares what w\", \"as rendered with what was previously rendered. The differences are applied to the DOM. Blazor compon\", \"ents are decoupled from how their rendered output is applied. Consequently, the components themselve\", \"s don\\u2019t have to run in the same process as the process updating the UI. In fact, they don\\u2019t even hav\", \"e to run on the same machine.\\n\\nIn Blazor Server apps, the components run on the server instead of cl\", \"ient-side in the browser. UI events that occur in the browser are sent to the server over a real-tim\", \"e connection. The events are dispatched to the correct component instances. The components render, a\", \"nd the calculated UI diff is serialized and sent to the browser where it\\u2019s applied to the DOM.\\n\\n9\\n\\nC\", \"HAPTER 3 | Blazor app hosting models\\n\\nThe Blazor Server hosting model may sound familiar if you\\u2019ve u\", \"sed ASP.NET AJAX and the UpdatePanel control. The UpdatePanel control handles applying partial page \", \"updates in response to trigger events on the page. When triggered, the UpdatePanel requests a partia\", \"l update and then applies it without needing to refresh the page. The state of the UI is managed usi\", \"ng ViewState. Blazor Server apps are slightly different in that the app requires an active connectio\", \"n with the client. Additionally, all UI state is maintained on the server. Aside from those differen\", \"ces, the two models are conceptually similar.\\n\\nHow to choose the right Blazor hosting model\\n\\nAs desc\", \"ribed in the Blazor hosting model docs, the different Blazor hosting models have different tradeoffs\", \".\\n\\nThe Blazor WebAssembly hosting model has the following benefits:\\n\\n\\n\\nThere\\u2019s no .NET server-side d\", \"ependency. The app is fully functioning after downloaded to the client.\\n\\n\\n\\nClient resources and capa\", \"bilities are fully leveraged.\\n\\nWork is offloaded from the server to the client.\\n\\n\\n\\nAn ASP.NET Core w\", \"eb server isn\\u2019t required to host the app. Serverless deployment scenarios are possible (for example,\", \" serving the app from a CDN).\\n\\nThe downsides of the Blazor WebAssembly hosting model are:\\n\\n\\n\\nBrowser\", \" capabilities restrict the app.\\n\\n\\n\\nCapable client hardware and software (for example, WebAssembly su\", \"pport) is required.\\n\\n\\n\\nDownload size is larger, and apps take longer to load.\\n\\n10\\n\\nCHAPTER 3 | Blazo\", \"r app hosting models\\n\\n\\n\\n.NET runtime and tooling support is less mature. For example, there are limi\", \"tations in .NET Standard support and debugging.\\n\\nConversely, the Blazor Server hosting model offers \", \"the following benefits:\\n\\n\\n\\nDownload size is much smaller than a client-side app, and the app loads m\", \"uch faster.\\n\\n\\n\\nThe app takes full advantage of server capabilities, including use of any .NET compat\", \"ible APIs.\\n\\n\\n\\n.NET on the server is used to run the app, so existing .NET tooling, such as debugging\", \", works as expected.\\n\\n\\n\\nThin clients are supported. For example, server-side apps work with browsers\", \" that don\\u2019t support WebAssembly and on resource-constrained devices.\\n\\n\\n\\nThe app\\u2019s .NET/C# code base,\", \" including the app\\u2019s component code, isn\\u2019t served to clients.\\n\\nThe downsides to the Blazor Server ho\", \"sting model are:\\n\\n\\n\\nHigher UI latency. Every user interaction involves a network hop.\\n\\n\\n\\nThere\\u2019s no \", \"offline support. If the client connection fails, the app stops working.\\n\\n\\n\\nScalability is challengin\", \"g for apps with many users. The server must manage multiple client connections and handle client sta\", \"te.\\n\\n\\n\\nAn ASP.NET Core server is required to serve the app. Serverless deployment scenarios aren\\u2019t p\", \"ossible. For example, you can\\u2019t serve the app from a CDN.\\n\\nThe preceding list of trade-offs may be i\", \"ntimidating, but your hosting model can be changed later. Regardless of the Blazor hosting model sel\", \"ected, the component model is the same. In principle, the same components can be used with either ho\", \"sting model. Your app code doesn\\u2019t change; however, it\\u2019s a good practice to introduce abstractions s\", \"o that your components stay hosting model-agnostic. The abstractions allow your app to more easily a\", \"dopt a different hosting model.\\n\\nDeploy your app\\n\\nASP.NET Web Forms apps are typically hosted on IIS\", \" on a Windows Server machine or cluster. Blazor apps can also:\\n\\n\\n\\nBe hosted on IIS, either as static\", \" files or as an ASP.NET Core app.\\n\\n\\n\\nLeverage ASP.NET Core\\u2019s flexibility to be hosted on various pla\", \"tforms and server infrastructures. For example, you can host a Blazor App using Nginx or Apache on L\", \"inux. For more information about how to publish and deploy Blazor apps, see the Blazor Hosting and d\", \"eployment documentation.\\n\\nIn the next section, we\\u2019ll look at how the projects for Blazor WebAssembly\", \" and Blazor Server apps are set up.\\n\\n11\\n\\nCHAPTER 3 | Blazor app hosting models\\n\\nCHAPTER 4\\n\\nProject s\", \"tructure for Blazor apps\\n\\nDespite their significant project structure differences, ASP.NET Web Forms\", \" and Blazor share many similar concepts. Here, we\\u2019ll look at the structure of a Blazor project and c\", \"ompare it to an ASP.NET Web Forms project.\\n\\nTo create your first Blazor app, follow the instructions\", \" in the Blazor getting started steps. You can follow the instructions to create either a Blazor Serv\", \"er app or a Blazor WebAssembly app hosted in ASP.NET Core. Except for the hosting model-specific log\", \"ic, most of the code in both projects is the same.\\n\\nProject file\\n\\nBlazor Server apps are .NET projec\", \"ts. The project file for the Blazor Server app is about as simple as it can get:\\n\\n<Project Sdk=\\\"Micr\", \"osoft.NET.Sdk.Web\\\">\\n\\n<PropertyGroup> <TargetFramework>net8.0</TargetFramework> </PropertyGroup>\\n\\n</P\", \"roject> The project file for a Blazor WebAssembly app looks slightly more involved (exact version nu\", \"mbers may vary): <Project Sdk=\\\"Microsoft.NET.Sdk.BlazorWebAssembly\\\">\\n\\n<PropertyGroup> <TargetFramewo\", \"rk>net8.0</TargetFramework> <ImplicitUsings>enable</ImplicitUsings> </PropertyGroup>\\n\\n<ItemGroup> <P\", \"ackageReference Include=\\\"Microsoft.AspNetCore.Components.WebAssembly\\\" Version=\\\"8.0.0\\\" /> <PackageRef\", \"erence Include=\\\"Microsoft.AspNetCore.Components.WebAssembly.DevServer\\\" Version=\\\"8.0.0\\\" PrivateAssets\", \"=\\\"all\\\" /> </ItemGroup>\\n\\n</Project>\\n\\n12\\n\\nCHAPTER 4 | Project structure for Blazor apps\\n\\nBlazor WebAss\", \"embly project targets Microsoft.NET.Sdk.BlazorWebAssembly instead of Microsoft.NET.Sdk.Web sdk becau\", \"se they run in the browser on a WebAssembly-based .NET runtime. You can\\u2019t install .NET into a web br\", \"owser like you can on a server or developer machine. Consequently, the project references the Blazor\", \" framework using individual package references.\\n\\nBy comparison, a default ASP.NET Web Forms project \", \"includes almost 300 lines of XML in its .csproj file, most of which is explicitly listing the variou\", \"s code and content files in the project. Since the release of .NET 5, both Blazor Server and Blazor \", \"WebAssembly apps can easily share one unified runtime.\\n\\nAlthough they\\u2019re supported, individual assem\", \"bly references are less common in .NET projects. Most project dependencies are handled as NuGet pack\", \"age references. You only need to reference top-level package dependencies in .NET projects. Transiti\", \"ve dependencies are included automatically. Instead of using the packages.config file commonly found\", \" in ASP.NET Web Forms projects to reference packages, package references are added to the project fi\", \"le using the <PackageReference> element.\\n\\n<ItemGroup> <PackageReference Include=\\\"Newtonsoft.Json\\\" Ve\", \"rsion=\\\"13.0.2\\\" /> </ItemGroup>\\n\\nEntry point\\n\\nThe Blazor Server app\\u2019s entry point is defined in the P\", \"rogram.cs file, as you would see in a Console app. When the app executes, it creates and runs a web \", \"host instance using defaults specific to web apps. The web host manages the Blazor Server app\\u2019s life\", \"cycle and sets up host-level services. Examples of such services are configuration, logging, depende\", \"ncy injection, and the HTTP server. This code is mostly boilerplate and is often left unchanged.\\n\\nus\", \"ing BlazorApp3.Areas.Identity; using BlazorApp3.Data; using Microsoft.AspNetCore.Components.Authoriz\", \"ation; using Microsoft.AspNetCore.Identity; using Microsoft.EntityFrameworkCore;\\n\\nvar builder = WebA\", \"pplication.CreateBuilder(args);\\n\\n// Add services to the container. var connectionString = builder.Co\", \"nfiguration.GetConnectionString(\\\"DefaultConnection\\\"); builder.Services.AddDbContext<ApplicationDbCon\", \"text>(options => options.UseSqlServer(connectionString)); builder.Services.AddDatabaseDeveloperPageE\", \"xceptionFilter(); builder.Services.AddDefaultIdentity<IdentityUser>(options => options.SignIn.Requir\", \"eConfirmedAccount = true) .AddEntityFrameworkStores<ApplicationDbContext>(); builder.Services.AddRaz\", \"orPages(); builder.Services.AddServerSideBlazor(); builder.Services.AddScoped<AuthenticationStatePro\", \"vider, RevalidatingIdentityAuthenticationStateProvider<IdentityUser>>(); builder.Services.AddSinglet\", \"on<WeatherForecastService>();\\n\\nvar app = builder.Build();\\n\\n// Configure the HTTP request pipeline.\\n\\n\", \"13\\n\\nCHAPTER 4 | Project structure for Blazor apps\\n\\nif (app.Environment.IsDevelopment()) { app.UseMig\", \"rationsEndPoint(); } else { app.UseExceptionHandler(\\\"/Error\\\"); // The default HSTS value is 30 days.\", \" You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts. app.UseHs\", \"ts(); }\\n\\napp.UseHttpsRedirection();\\n\\napp.UseStaticFiles();\\n\\napp.UseRouting();\\n\\napp.UseAuthorization(\", \");\\n\\napp.MapControllers(); app.MapBlazorHub(); app.MapFallbackToPage(\\\"/_Host\\\");\\n\\napp.Run();\\n\\nBlazor W\", \"ebAssembly apps also define an entry point in Program.cs. The code looks slightly different. The cod\", \"e is similar in that it\\u2019s setting up the app host to provide the same host-level services to the app\", \". The WebAssembly app host doesn\\u2019t, however, set up an HTTP server because it executes directly in t\", \"he browser.\\n\\nBlazor apps don\\u2019t use a Global.asax file to define the startup logic for the app. Inste\", \"ad, this logic is contained in Program.cs or in a related Startup class that is referenced from Prog\", \"ram.cs. Either way, this code is used to configure the app and any app-specific services.\\n\\nIn a Blaz\", \"or Server app, the Program.cs file shown is used to set up the endpoint for the real-time connection\", \" used by Blazor between the client browsers and the server.\\n\\nIn a Blazor WebAssembly app, the Progra\", \"m.cs file defines the root components for the app and where they should be rendered:\\n\\nusing BlazorAp\", \"p1; using Microsoft.AspNetCore.Components.Web; using Microsoft.AspNetCore.Components.WebAssembly.Hos\", \"ting;\\n\\nvar builder = WebAssemblyHostBuilder.CreateDefault(args); builder.RootComponents.Add<App>(\\\"#a\", \"pp\\\"); builder.RootComponents.Add<HeadOutlet>(\\\"head::after\\\");\\n\\nbuilder.Services.AddScoped(sp => new H\", \"ttpClient { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });\\n\\nawait builder.Build().Ru\", \"nAsync();\\n\\n14\\n\\nCHAPTER 4 | Project structure for Blazor apps\\n\\nStatic files\\n\\nUnlike ASP.NET Web Forms\", \" projects, not all files in a Blazor project can be requested as static files. Only the files in the\", \" wwwroot folder are web-addressable. This folder is referred to as the app\\u2019s \\u201cweb root\\u201d. Anything ou\", \"tside of the app\\u2019s web root isn\\u2019t web-addressable. This setup provides an additional level of securi\", \"ty that prevents accidental exposure of project files over the web.\\n\\nConfiguration\\n\\nConfiguration in\", \" ASP.NET Web Forms apps is typically handled using one or more web.config files. Blazor apps don\\u2019t t\", \"ypically have web.config files. If they do, the file is only used to configure IIS- specific setting\", \"s when hosted on IIS. Instead, Blazor Server apps use the ASP.NET Core configuration abstractions. (\", \"Blazor WebAssembly apps don\\u2019t currently support the same configuration abstractions, but that may be\", \" a feature added in the future.) For example, the default Blazor Server app stores some settings in \", \"appsettings.json.\\n\\n{ \\\"Logging\\\": { \\\"LogLevel\\\": { \\\"Default\\\": \\\"Information\\\", \\\"Microsoft\\\": \\\"Warning\\\", \\\"M\", \"icrosoft.Hosting.Lifetime\\\": \\\"Information\\\" } }, \\\"AllowedHosts\\\": \\\"*\\\" }\\n\\nYou\\u2019ll learn more about config\", \"uration in ASP.NET Core projects in the Configuration section.\\n\\nRazor components\\n\\nMost files in Blaz\", \"or projects are .razor files. Razor is a templating language based on HTML and C# that is used to dy\", \"namically generate web UI. The .razor files define components that make up the UI of the app. For th\", \"e most part, the components are identical for both the Blazor Server and Blazor WebAssembly apps. Co\", \"mponents in Blazor are analogous to user controls in ASP.NET Web Forms.\\n\\nEach Razor component file i\", \"s compiled into a .NET class when the project is built. The generated class captures the component\\u2019s\", \" state, rendering logic, lifecycle methods, event handlers, and other logic. You\\u2019ll learn more about\", \" authoring components in the Building reusable UI components with Blazor section.\\n\\nThe *_Imports.raz\", \"or* files aren\\u2019t Razor component files. Instead, they define a set of Razor directives to import int\", \"o other .razor files within the same folder and in its subfolders. For example, a *_Imports.razor* f\", \"ile is a conventional way to add using directives for commonly used namespaces:\\n\\n@using System.Net.H\", \"ttp @using System.Net.Http.Json @using Microsoft.AspNetCore.Components.Forms @using Microsoft.AspNet\", \"Core.Components.Routing\\n\\n15\\n\\nCHAPTER 4 | Project structure for Blazor apps\\n\\n@using Microsoft.AspNetC\", \"ore.Components.Web @using Microsoft.AspNetCore.Components.Web.Virtualization @using Microsoft.AspNet\", \"Core.Components.WebAssembly.Http @using Microsoft.JSInterop @using BlazorApp1 @using BlazorApp1.Shar\", \"ed\\n\\nPages\\n\\nWhere are the pages in the Blazor apps? Blazor doesn\\u2019t define a separate file extension f\", \"or addressable pages, like the .aspx files in ASP.NET Web Forms apps. Instead, pages are defined by \", \"assigning routes to components. A route is typically assigned using the @page Razor directive. For e\", \"xample, the Counter component authored in the Pages/Counter.razor file defines the following route:\\n\", \"\\n@page \\\"/counter\\\"\\n\\nRouting in Blazor is handled client-side, not on the server. As the user navigate\", \"s in the browser, Blazor intercepts the navigation and then renders the component with the matching \", \"route.\\n\\nThe component routes aren\\u2019t currently inferred by the component\\u2019s file location like they ar\", \"e with .aspx pages or ASP.NET Core Razor Pages. This feature may be added in the future. Each route \", \"must be specified explicitly on the component. Storing routable components in a Pages folder has no \", \"special meaning and is purely a convention.\\n\\nYou\\u2019ll learn more about routing in Blazor in the Pages,\", \" routing, and layouts section.\\n\\nLayout\\n\\nIn ASP.NET Web Forms apps, a common page layout is handled u\", \"sing master pages (Site.Master). In Blazor apps, the page layout is handled using layout components \", \"(Shared/MainLayout.razor). Layout components are discussed in more detail in the Page, routing, and \", \"layouts section.\\n\\nBootstrap Blazor\\n\\nTo bootstrap Blazor, the app must:\\n\\n\\n\\nSpecify where on the page \", \"the root component (App.Razor) should be rendered.\\n\\n\\n\\nAdd the corresponding Blazor framework script.\", \"\\n\\nIn the Blazor Server app, the root component\\u2019s host page is defined in the *_Host.cshtml* file. Th\", \"is file defines a Razor Page, not a component. Razor Pages use Razor syntax to define a server-addre\", \"ssable page, very much like an .aspx page.\\n\\n@page \\\"/\\\" @namespace BlazorApp3.Pages @addTagHelper *, M\", \"icrosoft.AspNetCore.Mvc.TagHelpers @{ Layout = \\\"_Layout\\\"; }\\n\\n16\\n\\nCHAPTER 4 | Project structure for B\", \"lazor apps\\n\\n<component type=\\\"typeof(App)\\\" render-mode=\\\"ServerPrerendered\\\" />\\n\\nThe render-mode attrib\", \"ute is used to define where a root-level component should be rendered. The RenderMode option indicat\", \"es the manner in which the component should be rendered. The following table outlines the supported \", \"RenderMode options.\\n\\nOption\\n\\nDescription\\n\\nRenderMode.Server\\n\\nRendered interactively once a connectio\", \"n with the browser is established\\n\\nRenderMode.ServerPrerendered\\n\\nFirst prerendered and then rendered\", \" interactively\\n\\nRenderMode.Static\\n\\nRendered as static content\\n\\nThe *_Layout.cshtml* file includes th\", \"e default HTML for the app and its components.\\n\\n@using Microsoft.AspNetCore.Components.Web @namespac\", \"e BlazorApp3.Pages @addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers\\n\\n<!DOCTYPE html> <html lang=\", \"\\\"en\\\"> <head> <meta charset=\\\"utf-8\\\" /> <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-sca\", \"le=1.0\\\" /> <base href=\\\"~/\\\" /> <link rel=\\\"stylesheet\\\" href=\\\"css/bootstrap/bootstrap.min.css\\\" /> <link\", \" href=\\\"css/site.css\\\" rel=\\\"stylesheet\\\" /> <link href=\\\"BlazorApp3.styles.css\\\" rel=\\\"stylesheet\\\" /> <com\", \"ponent type=\\\"typeof(HeadOutlet)\\\" render-mode=\\\"ServerPrerendered\\\" /> </head> <body> @RenderBody()\\n\\n<d\", \"iv id=\\\"blazor-error-ui\\\"> <environment include=\\\"Staging,Production\\\"> An error has occurred. This appl\", \"ication may no longer respond until reloaded. </environment> <environment include=\\\"Development\\\"> An \", \"unhandled exception has occurred. See browser dev tools for details. </environment> <a href=\\\"\\\" class\", \"=\\\"reload\\\">Reload</a> <a class=\\\"dismiss\\\">\\ud83d\\uddd9</a> </div>\\n\\n<script src=\\\"_framework/blazor.server.js\\\"></sc\", \"ript> </body> </html>\\n\\nThe script reference to *_framework/blazor.server.js* establishes the real-ti\", \"me connection with the server and then deals with all user interactions and UI updates.\\n\\n17\\n\\nCHAPTER\", \" 4 | Project structure for Blazor apps\\n\\nIn the Blazor WebAssembly app, the host page is a simple sta\", \"tic HTML file under wwwroot/index.html. The <div> element with id named app is used to indicate wher\", \"e the root component should be rendered.\\n\\n<!DOCTYPE html> <html lang=\\\"en\\\">\\n\\n<head> <meta charset=\\\"ut\", \"f-8\\\" /> <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0, maximum- scale=1.0, us\", \"er-scalable=no\\\" /> <title>BlazorApp1</title> <base href=\\\"/\\\" /> <link href=\\\"css/bootstrap/bootstrap.m\", \"in.css\\\" rel=\\\"stylesheet\\\" /> <link href=\\\"css/app.css\\\" rel=\\\"stylesheet\\\" /> <link href=\\\"BlazorApp1.styl\", \"es.css\\\" rel=\\\"stylesheet\\\" /> </head>\\n\\n<body> <div id=\\\"app\\\">Loading...</div>\\n\\n<div id=\\\"blazor-error-ui\", \"\\\"> An unhandled error has occurred. <a href=\\\"\\\" class=\\\"reload\\\">Reload</a> <a class=\\\"dismiss\\\">\\ud83d\\uddd9</a> </\", \"div> <script src=\\\"_framework/blazor.webassembly.js\\\"></script> </body>\\n\\n</html>\\n\\nThe root component t\", \"o render is specified in the app\\u2019s Program.cs file with the flexibility to register services through\", \" dependency injection. For more information, see ASP.NET Core Blazor dependency injection.\\n\\nvar buil\", \"der = WebAssemblyHostBuilder.CreateDefault(args); builder.RootComponents.Add<App>(\\\"#app\\\"); builder.R\", \"ootComponents.Add<HeadOutlet>(\\\"head::after\\\");\\n\\nBuild output\\n\\nWhen a Blazor project is built, all Raz\", \"or component and code files are compiled into a single assembly. Unlike ASP.NET Web Forms projects, \", \"Blazor doesn\\u2019t support runtime compilation of the UI logic.\\n\\nRun the app with Hot Reload\\n\\nTo run the\", \" Blazor Server app, press F5 in Visual Studio to run with the debugger attached, or Ctrl + F5 to run\", \" without the debugger attached.\\n\\nTo run the Blazor WebAssembly app, choose one of the following appr\", \"oaches:\\n\\n\\n\\nRun the client project directly using the development server.\\n\\n18\\n\\nCHAPTER 4 | Project st\", \"ructure for Blazor apps\\n\\n\\n\\nRun the server project when hosting the app with ASP.NET Core.\\n\\nBlazor We\", \"bAssembly apps can be debugged in both browser and Visual Studio. See Debug ASP.NET Core Blazor WebA\", \"ssembly for details.\\n\\nBoth Blazor Server and Blazor WebAssembly apps support Hot Reload in Visual St\", \"udio. Hot Reload is a feature that automatically updates changes made to a Blazor app live, in the b\", \"rowser. You can toggle whether Hot Reload is enabled from its icon in the toolbar:\\n\\nSelecting the ca\", \"ret beside the icon reveals additional options. You can toggle Hot Reload on or off, restart the app\", \"lication, and toggle whether Hot Reload should occur whenever a file is saved.\\n\\nYou can also access \", \"additional configuration options. The configuration dialog lets you specify whether Hot Reload shoul\", \"d be enabled when debugging (along with Edit and Continue), when starting without debugging, or when\", \" a file is saved.\\n\\n19\\n\\nCHAPTER 4 | Project structure for Blazor apps\\n\\nThe \\u201cdeveloper inner loop\\u201d has\", \" been greatly streamlined with Hot Reload. Without Hot Reload, a Blazor developer would typically ne\", \"ed to restart and rerun the app after every change, navigating to the appropriate part of the app as\", \" required. With Hot Reload, changes can be made to the running app without the need to restart in mo\", \"st cases. Hot Reload even retains the state of pages, so there\\u2019s no need to have to re-enter form va\", \"lues or otherwise get the app back where you need it.\\n\\n20\\n\\nCHAPTER 4 | Project structure for Blazor \", \"apps\\n\\nCHAPTER 5\\n\\nApp startup\\n\\nApplications that are written for ASP.NET typically have a global.asax\", \".cs file that defines the Application_Start event that controls which services are configured and ma\", \"de available for both HTML rendering and .NET processing. This chapter looks at how things are sligh\", \"tly different with ASP.NET Core and Blazor Server.\\n\\nApplication_Start and Web Forms\\n\\nThe default web\", \" forms Application_Start method has grown in purpose over years to handle many configuration tasks. \", \"A fresh web forms project with the default template in Visual Studio 2022 now contains the following\", \" configuration logic:\\n\\n\\n\\nRouteConfig - Application URL routing\\n\\n\\n\\nBundleConfig - CSS and JavaScript \", \"bundling and minification\\n\\nEach of these individual files resides in the App_Start folder and run on\", \"ly once at the start of our application. RouteConfig in the default project template adds the Friend\", \"lyUrlSettings for web forms to allow application URLs to omit the .ASPX file extension. The default \", \"template also contains a directive that provides permanent HTTP redirect status codes (HTTP 301) for\", \" the .ASPX pages to the friendly URL with the file name that omits the extension.\\n\\nWith ASP.NET Core\", \" and Blazor, these methods are either simplified and consolidated into the Startup class or they are\", \" eliminated in favor of common web technologies.\\n\\nBlazor Server Startup Structure\\n\\nBlazor Server app\", \"lications reside on top of an ASP.NET Core 3.0 or later version. ASP.NET Core web applications are c\", \"onfigured in Program.cs, or through a pair of methods in the Startup.cs class. A sample Program.cs f\", \"ile is shown below:\\n\\nusing BlazorApp1.Data; using Microsoft.AspNetCore.Components; using Microsoft.A\", \"spNetCore.Components.Web;\\n\\nvar builder = WebApplication.CreateBuilder(args);\\n\\n// Add services to the\", \" container. builder.Services.AddRazorPages(); builder.Services.AddServerSideBlazor(); builder.Servic\", \"es.AddSingleton<WeatherForecastService>();\\n\\n21\\n\\nCHAPTER 5 | App startup\\n\\nvar app = builder.Build();\\n\", \"\\n// Configure the HTTP request pipeline. if (!app.Environment.IsDevelopment()) { app.UseExceptionHan\", \"dler(\\\"/Error\\\"); // The default HSTS value is 30 days. You may want to change this for production sce\", \"narios, see https://aka.ms/aspnetcore-hsts. app.UseHsts(); }\\n\\napp.UseHttpsRedirection(); app.UseStat\", \"icFiles(); app.UseRouting(); app.MapBlazorHub(); app.MapFallbackToPage(\\\"/_Host\\\");\\n\\napp.Run();\\n\\nThe a\", \"pp\\u2019s required services are added to the WebApplicationBuilder instance\\u2019s Services collection. This i\", \"s how the various ASP.NET Core framework services are configured with the framework\\u2019s built-in depen\", \"dency injection container. The various builder.Services.Add* methods add services that enable featur\", \"es such as authentication, razor pages, MVC controller routing, SignalR, and Blazor Server interacti\", \"ons among many others. This method was not needed in web forms, as the parsing and handling of the A\", \"SPX, ASCX, ASHX, and ASMX files were defined by referencing ASP.NET in the web.config configuration \", \"file. More information about dependency injection in ASP.NET Core is available in the online documen\", \"tation.\\n\\nAfter the app has been built by the builder, the rest of the calls on app configure its HTT\", \"P pipeline. With these calls, we declare from top to bottom the Middleware that will handle every re\", \"quest sent to our application. Most of these features in the default configuration were scattered ac\", \"ross the web forms configuration files and are now in one place for ease of reference.\\n\\nNo longer is\", \" the configuration of the custom error page placed in a web.config file, but now is configured to al\", \"ways be shown if the application environment is not labeled Development. Additionally, ASP.NET Core \", \"applications are now configured to serve secure pages with TLS by default with the UseHttpsRedirecti\", \"on method call.\\n\\nNext, an unexpected configuration method call is made to UseStaticFiles. In ASP.NET\", \" Core, support for requests for static files (like JavaScript, CSS, and image files) must be explici\", \"tly enabled, and only files in the app\\u2019s wwwroot folder are publicly addressable by default.\\n\\nThe ne\", \"xt line is the first that replicates one of the configuration options from web forms: UseRouting. Th\", \"is method adds the ASP.NET Core router to the pipeline and it can be either configured here or in th\", \"e individual files that it can consider routing to. More information about routing configuration can\", \" be found in the Routing section.\\n\\nThe final app.Map* calls in this section define the endpoints tha\", \"t ASP.NET Core is listening on. These routes are the web accessible locations that you can access on\", \" the web server and receive some content handled by .NET and returned to you. The first entry, MapBl\", \"azorHub configures a SignalR hub for use in providing the real-time and persistent connection to the\", \" server where the state and rendering of Blazor components is handled. The MapFallbackToPage method \", \"call indicates the web- accessible location of the page that starts the Blazor application and also \", \"configures the application to\\n\\n22\\n\\nCHAPTER 5 | App startup\\n\\nhandle deep-linking requests from the cl\", \"ient-side. You will see this feature at work if you open a browser and navigate directly to Blazor h\", \"andled route in your application, such as /counter in the default project template. The request gets\", \" handled by the *_Host.cshtml* fallback page, which then runs the Blazor router and renders the coun\", \"ter page.\\n\\nThe very last line starts the application, something that wasn\\u2019t required in web forms (s\", \"ince it relied on IIS to be running).\\n\\nUpgrading the BundleConfig Process\\n\\nTechnologies for bundling\", \" assets like CSS stylesheets and JavaScript files have changed significantly, with other technologie\", \"s providing quickly evolving tools and techniques for managing these resources. To this end, we reco\", \"mmend using a Node command-line tool such as Grunt / Gulp / WebPack to package your static assets.\\n\\n\", \"The Grunt, Gulp, and WebPack command-line tools and their associated configurations can be added to \", \"your application and ASP.NET Core will quietly ignore those files during the application build proce\", \"ss. You can add a call to run their tasks by adding a Target inside your project file with syntax si\", \"milar to the following that would trigger a gulp script and the min target inside that script:\\n\\n<Tar\", \"get Name=\\\"MyPreCompileTarget\\\" BeforeTargets=\\\"Build\\\"> <Exec Command=\\\"gulp min\\\" /> </Target>\\n\\nMore det\", \"ails about both strategies to manage your CSS and JavaScript files are available in the Bundle and m\", \"inify static assets in ASP.NET Core documentation.\\n\\n23\\n\\nCHAPTER 5 | App startup\\n\\nCHAPTER 6\\n\\nBuild re\", \"usable UI components with Blazor\\n\\nOne of the beautiful things about ASP.NET Web Forms is how it enab\", \"les encapsulation of reusable pieces of user interface (UI) code into reusable UI controls. Custom u\", \"ser controls can be defined in markup using .ascx files. You can also build elaborate server control\", \"s in code with full designer support.\\n\\nBlazor also supports UI encapsulation through components. A c\", \"omponent:\\n\\n\\n\\nIs a self-contained chunk of UI.\\n\\nMaintains its own state and rendering logic.\\n\\n\\n\\nCan d\", \"efine UI event handlers, bind to input data, and manage its own lifecycle.\\n\\n\\n\\nIs typically defined i\", \"n a .razor file using Razor syntax.\\n\\nAn introduction to Razor\\n\\nRazor is a light-weight markup templa\", \"ting language based on HTML and C#. With Razor, you can seamlessly transition between markup and C# \", \"code to define your component rendering logic. When the .razor file is compiled, the rendering logic\", \" is captured in a structured way in a .NET class. The name of the compiled class is taken from the .\", \"razor file name. The namespace is taken from the default namespace for the project and the folder pa\", \"th, or you can explicitly specify the namespace using the @namespace directive (more on Razor direct\", \"ives below).\\n\\nA component\\u2019s rendering logic is authored using normal HTML markup with dynamic logic \", \"added using C#. The @ character is used to transition to C#. Razor is typically smart about figuring\", \" out when you\\u2019ve switched back to HTML. For example, the following component renders a <p> tag with \", \"the current time:\\n\\n<p>@DateTime.Now</p>\\n\\nTo explicitly specify the beginning and ending of a C# expr\", \"ession, use parentheses:\\n\\n<p>@(DateTime.Now)</p>\\n\\nRazor also makes it easy to use C# control flow in\", \" your rendering logic. For example, you can conditionally render some HTML like this:\\n\\n24\\n\\nCHAPTER 6\", \" | Build reusable UI components with Blazor\\n\\n@if (value % 2 == 0) { <p>The value was even.</p> }\\n\\nOr\", \" you can generate a list of items using a normal C# foreach loop like this:\\n\\n<ul> @foreach (var item\", \" in items) { <li>@item.Text</li> } </ul>\\n\\nRazor directives, like directives in ASP.NET Web Forms, co\", \"ntrol many aspects of how a Razor component is compiled. Examples include the component\\u2019s:\\n\\n\\n\\nNamesp\", \"ace\\n\\n\\n\\nBase class\\n\\n\\n\\nImplemented interfaces\\n\\n\\n\\nGeneric parameters\\n\\n\\n\\nImported namespaces\\n\\n\\n\\nRoutes\\n\\n\", \"Razor directives start with the @ character and are typically used at the start of a new line at the\", \" start of the file. For example, the @namespace directive defines the component\\u2019s namespace:\\n\\n@names\", \"pace MyComponentNamespace\\n\\nThe following table summarizes the various Razor directives used in Blazo\", \"r and their ASP.NET Web Forms equivalents, if they exist.\\n\\nDirective\\n\\nDescription\\n\\nExample\\n\\nWeb Form\", \"s equivalent\\n\\n@attribute\\n\\nAdds a class-level attribute to the component\\n\\n@attribute [Authorize]\\n\\nNon\", \"e\\n\\n@code\\n\\nAdds class members to the component\\n\\n@code { ... } <script runat=\\\"server\\\">...</script>\\n\\n@i\", \"mplements\\n\\nImplements the specified interface\\n\\n@impleme nts IDisposable\\n\\nUse code-behind\\n\\n@inherits\\n\", \"\\nInherits from the specified base class\\n\\n@inherits MyCompon entBase\\n\\n<%@ Control Inherits=\\\"MyUserCon\", \"trolBase\\\" %>\\n\\n@inject\\n\\nInjects a service into the component\\n\\n@inject IJSRuntime JS\\n\\nNone\\n\\n25\\n\\nCHAPTE\", \"R 6 | Build reusable UI components with Blazor\\n\\nDirective\\n\\nDescription\\n\\nExample\\n\\nWeb Forms equivalen\", \"t\\n\\n@layout\\n\\nSpecifies a layout component for the component\\n\\n@layout MainLayout\\n\\n<%@ Page MasterPageF\", \"ile=\\\"~/Site.Master\\\" %>\\n\\n@namespace\\n\\nSets the namespace for the component\\n\\n@namespa ce MyNamesp ace\\n\\n\", \"None\\n\\n@page\\n\\nSpecifies the route for the component\\n\\n@page \\\"/product/{i d}\\\"\\n\\n<%@ Page %>\\n\\n@typeparam\\n\", \"\\nSpecifies a generic type parameter for the component\\n\\n@typepara m TItem\\n\\nUse code-behind\\n\\n@using\\n\\nS\", \"pecifies a namespace to bring into scope\\n\\n@using MyCompon entNamesp ace\\n\\nAdd namespace in web.config\", \"\\n\\nRazor components also make extensive use of directive attributes on elements to control various as\", \"pects of how components get compiled (event handling, data binding, component & element references, \", \"and so on). Directive attributes all follow a common generic syntax where the values in parenthesis \", \"are optional:\\n\\n@directive(-suffix(:name))(=\\\"value\\\")\\n\\nThe following table summarizes the various attr\", \"ibutes for Razor directives used in Blazor.\\n\\nAttribute\\n\\nDescription\\n\\nExample\\n\\n@attributes\\n\\nRenders a\", \" dictionary of attributes\\n\\n<input @attributes=\\\"ExtraA ttributes\\\" />\\n\\n@bind\\n\\nCreates a two-way data b\", \"inding\\n\\n<input @bind=\\\"username\\\" @bind:event=\\\"oninp ut\\\" />\\n\\n@on{event}\\n\\nAdds an event handler for the\", \" specified event\\n\\n<button @onclick=\\\"Incremen tCount\\\">Click me!</button>\\n\\n@key\\n\\nSpecifies a key to be\", \" used by the diffing algorithm for preserving elements in a collection\\n\\n<DetailsEditor @key=\\\"person\\\"\", \" Details=\\\"person.Det ails\\\" />\\n\\n26\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nAttribute\\n\\n\", \"Description\\n\\nExample\\n\\n@ref\\n\\nCaptures a reference to the component or HTML element\\n\\n<MyDialog @ref=\\\"m\", \"yDialog\\\" />\\n\\nThe various directive attributes used by Blazor (@onclick, @bind, @ref, and so on) are \", \"covered in the sections below and later chapters.\\n\\nMany of the syntaxes used in .aspx and .ascx file\", \"s have parallel syntaxes in Razor. Below is a simple comparison of the syntaxes for ASP.NET Web Form\", \"s and Razor.\\n\\nFeature\\n\\nWeb Forms\\n\\nSyntax\\n\\nRazor\\n\\nSynt ax\\n\\nDirectives\\n\\n<%@ [directive] %> <%@ Page %>\", \"\\n\\n@[directive] @pa\\n\\nge\\n\\nCode blocks\\n\\n<% %>\\n\\n<% int x = 123; %> @{ }\\n\\n@{ int x = 123; }\\n\\nExpressions \", \"(HTML-encoded)\\n\\n<%: %>\\n\\n<%:DateTime.Now %>\\n\\nImplicit: @ Explicit: @()\\n\\n@Da teTi me.N ow @(Da teTi me\", \".N ow)\\n\\nComments\\n\\n<%-- --%>\\n\\n<%-- Commented -- %>\\n\\n@* *@\\n\\n@* Com ment ed *@\\n\\nData binding\\n\\n<%# %>\\n\\n<\", \"%# Bind(\\\"Name\\\") %>\\n\\n@bind\\n\\n<inp ut @bin d=\\\"u serna me\\\" />\\n\\nTo add members to the Razor component cla\", \"ss, use the @code directive. This technique is similar to using a <script runat=\\\"server\\\">...</script\", \"> block in an ASP.NET Web Forms user control or page.\\n\\n@code { int count = 0;\\n\\nvoid IncrementCount()\", \" { count++;\\n\\n27\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\n} }\\n\\nBecause Razor is based o\", \"n C#, it must be compiled from within a C# project (.csproj). You can\\u2019t compile .razor files from a \", \"Visual Basic project (.vbproj). You can still reference Visual Basic projects from your Blazor proje\", \"ct. The opposite is true too.\\n\\nFor a full Razor syntax reference, see Razor syntax reference for ASP\", \".NET Core.\\n\\nUse components\\n\\nAside from normal HTML, components can also use other components as part\", \" of their rendering logic. The syntax for using a component in Razor is similar to using a user cont\", \"rol in an ASP.NET Web Forms app. Components are specified using an element tag that matches the type\", \" name of the component. For example, you can add a Counter component like this:\\n\\n<Counter />\\n\\nUnlike\", \" ASP.NET Web Forms, components in Blazor:\\n\\n\\n\\nDon\\u2019t use an element prefix (for example, asp:).\\n\\n\\n\\nDon\", \"\\u2019t require registration on the page or in the web.config.\\n\\nThink of Razor components like you would \", \".NET types, because that\\u2019s exactly what they are. If the assembly containing the component is refere\", \"nced, then the component is available for use. To bring the component\\u2019s namespace into scope, apply \", \"the @using directive:\\n\\n@using MyComponentLib\\n\\n<Counter />\\n\\nAs seen in the default Blazor projects, i\", \"t\\u2019s common to put @using directives into a *_Imports.razor* file so that they\\u2019re imported into all .\", \"razor files in the same directory and in child directories.\\n\\nIf the namespace for a component isn\\u2019t \", \"in scope, you can specify a component using its full type name, as you can in C#:\\n\\n<MyComponentLib.C\", \"ounter />\\n\\nModify page title from components\\n\\nWhen building SPA-style apps, it\\u2019s common for parts of\", \" a page to reload without reloading the entire page. Even so, it can be useful to have the title of \", \"the page change based on which component is currently loaded. This can be accomplished by including \", \"the <PageTitle> tag in the component\\u2019s Razor page:\\n\\n@page \\\"/\\\" <PageTitle>Home</PageTitle>\\n\\nThe conte\", \"nts of this element can be dynamic, for instance showing the current count of messages:\\n\\n28\\n\\nCHAPTER\", \" 6 | Build reusable UI components with Blazor\\n\\n<PageTitle>@MessageCount messages</PageTitle>\\n\\nNote t\", \"hat if several components on a particular page include <PageTitle> tags, only the last one will be d\", \"isplayed (since each one will overwrite the previous one).\\n\\nComponent parameters\\n\\nIn ASP.NET Web For\", \"ms, you can flow parameters and data to controls using public properties. These properties can be se\", \"t in markup using attributes or set directly in code. Razor components work in a similar fashion, al\", \"though the component properties must also be marked with the [Parameter] attribute to be considered \", \"component parameters.\\n\\nThe following Counter component defines a component parameter called Incremen\", \"tAmount that can be used to specify the amount that the Counter should be incremented each time the \", \"button is clicked.\\n\\n<h1>Counter</h1>\\n\\n<p>Current count: @currentCount</p>\\n\\n<button class=\\\"btn btn-pr\", \"imary\\\" @onclick=\\\"IncrementCount\\\">Click me</button>\\n\\n@code { int currentCount = 0;\\n\\n[Parameter] publi\", \"c int IncrementAmount { get; set; } = 1;\\n\\nvoid IncrementCount() { currentCount+=IncrementAmount; } }\", \"\\n\\nTo specify a component parameter in Blazor, use an attribute as you would in ASP.NET Web Forms:\\n\\n<\", \"Counter IncrementAmount=\\\"10\\\" />\\n\\nQuery string parameters\\n\\nRazor components can also leverage values \", \"from the query string of the page they\\u2019re rendered on as a parameter source. To enable this, add the\", \" [SupplyParameterFromQuery] attribute to the parameter. For example, the following parameter definit\", \"ion would get its value from the request in the form ?IncBy=2:\\n\\n[Parameter] [SupplyParameterFromQuer\", \"y(Name = \\\"IncBy\\\")] public int IncrementAmount { get; set; } = 1;\\n\\nIf you don\\u2019t supply a custom Name \", \"in the [SupplyParameterFromQuery] attribute, by default it will match the property name (IncrementAm\", \"ount in this case).\\n\\n29\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nComponents and error \", \"boundaries\\n\\nBy default, Blazor apps will detect unhandled exceptions and show an error message at th\", \"e bottom of the page with no additional detail. To constrain the parts of the app that are impacted \", \"by an unhandled error, for instance to limit the impact to a single component, the <ErrorBoundary> t\", \"ag can be wrapped around component declarations.\\n\\nFor example, to protect against possible exception\", \"s thrown from the Counter component, declare it within an <ErrorBoundary> and optionally specify a m\", \"essage to display if there is an exception:\\n\\n<ErrorBoundary> <ChildContent> <Counter /> </ChildConte\", \"nt> <ErrorContent> Oops! The counter isn't working right now; please try again later. </ErrorContent\", \"> </ErrorBoundary> If you don\\u2019t need to specify custom error content, you can just wrap the componen\", \"t directly: <ErrorBoundary> <Counter /> </ErrorBoundary>\\n\\nA default message stating \\u201cAn error as occ\", \"urred.\\u201d will be displayed if an unhandled exception occurs in the wrapped component.\\n\\nEvent handlers\", \"\\n\\nBoth ASP.NET Web Forms and Blazor provide an event-based programming model for handling UI events.\", \" Examples of such events include button clicks and text input. In ASP.NET Web Forms, you use HTML se\", \"rver controls to handle UI events exposed by the DOM, or you can handle events exposed by web server\", \" controls. The events are surfaced on the server through form post-back requests. Consider the follo\", \"wing Web Forms button click example:\\n\\nCounter.ascx\\n\\n<asp:Button ID=\\\"ClickMeButton\\\" runat=\\\"server\\\" Te\", \"xt=\\\"Click me!\\\" OnClick=\\\"ClickMeButton_Click\\\" /> Counter.ascx.cs public partial class Counter : Syste\", \"m.Web.UI.UserControl { protected void ClickMeButton_Click(object sender, EventArgs e) { Console.Writ\", \"eLine(\\\"The button was clicked!\\\"); } }\\n\\nIn Blazor, you can register handlers for DOM UI events direct\", \"ly using directive attributes of the form @on{event}. The {event} placeholder represents the name of\", \" the event. For example, you can listen for button clicks like this:\\n\\n30\\n\\nCHAPTER 6 | Build reusable\", \" UI components with Blazor\\n\\n<button @onclick=\\\"OnClick\\\">Click me!</button>\\n\\n@code { void OnClick() { \", \"Console.WriteLine(\\\"The button was clicked!\\\"); } }\\n\\nEvent handlers can accept an optional, event-spec\", \"ific argument to provide more information about the event. For example, mouse events can take a Mous\", \"eEventArgs argument, but it isn\\u2019t required.\\n\\n<button @onclick=\\\"OnClick\\\">Click me!</button>\\n\\n@code { \", \"void OnClick(MouseEventArgs e) { Console.WriteLine($\\\"Mouse clicked at {e.ScreenX}, {e.ScreenY}.\\\"); }\", \" }\\n\\nInstead of referring to a method group for an event handler, you can use a lambda expression. A \", \"lambda expression allows you to close over other in-scope values.\\n\\n@foreach (var buttonLabel in butt\", \"onLabels) { <button @onclick=\\\"() => Console.WriteLine($\\\"The {buttonLabel} button was clicked!\\\")\\\">@bu\", \"ttonLabel</button> }\\n\\nEvent handlers can execute synchronously or asynchronously. For example, the f\", \"ollowing OnClick event handler executes asynchronously:\\n\\n<button @onclick=\\\"OnClick\\\">Click me!</butto\", \"n>\\n\\n@code { async Task OnClick() { var result = await Http.GetAsync(\\\"api/values\\\"); } }\\n\\nAfter an eve\", \"nt is handled, the component is rendered to account for any component state changes. With asynchrono\", \"us event handlers, the component is rendered immediately after the handler execution completes. The \", \"component is rendered again after the asynchronous Task completes. This asynchronous execution mode \", \"provides an opportunity to render some appropriate UI while the asynchronous Task is still in progre\", \"ss.\\n\\n<button @onclick=\\\"ShowMessage\\\">Get message</button>\\n\\n@if (showMessage) { @if (message == null) \", \"{ <p><em>Loading...</em></p> } else\\n\\n31\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\n{ <p>\", \"The message is: @message</p> } }\\n\\n@code { bool showMessage = false; string message;\\n\\npublic async Ta\", \"sk ShowMessage() { showMessage = true; message = await MessageService.GetMessageAsync(); } }\\n\\nCompon\", \"ents can also define their own events by defining a component parameter of type EventCallback<TValue\", \">. Event callbacks support all the variations of DOM UI event handlers: optional arguments, synchron\", \"ous or asynchronous, method groups, or lambda expressions.\\n\\n<button class=\\\"btn btn-primary\\\" @onclick\", \"=\\\"OnClick\\\">Click me!</button>\\n\\n@code { [Parameter] public EventCallback<MouseEventArgs> OnClick { ge\", \"t; set; } }\\n\\nData binding\\n\\nBlazor provides a simple mechanism to bind data from a UI component to th\", \"e component\\u2019s state. This approach differs from the features in ASP.NET Web Forms for binding data f\", \"rom data sources to UI controls. We\\u2019ll cover handling data from different data sources in the Dealin\", \"g with data section.\\n\\nTo create a two-way data binding from a UI component to the component\\u2019s state,\", \" use the @bind directive attribute. In the following example, the value of the check box is bound to\", \" the isChecked field.\\n\\n<input type=\\\"checkbox\\\" @bind=\\\"isChecked\\\" />\\n\\n@code { bool isChecked; }\\n\\nWhen \", \"the component is rendered, the value of the checkbox is set to the value of the isChecked field. Whe\", \"n the user toggles the checkbox, the onchange event is fired and the isChecked field is set to the n\", \"ew value. The @bind syntax in this case is equivalent to the following markup:\\n\\n<input value=\\\"@isChe\", \"cked\\\" @onchange=\\\"(UIChangeEventArgs e) => isChecked = e.Value\\\" />\\n\\nTo change the event used for the \", \"bind, use the @bind:event attribute.\\n\\n<input @bind=\\\"text\\\" @bind:event=\\\"oninput\\\" /> <p>@text</p>\\n\\n32\\n\", \"\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\n@code { string text; }\\n\\nComponents can also s\", \"upport data binding to their parameters. To data bind, define an event callback parameter with the s\", \"ame name as the bindable parameter. The \\u201cChanged\\u201d suffix is added to the name.\\n\\nPasswordBox.razor\\n\\nP\", \"assword: <input value=\\\"@Password\\\" @oninput=\\\"OnPasswordChanged\\\" type=\\\"@(showPassword ? \\\"text\\\" : \\\"pass\", \"word\\\")\\\" />\\n\\n<label><input type=\\\"checkbox\\\" @bind=\\\"showPassword\\\" />Show password</label>\\n\\n@code { priv\", \"ate bool showPassword;\\n\\n[Parameter] public string Password { get; set; }\\n\\n[Parameter] public EventCa\", \"llback<string> PasswordChanged { get; set; }\\n\\nprivate Task OnPasswordChanged(ChangeEventArgs e) { Pa\", \"ssword = e.Value.ToString(); return PasswordChanged.InvokeAsync(Password); } }\\n\\nTo chain a data bind\", \"ing to an underlying UI element, set the value and handle the event directly on the UI element inste\", \"ad of using the @bind attribute.\\n\\nTo bind to a component parameter, use a @bind-{Parameter} attribut\", \"e to specify the parameter to which you want to bind.\\n\\n<PasswordBox @bind-Password=\\\"password\\\" />\\n\\n@c\", \"ode { string password; }\\n\\nState changes\\n\\nIf the component\\u2019s state has changed outside of a normal UI\", \" event or event callback, then the component must manually signal that it needs to be rendered again\", \". To signal that a component\\u2019s state has changed, call the StateHasChanged method on the component.\\n\", \"\\nIn the example below, a component displays a message from an AppState service that can be updated b\", \"y other parts of the app. The component registers its StateHasChanged method with the AppState.OnCha\", \"nge event so that the component is rendered whenever the message gets updated.\\n\\n33\\n\\nCHAPTER 6 | Buil\", \"d reusable UI components with Blazor\\n\\npublic class AppState { public string Message { get; }\\n\\n// Let\", \"s components receive change notifications public event Action OnChange;\\n\\npublic void UpdateMessage(s\", \"tring message) { Message = message; NotifyStateChanged(); }\\n\\nprivate void NotifyStateChanged() => On\", \"Change?.Invoke(); }\\n\\n@inject AppState AppState\\n\\n<p>App message: @AppState.Message</p>\\n\\n@code { prote\", \"cted override void OnInitialized() { AppState.OnChange += StateHasChanged } }\\n\\nComponent lifecycle\\n\\n\", \"The ASP.NET Web Forms framework has well-defined lifecycle methods for modules, pages, and controls.\", \" For example, the following control implements event handlers for the Init, Load, and UnLoad lifecyc\", \"le events:\\n\\nCounter.ascx.cs\\n\\npublic partial class Counter : System.Web.UI.UserControl { protected vo\", \"id Page_Init(object sender, EventArgs e) { ... } protected void Page_Load(object sender, EventArgs e\", \") { ... } protected void Page_UnLoad(object sender, EventArgs e) { ... } }\\n\\nRazor components also ha\", \"ve a well-defined lifecycle. A component\\u2019s lifecycle can be used to initialize component state and i\", \"mplement advanced component behaviors.\\n\\nAll of Blazor\\u2019s component lifecycle methods have both synchr\", \"onous and asynchronous versions. Component rendering is synchronous. You can\\u2019t run asynchronous logi\", \"c as part of the component rendering. All asynchronous logic must execute as part of an async lifecy\", \"cle method.\\n\\nOnInitialized\\n\\nThe OnInitialized and OnInitializedAsync methods are used to initialize \", \"the component. A component is typically initialized after it\\u2019s first rendered. After a component is \", \"initialized, it may be rendered\\n\\n34\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nmultiple \", \"times before it\\u2019s eventually disposed. The OnInitialized method is similar to the Page_Load event in\", \" ASP.NET Web Forms pages and controls.\\n\\nprotected override void OnInitialized() { ... } protected ov\", \"erride async Task OnInitializedAsync() { await ... }\\n\\nOnParametersSet\\n\\nThe OnParametersSet and OnPar\", \"ametersSetAsync methods are called when a component has received parameters from its parent and the \", \"value are assigned to properties. These methods are executed after component initialization and each\", \" time the component is rendered.\\n\\nprotected override void OnParametersSet() { ... } protected overri\", \"de async Task OnParametersSetAsync() { await ... }\\n\\nOnAfterRender\\n\\nThe OnAfterRender and OnAfterRend\", \"erAsync methods are called after a component has finished rendering. Element and component reference\", \"s are populated at this point (more on these concepts below). Interactivity with the browser is enab\", \"led at this point. Interactions with the DOM and JavaScript execution can safely take place.\\n\\nprotec\", \"ted override void OnAfterRender(bool firstRender) { if (firstRender) { ... } } protected override as\", \"ync Task OnAfterRenderAsync(bool firstRender) { if (firstRender) { await ... } }\\n\\nOnAfterRender and \", \"OnAfterRenderAsync aren\\u2019t called when prerendering on the server.\\n\\nThe firstRender parameter is true\", \" the first time the component is rendered; otherwise, its value is false.\\n\\nIDisposable\\n\\nRazor compon\", \"ents can implement IDisposable to dispose of resources when the component is removed from the UI. A \", \"Razor component can implement IDispose by using the @implements directive:\\n\\n@using System @implement\", \"s IDisposable\\n\\n...\\n\\n@code { public void Dispose()\\n\\n35\\n\\nCHAPTER 6 | Build reusable UI components with\", \" Blazor\\n\\n{ ... } }\\n\\nCapture component references\\n\\nIn ASP.NET Web Forms, it\\u2019s common to manipulate a \", \"control instance directly in code by referring to its ID. In Blazor, it\\u2019s also possible to capture a\", \"nd manipulate a reference to a component, although it\\u2019s much less common.\\n\\nTo capture a component re\", \"ference in Blazor, use the @ref directive attribute. The value of the attribute should match the nam\", \"e of a settable field with the same type as the referenced component.\\n\\n<MyLoginDialog @ref=\\\"loginDia\", \"log\\\" ... />\\n\\n@code { MyLoginDialog loginDialog = default!;\\n\\nvoid OnSomething() { loginDialog.Show();\", \" } }\\n\\nWhen the parent component is rendered, the field is populated with the child component instanc\", \"e. You can then call methods on, or otherwise manipulate, the component instance.\\n\\nManipulating comp\", \"onent state directly using component references isn\\u2019t recommended. Doing so prevents the component f\", \"rom being rendered automatically at the correct times.\\n\\nCapture element references\\n\\nRazor components\", \" can capture references to an element. Unlike HTML server controls in ASP.NET Web Forms, you can\\u2019t m\", \"anipulate the DOM directly using an element reference in Blazor. Blazor handles most DOM interaction\", \"s for you using its DOM diffing algorithm. Captured element references in Blazor are opaque. However\", \", they\\u2019re used to pass a specific element reference in a JavaScript interop call. For more informati\", \"on about JavaScript interop, see ASP.NET Core Blazor JavaScript interop.\\n\\nTemplated components\\n\\nIn A\", \"SP.NET Web Forms, you can create templated controls. Templated controls enable the developer to spec\", \"ify a portion of the HTML used to render a container control. The mechanics of building templated se\", \"rver controls are complex, but they enable powerful scenarios for rendering data in a user customiza\", \"ble way. Examples of templated controls include Repeater and DataList.\\n\\nRazor components can also be\", \" templated by defining component parameters of type RenderFragment or RenderFragment<T>. A RenderFra\", \"gment represents a chunk of Razor markup\\n\\n36\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\n\", \"that can then be rendered by the component. A RenderFragment<T> is a chunk of Razor markup that take\", \"s a parameter that can be specified when the render fragment is rendered.\\n\\nChild content\\n\\nRazor comp\", \"onents can capture their child content as a RenderFragment and render that content as part of the co\", \"mponent rendering. To capture child content, define a component parameter of type RenderFragment and\", \" name it ChildContent.\\n\\nChildContentComponent.razor\\n\\n<h1>Component with child content</h1>\\n\\n<div>@Ch\", \"ildContent</div>\\n\\n@code { [Parameter] public RenderFragment ChildContent { get; set; } } A parent co\", \"mponent can then supply child content using normal Razor syntax. <ChildContentComponent> <ChildConte\", \"nt> <p>The time is @DateTime.Now</p> </ChildContent> </ChildContentComponent>\\n\\nTemplate parameters\\n\\n\", \"A templated Razor component can also define multiple component parameters of type RenderFragment or \", \"RenderFragment<T>. The parameter for a RenderFragment<T> can be specified when it\\u2019s invoked. To spec\", \"ify a generic type parameter for a component, use the @typeparam Razor directive.\\n\\nSimpleListView.ra\", \"zor\\n\\n@typeparam TItem\\n\\n@Heading\\n\\n<ul> @foreach (var item in Items) { <li>@ItemTemplate(item)</li> } \", \"</ul>\\n\\n@code { [Parameter] public RenderFragment Heading { get; set; }\\n\\n[Parameter] public RenderFra\", \"gment<TItem> ItemTemplate { get; set; }\\n\\n[Parameter] public IEnumerable<TItem> Items { get; set; } }\", \"\\n\\n37\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nWhen using a templated component, the te\", \"mplate parameters can be specified using child elements that match the names of the parameters. Comp\", \"onent arguments of type RenderFragment<T> passed as elements have an implicit parameter named contex\", \"t. You can change the name of this implement parameter using the Context attribute on the child elem\", \"ent. Any generic type parameters can be specified using an attribute that matches the name of the ty\", \"pe parameter. The type parameter will be inferred if possible:\\n\\n<SimpleListView Items=\\\"messages\\\" TIt\", \"em=\\\"string\\\"> <Heading> <h1>My list</h1> </Heading> <ItemTemplate Context=\\\"message\\\"> <p>The message i\", \"s: @message</p> </ItemTemplate> </SimpleListView> The output of this component looks like this: <h1>\", \"My list</h1> <ul> <li><p>The message is: message1</p></li> <li><p>The message is: message2</p></li> \", \"<ul>\\n\\nCode-behind\\n\\nA Razor component is typically authored in a single .razor file. However, it\\u2019s al\", \"so possible to separate the code and markup using a code-behind file. To use a component file, add a\", \" C# file that matches the file name of the component file but with a .cs extension added (Counter.ra\", \"zor.cs). Use the C# file to define a base class for the component. You can name the base class anyth\", \"ing you\\u2019d like, but it\\u2019s common to name the class the same as the component class, but with a Base e\", \"xtension added (CounterBase). The component-based class must also derive from ComponentBase. Then, i\", \"n the Razor component file, add the @inherits directive to specify the base class for the component \", \"(@inherits CounterBase).\\n\\nCounter.razor\\n\\n@inherits CounterBase\\n\\n<h1>Counter</h1>\\n\\n<p>Current count: \", \"@currentCount</p>\\n\\n<button @onclick=\\\"IncrementCount\\\">Click me</button> Counter.razor.cs public class\", \" CounterBase : ComponentBase { protected int currentCount = 0;\\n\\nprotected void IncrementCount() { cu\", \"rrentCount++; } }\\n\\n38\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nThe visibility of the c\", \"omponent\\u2019s members in the base class must be protected or public to be visible to the component clas\", \"s.\\n\\nAdditional resources\\n\\nThe preceding isn\\u2019t an exhaustive treatment of all aspects of Razor compon\", \"ents. For more information on how to Create and use ASP.NET Core Razor components, see the Blazor do\", \"cumentation.\\n\\n39\\n\\nCHAPTER 6 | Build reusable UI components with Blazor\\n\\nCHAPTER 7\\n\\nPages, routing, a\", \"nd layouts\\n\\nASP.NET Web Forms apps are composed of pages defined in .aspx files. Each page\\u2019s address\", \" is based on its physical file path in the project. When a browser makes a request to the page, the \", \"contents of the page are dynamically rendered on the server. The rendering accounts for both the pag\", \"e\\u2019s HTML markup and its server controls.\\n\\nIn Blazor, each page in the app is a component, typically \", \"defined in a .razor file, with one or more specified routes. Routing mostly happens client-side with\", \"out involving a specific server request. The browser first makes a request to the root address of th\", \"e app. A root Router component in the Blazor app then handles intercepting navigation requests and f\", \"orwards them to the correct component.\\n\\nBlazor also supports deep linking. Deep linking occurs when \", \"the browser makes a request to a specific route other than the root of the app. Requests for deep li\", \"nks sent to the server are routed to the Blazor app, which then routes the request client-side to th\", \"e correct component.\\n\\nA simple page in ASP.NET Web Forms might contain the following markup:\\n\\nName.a\", \"spx\\n\\n<%@ Page Title=\\\"Name\\\" Language=\\\"C#\\\" MasterPageFile=\\\"~/Site.Master\\\" AutoEventWireup=\\\"true\\\" CodeB\", \"ehind=\\\"Name.aspx.cs\\\" Inherits=\\\"WebApplication1.Name\\\" %>\\n\\n<asp:Content ID=\\\"BodyContent\\\" ContentPlaceH\", \"olderID=\\\"MainContent\\\" runat=\\\"server\\\"> <div> What is your name?<br /> <asp:TextBox ID=\\\"TextBox1\\\" runa\", \"t=\\\"server\\\"></asp:TextBox> <asp:Button ID=\\\"Button1\\\" runat=\\\"server\\\" Text=\\\"Submit\\\" OnClick=\\\"Button1_Cli\", \"ck\\\" /> </div> <div> <asp:Literal ID=\\\"Literal1\\\" runat=\\\"server\\\" /> </div> </asp:Content>\\n\\nName.aspx.cs\", \"\\n\\npublic partial class Name : System.Web.UI.Page { protected void Button1_Click1(object sender, Even\", \"tArgs e) { Literal1.Text = \\\"Hello \\\" + TextBox1.Text; } }\\n\\n40\\n\\nCHAPTER 7 | Pages, routing, and layout\", \"s\\n\\nThe equivalent page in a Blazor app would look like this:\\n\\nName.razor\\n\\n@page \\\"/Name\\\" @layout Main\", \"Layout\\n\\n<div> What is your name?<br /> <input @bind=\\\"text\\\" /> <button @onclick=\\\"OnClick\\\">Submit</but\", \"ton> </div> <div> @if (name != null) { @:Hello @name } </div>\\n\\n@code { string text; string name;\\n\\nvo\", \"id OnClick() { name = text; } }\\n\\nCreate pages\\n\\nTo create a page in Blazor, create a component and ad\", \"d the @page Razor directive to specify the route for the component. The @page directive takes a sing\", \"le parameter, which is the route template to add to that component.\\n\\n@page \\\"/counter\\\"\\n\\nThe route tem\", \"plate parameter is required. Unlike ASP.NET Web Forms, the route to a Blazor component isn\\u2019t inferre\", \"d from its file location (although that may be a feature added in the future).\\n\\nThe route template s\", \"yntax is the same basic syntax used for routing in ASP.NET Web Forms. Route parameters are specified\", \" in the template using braces. Blazor will bind route values to component parameters with the same n\", \"ame (case-insensitive).\\n\\n@page \\\"/product/{id}\\\"\\n\\n<h1>Product @Id</h1>\\n\\n@code { [Parameter] public str\", \"ing Id { get; set; } }\\n\\nYou can also specify constraints on the value of the route parameter. For ex\", \"ample, to constrain the product ID to be an int:\\n\\n41\\n\\nCHAPTER 7 | Pages, routing, and layouts\\n\\n@page\", \" \\\"/product/{id:int}\\\"\\n\\n<h1>Product @Id</h1>\\n\\n@code { [Parameter] public int Id { get; set; } }\\n\\nFor a\", \" full list of the route constraints supported by Blazor, see Route constraints.\\n\\nRouter component\\n\\nR\", \"outing in Blazor is handled by the Router component. The Router component is typically used in the a\", \"pp\\u2019s root component (App.razor).\\n\\n<Router AppAssembly=\\\"@typeof(Program).Assembly\\\"> <Found Context=\\\"r\", \"outeData\\\"> <RouteView RouteData=\\\"@routeData\\\" DefaultLayout=\\\"@typeof(MainLayout)\\\" /> </Found> <NotFou\", \"nd> <LayoutView Layout=\\\"@typeof(MainLayout)\\\"> <p>Sorry, there's nothing at this address.</p> </Layou\", \"tView> </NotFound> </Router>\\n\\nThe Router component discovers the routable components in the specifie\", \"d AppAssembly and in the optionally specified AdditionalAssemblies. When the browser navigates, the \", \"Router intercepts the navigation and renders the contents of its Found parameter with the extracted \", \"RouteData if a route matches the address, otherwise the Router renders its NotFound parameter.\\n\\nThe \", \"RouteView component handles rendering the matched component specified by the RouteData with its layo\", \"ut if it has one. If the matched component doesn\\u2019t have a layout, then the optionally specified Defa\", \"ultLayout is used.\\n\\nThe LayoutView component renders its child content within the specified layout. \", \"We\\u2019ll look at layouts more in detail later in this chapter.\\n\\nNavigation\\n\\nIn ASP.NET Web Forms, you t\", \"rigger navigation to a different page by returning a redirect response to the browser. For example:\\n\", \"\\nprotected void NavigateButton_Click(object sender, EventArgs e) { Response.Redirect(\\\"Counter\\\"); }\\n\\n\", \"Returning a redirect response isn\\u2019t typically possible in Blazor. Blazor doesn\\u2019t use a request-reply\", \" model. You can, however, trigger browser navigations directly, as you can with JavaScript.\\n\\n42\\n\\nCHA\", \"PTER 7 | Pages, routing, and layouts\\n\\nBlazor provides a NavigationManager service that can be used t\", \"o:\\n\\n\\n\\nGet the current browser address\\n\\n\\n\\nGet the base address\\n\\n\\n\\nTrigger navigations\\n\\n\\n\\nGet notified\", \" when the address changes\\n\\nTo navigate to a different address, use the NavigateTo method:\\n\\n@page \\\"/\\\"\", \" @inject NavigationManager NavigationManager\\n\\n<button @onclick=\\\"Navigate\\\">Navigate</button>\\n\\n@code {\", \" void Navigate() { NavigationManager.NavigateTo(\\\"counter\\\"); } }\\n\\nFor a description of all Navigation\", \"Manager members, see URI and navigation state helpers.\\n\\nBase URLs\\n\\nIf your Blazor app is deployed un\", \"der a base path, then you need to specify the base URL in the page metadata using the <base> tag for\", \" routing to work property. If the host page for the app is server- rendered using Razor, then you ca\", \"n use the ~/ syntax to specify the app\\u2019s base address. If the host page is static HTML, then you nee\", \"d to specify the base URL explicitly.\\n\\n<base href=\\\"~/\\\" />\\n\\nPage layout\\n\\nPage layout in ASP.NET Web F\", \"orms is handled by Master Pages. Master Pages define a template with one or more content placeholder\", \"s that can then be supplied by individual pages. Master Pages are defined in .master files and start\", \" with the <%@ Master %> directive. The content of the .master files is coded as you would an .aspx p\", \"age, but with the addition of <asp:ContentPlaceHolder> controls to mark where pages can supply conte\", \"nt.\\n\\nSite.master\\n\\n<%@ Master Language=\\\"C#\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Site.master.cs\\\" Inheri\", \"ts=\\\"WebApplication1.SiteMaster\\\" %>\\n\\n<!DOCTYPE html> <html lang=\\\"en\\\"> <head runat=\\\"server\\\"> <meta cha\", \"rset=\\\"utf-8\\\" /> <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" /> <title><%: \", \"Page.Title %> - My ASP.NET Application</title> <link href=\\\"~/favicon.ico\\\" rel=\\\"shortcut icon\\\" type=\\\"\", \"image/x-icon\\\" /> </head>\\n\\n43\\n\\nCHAPTER 7 | Pages, routing, and layouts\\n\\n<body> <form runat=\\\"server\\\"> \", \"<div class=\\\"container body-content\\\"> <asp:ContentPlaceHolder ID=\\\"MainContent\\\" runat=\\\"server\\\"> </asp:\", \"ContentPlaceHolder> <hr /> <footer> <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application</p> \", \"</footer> </div> </form> </body> </html>\\n\\nIn Blazor, you handle page layout using layout components.\", \" Layout components inherit from LayoutComponentBase, which defines a single Body property of type Re\", \"nderFragment, which can be used to render the contents of the page.\\n\\nMainLayout.razor\\n\\n@inherits Lay\", \"outComponentBase <h1>Main layout</h1> <div> @Body </div>\\n\\nWhen the page with a layout is rendered, t\", \"he page is rendered within the contents of the specified layout at the location where the layout ren\", \"ders its Body property.\\n\\nTo apply a layout to a page, use the @layout directive:\\n\\n@layout MainLayout\", \"\\n\\nYou can specify the layout for all components in a folder and subfolders using an *_Imports.razor*\", \" file. You can also specify a default layout for all your pages using the Router component.\\n\\nMaster \", \"Pages can define multiple content placeholders, but layouts in Blazor only have a single Body proper\", \"ty. This limitation of Blazor layout components will hopefully be addressed in a future release.\\n\\nMa\", \"ster Pages in ASP.NET Web Forms can be nested. That is, a Master Page may also use a Master Page. La\", \"yout components in Blazor may be nested too. You can apply a layout component to a layout component.\", \" The contents of the inner layout will be rendered within the outer layout.\\n\\nChildLayout.razor\\n\\n@lay\", \"out MainLayout <h2>Child layout</h2> <div> @Body </div>\\n\\nIndex.razor\\n\\n@page \\\"/\\\" @layout ChildLayout \", \"<p>I'm in a nested layout!</p>\\n\\nThe rendered output for the page would then be:\\n\\n44\\n\\nCHAPTER 7 | Pag\", \"es, routing, and layouts\\n\\n<h1>Main layout</h1> <div> <h2>Child layout</h2> <div> <p>I'm in a nested \", \"layout!</p> </div> </div>\\n\\nLayouts in Blazor don\\u2019t typically define the root HTML elements for a pag\", \"e (<html>, <body>, <head>, and so on). The root HTML elements are instead defined in a Blazor app\\u2019s \", \"host page, which is used to render the initial HTML content for the app (see Bootstrap Blazor). The \", \"host page can render multiple root components for the app with surrounding markup.\\n\\nComponents in Bl\", \"azor, including pages, can\\u2019t render <script> tags. This rendering restriction exists because <script\", \"> tags get loaded once and then can\\u2019t be changed. Unexpected behavior may occur if you try to render\", \" the tags dynamically using Razor syntax. Instead, all <script> tags should be added to the app\\u2019s ho\", \"st page.\\n\\n45\\n\\nCHAPTER 7 | Pages, routing, and layouts\\n\\nCHAPTER 8\\n\\nState management\\n\\nState management\", \" is a key concept of Web Forms applications, facilitated through ViewState, Session State, Applicati\", \"on State, and Postback features. These stateful features of the framework helped to hide the state m\", \"anagement required for an application and allow application developers to focus on delivering their \", \"functionality. With ASP.NET Core and Blazor, some of these features have been relocated and some hav\", \"e been removed altogether. This chapter reviews how to maintain state and deliver the same functiona\", \"lity with the new features in Blazor.\\n\\nRequest state management with ViewState\\n\\nWhen discussing stat\", \"e management in Web Forms application, many developers will immediately think of ViewState. In Web F\", \"orms, ViewState manages the state of the content between HTTP requests by sending a large encoded bl\", \"ock of text back and forth to the browser. The ViewState field could be overwhelmed with content fro\", \"m a page containing many elements, potentially expanding to several megabytes in size.\\n\\nWith Blazor \", \"Server, the app maintains an ongoing connection with the server. The app\\u2019s state, called a circuit, \", \"is held in server memory while the connection is considered active. State will only be disposed when\", \" the user navigates away from the app or a particular page in the app. All members of the active com\", \"ponents are available between interactions with the server.\\n\\nThere are several advantages of this fe\", \"ature:\\n\\n\\n\\nComponent state is readily available and not rebuilt between interactions.\\n\\n\\n\\nState isn\\u2019t \", \"transmitted to the browser.\\n\\nHowever, there are some disadvantages to in-memory component state pers\", \"istence to be aware of:\\n\\n\\n\\nIf the server restarts between request, state is lost.\\n\\n\\n\\nYour applicatio\", \"n web server load-balancing solution must include sticky sessions to ensure that all requests from t\", \"he same browser return to the same server. If a request goes to a different server, state will be lo\", \"st.\\n\\n\\n\\nPersistence of component state on the server can lead to memory pressure on the web server.\\n\\n\", \"For the preceding reasons, don\\u2019t rely on just the state of the component to reside in-memory on the \", \"server. Your application should also include some backing data store for data between requests. Some\", \" simple examples of this strategy:\\n\\n\\n\\nIn a shopping cart application, persist the content of new ite\", \"ms added to the cart in a database record. If the state on the server is lost, you can reconstitute \", \"it from the database records.\\n\\n46\\n\\nCHAPTER 8 | State management\\n\\n\\n\\nIn a multi-part web form, your us\", \"ers will expect your application to remember values between each request. Write the data between eac\", \"h of your user\\u2019s posts to a data store so that they can be fetched and assembled into the final form\", \" response structure when the multi-part form is completed.\\n\\nFor additional details on managing state\", \" in Blazor apps, see ASP.NET Core Blazor state management.\\n\\nMaintain state with Session\\n\\nWeb Forms d\", \"evelopers could maintain information about the currently acting user with the Microsoft.AspNetCore.H\", \"ttp.ISession dictionary object. It\\u2019s easy enough to add an object with a string key to the Session, \", \"and that object would be available at a later time during the user\\u2019s interactions with the applicati\", \"on. In an attempt to eliminate managing interacting with HTTP, the Session object made it easy to ma\", \"intain state.\\n\\nThe signature of the .NET Framework Session object isn\\u2019t the same as the ASP.NET Core\", \" Session object. Consider the documentation for the new ASP.NET Core Session before deciding to migr\", \"ate and use the new session state feature.\\n\\nSession is available in ASP.NET Core and Blazor Server, \", \"but is discouraged from use in favor of storing data in a data repository appropriately. Session sta\", \"te is also not functional if visitors decline the use HTTP cookies in your application due to privac\", \"y concerns.\\n\\nConfiguration for ASP.NET Core and Session state is available in the Session and state \", \"management in ASP.NET Core article.\\n\\nApplication state\\n\\nThe Application object in the Web Forms fram\", \"ework provides a massive, cross-request repository for interacting with application-scope configurat\", \"ion and state. Application state was an ideal place to store various application configuration prope\", \"rties that would be referenced by all requests, regardless of the user making the request. The probl\", \"em with the Application object was that data didn\\u2019t persist across multiple servers. The state of th\", \"e application object was lost between restarts.\\n\\nAs with Session, it\\u2019s recommended that data move to\", \" a persistent backing store that could be accessed by multiple server instances. If there is volatil\", \"e data that you would like to be able to access across requests and users, you could easily store it\", \" in a singleton service that can be injected into components that require this information or intera\", \"ction.\\n\\nThe construction of an object to maintain application state and its consumption could resemb\", \"le the following implementation:\\n\\npublic class MyApplicationState { public int VisitorCounter { get;\", \" private set; } = 0;\\n\\npublic void IncrementCounter() => VisitorCounter += 1; }\\n\\n47\\n\\nCHAPTER 8 | Stat\", \"e management\\n\\napp.AddSingleton<MyApplicationState>();\\n\\n@inject MyApplicationState AppState\\n\\n<label>T\", \"otal Visitors: @AppState.VisitorCounter</label>\\n\\nThe MyApplicationState object is created only once \", \"on the server, and the value VisitorCounter is fetched and output in the component\\u2019s label. The Visi\", \"torCounter value should be persisted and retrieved from a backing data store for durability and scal\", \"ability.\\n\\nIn the browser\\n\\nApplication data can also be stored client-side on the user\\u2019s device so th\", \"at is available later. There are two browser features that allow for persistence of data in differen\", \"t scopes of the user\\u2019s browser:\\n\\n\\n\\nlocalStorage - scoped to the user\\u2019s entire browser. If the page i\", \"s reloaded, the browser is closed and reopened, or another tab is opened with the same URL then the \", \"same localStorage is provided by the browser\\n\\n\\n\\nsessionStorage - scoped to the user\\u2019s current browse\", \"r tab. If the tab is reloaded, the state persists. However, if the user opens another tab to your ap\", \"plication or closes and reopens the browser the state is lost.\\n\\nYou can write some custom JavaScript\", \" code to interact with these features, or there are a number of NuGet packages that you can use that\", \" provide this functionality. One such package is Microsoft.AspNetCore.ProtectedBrowserStorage.\\n\\nFor \", \"instructions on utilizing this package to interact with localStorage and sessionStorage, see the Bla\", \"zor State Management article.\\n\\n48\\n\\nCHAPTER 8 | State management\\n\\nCHAPTER 9\\n\\nForms and validation\\n\\nTh\", \"e ASP.NET Web Forms framework includes a set of validation server controls that handle validating us\", \"er input entered into a form (RequiredFieldValidator, CompareValidator, RangeValidator, and so on). \", \"The ASP.NET Web Forms framework also supports model binding and validating the model based on data a\", \"nnotations ([Required], [StringLength], [Range], and so on). The validation logic can be enforced bo\", \"th on the server and on the client using unobtrusive JavaScript-based validation. The ValidationSumm\", \"ary server control is used to display a summary of the validation errors to the user.\\n\\nBlazor suppor\", \"ts the sharing of validation logic between both the client and the server. ASP.NET provides pre-buil\", \"t JavaScript implementations of many common server validations. In many cases, the developer still h\", \"as to write JavaScript to fully implement their app-specific validation logic. The same model types,\", \" data annotations, and validation logic can be used on both the server and client.\\n\\nBlazor provides \", \"a set of input components. The input components handle binding field data to a model and validating \", \"the user input when the form is submitted.\\n\\nInput component\\n\\nRendered HTML element\\n\\nInputCheckbox\\n\\n<\", \"input type=\\\"checkbox\\\">\\n\\nInputDate\\n\\n<input type=\\\"date\\\">\\n\\nInputNumber\\n\\n<input type=\\\"number\\\">\\n\\nInputSel\", \"ect\\n\\n<select>\\n\\nInputText\\n\\n<input>\\n\\nInputTextArea\\n\\n<textarea>\\n\\nThe EditForm component wraps these inp\", \"ut components and orchestrates the validation process through an EditContext. When creating an EditF\", \"orm, you specify what model instance to bind to using the Model parameter. Validation is typically d\", \"one using data annotations, and it\\u2019s extensible. To enable data annotation-based validation, add the\", \" DataAnnotationsValidator component as a child of the EditForm. The EditForm component provides a co\", \"nvenient event for handling valid (OnValidSubmit) and invalid (OnInvalidSubmit) submissions. There\\u2019s\", \" also a more generic OnSubmit event that lets you trigger and handle the validation yourself.\\n\\nTo di\", \"splay a validation error summary, use the ValidationSummary component. To display validation message\", \"s for a specific input field, use the ValidationMessage component, specifying a lambda expression fo\", \"r the For parameter that points to the appropriate model member.\\n\\nThe following model type defines s\", \"everal validation rules using data annotations:\\n\\n49\\n\\nCHAPTER 9 | Forms and validation\\n\\nusing System;\", \" using System.ComponentModel.DataAnnotations;\\n\\npublic class Starship { [Required] [StringLength(16, \", \"ErrorMessage = \\\"Identifier too long (16 character limit).\\\")] public string Identifier { get; set; }\\n\", \"\\npublic string Description { get; set; }\\n\\n[Required] public string Classification { get; set; }\\n\\n[Ra\", \"nge(1, 100000, ErrorMessage = \\\"Accommodation invalid (1-100000).\\\")] public int MaximumAccommodation \", \"{ get; set; }\\n\\n[Required] [Range(typeof(bool), \\\"true\\\", \\\"true\\\", ErrorMessage = \\\"This form disallows u\", \"napproved ships.\\\")] public bool IsValidatedDesign { get; set; }\\n\\n[Required] public DateTime Producti\", \"onDate { get; set; } }\\n\\nThe following component demonstrates building a form in Blazor based on the \", \"Starship model type:\\n\\n<h1>New Ship Entry Form</h1>\\n\\n<EditForm Model=\\\"@starship\\\" OnValidSubmit=\\\"@Hand\", \"leValidSubmit\\\"> <DataAnnotationsValidator /> <ValidationSummary />\\n\\n<p> <label for=\\\"identifier\\\">Iden\", \"tifier: </label> <InputText id=\\\"identifier\\\" @bind-Value=\\\"starship.Identifier\\\" /> <ValidationMessage \", \"For=\\\"() => starship.Identifier\\\" /> </p> <p> <label for=\\\"description\\\">Description (optional): </label\", \"> <InputTextArea id=\\\"description\\\" @bind-Value=\\\"starship.Description\\\" /> </p> <p> <label for=\\\"classif\", \"ication\\\">Primary Classification: </label> <InputSelect id=\\\"classification\\\" @bind-Value=\\\"starship.Cla\", \"ssification\\\"> <option value=\\\"\\\">Select classification ...</option> <option value=\\\"Exploration\\\">Explor\", \"ation</option> <option value=\\\"Diplomacy\\\">Diplomacy</option> <option value=\\\"Defense\\\">Defense</option>\", \" </InputSelect> <ValidationMessage For=\\\"() => starship.Classification\\\" /> </p> <p> <label for=\\\"accom\", \"modation\\\">Maximum Accommodation: </label> <InputNumber id=\\\"accommodation\\\" @bind-Value=\\\"starship.Maxi\", \"mumAccommodation\\\" /> <ValidationMessage For=\\\"() => starship.MaximumAccommodation\\\" /> </p>\\n\\n50\\n\\nCHAPT\", \"ER 9 | Forms and validation\\n\\n<p> <label for=\\\"valid\\\">Engineering Approval: </label> <InputCheckbox id\", \"=\\\"valid\\\" @bind-Value=\\\"starship.IsValidatedDesign\\\" /> <ValidationMessage For=\\\"() => starship.IsValida\", \"tedDesign\\\" /> </p> <p> <label for=\\\"productionDate\\\">Production Date: </label> <InputDate id=\\\"producti\", \"onDate\\\" @bind-Value=\\\"starship.ProductionDate\\\" /> <ValidationMessage For=\\\"() => starship.ProductionDa\", \"te\\\" /> </p>\\n\\n<button type=\\\"submit\\\">Submit</button> </EditForm>\\n\\n@code { private Starship starship = \", \"new Starship();\\n\\nprivate void HandleValidSubmit() { // Save the data } }\\n\\nAfter the form submission,\", \" the model-bound data hasn\\u2019t been saved to any data store, like a database. In a Blazor WebAssembly \", \"app, the data must be sent to the server. For example, using an HTTP POST request. In a Blazor Serve\", \"r app, the data is already on the server, but it must be persisted. Handling data access in Blazor a\", \"pps is the subject of the Dealing with data section.\\n\\nAdditional resources\\n\\nFor more information on \", \"forms and validation in Blazor apps, see the Blazor documentation.\\n\\n51\\n\\nCHAPTER 9 | Forms and valida\", \"tion\\n\\nCHAPTER 10\\n\\nWork with data\\n\\nData access is the backbone of an ASP.NET Web Forms app. If you\\u2019re\", \" building forms for the web, what happens to that data? With Web Forms, there were multiple data acc\", \"ess techniques you could use to interact with a database:\\n\\n\\n\\nData Sources\\n\\n\\n\\nADO.NET\\n\\n\\n\\nEntity Frame\", \"work\\n\\nData Sources were controls that you could place on a Web Forms page and configure like other c\", \"ontrols. Visual Studio provided a friendly set of dialogs to configure and bind the controls to your\", \" Web Forms pages. Developers who enjoy a \\u201clow code\\u201d or \\u201cno code\\u201d approach preferred this technique w\", \"hen Web Forms was first released.\\n\\nADO.NET is the low-level approach to interacting with a database.\", \" Your apps could create a connection to the database with Commands, Datatables, and Datasets for int\", \"eracting. The results could then be bound to fields on screen without much code. The drawback of thi\", \"s approach was that each set of ADO.NET objects (Connection, Command, and DataTable) was bound to li\", \"braries provided by a database vendor. Use of these components made the code rigid and difficult to \", \"migrate to a different database.\\n\\nEntity Framework\\n\\nEntity Framework (EF) is the open source object-\", \"relational mapping framework maintained by the .NET Foundation. Initially released with .NET Framewo\", \"rk, EF allows for generating code for the database connections, storage schemas, and interactions. W\", \"ith this abstraction, you can focus on your\\n\\n52\\n\\nCHAPTER 10 | Work with data\\n\\napp\\u2019s business rules a\", \"nd allow the database to be managed by a trusted database administrator. In .NET, you can use an upd\", \"ated version of EF called EF Core. EF Core helps generate and maintain the interactions between your\", \" code and the database with a series of commands that are available for you using the dotnet ef comm\", \"and-line tool. Let\\u2019s take a look at a few samples to get you working with a database.\\n\\nEF Code First\", \"\\n\\nA quick way to get started building your database interactions is to start with the class objects \", \"you want to work with. EF provides a tool to help generate the appropriate database code for your cl\", \"asses. This approach is called \\u201cCode First\\u201d development. Consider the following Product class for a \", \"sample storefront app that we want to store in a relational database like Microsoft SQL Server.\\n\\npub\", \"lic class Product { public int Id { get; set; }\\n\\n[Required] public string Name { get; set; }\\n\\n[MaxLe\", \"ngth(4000)] public string Description { get; set; }\\n\\n[Range(0, 99999,99)] [DataType(DataType.Currenc\", \"y)] public decimal Price { get; set; } }\\n\\nProduct has a primary key and three additional fields that\", \" would be created in our database:\\n\\n\\n\\nEF will identify the Id property as a primary key by conventio\", \"n.\\n\\n\\n\\nName will be stored in a column configured for text storage. The [Required] attribute decorati\", \"ng this property will add a not null constraint to help enforce this declared behavior of the proper\", \"ty.\\n\\n\\n\\nDescription will be stored in a column configured for text storage, and have a maximum length\", \" configured of 4000 characters as dictated by the [MaxLength] attribute. The database schema will be\", \" configured with a column named MaxLength using data type varchar(4000).\\n\\n\\n\\nThe Price property will \", \"be stored as currency. The [Range] attribute will generate appropriate constraints to prevent data s\", \"torage outside of the minimum and maximum values declared.\\n\\nWe need to add this Product class to a d\", \"atabase context class that defines the connection and translation operations with our database.\\n\\npub\", \"lic class MyDbContext : DbContext { public DbSet<Product> Products { get; set; } }\\n\\nThe MyDbContext \", \"class provides the one property that defines the access and translation for the Product class. Your \", \"application configures this class for interaction with the database using the following entries in t\", \"he Startup class\\u2019s ConfigureServices method (or appropriate location in Program.cs using the builder\", \".Services property instead of services):\\n\\n53\\n\\nCHAPTER 10 | Work with data\\n\\nservices.AddDbContext<MyD\", \"bContext>(options => options.UseSqlServer(\\\"MY DATABASE CONNECTION STRING\\\"));\\n\\nThe preceding code wil\", \"l connect to a SQL Server database with the specified connection string. You can place the connectio\", \"n string in your appsettings.json file, environment variables, or other configuration storage locati\", \"ons and replace this embedded string appropriately.\\n\\nYou can then generate the database table approp\", \"riate for this class using the following commands:\\n\\ndotnet ef migrations add 'Create Product table' \", \"dotnet ef database update\\n\\nThe first command defines the changes you\\u2019re making to the database schem\", \"a as a new EF Migration called Create Product table. A Migration defines how to apply and remove you\", \"r new database changes.\\n\\nOnce applied, you have a simple Product table in your database and some new\", \" classes added to the project that help manage the database schema. You can find these generated cla\", \"sses, by default, in a new folder called Migrations. When you make changes to the Product class or a\", \"dd more related classes you would like interacting with your database, you need to run the command-l\", \"ine commands again with a new name of the migration. This command will generate another set of migra\", \"tion classes to update your database schema.\\n\\nEF Database First\\n\\nFor existing databases, you can gen\", \"erate the classes for EF Core by using the .NET command-line tools. To scaffold the classes, use a v\", \"ariation of the following command:\\n\\ndotnet ef dbcontext scaffold \\\"CONNECTION STRING\\\" Microsoft.Entit\", \"yFrameworkCore.SqlServer -c MyDbContext -t Product -t Customer\\n\\nThe preceding command connects to th\", \"e database using the specified connection string and the Microsoft.EntityFrameworkCore.SqlServer pro\", \"vider. Once connected, a database context class named MyDbContext is created. Additionally, supporti\", \"ng classes are created for the Product and Customer tables that were specified with the -t options. \", \"There are many configuration options for this command to generate the class hierarchy appropriate fo\", \"r your database. For a complete reference, see the command\\u2019s documentation.\\n\\nMore information about \", \"EF Core can be found on the Microsoft Docs site.\\n\\nInteract with web services\\n\\nWhen ASP.NET was first\", \" released, SOAP services were the preferred way for web servers and clients to exchange data. Much h\", \"as changed since that time, and the preferred interactions with services have shifted to direct HTTP\", \" client interactions. With ASP.NET Core and Blazor, you can register the configuration of your HttpC\", \"lient in Program.cs or in the Startup class\\u2019s ConfigureServices method. Use that configuration when \", \"you need to interact with the HTTP endpoint. Consider the following configuration code:\\n\\n54\\n\\nCHAPTER\", \" 10 | Work with data\\n\\n// in Program.cs builder.Services.AddHttpClient(\\\"github\\\", client => { client.B\", \"aseAddress = new Uri(\\\"http://api.github.com/\\\"); // Github API versioning client.DefaultRequestHeader\", \"s.Add(\\\"Accept\\\", \\\"application/vnd.github.v3+json\\\"); // Github requires a user-agent client.DefaultReq\", \"uestHeaders.Add(\\\"User-Agent\\\", \\\"BlazorWebForms-Sample\\\"); });\\n\\nWhenever you need to access data from G\", \"itHub, create a client with a name of github. The client is configured with the base address, and th\", \"e request headers are set appropriately. Inject the IHttpClientFactory into your Blazor components w\", \"ith the @inject directive or an [Inject] attribute on a property. Create your named client and inter\", \"act with services using the following syntax:\\n\\n@inject IHttpClientFactory factory\\n\\n...\\n\\n@code { prot\", \"ected override async Task OnInitializedAsync() { var client = factory.CreateClient(\\\"github\\\"); var re\", \"sponse = await client.GetAsync(\\\"repos/dotnet/docs/issues\\\"); response.EnsureStatusCode(); var content\", \" = await response.Content.ReadAsStringAsync(); } }\\n\\nThis method returns the string describing the co\", \"llection of issues in the dotnet/docs GitHub repository. It returns content in JSON format and is de\", \"serialized into appropriate GitHub issue objects. There are many ways that you can configure the Htt\", \"pClientFactory to deliver preconfigured HttpClient objects. Try configuring multiple HttpClient inst\", \"ances with different names and endpoints for the various web services you work with. This approach w\", \"ill make your interactions with those services easier to work with on each page. For more informatio\", \"n, see Make HTTP requests using IHttpClientFactory.\\n\\n55\\n\\nCHAPTER 10 | Work with data\\n\\nCHAPTER 11\\n\\nMo\", \"dules, handlers, and middleware\\n\\nAn ASP.NET Core app is built upon a series of middleware. Middlewar\", \"e is handlers that are arranged into a pipeline to handle requests and responses. In a Web Forms app\", \", HTTP handlers and modules solve similar problems. In ASP.NET Core, modules, handlers, Global.asax.\", \"cs, and the app life cycle are replaced with middleware. In this chapter, you\\u2019ll learn about middlew\", \"are in the context of a Blazor app.\\n\\nOverview\\n\\nThe ASP.NET Core request pipeline consists of a seque\", \"nce of request delegates, called one after the other. The following diagram demonstrates the concept\", \". The thread of execution follows the black arrows.\\n\\n56\\n\\nCHAPTER 11 | Modules, handlers, and middlew\", \"are\\n\\nThe preceding diagram lacks a concept of lifecycle events. This concept is foundational to how \", \"ASP.NET Web Forms requests are handled. This system makes it easier to reason about what process is \", \"occurring and allows middleware to be inserted at any point. Middleware executes in the order in whi\", \"ch it\\u2019s added to the request pipeline. They\\u2019re also added in code instead of configuration files, us\", \"ually in Startup.cs.\\n\\nKatana\\n\\nReaders familiar with Katana will feel comfortable in ASP.NET Core. In\", \" fact, Katana is a framework from which ASP.NET Core derives. It introduced similar middleware and p\", \"ipeline patterns for ASP.NET 4.x. Middleware designed for Katana can be adapted to work with the ASP\", \".NET Core pipeline.\\n\\nCommon middleware\\n\\nASP.NET 4.x includes many modules. In a similar fashion, ASP\", \".NET Core has many middleware components available as well. IIS modules may be used in some cases wi\", \"th ASP.NET Core. In other cases, native ASP.NET Core middleware may be available.\\n\\nThe following tab\", \"le lists replacement middleware and components in ASP.NET Core.\\n\\nModule\\n\\nASP.NET 4.x module\\n\\nASP.NET\", \" Core option\\n\\nHTTP errors\\n\\nCustomErrorModule\\n\\nStatus Code Pages Middleware\\n\\n57\\n\\nCHAPTER 11 | Modules\", \", handlers, and middleware\\n\\nModule\\n\\nASP.NET 4.x module\\n\\nASP.NET Core option\\n\\nDefault document\\n\\nDefau\", \"ltDocumentModule\\n\\nDefault Files Middleware\\n\\nDirectory browsing\\n\\nDirectoryListingModule\\n\\nDirectory Br\", \"owsing Middleware\\n\\nDynamic compression\\n\\nDynamicCompressionModule\\n\\nResponse Compression Middleware\\n\\nF\", \"ailed requests tracing\\n\\nFailedRequestsTracingModule\\n\\nASP.NET Core Logging\\n\\nFile caching\\n\\nFileCacheMo\", \"dule\\n\\nResponse Caching Middleware\\n\\nHTTP caching\\n\\nHttpCacheModule\\n\\nResponse Caching Middleware\\n\\nHTTP \", \"logging\\n\\nHttpLoggingModule\\n\\nASP.NET Core Logging\\n\\nHTTP redirection\\n\\nHttpRedirectionModule\\n\\nURL Rewri\", \"ting Middleware\\n\\nISAPI filters\\n\\nIsapiFilterModule\\n\\nMiddleware\\n\\nISAPI\\n\\nIsapiModule\\n\\nMiddleware\\n\\nReque\", \"st filtering\\n\\nRequestFilteringModule\\n\\nURL Rewriting Middleware IRule\\n\\nURL rewriting\\u2020\\n\\nRewriteModule\\n\", \"\\nURL Rewriting Middleware\\n\\nStatic compression\\n\\nStaticCompressionModule\\n\\nResponse Compression Middlew\", \"are\\n\\nStatic content\\n\\nStaticFileModule\\n\\nStatic File Middleware\\n\\nURL authorization\\n\\nUrlAuthorizationMo\", \"dule\\n\\nASP.NET Core Identity\\n\\nThis list isn\\u2019t exhaustive but should give an idea of what mapping exis\", \"ts between the two frameworks. For a more detailed list, see IIS modules with ASP.NET Core.\\n\\nCustom \", \"middleware\\n\\nBuilt-in middleware may not handle all scenarios needed for an app. In such cases, it ma\", \"kes sense to create your own middleware. There are multiple ways of defining middleware, with the si\", \"mplest being a simple delegate. Consider the following middleware, which accepts a culture request f\", \"rom a query string:\\n\\npublic class Startup { public void Configure(IApplicationBuilder app) { app.Use\", \"(async (context, next) => { var cultureQuery = context.Request.Query[\\\"culture\\\"];\\n\\n58\\n\\nCHAPTER 11 | M\", \"odules, handlers, and middleware\\n\\nif (!string.IsNullOrWhiteSpace(cultureQuery)) { var culture = new \", \"CultureInfo(cultureQuery);\\n\\nCultureInfo.CurrentCulture = culture; CultureInfo.CurrentUICulture = cul\", \"ture; }\\n\\n// Call the next delegate/middleware in the pipeline await next(); });\\n\\napp.Run(async (cont\", \"ext) => await context.Response.WriteAsync( $\\\"Hello {CultureInfo.CurrentCulture.DisplayName}\\\")); } }\\n\", \"\\nMiddleware can also be defined as class, either by implementing the IMiddleware interface or by fol\", \"lowing middleware convention. For more information, see Write custom ASP.NET Core middleware.\\n\\n59\\n\\nC\", \"HAPTER 11 | Modules, handlers, and middleware\\n\\nCHAPTER 12\\n\\nApp configuration\\n\\nThe primary way to loa\", \"d app configuration in Web Forms is with entries in the web.config file\\u2014either on the server or a re\", \"lated configuration file referenced by web.config. You can use the static ConfigurationManager objec\", \"t to interact with app settings, data repository connection strings, and other extended configuratio\", \"n providers that are added into the app. It\\u2019s typical to see interactions with app configuration as \", \"seen in the following code:\\n\\nvar configurationValue = ConfigurationManager.AppSettings[\\\"Configuratio\", \"nSettingName\\\"]; var connectionString = ConfigurationManager.ConnectionStrings[\\\"MyDatabaseConnectionN\", \"ame\\\"].ConnectionString;\\n\\nWith ASP.NET Core and server-side Blazor, the web.config file MAY be presen\", \"t if your app is hosted on a Windows IIS server. However, there\\u2019s no ConfigurationManager interactio\", \"n with this configuration, and you can receive more structured app configuration from other sources.\", \" Let\\u2019s take a look at how configuration is gathered and how you can still access configuration infor\", \"mation from a web.config file.\\n\\nConfiguration sources\\n\\nASP.NET Core recognizes there are many config\", \"uration sources you may want to use for your app. The framework attempts to offer you the best of th\", \"ese features by default. Configuration is read and aggregated from these various sources by ASP.NET \", \"Core. Later loaded values for the same configuration key take precedence over earlier values.\\n\\nASP.N\", \"ET Core was designed to be cloud-aware and to make the configuration of apps easier for both operato\", \"rs and developers. ASP.NET Core is environment-aware and knows if it\\u2019s running in your Production or\", \" Development environment. The environment indicator is set in the ASPNETCORE_ENVIRONMENT system envi\", \"ronment variable. If no value is configured, the app defaults to running in the Production environme\", \"nt.\\n\\nYour app can trigger and add configuration from several sources based on the environment\\u2019s name\", \". By default, the configuration is loaded from the following resources in the order listed:\\n\\n1.\\n\\napp\", \"settings.json file, if present\\n\\n2.\\n\\nappsettings.{ENVIRONMENT_NAME}.json file, if present\\n\\n3. User se\", \"crets file on disk, if present\\n\\n4.\\n\\nEnvironment variables\\n\\n5.\\n\\nCommand-line arguments\\n\\n60\\n\\nCHAPTER 1\", \"2 | App configuration\\n\\nappsettings.json format and access\\n\\nThe appsettings.json file can be hierarch\", \"ical with values structured like the following JSON:\\n\\n{ \\\"section0\\\": { \\\"key0\\\": \\\"value\\\", \\\"key1\\\": \\\"valu\", \"e\\\" }, \\\"section1\\\": { \\\"key0\\\": \\\"value\\\", \\\"key1\\\": \\\"value\\\" } }\\n\\nWhen presented with the preceding JSON, th\", \"e configuration system flattens child values and references their fully qualified hierarchical paths\", \". A colon (:) character separates each property in the hierarchy. For example, the configuration key\", \" section1:key0 accesses the section1 object literal\\u2019s key0 value.\\n\\nUser secrets\\n\\nUser secrets are:\\n\\n\", \"\\n\\nConfiguration values that are stored in a JSON file on the developer\\u2019s workstation, outside of the\", \" app development folder.\\n\\n\\n\\nOnly loaded when running in the Development environment.\\n\\n\\n\\nAssociated w\", \"ith a specific app.\\n\\nManaged with the .NET CLI\\u2019s user-secrets command.\\n\\nConfigure your app for secre\", \"ts storage by executing the user-secrets command:\\n\\ndotnet user-secrets init\\n\\nThe preceding command a\", \"dds a UserSecretsId element to the project file. The element contains a GUID, which is used to assoc\", \"iate secrets with the app. You can then define a secret with the set command. For example:\\n\\ndotnet u\", \"ser-secrets set \\\"Parent:ApiKey\\\" \\\"12345\\\"\\n\\nThe preceding command makes the Parent:ApiKey configuration\", \" key available on a developer\\u2019s workstation with the value 12345.\\n\\nFor more information about creati\", \"ng, storing, and managing user secrets, see the Safe storage of app secrets in development in ASP.NE\", \"T Core document.\\n\\nEnvironment variables\\n\\nThe next set of values loaded into your app configuration i\", \"s the system\\u2019s environment variables. All of your system\\u2019s environment variable settings are now acc\", \"essible to you through the configuration API.\\n\\n61\\n\\nCHAPTER 12 | App configuration\\n\\nHierarchical valu\", \"es are flattened and separated by colon characters when read inside your app. However, some operatin\", \"g systems don\\u2019t allow the colon character environment variable names. ASP.NET Core addresses this li\", \"mitation by converting values that have double-underscores (__) into a colon when they\\u2019re accessed. \", \"The Parent:ApiKey value from the user secrets section above can be overridden with the environment v\", \"ariable Parent__ApiKey.\\n\\nCommand-line arguments\\n\\nConfiguration can also be provided as command-line \", \"arguments when your app is started. Use the double-dash (--) or forward-slash (/) notation to indica\", \"te the name of the configuration value to set and the value to be configured. The syntax resembles t\", \"he following commands:\\n\\ndotnet run CommandLineKey1=value1 --CommandLineKey2=value2 /CommandLineKey3=\", \"value3 dotnet run --CommandLineKey1 value1 /CommandLineKey2 value2 dotnet run Parent:ApiKey=67890\\n\\nT\", \"he return of web.config\\n\\nIf you\\u2019ve deployed your app to Windows on IIS, the web.config file still co\", \"nfigures IIS to manage your app. By default, IIS adds a reference to the ASP.NET Core Module (ANCM).\", \" ANCM is a native IIS module that hosts your app in place of the Kestrel web server. This web.config\", \" section resembles the following XML markup:\\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> <configuration>\", \" <location path=\\\".\\\" inheritInChildApplications=\\\"false\\\"> <system.webServer> <handlers> <add name=\\\"asp\", \"NetCore\\\" path=\\\"*\\\" verb=\\\"*\\\" modules=\\\"AspNetCoreModuleV2\\\" resourceType=\\\"Unspecified\\\" /> </handlers> <a\", \"spNetCore processPath=\\\".\\\\MyApp.exe\\\" stdoutLogEnabled=\\\"false\\\" stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" hostingMo\", \"del=\\\"inprocess\\\" /> </system.webServer> </location> </configuration>\\n\\nApp-specific configuration can \", \"be defined by nesting an environmentVariables element in the aspNetCore element. The values defined \", \"in this section are presented to the ASP.NET Core app as environment variables. The environment vari\", \"ables load appropriately during that segment of app startup.\\n\\n<aspNetCore processPath=\\\"dotnet\\\" argum\", \"ents=\\\".\\\\MyApp.dll\\\" stdoutLogEnabled=\\\"false\\\" stdoutLogFile=\\\".\\\\logs\\\\stdout\\\" hostingModel=\\\"inprocess\\\"> \", \"<environmentVariables> <environmentVariable name=\\\"ASPNETCORE_ENVIRONMENT\\\" value=\\\"Development\\\" />\\n\\n62\", \"\\n\\nCHAPTER 12 | App configuration\\n\\n<environmentVariable name=\\\"Parent:ApiKey\\\" value=\\\"67890\\\" /> </envir\", \"onmentVariables> </aspNetCore>\\n\\nRead configuration in the app\\n\\nASP.NET Core provides app configurati\", \"on through the IConfiguration interface. This configuration interface should be requested by your Bl\", \"azor components, Blazor pages, and any other ASP.NET Core- managed class that needs access to config\", \"uration. The ASP.NET Core framework will automatically populate this interface with the resolved con\", \"figuration configured earlier. On a Blazor page or a component\\u2019s Razor markup, you can inject the IC\", \"onfiguration object with an @inject directive at the top of the .razor file like this:\\n\\n@inject ICon\", \"figuration Configuration\\n\\nThis preceding statement makes the IConfiguration object available as the \", \"Configuration variable throughout the rest of the Razor template.\\n\\nIndividual configuration settings\", \" can be read by specifying the configuration setting hierarchy sought as an indexer parameter:\\n\\nvar \", \"mySetting = Configuration[\\\"section1:key0\\\"];\\n\\nYou can fetch entire configuration sections by using th\", \"e GetSection method to retrieve a collection of keys at a specific location with a syntax similar to\", \" GetSection(\\\"section1\\\") to retrieve the configuration for section1 from the earlier example.\\n\\nStrong\", \"ly typed configuration\\n\\nWith Web Forms, it was possible to create a strongly typed configuration typ\", \"e that inherited from the ConfigurationSection type and associated types. A ConfigurationSection all\", \"owed you to configure some business rules and processing for those configuration values.\\n\\nIn ASP.NET\", \" Core, you can specify a class hierarchy that will receive the configuration values. These classes:\\n\", \"\\n\\n\\nDon\\u2019t need to inherit from a parent class.\\n\\n\\n\\nShould include public properties that match the pro\", \"perties and type references for the configuration structure you wish to capture.\\n\\nFor the earlier ap\", \"psettings.json sample, you could define the following classes to capture the values:\\n\\npublic class M\", \"yConfig { public MyConfigSection section0 { get; set;}\\n\\npublic MyConfigSection section1 { get; set;}\", \" }\\n\\npublic class MyConfigSection {\\n\\n63\\n\\nCHAPTER 12 | App configuration\\n\\npublic string key0 { get; se\", \"t; }\\n\\npublic string key1 { get; set; } }\\n\\nThis class hierarchy can be populated by adding the follow\", \"ing line to the Startup.ConfigureServices method (or appropriate location in Program.cs using the bu\", \"ilder.Services property instead of services):\\n\\nservices.Configure<MyConfig>(Configuration);\\n\\nIn the \", \"rest of the app, you can add an input parameter to classes or an @inject directive in Razor template\", \"s of type IOptions<MyConfig> to receive the strongly typed configuration settings. The IOptions<MyCo\", \"nfig>.Value property will yield the MyConfig value populated from the configuration settings.\\n\\n@inje\", \"ct IOptions<MyConfig> options @code { var MyConfiguration = options.Value; var theSetting = MyConfig\", \"uration.section1.key0; }\\n\\nMore information about the Options feature can be found in the Options pat\", \"tern in ASP.NET Core document.\\n\\n64\\n\\nCHAPTER 12 | App configuration\\n\\nCHAPTER 13\\n\\nSecurity: Authentica\", \"tion and Authorization in ASP.NET Web Forms and Blazor\\n\\nMigrating from an ASP.NET Web Forms applicat\", \"ion to Blazor will almost certainly require updating how authentication and authorization are perfor\", \"med, assuming the application had authentication configured. This chapter will cover how to migrate \", \"from the ASP.NET Web Forms universal provider model (for membership, roles, and user profiles) and h\", \"ow to work with ASP.NET Core Identity from Blazor apps. While this chapter will cover the high-level\", \" steps and considerations, the detailed steps and scripts may be found in the referenced documentati\", \"on.\\n\\nASP.NET universal providers\\n\\nSince ASP.NET 2.0, the ASP.NET Web Forms platform has supported a \", \"provider model for a variety of features, including membership. The universal membership provider, a\", \"long with the optional role provider, is commonly deployed with ASP.NET Web Forms applications. It o\", \"ffers a robust and secure way to manage authentication and authorization that continues to work well\", \" today. The most recent offering of these universal providers is available as a NuGet package, Micro\", \"soft.AspNet.Providers.\\n\\nThe Universal Providers work with a SQL database schema that includes tables\", \" like aspnet_Applications, aspnet_Membership, aspnet_Roles, and aspnet_Users. When configured by run\", \"ning the aspnet_regsql.exe command, the providers install tables and stored procedures that provide \", \"all of the necessary queries and commands to work with the underlying data. The database schema and \", \"these stored procedures are not compatible with newer ASP.NET Identity and ASP.NET Core Identity sys\", \"tems, so existing data must be migrated into the new system. Figure 1 shows an example table schema \", \"configured for universal providers.\\n\\n65\\n\\nCHAPTER 13 | Security: Authentication and Authorization in \", \"ASP.NET Web Forms and Blazor\\n\\nThe universal provider handles users, membership, roles, and profiles.\", \" Users are assigned globally unique identifiers and basic information like userId, userName etc. are\", \" stored in the aspnet_Users table. Authentication information, such as password, password format, pa\", \"ssword salt, lockout counters and details, etc. are stored in the aspnet_Membership table. Roles con\", \"sist simply of names and unique identifiers, which are assigned to users via the aspnet_UsersInRoles\", \" association table, providing a many-to-many relationship.\\n\\nIf your existing system is using roles i\", \"n addition to membership, you will need to migrate the user accounts, the associated passwords, the \", \"roles, and the role membership into ASP.NET Core Identity. You will also most likely need to update \", \"your code where you\\u2019re currently performing role checks using if statements to instead leverage decl\", \"arative filters, attributes, and/or tag helpers. We will review migration considerations in greater \", \"detail at the end of this chapter.\\n\\nAuthorization configuration in Web Forms\\n\\nTo configure authorize\", \"d access to certain pages in an ASP.NET Web Forms application, typically you specify that certain pa\", \"ges or folders are inaccessible to anonymous users. This configuration is done in the web.config fil\", \"e:\\n\\n<?xml version=\\\"1.0\\\"?> <configuration> <system.web> <authentication mode=\\\"Forms\\\"> <forms defaultU\", \"rl=\\\"~/home.aspx\\\" loginUrl=\\\"~/login.aspx\\\" slidingExpiration=\\\"true\\\" timeout=\\\"2880\\\"></forms> </authenti\", \"cation>\\n\\n<authorization> <deny users=\\\"?\\\" /> </authorization> </system.web> </configuration>\\n\\nThe aut\", \"hentication configuration section sets up the forms authentication for the application. The authoriz\", \"ation section is used to disallow anonymous users for the entire application. However, you can provi\", \"de more granular authorization rules on a per-location basis as well as apply role-based authorizati\", \"on checks.\\n\\n<location path=\\\"login.aspx\\\"> <system.web>\\n\\n66\\n\\nCHAPTER 13 | Security: Authentication and\", \" Authorization in ASP.NET Web Forms and Blazor\\n\\n<authorization> <allow users=\\\"*\\\" /> </authorization>\", \" </system.web> </location>\\n\\nThe above configuration, when combined with the first one, would allow a\", \"nonymous users to access the login page, overriding the site-wide restriction on non-authenticated u\", \"sers.\\n\\n<location path=\\\"/admin\\\"> <system.web> <authorization> <allow roles=\\\"Administrators\\\" /> <deny \", \"users=\\\"*\\\" /> </authorization> </system.web> </location>\\n\\nThe above configuration, when combined with\", \" the others, restricts access to the /admin folder and all resources within it to members of the \\u201cAd\", \"ministrators\\u201d role. This restriction could also be applied by placing a separate web.config file wit\", \"hin the /admin folder root.\\n\\nAuthorization code in Web Forms\\n\\nIn addition to configuring access usin\", \"g web.config, you can also programmatically configure access and behavior in your Web Forms applicat\", \"ion. For instance, you can restrict the ability to perform certain operations or view certain data b\", \"ased on the user\\u2019s role.\\n\\nThis code can be used both in code-behind logic as well as in the page its\", \"elf:\\n\\n<% if (HttpContext.Current.User.IsInRole(\\\"Administrators\\\")) { %> <a href=\\\"/admin\\\">Go To Admin<\", \"/a> <% } %>\\n\\nIn addition to checking user role membership, you can also determine if they are authen\", \"ticated (though often this is better done using the location-based configuration covered above). Bel\", \"ow is an example of this approach.\\n\\nprotected void Page_Load(object sender, EventArgs e) { if (!User\", \".Identity.IsAuthenticated) { FormsAuthentication.RedirectToLoginPage(); } if (!Roles.IsUserInRole(Us\", \"er.Identity.Name, \\\"Administrators\\\")) { MessageLabel.Text = \\\"Only administrators can view this.\\\"; Sec\", \"retPanel.Visible = false; } }\\n\\nIn the code above, role-based access control (RBAC) is used to determ\", \"ine whether certain elements of the page, such as a SecretPanel, are visible based on the current us\", \"er\\u2019s role.\\n\\n67\\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Bla\", \"zor\\n\\nTypically, ASP.NET Web Forms applications configure security within the web.config file and the\", \"n add additional checks where needed in .aspx pages and their related .aspx.cs code-behind files. Mo\", \"st applications leverage the universal membership provider, frequently with the additional role prov\", \"ider.\\n\\nASP.NET Core Identity\\n\\nAlthough still tasked with authentication and authorization, ASP.NET C\", \"ore Identity uses a different set of abstractions and assumptions when compared to the universal pro\", \"viders. For example, the new Identity model supports third party authentication, allowing users to a\", \"uthenticate using a social media account or other trusted authentication provider. ASP.NET Core Iden\", \"tity supports UI for commonly needed pages like login, logout, and register. It leverages EF Core fo\", \"r its data access, and uses EF Core migrations to generate the necessary schema required to support \", \"its data model. This introduction to Identity on ASP.NET Core provides a good overview of what is in\", \"cluded with ASP.NET Core Identity and how to get started working with it. If you haven\\u2019t already set\", \" up ASP.NET Core Identity in your application and its database, it will help you get started.\\n\\nRoles\", \", claims, and policies\\n\\nBoth the universal providers and ASP.NET Core Identity support the concept o\", \"f roles. You can create roles for users and assign users to roles. Users can belong to any number of\", \" roles, and you can verify role membership as part of your authorization implementation.\\n\\nIn additio\", \"n to roles, ASP.NET Core identity supports the concepts of claims and policies. While a role should \", \"specifically correspond to a set of resources a user in that role should be able to access, a claim \", \"is simply part of a user\\u2019s identity. A claim is a name value pair that represents what the subject i\", \"s, not what the subject can do.\\n\\nIt is possible to directly inspect a user\\u2019s claims and determine ba\", \"sed on these values whether a user should be given access to a resource. However, such checks are of\", \"ten repetitive and scattered throughout the system. A better approach is to define a policy.\\n\\nAn aut\", \"horization policy consists of one or more requirements. Policies are registered as part of the autho\", \"rization service configuration in the ConfigureServices method of Startup.cs. For example, the follo\", \"wing code snippet configures a policy called \\u201cCanadiansOnly\\u201d, which has the requirement that the use\", \"r has the Country claim with the value of \\u201cCanada\\u201d.\\n\\nservices.AddAuthorization(options => { options.\", \"AddPolicy(\\\"CanadiansOnly\\\", policy => policy.RequireClaim(ClaimTypes.Country, \\\"Canada\\\")); });\\n\\nYou ca\", \"n learn more about how to create custom policies in the documentation.\\n\\nWhether you\\u2019re using policie\", \"s or roles, you can specify that a particular page in your Blazor application requires that role or \", \"policy with the [Authorize] attribute, applied with the @attribute directive.\\n\\nRequiring a role:\\n\\n68\", \"\\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\n@attribut\", \"e [Authorize(Roles =\\\"administrators\\\")]\\n\\nRequiring a policy be satisfied:\\n\\n@attribute [Authorize(Poli\", \"cy =\\\"CanadiansOnly\\\")]\\n\\nIf you need access to a user\\u2019s authentication state, roles, or claims in your\", \" code, there are two primary ways to achieve this functionality. The first is to receive the authent\", \"ication state as a cascading parameter. The second is to access the state using an injected Authenti\", \"cationStateProvider. The details of each of these approaches are described in the Blazor Security do\", \"cumentation.\\n\\nThe following code shows how to receive the AuthenticationState as a cascading paramet\", \"er:\\n\\n[CascadingParameter] private Task<AuthenticationState> authenticationStateTask { get; set; }\\n\\nW\", \"ith this parameter in place, you can get the user using this code:\\n\\nvar authState = await authentica\", \"tionStateTask; var user = authState.User;\\n\\nThe following code shows how to inject the Authentication\", \"StateProvider:\\n\\n@using Microsoft.AspNetCore.Components.Authorization @inject AuthenticationStateProv\", \"ider AuthenticationStateProvider\\n\\nWith the provider in place, you can gain access to the user with t\", \"he following code:\\n\\nAuthenticationState authState = await AuthenticationStateProvider.GetAuthenticat\", \"ionStateAsync(); ClaimsPrincipal user = authState.User;\\n\\nif (user.Identity.IsAuthenticated) { // wor\", \"k with user.Claims and/or user.Roles }\\n\\nNote: The AuthorizeView component, covered later in this cha\", \"pter, provides a declarative way to control what a user sees on a page or component.\\n\\nTo work with u\", \"sers and claims (in Blazor Server applications) you may also need to inject a UserManager<T> (use Id\", \"entityUser for default) which you can use to enumerate and modify claims for a user. First inject th\", \"e type and assign it to a property:\\n\\n@inject UserManager<IdentityUser> MyUserManager\\n\\nThen use it to\", \" work with the user\\u2019s claims. The following sample shows how to add and persist a claim on a user:\\n\\n\", \"private async Task AddCountryClaim() { var authState = await AuthenticationStateProvider.GetAuthenti\", \"cationStateAsync(); var user = authState.User; var identityUser = await MyUserManager.FindByNameAsyn\", \"c(user.Identity.Name);\\n\\nif (!user.HasClaim(c => c.Type == ClaimTypes.Country)) {\\n\\n69\\n\\nCHAPTER 13 | S\", \"ecurity: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\n// stores the claim in th\", \"e cookie ClaimsIdentity id = new ClaimsIdentity(); id.AddClaim(new Claim(ClaimTypes.Country, \\\"Canada\", \"\\\")); user.AddIdentity(id);\\n\\n// save the claim in the database await MyUserManager.AddClaimAsync(iden\", \"tityUser, new Claim(ClaimTypes.Country, \\\"Canada\\\")); } }\\n\\nIf you need to work with roles, follow the \", \"same approach. You may need to inject a RoleManager<T> (use IdentityRole for default type) to list a\", \"nd manage the roles themselves.\\n\\nNote: In Blazor WebAssembly projects, you will need to provide serv\", \"er APIs to perform these operations (instead of using UserManager<T> or RoleManager<T> directly). A \", \"Blazor WebAssembly client application would manage claims and/or roles by securely calling API endpo\", \"ints exposed for this purpose.\\n\\nMigration guide\\n\\nMigrating from ASP.NET Web Forms and universal prov\", \"iders to ASP.NET Core Identity requires several steps:\\n\\n1.\\n\\nCreate ASP.NET Core Identity database sc\", \"hema in the destination database\\n\\n2. Migrate data from universal provider schema to ASP.NET Core Ide\", \"ntity schema\\n\\n3. Migrate configuration from the web.config to middleware and services, typically in \", \"Program.cs\\n\\n(or a Startup class)\\n\\n4. Update individual pages using controls and conditionals to use \", \"tag helpers and new identity\\n\\nAPIs.\\n\\nEach of these steps is described in detail in the following sec\", \"tions.\\n\\nCreating the ASP.NET Core Identity schema\\n\\nThere are several ways to create the necessary ta\", \"ble structure used for ASP.NET Core Identity. The simplest is to create a new ASP.NET Core Web appli\", \"cation. Choose Web Application and then change Authentication type to use Individual Accounts.\\n\\n70\\n\\n\", \"CHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\nFrom the co\", \"mmand line, you can do the same thing by running dotnet new webapp -au Individual. Once the app has \", \"been created, run it and register on the site. You should trigger a page like the one shown below:\\n\\n\", \"71\\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\nClick o\", \"n the \\u201cApply Migrations\\u201d button and the necessary database tables should be created for you. In addi\", \"tion, the migration files should appear in your project, as shown:\\n\\n72\\n\\nCHAPTER 13 | Security: Authe\", \"ntication and Authorization in ASP.NET Web Forms and Blazor\\n\\nYou can run the migration yourself, wit\", \"hout running the web application, using this command-line tool:\\n\\ndotnet ef database update\\n\\nIf you w\", \"ould rather run a script to apply the new schema to an existing database, you can script these migra\", \"tions from the command-line. Run this command to generate the script:\\n\\ndotnet ef migrations script -\", \"o auth.sql\\n\\nThe above command will produce a SQL script in the output file auth.sql, which can then \", \"be run against whatever database you like. If you have any trouble running dotnet ef commands, make \", \"sure you have the EF Core tools installed on your system.\\n\\nIn the event you have additional columns \", \"on your source tables, you will need to identify the best location for these columns in the new sche\", \"ma. Generally, columns found on the aspnet_Membership table should be mapped to the AspNetUsers tabl\", \"e. Columns on aspnet_Roles should be mapped to AspNetRoles. Any additional columns on the aspnet_Use\", \"rsInRoles table would be added to the AspNetUserRoles table.\\n\\nIt\\u2019s also worth considering putting an\", \"y additional columns on separate tables. So that future migrations won\\u2019t need to take into account s\", \"uch customizations of the default identity schema.\\n\\nMigrating data from universal providers to ASP.N\", \"ET Core Identity\\n\\nOnce you have the destination table schema in place, the next step is to migrate y\", \"our user and role records to the new schema. A complete list of the schema differences, including wh\", \"ich columns map to which new columns, can be found here.\\n\\n73\\n\\nCHAPTER 13 | Security: Authentication \", \"and Authorization in ASP.NET Web Forms and Blazor\\n\\nTo migrate your users from membership to the new \", \"identity tables, you should follow the steps described in the documentation. After following these s\", \"teps and the script provided, your users will need to change their password the next time they log i\", \"n.\\n\\nIt is possible to migrate user passwords but the process is much more involved. Requiring users \", \"to update their passwords as part of the migration process, and encouraging them to use new, unique \", \"passwords, is likely to enhance the overall security of the application.\\n\\nMigrating security setting\", \"s from web.config to app startup\\n\\nAs noted above, ASP.NET membership and role providers are configur\", \"ed in the application\\u2019s web.config file. Since ASP.NET Core apps are not tied to IIS and use a separ\", \"ate system for configuration, these settings must be configured elsewhere. For the most part, ASP.NE\", \"T Core Identity is configured in the Program.cs file. Open the web project that was created earlier \", \"(to generate the identity table schema) and review its Program.cs (or Startup.cs) file.\\n\\nThis code a\", \"dds support for EF Core and Identity:\\n\\n// Add services to the container. var connectionString = buil\", \"der.Configuration.GetConnectionString(\\\"DefaultConnection\\\"); builder.Services.AddDbContext<Applicatio\", \"nDbContext>(options => options.UseSqlServer(connectionString)); builder.Services.AddDatabaseDevelope\", \"rPageExceptionFilter(); builder.Services.AddDefaultIdentity<IdentityUser>(options => options.SignIn.\", \"RequireConfirmedAccount = true) .AddEntityFrameworkStores<ApplicationDbContext>();\\n\\nThe AddDefaultId\", \"entity extension method is used to configure Identity to use the default ApplicationDbContext and th\", \"e framework\\u2019s IdentityUser type. If you\\u2019re using a custom IdentityUser, be sure to specify its type \", \"here. If these extension methods aren\\u2019t working in your application, check that you have the appropr\", \"iate using statements and that you have the necessary NuGet package references. For example, your pr\", \"oject should have some version of the Microsoft.AspNetCore.Identity.EntityFrameworkCore and Microsof\", \"t.AspNetCore.Identity.UI packages referenced.\\n\\nAlso in Program.cs you should see the necessary middl\", \"eware configured for the site. Specifically, UseAuthentication and UseAuthorization should be set up\", \", and in the proper location.\\n\\n// Configure the HTTP request pipeline. if (app.Environment.IsDevelop\", \"ment()) { app.UseMigrationsEndPoint(); } else { app.UseExceptionHandler(\\\"/Error\\\"); // The default HS\", \"TS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnet\", \"core-hsts. app.UseHsts(); }\\n\\napp.UseHttpsRedirection();\\n\\napp.UseStaticFiles();\\n\\n74\\n\\nCHAPTER 13 | Sec\", \"urity: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\napp.UseRouting();\\n\\napp.UseA\", \"uthentication(); app.UseAuthorization();\\n\\n//app.MapControllers(); app.MapBlazorHub(); app.MapFallbac\", \"kToPage(\\\"/_Host\\\");\\n\\nASP.NET Identity does not configure anonymous or role-based access to locations \", \"from Program.cs. You will need to migrate any location-specific authorization configuration data to \", \"filters in ASP.NET Core. Make note of which folders and pages will require such updates. You will ma\", \"ke these changes in the next section.\\n\\nUpdating individual pages to use ASP.NET Core Identity abstra\", \"ctions\\n\\nIn your ASP.NET Web Forms application, if you had web.config settings to deny access to cert\", \"ain pages or folders to anonymous users, you would migrate these changes by adding the [Authorize] a\", \"ttribute to such pages:\\n\\n@attribute [Authorize]\\n\\nIf you further had denied access except to those us\", \"ers belonging to a certain role, you would likewise migrate this behavior by adding an attribute spe\", \"cifying a role:\\n\\n@attribute [Authorize(Roles =\\\"administrators\\\")]\\n\\nThe [Authorize] attribute only wor\", \"ks on @page components that are reached via the Blazor Router. The attribute does not work with chil\", \"d components, which should instead use AuthorizeView.\\n\\nIf you have logic within page markup for dete\", \"rmining whether to display some code to a certain user, you can replace this with the AuthorizeView \", \"component. The AuthorizeView component selectively displays UI depending on whether the user is auth\", \"orized to see it. It also exposes a context variable that can be used to access user information.\\n\\n<\", \"AuthorizeView> <Authorized> <h1>Hello, @context.User.Identity.Name!</h1> <p>You can only see this co\", \"ntent if you are authenticated.</p> </Authorized> <NotAuthorized> <h1>Authentication Failure!</h1> <\", \"p>You are not signed in.</p> </NotAuthorized> </AuthorizeView>\\n\\nYou can access the authentication st\", \"ate within procedural logic by accessing the user from a Task<AuthenticationState configured with th\", \"e [CascadingParameter] attribute. This configuration will get you access to the user, which can let \", \"you determine if they are authenticated and if they belong to a particular role. If you need to eval\", \"uate a policy procedurally, you can inject an instance of the IAuthorizationService and calls the Au\", \"thorizeAsync method on it. The following sample code demonstrates how to get user information and al\", \"low an authorized user to perform a task restricted by the content-editor policy.\\n\\n75\\n\\nCHAPTER 13 | \", \"Security: Authentication and Authorization in ASP.NET Web Forms and Blazor\\n\\n@using Microsoft.AspNetC\", \"ore.Authorization @inject IAuthorizationService AuthorizationService\\n\\n<button @onclick=\\\"@DoSomething\", \"\\\">Do something important</button>\\n\\n@code { [CascadingParameter] private Task<AuthenticationState> au\", \"thenticationStateTask { get; set; }\\n\\nprivate async Task DoSomething() { var user = (await authentica\", \"tionStateTask).User;\\n\\nif (user.Identity.IsAuthenticated) { // Perform an action only available to au\", \"thenticated (signed-in) users. }\\n\\nif (user.IsInRole(\\\"admin\\\")) { // Perform an action only available \", \"to users in the 'admin' role. }\\n\\nif ((await AuthorizationService.AuthorizeAsync(user, \\\"content-edito\", \"r\\\")) .Succeeded) { // Perform an action only available to users satisfying the // 'content-editor' p\", \"olicy. } } }\\n\\nThe AuthenticationState first need to be set up as a cascading value before it can be \", \"bound to a cascading parameter like this. That\\u2019s typically done using the CascadingAuthenticationSta\", \"te component. This configuration is typically done in App.razor:\\n\\n<CascadingAuthenticationState> <Ro\", \"uter AppAssembly=\\\"@typeof(Program).Assembly\\\"> <Found Context=\\\"routeData\\\"> <AuthorizeRouteView RouteD\", \"ata=\\\"@routeData\\\" DefaultLayout=\\\"@typeof(MainLayout)\\\" /> </Found> <NotFound> <LayoutView Layout=\\\"@typ\", \"eof(MainLayout)\\\"> <p>Sorry, there's nothing at this address.</p> </LayoutView> </NotFound> </Router>\", \" </CascadingAuthenticationState>\\n\\nSummary\\n\\nBlazor uses the same security model as ASP.NET Core, whic\", \"h is ASP.NET Core Identity. Migrating from universal providers to ASP.NET Core Identity is relativel\", \"y straightforward, assuming not too much customization was applied to the original data schema. Once\", \" the data has been migrated, working\\n\\n76\\n\\nCHAPTER 13 | Security: Authentication and Authorization in\", \" ASP.NET Web Forms and Blazor\\n\\nwith authentication and authorization in Blazor apps is well document\", \"ed, with configurable as well as programmatic support for most security requirements.\\n\\nReferences\\n\\n\\n\", \"\\nIntroduction to Identity on ASP.NET Core\\n\\nMigrate from ASP.NET Membership authentication to ASP.NET\", \" Core 2.0 Identity\\n\\nMigrate Authentication and Identity to ASP.NET Core\\n\\n\\n\\nASP.NET Core Blazor authe\", \"ntication and authorization\\n\\n77\\n\\nCHAPTER 13 | Security: Authentication and Authorization in ASP.NET \", \"Web Forms and Blazor\\n\\nCHAPTER 14\\n\\nMigrate from ASP.NET Web Forms to Blazor\\n\\nMigrating a code base fr\", \"om ASP.NET Web Forms to Blazor is a time-consuming task that requires planning. This chapter outline\", \"s the process. Something that can ease the transition is to ensure the app adheres to an N-tier arch\", \"itecture, wherein the app model (in this case, Web Forms) is separate from the business logic. This \", \"logical separation of layers makes it clear what needs to move to .NET Core and Blazor.\\n\\nFor this ex\", \"ample, the eShop app available on GitHub is used. eShop is a catalog service that provides CRUD capa\", \"bilities via form entry and validation.\\n\\nWhy should a working app be migrated to Blazor? Many times,\", \" there\\u2019s no need. ASP.NET Web Forms will continue to be supported for many years. However, many of t\", \"he features that Blazor provides are only supported on a migrated app. Such features include:\\n\\n\\n\\nPer\", \"formance improvements in the framework such as Span<T>\\n\\n\\n\\nAbility to run as WebAssembly\\n\\n\\n\\nCross-pla\", \"tform support for Linux and macOS\\n\\n\\n\\nApp-local deployment or shared framework deployment without imp\", \"acting other apps\\n\\nIf these or other new features are compelling enough, there may be value in migra\", \"ting the app. The migration can take different shapes; it can be the entire app, or only certain end\", \"points that require the changes. The decision to migrate is ultimately based on the business problem\", \"s to be solved by the developer.\\n\\nServer-side versus client-side hosting\\n\\nAs described in the hostin\", \"g models chapter, a Blazor app can be hosted in two different ways: server- side and client-side. Th\", \"e server-side model uses ASP.NET Core SignalR connections to manage the DOM updates while running an\", \"y actual code on the server. The client-side model runs as WebAssembly within a browser and requires\", \" no server connections. There are a number of differences that may affect which is best for a specif\", \"ic app:\\n\\n\\n\\nRunning as WebAssembly doesn\\u2019t support all features (such as threading) at the current ti\", \"me\\n\\n\\n\\nChatty communication between the client and server may cause latency issues in server-side mod\", \"e\\n\\n78\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\n\\n\\nAccess to databases and internal or \", \"protected services require a separate service with client- side hosting\\n\\nAt the time of writing, the\", \" server-side model more closely resembles Web Forms. Most of this chapter focuses on the server-side\", \" hosting model, as it\\u2019s production-ready.\\n\\nCreate a new project\\n\\nThis initial migration step is to c\", \"reate a new project. This project type is based on the SDK style projects of .NET and simplifies muc\", \"h of the boilerplate that was used in previous project formats. For more detail, please see the chap\", \"ter on Project Structure.\\n\\nOnce the project has been created, install the libraries that were used i\", \"n the previous project. In older Web Forms projects, you may have used the packages.config file to l\", \"ist the required NuGet packages. In the new SDK-style project, packages.config has been replaced wit\", \"h <PackageReference> elements in the project file. A benefit to this approach is that all dependenci\", \"es are installed transitively. You only list the top-level dependencies you care about.\\n\\nMany of the\", \" dependencies you\\u2019re using are available for .NET, including Entity Framework 6 and log4net. If ther\", \"e\\u2019s no .NET or .NET Standard version available, the .NET Framework version can often be used. Your m\", \"ileage may vary. Any API used that isn\\u2019t available in .NET causes a runtime error. Visual Studio not\", \"ifies you of such packages. A yellow icon appears on the project\\u2019s References node in Solution Explo\", \"rer.\\n\\nIn the Blazor-based eShop project, you can see the packages that are installed. Previously, th\", \"e packages.config file listed every package used in the project, resulting in a file almost 50 lines\", \" long. A snippet of packages.config is:\\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> <packages> ... <pack\", \"age id=\\\"Microsoft.ApplicationInsights.Agent.Intercept\\\" version=\\\"2.4.0\\\" targetFramework=\\\"net472\\\" /> <\", \"package id=\\\"Microsoft.ApplicationInsights.DependencyCollector\\\" version=\\\"2.9.1\\\" targetFramework=\\\"net4\", \"72\\\" /> <package id=\\\"Microsoft.ApplicationInsights.PerfCounterCollector\\\" version=\\\"2.9.1\\\" targetFramew\", \"ork=\\\"net472\\\" /> <package id=\\\"Microsoft.ApplicationInsights.Web\\\" version=\\\"2.9.1\\\" targetFramework=\\\"net\", \"472\\\" /> <package id=\\\"Microsoft.ApplicationInsights.WindowsServer\\\" version=\\\"2.9.1\\\" targetFramework=\\\"n\", \"et472\\\" /> <package id=\\\"Microsoft.ApplicationInsights.WindowsServer.TelemetryChannel\\\" version=\\\"2.9.1\\\"\", \" targetFramework=\\\"net472\\\" /> <package id=\\\"Microsoft.AspNet.FriendlyUrls\\\" version=\\\"1.0.2\\\" targetFrame\", \"work=\\\"net472\\\" /> <package id=\\\"Microsoft.AspNet.FriendlyUrls.Core\\\" version=\\\"1.0.2\\\" targetFramework=\\\"n\", \"et472\\\" /> <package id=\\\"Microsoft.AspNet.ScriptManager.MSAjax\\\" version=\\\"5.0.0\\\" targetFramework=\\\"net47\", \"2\\\" /> <package id=\\\"Microsoft.AspNet.ScriptManager.WebForms\\\" version=\\\"5.0.0\\\" targetFramework=\\\"net472\\\"\", \" /> ... <package id=\\\"System.Memory\\\" version=\\\"4.5.1\\\" targetFramework=\\\"net472\\\" /> <package id=\\\"System.\", \"Numerics.Vectors\\\" version=\\\"4.4.0\\\" targetFramework=\\\"net472\\\" /> <package id=\\\"System.Runtime.CompilerSe\", \"rvices.Unsafe\\\" version=\\\"4.5.0\\\"\\n\\n79\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\ntargetFra\", \"mework=\\\"net472\\\" /> <package id=\\\"System.Threading.Channels\\\" version=\\\"4.5.0\\\" targetFramework=\\\"net472\\\" \", \"/> <package id=\\\"System.Threading.Tasks.Extensions\\\" version=\\\"4.5.1\\\" targetFramework=\\\"net472\\\" /> <pack\", \"age id=\\\"WebGrease\\\" version=\\\"1.6.0\\\" targetFramework=\\\"net472\\\" /> </packages>\\n\\nThe <packages> element i\", \"ncludes all necessary dependencies. It\\u2019s difficult to identify which of these packages are included \", \"because you require them. Some <package> elements are listed simply to satisfy the needs of dependen\", \"cies you require.\\n\\nThe Blazor project lists the dependencies you require within an <ItemGroup> eleme\", \"nt in the project file:\\n\\n<ItemGroup> <PackageReference Include=\\\"Autofac\\\" Version=\\\"4.9.3\\\" /> <Package\", \"Reference Include=\\\"EntityFramework\\\" Version=\\\"6.4.4\\\" /> <PackageReference Include=\\\"log4net\\\" Version=\\\"\", \"2.0.12\\\" /> <PackageReference Include=\\\"Microsoft.Extensions.Logging.Log4Net.AspNetCore\\\" Version=\\\"2.2.\", \"12\\\" /> </ItemGroup>\\n\\nOne NuGet package that simplifies the life of Web Forms developers is the Windo\", \"ws Compatibility Pack. Although .NET is cross-platform, some features are only available on Windows.\", \" Windows- specific features are made available by installing the compatibility pack. Examples of suc\", \"h features include the Registry, WMI, and Directory Services. The package adds around 20,000 APIs an\", \"d activates many services with which you may already be familiar. The eShop project doesn\\u2019t require \", \"the compatibility pack; but if your projects use Windows-specific features, the package eases the mi\", \"gration efforts.\\n\\nEnable startup process\\n\\nThe startup process for Blazor has changed from Web Forms \", \"and follows a similar setup for other ASP.NET Core services. When hosted server-side, Razor componen\", \"ts are run as part of a normal ASP.NET Core app. When hosted in the browser with WebAssembly, Razor \", \"components use a similar hosting model. The difference is the components are run as a separate servi\", \"ce from any of the backend processes. Either way, the startup is similar.\\n\\nThe Global.asax.cs file i\", \"s the default startup page for Web Forms projects. In the eShop project, this file configures the In\", \"version of Control (IoC) container and handles the various lifecycle events of the app or request. S\", \"ome of these events are handled with middleware (such as Application_BeginRequest). Other events req\", \"uire the overriding of specific services via dependency injection (DI).\\n\\nBy way of example, the Glob\", \"al.asax.cs file for eShop, contains the following code:\\n\\npublic class Global : HttpApplication, ICon\", \"tainerProviderAccessor { private static readonly ILog _log = LogManager.GetLogger(System.Reflection.\", \"MethodBase.GetCurrentMethod().DeclaringType);\\n\\nstatic IContainerProvider _containerProvider; IContai\", \"ner container;\\n\\n80\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\npublic IContainerProvider\", \" ContainerProvider { get { return _containerProvider; } }\\n\\nprotected void Application_Start(object s\", \"ender, EventArgs e) { // Code that runs on app startup RouteConfig.RegisterRoutes(RouteTable.Routes)\", \"; BundleConfig.RegisterBundles(BundleTable.Bundles); ConfigureContainer(); ConfigDataBase(); }\\n\\n/// \", \"<summary> /// Track the machine name and the start time for the session inside the current session /\", \"// </summary> protected void Session_Start(Object sender, EventArgs e) { HttpContext.Current.Session\", \"[\\\"MachineName\\\"] = Environment.MachineName; HttpContext.Current.Session[\\\"SessionStartTime\\\"] = DateTim\", \"e.Now; }\\n\\n/// <summary> /// https://autofaccn.readthedocs.io/en/latest/integration/webforms.html ///\", \" </summary> private void ConfigureContainer() { var builder = new ContainerBuilder(); var mockData =\", \" bool.Parse(ConfigurationManager.AppSettings[\\\"UseMockData\\\"]); builder.RegisterModule(new Application\", \"Module(mockData)); container = builder.Build(); _containerProvider = new ContainerProvider(container\", \"); }\\n\\nprivate void ConfigDataBase() { var mockData = bool.Parse(ConfigurationManager.AppSettings[\\\"Us\", \"eMockData\\\"]);\\n\\nif (!mockData) {\\n\\nDatabase.SetInitializer<CatalogDBContext>(container.Resolve<Catalog\", \"DBInitializer>()); } }\\n\\nprotected void Application_BeginRequest(object sender, EventArgs e) { //set \", \"the property to our new object LogicalThreadContext.Properties[\\\"activityid\\\"] = new ActivityIdHelper(\", \");\\n\\nLogicalThreadContext.Properties[\\\"requestinfo\\\"] = new WebRequestInfo();\\n\\n_log.Debug(\\\"Application_\", \"BeginRequest\\\"); } }\\n\\nThe preceding file becomes the Program.cs file in server-side Blazor:\\n\\n81\\n\\nCHAP\", \"TER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\nusing eShopOnBlazor.Models; using eShopOnBlazor.M\", \"odels.Infrastructure; using eShopOnBlazor.Services; using log4net; using System.Data.Entity; using e\", \"ShopOnBlazor;\\n\\nvar builder = WebApplication.CreateBuilder(args);\\n\\n// add services\\n\\nbuilder.Services.\", \"AddRazorPages(); builder.Services.AddServerSideBlazor();\\n\\nif (builder.Configuration.GetValue<bool>(\\\"\", \"UseMockData\\\")) { builder.Services.AddSingleton<ICatalogService, CatalogServiceMock>(); } else { buil\", \"der.Services.AddScoped<ICatalogService, CatalogService>(); builder.Services.AddScoped<IDatabaseIniti\", \"alizer<CatalogDBContext>, CatalogDBInitializer>(); builder.Services.AddSingleton<CatalogItemHiLoGene\", \"rator>(); builder.Services.AddScoped(_ => new CatalogDBContext(builder.Configuration.GetConnectionSt\", \"ring(\\\"CatalogDBContext\\\"))); }\\n\\nvar app = builder.Build();\\n\\nnew LoggerFactory().AddLog4Net(\\\"log4Net.x\", \"ml\\\");\\n\\nif (app.Environment.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExcep\", \"tionHandler(\\\"/Home/Error\\\"); }\\n\\n// Middleware for Application_BeginRequest app.Use((ctx, next) => { L\", \"ogicalThreadContext.Properties[\\\"activityid\\\"] = new ActivityIdHelper(ctx); LogicalThreadContext.Prope\", \"rties[\\\"requestinfo\\\"] = new WebRequestInfo(ctx); return next(); });\\n\\napp.UseStaticFiles();\\n\\napp.UseRo\", \"uting();\\n\\napp.UseEndpoints(endpoints => { endpoints.MapBlazorHub(); endpoints.MapFallbackToPage(\\\"/_H\", \"ost\\\"); });\\n\\nConfigDataBase(app);\\n\\n82\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\nvoid Co\", \"nfigDataBase(IApplicationBuilder app) { using (var scope = app.ApplicationServices.CreateScope()) { \", \"var initializer = scope.ServiceProvider.GetService<IDatabaseInitializer<CatalogDBContext>>();\\n\\nif (i\", \"nitializer != null) { Database.SetInitializer(initializer); } } }\\n\\napp.Run();\\n\\nOne significant chang\", \"e you may notice from Web Forms is the prominence of dependency injection (DI). DI has been a guidin\", \"g principle in the ASP.NET Core design. It supports customization of almost all aspects of the ASP.N\", \"ET Core framework. There\\u2019s even a built-in service provider that can be used for many scenarios. If \", \"more customization is required, it can be supported by many community projects. For example, you can\", \" carry forward your third-party DI library investment.\\n\\nIn the original eShop app, there\\u2019s some conf\", \"iguration for session management. Since server-side Blazor uses ASP.NET Core SignalR for communicati\", \"on, the session state isn\\u2019t supported as the connections may occur independent of an HTTP context. A\", \"n app that uses the session state requires rearchitecting before running as a Blazor app.\\n\\nFor more \", \"information about app startup, see App startup.\\n\\nMigrate HTTP modules and handlers to middleware\\n\\nHT\", \"TP modules and handlers are common patterns in Web Forms to control the HTTP request pipeline. Class\", \"es that implement IHttpModule or IHttpHandler could be registered and process incoming requests. Web\", \" Forms configure modules and handlers in the web.config file. Web Forms is also heavily based on app\", \" lifecycle event handling. ASP.NET Core uses middleware instead. Middleware is registered in the Con\", \"figure method of the Startup class. Middleware execution order is determined by the registration ord\", \"er.\\n\\nIn the Enable startup process section, a lifecycle event was raised by Web Forms as the Applica\", \"tion_BeginRequest method. This event isn\\u2019t available in ASP.NET Core. One way to achieve this behavi\", \"or is to implement middleware as seen in the Startup.cs file example. This middleware does the same \", \"logic and then transfers control to the next handler in the middleware pipeline.\\n\\nFor more informati\", \"on on migrating modules and handlers, see Migrate HTTP handlers and modules to ASP.NET Core middlewa\", \"re.\\n\\n83\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\nMigrate static files\\n\\nTo serve stati\", \"c files (for example, HTML, CSS, images, and JavaScript), the files must be exposed by middleware. C\", \"alling the UseStaticFiles method enables the serving of static files from the web root path. The def\", \"ault web root directory is wwwroot, but it can be customized. As included in the Program.cs file:\\n\\n.\", \"..\\n\\napp.UseStaticFiles();\\n\\n...\\n\\nThe eShop project enables basic static file access. There are many c\", \"ustomizations available for static file access. For information on enabling default files or a file \", \"browser, see Static files in ASP.NET Core.\\n\\nMigrate runtime bundling and minification setup\\n\\nBundlin\", \"g and minification are performance optimization techniques for reducing the number and size of serve\", \"r requests to retrieve certain file types. JavaScript and CSS often undergo some form of bundling or\", \" minification before being sent to the client. In ASP.NET Web Forms, these optimizations are handled\", \" at run time. The optimization conventions are defined an App_Start/BundleConfig.cs file. In ASP.NET\", \" Core, a more declarative approach is adopted. A file lists the files to be minified, along with spe\", \"cific minification settings.\\n\\nFor more information on bundling and minification, see Bundle and mini\", \"fy static assets in ASP.NET Core.\\n\\nMigrate ASPX pages\\n\\nA page in a Web Forms app is a file with the \", \".aspx extension. A Web Forms page can often be mapped to a component in Blazor. A Razor component is\", \" authored in a file with the .razor extension. For the eShop project, five pages are converted to a \", \"Razor page.\\n\\nFor example, the details view comprises three files in the Web Forms project: Details.a\", \"spx, Details.aspx.cs, and Details.aspx.designer.cs. When converting to Blazor, the code-behind and m\", \"arkup are combined into Details.razor. Razor compilation (equivalent to what\\u2019s in .designer.cs files\", \") is stored in the obj directory and isn\\u2019t, by default, viewable in Solution Explorer. The Web Forms\", \" page consists of the following markup:\\n\\n<%@ Page Title=\\\"Details\\\" Language=\\\"C#\\\" MasterPageFile=\\\"~/Si\", \"te.Master\\\" AutoEventWireup=\\\"true\\\" CodeBehind=\\\"Details.aspx.cs\\\" Inherits=\\\"eShopLegacyWebForms.Catalog\", \".Details\\\" %>\\n\\n<asp:Content ID=\\\"Details\\\" ContentPlaceHolderID=\\\"MainContent\\\" runat=\\\"server\\\"> <h2 class\", \"=\\\"esh-body-title\\\">Details</h2>\\n\\n<div class=\\\"container\\\"> <div class=\\\"row\\\">\\n\\n84\\n\\nCHAPTER 14 | Migrate \", \"from ASP.NET Web Forms to Blazor\\n\\n<asp:Image runat=\\\"server\\\" CssClass=\\\"col-md-6 esh-picture\\\" ImageUrl\", \"='<%#\\\"/Pics/\\\" + product.PictureFileName%>' /> <dl class=\\\"col-md-6 dl-horizontal\\\"> <dt>Name </dt>\\n\\n<d\", \"d> <asp:Label runat=\\\"server\\\" Text='<%#product.Name%>' /> </dd>\\n\\n<dt>Description </dt>\\n\\n<dd> <asp:Lab\", \"el runat=\\\"server\\\" Text='<%#product.Description%>' /> </dd>\\n\\n<dt>Brand </dt>\\n\\n<dd> <asp:Label runat=\\\"\", \"server\\\" Text='<%#product.CatalogBrand.Brand%>' /> </dd>\\n\\n<dt>Type </dt>\\n\\n<dd> <asp:Label runat=\\\"serv\", \"er\\\" Text='<%#product.CatalogType.Type%>' /> </dd> <dt>Price </dt>\\n\\n<dd> <asp:Label CssClass=\\\"esh-pri\", \"ce\\\" runat=\\\"server\\\" Text='<%#product.Price%>' /> </dd>\\n\\n<dt>Picture name </dt>\\n\\n<dd> <asp:Label runat\", \"=\\\"server\\\" Text='<%#product.PictureFileName%>' /> </dd>\\n\\n<dt>Stock </dt>\\n\\n<dd> <asp:Label runat=\\\"serv\", \"er\\\" Text='<%#product.AvailableStock%>' /> </dd>\\n\\n<dt>Restock </dt>\\n\\n<dd> <asp:Label runat=\\\"server\\\" T\", \"ext='<%#product.RestockThreshold%>' /> </dd>\\n\\n<dt>Max stock </dt>\\n\\n85\\n\\nCHAPTER 14 | Migrate from ASP\", \".NET Web Forms to Blazor\\n\\n<dd> <asp:Label runat=\\\"server\\\" Text='<%#product.MaxStockThreshold%>' /> </\", \"dd>\\n\\n</dl> </div>\\n\\n<div class=\\\"form-actions no-color esh-link-list\\\"> <a runat=\\\"server\\\" href='<%# Get\", \"RouteUrl(\\\"EditProductRoute\\\", new {id =product.Id}) %>' class=\\\"esh-link-item\\\">Edit </a> | <a runat=\\\"s\", \"erver\\\" href=\\\"~\\\" class=\\\"esh-link-item\\\">Back to list </a> </div>\\n\\n</div> </asp:Content>\\n\\nThe preceding\", \" markup\\u2019s code-behind includes the following code:\\n\\nusing eShopLegacyWebForms.Models; using eShopLeg\", \"acyWebForms.Services; using log4net; using System; using System.Web.UI;\\n\\nnamespace eShopLegacyWebFor\", \"ms.Catalog { public partial class Details : System.Web.UI.Page { private static readonly ILog _log =\", \" LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);\\n\\nprotected Cat\", \"alogItem product;\\n\\npublic ICatalogService CatalogService { get; set; }\\n\\nprotected void Page_Load(obj\", \"ect sender, EventArgs e) { var productId = Convert.ToInt32(Page.RouteData.Values[\\\"id\\\"]); _log.Info($\", \"\\\"Now loading... /Catalog/Details.aspx?id={productId}\\\"); product = CatalogService.FindCatalogItem(pro\", \"ductId);\\n\\nthis.DataBind(); } } }\\n\\nWhen converted to Blazor, the Web Forms page translates to the fol\", \"lowing code:\\n\\n@page \\\"/Catalog/Details/{id:int}\\\" @inject ICatalogService CatalogService @inject ILogg\", \"er<Details> Logger\\n\\n<h2 class=\\\"esh-body-title\\\">Details</h2>\\n\\n<div class=\\\"container\\\"> <div class=\\\"row\", \"\\\">\\n\\n86\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\n<img class=\\\"col-md-6 esh-picture\\\" src\", \"=\\\"@($\\\"/Pics/{_item.PictureFileName}\\\")\\\">\\n\\n<dl class=\\\"col-md-6 dl-horizontal\\\"> <dt> Name </dt>\\n\\n<dd> @\", \"_item.Name </dd>\\n\\n<dt> Description </dt>\\n\\n<dd> @_item.Description </dd>\\n\\n<dt> Brand </dt>\\n\\n<dd> @_it\", \"em.CatalogBrand.Brand </dd>\\n\\n<dt> Type </dt>\\n\\n<dd> @_item.CatalogType.Type </dd> <dt> Price </dt>\\n\\n<\", \"dd> @_item.Price </dd>\\n\\n<dt> Picture name </dt>\\n\\n<dd> @_item.PictureFileName </dd>\\n\\n<dt> Stock </dt>\", \"\\n\\n<dd> @_item.AvailableStock </dd>\\n\\n<dt> Restock </dt>\\n\\n87\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Fo\", \"rms to Blazor\\n\\n<dd> @_item.RestockThreshold </dd>\\n\\n<dt> Max stock </dt>\\n\\n<dd> @_item.MaxStockThresho\", \"ld </dd>\\n\\n</dl> </div>\\n\\n<div class=\\\"form-actions no-color esh-link-list\\\"> <a href=\\\"@($\\\"/Catalog/Edit\", \"/{_item.Id}\\\")\\\" class=\\\"esh-link-item\\\"> Edit </a> | <a href=\\\"/\\\" class=\\\"esh-link-item\\\"> Back to list </\", \"a> </div>\\n\\n</div>\\n\\n@code { private CatalogItem _item;\\n\\n[Parameter] public int Id { get; set; }\\n\\nprot\", \"ected override void OnInitialized() { Logger.LogInformation(\\\"Now loading... /Catalog/Details/{Id}\\\", \", \"Id);\\n\\n_item = CatalogService.FindCatalogItem(Id); } }\\n\\nNotice that the code and markup are in the sa\", \"me file. Any required services are made accessible with the @inject attribute. Per the @page directi\", \"ve, this page can be accessed at the Catalog/Details/{id} route. The value of the route\\u2019s {id} place\", \"holder has been constrained to an integer. As described in the routing section, unlike Web Forms, a \", \"Razor component explicitly states its route and any parameters that are included. Many Web Forms con\", \"trols may not have exact counterparts in Blazor. There\\u2019s often an equivalent HTML snippet that will \", \"serve the same purpose. For example, the <asp:Label /> control can be replaced with an HTML <label> \", \"element.\\n\\nModel validation in Blazor\\n\\nIf your Web Forms code includes validation, you can transfer m\", \"uch of what you have with little-to-no changes. A benefit to running in Blazor is that the same vali\", \"dation logic can be run without needing custom JavaScript. Data annotations enable easy model valida\", \"tion.\\n\\n88\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\nFor example, the Create.aspx page \", \"has a data entry form with validation. An example snippet would look like this:\\n\\n<div class=\\\"form-gr\", \"oup\\\"> <label class=\\\"control-label col-md-2\\\">Name</label> <div class=\\\"col-md-3\\\"> <asp:TextBox ID=\\\"Nam\", \"e\\\" runat=\\\"server\\\" CssClass=\\\"form-control\\\"></asp:TextBox> <asp:RequiredFieldValidator runat=\\\"server\\\" \", \"ControlToValidate=\\\"Name\\\" Display=\\\"Dynamic\\\" CssClass=\\\"field-validation-valid text-danger\\\" ErrorMessag\", \"e=\\\"The Name field is required.\\\" /> </div> </div>\\n\\nIn Blazor, the equivalent markup is provided in a \", \"Create.razor file:\\n\\n<EditForm Model=\\\"_item\\\" OnValidSubmit=\\\"@...\\\"> <DataAnnotationsValidator />\\n\\n<div\", \" class=\\\"form-group\\\"> <label class=\\\"control-label col-md-2\\\">Name</label> <div class=\\\"col-md-3\\\"> <Inpu\", \"tText class=\\\"form-control\\\" @bind-Value=\\\"_item.Name\\\" /> <ValidationMessage For=\\\"(() => _item.Name)\\\" /\", \"> </div> </div>\\n\\n... </EditForm>\\n\\nThe EditForm context includes validation support and can be wrappe\", \"d around an input. Data annotations are a common way to add validation. Such validation support can \", \"be added via the DataAnnotationsValidator component. For more information on this mechanism, see ASP\", \".NET Core Blazor forms and validation.\\n\\nMigrate configuration\\n\\nIn a Web Forms project, configuration\", \" data is most commonly stored in the web.config file. The configuration data is accessed with Config\", \"urationManager. Services were often required to parse objects. With .NET Framework 4.7.2, composabil\", \"ity was added to the configuration via ConfigurationBuilders. These builders allowed developers to a\", \"dd various sources for the configuration that was then composed at run time to retrieve the necessar\", \"y values.\\n\\nASP.NET Core introduced a flexible configuration system that allows you to define the con\", \"figuration source or sources used by your app and deployment. The ConfigurationBuilder infrastructur\", \"e that you may be using in your Web Forms app was modeled after the concepts used in the ASP.NET Cor\", \"e configuration system.\\n\\nThe following snippet demonstrates how the Web Forms eShop project uses web\", \".config to store configuration values:\\n\\n<configuration> <configSections> <section name=\\\"entityFramew\", \"ork\\\"\\n\\n89\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms to Blazor\\n\\ntype=\\\"System.Data.Entity.Internal.C\", \"onfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=\", \"b77a5c561934e089\\\" requirePermission=\\\"false\\\" /> </configSections> <connectionStrings> <add name=\\\"Cata\", \"logDBContext\\\" connectionString=\\\"Data Source=(localdb)\\\\MSSQLLocalDB; Initial Catalog=Microsoft.eShopO\", \"nContainers.Services.CatalogDb; Integrated Security=True; MultipleActiveResultSets=True;\\\" providerNa\", \"me=\\\"System.Data.SqlClient\\\" /> </connectionStrings> <appSettings> <add key=\\\"UseMockData\\\" value=\\\"true\\\"\", \" /> <add key=\\\"UseCustomizationData\\\" value=\\\"false\\\" /> </appSettings> </configuration>\\n\\nIt\\u2019s common fo\", \"r secrets, such as database connection strings, to be stored within the web.config. The secrets are \", \"inevitably persisted in unsecure locations, such as source control. With Blazor on ASP.NET Core, the\", \" preceding XML-based configuration is replaced with the following JSON:\\n\\n{ \\\"ConnectionStrings\\\": { \\\"C\", \"atalogDBContext\\\": \\\"Data Source=(localdb)\\\\\\\\MSSQLLocalDB; Initial Catalog=Microsoft.eShopOnContainers.\", \"Services.CatalogDb; Integrated Security=True; MultipleActiveResultSets=True;\\\" }, \\\"UseMockData\\\": true\", \", \\\"UseCustomizationData\\\": false }\\n\\nJSON is the default configuration format; however, ASP.NET Core s\", \"upports many other formats, including XML. There are also several community-supported formats.\\n\\nYou \", \"can access configuration values from the builder in Program.cs:\\n\\nif (builder.Configuration.GetValue<\", \"bool>(\\\"UseMockData\\\")) { builder.Services.AddSingleton<ICatalogService, CatalogServiceMock>(); } else\", \" { builder.Services.AddScoped<ICatalogService, CatalogService>(); builder.Services.AddScoped<IDataba\", \"seInitializer<CatalogDBContext>, CatalogDBInitializer>(); builder.Services.AddSingleton<CatalogItemH\", \"iLoGenerator>(); builder.Services.AddScoped(_ => new CatalogDBContext(builder.Configuration.GetConne\", \"ctionString(\\\"CatalogDBContext\\\"))); }\\n\\nBy default, environment variables, JSON files (appsettings.jso\", \"n and appsettings.{Environment}.json), and command-line options are registered as valid configuratio\", \"n sources in the configuration object. The configuration sources can be accessed via Configuration[k\", \"ey]. A more advanced technique is to bind the configuration data to objects using the options patter\", \"n. For more information on configuration and the options pattern, see Configuration in ASP.NET Core \", \"and Options pattern in ASP.NET Core, respectively.\\n\\n90\\n\\nCHAPTER 14 | Migrate from ASP.NET Web Forms \", \"to Blazor\\n\\nMigrate data access\\n\\nData access is an important aspect of any app. The eShop project sto\", \"res catalog information in a database and retrieves the data with Entity Framework (EF) 6. Since EF \", \"6 is supported in .NET 5, the project can continue to use it.\\n\\nThe following EF-related changes were\", \" necessary to eShop:\\n\\n\\n\\nIn .NET Framework, the DbContext object accepts a string of the form name=Co\", \"nnectionString and uses the connection string from ConfigurationManager.AppSettings[ConnectionString\", \"] to connect. In .NET Core, this isn\\u2019t supported. The connection string must be supplied.\\n\\n\\n\\nThe dat\", \"abase was accessed in a synchronous way. Though this works, scalability may suffer. This logic shoul\", \"d be moved to an asynchronous pattern.\\n\\nAlthough there isn\\u2019t the same native support for dataset bin\", \"ding, Blazor provides flexibility and power with its C# support in a Razor page. For example, you ca\", \"n perform calculations and display the result. For more information on data patterns in Blazor, see \", \"the Data access chapter.\\n\\nArchitectural changes\\n\\nFinally, there are some important architectural dif\", \"ferences to consider when migrating to Blazor. Many of these changes are applicable to anything base\", \"d on .NET Core or ASP.NET Core.\\n\\nBecause Blazor is built on .NET Core, there are considerations in e\", \"nsuring support on .NET Core. Some of the major changes include the removal of the following feature\", \"s:\\n\\nMultiple AppDomains\\n\\n\\n\\nRemoting\\n\\n\\n\\nCode Access Security (CAS)\\n\\n\\n\\nSecurity Transparency\\n\\nFor more\", \" information on techniques to identify necessary changes to support running on .NET Core, see Port y\", \"our code from .NET Framework to .NET Core.\\n\\nASP.NET Core is a reimagined version of ASP.NET and has \", \"some changes that may not initially seem obvious. The main changes are:\\n\\n\\n\\nNo synchronization contex\", \"t, which means there\\u2019s no HttpContext.Current, Thread.CurrentPrincipal, or other static accessors\\n\\n\\n\", \"\\nNo shadow copying\\n\\n\\n\\nNo request queue\\n\\nMany operations in ASP.NET Core are asynchronous, which allo\", \"ws easier off-loading of I/O-bound tasks. It\\u2019s important to never block by using Task.Wait() or Task\", \".GetResult(), which can quickly exhaust thread pool resources.\\n\\n91\\n\\nCHAPTER 14 | Migrate from ASP.NE\", \"T Web Forms to Blazor\\n\\nMigration conclusion\\n\\nAt this point, you\\u2019ve seen many examples of what it tak\", \"es to move a Web Forms project to Blazor. For a full example, see the eShopOnBlazor project.\\n\\n92\\n\\nCH\", \"APTER 14 | Migrate from ASP.NET Web Forms to Blazor\"]"