,0
0,public IContainerProvider ContainerProvider
1,{
2,get { return _containerProvider; }
3,}
4,
5,"protected void Application_Start(object sender, EventArgs e)"
6,{
7,// Code that runs on app startup
8,RouteConfig.RegisterRoutes(RouteTable.Routes);
9,BundleConfig.RegisterBundles(BundleTable.Bundles);
10,ConfigureContainer();
11,ConfigDataBase();
12,}
13,
14,/// <summary>
15,/// Track the machine name and the start time for the session inside the current
16,session
17,/// </summary>
18,"protected void Session_Start(Object sender, EventArgs e)"
19,{
20,"HttpContext.Current.Session[""MachineName""] = Environment.MachineName;"
21,"HttpContext.Current.Session[""SessionStartTime""] = DateTime.Now;"
22,}
23,
24,/// <summary>
25,/// https://autofaccn.readthedocs.io/en/latest/integration/webforms.html
26,/// </summary>
27,private void ConfigureContainer()
28,{
29,var builder = new ContainerBuilder();
30,"var mockData = bool.Parse(ConfigurationManager.AppSettings[""UseMockData""]);"
31,builder.RegisterModule(new ApplicationModule(mockData));
32,container = builder.Build();
33,_containerProvider = new ContainerProvider(container);
34,}
35,
36,private void ConfigDataBase()
37,{
38,"var mockData = bool.Parse(ConfigurationManager.AppSettings[""UseMockData""]);"
39,
40,if (!mockData)
41,{
42,
43,Database.SetInitializer<CatalogDBContext>(container.Resolve<CatalogDBInitializer>());
44,}
45,}
46,
47,"protected void Application_BeginRequest(object sender, EventArgs e)"
48,{
49,//set the property to our new object
50,"LogicalThreadContext.Properties[""activityid""] = new ActivityIdHelper();"
51,
52,"LogicalThreadContext.Properties[""requestinfo""] = new WebRequestInfo();"
53,
54,"_log.Debug(""Application_BeginRequest"");"
55,}
56,}
