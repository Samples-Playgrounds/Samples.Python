var builder = WebApplication.CreateBuilder(args); var serverCert = ObtainServerCertificate(); builder.WebHost.UseKestrel(kestrelServerOptions => { kestrelServerOptions.ConfigureHttpsDefaults(opt => { opt.ClientCertificateMode = ClientCertificateMode.RequireCertificate; // Verify that client certificate was issued by same CA as server certificate opt.ClientCertificateValidation = (certificate, chain, errors) => certificate.Issuer == serverCert.Issuer; }); });