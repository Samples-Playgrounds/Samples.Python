static unsafe bool Contains(ReadOnlySpan<byte> haystack, byte needle) { if (Vector128.IsHardwareAccelerated && haystack.Length >= Vector128<byte>.Count) { ref byte current = ref MemoryMarshal.GetReference(haystack); if (Vector256.IsHardwareAccelerated && haystack.Length >= Vector256<byte>.Count) { Vector256<byte> target = Vector256.Create(needle); ref byte endMinusOneVector = ref Unsafe.Add( ref current, haystack.Length Vector256<byte>.Count); do { if (Vector256.EqualsAny(target, Vector256.LoadUnsafe( ref current))) { return true ; } current = ref Unsafe.Add( ref current, Vector256<byte>.Count); } while (Unsafe.IsAddressLessThan( ref current, ref endMinusOneVector));