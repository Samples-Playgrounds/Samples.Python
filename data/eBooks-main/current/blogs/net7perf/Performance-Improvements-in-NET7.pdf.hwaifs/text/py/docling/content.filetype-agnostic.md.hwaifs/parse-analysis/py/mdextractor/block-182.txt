SafeFileHandle handle = Interop.CreateFile(); if (handle.IsInvalid) { int lastError = Marshal.GetLastPInvokeError(); handle.Dispose(); // or handle.SetHandleAsInvalid() throw new UhOhException(lastError); } return handle;