|    | 0                                                                                   |
|---:|:------------------------------------------------------------------------------------|
|  0 | private readonly Activity _activity;                                                |
|  1 |                                                                                     |
|  2 | public Program()                                                                    |
|  3 | {                                                                                   |
|  4 | using ActivitySource activitySource = new ActivitySource("Perf7Source");            |
|  5 | ActivitySource.AddActivityListener(new ActivityListener                             |
|  6 | {                                                                                   |
|  7 | ShouldListenTo = s => s == activitySource,                                          |
|  8 | Sample = (ref ActivityCreationOptions<ActivityContext> o) =>                        |
|  9 | ActivitySamplingResult.AllDataAndRecorded                                           |
| 10 | });                                                                                 |
| 11 |                                                                                     |
| 12 | _activity = activitySource.StartActivity(                                           |
| 13 | "TestActivity",                                                                     |
| 14 | ActivityKind.Internal,                                                              |
| 15 | parentContext: default,                                                             |
| 16 | links: Enumerable.Range(0, 1024).Select(_ => new ActivityLink(default)).ToArray()); |
| 17 | _activity.Stop();                                                                   |
| 18 | }                                                                                   |
| 19 |                                                                                     |
| 20 | [Benchmark(Baseline = true)]                                                        |
| 21 | public ActivityLink EnumerateActivityLinks()                                        |
| 22 | {                                                                                   |
| 23 | ActivityLink last = default;                                                        |
| 24 | foreach (ActivityLink link in _activity.Links) last = link;                         |
| 25 | return last;                                                                        |
| 26 | }                                                                                   |