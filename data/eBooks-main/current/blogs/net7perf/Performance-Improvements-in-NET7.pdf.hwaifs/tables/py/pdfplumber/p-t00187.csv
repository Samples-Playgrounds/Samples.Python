,0
0,public static void Work(Stream s) =>
1,"A(s, useAsyunc: false).GetAwaiter().GetResult(); // GetResult() to propagate any"
2,exceptions
3,
4,public static Task WorkAsync(Stream S) =>
5,"A(s, useAsync: true);"
6,
7,"internal static async Task A(Stream s, bool useAsync)"
8,{
9,...
10,"await B(s, useAsync);"
11,...
12,}
13,
14,"private static async Task B(Stream s, bool useAsync)"
15,{
16,...
17,int bytesRead = useAsync ?
18,await s.ReadAsync(buffer) :
19,s.Read(buffer.Span);
20,...
21,}
