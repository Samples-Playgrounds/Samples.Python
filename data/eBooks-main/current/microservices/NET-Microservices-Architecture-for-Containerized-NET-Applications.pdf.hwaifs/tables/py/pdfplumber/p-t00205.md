|    | 0                                                               |
|---:|:----------------------------------------------------------------|
|  0 | using Dapper;                                                   |
|  1 | using Microsoft.Extensions.Configuration;                       |
|  2 | using System.Data.SqlClient;                                    |
|  3 | using System.Threading.Tasks;                                   |
|  4 | using System.Dynamic;                                           |
|  5 | using System.Collections.Generic;                               |
|  6 |                                                                 |
|  7 | public class OrderQueries : IOrderQueries                       |
|  8 | {                                                               |
|  9 | public async Task<IEnumerable<dynamic>> GetOrdersAsync()        |
| 10 | {                                                               |
| 11 | using (var connection = new SqlConnection(_connectionString))   |
| 12 | {                                                               |
| 13 | connection.Open();                                              |
| 14 | return await connection.QueryAsync<dynamic>(                    |
| 15 | @"SELECT o.[Id] as ordernumber,                                 |
| 16 | o.[OrderDate] as [date],os.[Name] as [status],                  |
| 17 | SUM(oi.units*oi.unitprice) as total                             |
| 18 | FROM [ordering].[Orders] o                                      |
| 19 | LEFT JOIN[ordering].[orderitems] oi ON o.Id = oi.orderid        |
| 20 | LEFT JOIN[ordering].[orderstatus] os on o.OrderStatusId = os.Id |