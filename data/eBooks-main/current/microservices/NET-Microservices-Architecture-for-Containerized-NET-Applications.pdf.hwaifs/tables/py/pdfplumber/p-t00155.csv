,0
0,"public class EventBusRabbitMQ : IEventBus, IDisposable"
1,{
2,// Member objects and other methods ...
3,// ...
4,
5,"public void Subscribe<T, TH>()"
6,where T : IntegrationEvent
7,where TH : IIntegrationEventHandler<T>
8,{
9,var eventName = _subsManager.GetEventKey<T>();
10,
11,var containsKey = _subsManager.HasSubscriptionsForEvent(eventName);
12,if (!containsKey)
13,{
14,if (!_persistentConnection.IsConnected)
15,{
16,_persistentConnection.TryConnect();
17,}
18,
19,using (var channel = _persistentConnection.CreateModel())
20,{
21,"channel.QueueBind(queue: _queueName,"
22,"exchange: BROKER_NAME,"
23,routingKey: eventName);
24,}
25,}
26,
27,"_subsManager.AddSubscription<T, TH>();"
28,}
29,}
