,0
0,public class CatalogIntegrationEventService : ICatalogIntegrationEventService
1,{
2,//â€¦
3,public async Task SaveEventAndCatalogContextChangesAsync(
4,IntegrationEvent evt)
5,{
6,// Use of an EF Core resiliency strategy when using multiple DbContexts
7,// within an explicit BeginTransaction():
8,// https://learn.microsoft.com/ef/core/miscellaneous/connection-resiliency
9,await ResilientTransaction.New(_catalogContext).ExecuteAsync(async () =>
10,{
11,// Achieving atomicity between original catalog database
12,// operation and the IntegrationEventLog thanks to a local transaction
13,await _catalogContext.SaveChangesAsync();
14,"await _eventLogService.SaveEventAsync(evt,"
15,_catalogContext.Database.CurrentTransaction.GetDbTransaction());
16,});
17,}
18,}
