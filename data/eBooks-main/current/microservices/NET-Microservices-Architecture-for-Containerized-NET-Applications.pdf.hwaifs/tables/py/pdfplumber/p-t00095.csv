,0
0,1 FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base
1,2 WORKDIR /app
2,3 EXPOSE 80
3,4
4,5 FROM mcr.microsoft.com/dotnet/sdk:7.0 AS build
5,6 WORKDIR /src
6,7 COPY src/Services/Catalog/Catalog.API/Catalog.API.csproj …
7,8 COPY src/BuildingBlocks/HealthChecks/src/Microsoft.AspNetCore.HealthChecks …
8,9 COPY src/BuildingBlocks/HealthChecks/src/Microsoft.Extensions.HealthChecks …
9,10 COPY src/BuildingBlocks/EventBus/IntegrationEventLogEF/ …
10,11 COPY src/BuildingBlocks/EventBus/EventBus/EventBus.csproj …
11,12 COPY src/BuildingBlocks/EventBus/EventBusRabbitMQ/EventBusRabbitMQ.csproj …
12,13 COPY src/BuildingBlocks/EventBus/EventBusServiceBus/EventBusServiceBus.csproj …
13,14 COPY src/BuildingBlocks/WebHostCustomization/WebHost.Customization …
14,15 COPY src/BuildingBlocks/HealthChecks/src/Microsoft.Extensions …
15,16 COPY src/BuildingBlocks/HealthChecks/src/Microsoft.Extensions …
16,17 RUN dotnet restore src/Services/Catalog/Catalog.API/Catalog.API.csproj
17,18 COPY . .
18,19 WORKDIR /src/src/Services/Catalog/Catalog.API
19,20 RUN dotnet build Catalog.API.csproj -c Release -o /app
20,21
21,22 FROM build AS publish
22,23 RUN dotnet publish Catalog.API.csproj -c Release -o /app
23,24
24,25 FROM base AS final
25,26 WORKDIR /app
26,27 COPY --from=publish /app .
27,"28 ENTRYPOINT [""dotnet"", ""Catalog.API.dll""]"
