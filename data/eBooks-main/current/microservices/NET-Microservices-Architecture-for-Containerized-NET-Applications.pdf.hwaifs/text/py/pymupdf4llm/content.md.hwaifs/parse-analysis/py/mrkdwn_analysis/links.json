{'Text link': [{'line': 4, 'text': 'Refer changelog', 'url': 'https://aka.ms/MicroservicesEbookChangelog'}, {'line': 12, 'text': 'eShopOnContainers', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers'}, {'line': 44, 'text': 'In addition, the microservices architecture is emerging as an important approach for distributed', 'url': 'https://martinfowler.com/articles/microservices.html'}, {'line': 50, 'text': 'sample application is available at the eShopOnContainers', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers'}, {'line': 76, 'text': 'complementary guide Containerized Docker Application Lifecycle with Microsoft Platform and Tools', 'url': 'https://aka.ms/dockerlifecycleebook'}, {'line': 189, 'text': '- Software Architect and Trainer - Ardalis.com', 'url': 'https://ardalis.com/'}, {'line': 257, 'text': 'Microsoft and the trademarks listed at https://www.microsoft.com', 'url': 'https://www.microsoft.com/'}, {'line': 1109, 'text': 'Docker', 'url': 'https://www.docker.com/'}, {'line': 1109, 'text': 'is an open-source project for automating the deployment of applications as portable, self-', 'url': 'https://github.com/docker/docker'}, {'line': 1109, 'text': 'sufficient containers that can run on the cloud or on-premises. Docker is also a company that', 'url': 'https://www.docker.com/'}, {'line': 1138, 'text': 'ships Docker Desktop for Windows', 'url': 'https://hub.docker.com/editions/community/docker-ce-desktop-windows'}, {'line': 1138, 'text': 'or for macOS. These products install the necessary VM (the Docker', 'url': 'https://hub.docker.com/editions/community/docker-ce-desktop-mac'}, {'line': 1143, 'text': 'To run Windows Containers, there are two types of runtimes:', 'url': 'https://docs.microsoft.com/virtualization/windowscontainers/about/'}, {'line': 1269, 'text': 'For further definitions, see the extensive glossary', 'url': 'https://docs.docker.com/glossary/'}, {'line': 1328, 'text': 'Docker Hub', 'url': 'https://hub.docker.com/'}, {'line': 1334, 'text': ': For multi-architecture (or multi-platform), it’s a Docker feature that simplifies the', 'url': 'https://docs.docker.com/build/building/multi-platform/'}, {'line': 1356, 'text': 'and Windows Containers. The Linux Docker host on Windows is based on a Hyper-V virtual machine.', 'url': 'https://www.microsoft.com/cloud-platform/server-virtualization'}, {'line': 1356, 'text': 'the Apple Hypervisor framework and the xhyve hypervisor, which provides a Linux Docker host virtual', 'url': 'https://github.com/mist64/xhyve'}, {'line': 1402, 'text': 'deploying to production orchestrators. Docker maintains a public registry via Docker Hub; other', 'url': 'https://hub.docker.com/'}, {'line': 1402, 'text': 'vendors provide registries for different collections of images, including Azure Container Registry.', 'url': 'https://azure.microsoft.com/services/container-registry/'}, {'line': 1452, 'text': '.NET: .NET Framework and .NET 7. They share many .NET platform components, and you can share', 'url': 'https://dotnet.microsoft.com/download'}, {'line': 1550, 'text': 'Visual Studio', 'url': 'https://www.visualstudio.com/vs/'}, {'line': 1554, 'text': 'Visual Studio for Mac', 'url': 'https://www.visualstudio.com/vs/visual-studio-mac/'}, {'line': 1559, 'text': 'You can also use Visual Studio Code on macOS, Linux, and Windows. Visual Studio Code fully', 'url': 'https://code.visualstudio.com/'}, {'line': 1566, 'text': '.NET CLI. You can also target .NET 7 with most third-party editors like Sublime, Emacs, vi, and the', 'url': 'https://docs.microsoft.com/dotnet/core/tools/'}, {'line': 1571, 'text': 'In addition to the IDEs and editors, you can use the .NET CLI', 'url': 'https://docs.microsoft.com/dotnet/core/tools/'}, {'line': 1585, 'text': 'Windows Server Core container images have been reduced to >40% smaller.', 'url': 'https://devblogs.microsoft.com/dotnet/we-made-windows-server-core-container-images-40-smaller'}, {'line': 1599, 'text': 'footprint, to have a small Bounded Context (check DDD, Domain-Driven Design), to represent a small', 'url': 'https://en.wikipedia.org/wiki/Domain-driven_design'}, {'line': 1652, 'text': 'Third-party libraries are quickly embracing .NET Standard, which enables code sharing across all .NET', 'url': 'https://docs.microsoft.com/dotnet/standard/net-standard'}, {'line': 1652, 'text': 'can also directly reference existing .NET Framework libraries (see .NET Framework 4.6.1 supporting', 'url': 'https://github.com/dotnet/standard/blob/v2.1.0/docs/planning/netstandard-2.0/README.md#net-framework-461-supporting-net-standard-20'}, {'line': 1652, 'text': '.NET Standard 2.0).', 'url': 'https://github.com/dotnet/standard/blob/v2.1.0/docs/planning/netstandard-2.0/README.md#net-framework-461-supporting-net-standard-20'}, {'line': 1659, 'text': 'In addition, the Windows Compatibility Pack extends the API surface available for .NET Standard 2.0', 'url': 'https://docs.microsoft.com/dotnet/core/porting/windows-compat-pack'}, {'line': 1700, 'text': 'the available Azure SDKs in the Azure SDK Latest Releases', 'url': 'https://azure.github.io/azure-sdk/releases/latest/index.html'}, {'line': 1712, 'text': 'to .NET Core or .NET 5+, see Porting Existing ASP.NET Apps to .NET Core.', 'url': 'https://docs.microsoft.com/dotnet/architecture/porting-existing-aspnet-apps/'}, {'line': 1815, 'text': 'publicly available on Microsoft Artifact Registry. You can search over the catalog to find all .NET image', 'url': 'https://mcr.microsoft.com/'}, {'line': 1815, 'text': 'repositories, for example .NET SDK', 'url': 'https://mcr.microsoft.com/product/dotnet/sdk/about'}, {'line': 1934, 'text': 'When you design a container image, you’ll see an ENTRYPOINT', 'url': 'https://docs.docker.com/engine/reference/builder/#entrypoint'}, {'line': 1934, 'text': 'implemented as Azure WebJobs.', 'url': 'https://github.com/Azure/azure-webjobs-sdk/wiki'}, {'line': 1950, 'text': 'container that launches as many programs as needed. For example, you can use Supervisor or a', 'url': 'http://supervisord.org/'}, {'line': 2020, 'text': 'Additionally, using Azure virtual machine scale sets, you can easily scale the VMs. Azure App Service', 'url': 'https://azure.microsoft.com/documentation/services/virtual-machine-scale-sets/'}, {'line': 2116, 'text': 'From the Docker host, as Docker Volumes:', 'url': 'https://docs.docker.com/engine/admin/volumes/'}, {'line': 2255, 'text': 'large central brokers, central orchestrators at the organization level, and the Enterprise Service Bus', 'url': 'https://en.wikipedia.org/wiki/Enterprise_service_bus'}, {'line': 2255, 'text': '(ESB)', 'url': 'https://en.wikipedia.org/wiki/Enterprise_service_bus'}, {'line': 2268, 'text': 'communicates with other processes using protocols such as HTTP/HTTPS, WebSockets, or AMQP.', 'url': 'https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol'}, {'line': 2392, 'text': 'This principle is similar in Domain-driven design (DDD), where each Bounded Context or autonomous', 'url': 'https://en.wikipedia.org/wiki/Domain-driven_design'}, {'line': 2415, 'text': 'A monolithic application with typically a single relational database has two important benefits: ACID', 'url': 'https://en.wikipedia.org/wiki/ACID'}, {'line': 2415, 'text': 'transactions', 'url': 'https://en.wikipedia.org/wiki/ACID'}, {'line': 2444, 'text': 'is sometimes called the polyglot persistence approach.', 'url': 'https://martinfowler.com/bliki/PolyglotPersistence.html'}, {'line': 2461, 'text': 'The concept of microservice derives from the Bounded Context (BC) pattern', 'url': 'https://martinfowler.com/bliki/BoundedContext.html'}, {'line': 2461, 'text': 'in domain-driven design', 'url': 'https://en.wikipedia.org/wiki/Domain-driven_design'}, {'line': 2461, 'text': '(DDD). DDD deals with large models by dividing them into multiple BCs and being explicit about their', 'url': 'https://en.wikipedia.org/wiki/Domain-driven_design'}, {'line': 2461, 'text': 'related data. In addition, each BC usually has its own ubiquitous language', 'url': 'https://martinfowler.com/bliki/UbiquitousLanguage.html'}, {'line': 2474, 'text': 'noted earlier, like HTTP/HTTPS, WebSockets, or AMQP. The Bounded Context pattern, however,', 'url': 'https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol'}, {'line': 2527, 'text': 'container (for simplicity’s sake, that’s the approach taken in the initial version of eShopOnContainers),', 'url': 'https://aka.ms/MicroservicesArchitecture'}, {'line': 2624, 'text': 'GraphQL Federation. Federation allows you to define “subgraphs” from other services and compose', 'url': 'https://www.apollographql.com/docs/federation/'}, {'line': 2629, 'text': 'the Materialized View pattern. In this approach, you generate, in advance (prepare denormalized data', 'url': 'https://docs.microsoft.com/azure/architecture/patterns/materialized-view'}, {'line': 2652, 'text': 'scalability in collaborative scenarios (or competitive scenarios, depending on the point of view) are', 'url': 'http://udidahan.com/2011/10/02/why-you-should-be-using-cqrs-almost-everywhere/'}, {'line': 2688, 'text': 'To analyze this problem, let’s look at an example from the eShopOnContainers reference application.', 'url': 'https://aka.ms/eshoponcontainers'}, {'line': 2713, 'text': 'as integration events (message and event-based communication). This is how the eShopOnContainers', 'url': 'https://aka.ms/eshoponcontainers'}, {'line': 2720, 'text': 'As stated by the CAP theorem, you need to choose between availability and ACID strong consistency.', 'url': 'https://en.wikipedia.org/wiki/CAP_theorem'}, {'line': 2866, 'text': 'Sam Newman, a recognized promoter of microservices and author of the book Building Microservices,', 'url': 'https://samnewman.io/'}, {'line': 2878, 'text': 'Another tool that informs your design choice is Conway’s law, which states that an application will', 'url': 'https://en.wikipedia.org/wiki/Conway%27s_law'}, {'line': 2884, 'text': 'To identify bounded contexts, you can use a DDD pattern called the Context Mapping pattern. With', 'url': 'https://www.infoq.com/articles/ddd-contextmapping'}, {'line': 2936, 'text': 'the ubiquitous language', 'url': 'https://martinfowler.com/bliki/UbiquitousLanguage.html'}, {'line': 3010, 'text': 'you could have an Application Delivery Controller (ADC) like Azure Application Gateway between your', 'url': 'https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction'}, {'line': 3118, 'text': 'apps, a good approach to consider can be an API Gateway. This pattern is a service that provides a', 'url': 'https://microservices.io/patterns/apigateway.html'}, {'line': 3118, 'text': 'single-entry point for certain groups of microservices. It’s similar to the Facade pattern from object-', 'url': 'https://en.wikipedia.org/wiki/Facade_pattern'}, {'line': 3118, 'text': 'sometimes known as the “backend for frontend” (BFF) because you build it while thinking about the', 'url': 'https://samnewman.io/patterns/architectural/bff/'}, {'line': 3165, 'text': 'Frontend” (BFF) where each API Gateway can provide a different API tailored for each client app type,', 'url': 'https://samnewman.io/patterns/architectural/bff/'}, {'line': 3179, 'text': 'Frontend” (BFF) pattern, hence based just on the API needed per client app. But in larger applications', 'url': 'https://samnewman.io/patterns/architectural/bff/'}, {'line': 3211, 'text': 'For more information, see Gateway routing pattern.', 'url': 'https://docs.microsoft.com/azure/architecture/patterns/gateway-routing'}, {'line': 3232, 'text': 'For more information, see Gateway aggregation pattern.', 'url': 'https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation'}, {'line': 3420, 'text': 'known as the Fallacies of distributed computing that lists assumptions that developers often make', 'url': 'https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing'}, {'line': 3449, 'text': 'The microservice community promotes the philosophy of “smart endpoints and dumb pipes”. This', 'url': 'https://simplicable.com/new/smart-endpoints-and-dumb-pipes'}, {'line': 3575, 'text': 'Bounded Context. For instance, in the eShopOnContainers application', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers'}, {'line': 3634, 'text': 'implement asynchronous communication based on messaging patterns', 'url': 'https://docs.microsoft.com/azure/architecture/patterns/category/messaging'}, {'line': 3634, 'text': 'and messaging technologies,', 'url': 'https://en.wikipedia.org/wiki/Message-oriented_middleware'}, {'line': 3640, 'text': 'A popular architectural style for request/response communication is REST. This approach is based on,', 'url': 'https://en.wikipedia.org/wiki/Representational_state_transfer'}, {'line': 3640, 'text': 'and tightly coupled to, the HTTP', 'url': 'https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol'}, {'line': 3646, 'text': 'instance, if you use Swagger metadata to describe your service API, you can use tools that generate', 'url': 'https://swagger.io/'}, {'line': 3763, 'text': 'applications. Thus, it helps you to follow the open/closed principle', 'url': 'https://en.wikipedia.org/wiki/Open/closed_principle'}, {'line': 3804, 'text': 'the microservice architecture. It’s similar to the way Bounded Contexts', 'url': 'https://martinfowler.com/bliki/BoundedContext.html'}, {'line': 3804, 'text': 'or to the way you propagate updates from the write database to the read database in the Command', 'url': 'https://martinfowler.com/bliki/CQRS.html'}, {'line': 3813, 'text': 'and Query Responsibility Segregation (CQRS) architecture pattern. The goal is to have eventual', 'url': 'https://martinfowler.com/bliki/CQRS.html'}, {'line': 3820, 'text': 'determine what protocol to use for event-driven, message-based communications. AMQP can help', 'url': 'https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol'}, {'line': 3826, 'text': 'RabbitMQ', 'url': 'https://www.rabbitmq.com/'}, {'line': 3826, 'text': 'or a service bus like Azure Service Bus with Topics. Alternatively, you might want to use a', 'url': 'https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions'}, {'line': 3826, 'text': 'higher-level service bus like NServiceBus,', 'url': 'https://particular.net/nservicebus'}, {'line': 3826, 'text': 'MassTransit, or Brighter', 'url': 'https://masstransit.io/'}, {'line': 3835, 'text': 'lower level than other products like NServiceBus,', 'url': 'https://particular.net/nservicebus'}, {'line': 3835, 'text': 'MassTransit, or Brighter, which can work on top of', 'url': 'https://masstransit.io/'}, {'line': 3844, 'text': 'service buses, such as NServiceBus, MassTransit, and Brighter. Of course, you can build your own', 'url': 'https://particular.net/nservicebus'}, {'line': 3948, 'text': 'version of the API. A good approach for this functionality is the Mediator pattern (for example,', 'url': 'https://en.wikipedia.org/wiki/Mediator_pattern'}, {'line': 3948, 'text': 'MediatR library) to decouple the different implementation versions into independent handlers.', 'url': 'https://github.com/jbogard/MediatR'}, {'line': 3957, 'text': 'Finally, if you’re using a REST architecture, Hypermedia', 'url': 'https://www.infoq.com/articles/mark-baker-hypermedia'}, {'line': 3981, 'text': 'your service is deployed and how it’s discovered, because there needs to be a service registry. In the', 'url': 'https://microservices.io/patterns/service-registry.html'}, {'line': 3992, 'text': 'The service registry pattern is a key part of service discovery. The registry is a database containing the', 'url': 'https://microservices.io/patterns/service-registry.html'}, {'line': 4021, 'text': 'frontends, is to design your application UI based on microservices as well. That means having a', 'url': 'https://martinfowler.com/articles/micro-frontends.html'}, {'line': 4076, 'text': 'The eShopOnContainers', 'url': 'https://aka.ms/MicroservicesArchitecture'}, {'line': 4148, 'text': 'using libraries like Polly, which offers a large variety of policies to handle this subject.', 'url': 'https://github.com/App-vNext/Polly'}, {'line': 4189, 'text': 'AspNetCore.Diagnostics.HealthChecks, available on GitHub', 'url': 'https://github.com/Xabaril/AspNetCore.Diagnostics.HealthChecks'}, {'line': 4189, 'text': 'and as a NuGet package. This library also', 'url': 'https://www.nuget.org/packages/Microsoft.AspNetCore.Diagnostics.HealthChecks/'}, {'line': 4416, 'text': 'single development machine (Windows 10 or macOS) by installing Docker Desktop. You can later', 'url': 'https://docs.docker.com/install/'}, {'line': 4426, 'text': 'information on deploying a Kubernetes cluster in Azure, see Deploy an Azure Kubernetes Service', 'url': 'https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal'}, {'line': 4426, 'text': '(AKS) cluster.', 'url': 'https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal'}, {'line': 4446, 'text': 'microservice-based applications, it’s recommended to use Helm.', 'url': 'https://helm.sh/'}, {'line': 4456, 'text': 'such as Azure Dev Spaces are also based on Helm charts.', 'url': 'https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces'}, {'line': 4460, 'text': 'Helm is maintained by the Cloud Native Computing Foundation (CNCF)', 'url': 'https://www.cncf.io/'}, {'line': 4464, 'text': 'For more implementation information on Helm charts and Kubernetes, see the Using Helm Charts to', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS'}, {'line': 4464, 'text': 'deploy eShopOnContainers to AKS post.', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS'}, {'line': 4525, 'text': 'By installing Docker Desktop, you can use a single Docker CLI to build apps for both Windows and', 'url': 'https://hub.docker.com/search/?type=edition&offering=community'}, {'line': 4553, 'text': 'framework is in use. For more details about.NET languages, see the blog post The .NET Language', 'url': 'https://devblogs.microsoft.com/dotnet/the-net-language-strategy/'}, {'line': 4553, 'text': 'Strategy.', 'url': 'https://devblogs.microsoft.com/dotnet/the-net-language-strategy/'}, {'line': 4604, 'text': 'Containerized Docker Application lifecycle with Microsoft Platforms and Tools.', 'url': 'https://aka.ms/dockerlifecycleebook/'}, {'line': 4638, 'text': 'To begin, make sure you have Docker Desktop for Windows for Windows installed, as explained in the', 'url': 'https://docs.docker.com/docker-for-windows/'}, {'line': 4642, 'text': 'Get started with Docker Desktop for Windows', 'url': 'https://docs.docker.com/docker-for-windows/'}, {'line': 4723, 'text': 'repository like the Docker Hub registry. That is precisely what happens under the covers when you', 'url': 'https://hub.docker.com/'}, {'line': 4743, 'text': 'information about this base image, see the ASP.NET Core Docker Image', 'url': 'https://hub.docker.com/_/microsoft-dotnet-aspnet/'}, {'line': 5076, 'text': 'The docker-compose.yml file lets you define a set of related services to be deployed as a composed', 'url': 'https://docs.docker.com/compose/compose-file/'}, {'line': 5375, 'text': 'Windows Containers', 'url': 'https://docs.microsoft.com/virtualization/windowscontainers/about/index'}, {'line': 5545, 'text': 'source code is available in the eShopOnContainers', 'url': 'https://aka.ms/MicroservicesArchitecture'}, {'line': 5892, 'text': 'need ASP.NET Core', 'url': 'https://docs.microsoft.com/aspnet/core/'}, {'line': 5892, 'text': 'and a data-access API or ORM like Entity Framework Core. You could also', 'url': 'https://docs.microsoft.com/ef/core/index'}, {'line': 5892, 'text': 'generate Swagger', 'url': 'https://swagger.io/'}, {'line': 5892, 'text': 'metadata automatically through Swashbuckle', 'url': 'https://github.com/domaindrivendev/Swashbuckle.AspNetCore'}, {'line': 5968, 'text': '(POCO) entity class.', 'url': 'https://docs.microsoft.com/dotnet/standard/glossary#poco'}, {'line': 5991, 'text': 'mappings and other EF extensibility points.', 'url': 'https://devblogs.microsoft.com/dotnet/implementing-seeding-custom-conventions-and-interceptors-in-ef-core-1-0/'}, {'line': 6076, 'text': 'secrets like the connection strings. An excellent way to manage application secrets is using Azure Key', 'url': 'https://azure.microsoft.com/services/key-vault/'}, {'line': 6076, 'text': 'Vault.', 'url': 'https://azure.microsoft.com/services/key-vault/'}, {'line': 6171, 'text': 'Swagger', 'url': 'https://swagger.io/'}, {'line': 6191, 'text': 'from companies like Spotify, Uber, Slack, and Microsoft, see the Swagger site (https://swagger.io).', 'url': 'https://swagger.io/'}, {'line': 6202, 'text': 'and commercial tools', 'url': 'https://swagger.io/commercial-tools/'}, {'line': 6202, 'text': 'and many libraries and frameworks', 'url': 'https://swagger.io/open-source-integrations/'}, {'line': 6340, 'text': 'In this guide, the docker-compose.yml file was introduced in the section Step 4. Define your services', 'url': 'https://docs.docker.com/compose/compose-file/'}, {'line': 6353, 'text': 'the whole solution in a single action orchestrated by the docker-compose up', 'url': 'https://docs.docker.com/compose/overview/'}, {'line': 6509, 'text': 'single Docker host instance (like a production VM or server provisioned with Docker Machine).', 'url': 'https://docs.docker.com/machine/overview/'}, {'line': 6684, 'text': 'The following example shows an .env file like the .env', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/.env'}, {'line': 6796, 'text': 'In eShopOnContainers, there’s a container named sqldata, as defined in the docker-compose.yml file,', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/docker-compose.yml'}, {'line': 6920, 'text': 'https://hub.docker.com/_/redis/', 'url': 'https://hub.docker.com/_/redis/'}, {'line': 7006, 'text': 'If you require high-level abstractions and richer features like Sagas for long-running processes that', 'url': 'https://docs.particular.net/nservicebus/sagas/'}, {'line': 7006, 'text': 'abstractions (like the simple event bus abstractions provided at eShopOnContainers). For that matter,', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs'}, {'line': 7016, 'text': 'you can research the forked eShopOnContainers using NServiceBus', 'url': 'https://go.particular.net/eShopOnContainers'}, {'line': 7042, 'text': 'autonomous. For more information, see this blog post on the amount of data to put in events. Be', 'url': 'https://particular.net/blog/putting-your-events-on-a-diet'}, {'line': 7042, 'text': 'careful not to take this too far, as this other blog post describes the problem data deficient messages', 'url': 'https://ardalis.com/data-deficient-messages/'}, {'line': 7042, 'text': 'can produce. Your design of your events should aim to be “just right” for the needs of their', 'url': 'https://ardalis.com/data-deficient-messages/'}, {'line': 7054, 'text': 'final application blocks, like the Event Bus client API, as in eShopOnContainers. Another is libraries', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/tree/main/src/BuildingBlocks/EventBus'}, {'line': 7079, 'text': 'In the Observer pattern, your primary object (known as the Observable) notifies other interested', 'url': 'https://en.wikipedia.org/wiki/Observer_pattern'}, {'line': 7086, 'text': 'The purpose of the Publish/Subscribe pattern is the same as the Observer pattern: you want to notify', 'url': 'https://docs.microsoft.com/previous-versions/msp-n-p/ff649664(v=pandp.10'}, {'line': 7178, 'text': 'We should start by saying that if you create your custom event bus based on RabbitMQ running in a', 'url': 'https://www.rabbitmq.com/'}, {'line': 7215, 'text': 'implementation, see the actual code in the dotnet-architecture/eShopOnContainers', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/BuildingBlocks/EventBus/EventBusRabbitMQ/EventBusRabbitMQ.cs'}, {'line': 7223, 'text': 'The actual code', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/BuildingBlocks/EventBus/EventBusRabbitMQ/EventBusRabbitMQ.cs'}, {'line': 7223, 'text': 'Polly', 'url': 'https://github.com/App-vNext/Polly'}, {'line': 7338, 'text': 'database and the message broker, as you do in older systems like Microsoft Message Queuing', 'url': 'https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms711472(v=vs.85'}, {'line': 7338, 'text': '(MSMQ), this approach is not recommended for the reasons described by the CAP theorem.', 'url': 'https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms711472(v=vs.85'}, {'line': 7354, 'text': 'distributed transactions', 'url': 'https://docs.microsoft.com/previous-versions/windows/desktop/ms681205(v=vs.85'}, {'line': 7354, 'text': 'MSMQ.', 'url': 'https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms711472(v=vs.85'}, {'line': 7638, 'text': 'UserCheckoutAcceptedIntegrationEventHandler class when it receives a', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/Services/Ordering/Ordering.API/Application/IntegrationEvents/EventHandling/UserCheckoutAcceptedIntegrationEventHandler.cs'}, {'line': 7658, 'text': 'According to the RabbitMQ documentation, “If a message is delivered to a consumer and then', 'url': 'https://www.rabbitmq.com/reliability.html#consumer'}, {'line': 8000, 'text': 'Since .NET Core 2.0, the framework provides a new interface named IHostedService helping you to', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.hosting.ihostedservice'}, {'line': 8089, 'text': 'IHostedService interface.', 'url': 'https://docs.microsoft.com/aspnet/core/fundamentals/host/hosted-services#ihostedservice-interface'}, {'line': 8387, 'text': 'You install Ocelot and its dependencies in your ASP.NET Core project with Ocelot’s NuGet package,', 'url': 'https://www.nuget.org/packages/Ocelot/'}, {'line': 8423, 'text': 'Here’s a simplified example of ReRoute configuration file', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/ApiGateways/Mobile.Bff.Shopping/apigw/configuration.json'}, {'line': 8466, 'text': 'multiple merged configuration.json files or you can also store the configuration in a Consul KV store.', 'url': 'https://ocelot.readthedocs.io/en/latest/features/configuration.html#merging-configuration-files'}, {'line': 8555, 'text': 'code. You could also implement request aggregation with the Request Aggregation feature in Ocelot,', 'url': 'https://ocelot.readthedocs.io/en/latest/features/requestaggregation.html#request-aggregation'}, {'line': 8598, 'text': 'service using IdentityServer providing the auth token, either out or inside the API Gateway.', 'url': 'https://docs.microsoft.com/dotnet/architecture/cloud-native/identity-server'}, {'line': 8683, 'text': 'requests through the Kubernetes Ingress tier based on', 'url': 'https://kubernetes.io/docs/concepts/services-networking/ingress/'}, {'line': 8828, 'text': 'DDD is a large topic with a rich set of resources for learning. You can start with books like Domain-', 'url': 'https://domainlanguage.com/ddd/'}, {'line': 8828, 'text': 'Driven Design', 'url': 'https://domainlanguage.com/ddd/'}, {'line': 8906, 'text': 'term Command Query Separation (CQS) was originally defined by Bertrand Meyer in his book', 'url': 'https://martinfowler.com/bliki/CommandQuerySeparation.html'}, {'line': 9030, 'text': 'implement straight queries using a micro ORM like Dapper. This guide lets you implement any query', 'url': 'https://github.com/StackExchange/dapper-dot-net'}, {'line': 9114, 'text': 'like Dapper) can be implemented within the same Web API project. Figure 7-4 shows this approach.', 'url': 'https://github.com/StackExchange/Dapper'}, {'line': 9155, 'text': 'used in Stack Overflow. To use Dapper, you just need to install it through the Dapper NuGet package,', 'url': 'https://stackoverflow.com/'}, {'line': 9163, 'text': 'When you use Dapper in your code, you directly use the SqlConnection', 'url': 'https://learn.microsoft.com/dotnet/api/microsoft.data.sqlclient.sqlconnection'}, {'line': 9163, 'text': 'Microsoft.Data.SqlClient', 'url': 'https://learn.microsoft.com/dotnet/api/microsoft.data.sqlclient'}, {'line': 9163, 'text': 'that extend the SqlConnection class, you can run queries in a straightforward and performant way.', 'url': 'https://learn.microsoft.com/dotnet/api/microsoft.data.sqlclient.sqlconnection'}, {'line': 9247, 'text': 'Microsoft.AspNetCore.Mvc.ProducesResponseTypeAttribute, so Swashbuckle can generate richer', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.aspnetcore.mvc.producesresponsetypeattribute'}, {'line': 9302, 'text': 'many technical concepts and patterns, like domain entities with rich models (no anemic-domain', 'url': 'https://martinfowler.com/bliki/AnemicDomainModel.html'}, {'line': 9302, 'text': 'model), value objects, aggregates, and aggregate root (or root entity) rules to support the internal', 'url': 'https://martinfowler.com/bliki/AnemicDomainModel.html'}, {'line': 9339, 'text': 'It is similar to the Inappropriate Intimacy code smell when implementing classes. If two microservices', 'url': 'https://sourcemaking.com/refactoring/smells/inappropriate-intimacy'}, {'line': 9388, 'text': 'Objects, or POCO, classes). As shown in Figure 7-6, the', 'url': 'https://docs.microsoft.com/dotnet/standard/glossary#poco'}, {'line': 9405, 'text': 'Eric Evans’s excellent book Domain Driven Design', 'url': 'https://domainlanguage.com/ddd/'}, {'line': 9423, 'text': 'Following the Persistence Ignorance and the Infrastructure Ignorance', 'url': 'https://deviq.com/persistence-ignorance/'}, {'line': 9454, 'text': 'Moving on to the application layer, we can again cite Eric Evans’s book Domain Driven Design:', 'url': 'https://domainlanguage.com/ddd/'}, {'line': 9498, 'text': 'In accordance with the previously mentioned Persistence Ignorance', 'url': 'https://deviq.com/persistence-ignorance/'}, {'line': 9498, 'text': 'and Infrastructure Ignorance', 'url': 'https://ayende.com/blog/3137/infrastructure-ignorance'}, {'line': 9605, 'text': 'In his post AnemicDomainModel, Martin Fowler describes an anemic domain model this way:', 'url': 'https://martinfowler.com/bliki/AnemicDomainModel.html'}, {'line': 9620, 'text': 'essentially end up with spaghetti code or transaction scripts, and therefore you lose the advantages', 'url': 'https://en.wikipedia.org/wiki/Spaghetti_code'}, {'line': 9863, 'text': 'You can also see a SeedWork folder that contains custom base classes that you can use as a base for', 'url': 'https://martinfowler.com/bliki/Seedwork.html'}, {'line': 9886, 'text': 'base class or interface, like entity or value object, as implemented in the SeedWork folder.', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/tree/main/src/Services/Ordering/Ordering.Domain/SeedWork'}, {'line': 9995, 'text': 'allows mapping to fields', 'url': 'https://docs.microsoft.com/ef/core/modeling/backing-field'}, {'line': 10066, 'text': 'introduced by Michael Feathers and popularized by Martin Fowler', 'url': 'https://www.artima.com/forums/flat.jsp?forum=106&thread=8826'}, {'line': 10095, 'text': 'the same way by any domain entity, such as the entity ID, equality operators, a domain event list per', 'url': 'https://docs.microsoft.com/dotnet/csharp/language-reference/operators/equality-operators'}, {'line': 10118, 'text': 'Separated Interface pattern. As explained by Martin Fowler, “Use Separated Interface to define an', 'url': 'https://www.martinfowler.com/eaaCatalog/separatedInterface.html'}, {'line': 10263, 'text': 'As background, a limitation when using EF Core 1.0 and 1.1 was that you could not use complex types', 'url': 'https://docs.microsoft.com/dotnet/api/system.componentmodel.dataannotations.schema.complextypeattribute'}, {'line': 10263, 'text': 'not important in the domain model. You could hide that ID by using the ID as a shadow property.', 'url': 'https://docs.microsoft.com/ef/core/modeling/shadow-properties'}, {'line': 10488, 'text': 'Enumerations', 'url': 'https://docs.microsoft.com/dotnet/csharp/language-reference/builtin-types/enum'}, {'line': 10488, 'text': 'or more robust abstractions can be a code smell. This type of usage leads to fragile code with many', 'url': 'https://deviq.com/antipatterns/code-smells'}, {'line': 10502, 'text': 'However, this isn’t a critical topic and in many cases, for simplicity, you can still use regular enum', 'url': 'https://docs.microsoft.com/dotnet/csharp/language-reference/builtin-types/enum'}, {'line': 10502, 'text': 'types', 'url': 'https://docs.microsoft.com/dotnet/csharp/language-reference/builtin-types/enum'}, {'line': 10599, 'text': 'section, but they no longer work', 'url': 'https://github.com/dotnet/efcore/issues/3680'}, {'line': 10599, 'text': 'for entity validation in EF Core (neither does the IValidatableObject.Validate', 'url': 'https://github.com/dotnet/efcore/issues/3680'}, {'line': 10605, 'text': 'Data annotations and the IValidatableObject', 'url': 'https://docs.microsoft.com/dotnet/api/system.componentmodel.dataannotations.ivalidatableobject'}, {'line': 10627, 'text': 'You can see a sample implementation for validating IValidatableObject entities in this comment on', 'url': 'https://github.com/dotnet/efcore/issues/3680#issuecomment-155502539'}, {'line': 10627, 'text': 'GitHub. That sample doesn’t do attribute-based validations, but they should be easy to implement', 'url': 'https://github.com/dotnet/efcore/issues/3680#issuecomment-155502539'}, {'line': 10659, 'text': 'Implementing Domain-Driven Design, Vaughn Vernon discusses these in the section on validation.', 'url': 'https://www.amazon.com/Implementing-Domain-Driven-Design-Vaughn-Vernon/dp/0321834577'}, {'line': 10942, 'text': 'This change could result in new bugs and this approach also goes against the Open/Closed principle', 'url': 'https://en.wikipedia.org/wiki/Open/closed_principle'}, {'line': 10942, 'text': 'from SOLID. Not only that, the original class that was orchestrating the operations would grow and', 'url': 'https://en.wikipedia.org/wiki/SOLID'}, {'line': 10942, 'text': 'grow, which goes against the Single Responsibility Principle (SRP).', 'url': 'https://en.wikipedia.org/wiki/Single_responsibility_principle'}, {'line': 11040, 'text': 'Udi Dahan originally proposed (for example, in several related posts, such as Domain Events – Take 2)', 'url': 'https://udidahan.com/2008/08/25/domain-events-take-2/'}, {'line': 11040, 'text': 'DomainEvents.Raise(Event myEvent). Jimmy Bogard wrote a blog post (Strengthening your domain:', 'url': 'https://lostechies.com/jimmybogard/2010/04/08/strengthening-your-domain-domain-events/'}, {'line': 11040, 'text': 'Domain Events) that recommends a similar approach.', 'url': 'https://lostechies.com/jimmybogard/2010/04/08/strengthening-your-domain-domain-events/'}, {'line': 11063, 'text': 'Bogard in this post A better domain events pattern.)', 'url': 'https://lostechies.com/jimmybogard/2014/05/13/a-better-domain-events-pattern/'}, {'line': 11084, 'text': 'The following code, part of the Order aggregate-root at eShopOnContainers, shows an example:', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.Domain/AggregatesModel/OrderAggregate/Order.cs'}, {'line': 11130, 'text': 'Vaughn Vernon says the following in Effective Aggregate Design. Part II: Making Aggregates Work', 'url': 'https://dddcommunity.org/wp-content/uploads/files/pdf_articles/Vernon_2011_2.pdf'}, {'line': 11130, 'text': 'Together:', 'url': 'https://dddcommunity.org/wp-content/uploads/files/pdf_articles/Vernon_2011_2.pdf'}, {'line': 11154, 'text': 'effects for the same original command. For instance, in A better domain events pattern, Bogard says', 'url': 'https://lostechies.com/jimmybogard/2014/05/13/a-better-domain-events-pattern/'}, {'line': 11234, 'text': 'following domain event handler code at eShopOnContainers, shows an implementation example.', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/DomainEventHandlers/ValidateOrAddBuyerAggregateWhenOrderStartedDomainEventHandler.cs'}, {'line': 11267, 'text': 'The reference app uses MediatR to propagate domain events synchronously across aggregates, within', 'url': 'https://github.com/jbogard/MediatR'}, {'line': 11267, 'text': 'a single transaction. However, you could also use some AMQP implementation like RabbitMQ or', 'url': 'https://www.rabbitmq.com/'}, {'line': 11267, 'text': 'Azure Service Bus', 'url': 'https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview'}, {'line': 11316, 'text': 'components such as repositories and Unit of Work', 'url': 'https://martinfowler.com/eaaCatalog/unitOfWork.html'}, {'line': 11316, 'text': 'DbContext', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.dbcontext'}, {'line': 11343, 'text': 'The Repository pattern is a well-documented way of working with a data source. In the book Patterns', 'url': 'https://www.amazon.com/Patterns-Enterprise-Application-Architecture-Martin/dp/0321127420/'}, {'line': 11343, 'text': 'of Enterprise Application Architecture, Martin Fowler describes a repository as follows:', 'url': 'https://www.amazon.com/Patterns-Enterprise-Application-Architecture-Martin/dp/0321127420/'}, {'line': 11483, 'text': 'Decorators or Proxies. For instance, cross-cutting concerns like caching, logging, and error handling', 'url': 'https://ardalis.com/building-a-cachedrepository-in-aspnet-core/'}, {'line': 11494, 'text': 'A unit of work', 'url': 'https://martinfowler.com/eaaCatalog/unitOfWork.html'}, {'line': 11500, 'text': 'implemented by a DbContext and is executed when a call is made to SaveChanges.', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.dbcontext'}, {'line': 11626, 'text': 'domain model classes are persistence-ignorant, following the Persistence Ignorance and the', 'url': 'https://deviq.com/persistence-ignorance/'}, {'line': 11626, 'text': 'Infrastructure Ignorance', 'url': 'https://ayende.com/blog/3137/infrastructure-ignorance'}, {'line': 11889, 'text': 'An interesting aspect of code in the preceding example is that it uses the Hi/Lo algorithm as the key', 'url': 'https://vladmihalcea.com/the-hilo-algorithm/'}, {'line': 11956, 'text': 'the eShopOnWeb', 'url': 'https://github.com/dotnet-architecture/eShopOnWeb'}, {'line': 11966, 'text': 'buyer to whom the basket belongs. It will eagerly load', 'url': 'https://docs.microsoft.com/ef/core/querying/related-data'}, {'line': 11984, 'text': 'Learn how the specification pattern is applied in the eShopOnWeb sample.', 'url': 'https://github.com/dotnet-architecture/eShopOnWeb/wiki/Patterns#specification'}, {'line': 12078, 'text': 'Azure Cosmos DB', 'url': 'https://docs.microsoft.com/azure/cosmos-db/introduction'}, {'line': 12078, 'text': 'Azure Cosmos DB provides turn-key global distribution,', 'url': 'https://docs.microsoft.com/azure/cosmos-db/distribute-data-globally'}, {'line': 12078, 'text': 'elastic scaling of throughput and storage', 'url': 'https://docs.microsoft.com/azure/cosmos-db/partition-data'}, {'line': 12078, 'text': 'worldwide, single-digit millisecond latencies at the 99th percentile, five well-defined consistency', 'url': 'https://docs.microsoft.com/azure/cosmos-db/consistency-levels'}, {'line': 12078, 'text': 'levels, and guaranteed high availability, all backed by industry-leading SLAs. Azure Cosmos DB', 'url': 'https://docs.microsoft.com/azure/cosmos-db/consistency-levels'}, {'line': 12078, 'text': 'automatically indexes data without requiring you to deal with schema and index management. It is', 'url': 'https://www.vldb.org/pvldb/vol8/p1668-shukla.pdf'}, {'line': 12119, 'text': 'view. Even though there’s an on-premises Azure Cosmos DB Emulator', 'url': 'https://docs.microsoft.com/azure/cosmos-db/local-emulator'}, {'line': 12152, 'text': 'containers because the MongoDB Docker image is a multi-arch image that supports Docker Linux', 'url': 'https://hub.docker.com/r/_/mongo/'}, {'line': 12157, 'text': 'scalable, PaaS cloud solution as Azure Cosmos DB by simply changing the MongoDB connection', 'url': 'https://docs.microsoft.com/azure/cosmos-db/connect-mongodb-account'}, {'line': 12157, 'text': 'string to point to Azure Cosmos DB.', 'url': 'https://docs.microsoft.com/azure/cosmos-db/connect-mongodb-account'}, {'line': 12185, 'text': 'Benefits of using Azure Cosmos DB in this page.', 'url': 'https://docs.microsoft.com/azure/cosmos-db/mongodb-introduction'}, {'line': 12207, 'text': 'MongoDB Azure Service. But that is not a PaaS service provided by Microsoft. In this case, Azure is just', 'url': 'https://www.mongodb.com/scale/mongodb-azure-service'}, {'line': 12295, 'text': 'connection string obtained from the Azure portal as explained in Connect a MongoDB application to', 'url': 'https://docs.microsoft.com/azure/cosmos-db/connect-mongodb-account'}, {'line': 12295, 'text': 'Azure Cosmos DB.', 'url': 'https://docs.microsoft.com/azure/cosmos-db/connect-mongodb-account'}, {'line': 12438, 'text': 'ASP.NET Core includes a simple built-in IoC container', 'url': 'https://docs.microsoft.com/aspnet/core/fundamentals/dependency-injection'}, {'line': 12465, 'text': 'method, or a DDD Application Service. It is ultimately a simple class that uses repositories, domain', 'url': 'https://lostechies.com/jimmybogard/2008/08/21/services-in-domain-driven-design/'}, {'line': 12506, 'text': 'Scrutor', 'url': 'https://github.com/khellang/Scrutor'}, {'line': 12585, 'text': 'in the initial code of this section (the CreateOrderCommandHandler', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/main/src/Services/Ordering/Ordering.API/Application/Commands/CreateOrderCommandHandler.cs'}, {'line': 12595, 'text': 'guide. CQRS has two sides. The first area is queries, using simplified queries with the Dapper', 'url': 'https://github.com/StackExchange/dapper-dot-net'}, {'line': 12722, 'text': 'aggregate roots (root entities), child entities, or domain services, but not within the command handler,', 'url': 'https://lostechies.com/jimmybogard/2008/08/21/services-in-domain-driven-design/'}, {'line': 12966, 'text': 'handlers. The guide also proposes applying behaviors', 'url': 'https://github.com/jbogard/MediatR/wiki/Behaviors'}, {'line': 12971, 'text': 'Mediator pattern. The library used in this guide is the MediatR', 'url': 'https://github.com/jbogard/MediatR'}, {'line': 13009, 'text': 'named UserCheckoutAcceptedIntegrationEventHandler', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/IntegrationEvents/EventHandling/UserCheckoutAcceptedIntegrationEventHandler.cs'}, {'line': 13039, 'text': 'Then the CommandHandler for the IdentifiedCommand named IdentifiedCommandHandler.cs will', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/Commands/IdentifiedCommandHandler.cs'}, {'line': 13051, 'text': '_mediator.Send(message.Command), from the IdentifiedCommandHandler.cs.', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/Commands/IdentifiedCommandHandler.cs'}, {'line': 13057, 'text': 'CreateOrderCommandHandler, which is running transactions against the Ordering database, as shown', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/Commands/CreateOrderCommandHandler.cs'}, {'line': 13102, 'text': 'That LoggingBehavior', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/Behaviors/LoggingBehavior.cs'}, {'line': 13114, 'text': 'the ValidatorBehavior', 'url': 'https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/Services/Ordering/Ordering.API/Application/Behaviors/ValidatorBehavior.cs'}, {'line': 13114, 'text': 'class that relies on the FluentValidation', 'url': 'https://github.com/JeremySkinner/FluentValidation'}, {'line': 13123, 'text': 'Then, based on the FluentValidation library, you would create validation for the data passed with', 'url': 'https://github.com/JeremySkinner/FluentValidation'}, {'line': 13325, 'text': 'breakers, it can aggravate the ripple effects, ultimately even causing a Denial of Service (DoS).', 'url': 'https://en.wikipedia.org/wiki/Denial-of-service_attack'}, {'line': 13349, 'text': 'immediately. In terms of implementation, the Polly Bulkhead Isolation', 'url': 'https://github.com/App-vNext/Polly/wiki/Bulkhead'}, {'line': 13349, 'text': 'requirement. This approach is essentially a parallelization throttle with SemaphoreSlim as the', 'url': 'https://docs.microsoft.com/dotnet/api/system.threading.semaphoreslim'}, {'line': 13361, 'text': 'failures. The BulkheadPolicy object in Polly', 'url': 'https://thepollyproject.azurewebsites.net/'}, {'line': 13390, 'text': 'Retries with exponential backoff', 'url': 'https://docs.microsoft.com/azure/architecture/patterns/retry'}, {'line': 13390, 'text': 'increasing wait time, up to a maximum retry count has been reached (the exponential backoff). This', 'url': 'https://en.wikipedia.org/wiki/Exponential_backoff'}, {'line': 13404, 'text': 'and retry logic. But you need to enable the Entity Framework execution strategy for each DbContext', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.dbcontext'}, {'line': 13404, 'text': 'connection if you want to have resilient EF Core connections.', 'url': 'https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency'}, {'line': 13449, 'text': 'The first DbContext', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.dbcontext'}, {'line': 13484, 'text': 'IHttpClientFactory', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.ihttpclientfactory'}, {'line': 13484, 'text': 'available since .NET Core 2.1, for creating HttpClient', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.httpclient'}, {'line': 13490, 'text': 'The original and well-known HttpClient', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.httpclient'}, {'line': 13494, 'text': 'issue, see the blog post You’re using HttpClient wrong and it’s destabilizing your software.', 'url': 'https://aspnetmonsters.com/2016/08/2016-08-27-httpclientwrong/'}, {'line': 13500, 'text': 'explained in this Microsoft article on HttpClient usage. This can be a good solution for short-lived', 'url': 'https://docs.microsoft.com/dotnet/csharp/tutorials/console-webapiclient'}, {'line': 13511, 'text': 'handle the DNS changes as described in this issue', 'url': 'https://github.com/dotnet/runtime/issues/18348'}, {'line': 13516, 'text': 'However, the issue isn’t really with HttpClient per se, but with the default constructor for HttpClient,', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.httpclient.-ctor#system-net-http-httpclient-ctor'}, {'line': 13516, 'text': 'because it creates a new concrete instance of HttpMessageHandler, which is the one that has', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.httpmessagehandler'}, {'line': 13521, 'text': 'introduced two approaches, one of them being IHttpClientFactory. It’s an interface that’s used to', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.ihttpclientfactory'}, {'line': 13528, 'text': 'different strategies, see HttpClient guidelines for .NET.', 'url': 'https://docs.microsoft.com/dotnet/fundamentals/networking/http/httpclient-guidelines'}, {'line': 13533, 'text': 'Polly', 'url': 'https://thepollyproject.azurewebsites.net/'}, {'line': 13539, 'text': 'The current implementation of IHttpClientFactory, that also implements IHttpMessageHandlerFactory,', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.ihttpclientfactory'}, {'line': 13600, 'text': 'IHttpClientFactory in the DI container with the extension method AddHttpClient.', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.dependencyinjection.httpclientfactoryservicecollectionextensions.addhttpclient'}, {'line': 13606, 'text': 'To configure the above structure, add IHttpClientFactory', 'url': 'https://docs.microsoft.com/dotnet/api/system.net.http.ihttpclientfactory'}, {'line': 13606, 'text': 'Microsoft.Extensions.Http NuGet package that includes the AddHttpClient', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.dependencyinjection.httpclientfactoryservicecollectionextensions.addhttpclient'}, {'line': 13606, 'text': 'IServiceCollection. This extension method registers the internal DefaultHttpClientFactory class to be', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.dependencyinjection.iservicecollection'}, {'line': 13606, 'text': 'HttpMessageHandlerBuilder. This message handler (HttpMessageHandler', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.http.httpmessagehandlerbuilder'}, {'line': 13652, 'text': 'be overridden per Typed Client. To override it, call SetHandlerLifetime() on the IHttpClientBuilder', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.extensions.dependencyinjection.ihttpclientbuilder'}, {'line': 13728, 'text': 'advanced .NET libraries like the open-source Polly library.', 'url': 'https://github.com/App-vNext/Polly'}, {'line': 13791, 'text': 'the overall performance of the end-to-end system. As recommended in Polly: Retry with Jitter, a good', 'url': 'https://github.com/App-vNext/Polly/wiki/Retry-with-jitter'}, {'line': 13848, 'text': 'Using Http retries carelessly could result in creating a Denial of Service (DoS) attack within your own', 'url': 'https://en.wikipedia.org/wiki/Denial-of-service_attack'}, {'line': 13891, 'text': 'breaker rather than actually be placed. The policy automatically interprets relevant exceptions and', 'url': 'https://docs.microsoft.com/aspnet/core/fundamentals/http-requests#handle-transient-faults'}, {'line': 13891, 'text': 'HTTP status codes', 'url': 'https://docs.microsoft.com/aspnet/core/fundamentals/http-requests#handle-transient-faults'}, {'line': 13904, 'text': 'to the fallback services. Polly is planning a new policy to automate this failover policy scenario.', 'url': 'https://github.com/App-vNext/Polly/wiki/Polly-Roadmap#failover-policy'}, {'line': 14054, 'text': '(Microsoft.Extensions.Diagnostics.HealthChecks). Like many ASP.NET Core features, health checks', 'url': 'https://www.nuget.org/packages/Microsoft.Extensions.Diagnostics.HealthChecks'}, {'line': 14075, 'text': 'Web API application when using the Microsoft.Extensions.Diagnostics.HealthChecks', 'url': 'https://www.nuget.org/packages/Microsoft.Extensions.Diagnostics.HealthChecks'}, {'line': 14135, 'text': 'The open-source project AspNetCore.Diagnostics.HealthChecks', 'url': 'https://github.com/Xabaril/AspNetCore.Diagnostics.HealthChecks'}, {'line': 14192, 'text': 'Fortunately, AspNetCore.Diagnostics.HealthChecks also provides AspNetCore.HealthChecks.UI NuGet', 'url': 'https://github.com/Xabaril/AspNetCore.Diagnostics.HealthChecks'}, {'line': 14247, 'text': 'Note that Azure Service Fabric provides its own Health Monitoring model, which is more advanced', 'url': 'https://docs.microsoft.com/azure/service-fabric/service-fabric-health-introduction'}, {'line': 14257, 'text': 'shown when explaining the AspNetCore.Diagnostics.HealthChecks. Or you could use more advanced', 'url': 'https://github.com/Xabaril/AspNetCore.Diagnostics.HealthChecks'}, {'line': 14257, 'text': 'tools like Azure Monitor', 'url': 'https://azure.microsoft.com/services/monitor/'}, {'line': 14321, 'text': 'cookie sharing.) This pattern is illustrated in Figure 9-2.', 'url': 'https://docs.microsoft.com/aspnet/core/security/cookie-sharing'}, {'line': 14336, 'text': 'The primary mechanism in ASP.NET Core for identifying an application’s users is the ASP.NET Core', 'url': 'https://docs.microsoft.com/aspnet/core/security/authentication/identity'}, {'line': 14336, 'text': 'Identity', 'url': 'https://docs.microsoft.com/aspnet/core/security/authentication/identity'}, {'line': 14381, 'text': 'ASP.NET Core also supports using external authentication providers', 'url': 'https://docs.microsoft.com/aspnet/core/security/authentication/social/'}, {'line': 14381, 'text': 'to let users sign in via OAuth 2.0', 'url': 'https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2'}, {'line': 14451, 'text': 'To enable token authentication, ASP.NET Core supports several options for using OAuth 2.0 and', 'url': 'https://oauth.net/2/'}, {'line': 14451, 'text': 'OpenID Connect.', 'url': 'https://openid.net/connect/'}, {'line': 14485, 'text': 'IdentityServer4', 'url': 'https://github.com/IdentityServer/IdentityServer4'}, {'line': 14485, 'text': 'and OpenIddict are OpenID Connect providers that integrate easily with ASP.NET Core', 'url': 'https://github.com/openiddict/openiddict-core'}, {'line': 14485, 'text': 'Identity to let you issue security tokens from an ASP.NET Core service. The IdentityServer4', 'url': 'https://identityserver4.readthedocs.io/en/latest/'}, {'line': 14485, 'text': 'documentation', 'url': 'https://identityserver4.readthedocs.io/en/latest/'}, {'line': 14545, 'text': 'package. JWT stands for “JSON Web Token” and', 'url': 'https://tools.ietf.org/html/rfc7519'}, {'line': 14616, 'text': 'to make APIs available to some authenticated users, but not to all. Authorization', 'url': 'https://docs.microsoft.com/aspnet/core/security/authorization/introduction'}, {'line': 14675, 'text': 'Custom authorization rules can also be written using authorization policies. This section provides an', 'url': 'https://docs.asp.net/en/latest/security/authorization/policies.html'}, {'line': 14675, 'text': 'overview. For more information, see the ASP.NET Authorization Workshop.', 'url': 'https://github.com/blowdart/AspNetAuthorizationWorkshop'}, {'line': 14696, 'text': 'The second AddPolicy', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.aspnetcore.authorization.authorizationoptions.addpolicy'}, {'line': 14696, 'text': 'present for the user. The RequireClaim', 'url': 'https://docs.microsoft.com/dotnet/api/microsoft.aspnetcore.authorization.authorizationpolicybuilder.requireclaim'}, {'line': 14787, 'text': 'environment variables', 'url': 'https://docs.microsoft.com/aspnet/core/security/app-secrets#environment-variables'}, {'line': 14806, 'text': 'The ASP.NET Core Secret Manager tool provides another method of keeping secrets out of source', 'url': 'https://docs.microsoft.com/aspnet/core/security/app-secrets#secret-manager'}, {'line': 14835, 'text': 'and unencrypted on the machine. A more secure option for storing secrets is Azure Key Vault, which', 'url': 'https://azure.microsoft.com/services/key-vault/'}]}