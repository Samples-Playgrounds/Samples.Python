public static int Main(string[] args) { var configuration = GetConfiguration(); Log . Logger = CreateSerilogLogger(configuration); try { Log . Information("Configuring web host ({ApplicationContext})..." , AppName); var host = CreateHostBuilder(configuration , args); Log . Information("Applying migrations ({ApplicationContext})..." , AppName); host . MigrateDbContext<CatalogContext>((context , services) => { var env = services . GetService<IWebHostEnvironment>(); var settings = services . GetService<IOptions<CatalogSettings>>(); var logger = services . GetService<ILogger<CatalogContextSeed>>(); new CatalogContextSeed() . SeedAsync(context , env , settings , logger) . Wait(); }) . MigrateDbContext<IntegrationEventLogContext>(( _ , __ ) => { }); Log . Information("Starting web host ({ApplicationContext})..." , AppName); host . Run(); return 0; } catch (Exception ex) { Log . Fatal(ex , "Program terminated unexpectedly ({ApplicationContext})!" , AppName); return 1; } finally { Log . CloseAndFlush(); } }