,0
0,public class EventToCommandBehavior : BindableBehavior<View>
1,{
2,...
3,protected override void OnAttachedTo(View visualElement)
4,{
5,base.OnAttachedTo(visualElement);
6,
7,var events = AssociatedObject.GetType().GetRuntimeEvents().ToArray();
8,if (events.Any())
9,{
10,_eventInfo = events.FirstOrDefault(e => e.Name == EventName);
11,if (_eventInfo == null)
12,throw new ArgumentException(string.Format(
13,"""EventToCommand: Can't find any event named '{0}' on attached type"","
14,EventName));
15,
16,"AddEventHandler(_eventInfo, AssociatedObject, OnFired);"
17,}
18,}
19,
20,protected override void OnDetachingFrom(View view)
21,{
22,if (_handler != null)
23,"_eventInfo.RemoveEventHandler(AssociatedObject, _handler);"
24,
25,base.OnDetachingFrom(view);
26,}
27,
28,private void AddEventHandler(
29,"EventInfo eventInfo, object item, Action<object, EventArgs> action)"
30,{
31,...
32,}
33,
34,"private void OnFired(object sender, EventArgs eventArgs)"
35,{
36,...
37,}
38,}
