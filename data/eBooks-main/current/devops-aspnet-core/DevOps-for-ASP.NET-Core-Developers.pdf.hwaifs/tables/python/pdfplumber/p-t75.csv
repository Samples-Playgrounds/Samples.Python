,0
0,environment:
1,name: PROD
2,url: ${{ steps.slot_swap.outputs.url }}
3,
4,steps:
5,- name: Login via Azure CLI
6,uses: azure/login@v1
7,with:
8,creds: ${{ secrets.AZURE_CREDENTIALS }}
9,
10,- name: Swap staging slot into production
11,id: slot_swap
12,run: |
13,az webapp deployment slot swap -g ${{ env.rg-name }} -n ${{ env.app-name }} -s staging
14,url=$(az webapp show -g ${{ env.rg-name }} -n ${{ env.app-name }} --query
15,"""defaultHostName"" -o tsv)"
16,"echo ""::set-output name=url::http://$url"""
17,
18,- name: az cli logout
19,run: az logout
20,``` :::
