['== Microsoft\n\nDevOps for\nASP.NET Core Developers\n\nCam Soper\nScott Addie\nColin Dembovsky\n\nVersion 1.1\nm= Microsoft\n\nEDITION v1.1.0\n\nRefer changelog for the book updates and community contributions.\nThis guide is available as a downloadable PDF e-book,\n\nPUBLISHED BY\n\nMicrosoft Developer Division, .NET, and Visual Studio product teams\nA division of Microsoft Corporation\n\nOne Microsoft Way\n\nRedmond, Washington 98052-6399\n\nCopyright © 2022 by Microsof', "t Corporation\n\nAll rights reserved. No part of the contents of this book may be reproduced or transmitted in any\nform or by any means without the written permission of the publisher.\n\nThis book is provided “as-is” and expresses the author's views and opinions. The views, opinions, and\ninformation expressed in this book, including URL and other Internet website references, may change\nwithout notice.\n\nSome examples depicted herein are provided for ", 'illustration only and are fictitious. No real association\nor connection is intended or should be inferred.\n\nMicrosoft and the trademarks listed at https://www.microsoft.com on the “Trademarks” webpage are\ntrademarks of the Microsoft group of companies.\n\nMac and macOS are trademarks of Apple Inc.\nThe Docker whale logo is a registered trademark of Docker, Inc. Used by permission.\n\nAll other marks and logos are property of their respective owners.\n\n', "Credits\n\nAuthors:\n\nCam Soper\nScott Addie\n\nColin Dembovsky\n\nWelcome\n\nWelcome to the Azure Development Lifecycle guide for .NET! This guide introduces the basic concepts\nof building a development lifecycle around Azure using .NET tools and processes. After finishing this\nguide, you'll reap the benefits of a mature DevOps toolchain.\n\nWho this guide is for\nm= Microsoft\n\nYou should be an experienced ASP.NET Core developer (200-300 level). You don’t ne", "ed to know\nanything about Azure, as we'll cover that in this introduction. This guide may also be useful for\nDevOps engineers who are more focused on operations than development.\n\nThis guide targets Windows developers. However, Linux and macOS are fully supported by .NET Core.\nTo adapt this guide for Linux/macOS, watch for callouts for Linux/macOS differences.\n\nWhat this guide doesn't cover\n\nThis guide is focused on an end-to-end continuous deplo", "yment experience for .NET developers. It's\nnot an exhaustive guide to all things Azure, and it doesn’t focus extensively on .NET APIs for Azure\nservices. The emphasis is all around continuous integration, deployment, monitoring, and debugging.\nNear the end of the guide, recommendations for next steps are offered. Included in the suggestions\nare Azure platform services that are useful to ASP.NET Core developers.\n\nWhat's in this guide\nTools and dow", 'nloads\nLearn where to acquire the tools used in this guide.\n\nDeploy to App Service\n\nLearn the various methods for deploying an ASP.NET Core app to Azure App Service.\n\nContinuous integration and deployment with Azure DevOps\n\nBuild an end-to-end continuous integration and deployment solution for your ASP.NET Core app with\nGitHub, Azure DevOps Services, and Azure.\n\nContinuous integration and deployment with GitHub Actions\n\nBuild an end-to-end contin', "uous integration and deployment solution for your ASP.NET Core app with\nGitHub, GitHub Actions, and Azure, including code scanning for security and quality using CodeQL.\n\nMonitor and debug\n\nUse Azure's tools to monitor, troubleshoot, and tune your application.\n\nNext steps\n\nOther learning paths for the ASP.NET Core developer learning Azure.\n\nAdditional introductory reading\n\nIf this is your first exposure to cloud computing, these articles explain ", 'the basics.\n\n° What is Cloud Computing?\n° Examples of Cloud Computing\nmE Microsoft\n\nWhat is laaS?\nWhat is PaaS?\nContents\n\nTOOlS ANd COWNOAMS ..............ccccccsccscccccscccccsccscscscssssssssessssssssssssssssssssssssssssssssssssssssssscesccccescoocs 1\nPPE QuISITES ......ecessesessssessesessesscsesessecscsesussessssessesessssesussessssesssscussessssecussssesecussecsssssusssssssessssessesssseaessssessssessesessesessesesseaeeneaeeseess 1\nRECOMMENE', ' tOOIS (WINGCOWS ONY)... ccccessessssessssessessssesssesssssssssesessssecsesessssessssessssessesessesessssessesesscsesseseeseseeseaeeneeseneess 1\n\nDeploy an app to App Service......................sssccsssssssssssssssssssssssscscscesssccesccccecccccccccssccsssssscsseses 3\nDownload and test the Ap ou... ceecesesssssssessssssssssssssssesessssessesessesessssessssessssessssessssessssessesessssessesessesessesessesesseseeseaeeseaeeseess 3\nCreate the Az', 'ure App Service Web Appu....ccsssssssssssssssssssssssssssssessssesscsessesessssesussessssecucsesussesessesessecusseensseeesseeneseenees 5\nDeployment WITH Visual StUCIOn.... ec ccsessssssssesssssssssssssssssesessssessesessssessssessssessssessssessessssssessesessssessesessesessesesseseeseaneneens 6\nDeployMent SLOTS .....cceecessssessesessecessesssesssesscsessssessssessssessssessssessesecsssessssessssecussessssessssesssseenssesseaeesssessesessssesss', 'seesesesaeaesseaseneens 8\nSUIMIMALSY ...eescsesssssssssssesesscsesessesesessescsesucsesesusscsesucsesesscsesesscuesesessesesesusscsesscsssesesuesesesuesesesucsesesucuesesecuesesecueseseaueaesesueseseseseeseneenesees 10\nAdditional reading......e.secessesessssssssssssscesssssseccsessssessssessssessssesussesussesussesuesesussesussesussecessecussesessecesseceeseseesecussesessecesseeneseeeeseenees 10\n\nContinuous integration and deployment with Azure D', "evOpe .......................sssssssssssssseees 11\nPublish the app's COde@ to GItHUD ou. sessssessssesessessssesessesssesssesssessssesussesssesessesssesessesessesessesessesessesessesesseseeseens 12\nDisconnect local Git CEPlOYMENE uu... eessesessesessesessesessesessesessesssesessesssesssesussesssesessesssesessesessesessesessesessesesseseeseseeneens 12\nCreate an AZUre De@VOPS OFGANIZAtiON uu... ceecessessssessssesessesessesessessssesessesussesssses", 'sssesussesssesusseseesesessesessesessesesseeesseeeeseeess 13\nCreate a team project IN AZUre DeVOPS OFGANIZATION ou... eeecessesessesessesessessssesessesessesessessesesessesesseseesesesseetsseeeeseeess 13\nConfigure a Self-hosted agent if NECESSALY ......cceeessessssessessessssessesscsessessecessesssesesessessecussessessesessessecucsesseesessseeseeneseeses 13\nConfigure the AZure Pipelines PiPelin@ uc ecccesessessesessessecsssessesscsessessecussesss', 'ssssussessecussesseesesessessececsesseeseeesseeseeneseses 14\n\nGrant Azure DevOps access to the GItHUD repOSItOFy uu... eesessessesessesessesessesessesessesessesessesessesesseseesesneseseeseess 14\nCreate the DuUIId DEFINITION oe ecessesssssssssssesseeseessssecsecsecsecsessecsecsecsessessecuscuccsccuccuscucsucsussussucsucsecsecseeseeseeaeeseeseeaeeaeenss 16\nCreate the release Pipeline... eccesscsssesssessssesssssssssssessssessesesssssssesessesesses', 'essesessessssesessesessesessesessesesseseeseseeseseeseseeseess 18\nCommit changes to GitHub and automatically deploy to AZULC ou... ecsesessesessesessesessessssesessesessesesseeesseeeeseeess 22\nExamine the AZure Pipelines Pipeline... ccescssssessssessssesessesessessssesessesessesessesessesessesessesessesessesessesessesessesessesesseseeneens 23\nBUI GePIMITION 0... eeceesessessessesseesessecsecsecsecscsecsecsessecsessecsecsecsecsessessccnscuscuceuss', 'uccussuccucsucsussucsussucsucsesseeseeaeeaeeaeeaeeaeeaeeaeeneeneenee 23\nREICASE PIPELINE oe cecesscsessesessesessesessesessessssesssesessesssesssesessesessssussssessesussssusussessssussesesussessssecessecsesecessesussecesseeesseensseenees 26\nAdditional reading......e.secessesessssssssssssscesssssseccsessssessssessssessssesussesussesussesuesesussesussesussecessecussesessecesseceeseseesecussesessecesseeneseeeeseenees 29\nContinuous integration and d', "eployment with AZUre De@VODS ou... ecessesessessssesessesesseseesesessesessesessesesseensseeeeseeess 30\nPublish the app's Code to GitHub... essssssssssssessssssesscsesscsesscsessesessssessssessesesssseseesecusseceesecesseseesecesseeesseeneseenees 30\nDisconnect local Git CEPlOYMENL..... ee ecessssessesessesessesessesesscsessssessesessesessesessesessesessssesessecsssecusseceeseenssecneseeesseensaeenees 31\n\ni Contents\nCreate an AZUre De@VOPS OFGaNIZ", 'AtiON ........ececsssssssssssessessssessssessssesessesessesessesessesessesessesesseseesesesseseesesesseseeseaeeseeeeseens 31\n\nCreate a team project IN AZUre DeEVOPS OFGaNIZatlON .......eececessssessesssesesesessesessesessesessesessesessesesseseeseseeseeeeneess 32\nConfigure a Self-hosted agent if NECESSALY .......cecsecsssessessessssessessesessessesssessecussesssesesusseesesuesessessesessessecssesseeneaeeaes 32\nConfigure the AZUre PIPeliNeS PiPeEl', 'iNe? oe cccesesessssessessesessessesscsessessesecsessscsssesssesesesseesesussessessssesseeseeesseeseeneaneaes 32\nCommit changes to GitHub and automatically deploy to AZUL uu... eesessessessssesessesessssessesesscseesesesseseeseens 40\nExamine the AZure Pipelines Pipeline oo... ccsssssssesescsesscsesssesscsesscsessesessesessesessssesessecessessssesessesuesecesseeesseensseenees 41\nAdditional reading uu... cceesssssssessssesessesessesessessssesessess', 'sesssesssessssessssessssesussessesessssesussesussessesesussesuesesussesssesessesesseeesseeeeaeeess 47\nContinuous integration and deployment with GItHUD ACTIONS... esesessesessesessessssestssesesseseesesesseetsseeesseees 48\nGITHUD ACTIONS oo. eeeececsessessesseseesessecsesecsecsesscsecuecucscsecucsucsessesucsscsecuesscsesuesucsessecuessssesuesucsessesucaeesesuesecsecsesueaeenesneaeeneeneaneass 48\nSECUrE CODE) WITH COOOL oneeeeeeeececsessessesesses', 'sessesessesseseesessesscsessesucsscsesuesucsecsesuesscsessesucsecsecuesucsecuesuesessecueaeenesneseaeeneenensens 48\nCompare and contrast GitHub Actions and AZUre PIPeliNe oe eecessssessesessessssesessesesseseesesesssseeseseeseeeeseens 49\nContinuous integration and deployment with GItHUD ACTIONS... esesessesessesessessssestssesesseseesesesseetsseeesseees 49\nGITHUD ACTIONS oo. eeeececsessessesseseesessecsesecsecsesscsecuecucscsecucsucsessesucsscsec', 'uesscsesuesucsessecuessssesuesucsessesucaeesesuesecsecsesueaeenesneaeeneeneaneass 49\nSECUrE CODE) WITH COOOL oneeeeeeeececsessessesessessessesessesseseesessesscsessesucsscsesuesucsecsesuesscsessesucsecsecuesucsecuesuesessecueaeenesneseaeeneenensens 50\nCompare and contrast GitHub Actions and AZUre PIPeliNe oe eecessssessesessessssesessesesseseesesesssseeseseeseeeeseens 50\nCompare and contrast GitHub Actions and AZUre PIPeliN@S....... ee cesesesese', 'ssesessesessesessesessesessesesseeesseeesseeeeseeess 50\nPIPELINES AS CODE wa... eeeecesscsessessssesessesessesessesessessssesessesucsesussesssssesssssssssussesussessssssessesucsesesussessesecessecuesesussesuesecessecesseeneaeenees 50\nAGe@Nts ANC FUNNESS ......cecesscsessssessesessesessesessecussesussessssesussesussesussesussessssesussessssesussesussesusseasssesussesusseassesussesesseeessesesseeeeseeess 51\nComparison of GitHub Actions and AZUre Pi', 'peline uu... eecsessescsessessesssesssssesessessecussessessssesseeseeessesseeneaeaes 52\nBuild a .NET Web app USING GItHUD ACTIONS uu... eccsessesessesessesessesessesessesessesessesessesessesessesessesessesessesessesessesesseseeseens 55\nWOrkfIOW StrUCTULe .....esecsessessessesssssesucsucssssucsucsucsucsucsucsucsscsucsscsscsecsscsessecaecsecuscuecuecuscussucsucsucsucsussussuesesseeseeateaeeateateateneenee 55\nCreate a basic DUI WOrkflOW nn... eececs', 'essssssssessesssssessessecsecsecsecsecsecsecsecsessecsecsccsecuccussucsucsussucsucsucsecsecseeseeseeaeeseeseenseaeenss 56\nDissect the Workflow file on... .eeesessesssssessessessessessessessecsecsecsessesscesscuscsesussuceussucsucsucsussucsussucsussessesseeseeseeaeeaeeaeeaeeaeeseeneenes 58\nPUBLISH the OUTPUT uo... ccessesessesessesessesessesessesessesessesssesessssessssssscsssesessesesussssussessssessssesessecessessssesessesuesecnsseeesseeneaeenee', 's 59\nDeploy a .NET Web app USING GItHUD ACTIONS... cecesessesessesessesessesessesessesessesessesessesessesessesessesessesessesesseseeseseeneens 61\nEMVIFOMMENMMS .......esseseeseesessessesessecsccscsecsesscsscsecsesucsecsessesucsssesucsucsesnecucsscsecuesecsessesscsecsecuesucsessecucsessesucaessecnesueneeaeeuenteneeneenenee 61\nAZUFe AUTHENTICATION... eeeesecsessesseseesessessessesessecscsecsessesscsessecuesscsecuesucsecsessesucsecuessesessesuesess', 'esueseesecsesuesesseseeseeaeeneeeeaeeneenenees 62\nAd CNvirONMentts .......eesessessssessessessesessesscssesessesscsessessesucsessessescsecuesucsessessesecsecuesecsessesuesessesucseeseeuesesseesesueneeaeeneeeeseeseenenees 63\nDeploy tO STAGING... ..cecesscsessessssessssesessessssessssesessesessesessesessssessssessssesssssssesessesesssasssssessssesssssssesecessecussessssesnssecssseeesseeneaeenees 65\nDeploy tO PrOdUctiONn ....ecccessesssssssssesssses', 'sssesessessssesessesessesessssessssesssssssesessesessssesssssssssessssessesecessecsesecesseseeseceesecesseeneseenees 68\nAdd a Manual QUEUE OPTION... eeesesessessssessssesessessssesessesessesssesussessssessssecussesussesusseasssesussessssesssesssesesseeesseetsseetsseeess 70\nHandle EnvironMent CONFIGUIATION........ccccecesessessessesessessessssessesseccssessscucsecsessecussesssesssussessecussesseescsesseeseeneseeseeneeeses 71\nContents\nFiral WOrKFIO', 'W FIG wo. eeceeccccscsceccsceccsscscsscsceccsccscsscccsccscsccscsccsccacsccscsecscsecsesacsecscsscscsscacsccsecsesecsesscsesccacacaecsesscsesccacescaeeneas 73\n\nSecure .NET Code with CodeQL and GItHUD Actions 0... ec eescessssessesesseseeseseseeseencsessessesecsecseeneceesesseeeneeneeneaneass 15\nCreate the Code SCANNING WOFKFOW .......cecesesssssesessessesesessessesucsessesucsessessecussessecussusseenesussessecuesessecucsussesseeusseeseeneaneaes 7', '6\nCUSTOMIZE COCEQL SETTINGS .......eecececessssessessssessssesesssssssssessesessesessesessesessesessesessesessesessesessesesseseesesessesesseseesesesseseeseseeseess 79\nREVIEW the SECUTITY Al|MtS oo. essesesessssessssesessesessesessesessesessesessssessesessesessssessesessesessssesessecsssecsesesusseseeseensseeesseeneseenees 80\n\nMonitor and Aebug.............ccccccccccccccscssccsccscsssssssssssssssssssssssssssssscsssssssscsscscscccsscccceccccscscce', 'sscssees 83\n\nBaSiC MONITOFING ANA trOUDlESNOOTING ou... eseesessesessesessessssesessesessesessesessessssesssesssesessessssesssesessesessesessesessesesseseeseseeneens 83\n\nAVANCE” MONITOLING ou... cecessesessesessesessecsesecscsesessecscsecucsecuesesussesussesussecussesussessssesussecussecussesussecsssecessesessecussecussecessecneseeeeseenees 84\n\nProfile With Application INSIGHTS .........ccccessesscsessessesecsessesscsesssssecsssessesscsecsessesuc', 'sesssesssussessecussessecuesusseesecucsesseencsesseeseeneaness 84\n\nLOGGING .ocessssessesessessssesessessssesscsesussesussessssesussesussesussessesesussessssessssesussesussessssesussesussessssessssessssesussesussesussesucsesussesessesessesesneaesseaeeneens 87\n\nLOG StFOAMING ......ecsecessssessesessesessessssesessesssesussessssessssesussessssesussesussessssesussesussessssessssesussessssesussesussesussesessesessesessesessesesseseeseaeeseens 87\n\nALO ', 'rt wee ececsessesssssssessessesessecscsucsecsesucsucsessesuesscsesuesucscsecucsscsecuesucsessesucsucsesuesucsessesucsscsesnecucsecsecuesucsecuesucsessesueseesecnesusaesneeueseeaeeneenenees 88\n\nLIVE CEDUGGIING .....esessesessesessesessesessesssesussesussesussesussesussesussesussesussesussessssesussesussessssesussessssesussesussesussesucsesessesessesessesesseseeseaeeneens 88\n\nCONCIUSION ....eceeesessessessessesessecsessesscsecucsscsecsecucsscsecnes', 'ussscsecucsucsecuesucsscsecucsscaessesucsucsecucsucsesnesuesscsesuesucaessecueaessecuesueseesecueaeeaeeneaeeass 89\n\nAdditional reading......e.secessesessssssssssssscesssssseccsessssessssessssessssesussesussesussesuesesussesussesussecessecussesessecesseceeseseesecussesessecesseeneseeeeseenees 89\n\nNext Steps ...............sscscscccccsssssccccccssssssccccccssscscccccccssssscccccecsssssccceccnsssscccccccsssssccoceccssscscceeeeeseees 90\n\nStOrage ANA ', 'database ou... ccceccssesssssssssssesessscssesecsecesecsssessssecsssecessessssessssessesecsesecsssesesseessseeessessesesessessseeeeseaesseessseeesseeess 90\n\nIAONCITY oe eeccesesessecessesessecscsesussesucsessssesussesussesussesussessssessssesussesussesussesussessssesussessssesessessssesessesussessssesussesessesessesessesessesesseaeeneess 90\n\nMOD Ie oe eeeseesessessesscsessessesscsecsecscsscsecsccucsscsesscsucsessesucsucsesuesucascsesucsecsessesuc', 'scsesucsecsesuesucsessesucsecsesuesucsesnecusaessecucseaeesessaeeneenensens 90\n\nWeb InfrastructUre......cecccsesssssesessssssssscsssssssesseesessessecsessecsecsecsessessessecsessecuscuccuceucsucsucsussucsussussussessesseeseeseeseeaeeaeeateateaeenee 91\n\neee\n\nContents\nCHAPTER |\n\nTools ana downloads\n\nAzure has several interfaces for provisioning and managing resources, such as the Azure portal, Azure\nCLI, Azure PowerShell, Azure Cloud Shell, and Vis', "ual Studio. This guide takes a minimalist approach\nand uses the Azure Cloud Shell whenever possible to reduce the steps required. However, the Azure\nportal must be used for some portions.\n\nPrerequisites\n\nThe following subscriptions are required:\n\n. Azure — If you don't have an account, get a free trial.\n\n. Azure DevOps Services — your Azure DevOps subscription and organization is created in\nChapter 4.\n\n. GitHub — If you don't have an account, sig", 'n up for free.\n\nThe following tools are required:\n\n. Git — A fundamental understanding of Git is recommended for this guide. Review the Git\ndocumentation, specifically git remote and git push.\n\n. .NET Core SDK — Version 2.1.300 or later is required to build and run the sample app. If\nVisual Studio is installed with the .NET Core cross-platform development workload, the\n.NET Core SDK is already installed.\n\nVerify your .NET Core SDK installation. O', 'pen a command shell, and run the following\ncommand:\n\n:{custom-style=CodeBox} dotnetcli dotnet --version :::\n\nRecommended tools (Windows only)\n\n. Visual Studio’s robust Azure tools provide a GUI for most of the functionality described in this\nguide. Any edition of Visual Studio will work, including the free Visual Studio Community\nEdition. The tutorials are written to demonstrate development, deployment, and DevOps both\nwith and without Visual Stu', 'dio.\n\nConfirm that Visual Studio has the following workloads installed:\n\n— ASP.NET and web development\n— Azure development\n\n1 CHAPTER 1 | Tools and downloads\n.NET Core cross-platform development\n\nCHAPTER 1 | Tools and downloads\nCHAPTER 2\n\nDeploy an app to App\nService\n\nAzure App Service is Azure’s web hosting platform. Deploying a web app to Azure App Service can be\ndone manually or by an automated process. This section of the guide discusses depl', 'oyment methods\nthat can be triggered manually or by script using the command line, or triggered manually using\nVisual Studio.\n\nIn this section, you\'ll accomplish the following tasks:\n\n[\'!div class="checklist”]\n\n. Download and build the sample app.\n\n. Create an Azure App Service Web App using the Azure Cloud Shell.\n. Deploy the sample app to Azure using Git.\n\n. Deploy a change to the app using Visual Studio.\n\n. Add a staging slot to the web app.\n\n', ". Deploy an update to the staging slot.\n\n. Swap the staging and production slots.\n\nDownload and test the app\n\nThe app used in this guide is a pre-built ASP.NET Core app, Simple Feed Reader. It’s an ASP.NET Core\nRazor Pages app that uses the Microsoft.SyndicationFeed.ReaderWriter API to retrieve an RSS/Atom\nfeed and display the news items in a list.\n\nFeel free to review the code, but it’s important to understand that there's nothing special about ", "this\napp. It's just a simple ASP.NET Core app for illustrative purposes.\n\nFrom a command shell, download the code, build the project, and run it as follows.\n\nNote\n\nLinux and macOS users should make appropriate changes for paths, for example, using forward slash\n(/) rather than back slash (\\).*\n\n1. Clone the code to a folder on your local machine.\n\n3 CHAPTER 2 | Deploy an app to App Service\n:{custom-style=CodeBox} console git clone https://github.", 'com/dotnet-architecture/simple-\nfeed-reader/ :::\n\nChange your working folder to the simple-feed-reader folder that was created.\n::{custom-style=CodeBox} console cd .\\simple-feed-reader\\SimpleFeedReader :::\nRestore the packages, and build the solution.\n\n:{custom-style=CodeBox} dotnetcli dotnet build :::\n\nRun the app.\n\n:{custom-style=CodeBox} dotnetcli dotnet run :::\n\nCommand Prompt - dotnet run\n\nOpen a browser and navigate to http://localhost:5000', ". The app allows you to type or paste a\nsyndication feed URL and view a list of news items.\n\n| Home page - SimpleFee X | + Vv ha oO x\n\n- C) tnt D localhost 4 Ww *: f£\n\nSimple Feed Reader\n\nEnter a feed URL:\n\nhttp://feeds.hanselman.c\n\nRetrieve Feed\n\nTitle Published\n\nPenny Pinching in the Cloud: Deploying Containers cheaply to Azure 6/15/2018 11:50:21 PM\n+00:00\n\nEarTrumpet 2.0 makes Windows 10's audio subsystem even better...and it's free! 6/13/2018", " 7:34:00 AM\n+00:00\n\nASP.NET Core Architect David Fowler's hidden gems in 2.1 6/11/2018 5:15:24 AM\n+00:00\n\nCarriage Returms and Line Feeds will ultimately bite you - Some Git Tips 6/5/2018 11:37:47 PM\n+00:00\n\nCHAPTER 2 | Deploy an app to App Service\n6.\n\nOnce you're satisfied the app is working correctly, shut it down by pressing Ctrl+C in the\ncommand shell.\n\nCreate the Azure App Service Web App\n\nTo deploy the app, you'll need to create an App Serv", "ice Web App. After creation of the Web App,\nyou'll deploy to it from your local machine using Git.\n\n1.\n\nSign in to the Azure Cloud Shell. Note: When you sign in for the first time, Cloud Shell\nprompts to create a storage account for configuration files. Accept the defaults or provide a\nunique name.\n\nUse the Cloud Shell for the following steps.\n\na. | Declare a variable to store your web app’s name. The name must be unique to be\nused in the default", ' URL. Using the $RANDOM Bash function to construct the name\nguarantees uniqueness and results in the format webappname99999.\n\n{custom-style=CodeBox} console webappname=mywebapp$RANDOM §:::\n\nb. Create a resource group. Resource groups provide a means to aggregate Azure\nresources to be managed as a group.\n\n::{custom-style=CodeBox} azurecli az group create --location centralus --name AzureTutorial\n\nThe az command invokes the Azure CLI. The CLI can b', 'e run locally, but using it in the Cloud\nShell saves time and configuration.\n\nc. Create an App Service plan in the S1 tier. An App Service plan is a grouping of web\napps that share the same pricing tier. The S1 tier isn’t free, but it’s required for the\nStaging slots feature.\n\n={custom-style=CodeBox} azurecli az appservice plan create --name $webappname --\nresource-group AzureTutorial --sku $1 :::\n\nd. Create the web app resource using the App Ser', 'vice plan in the same resource group.\n\n{custom-style=CodeBox} azurecli az webapp create --name $webappname --resource-\ngroup AzureTutorial --plan $webappname :::\n\ne. Set the deployment branch to main in the appsettings configuration.\n\n"{custom-style=CodeBox} azurecli az webapp config appsettings set --name $webappname -\n-resource-group AzureTutorial --settings DEPLOYMENT_BRANCH=main :::\n\nf. Set the deployment credentials. These deployment credent', "ials apply to all the web\napps in your subscription. Don't use special characters in the user name.\n\n::{custom-style=CodeBox} azurecli az webapp deployment user set --user-name\nREPLACE_WITH_USER_NAME --password REPLACE_WITH_PASSWORD :::\n\nCHAPTER 2 | Deploy an app to App Service\ng. Configure the web app to accept deployments from local Git and display the Git\ndeployment URL. Note this URL for reference later.\n\n{custom-style=CodeBox} azurecli echo ", 'Git deployment URL: $(az webapp deployment\nsource config-local-git --name $webappname --resource-group AzureTutorial --query url --\noutput tsv) :::\n\nh. | Display the web app URL. Browse to this URL to see the blank web app. Note this\nURL for reference later.\n\n::{custom-style=CodeBox} console echo Web app URL:\nhttp://$webappname.azurewebsites.net :::\n\n3. | Using a command shell on your local machine, navigate to the web app’s project folder (for\ne', "xample, *.-feed-reader). Execute the following commands to set up Git to push to the\ndeployment URL:\n\na. | Add the remote URL to the local repository.\n::{custom-style=CodeBox} console git remote add azure-prod GIT_.DEPLOYMENT_URL :::\n\nb. Push the local default branch (main) to the azure-prod remote'’s deployment branch\n(main).\n\n:{custom-style=CodeBox} console git push azure-prod main :::\n\nYou'll be prompted for the deployment credentials you crea", 'ted earlier. Observe the output in\nthe command shell. Azure builds the ASP.NET Core app remotely.\n\n4. Ina browser, navigate to the Web app URL and note the app has been built and deployed.\nAdditional changes can be committed to the local Git repository with git commit. These\nchanges are pushed to Azure with the preceding git push command.\n\nDeployment with Visual Studio\n\nNote\n\nThis section applies to Windows only. Linux and macOS users should make', " the change described in\n\nstep 2 below. Save the file, and commit the change to the local repository with git commit. Finally,\npush the change with git push, as in the first section.*\n\nThe app has already been deployed from the command shell. Let’s use Visual Studio's integrated tools\nto deploy an update to the app. Behind the scenes, Visual Studio accomplishes the same thing as the\ncommand line tooling, but within Visual Studio's familiar Ul.\n\n1", '. Open SimpleFeedReader.sln in Visual Studio.\n\n2. In Solution Explorer, open Pages.cshtml. Change <h2>Simple Feed Reader</h2> to\n<h2>Simple Feed Reader - V2</h2>.\n\n3. Press Ctrl+Shift+B to build the app.\n4. —_ In Solution Explorer, right-click on the project and click Publish.\n\n6 CHAPTER 2 | Deploy an app to App Service\n$8 Y ta\n\nUX\n\n‘4\n\nScope to This\n\nNew Solution Explorer View\nShow on Code Map\n\nFile Nesting\n\nEdit SimpleFeedReader.csproj\nAdd\n\nMan', 'age NuGet Packages...\nManage User Secrets\n\nSet as StartUp Project\n\nDebug\n\nSource Control\n\nUnload Project\nOpen Folder in File Explorer\n\nProperties\n\na ten | [*e|- | [=]\n--\n\nirmpleFeedReader (1 project)\n\nExplorer (Ctri+;)\n\nP\nConnected Services\nDependencies\nProperties\nwwwroot\n\nPages\n\nRepositories\nappsettings.json\nbundleconfig-json\nProgram.cs\nStartup.cs\n\nAlt+ Enter\n\nSolution Explorer 9IR eg s-- les\n\n5. Visual Studio can create a new App Service resour', 'ce, but this update will be published over\nthe existing deployment. In the Pick a publish target dialog, select App Service from the list\non the left, and then select Select Existing. Click Publish.\n\n6. Inthe App Service dialog, confirm that the Microsoft or Organizational account used to\ncreate your Azure subscription is displayed in the upper right. If it’s not, click the drop-down\nand add it.\n\n7. Confirm that the correct Azure Subscription is ', 'selected. For View, select Resource Group.\nExpand the AzureTutorial resource group and then select the existing web app. Click OK.\n\nApp Service\n\nHost your web and mobile applications, REST APIs, and more in Azure\n\nSubscription\n\nx\n\nMicrosoft .\ncasoper@microsoft.com\n\nvs-beta\n\nView\n\nResource Group\n\nSearch\n\n© casoper-blog\n\n4 © AzureTutorial\n\nOK Cancel\n\nVisual Studio builds and deploys the app to Azure. Browse to the web app URL. Validate that the\n<h2', '> element modification is live.\n\nCHAPTER 2 | Deploy an app to App Service\nfe <1| |) Homepage-Simplefee X | + Vv a = e\n\n0) 1 mywebapp14483.azurewebsites.net 4 Ww ¢: ff\n\nSimple Feed Reader - V2 y\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - SimpleFeedReader\n\nDeployment slots\n\nDeployment slots support the staging of changes without impacting the app running in production.\nOnce the staged version of the app is validated by a quality assurance team, the', ' production and\nStaging slots can be swapped. The app in staging is promoted to production in this manner. The\nfollowing steps create a staging slot, deploy some changes to it, and swap the staging slot with\nproduction after verification.\n\n1. Sign in to the Azure Cloud Shell, if not already signed in.\n2. Create the staging slot.\n\na. Create a deployment slot with the name staging.\n\n{custom-style=CodeBox} azurecli az webapp deployment slot create -', '-name $webappname\n--resource-group AzureTutorial --slot staging :::\n\nb. Set the deployment branch to main in the appsettings configuration.\n\n"{custom-style=CodeBox} azurecli az webapp config appsettings set --name $webappname -\n-resource-group AzureTutorial --slot staging --settings DEPLOYMENT_BRANCH=main :::\n\nc. Configure the staging slot to use deployment from local Git and get the staging\ndeployment URL. Note this URL for reference later.\n\n{cu', 'stom-style=CodeBox} azurecli echo Git deployment URL for staging: $(az webapp\ndeployment source config-local-git --name $webappname --resource-group AzureTutorial --\nslot staging --query url --output tsv) :::\n\nd. Display the staging slot’s URL. Browse to the URL to see the empty staging slot. Note\nthis URL for reference later.\n\n8 CHAPTER 2 | Deploy an app to App Service\nf.\n\n{custom-style=CodeBox} console echo Staging web app URL: http://$webappna', 'me-\nstaging.azurewebsites.net :::\n\nIn a text editor or Visual Studio, modify Pages/Index.cshtml again so that the <h2> element\nreads <h2>Simple Feed Reader - V3</h2> and save the file.\n\nCommit the file to the local Git repository, using either the Changes page in Visual Studio\'s\nTeam Explorer tab, or by entering the following using the local machine’s command shell:\n\n::{custom-style=CodeBox} console git commit -a -m "upgraded to V3" :::\n\nUsing th', "e local machine's command shell, add the staging deployment URL as a Git remote\nand push the committed changes:\n\na. Add the remote URL for staging to the local Git repository.\n::{custom-style=CodeBox} console git remote add azure-staging\n<Git_staging_deployment_URL> ::\n\nb. | Push the local default branch (main) to the azure-staging remote’s deployment\n\nbranch (main).\n\n:{custom-style=CodeBox} console git push azure-staging main :::\nWait while Azur", 'e builds and deploys the app.\n\nTo verify that V3 has been deployed to the staging slot, open two browser windows. In one\nwindow, navigate to the original web app URL. In the other window, navigate to the staging\nweb app URL. The production URL serves V2 of the app. The staging URL serves V3 of the\n\nSimple Feed Reader - V2\n\nEnter a teed URL:\nRetrieve Feed\n\n© 2017 - Simpler eedReader\n\na. = =I 1.7 Home page - SimpleFee ><\n\n7 mywebapp 14423-staging.a', 'zurewebsites. t\n\nSimple Feed Reader - V3\n\nEnter a teed URL:\n\nRetrieve Feed\n\n©& 2017 - SimpleFeedReader\n\nIn the Cloud Shell, swap the verified/warmed-up staging slot into production.\n\nCHAPTER 2 | Deploy an app to App Service\n={custom-style=CodeBox} azurecli az webapp deployment slot swap --name $webappname -\n-resource-group AzureTutorial --slot staging :::\n\n8. Verify that the swap occurred by refreshing the two browser windows.\n\nSS = 1]. 1 Home pa', 'ge - SimpleFee >< | + ~~ —_—\n\noO\n<— > cD o mywebapp 14483. .azurewebsites.net == vs v= BZ =>\n\nSimple Feed Reader - V3\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - SimpleFeedReader\n\n1.7 Home page - SimpleFee ><\n\ncD - mywebapp 14423-staging.azurewebsites.net\n\nSimple Feed Reader - V2\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - SimpleFeedReader\n\nSummary\n\nIn this section, the following tasks were completed:\n\n. Downloaded and built the sample app.\n\n. Crea', "ted an Azure App Service Web App using the Azure Cloud Shell.\n. Deployed the sample app to Azure using Git.\n\n. Deployed a change to the app using Visual Studio.\n\n. Added a staging slot to the web app.\n\n. Deployed an update to the staging slot.\n\n. Swapped the staging and production slots.\n\nIn the next section, you'll learn how to build a DevOps pipeline with Azure Pipelines.\n\nAdditional reading\n\n° Web Apps overview\n\n° Build a .NET Core and SQL Dat", 'abase web app in Azure App Service\n: Configure deployment credentials for Azure App Service\n\n° Set up staging environments in Azure App Service\n\n10 CHAPTER 2 | Deploy an app to App Service\nCHAPTER\n\nContinuous integration\nand deployment with\nAzure DevOps\n\nNote\n\nThis section details continuous integration and deployment with Azure DevOps. You can achieve that\nwith GitHub Actions as well. GitHub Actions is a workflow engine built into GitHub that ca', "n also be\n\nused for continuous integration and deployment. To follow the guide for building and deploying to\nAzure using GitHub, complete the Publish the app’s code to GitHub and Disconnect local Git\ndeployment sections below and then proceed to the GitHub Actions section.\n\nIn the previous chapter, you created a local Git repository for the Simple Feed Reader app. In this\nchapter, you'll publish that code to a GitHub repository and construct an A", 'zure DevOps Services\npipeline using Azure Pipelines. The pipeline enables continuous builds and deployments of the app.\nAny commit to the GitHub repository triggers a build and a deployment to the Azure Web App’s\nStaging slot.\n\nIn this section, you\'ll complete the following tasks:\n\n[\'!div class="checklist”]\n\n. Publish the app’s code to GitHub\n\n. Disconnect local Git deployment\n\n. Create an Azure DevOps organization\n\n. Create a team project in Azu', 're DevOps organization\n\n. Configure a self-hosted agent if necessary\n\n. Create a build definition\n\n. Create a release pipeline\n\n. Commit changes to GitHub and automatically deploy to Azure\n\n° Examine the Azure Pipelines pipeline\n\n11 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPublish the app’s code to GitHub\n\n1. Open a browser window, and navigate to https://github.com.\n\n2. Click the + drop-down in the header, and select N', 'ew repository:\n\nNew repository\n\nImport repository\nNew gist\n\nNew organization\n\n1. | Select your account in the Owner drop-down, and enter simple-feed-reader in the Repository\nname textbox.\n\n2. Click the Create repository button.\n\n3. | Open your local machine’s command shell. Navigate to the directory in which the simple-feed-\nreader Git repository is stored.\n\n4. Rename the existing origin remote to upstream. Execute the following command:\n::{custo', 'm-style=CodeBox} console git remote rename origin upstream :::\n\n5. Add a new origin remote pointing to your copy of the repository on GitHub. Execute the\nfollowing command:\n\n“{custom-style=CodeBox} console git remote add origin\nhttps://github.com/<GitHub_username>/simple-feed-reader/ :::\n\n6. Publish your local Git repository to the newly created GitHub repository. Execute the following\ncommand:\n\n:{custom-style=CodeBox} console git push -u origin ', 'main :::\n\n7. Open a browser window, and navigate to https://github.com/<GitHub_username>/simple-\nfeed-reader/. Validate that your code appears in the GitHub repository.\n\nDisconnect local Git deployment\n\nRemove the local Git deployment with the following steps. Azure Pipelines (an Azure DevOps service)\nboth replaces and augments that functionality.\n\n1. Open the Azure portal, and navigate to the staging (mywebapp<unique_number>/staging)\nWeb App. Th', 'e Web App can be quickly located by entering staging in the portal’s search box:\n\n12 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nClick Deployment Center. A new panel appears. Click Disconnect to remove the local Git\nsource control configuration that was added in the previous chapter. Confirm the\nremoval operation by clicking the Yes button.\n\n1. Navigate to the mywebapp App Service. As a reminder, the portal’s search box ca', 'n be used to\nquickly locate the App Service.\n\n2. Click Deployment Center. A new panel appears. Click Disconnect to remove the local Git\nsource control configuration that was added in the previous chapter. Confirm the removal\noperation by clicking the Yes button.\n\nCreate an Azure DevOps organization\n\nOpen a browser, and navigate to the Azure DevOps organization creation page.\nSelect New organization\n\n1\n2\n3. Confirm the information, and then select', ' Continue.\n4\n\nSign in to your organization at any time, https://dev.azure.com/{yourorganization}\n\nCreate a team project in Azure DevOps organization\n\n1. | Choose the organization, and then select New project.\n2. Enter the project name as MyFirstProject and select the Visibility as Private\n\n3. Select Create project.\n\nFor more information, see Create a project\n\nContigure a selt-hosted agent if necessary\n\nTo build your code or deploy your software u', 'sing Azure Pipelines, you need at least one agent. In\nAzure Pipelines, you can run parallel jobs on either Microsoft-hosted or self-hosted agent. But with\nthe recent change in Azure Pipelines free grant of parallel jobs is temporarily disable for the public\n\nprojects.For more details, refer Configure and pay for parallel jobs.\n\nGo to Organization Settings and then Pipelines > Parallel jobs. If you see value 0 under Microsoft-\nhosted that means yo', "u need a Self-hosted agent to run your pipeline.\n\n13 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPublic projects\n\nFree\n\nMicrosoft-hosted (i)\n\nView in-progress jobs\n\nSelf-hosted (i) Unlimited\nParallel jobs\nView in-progress jobs\n\nYou can create that by following details mentioned in Self-hosted agents. After successful\nconfiguration, you'll be able to see available agent under Organization Settings > Agent pools >\n{youragent", 'name}\n\nJobs Agents Details Security Settings Maintenance History\n\nName Last run Current status Agent version Enabled\n\na= @ on\n\nec Yesterday Idle 2.185.1\nOnline\n\nConfigure the Azure Pipelines pipeline\n\nThere are three distinct steps to complete. Completing the steps in the following three sections results\nin an operational DevOps pipeline.\n\nGrant Azure DevOps access to the GitHub repository\n\n1. In your project, navigate to the Pipelines page. Then', ' choose the action to create a new\npipeline:\n\nCreate your first Pipeline\n\nAutomate your build and release processes using our wizard, and go from\ncode to cloud-hosted within minutes.\n\nCreate Pipeline\n\n14 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n1.\n\n1.\n\n1.\n\n15\n\nUse Use the classic editor to create the pipeline.\n\nConnect Select Configure Review\n\nNew pipeline\n\nWhere is your code?\n\nAzure Repos Git YAML\n\n29\n\nBitbucket Cloud ', "YAML\n\nC) GitHub YAML\nHome to the world's largest community of developers\n\nC) GitHub Enterprise Server YAML\nThe self-hosted version of GitHub Enterprise\n> Other Git\nAny generic Git repositor\nm= Subversion\net Centralized version control by Apache\n\nSelect the GitHub option from the Select a source section::\n\nSelect a source\n\nqi ¢) = | ©\n\nVSTS Git GitHub GitHub Enterprise Subversion Bitbucket® Cloud External Git\n\nAuthorization is required before Azur", 'e DevOps can access your GitHub repository. Enter\nGitHub connection in the Connection name textbox. For example:\n\nG) We need your authorization to access your repositones\n\nConnection name *\n\nscottaddie GitHub connection\n\nAuthorize using OAuth Or Authorize with a GitHub personal access token\n\nIf two-factor authentication is enabled on your GitHub account, a personal access token Is\nrequired. In that case, click the Authorize with a GitHub personal', ' access token link. See the\n\nofficial GitHub personal access token creation instructions for help. Only the repo scope of\npermissions is needed. Otherwise, click the Authorize using OAuth button.\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n2. When prompted, sign in to your GitHub account. Then select Authorize to grant access to\nyour Azure DevOps organization. If successful, a new service endpoint is created.\n\n3. — Click ', 'the ellipsis button next to the Repository button. Select the /simple-feed-reader\nrepository from the list. Click the Select button.\n\n4. Select the default branch (main) from the Default branch for manual and scheduled builds\ndrop-down. Click the Continue button. The template selection page appears.\n\nCreate the build definition\n\n1. From the template selection page, enter ASP.NET Core in the search box:\n\nOr start with an |2y Empty pipeline\n\nOthers', '\n\n> ASP.NET Core\n\ndotnet\n\nBuild and test an ASP.NET Core web application.\n\nASP.NET Core (.NET Framework)\n\nBuild an ASP.NET Core web application that targets the\nTull NET Framework.\n\n1. |The template search results appear. Hover over the ASP.NET Core template, and click the\nApply button.\n\n2. The Tasks tab of the build definition appears. Select the self-hosted Agent pool if you have\ncreated that in the earlier step.\n\nTasks Variables Triggers Optio', 'ns Retention History = Save & queue\n\nPipeline\n= Get sources\n\nAgent job 1\n\nI] Use NuGet 4.4.1\n\nParameters Q | & Unlinks\n\nI] NuGet restore Path to solution or packages.config * @\ncd | Build solution\n[=> Publish symbols path\n\n* Publish Artifact\n\n> [!NOTE]\n> If you are using MS-hosted agent then select the *Hosted > Azure Pipelines* from\ndrop down.\n\n16 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n1. Click the Triggers tab.\n\n2. ', 'Check the Enable continuous integration box. Under the Branch filters section, confirm\nthat the Type drop-down is set to /nclude. Set the Branch specification drop-down to main.\n\n@ Enable continuous integration\n\n[_] Batch changes while a build is in progress\n\nBranch filters\n\nType Branch specification\nInclude main\n\n+ Add\n\nPath filters\n\n+ Add\n\nThese settings cause a build to trigger when any change is pushed to the default\n\nbranch (*main*) of the G', 'itHub repository. Continuous integration is tested in the\n[Commit changes to GitHub and automatically deploy to Azure] (#commit -changes-to-\n\ngithub-and-automatical) section.\n\n1. Click the Save & queue button, and select the Save option:\n\n=] Save & queue “\n\nSave & queue\n\n1. The following modal dialog appears:\nI\nSave build definition *\n\nSelect folder *\n\n\\\n\nComment\n\nSave Cancel\n\nUse the default folder of *\\\\*, and click the **Save** button.\n\n17 CHA', 'PTER 3 | Continuous integration and deployment with Azure DevOps\nCreate the release pipeline\n\n1.\n\nClick the Releases tab of your team project. Click the New pipeline button.\n\nEe overview\nBB Boards\nRepos\n@ Pipelines\n\nPe Pipelines\n\n& Environments\n\nEs\n\nH\\ Library\n\n. .\n\n= Task groups No release pipelines found\n\nT Deployment groups Automate your release process in a few easy steps with a new pipeline\n\nA Test Plans New pipeline\nBB artifacts\n\nThe templa', 'te selection pane appears.\n\n1.\n\n1.\n\n18\n\nFrom the template selection page, enter App Service Deployment in the search box:\n\nSelect a template Azure App Service Deploy\n\nFeatured\n\neS Azure App Service deployment\n\nOthers\n\nAzure App Service deployment with continuous\nmonitoring\n\nAzure App Service deployment with slot\n\nperformance tests\n\nAzure Service Fabric Compose deployment\n\neS Azure App Service deployment with tests and\n\nAzure Service Fabric deploy', 'ment\n\nThe template search results appear. Hover over the Azure App Service Deployment with\nSlot template, and click the Apply button. The Pipeline tab of the release pipeline appears.\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n19\n\nAll pipelines > ™ New release pipeline\n\nPipeline © Tasks Variables Retention Options History\n\nArtifacts | -+- Add Stages | -+ Add ~\n\n% Stage\n2 © 1)ob, 2 tasks\n\nL\n\nfe) Schedule\n\nnot set\n\nAdd art', 'ifact\n\nSource type\n\n© ©)\n\nBuild Git GitHub\n\n3 more artifact types ~\nProject* (Gi)\n\nMyFirstProject\n\nSource (Build definition)* @\n\nClick the Add button in the Artifacts box. The Add artifact panel appears:\n\na\n\nTeam Found...\n\n() This setting is required.\n\nSelect MyFirstProject from the Project drop-down.\n\nSelect the build definition name, MyFirstProject-ASP.NET Core-Cl, from the Source (Build\ndefinition) drop-down.\n\nSelect the Build tile from the So', 'urce type section. This type allows for the linking of the\nrelease pipeline to the build definition.\n\nSelect Latest from the Default version drop-down. This option builds the artifacts produced\nby the latest run of the build definition.\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\nReplace the text in the Source alias textbox with Drop.\n6. Click the Add button. The Artifacts section updates to display the changes.\n\nClick th', 'e lightning bolt icon to enable continuous deployments:\n\nArtifacts | — Add\n\n~~\nees]\nCrap\n\nSchedule\n© mot set\n\nWith this option enabled, a deployment occurs each time a new build is available.\n\n1. A Continuous deployment trigger panel appears to the right. Click the toggle button to\n\nenable the feature. It isn’t necessary to enable the Pull request trigger.\n\n2. Click the Add drop-down in the Build branch filters section. Choose the Build Definitio', 'n’s\ndefault branch option. This filter causes the release to trigger only for a build from the\n\nGitHub repository’s default branch (main).\n\n3. Click the Save button. Click the OK button in the resulting Save modal dialog.\n4. Click the Stage 1 box. An Stage panel appears to the right. Change the Stage 7 text in the\n\nStage name textbox to Production.\n\nAdd »\nStages | + Ac Stage [ll] Delete\n\nProduction\n\n& Properties A\n\nZB Production Name and owners o', 'f the stage\n\n2 © 1)job, 2 tasks\n\n| Stage name\nL\n\nProduction\n\nStage owner\n\n1. Click the 1 phase, 2 tasks link in the Production box:\n\n20 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nStages | ++ Add ~\n\nYJ\n\nProduction\n\nA [ormeem |\n—————\n\nThe **Tasks** tab of the environment appears.\n\n1. Click the Deploy Azure App Service to Slot task. Its settings appear in a panel to the right.\n\nSelect the Azure subscription associated with t', "he App Service from the Azure subscription\ndrop-down. Once selected, click the Authorize button.\n\nSelect Web App from the App type drop-down.\n\nSelect mywebapp/ from the App service name drop-down.\nSelect AzureTutorial from the Resource group drop-down.\nSelect staging from the Slot drop-down.\n\nSelect Run on agent* under Tasks. On the right pane, you'll see Agent Job.\n\nCoN DW WwW\n\nSelect the self-hosted Agent pool if you have created that in the ea", 'rlier step.\n\nProduction . - -\nDeployment proces Agent job @ [ll] Remove\n\nDisplay name *\n\nRun on agent\n\nAgent selection ~\n\n("3 Deploy Azure App Service to Slot\n\nManage Azure App Service - Slot Swap\n\nAgent pool @ | Pool information | Manage 2\n\nDefault\n\nExecution plan A\n\n> [NOTE]\n> If you are using MS-hosted agent then select the *Hosted > Azure Pipelines* from\ndrop down.\n\n1. Click the Save button.\n\n2. Hover over the default release pipeline name. C', 'lick the pencil icon to edit it. Use\nMyFirstProject-ASP.NET Core-CD as the name.\n\n21 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nCJ MyFirstProject / MyFirst... ““ Dashboards Code Work Build a\n\nBuilds Releases Library Task Groups Deployment Groups\n\nAll definitions > *|MyFirstProject-ASP.NET Core-CD\n\n1. Click the Save button.\n\nCommit changes to GitHub and automatically\ndeploy to Azure\n\n1. Open SimpleFeedReader.sln in Visual ', 'Studio.\n\n2. In Solution Explorer, open Pages.cshtml. Change <h2>Simple Feed Reader - V3</h2> to\n<h2>Simple Feed Reader - V4</h2>.\n\n3. Press Ctrl+Shift+B to build the app.\n\n4. Commit the file to the GitHub repository. Use either the Changes page in Visual Studio\'s\nTeam Explorer tab, or execute the following using the local machine’s command shell:\n\n:{custom-style=CodeBox} console git commit -a -m "upgraded to V4" :::\n\n5. Push the change in the def', "ault branch (main) to the origin remote of your GitHub repository.\nIn the following command, replace the placeholder {BRANCH} with the default branch (use\nmain):\n\n:{custom-style=CodeBox} console git push origin {BRANCH} :::\n\nThe commit appears in the GitHub repository’s default branch (main). You'll be able to see the\ncommit history in https://github.com/<GitHub_username>/simple-feed-\nreader/commits/main.\n\nThe build is triggered, since continuous", " integration is enabled in the build definition’s\n\nTriggers tab:\n\nTasks Variables Triggers Options Retention History\n\nContinuous integration\nJ © scottaddie/simple-feed-reader\n\nC) scottaddie/simple-feed-reader\n\nEnabled\n\n22 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n1. Navigate to the Pipelines. You'll see the Cl pipeline details and monitor each steps if you drill\ndown Jobs details.\n\nRecent All Runs Y/ Filter pipelines\n\nRe", 'cently run pipelines\n\nPipeline Last run\n\n#20210420.5 * Update Index.cshtml 3 Just now\n@ MyFirstProject-ASP.NET Core (.NET Frame... - -\n\n1. Similarly, go to the Releases tab to see the details of CD pipeline. You can always drill down\nfurther to see more details of each step.\n\nO Search all pipelines . . :\nmer pips MyFirstProject-ASP.NET Core-CD 7 Edit\n= 5 wW ++ New v Releases Deployments Analytics ==] Allreleases YY :\n\nMyFirstProject-ASP.NET Core-', '... vs\n®@ Production -\n\nRelease-3 ;\n4, 20210420 ; 4/20/2021, 12:58:08 PM © Production\nty 20210420..... 5 main\n\n1. Once the build succeeds, a deployment to Azure occurs. Navigate to the app in the browser.\nNotice that the “V4” text appears in the heading:\n\nSimple Feed Reader - V4\n\nEnter a feed URL:\nRetrieve Feed\n\n@ 2017 - SimpleFeedReader\n\nExamine the Azure Pipelines pipeline\n\nBuild definition\n\nA build definition was created with the name MyFirstP', 'roject-ASP.NET Core-C/. Upon completion, the\nbuild produces a .zip file including the assets to be published. The release pipeline deploys those\nassets to Azure.\n\nThe build definition’s Tasks tab lists the individual steps being used. There are five build tasks.\n\n23 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nTasks\n\n> MyFirstProject-ASP.NET Core (.NET Framework)-Cl\nVariables Triggers\nPipeline\n\nBuild pipeline\n\nOptions Reten', 'tion History\n\nGet sources\n©) sughosneo/simple-feed-reader\nAgent job 1\n= Runon ag\n\n=!\n\ntil\n\n*\n\ne)\n\nUse NuGet 4.4.1\n\nee\nhs a en 2\nHo JuGet toc Sta llé\n\nNuGet restore\nNuGet\n\nBuild solution\nVisual Stud\n\nfm Bai\n\nbui a\n\nae)\n\nTest Assemblies\nVisual St\n\nPa rat\n\nii)\n\nee\n\nK\nI»\n\nrom ci\n\nPublish symbols path\nOe SOUrCesS amd ob\n\nSmt et\n\n>\n\nm\n\nPublish Artifact\n\nblish symbols\nPublish build artifacts\n\ndefault package feed used is nuget.org.\n\nneeded.\n\nRestore — E', 'xecutes the dotnet restore command to restore the app’s NuGet packages. The\nBuild — Executes the dotnet build --configuration release command to compile the app’s\n\ncode. This --configuration option is used to produce an optimized version of the code, which\n24\n\nis suitable for deployment to a production environment. Modify the BuildConfiguration\nvariable on the build definition’s Variables tab if, for example, a debug configuration is\nTest — Execu', "tes the dotnet test --configuration release --logger trx --results-directory\nand isn't deployed.\n\n<local_path_on_build_agent> command to run the app’s unit tests. Unit tests are executed\nwithin any C# project matching the **/Tests/.csproj glob pattern. Test results are saved in a .trx\n\nfile at the location specified by the --results-directory option. If any tests fail, the build fails\n\nCHAPTER 3 | Continuous integration and deployment with Azure ", 'DevOps\n[INOTE] To verify the unit tests work, modify SimpleFeedReader.Tests.cs to purposefully break\none of the tests. For example, change Assert.True(result.Count > 0); to\nAssert.False(result.Count > 0); in the Returns_News_ Stories _Given_Valid_Uri method. Commit\nand push the change to GitHub. The build is triggered and fails. The build pipeline status\nchanges to failed. Revert the change, commit, and push again. The build succeeds.\n\n4. Publish', ' — Executes the dotnet publish --configuration release --output\n<local_path_on_build_agent> command to produce a .zip file with the artifacts to be\ndeployed. The --output option specifies the publish location of the .zip file. That location is\nspecified by passing a predefined variable named $(build.artifactstagingdirectory). That\nvariable expands to a local path, such as *c:_work\\1, on the build agent.\n\n5. Publish Artifact — Publishes the .zip f', 'ile produced by the Publish task. The task accepts the\nzip file location as a parameter, which is the predefined variable\n$(build.artifactstagingdirectory). The .zip file is published as a folder named drop.\n\nClick the build definition’s Summary link to view a history of builds with the definition:\n\nTasks Variables Triggers Options Retention History > Queue\nOn the resulting page, click the individual build for more details.\n< MyFirstProject-ASP.N', 'ET Core (.NET Framework)-Cl Edit :\nRuns Branches Analytics Y\nDescription\n#20210420.5 Update Index.cshtml & 19m ago\nndividual Cl for % main 97¢@a2b ° D 41s\n#20210420.4 Update Index.cshtml & 36m ago\nndividual Cl for nai d1077bb ° ® 40s -\n#20210420.3 Update Index.cshtml & 40m ago\nndividual Cl for > main 58b2b8e ° 5 1m 0s\n#20210420.2 Update Index.cshtml & thago\nndividual Cl for nair cb034f7 iv) 5 41s\n\nA summary of this specific build is displayed. Cl', 'ick the published link, and notice the drop folder\nproduced by the build is listed:\n\n25 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n@ #20210420.5 Update Index.cshtm! | Run new [iE\n\non MyFirstProject-ASP.NET Core (.NET Framework)-Cl Retained by re\n\nease\n\nSummary Releases\n\nTriggered by < sughosneo\n\nView change\nRepository and version Time started and elapsed Related Tests and coverage\n© sughosneo/simple-feed-reader i Today at', ' 1:14 PM 0 A Get started\nmain ° 97c0a2b © 41s\n\n1 published; 1 consumed\n\nArtifacts\n\nPublished Consume d\n\n906 KB\n\nUse the ellipsis and click on Downloads artifacts links to inspect the published artifacts.\n\nRelease pipeline\n\nA release pipeline was created with the name MyFirstProject-ASP.NET Core-CD:\n\nPipeline —_— Tasks Variables Retention Options History\nArtifacts | -- Add Stages | -+ Add\n%\nan % — Production Q\nDrop 2 1 job, 2 tasks\n\nThe two major ', 'components of the release pipeline are the Artifacts and the Stages. Clicking the box\nin the Artifacts section reveals the following panel:\n\n26 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPipeline —_ Tasks Variables Retention Options History\n\nArtifact [lil] Delete\nArtifacts | -+- Add Stages | -+ Add Build - Drop\n\nProject* @\n\nMyFirstProject\n% | Produc\nbe 1 job, 27\n\nSource (build pipeline)* @\n\nMyFirstProject-ASP.NET Core (.N', 'ET Framework)-Cl\n\n© Schedule\n\nnot set\n\nDefault version* (i)\nLatest v\nSource alias* (i)\n\nDrop\n\nThe Source (Build definition) value represents the build definition to which this release pipeline is\nlinked. The .zip file produced by a successful run of the build definition is provided to the Production\nenvironment for deployment to Azure. Click the 7 phase, 2 tasks link in the Production environment\nbox to view the release pipeline tasks:\n\nPipeline ', 'Tasks ~ Variables Retention Options =F\n\nProduction _\nDeployment process\n\nPhase +\n\nee Run on agent\n\nDeploy Azure App Service to Slot\nfH Azure App Service Deploy\n\nra Manage Azure App Service - Slo...\n= .\nes Azure App Service Manage\n\nThe release pipeline consists of two tasks: Deploy Azure App Service to Slot and Manage Azure App\nService - Slot Swap. Clicking the first task reveals the following task configuration:\n\n27 CHAPTER 3 | Continuous integra', 'tion and deployment with Azure DevOps\nPipeline Tasks ~ Variables Retention Options Ff\n\nProduction\nDeployment process\n\nPhaset +\n\nea Run on agent\n\nDeploy Azure App Service to Slot\nh Azure App Service Deploy\n\nro Manage Azure App Service - Slo...\n= .\nes) Azure App Service Manage\n\nThe Azure subscription, service type, web app name, resource group, and deployment slot are defined\nin the deployment task. The Package or folder textbox holds the .zip file', ' path to be extracted and\ndeployed to the staging slot of the mywebapp<unique_number> web app.\n\nClicking the slot swap task reveals the following task configuration:\n\n28 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nAzure App Service Manage @\n\nVersion 0.* ee\n\nDisplay name *\n\nManage Azure App Service - Slot Swap\n\nAzure subscription * @ | Manage EC\n\nVisual Studio Enterprise ww C)\nAction Gi)\nSwap Slots ‘\n\nApp Service name* ()\n\n', 'mywebapp113a5/ ‘ C)\n\nResource group* ()\n\nAzureTutorial ww C)\n\nSource Slot* (i)\n\nstaging “ C)\n| Swap with Production @\n| | Preserve Vnet (i)\n\nThe subscription, resource group, service type, web app name, and deployment slot details are\nprovided. The Swap with Production check box is checked. Consequently, the bits deployed to the\nstaging slot are swapped into the production environment.\n\nAdditional reading\n\n° Create your first pipeline with Azure ', 'Pipelines\n° Build and .NET Core project\n° Deploy a web app with Azure Pipelines\n\n29 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nContinuous integration and deployment with Azure\nDevOps\n\nNote\n\nThis section details continuous integration and deployment with Azure DevOps. You can achieve that\nwith GitHub Actions as well. GitHub Actions is a workflow engine built into GitHub that can also be\n\nused for continuous integration and', " deployment. To follow the guide for building and deploying to\nAzure using GitHub, complete the Publish the app’s code to GitHub and Disconnect local Git\ndeployment sections below and then proceed to the GitHub Actions section.\n\nIn the previous chapter, you created a local Git repository for the Simple Feed Reader app. In this\nchapter, you'll publish that code to a GitHub repository and construct an Azure DevOps Services\npipeline using Azure Pipe", 'lines. The pipeline enables continuous builds and deployments of the app.\nAny commit to the GitHub repository triggers a build and a deployment to the Azure Web App’s\nStaging slot.\n\nIn this section, you\'ll complete the following tasks:\n\n[\'!div class="checklist”]\n\n. Publish the app’s code to GitHub\n\n. Disconnect local Git deployment\n\n. Create an Azure DevOps organization\n\n. Create a team project in Azure DevOps organization\n\n. Configure a self-hos', 'ted agent if necessary\n\n. Create a build definition\n\n. Create a release pipeline\n\n. Commit changes to GitHub and automatically deploy to Azure\n\n° Examine the Azure Pipelines pipeline\n\nPublish the app’s code to GitHub\n\n1. Open a browser window, and navigate to https://github.com.\n\n2. Click the + drop-down in the header, and select New repository:\n\nm +~\n—————V\n\nNew repository\n\nImport repository\nNew gist\n\nNew organization\n\n30 CHAPTER 3 | Continuous ', 'integration and deployment with Azure DevOps\n1. | Select your account in the Owner drop-down, and enter simple-feed-reader in the Repository\nname textbox.\n\n2. Click the Create repository button.\n\n3. | Open your local machine’s command shell. Navigate to the directory in which the simple-feed-\nreader Git repository is stored.\n\n4. Rename the existing origin remote to upstream. Execute the following command:\n::{custom-style=CodeBox} console git remo', 'te rename origin upstream :::\n\n5. Add a new origin remote pointing to your copy of the repository on GitHub. Execute the\nfollowing command:\n\n“{custom-style=CodeBox} console git remote add origin\nhttps://github.com/<GitHub_username>/simple-feed-reader/ :::\n\n6. Publish your local Git repository to the newly created GitHub repository. Execute the following\ncommand:\n\n:{custom-style=CodeBox} console git push -u origin main :::\n7. Open a browser window', ', and navigate to https://github.com/<GitHub_username>/simple-\n\nfeed-reader/. Validate that your code appears in the GitHub repository.\n\nDisconnect local Git deployment\n\nRemove the local Git deployment with the following steps. Azure Pipelines (an Azure DevOps service)\nboth replaces and augments that functionality.\n\n1. Open the Azure portal, and navigate to the staging (mywebapp<unique_number>/staging)\nWeb App. The Web App can be quickly located ', 'by entering staging in the portal’s search box:\n\n1. Click Deployment Center. A new panel appears. Click Disconnect to remove the local Git\nsource control configuration that was added in the previous chapter. Confirm the removal\noperation by clicking the Yes button.\n\n2. Navigate to the mywebapp App Service. As a reminder, the portal’s search box can be used to\nquickly locate the App Service.\n\n3. Click Deployment Center. A new panel appears. Click ', 'Disconnect to remove the local Git\nsource control configuration that was added in the previous chapter. Confirm the removal\noperation by clicking the Yes button.\n\nCreate an Azure DevOps organization\n\n1. Open a browser, and navigate to the Azure DevOps organization creation page.\n2. Select New organization\n\n3. Confirm the information, and then select Continue.\n\n31 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n4. Sign in to yo', 'ur organization at any time, https://dev.azure.com/{yourorganization}\n\nCreate a team project in Azure DevOps organization\n1. | Choose the organization, and then select New project.\n2. Enter the project name as MyFirstProject and select the Visibility as Private\n3. Select Create project.\n\nFor more information, see Create a project\n\nConfigure a self-hosted agent if necessary\n\nTo build your code or deploy your software using Azure Pipelines, you nee', 'd at least one agent. In\nAzure Pipelines, you can run parallel jobs on either Microsoft-hosted or self-hosted agent. But with\nthe recent change in Azure Pipelines free grant of parallel jobs is temporarily disable for the public\n\nprojects.For more details, refer Configure and pay for parallel jobs.\n\nGo to Organization Settings and then Pipelines > Parallel jobs. If you see value 0 under Microsoft-\nhosted that means you need a Self-hosted agent to', " run your pipeline.\n\nPublic projects\n\nFree\n\nMicrosoft-hosted (i)\n\nView in-progress jobs\n\nSelf-hasted (i) ilimited\n\n=\nmle\n\ni |\n\nara\n\nView in-progress jobs\n\nYou can create that by following details mentioned in Self-hosted agents. After successful\nconfiguration, you'll be able to see available agent under Organization Settings > Agent pools >\n{youragentname}\n\nJobs Agents Details Security Settings Maintenance History\n\nName Last run Current status Ag", 'ent version Enabled\n\nYesterday Idle 2.185.1 @® on\n\nConfigure the Azure Pipelines pipeline\n\nThere are three distinct steps to complete. Completing the steps in the following three sections results\nin an operational DevOps pipeline.\n\n32 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nGrant Azure DevOps access to the GitHub repository\n\n1.\n\n33\n\nIn your project, navigate to the Pipelines page. Then choose the action to create a new', '\npipeline:\n\nCw\nCreate your first Pipeline\n\nAutomate your build and release processes using our wizard, and go from\ncode to cloud-hosted within minutes.\n\nCreate Pipeline\n\nUse Use the classic editor to create the pipeline.\n\nConnect Select Configure Review\nee\n\nNew pipeline\n\nWhere is your code?\n\nSit repositories, pull requests, and code search\n\nBitbucket Cloud YAML\n\nHosted by Atlassian\n\nws) GitHub YAML\nHome to the world’s largest community of develop', 'ers\n\nwe) GitHub Enterprise Server YAML\n\nThe self-hosted version of GitHub Enterprise\n® Other Git\n\nAny generic Git repository\n= Subversion\n\nUse the classic editor to create a pipeline without YAML.\n\nSelect the GitHub option from the Select a source section::\n\nSelect a source\n\nee, ©) = U ©\n\nVSTS Git GitHub GitHub Enterprise Subversion Bitbucket® Cloud External Git\n\nAuthorization is required before Azure DevOps can access your GitHub repository. Ent', 'er\nGitHub connection in the Connection name textbox. For example:\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n@ We need your authorization to access your repositones\n\nConnection name *\n\nscottaddie GitHub connection\n\nAuthorize using OAuth Or Authorize with a GitHub personal access token\n\n1. If two-factor authentication is enabled on your GitHub account, a personal access token is\nrequired. In that case, click the Authorize', ' with a GitHub personal access token link. See the\n\nofficial GitHub personal access token creation instructions for help. Only the repo scope of\npermissions is needed. Otherwise, click the Authorize using OAuth button.\n\n2. When prompted, sign in to your GitHub account. Then select Authorize to grant access to\nyour Azure DevOps organization. If successful, a new service endpoint is created.\n\n3. — Click the ellipsis button next to the Repository bu', 'tton. Select the /simple-feed-reader\nrepository from the list. Click the Select button.\n\n4. Select the default branch (main) from the Default branch for manual and scheduled builds\ndrop-down. Click the Continue button. The template selection page appears.\n\nCreate the build definition\n\n1. From the template selection page, enter ASP.NET Core in the search box:\n\nOr start with an |3y Empty pipeline\n\nOthers\n\n> ASP.NET Core\n\ndotnet\nBuild and test an AS', 'P.NET Core web application.\n\n5 ASP.NET Core (NET Framework)\n\nBuild an ASP.NET Core web application that targets the\nfull NET Framework.\n\nThe template search results appear. Hover over the ASP.NET Core template, and click\nthe Apply button.\n\n1. The Tasks tab of the build definition appears. Select the self-hosted Agent pool if you have\ncreated that in the earlier step.\n\n34 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nAgent jo', 'b 1\n\ni. Use NuGet 4.4.1\n\nParameters ©\n\n@) Uniink all\nr.) NuGet restore Path to solution or packages.config *\nBuild solution\na) ; Artifact Name *\nA Test Assemblies drop\n=) Publish symbols path\net\nt Publish Artifact\n> [NOTE]\n\n> If you are using MS-hosted agent then select the *Hosted > Azure Pipelines* from\ndrop down.\n\n1. Click the Triggers tab.\n\n2. Check the Enable continuous integration box. Under the Branch filters section, confirm\n\nthat the Typ', 'e drop-down is set to /nclude. Set the Branch specification drop-down to main\n\n@ Enable continuous integration\n\n[_] Batch changes while a build is in progress\n\nBranch filters\n\nType Branch specification\nInclude a main\n\nt- Add\n\nPath filters\n\n+- Add\n\nThese settings cause a build to trigger when any change is pushed to the default\nbranch (*main*) of the GitHub repository. Continuous integration is tested in the\n\n[Commit changes to GitHub and automati', 'cally deploy to Azure] (#commit -changes-to-\ngithub-and-automatical) section.\n\n1. Click the Save & queue button, and select the Save option:\n\n35 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n| Save & queue “\n\nSave & queue\n\n1. The following modal dialog appears:\n\nct\n\nSave build definition x\nrT\n| Select folder *\n\nComment\n\nSave Cancel\n\nUse the default folder of *\\\\*, and click the **Save** button.\n\nCreate the release pipeline\n1', '. Click the Releases tab of your team project. Click the New pipeline button.\n\nEe overview\nGB Boards\nRepos\n@ Pipelines\n\ndy Pipelines\n\n& Environments\n\nee /\n\nH\\ Library\n\n= Task groups No release pipelines found\n\n7. Deployment groups Automate your release process in a few easy steps with a new pipeline\nA Test Plans\n\nPo Artifacts\n\n36 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nThe template selection pane appears.\n\n1. From the ', 'template selection page, enter App Service Deployment in the search box:\n\nSelect a template\n\nAzure App Service Deploy ><\n\nOr start with an gy Empty job\n\nFeatured\n\ngS Azure App Service deployment\n\nOthers\n\nAzure App Service deployment with continuous\nmonitoring\n\npe rformance tests\n\nAzure Service Fabric Compose deployment\n\ngS Azure App Service deployment with tests and\n\nAzure Service Fabric deployment\n\n1. |The template search results appear. Hover o', 'ver the Azure App Service Deployment with\nSlot template, and click the Apply button. The Pipeline tab of the release pipeline appears.\n\nAll pipelines > ™ New release pipeline\n\nPipeline © Tasks Variables Retention Options History\nArtifacts | + Add Stages | + Add ~\n% Stage\n\n2 | © 1)job, 2 tasks\n\nQ\n| |\n\nfo) hedu\n\nnot set\n\n1. Click the Add button in the Artifacts box. The Add artifact panel appears:\n\nAdd artifact\n\nSource type\n\n<> cD pan\n\nGit GitHub T', 'eam Found...\n\n3 more artifact types ~\nProject * @>\n\nMyFirstProject\n\nSource (Build definition) * @\n\n©) This setting is required.\n\n37 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nSelect the Build tile from the Source type section. This type allows for the linking of the\nrelease pipeline to the build definition.\n\nSelect MyFirstProject from the Project drop-down.\n\nSelect the build definition name, MyFirstProject-ASP.NET Core-Cl', ', from the Source (Build\ndefinition) drop-down.\n\nSelect Latest from the Default version drop-down. This option builds the artifacts produced\nby the latest run of the build definition.\n\nReplace the text in the Source alias textbox with Drop.\nClick the Add button. The Artifacts section updates to display the changes.\n\nClick the lightning bolt icon to enable continuous deployments:\n\nArtifacts | —-- Add\n\nDrop\n\nSchedule\n© not set\n\nWith this option ena', 'bled, a deployment occurs each time a new build is available.\n\n1.\n\n38\n\nA Continuous deployment trigger panel appears to the right. Click the toggle button to\nenable the feature. It isn’t necessary to enable the Pull request trigger.\n\nClick the Add drop-down in the Build branch filters section. Choose the Build Definition’s\ndefault branch option. This filter causes the release to trigger only for a build from the\nGitHub repository’s default branch', ' (main).\n\nClick the Save button. Click the OK button in the resulting Save modal dialog.\n\nClick the Stage 1 box. An Stage panel appears to the right. Change the Stage 7 text in the\nStage name textbox to Production.\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\nAdd\nStages | t Stage [Hi] Delete 2 Move\n\nProduction\n\n& Properties A\nZZ Production Name and owners of the stage\n2 © 1)job, 2 tasks\n\n| Stage name\nl\n\nProduction\n\nStage o', 'wner\n\n1. Click the 1 phase, 2 tasks link in the Production box:\n\nStages | + Add ~\n\nYJ\n\n% Production 7\n\n2 | © 1)job, 2 tasks -\n\nThe **Tasks** tab of the environment appears.\n\n1. Click the Deploy Azure App Service to Slot task. Its settings appear in a panel to the right.\n\nN\n\nSelect the Azure subscription associated with the App Service from the Azure subscription\ndrop-down. Once selected, click the Authorize button.\n\nSelect Web App from the App ty', "pe drop-down.\n\nSelect mywebapp/ from the App service name drop-down.\nSelect AzureTutorial from the Resource group drop-down.\nSelect staging from the Slot drop-down.\n\nSelect Run on agent* under Tasks. On the right pane, you'll see Agent Job.\n\nCOND YM RW\n\nSelect the self-hosted Agent pool if you have created that in the earlier step.\n\nProduction\n\nAgent job @ [i] Remove\n\nDisplay name *\n\nRun on agent\n\n& Deploy Azure App Service to Slot\n\nAgent selecti", 'on A\n\n@ Manage Azure App Service - Slot Swap\n\nAgent pool @ | Pool information | Manage @\n\nDefault\n\nDemands (i)\n\n+ Add\n\nExecution plan A\n\n39 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n> [!NOTE]\n> If you are using MS-hosted agent then select the *Hosted > Azure Pipelines* from\ndrop down.\n\n1. Click the Save button.\n\n2. Hover over the default release pipeline name. Click the pencil icon to edit it. Use\nMyFirstProject-ASP.NET ', 'Core-CD as the name.\n\nCJ MyFirstProject / MyFirst... ~~“ Dashboards Code Work Build a\n\nBuilds Releases Library Task Groups Deployment Groups\n\nAll definitions > *|MyFirstProject-ASP.NET Core-CD\n\n1. Click the Save button.\n\nCommit changes to GitHub and automatically deploy to Azure\n1. Open SimpleFeedReader.sln in Visual Studio.\n\n2. In Solution Explorer, open Pages.cshtml. Change <h2>Simple Feed Reader - V3</h2> to\n<h2>Simple Feed Reader - V4</h2>.\n\n', '3. Press Ctrl+Shift+B to build the app.\n\n4. Commit the file to the GitHub repository. Use either the Changes page in Visual Studio\'s\nTeam Explorer tab, or execute the following using the local machine’s command shell:\n\n:{custom-style=CodeBox} console git commit -a -m "upgraded to V4" :::\n\n5. Push the change in the default branch (main) to the origin remote of your GitHub repository.\nIn the following command, replace the placeholder {BRANCH} with ', "the default branch (use\nmain):\n\n:{custom-style=CodeBox} console git push origin {BRANCH} :::\n\nThe commit appears in the GitHub repository’s default branch (main). You'll be able to see the\ncommit history in https://github.com/<GitHub_username>/simple-feed-\nreader/commits/main.\n\nThe build is triggered, since continuous integration is enabled in the build definition’s\nTriggers tab:\n\nTasks Variables Triggers Options Retention History\n\nContinuous int", "egration\nJ © scottaddie/simple-feed-reader\n\nC) scottaddie/simple-feed-reader\n\nEnabled\n\n40 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n1. Navigate to the Pipelines. You'll see the Cl pipeline details and monitor each steps if you drill\ndown Jobs details.\n\nPipelines\n\nRecent All Runs Y/ Filter pipelines\n\nRecently run pipelines\n\nPipeline Last run\n\n#20210420.5 » Update Index.cshtml 3 Just now\n@ MyFirstProject-ASP.NET Core (.NET", ' Frame... - -\n\n1. Similarly, go to the Releases tab to see the details of CD pipeline. You can always drill down\nfurther to see more details of each step.\n\nmer pips MyFirstProject-ASP.NET Core-CD 7 Edit\n= 5 wW + New v Releases Deployments Analytics ==] Allreleases YY :\n\nMyFirstProject-ASP.NET Core-... vs\n®@ Production ~\n\nRelease-3\n4, 20210420 ; 4/20/2021, 12:58:08 PM © Production\ntay 20210420.... & main\n\n1. Once the build succeeds, a deployment t', 'o Azure occurs. Navigate to the app in the browser.\nNotice that the “V4” text appears in the heading:\n\nSimple Feed Reader - V4\n\nEnter a feed URL:\nRetneve Feed\n\n© 2017 - SimpleFeedReader\n\nExamine the Azure Pipelines pipeline\n\nBuild definition\n\nA build definition was created with the name MyFirstProject-ASP.NET Core-C/. Upon completion, the\nbuild produces a .zip file including the assets to be published. The release pipeline deploys those\nassets to', ' Azure.\n\nThe build definition’s Tasks tab lists the individual steps being used. There are five build tasks.\n\n41 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nTasks\n\n> MyFirstProject-ASP.NET Core (.NET Framework)-Cl\nVariables Triggers\nPipeline\n\nBuild pipeline\n\nOptions Retention History\n\nGet sources\n©) sughosneo/simple-feed-reader\nAgent job 1\n= Runon ag\n\n=!\n\ntil\n\n*\n\ne)\n\nUse NuGet 4.4.1\n\nee\nhs a en 2\nHo JuGet toc Sta llé\n\nNuGe', 't restore\nNuGet\n\nBuild solution\nVisual Stud\n\nfm Bai\n\nbui a\n\nae)\n\nTest Assemblies\nVisual St\n\nPa rat\n\nii)\n\nee\n\nK\nI»\n\nrom ci\n\nPublish symbols path\nOe SOUrCesS amd ob\n\nSmt et\n\n>\n\nm\n\nPublish Artifact\n\nblish symbols\nPublish build artifacts\n\ndefault package feed used is nuget.org.\n\nneeded.\n\nRestore — Executes the dotnet restore command to restore the app’s NuGet packages. The\nBuild — Executes the dotnet build --configuration release command to compile t', "he app’s\n\ncode. This --configuration option is used to produce an optimized version of the code, which\n\nis suitable for deployment to a production environment. Modify the BuildConfiguration\n\nvariable on the build definition’s Variables tab if, for example, a debug configuration is\n\nTest — Executes the dotnet test --configuration release --logger trx --results-directory\nand isn't deployed.\n\n42\n\n<local_path_on_build_agent> command to run the app’s ", 'unit tests. Unit tests are executed\nwithin any C# project matching the **/Tests/.csproj glob pattern. Test results are saved in a .trx\n\nfile at the location specified by the --results-directory option. If any tests fail, the build fails\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n[INOTE] To verify the unit tests work, modify SimpleFeedReader.Tests.cs to purposefully break\none of the tests. For example, change Assert.True(', 'result.Count > 0); to\nAssert.False(result.Count > 0); in the Returns_News_ Stories _Given_Valid_Uri method. Commit\nand push the change to GitHub. The build is triggered and fails. The build pipeline status\nchanges to failed. Revert the change, commit, and push again. The build succeeds.\n\n4. Publish — Executes the dotnet publish --configuration release --output\n<local_path_on_build_agent> command to produce a .zip file with the artifacts to be\ndep', 'loyed. The --output option specifies the publish location of the .zip file. That location is\nspecified by passing a predefined variable named $(build.artifactstagingdirectory). That\nvariable expands to a local path, such as *c:_work\\1, on the build agent.\n\n5. Publish Artifact — Publishes the .zip file produced by the Publish task. The task accepts the\nzip file location as a parameter, which is the predefined variable\n$(build.artifactstagingdirect', 'ory). The .zip file is published as a folder named drop.\n\nClick the build definition’s Summary link to view a history of builds with the definition:\n\nTasks Variables Triggers Options Retention History > Queue\nOn the resulting page, click the individual build for more details.\n< MyFirstProject-ASP.NET Core (.NET Framework)-Cl Edit :\nRuns Branches Analytics Y\nDescription\n#20210420.5 Update Index.cshtml & 19m ago\nndividual Cl for % main 97¢@a2b ° D ', '41s\n#20210420.4 Update Index.cshtml & 36m ago\nndividual Cl for nai d1077bb ° ® 40s -\n#20210420.3 Update Index.cshtml & 40m ago\nndividual Cl for > main 58b2b8e ° 5 1m 0s\n#20210420.2 Update Index.cshtml & thago\nndividual Cl for nair cb034f7 iv) 5 41s\n\nA summary of this specific build is displayed. Click the published link, and notice the drop folder\nproduced by the build is listed:\n\n43 CHAPTER 3 | Continuous integration and deployment with Azure De', 'vOps\n@ #20210420.5 Update Index.cshtm! | Run new [iE\n\non MyFirstProject-ASP.NET Core (.NET Framework)-C Retained by release\n\nSummary Releases\n\nTriggered by Cy sughosneo View change\nRepository and version Time started and elapsed Related Tests and coverage\n© sughosneo/simple-feed-reader i Today at 1:14 PM 0 work items A Get started\n2 main ¢ 97c0a2b © 41s 1 published; 1 consumed\nArtifacts\nPublished Consumed\n> fF drop 906 KB\n\nUse the ellipsis and cl', 'ick on Downloads artifacts links to inspect the published artifacts.\n\nRelease pipeline\n\nA release pipeline was created with the name MyFirstProject-ASP.NET Core-CD:\n\nPipeline —_— Tasks Variables Retention Options History\nArtifacts | +- Add Stages | -+ Add\n%\n\n2. .\n\nke % — Production Q\n\nDrop QR | 1 job, 2 tasks\n\nSchedule\n© not set\n\nThe two major components of the release pipeline are the Artifacts and the Stages. Clicking the box\nin the Artifacts s', 'ection reveals the following panel:\n\n44 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPipeline —_ Tasks Variables Retention Options History\n\nArtifact [lil] Delete\nArtifacts | -+- Add Stages | -+ Add Build - Drop\n\nProject* @\n\nMyFirstProject\n% | Produc\nbe 1 job, 27\n\nSource (build pipeline)* @\n\nMyFirstProject-ASP.NET Core (.NET Framework)-Cl\n\n© Schedule\n\nnot set\n\nDefault version* (i)\nLatest v\nSource alias* (i)\n\nDrop\n\nThe Source', ' (Build definition) value represents the build definition to which this release pipeline is\nlinked. The .zip file produced by a successful run of the build definition is provided to the Production\nenvironment for deployment to Azure. Click the 7 phase, 2 tasks link in the Production environment\nbox to view the release pipeline tasks:\n\nPipeline Tasks ~ Variables Retention Options =F\n\nProduction _\nDeployment process\n\nPhase +\n\nee Run on agent\n\nDeplo', 'y Azure App Service to Slot\nfH Azure App Service Deploy\n\nra Manage Azure App Service - Slo...\n= .\nes Azure App Service Manage\n\nThe release pipeline consists of two tasks: Deploy Azure App Service to Slot and Manage Azure App\nService - Slot Swap. Clicking the first task reveals the following task configuration:\n\n45 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPipeline Tasks ~ Variables Retention Options Ff\n\nProduction\nDeploy', 'ment process\n\nPhaset +\n\nea Run on agent\n\nDeploy Azure App Service to Slot\nh Azure App Service Deploy\n\nro Manage Azure App Service - Slo...\n= .\nes) Azure App Service Manage\n\nThe Azure subscription, service type, web app name, resource group, and deployment slot are defined\nin the deployment task. The Package or folder textbox holds the .zip file path to be extracted and\ndeployed to the staging slot of the mywebapp<unique_number> web app.\n\nClicking', ' the slot swap task reveals the following task configuration:\n\n46 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nAzure App Service Manage @\n\nVersion 0.* ee\n\nDisplay name *\n\nManage Azure App Service - Slot Swap\n\nAzure subscription * @ | Manage EC\n\nVisual Studio Enterprise ww C)\nAction Gi)\nSwap Slots ‘\n\nApp Service name* ()\n\nmywebapp113a5/ ‘ C)\n\nResource group* ()\n\nAzureTutorial ww C)\n\nSource Slot* (i)\nstaging “ C)\n| Swap with ', 'Production @\n\n| | Preserve Vnet (i)\n\nThe subscription, resource group, service type, web app name, and deployment slot details are\nprovided. The Swap with Production check box is checked. Consequently, the bits deployed to the\nstaging slot are swapped into the production environment.\n\nAdditional reading\n\n° Create your first pipeline with Azure Pipelines\n° Build and .NET Core project\n° Deploy a web app with Azure Pipelines\n\n47 CHAPTER 3 | Continuo', 'us integration and deployment with Azure DevOps\nContinuous integration and deployment with\nGitHub Actions\n\nGitHub has long been the home for millions of open-source developers around the globe. Most\ndevelopers associate source control with GitHub. However, GitHub is an evolving platform that can be\nused for more than just synchronizing Git repositories.\n\nGitHub Actions\n\nGitHub Actions is a workflow engine that can automate workflows for nearly al', "l events that occur on\nGitHub. Actions is a great solution for Continuous Integration/Continuous Deployment (CI/CD)\npipelines.\n\nIn this section of articles, you'll learn how to create an Actions workflow. The workflow will build, test,\nand deploy a .NET web app to Azure Web Apps.\n\nNote\n\nBefore you begin, complete the Publish the app’s code to GitHub and Disconnect local Git\n\ndeployment sections of the Continuous integration and deployment with Az", 'ure DevOps section to\npublish your code to GitHub. Then proceed to the Build article.\n\nIn the Build article, you\'ll create the initial workflow to build and test the .NET app. You\'ll:\n\n[\'!div class="checklist”]\n\n. Learn the basic structure of a GitHub Action workflow YAML file.\n. Use a template to create a basic build workflow that builds a .NET app and executes unit tests.\n\n. Publish the compiled app so that it’s ready for deployment.\nIn the Dep', 'loy article, you\'ll:\n\n[\'!div class="checklist”]\n\n. Learn about environments in GitHub Actions.\n. Create two environments and specify environment protection rules.\n. Create environment secrets for managing environment-specific configuration.\n\n. Extend the workflow YAML file to add deployment steps.\n. Add a manual dispatch trigger.\n\nSecure code with CodeQL\n\nIn addition to building and deploying code, GitHub Advanced Security offers tools for “shift', 'ing left"\nwith security. That is, integrating security early on in the software delivery lifecycle. CodeQL is a code\nscanning language that runs queries to find potential vulnerabilities or quality issues in your code.\nCodeQL is run using an Actions workflow.\n\nIn the CodeQL article, you\'ll:\n\n48 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n[\'!div class="checklist”]\n\n. Create a Code Scanning Action.\n. Edit the workflow file t', "o include custom scan settings.\n\n. See scanning results.\n\nCompare and contrast GitHub Actions and Azure Pipelines\n\nGitHub Actions and Azure Pipelines have a common lineage and are similar in many respects.\nHowever, you should understand the differences before selecting a platform for building, testing, and\ndeploying apps. In the Comparison article, you'll deep dive into these platforms and compare and\ncontrast them. You'll also learn how to selec", 't the correct platform for your CI/CD needs.\n\nContinuous integration and deployment with\nGitHub Actions\n\nGitHub has long been the home for millions of open-source developers around the globe. Most\ndevelopers associate source control with GitHub. However, GitHub is an evolving platform that can be\nused for more than just synchronizing Git repositories.\n\nGitHub Actions\n\nGitHub Actions is a workflow engine that can automate workflows for nearly all ', "events that occur on\nGitHub. Actions is a great solution for Continuous Integration/Continuous Deployment (CI/CD)\npipelines.\n\nIn this section of articles, you'll learn how to create an Actions workflow. The workflow will build, test,\nand deploy a .NET web app to Azure Web Apps.\n\nNote\n\nBefore you begin, complete the Publish the app’s code to GitHub and Disconnect local Git\n\ndeployment sections of the Continuous integration and deployment with Azur", 'e DevOps section to\npublish your code to GitHub. Then proceed to the Build article.\n\nIn the Build article, you\'ll create the initial workflow to build and test the .NET app. You\'ll:\n\n[\'!div class="checklist”]\n\n. Learn the basic structure of a GitHub Action workflow YAML file.\n. Use a template to create a basic build workflow that builds a .NET app and executes unit tests.\n\n. Publish the compiled app so that it’s ready for deployment.\nIn the Deplo', 'y article, you\'ll:\n\n[\'!div class="checklist”]\n\n° Learn about environments in GitHub Actions.\n\n49 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n. Create two environments and specify environment protection rules.\n\n. Create environment secrets for managing environment-specific configuration.\n. Extend the workflow YAML file to add deployment steps.\n\n. Add a manual dispatch trigger.\n\nSecure code with CodeQL\n\nIn addition to buildi', 'ng and deploying code, GitHub Advanced Security offers tools for “shifting left”\nwith security. That is, integrating security early on in the software delivery lifecycle. CodeQL is a code\nscanning language that runs queries to find potential vulnerabilities or quality issues in your code.\nCodeQL is run using an Actions workflow.\n\nIn the CodeQL article, you\'ll:\n\n[\'!div class="checklist”]\n\n. Create a Code Scanning Action.\n. Edit the workflow file t', "o include custom scan settings.\n\n. See scanning results.\n\nCompare and contrast GitHub Actions and Azure Pipelines\n\nGitHub Actions and Azure Pipelines have a common lineage and are similar in many respects.\nHowever, you should understand the differences before selecting a platform for building, testing, and\ndeploying apps. In the Comparison article, you'll deep dive into these platforms and compare and\ncontrast them. You'll also learn how to selec", 't the correct platform for your CI/CD needs.\n\nCompare and contrast GitHub Actions and Azure\nPipelines\n\nGitHub Actions and Azure Pipelines have a common history. In fact, the Actions agent is a fork of the\nPipelines agent. There are many similarities between GitHub Actions and Azure Pipelines and it’s\nworth comparing and contrasting them.\n\nPipelines as code\n\nBefore you compare GitHub Actions and Azure Pipelines, you should consider the benefits of', ' pipelines\nas code. Pipelines as code:\n\n[\'!div class="checklist”]\n\n. Benefit from standard source control practices (such as code reviews via pull request and\nversioning).\n\n. Can be audited for changes just like any other files in the repository.\n. Don\'t require accessing a separate system or UI to edit.\n\n. Can fully codify the build, test, and deploy process for code.\n\n50 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n. Can ', 'usually be templatized to empower teams to create standard processes across multiple\nrepositories.\n\nNote\n\nThe term “pipelines” can also be referred to by several different interchangeable words: pipeline,\n\nworkflow, and build are common terms. In this article, references to Azure Pipelines are referring to\nYAML Pipelines, and not the older Ul-based Classic Pipelines.\n\nAgents and runners\n\nBefore you examine pipelines themselves, you should conside', 'r how these pipelines execute. Both\nGitHub Actions and Azure Pipelines are really orchestration engines. When a pipeline is triggered, the\nsystem finds an “agent” and tells the agent to execute the jobs defined in the pipeline file.\n\nAzure Pipelines run on agents. The agent is written in .NET, so it will run wherever .NET can run:\nWindows, macOS, and Linux. Agents can even run in containers. Agents are registered to a pool in\nAzure Pipelines or t', "o a repository or organization in GitHub. Agents can be hosted or private.\n\nGitHub Workflows execute on runners. The runner code is essentially a fork of the Azure Pipelines\ncode, so it's very similar. It’s also cross-platform and you can also use hosted or self-hosted runners.\n\nHosted agents and runners\n\nHosted agents (Azure Pipelines) and hosted runners (GitHub) are agents that are soun up and\nmanaged by Azure DevOps or GitHub respectively. You", ' don’t need to maintain any build\ninfrastructure. When a pipeline triggers that targets a hosted agent, an instance of the specified agent\nimage is created. The job is run by the agent on the instance, and once the job completes, the\ninstance is destroyed. The same applies for hosted runners running GitHub workflows.\n\nNote\n\nThe list of software installed on Azure Pipelines images is listed in this repository. You can select the\n\nplatform folder a', "nd examine the README.md files. You can find information on GitHub hosted\nrunners.\n\nPrivate agents and self-hosted runners\n\nThere are times when you can't use hosted images. For example, when you:\n\n. Require SDKs or other software that isn't installed on the images.\n\n. Need to access resources that aren't public (such as an internal SonarQube server or an\ninternal Artifactory instance).\n\n. Need to deploy to private networks.\n\n. Need to install li", "censes for third-party software required for building your code.\n\n. Need more storage or memory than is provided to the hosted agent images.\n\n. Need more time than the maximum build time limit for hosted agents.\n\n51 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nImportant\n\nIt's possible to install tools and SDKs when running pipelines on hosted agents. If the install steps\n\ndon't take long, this is viable. However, if the too", 'ls/software take a long time to install, then you may\nbe better off with a private agent or self-hosted runner, since the install steps will need to execute for\nevery run of the workflow.\n\nAzure DevOps agents\n\nEvery Azure DevOps account has a hosted pool with a single agent that can run one job at a time.\nAlso included is a set number of free build minutes. You may purchase additional “hosted pipelines” in\nAzure DevOps. When you purchase an addit', "ional hosted pipeline, you're really removing the build\nminutes limit and adding concurrency. One pipeline can run one job at a time. Two pipelines can run\ntwo jobs simultaneously, and so on.\n\nComparison of agents\n\n| Feature | GitHub Azure Pipelines |Links\n\nHosted agents for Up to 10 free Microsoft-hosted parallel jobs | Azure\npublic that can run for up to 360 minutes (6 hours) | Pipelines\nrepos/projects each time with no overall time limit per G", "itHub\nmonth. You aren't given this free grant by\ndefault, you have to submit a request\n\nHosted agents for | 2,000 minutes One free parallel job that can run for up to\n\nprivate free per month, | 60 minutes each time, until you've used\n\nrepos/projects 3,000 minutes 1,800 minutes (30 hours) per month. You\nfor Pro and can pay for additional capacity per parallel\nTeam licenses, | job. Paid parallel jobs remove the monthly\n\n50,000 minutes | time limit ", 'and allow you to run each job for\nfor Enterprise up to 360 minutes (6 hours).\nlicense.\n\nAdditional\nminutes may be\npurchased.\n\nScale set agents No Yes Azure virtual\nmachine\nscale set\nagents\n\nComparison of GitHub Actions and Azure Pipelines\n\nAzure Pipelines (YAML pipelines) provide a mature set of features. Some of the features include:\n\n. Approvals\n\n. Artifact storage\n\n52 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n. Deploy', 'ment jobs\n\n° Environments\n° Gates\n° Stages\n\n. Templates\n. Triggers\n: Variable groups\n\nFor a full list of Azure Pipelines features, refer to the Feature availability table.\n\nGitHub Actions are evolving rapidly and provide features such as triggers for almost all GitHub events,\nartifact storage, environments and environment rules, starter templates, and matrices. Read more\nabout the entire feature set refer GitHub Actions.\n\nFeature comparison\n\nThe ', 'following table is current as of January 2023 and is not an exhaustive list of features.\n\nApprovals Define approval Yes Yes\nconditions before\nmoving further in the\npipeline\n\nArtifacts Upload, store, and Yes Yes\ndownload artifacts\nfrom jobs\n\nCaching Cache folders or files | Yes Yes\nfor subsequent runs\n\nConditions Specify conditions Y\nfor steps or jobs\nContainer Run jobs inside a Y\nJobs container\nDemands Specify demands Yes\nthat must be met to\nmatc', 'h jobs to agents\nY\n\nDependenci | Specify Yes\nes dependencies\nbetween jobs or\nstages\nRe\n\nGroups machines for\ndeployments\n\nDeployment | Job that targets a\nJobs deployment group\n53\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n\nes\n\nes\n\nes\n\nDeployment | A logical set of target | No\nNo\n\nYes Yes\n\nEnvironment | A collection of\n\nS resources to target\nor a logical\nenvironment\n\npates/eneck Automatic collection | Yes Yes\nand evaluatio', 'n of\nsignals to control\ncontinuation\n\nSequence of steps\nthat are executed on\nan agent\n\nService Manage the lifecycle\n\nContainers of a containerized\nservice instance\nvatavle during a\n\nService Abstract credentials\nConnections | to external systems\n\nPasswordles | Provide technologies | Yes No\nS and support use\nconnections | cases that reduce\nto cloud and potentially\nproviders eliminate the use of\npasswords\nStages Group jobs ina\npipeline\n\nTemplates De', 'fine reusable,\nparameterized\nbuilding blocks for\nsteps, jobs, or\nvariables\n\nStarter Defines a starter\n\nTemplates workflow based on\nthe type of code\ndetected ina\nrepository\n\nTriggers Set of events that\ncause the pipeline to\ntrigger\n\n54 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n\nVariables Variables that can be\npassed in, statically\nor dynamically\ndefined\n\nVariable Store values for use\nGroups across multiple\npipelines\n\nImpo', 'rtant\n\nGitHub Actions is rapidly evolving. Be sure to check documentation carefully before deciding which\nplatform is right for you.\n\nBuild a .NET web app using GitHub Actions\n\nGitHub Actions allow you to automate workflows in response to events that are triggered in GitHub. A\ncommon workflow is Continuous Integration (Cl), but Actions can automate other processes. For\nexample, sending welcome emails when people join a repository.\n\nTo explore mov', 'ing code to the cloud, you\'ll build a GitHub Actions workflow file. The workflow file will\nbe used for the Simple Feed Reader app you\'ve already deployed to Azure App Service.\n\nIn this article, you will: > [!div class="checklist”] > > * Learn the basic structure of a GitHub Action\nworkflow YAML file. > * Use a template to create a basic build workflow that builds the .NET app and\nexecutes unit tests. > * Publish the compiled app so that it’s read', 'y for deployment.\n\nWorkflow structure\n\nWorkflows are defined in YAML files, and contain several common nodes:\n\n. a name\n. a trigger, defined by an on section\n. one or more job sections composed of one or more steps\n\n. optional attributes such as environment variables\n\nJobs are run on runners. You can use hosted runners, which are spun up by GitHub during the\nworkflow and then thrown away. Hosted runners are great because you don’t have to maintai', 'n your\nown build infrastructure. For workflows that require a specific build environment, or for running\nworkflows on a private network, you can also use private runners. To create a private runner, install the\nrunner on any machine that supports .NET.\n\nEach job will specify what runner GitHub should use to execute the steps. You can also specify\ndependencies between jobs using the needs attribute. Deployment jobs can also specify an\nenvironment ', 'to target.\n\n55 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nThe steps node can be as easy as inline commands, or they can be actions. Most Cl workflows will\nhave a combination of run steps (for executing scripts) and actions. Individual actions are pulled into\nthe workflow by referencing the GitHub Action repository (and optionally a tag or commit hash for\nspecific versions) and specifying any parameters using the with keyw', "ord.\n\nTip\n\nFor more information, see GitHub Actions YAML syntax.\n\nFrom a workflow file, you're able to run any of the available .NET CLI commands. For example, if you're\nrequired to build, test, and deploy an ASP.NET Core Blazor WebAssembly app with Ahead-of-Time\n(AoT) compilation, you'd use the following commands:\n\n° dotnet workload install\n° dotnet restore\n\n° dotnet build\n\n. dotnet test\n\n° dotnet publish\n\nThe .NET SDK is a workflow necessity\n\nA", "ll .NET workflows require the .NET SDK, and this can be set up by the actions/setup-dotnet_GitHub\nAction. This action sets up a .NET CLI environment for use in actions. Some GitHub hosted runners\nhave the .NET SDK preinstalled, but that's subject to change. As a best practice, use the actions/setup-\ndotnet action to ensure the proper version is available.\n\nCreate a basic build workflow\n\nA primary principle of effective DevOps is to “build once, a", "nd deploy many times”. You'll start by\ncreating a workflow to build a basic .NET app. In the next step, you'll publish the output to prepare for\ndeployment.\n\n1. Navigate to your GitHub repository and select the Actions tab.\n\n2. GitHub detects that there’s .NET code in the repository and suggests a .NET workflow\ntemplate. Select Set up this workflow to create a new YAML workflow file:\n\n1\n\nGet started with GitHub Actions\n\n**Figure 1**: Creating a n", "ew workflow.\n\n56 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n1. Commit the file onto the main branch. Since you've defined a trigger condition for commits to\nmain, this commit should trigger the workflow to run.\n\n1 Start commit +\n\nMarketplac ~Commit changes\n\nFeatured Act\n\n1} Create a new branch for this commit and start a\n\noO Sett pull request. Learn more about pull requests\n\n® - Commit directly to the master branch\n\n**Fig", 'ure 2**: Commit the YAML file.\n\n1. Select the Actions tab again. You should see a running workflow. Once the workflow has\ncompleted, you should see a successful run.\n\nes) Search or jum Pull requests Issues Codespaces Marketplace Explore\ncolindembovsky / simple-feed-reader\n\nUpdate dotnet.yml\n\nSummary\n\n**Figure 3**: Successful build view.\n\n1. Opening the logs, you can see that the .NET build succeeded and the tests ran and passed.\n\n**Figure 4**: Ch', 'ecking the logs.\nNote\n\nIf any of the tests fail, the workflow will fail.\n\nDissect the workflow file\n\nLet’s examine the workflow YAML file you have so far:\n\non:\npush:\nbranches: [ main ]\npull request:\nbranches: [ main ]\n\njobs:\nbuild:\n\nruns-on: ubuntu-latest\n\nsteps:\n- uses: actions/checkout@v3\n- name: Setup .NET\nuses: actions/setup-dotnet@v3\nwith:\ndotnet-version: 6.0.x\nname: Restore dependencies\nrun: dotnet restore\nname: Build\nrun: dotnet build --no', "-restore\nname: Test\nrun: dotnet test --no-build --verbosity normal\n\nNotice the following things:\n\n1. There’s a name that names the workflow.\n\n2. The on object specifies when this workflow should run. This workflow has two events that\ntrigger it: push to main and pull_request to main. Each time someone commits to main or\ncreates a pull request (PR) to main, this workflow will execute.\n\n3. There's a single job called build. This build should run on", ' a hosted agent. ubuntu_latest\nspecifies the most recent Ubuntu hosted agent.\n\n4. There are five steps:\n\n1. actions/checkout@v3 Is an action that checks out the code in the repository onto the\nrunner.\n\n2. actions/setup-dotnet@v3 is an action that sets up the .NET CLI. This step also\nspecifies a name attribute for the logs and the dotnet-version parameter within the\nwith object.\n\n3. Three run steps that execute dotnet restore, dotnet build, and do', "tnet test. name\nattributes are also specified for these run steps to make the logs look pretty.\n\n58 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nNow that you've successfully built and tested the code, add steps that publish the output so you can\ndeploy the web app.\n\n1. Navigate to the .github/workflows/dotnet.yml file and select the pencil icon to edit\n\n¥ colindembovsky / simple-feed-reader\n\nforked from Azure-Sarnple imple-", 'feed-reade\n\n<> Code\n\nt? master ~ simple-feed-reader / github / workflows / dotnet.yml\n\nGo to file\n\nbig colindembovsky\n\n**Figure 5**:; Edit the YAML file.\n\n1. Add the following Publish step below the Test step. The step runs the dotnet publish\ncommand to publish the web app:\n\n:{custom-style=CodeBox} “yml\n\n- name: Test run: dotnet test —no-build —-verbosity normal # <-— this is the current\nbottom line\n\n- name: Publish run: dotnet publish SimpleFeed', "Reader/SimpleFeedReader.csproj -c\nRelease -o website ~~ :::\n\n2. This publishes the web app to a folder on the hosted agent. Now you'll want to upload the\nsite as a build artifact that can be deployed to Azure. To complete this activity, you'll use an\nexisting action.\n\n3. On the list of actions in the Actions Helper pane on the right, search for artifact. Select on\nthe Upload a Build Artifact (By actions) action.\n\nes) Search or jump to Pull reques", 'ts Issues Codespaces Marketplace Explore\n\ncolindembovsky / simple-feed-reader\nrked from Azur ymples/simple-teed-reade\n\nsimple-feed-reader / .github / workflows dotnetym!\n\n<> Edit file\n\name NE\n\nMarketplace / Search results\noO Upload a Build Artifact 2\noOo Download a Build Artifact\n\n**Figure 6**: Accessing the snippet helper.\n1. Edit the version to v2.2.2 to display a sample snippet. Select the clipboard icon to copy the\nSnippet and paste it into t', 'he workflow below the publish step.\n\nMarketplace / Search results / Upload a Build Artifact\n\nUpload a Build Artifact\nBy acti ns & & v2 LY 803\n\nUpload a build artifact that can be used by subsequent workflow steps\n\nView full Marketplace listing\n\nInstallation\n\nVersion: v2.2.2 ~ 1\n\n- name: Upload a Build Artifact\nuses: actions/upload-artifact@v2.2.2\nwith:\n# Artifact name\nname: # optional, default is artifact\n# A file, directory or wildcard pattern t', 'hat describes what t¢\npath:\n# The desired behavior if no files are found using the provide\nAvailable Options:\nwarn: Output a warning but do not fail the action\nerror: Fail the action with an error message\nignore: Do not output any warnings or errors, the action does m\n\n**Figure 7**: Copying a snippet.\n1. Edit the YAML for this step to look as follows:\n:{custom-style=CodeBox} “yml\n\n- name: Upload a Build Artifact uses: actions/upload-artifact@v3 w', "ith: name: website\npath: SimpleFeedReader/website/** if-no-files-found: error ~~\n\n2. Commit the file.\n\n3. Once the workflow completes, you'll see the artifact from the Home tab:\n\ncolindembovsky / simple-feed-reader\n\n© Actions\n\nUpdate dotnet.yml\n\nAnnotations\n\nae) website\n\n**Figure 8**: Viewing artifacts in the summary page.\nFinal workflow file\n\nThe final workflow file should look something like this:\n\nname: .NET\n\non:\npush:\nbranches: [ main ]\npull ", 'request:\nbranches: [ main ]\n\njobs:\nbuild:\n\nruns-on: ubuntu-latest\n\nsteps:\n- uses: actions/checkout@v3\n- name: Setup .NET\nuses: actions/setup-dotnet@v3\nwith:\ndotnet-version: 6.0.x\n- name: Restore dependencies\nrun: dotnet restore\n- name: Build\nrun: dotnet build --no-restore\n- name: Test\nrun: dotnet test --no-build --verbosity normal\n- name: Publish\nrun: dotnet publish SimpleFeedReader/SimpleFeedReader.csproj -c Release -o website\n- name: Upload a B', 'uild Artifact\nuses: actions/upload-artifact@v3\nwith:\nname: website\npath: SimpleFeedReader/website/**\nif-no-files-found: error\n\nDeploy a .NET web app using GitHub Actions\n\nWarning\n\nPlease complete the Build tutorial before starting this lab.\n\nIn this article, you\'ll: > [!div class="checklist”] > > * Learn about Environments in GitHub Actions. > *\nCreate two environments and specify environment protection rules. > * Create environment secrets\nfor m', "anaging environment-specific configuration. > * Extend the workflow YAML file to add\ndeployment steps. > * Add a manual dispatch trigger.\n\nEnvironments\n\nNow that you've published an artifact that’s potentially deployable, you'll add deployment jobs to the\nworkflow. There's nothing special about a deployment job, other than the fact that it references an\n\n61 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nenvironment. Environme", "nts are logical constructs that allow you to specify environment protection\nrules, such as approvals, on any group of resources that you're targeting.\n\nIn this walkthrough, you'll be deploying to two environments: PRE-PROD and PROD. In a typical\ndevelopment lifecycle, you'll want to deploy the latest code to a soft environment (typically DEV) that\nis expected to be a bit unstable. You'll use PRE-PROD as this soft environment. The “higher”\nenviron", "ments (like UAT and PROD) are harder environments that are expected to be more stable. To\nenforce this, you can build protection rules into higher environments. You'll configure an approval\nprotection rule on the PROD environment: whenever a deployment job targets an environment with\nan approval rule, it will pause until approval is granted before executing.\n\nGitHub environments are logical. They represent the physical (or virtual) resources that", " you're\ndeploying to. In this case, the PRE-PROD is just a deployment slot on the Azure Web App. PROD is the\nproduction slot. The PRE-PROD deployment job will deploy the published .NET app to the staging\nslot. The PROD deployment job will swap the slots.\n\nOnce you have these steps in place, you'll update the workflow to handle environment-specific\nconfiguration using environment secrets.\n\nNote\n\nFor more information, see GitHub Actions - Environme", "nts.\n\nAzure authentication\n\nTo perform actions such as deploying code to an Azure resource, you need the correct permissions.\nFor deployment to Azure Web Apps, you can use a publishing profile. If you want to deploy to a\nStaging slot, then you'll need the publishing profile for the slot too. Instead, you can use a service\nprincipal (SPN) and assign permission to this service principal. You can then authenticate using\ncredentials for the SPN befor", "e using any commands that the SPN has permissions to perform.\n\nOnce you have an SPN, you'll create a repository secret to securely store the credentials. You can then\nrefer to the secret whenever you need to authenticate. The secret is encrypted and once it has been\nsaved, can never be viewed or edited (only deleted or re-created).\n\nCreate an SPN\n\n1. In your terminal or Cloud Shell, run the following command to create a service principal with\ncon", 'tributor permissions to the web app you created earlier:\n\n:{custom-style=CodeBox} azurecli az ad sp create-for-rbac --name "{sp-name}" --sdk-auth --\nrole contributor \\ --scopes /subscriptions/{subscription-id}/resourceGroups/{resource-\ngroup}/providers/Microsoft.Web/sites/{webappname} :::\n\n2. |The command should output JSON that has credentials embedded:\n\n:{custom-style=CodeBox} json {  "clientld":"<GUID>",  "clientSecret": "<GUID>",\n“subscriptio', 'nid": "<GUID>",  "tenantld":""<GUID>", 0. Jr:\n\n62 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n3. | Make sure to record the clientld, clientSecret, subscription, and tenantlid. You can also leave\nthe terminal open for copy/paste later.\n\nCreate a repository secret\n1. | Now you\'re going to create an encrypted secret to store the credentials. You\'ll create this\nsecret at the repository level.\n\n2. Navigate to GitHub and select ', 'your repository Settings tab. Then select Secrets. Select New\nrepository secret:\n\nActions secrets\n\n**Figure 1**: Create a secret.\n\n1. Copy and paste the JSON from the az ad sp create-for-rbac command into the body of the\nsecret. You can create this JSON by hand too if you have the relevant fields for your SPN. The\nsecret should be named AZURE_CREDENTIALS. Select Add secret to save the new secret:\n\n/ New secret\n\nName\n\nAZURE_CREDENTIALS\n\n{\n“clienti', 'd": "\n“clientSecret”: “:\n\n"tenantid”™: "\n\n“subscriptionld”: "\n\n}\n\nAdd secret\n\n**Figure 2**: Add Azure credentials.\n1. You\'ll consume this secret in a workflow in later steps. To access it, use the variable notation\n${{}}. In this case, ${{ AZURE_CREDENTIAL }} will be populated with the JSON you saved.\nAdd environments\n\nEnvironments are used as a logical boundary. You can add approvals to environments to ensure\nquality. You can also track deployme', "nts to environments and specify environment-specific values\n(secrets) for configuration.\n\n63 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nFor this example, you're going to split the actual Azure environment into two logical environments\ncalled PRE-PROD and PROD. When you deploy the web app, you'll deploy to the staging slot of the\nAzure web app, represented by the PRE-PROD environment. When you're ready to deploy to PROD,\ny", "ou'll just perform a slot swap.\n\nIn this case, the only difference between the environments is the slot that you're deploying to. In real\nlife, there would typically be different web apps (and separate web app plans), separate resource\ngroups, and even separate subscriptions. Typically, there's an SPN per environment. You may want to\noverride the AZURE_CREDENTIAL value that you saved as a repository secret by creating it as an\nenvironment secret.", '\n\n| Note |\n\nPrecedence works from Environment to repository. If a targeted environment has a secret called\nMY_SECRET, then that value is used. If not, the repository value of MY_SECRET (if any) is used.\n\n1. Select Settings and then Environments in your repository. Select New Environment:\n\n**Figure 3**: Create an environment.\n\n1. Enter PRE-PROD and select Configure environment:\n\nName\n\nPRE-PROD\n\nConfigure environment\n\n**Figure 4**: Name the environ', 'ment.\n\n64 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nSince deploying to a staging slot doesn’t affect the web app, you can safely deploy to the slot\nwithout requiring an approval first. A reviewer could be added if desired. For this example,\nleave the Environment protection rules empty.\n\n[INOTE] If you target an environment in a workflow and it does not exist, an “empty”\nenvironment is created automatically. The environme', 'nt would look exactly the same as the\nPRE-PROD environment - it would exist, but would not have any protection rules enabled.\n\nSelect Environments again and again select New Environment. Now enter PROD as the\nname and select Configure environment.\n\nCheck the Required reviewers rule and add yourself as a reviewer. Don’t forget to select\nSave protection rules:\n\n/ Configure PROD\n\nEnvironment protection rules\n\n**Figure 5**: Add protection rules.\n\nDep', "loy to staging\n\nYou can now add additional jobs to the workflow to deploy to the environments! You'll start by\nadding a deployment to the PRE-PROD environment, which in this case is the web app staging slot.\n\n1.\n\n2.\n\n65\n\nNavigate to the .github/workflows/dotnet.yml file and select the pencil icon to edit the file.\n\nYou're going to use the web app name a few times in this workflow, and will need the name\nof the resource group too. You'll define th", 'e app and resource group names as variables. With\nthe variables, you can maintain the values in one place in the workflow file.\n\nAdd this snippet below the on block and above the jobs block:\n::{custom-style=CodeBox} “yml env: app-name: “” rg-name: “"\n\njobs: # <-— this is the existing jobs line ~~ :::\n\n[!WARNING] You\'ll need to replace <name of your web app> with the actual name of your\nweb app, and <name of your resource group> with the actual na', 'me of your resource group.\n\nAdd a new job below the build job as follows:\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n{custom-style=CodeBox} “yml if-no-files-found: error # <-— last line of build job: insert\nbelow this line\n\ndeploy_staging: needs: build runs-on: ubuntu-latest\n\nenvironment:\nname: PRE-PROD\nurl: ${{ steps.deploywebapp.outputs.webapp-url }}\n\nsteps:\n\n- name: Download a Build Artifact\nuses: actions/download-art', "ifact@v3\nwith:\n\nname: website\npath: website\n\n- name: Login via Azure CLI\nuses: azure/login@v1\nwith:\ncreds: ${{ secrets.AZURE_ CREDENTIALS }}\n\nname: Deploy web app\nid: deploywebapp\nuses: azure/webapps-deploy@v2\nwith:\napp-name: ${{ env.app-name }}\nslot-name: staging\npackage: website\n\nname: az cli logout\nrun: az logout\n\nThe preceding workflow defines several steps:\n\nYou're creating a new job called deploy_staging.\n2. You specify a dependency using n", 'eeds. This job needs the build job to complete\nsuccessfully before it starts.\n\n3. — This job also runs on the latest Ubuntu hosted agent, as specified with the runs-on\nattribute.\n\n4. You specify that this job is targeting the PRE-PROD environment using the\nenvironment object. You also specify the url property. This URL will be displayed in\nthe workflow diagram, giving users an easy way to navigate to the environment. The\nvalue of this property is', " set as the output of the step with id deploywebapp, which is\ndefined below.\n\n5. You're executing a download-artifact step to download the artifact (compiled web\napp) from the build job.\n\n6. You then login to Azure using the AZURE_CREDENTIALS secret you saved earlier.\nNote the ${{ }} notation for dereferencing variables.\n\n7. You then perform a webapp-deploy, specifying the app-name, slot-name, and path to\nthe downloaded artifact (package). This a", 'ction also defines an output parameter that\nyou use to set the url of the environment above.\n\n66 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n8. Finally, you execute a logout to log out of the Azure context.\n\n5. Commit the file.\n\n6. | When the run completes, you should see two successful jobs. The URL for the PRE-PROD\nstage has been set and selecting it will navigate you to your web app staging slot:\n\nS A Notsecure | cd-sim', 'plefeedreader-staging azurewebsites.net\n\nAZ Exams Learning rs) .NET on Actions\n\nSimple Feed Reader\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - SimpleFeedReader\n\n**Figure 6**: Deployment to PRE-PROD is successful.\n\n1. | Notice how the staging slot’s direct URL contains -staging:\n\n© A Not secure | cd-simplefeedreader-staging,azurewebsites.net\n\nAZ Exams B Learning es) -NET on Actions\n\nSimple Feed Reader\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - Simp', "leFeedReader\n\n**Figure 7**: The staging slot running.\n\n1. You can also now see deployments. Navigate to https://{your repository url}/deployments to\nview your deployments:\n\n67 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nPull requests Issues Codespaces Marketplace Explore\n\nDeployed to PRE-PROD\n\n**Figure 8**: View deployments.\n\nDeploy to production\n\nNow that you've deployed successfully to PRE-PROD, you'll want to deploy to ", "PROD. Deployment to\nPROD will be slightly different since you don't need to copy the website again - you just need to swap\nthe staging slot with the production slot. You'll do this using an Azure CLI (az) command.\n\n1. Navigate to the .github/workflows/dotnet.yml file and select the pencil icon to edit the file.\n\n2. Add anew job below the deploy_staging job as follows:\n{custom-style=CodeBox} “yml run: az logout # <-— last line of previous job: ins", 'ert below this\nline\ndeploy_prod: needs: deploy_staging runs-on: ubuntu-latest\n\nenvironment:\nname: PROD\nurl: ${{ steps.slot_swap.outputs.url }}\n\nsteps:\n- name: Login via Azure CLI\nuses: azure/login@v1\nwith:\ncreds: ${{ secrets.AZURE_ CREDENTIALS }}\n\nname: Swap staging slot into production\nid: slot_swap\nrun: |\naz webapp deployment slot swap -g ${{ env.rg-name }} -n ${{ env.app-name }} -s staging\nurl=$(az webapp show -g ${{ env.rg-name }} -n ${{ env.', 'app-name }} --query\n“defaultHostName" -o tsv)\necho "::set-output name=url: :http://$url"\n\n- name: az cli logout\nrun: az logout\n\nThe deployment to the PROD environment workflow specifies several steps:\n\n1. | Once again, you specify a new job deploy_prod that needs deploy_staging to\ncomplete before starting.\n\n2. You\'re targeting the PROD environment this time. Also, the url value is different from\nbefore.\n\n68 CHAPTER 3 | Continuous integration and ', "deployment with Azure DevOps\n3. For the steps, you don’t need to download the artifact since you're just going to\nperform a slot swap. You start by executing a login to the Azure context.\n\n4. The Swap staging slot into production step is a multi-line run command (note the use\nof the pipe symbol |). You also specify an id for this step so that you can refer to it\n(you refer to it in the url property of the environment). The first line executes the", " slot\nswap using the variables you defined above in the workflow. The second line uses an\naz webapp show command to extract the URL of the target web app. This final line\nuses ::set-output in an echo to create an output variable for this task, setting the value\nto the web app URL.\n\n[INOTE] The URL must start with http:// or https:// or it won't render.\n3. Commit the file.\n\n4. Let the workflow run for a couple minutes until it has deployed to PRE-", "PROD. At this point,\nthe workflow will pause and wait for the required approval since you're targeting the PROD\nenvironment, which requires an approval as defined earlier:\n\nUpdate dotnet.yml\n\n**Figure 9**; Waiting for an approval.\n\n1. Select Review deployments, select the PROD checkbox, optionally add a comment, and then\nselect Approve and deploy to start the PROD job.\n\nReview pending deployments\n\n2\n\nPROD\n\nLeave a comment\n\n3\n\n@ Approve and deploy", ' 1\n\n**Figure 10**: Approve the PROD deployment.\n\n1. The deployment should only take a few seconds. Once it has completed, the URL for the\nPROD environment will update.\n\n69 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nUpdate dotnet.yml\n\n**Figure 11**: PROD deployment completed.\n\n1. Selecting the PROD URL will navigate you to the PROD site.\n\nCG A Notsecure | cd-simplefeedreader.azurewebsites.net\n\nAZ Exams § Learning es) .NET ', 'on Actions\n\nSimple Feed Reader\n\nEnter a feed URL:\nRetrieve Feed\n\n© 2017 - SimpleFeedReader\n\n**Figure 12**: The PROD site.\n\nAdd a manual queue option\n\nYou now have an end-to-end build and deploy workflow, including approvals. One more change you\ncan make is to add a manual trigger to the workflow so that the workflow can be triggered from\nwithin the Actions tab of the repository.\n\n1. Navigate to the .github/workflows/dotnet.yml file and select the', ' pencil icon to edit the file.\n2. Add anew trigger between on and push on lines 3 and 4:\n:{custom-style=CodeBox} yml on: workflow_dispatch: # <-- this is the new line push: :::\n\n3. The workflow_dispatch trigger displays a Run workflow button in the Actions tab of the\nrepository—but only if the trigger is defined tn the default branch. However, once this trigger is\ndefined in the workflow, you can select the branch for the run.\n\n4. Commit the file', ".\n\n70 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n5. To see the Run workflow button, select the Actions tab. Select the .NET workflow in the list\nof workflows. At the top of the list of runs, you'll see the Run workflow button. If you select\nit, you can choose the branch to run the workflow against and queue it:\n\nissues Codespaces Marketplace Explore\n\n**Figure 13**: Manual dispatch.\n\nHandle environment configuration\n\nYour ", 'workflow is deploying the same binary to each environment. This concept is important to ensure\nthat the binaries you test in one environment are the same that you deploy to the next. However,\nenvironments typically have different settings like database connection strings. You want to ensure\nthat the DEV app is using DEV settings and the PROD app is using PROD settings.\n\nFor this simple app, there’s no database connection string. However, there’s ', 'an example configuration\nsetting that you can modify for each environment. If you open the simple-feed-\nreader/SimpleFeedReader/appsettings.json file, you\'ll see that the configuration includes a setting for\nthe Header text on the Index page:\n\n"UI" ° {\n"Index": {\n\n"Header": "Simple News Reader"\n\n}\nbs\n\nTo show how environment configuration can be handled, you\'re going to add a secret to each\nenvironment and then substitute that value into the sett', 'ings as you deploy.\n\nAdd environment secrets\n\n1. | Onyour repository, select Settings > Environments > PRE-PROD.\n\n2. Select Add secret and add a secret called index_header with the value PRE PROD News\nReader. Select Add secret.\n\n71 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nAdd secret\n\nName\n\n2\n\nindex_header\n\nValue\n\nPRE PROD News Reader @@\n\n**Figure 14**:; Add an environment secret.\n\n1. Repeat these steps to add a secret c', "alled index_header with the value PROD News Reader for\nthe PROD environment.\n\n2. If you select Settings > Secrets in the repository, you'll see the changes. They should look\nsomething like this:\n\nActions secrets New repository secret\n\nSecrets are environment variables that are encrypted. Anyone with collaborator access to this repository can use these secrets for Actions\n\nSecrets are not passed to workflows that are triggered by a pull request fr", 'om a fork. Learn more\n\nEnvironment secrets\n\nManage environment\n\nManage environment\n\nRepository secrets\n\nUpdate\n\n**Figure 15**: View secrets.\n\n1. Navigate to the .github/workflows/dotnet.yml file and select the pencil icon to edit the file.\n\n2. Add the following step before the az cli logout step in the deploy_staging job:\n\nNNN\n\n::{custom-style=CodeBox} “yml - name: Update config uses: Azure/appservice-settings@v1\nwith: app-name: ${{ env.app-name ', '}} slot-name: staging app-settings-json:| [ { "name":\n"Ul:index:Header", "value": "${{ secrets.INDEX_HEADER }}","slotSetting”: true } ]\n\n- name: az cli logout # <-- this exists already\n\nNNN\n3. | Add almost the same code to the deploy_prod job above its az cli logout step. The only\ndifference is that you don\'t specify a slot-name, since you\'re targeting the production slot:\n\n::{custom-style=CodeBox} “yml - name: Update config uses: Azure/appservic', 'e-settings@v1\nwith: app-name: ${{ env.app-name }} app-settings-json:| [ { "name": "Ul:Index:Header",\n"value": "${{ secrets.INDEX_HEADER }}","slotSetting”: true } ]\n\n- name: az cli logout # <-- this exists already\n\n4. Commit the file.\n\n5. Let the workflow run and approve the deployment to PROD once the approval is reached.\n\n6. You should see the following headers on the index page for both sites:\n\nA Notsecure | cd-simplefeedreader-staging.azureweb', '... = «6G ? oe G A Notsecure | cd-simplefeedreader.azurewebsites.net\n\nJ AZ Exams Learning QO NET on Actions $ arming QO .NET on Actions\n\nPRE PROD News Reader PROD News Reader\n\nEnter a feed URL: Enter a feed URL:\nRetrieve Feed\n\nRetrieve Feed\n\n© 2017 - SimpleFeedReader © 2017 - SimpleFeedReader\n\n**Figure 16**: Settings changed in the environments.\n\nFinal workflow file\n\nThe final workflow file should look like this:\n\nname: .NET\n\non:\nworkflow_dispatc', 'h:\ninputs:\nreason:\ndescription: \'The reason for running the workflow’\nrequired: true\ndefault: ‘Manual build from GitHub UI\'\npush:\nbranches: [ main ]\npull request:\nbranches: [ main ]\n\nenv:\napp-name: "cd-simplefeedreader"\nrg-name: "“cd-dotnetactions"\n\njobs:\nbuild:\n\n73 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n74\n\nruns-on: ubuntu-latest\n\nsteps:\n- uses: actions/checkout@v3\n- name: ‘Print manual run reason\'\nif: ${{ github.eve', "nt_name == 'workflow_dispatch' }}\nrun: |\necho ‘Reason: ${{ github.event.inputs.reason }}'\n- name: Setup .NET\nuses: actions/setup-dotnet@v3\nwith:\ndotnet-version: 6.0.x\n- name: Restore dependencies\nrun: dotnet restore\n- name: Build\nrun: dotnet build --no-restore\n- name: Test\nrun: dotnet test --no-build --verbosity normal\n- name: Publish\nrun: dotnet publish SimpleFeedReader/SimpleFeedReader.csproj -c Release -o website\n- name: Upload a Build Artifac", 't\nuses: actions/upload-artifact@v3\nwith:\nname: website\npath: SimpleFeedReader/website/**\nif-no-files-found: error\n\ndeploy_staging:\nneeds: build\nruns-on: ubuntu-latest\n\nenvironment:\nname: STAGING\nurl: ${{ steps.deploywebapp.outputs.webapp-url }}\n\nsteps:\n\n- name: Download a Build Artifact\nuses: actions/download-artifact@v3\nwith:\n\nname: website\npath: website\n\n- name: Login via Azure CLI\nuses: azure/login@v1\nwith:\ncreds: ${{ secrets.AZURE_CREDENTIALS', ' }}\n\n- name: Deploy web app\nid: deploywebapp\nuses: azure/webapps-deploy@v2\nwith:\napp-name: ${{ env.app-name }}\nslot-name: staging\npackage: website\n\n- name: Update config\nuses: Azure/appservice-settings@v1\nwith:\napp-name: ${{ env.app-name }}\nslot-name: staging\napp-settings-json: |\n\nCHAPTER 3 | Continuous integration and deployment with Azure DevOps\n{\n"name": "UI:Index:Header",\n"value": "${{ secrets. INDEX_HEADER }}",\n“slotSetting": true\n\n}\n\n]\n\n- n', 'ame: az cli logout\nrun: az logout\n\ndeploy_prod:\nneeds: deploy staging\nruns-on: ubuntu-latest\n\nenvironment:\nname: PROD\nurl: ${{ steps.slot_swap.outputs.url }}\n\nsteps:\n- name: Login via Azure CLI\nuses: azure/login@v1\nwith:\ncreds: ${{ secrets.AZURE_CREDENTIALS }}\n\n- name: Swap staging slot into production\nid: slot_swap\nrun:\naz webapp deployment slot swap -g ${{ env.rg-name }} -n ${{ env.app-name }} -s\nstaging\nurl=$(az webapp show -g ${{ env.rg-name ', '}} -n ${{ env.app-name }} --query\n“defaultHostName" -o tsv)\necho "::set-output name=url: :http://$url"\n\n- name: Update config\nuses: Azure/appservice-settings@v1\nwith:\napp-name: ${{ env.app-name }}\napp-settings-json: |\n\n[\n{\n"name": "UI:Index:Header",\n"value": "${{ secrets. INDEX_HEADER }}",\n“slotSetting": true\n}\n]\n\n- name: az cli logout\nrun: az logout\n\nSecure .NET Code with CodeQL and GitHub Actions\n\nCodeQL Is a static code analysis engine that ca', 'n automate security and quality checks. With CodeQL,\nyou can perform variant analysis, which uses known vulnerabilities as seeds to find similar issues.\n\nCodeQL is part of GitHub Advanced Security that includes:\n\n[\'!div class="checklist”]\n\n75 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\n. Code scanning—find potential security vulnerabilities in your code.\n. Secret scanning—detect secrets and tokens that are committed.\n\n. De', 'pendency scanning—detect vulnerabilities in packages that you consume.\n\nCodeQL supports some of the most popular programming languages and compilers:\n\n. C/C++\n° Java\n\n° C#\n\n° Python\n° Go\n\n. JavaScript\n. TypeScript\nCodeQL is a powerful language and security professionals can create custom queries using CodeQL.\n\nHowever, teams can benefit immensely from the large open-source collection of queries that the\nsecurity community has created without havi', 'ng to write any custom CodeQL.\n\nIn this article, you\'ll set up a GitHub workflow that will scan code in your repository using CodeQL.\nYou will:\n\n[!div class="checklist”]\n. Create a code scanning action.\n\n. Edit the workflow file to include custom scan settings.\n\n. See scanning results.\n\nNote\n\nTo see security alerts for your repository, you must be a repository owner.\n\nCreate the code scanning workflow\n\nYou can use a Starter workflow for code scan', 'ning by navigating to the Security tab of your repository.\n\n1. Navigate to your GitHub repository and select the Security > Code Scanning Alerts. The top\nrecommended workflow should be CodeQL Analysis. Select Set up this workflow.\n\nPull requests issues Marketplace Explore\n\nCodeQL Analysis\n\n**Figure 1:** Create a new code scanning workflow.\n\n76 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nA new workflow file is created in yo', "ur .github/workflows folder.\n\n2. Select Start Commit on the upper right to save the default workflow. You can commit to the\nmain branch.\n\nPull requests Issues Marketplace Explore\n\nStart commit ~\n\n**Figure 2:** Commit the file.\n\n1. Select the Actions tab. In the left-hand tree, you'll see a CodeQL node. Select this node to\nfilter for CodeQL workflow runs.\n\nPull requests Issues Marketplace Explore\n\nCodeQL\n\n1 workflow run\n\nCreate codeq|l-analysis.ym", 'i\n\n**Figure 3:** View the CodeQL workflow runs.\n\nTake a look at the workflow file while it runs. If you remove the comments from the file, you\'ll see the\nfollowing YAML:\n\nname: "CodeQL"\n\non:\npush:\nbranches: [ main ]\npull request:\nbranches: [ main ]\nschedule:\n- cron: ‘40 14 * * 6\'\n\njobs:\nanalyze:\nname: Analyze\nruns-on: ubuntu-latest\n\nstrategy:\nfail-fast: false\n\n77 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\nmatrix:\nlanguage', ": [ ‘csharp' ]\n\nsteps:\n- name: Checkout repository\nuses: actions/checkout@v3\n\n- name: Initialize CodeQL\nuses: github/codeql-action/init@v1\nwith:\nlanguages: ${{ matrix.language }}\n\n- name: Autobuild\nuses: github/codegl-action/autobuild@v1\n\n- name: Perform CodeQL Analysis\nuses: github/codeql-action/analyze@v1\n\nNotice the following things:\n1. The workflow name is CodeQL.\n\n2. This workflow triggers on push and pull_request events to the main branch. ", "There's also a\ncron trigger. The cron trigger lets you define a schedule for triggering this workflow and is\nrandomly generated for you. In this case, this workflow will run at 14:40 UTC every Saturday.\n\n[!TIP] If you edit the workflow file and hover over the cron expression, a tooltip will show you\nthe English text for the cron expression.\n\n3. There's a single job called analyze that runs on the ubuntu-latest hosted agent.\n\n4. — This workflow de", 'fines a strategy with a matrix on the array of language. In this case, there’s\nonly csharp. If the repository contained other languages, you could add them to this array.\nThis causes the job to “fan out” and create an instance per value of the matrix.\n\n5. There are four steps, starting with checkout.\n\n6. |The second step initializes the CodeQL scanner for the language this job is going to scan.\nCodeQL intercepts calls to the compiler to build a d', 'atabase of the code while the code is\nbeing built.\n\n7. | The Autobuild step will attempt to automatically build the source code using common\nconventions. If this step fails, you can replace it with your own custom build steps.\n\n8. After building, the CodeQL analysis is performed, where suites of queries are run against the\ncode database.\n\n9. |The run should complete successfully. However, there appear to be no issues.\n\n78 CHAPTER 3 | Continuous i', "ntegration and deployment with Azure DevOps\nCode scanning\n\nFilters\n\nNo code scanning alerts found.\n\n**Figure 4:** No results to the initial scan.\n\nCustomize CodeQL settings\n\nThe CodeQL scan isn’t reporting any security issues. That's expected with this basic sample. CodeQL\ncan also scan for quality issues. The current workflow is using the default security-extended suite. You\ncan add quality scanning in by adding a configuration file to customize", " the scanning suites. In this\nstep, you'll configure CodeQL to use the security-and-quality suites.\n\n[INFORMATION] For other CodeQL configuration options, see Configuring CodeQL code scanning in\nyour Cl system.\n1. Navigate to the .github folder in the Code tab and select Add File:\n\nPull requests Issues Marketplace Explore\n\nStar {\n\nSSUE TEMPLATE\n\n**Figure 5:** Create a new file.\n\n1. Enter codeql/codeql-config.yml as the name. This creates the file", ' in a folder. Paste in the\nfollowing code:\n\n{custom-style=CodeBox} “\'yml name: “Security and Quality”\nqueries:\n\n- uses: security-and-quality ~~ :::\n\n79 CHAPTER 3 | Continuous integration and deployment with Azure DevOps\noe) Search or jump to... Pull requests Issues Marketplace Explore\n\nforked from\n\ncodeq|-config.yml Cancel\n\n<> Edit new file\n\nname: "Security and Quality”\n\nqueries:\n\n- uses: security-and-quality\n\n**Figure 6:** Create the CodeQL conf', 'iguration file.\n\n1. Select Commit to main at bottom of the editor to commit the file.\n\n2. Edit the CodeQL workflow to use the new configuration file. Navigate to\n.github/workflows/codeql-analysis.yml and select the pencil icon. Add a new property to the\nwith section as shown below:\n\n:{custom-style=CodeBox} yml - name: Initialize CodeQL uses: github/codeql-action/init@v1\nwith: languages: ${{ matrix.language }} config-file: ./.github/codeql/codeql-', "config.yml # <--\nadd this line :::\n\n1. Select Start Commit and commit to the main branch.\n\nReview the security alerts\nImportant\n\nYou must be a repository owner to view security alerts.\n\nThis sample repository is small. As such, it doesn't contain any major security or quality issues.\nHowever, “real world” repositories will likely have some issues.\n\nWhen the last CodeQL workflow run completes, you should see two issues in the Security tab:\n\n80 CHA", 'PTER 3 | Continuous integration and deployment with Azure DevOps\nws) Search or jump to Pull requests Issues Marketplace Explore\n\ncolindembovsky / simple-feed-reader\n\nforked from Azure~Samples/simple-feed-reade\n\n© Security\n\nOverview Code scanning\n\nSet up more code scanning tools\n\nSecurity policy\nFilters ~\n\nSecurity advisories\n\n~“ 2 Open\nDependabot alerts\n\nMissed ‘readonly’ opportunity\n\nCode scanning alerts\n\nCodeQl sss readonly’ opportunity\n\nProTip', '!\n\nLearn more\n\nFigure 7: View security alerts.\n\nSelect the first alert to open it.\n\n2. In this case, the alert is for a generated file that isn’t committed to the repository. For that\nreason, the preview is unavailable.\n\n3. Notice the tags that are applied. These tags can be used for filtering issues.\n\n4. Select Show more under the rule information to show help and recommendations.\n\nMissed ‘readonly’ opportunity\n\n&> language features\n\nanch: maste', 'r ~ Dismiss ~\n\nSimpleF eedReader/obj/Debug/netcoreapp2 .1/Razor/Pages/Index.cshtml.g.cs | Generated\n\nPreview unavailable\nField *__tagHelperRunner’ can be ‘readonly’.\n\nTool Rule ID Query\n\nCodeQL cs/missed-readonly-modifier View source\n\nA private field where all assignments occur as part of the declaration or in a constructor in the same class can be readonly . Making a field\nreadonly prevents unintended assignments after object initialization.\n\n© ', "First appeared in commit 824b301 8 minutes ago\n\nSimpleFeedReader/obj/Debug/netcoreapp2.1/Razor/Pages/Index.cshtml.g.cs#L31 on branc\n\n**Figure 8:** Open an alert.\n\n1. Selecting Dismiss will open options for dismissing this issue:\nDismiss +\n\nDismiss reason\n\nFalse positive\n\nThis alert ts not valid\n\nUsed in tests\n\nThis alert ts not in production code\n\nWon't fix\n\nThis alert ts not relevant\n\n**Figure 9:** Dismiss an alert.\n\n82 CHAPTER 3 | Continuous in", 'tegration and deployment with Azure DevOps\nCHAPTER\n\nMonitor and debug\n\nHaving deployed the app and built a DevOps pipeline, it\'s important to understand how to monitor\nand troubleshoot the app.\n\nIn this section, you\'ll complete the following tasks:\n\n[\'!div class="checklist”]\n\n. Find basic monitoring and troubleshooting data in the Azure portal\n\n. Learn how Azure Monitor provides a deeper look at metrics across all Azure services\n. Connect the web', ' app with Application Insights for app profiling\n\n. Turn on logging and learn where to download logs\n\n. Stream logs in real time\n\n. Learn where to set up alerts\n\n. Learn about remote debugging Azure App Service web apps.\n\nBasic monitoring and troubleshooting\n\nApp Service web apps are easily monitored in real time. The Azure portal renders metrics in easy-to-\nunderstand charts and graphs.\n\n1. Open the Azure portal, and then navigate to the mywebap', 'p<unique_number> App Service.\n\n2. The Overview tab displays useful “at-a-glance” information, including graphs displaying\nrecent metrics.\n\nDATAOUT @\n| 12.94 kB\n\nS:15 PM 5:30 PM\nAVERAGE RESPONS...\n243.52 ms\n\n83 CHAPTER 4 | Monitor and debug\n**Http 5xx**: Count of server-side errors, usually exceptions in ASP.NET Core code.\n**Data In**: Data ingress coming into your web app.\n\n**Data Out**: Data egress from your web app to clients.\n\n**Requests**: Co', 'unt of HTTP requests.\n\n**kAverage Response Time**: Average time for the web app to respond to HTTP requests.\n\n*\n*\n*\n*\n*\n\nSeveral self-service tools for troubleshooting and optimization are also found on this\npage.\n\nee mywebapp21816\n\n[5 Browse ™ Stop i, Swap Restart MH Delete WS Get publish profile (2 Reset publish profile\na _\nResource group &hangd URL\n= - AzureTutorial https://mywebapp21816.azurewebsites.net\nSS Overview Pe ve pp\n~ Status App Serv', 'ice plan/pricing tier\nokey | Runnin 9 mywebapp21816 (Standard: 1 Small)\ncti\n3 Location Git/Deployment username\n. Centra POS Camm sco per\nsea Acc ontrol (IAM)\nSubscriptio Git <\ner vs-beta https: per@mywebapp21816.scm.azurewebsites.net:443/mywebapp21816.git\na\n2 Subscription ID FTP hy\ndf11f062-9277-40f1-a559-888e4c82c4db ftp://waws-prod-dm 1-089.ftp.azurewebsites.windows.net\n: P: P P.\ni\n\nDEPLOYMENT\n\nGF Deployment options Http 5Sxx a Data In , a Data', ' Out , a\n\nG Continuous Delivery (Preview)\n\n200 10kB 6kEB\n\n80 8kB 5kB\n\nSETTINGS 4kB\n60 6kB\n\n~ 3kB\n= Application settings a0 axe\n\n2ke\n\nAuthentication / Authorization 20 2kB —\n\no OkB OkB\n\nPM 5:45 PM 6PM A 5:30 PM 5:45 PM 6 PM 5:15 5:30 PM 5:45 PM 6 PM\n\n?\n@ Application Insights eas pn —_ 5 eas pn on\n\nHTTP SERVER ERRORS @ DATAIN @ DATA OUT @\n& Managed service identity (Pr...\n\n21.19 kB 17.57 kB\n@® Backups\nGi Custom domains\nRequests Average Response Tim', 'e\n\n© SSL settings rf rf\n\n<> Networking\n\n1 Scale up (App Service plan) 4 &\n{Z Scale out (App Service plan) . ~\n‘@ Weblobs 1\n° Os\n5:30 PM 5:45 PM 6PM\n\nPush OPM 5:45 PM 6PM\n\nS:15 PM S:15 PM 5:30 P\nREQUESTS @ | AVERAGE RESPONS... @\n10 244.29 ms\n\n| Properties\n\na\n\n&. MySQL In App\n!\n\na\n\nLocks\n\n* **Diagnose and solve problems** is a self-service troubleshooter.\n\n* **Application Insights** is for profiling performance and app behavior, and is\ndiscussed la', 'ter in this section.\n\n* **Anp Service Advisor** makes recommendations to tune your app experience.\n\nAdvanced monitoring\n\nAzure Monitor is the centralized service for monitoring all metrics and setting alerts across Azure\nservices. Within Azure Monitor, administrators can granularly track performance and identify trends.\nEach Azure service offers its own set of metrics to Azure Monitor.\n\nProfile with Application Insights\n\nApplication Insights is a', 'n Azure service for analyzing the performance and stability of web apps and\nhow users use them. The data from Application Insights is broader and deeper than that of Azure\nMonitor. The data can provide developers and administrators with key information for improving\napps. Application Insights can be added to an Azure App Service resource without code changes.\n\n1. Open the Azure portal, and then navigate to the mywebapp<unique_number> App Service.', "\n2. From the Overview tab, click the Application Insights tile.\n\n84 CHAPTER 4 | Monitor and debug\n? Application Insights\n\n= Application Insights helps you detect and diagnose quality\nISSUe5 in your apps, and helps you understand what your\nusers actually do with it.\n\n1. Select the Create new resource radio button. Use the default resource name, and select the\nlocation for the Application Insights resource. The location doesn't need to match that o", 'f your\nweb app.\n\ni? Application Insights\n\nApplication Insights helps you detect and diagnose quality issues in your web apps and web services, and helps yo\nqxtually do with it.\nGetting started with Application Insights monitoring\n\nLink your application to Application Insights\n\n© Select existing resource\n\n9 my-blog my-blog South Central US\n\n® Create new resource\n\n* New resource name * Location\nmywebapp21816 v|| East US\n\nInstrument your application', '\n\n* . .\nRuntime/Framework\n\nASP.NET Core\n\nCode level diagnostics\nIdentify code that slowed down your web app and debug runtime exceptions with local variables\nOn\n\nv Advanced Settings\n\n1. For Runtime/Framework, select ASP.NET Core. Accept the default settings.\n2. Select OK. If prompted to confirm, select Continue.\n\nAfter the resource has been created, click the name of Application Insights resource to\nnavigate directly to the Application Insights p', 'age.\n\nvy) mywebapp2 1616 Application Insights resource is connected Change\n\nTroubleshooting information\nAs the app Is used, data accumulates. Select Refresh to reload the blade with new data.\n\n85 CHAPTER 4 | Monitor and debug\nv7 mywebapp21816\n\n9 Overview\n\nid Activity log\n\nsila Access control (IAM)\n¢ Tags\n\nx Diagnose and solve problems\n\nINVESTIGATE\n—™ Application map\n@ Smart Detection\n‘- Live Metrics Stream\nill Metrics Explorer\nlef Metrics (previe', 'w)\nSearch\n\n® availability\n\ntlt Failures\n\n‘\n\nPerformance\n\nServers\n\nBrowser\n\nWorkbooks (preview)\n\nUSAGE (PREVIEW)\nwa Users\n> Sessions\n\nEvents\n\na\n\nFunnels\n\nUser Flows\n\nRetention\n\noO ff\n\nImpact\n\nCohorts\n\nQ. Search ify Metrics Explorer S88 Analytics © Time range | ©) Refresh *** More\n\nPe wccccccceeccccccccescy\n\nEssentials V;\n\nA- Live Stream Smart Detection\nrr\nClick to | af\nAlerts configure Users Detections (7d) Availability App map\nHealth\nOverview tim', 'eline nes\n\nMYWEBAPP21816\n\nSERVER RESPONSE TI... @\n\n1.53;\n\n20ms PAGE VIEW LOAD TIME @\nOms -=\n\n20 SERVER REQUESTS @\n\no al. 39\n\n10\n\n5 FAILED REQUESTS @\n\nC al. 11\n\nMay 31 6AM 12 PM 6PM\n\nTotal of Server Requests by Request Performance\n\nMYWEBAPP21816\nREQUEST PERFORMANCE TOTAL % TOTAL\n\n<250ms yy 43.6%\n250ms-500ms P| 20.5%\nIsec-3sec | 6 15.4%\n500ms-Isec | | + 10.3%\nTsec-15sec | 2 5.1%\nI5sec-30sec | 1 2.6%\n3sec-7sec | 1 2.6%\n\nApplication Insights provides', ' useful server-side information with no additional configuration. To get\n\nthe most value from Application Insights, instrument your app with the Application Insights SDK.\nWhen properly configured, the service provides end-to-end monitoring across the web server and\n\n86\n\nCHAPTER 4 | Monitor and debug\nbrowser, including client-side performance. For more information, see the Application Insights\ndocumentation.\n\nLogging\n\nWeb server and app logs are d', 'isabled by default in Azure App Service. Enable the logs with the\nfollowing steps:\n\n1. Open the Azure portal, and navigate to the mywebapp<unique_number> App Service.\n2. Inthe menu to the left, scroll down to the Monitoring section. Select Diagnostics logs.\n\nMONITORING\n\naf Alerts (Classic)\n\nES Diagnostics logs\n\nLog stream\n\nms Process explorer\n\n1. Turn on Application Logging (Filesystem). If prompted, click the box to install the\nextensions to ena', 'ble app logging in the web app.\n\n2. Set Web server logging to File System.\n3. Enter the Retention Period in days. For example, 30.\n4. Click Save.\n\nASP.NET Core and web server (App Service) logs are generated for the web app. They can be\ndownloaded using the FTP/FTPS information displayed. The password is the same as the deployment\n\ncredentials created earlier in this guide. The logs can be streamed directly to your local machine with\nPowerShell o', 'r Azure CLI. Logs can also be viewed in Application Insights.\n\nLog streaming\n\nApp and web server logs can be streamed in real time through the portal.\n\n1. Open the Azure portal, and navigate to the mywebapp<unique_number> App Service.\n2. Inthe menu to the left, scroll down to the Monitoring section and select Log stream.\n\n87 CHAPTER 4 | Monitor and debug\nMONITORING\naf Alerts (Classic)\nES Diagnostics logs\n\nms Process explorer\n\nLogs can also be str', 'eamed via Azure CLI or Azure PowerShell, including through the Cloud Shell.\n\nAlerts\n\nAzure Monitor also provides real time alerts based on metrics, administrative events, and other\ncriteria.\n\nNote\n\nCurrently alerting on web app metrics is only available in the Alerts (classic) service.\n\nThe Alerts (classic) service can be found in Azure Monitor or under the Monitoring section of the App\nService settings.\n\nMONITORING\nES Diagnostics logs\nit | Log s', 'tream\n\nme Process explorer\n\nLive debugging\n\nAzure App Service can be debugged remotely with Visual Studio when logs don’t provide enough\ninformation. However, remote debugging requires the app to be compiled with debug symbols.\nDebugging shouldn\'t be done in production, except as a last resort.\n\n88 CHAPTER 4 | Monitor and debug\nConclusion\n\nIn this section, you completed the following tasks:\n[\'!div class="checklist”]\n\n. Find basic monitoring and t', 'roubleshooting data in the Azure portal\n\n. Learn how Azure Monitor provides a deeper look at metrics across all Azure services\n. Connect the web app with Application Insights for app profiling\n\n. Turn on logging and learn where to download logs\n\n. Stream logs in real time\n\n. Learn where to set up alerts\n\n. Learn about remote debugging Azure App Service web apps.\n\nAdditional reading\n\n. Troubleshooting ASP.NET Core on Azure App Service and IIS\n\n° C', 'ommon errors reference for Azure App Service and IIS with ASP.NET Core\n\n° Monitor Azure web app performance with Application Insights\n\n° Enable diagnostics logging for web apps in Azure App Service\n\n. Troubleshoot a web app in Azure App Service using Visual Studio\n\n. Create classic metric alerts in Azure Monitor for Azure services - Azure portal\n\n89 CHAPTER 4 | Monitor and debug\nCHAPTER 5\n\nNext steps\n\nIn this guide, you created a DevOps pipeline ', 'for an ASP.NET Core sample app. Congratulations! We\nhope you enjoyed learning to publish ASP.NET Core web apps to Azure App Service and automate the\ncontinuous integration of changes.\n\nBeyond web hosting and DevOps, Azure has a wide array of Platform-as-a-Service (PaaS) services\nuseful to ASP.NET Core developers. This section gives a brief overview of some of the most commonly\nused services.\n\nStorage and databases\n\nRedis Cache is high-throughput,', ' low-latency data caching available as a service. It can be used for\ncaching page output, reducing database requests, and providing ASP.NET Core session state across\nmultiple instances of an app.\n\nAzure Storage is Azure’s massively scalable cloud storage. Developers can take advantage of Queue\nStorage for reliable message queuing, and Table Storage is a NoSQL key-value store designed for\nrapid development using massive, semi-structured data sets.', '\n\nAzure SQL Database provides familiar relational database functionality as a service using the Microsoft\nSQL Server Engine.\n\nCosmos DB globally distributed, multi-model NoSQL database service. Multiple APIs are available,\nincluding SQL API (formerly called DocumentDB), Cassandra, and MongoDB.\n\nIdentity\n\nAzure Active Directory and Azure Active Directory B2C are both identity services. Azure Active\nDirectory is designed for enterprise scenarios an', 'd enables Azure AD B2B (business-to-business)\ncollaboration, while Azure Active Directory B2C is intended business-to-customer scenarios, including\nsocial network sign-in.\n\nMobile\n\nNotification Hubs is a multi-platform, scalable push-notification engine to quickly send millions of\nmessages to apps running on various types of devices.\n\n90 CHAPTER 5 | Next steps\nWeb infrastructure\n\nAzure Container Service manages your hosted Kubernetes environment,', ' making it quick and easy to\ndeploy and manage containerized apps without container orchestration expertise.\n\nAzure Search is used to create an enterprise search solution over private, heterogenous content.\n\nService Fabric is a distributed systems platform that makes it easy to package, deploy, and manage\nscalable and reliable microservices and containers.\n\n91 CHAPTER 5 | Next steps\n']