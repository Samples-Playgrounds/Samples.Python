"[\"ES Microsoft\\n\\nModernizing Desktop\\nApps on Windows\\nwith .NET 7\\n\\nae,\\n\\noA\\n\\nMiguel Angel Castejon Doming\", \"uez\\n\\nOlia Gavrysh\\n\\nmE Microsoft\\n\\nEDITION v1.0.3 - Updated to .NET 7\\n\\nRefer to the changelog for the \", \"book updates and community contributions.\\nPUBLISHED BY\\n\\nMicrosoft Developer Division, .NET, and Visu\", \"al Studio product teams\\n\\nA division of Microsoft Corporation\\n\\nOne Microsoft Way\\n\\nRedmond, Washington\", \" 98052-6399\\n\\nCopyright \\u00a9 2022 by Microsoft Corporation\\n\\nAll rights reserved. No part of the contents\", \" of this book may be reproduced or transmitted in any\\nform or by any means without the written permi\", \"ssion of the publisher.\\n\\nThis book is provided \\u201cas-is\\u201d and expresses the author's views and opinions\", \". The views, opinions, and\\ninformation expressed in this book, including URL and other Internet webs\", \"ite references, may change\\nwithout notice.\\n\\nSome examples depicted herein are provided for illustrat\", \"ion only and are fictitious. No real association\\nor connection is intended or should be inferred.\\n\\nM\", \"icrosoft and the trademarks listed at https://www.microsoft.com on the \\u201cTrademarks\\u201d webpage are\\ntrad\", \"emarks of the Microsoft group of companies.\\n\\nMac and macOS are trademarks of Apple Inc.\\nAll other ma\", \"rks and logos are property of their respective owners.\\nCo-Authors:\\n\\nOlia Gavrysh, Program Manager, .\", \"NET team, Microsoft\\n\\nMiguel Angel Castejon Dominguez, Innovation Architect, Kabel\\n\\nParticipants and \", \"reviewers:\\n\\nMaira Wenzel, Senior Program Manager, .NET team, Microsoft\\n\\nAndy De Gorge, Senior Conten\", \"t Developer, .NET docs team, Microsoft\\n\\nMiguel Ramos, Senior Program Manager, Windows Developer Plat\", \"form team, Microsoft\\nAdam Braden, Principal Program Manager, Windows Developer Platform team, Micros\", \"oft\\nRicardo Minguez Pablos, Senior Program Manager, Azure loT team, Microsoft\\n\\nNish Anil, Senior Pro\", \"gram Manager, .NET team, Microsoft\\n\\nBeth Massi, Senior Product Marketing Manager, Microsoft\\n\\nScott H\", \"unter, Partner Director Program Manager, .NET team, Microsoft\\n\\nMarta Fuentes Lara, Kabel\\nmE Microsof\", \"t\\n\\nRaul Fernandez de Cordoba, Kabel\\n\\nAntonio Manuel Fernandez Cantos, Kabel\\n\\nIntroduction\\n\\nThis book\", \" is about strategies you can adopt to move your existing desktop applications through the\\npath of mo\", \"dernization and incorporate the latest runtime, language, and platform features. You'll\\ndiscover tha\", \"t there\\u2019s no unique recipe as each application is different, and so are your requirements\\nand prefer\", \"ences. The good news is that there are common approaches you can apply to add new\\nfeatures and capab\", \"ilities to your applications. Some of them won't even require major modifications\\nof your code. In t\", \"his book, we'll reveal how all those features work behind the scenes and explain the\\nmechanics of th\", \"eir implementations. Moreover, you'll find some common scenarios for modernizing\\nexisting desktop ap\", \"plications shown in detail so you can find inspiration for evolving your projects.\\n\\nMicrosoft's appr\", \"oach to modernizing existing applications is to give you the flexibility to create your\\nown customiz\", \"ed path. All the modernization strategies described in this book are mostly independent.\\nYou can cho\", \"ose ones that are relevant for your application and skip others that aren't important for\\nyou. In ot\", \"her words, you can mix and match the strategies to best address your application needs.\\n\\nWho should \", \"use the book\\n\\nThis book for developers and solution architects who want to modernize existing Window\", \"s Forms and\\nWPF desktop applications to leverage the benefits of INET and Windows 10.\\n\\nYou might als\", \"o find this book useful if you're a technical decision maker, such as an enterprise\\narchitect or a d\", \"evelopment lead or director who wants an overview of the benefits of updating\\nexisting desktop appli\", \"cations.\\n\\nHow to use the book\\n\\nThis book addresses the \\u201cwhy\\\"\\u2014why you might want to modernize your ex\", \"isting applications, and the\\nspecific benefits you get from using NET and MSIX to modernize your des\", \"ktop apps. The content of\\nthe book is designed for architects and technical decision makers who want\", \" an overview, but who\\ndon't need to focus on implementation and technical, step-by-step details.\\n\\nAl\", \"ong the different chapters, sample implementation code snippets and screenshots are provided,\\nwith c\", \"hapter 5 devoted to showcase a complete migration process for sample applications.\\n\\nWhat this book d\", \"oesn't cover\\n\\nThis book covers a specific subset of scenarios that are focused on lift-and-shift sce\", \"narios, outlining\\nthe way to gain the benefits of modernizing without the effort of rewriting code.\\n\", \"\\nThis book isn't about developing modern applications with .NET from scratch or about getting starte\", \"d\\nwith Windows Forms and WPF. It focuses on how you can update existing desktop applications with\\nth\", \"e latest technologies for desktop development.\\nmE Microsoft\\n\\nSamples used in this book\\n\\nTo highlight\", \" the necessary steps to perform a modernization, we'll be using a sample application\\ncalled eshopMod\", \"ernizing. This application has two flavors, Windows Forms and WPF, and we'll show a\\nstep-by-step pro\", \"cess on how to perform the modernization on both of them to .NET.\\n\\nAlso, on the GitHub repository fo\", \"r this book, you'll find the results of the process, which you can\\nconsult with if you decide to fol\", \"low the step-by-step tutorial.\\nContents\\n\\nWhy modern desktop applications .................cccccccccc\", \"ccsccsssscsssssssssscssssssssssssssssessssssscesccccecceecs 1\\nIM EFOCUCTION oo. eeceeeesecsessessess\", \"esessecsessesscsecsesscscsesucsscsecuessesscsecuesscsesuesucsecsesucsucsssuessesecsesuesucsessesucse\", \"ssesuesucsesnecuesessecuessaeeneaueaeeneeneasens 1\\n\\nA StOLY Of ONE COMPANY .u...cccessessssssssssess\", \"esssessecscsessessecucsessecsssucsessecussssecussussessecussessecussusseesecusseesecuesesseesesussee\", \"secessesseeneaeeses 1\\nYOUP StOLY w.e.eececcsesssssssssesssscsesesscsesesscsesesussesescussesecuesese\", \"suesesesuesesesussssesscsesescsesesssnssesesussesesucsesesscueseseanesesesussesesesneseseeueseseenee\", \"eaeens 1\\nDeSktOp Applications NOWACAYS ........ccesssssssssssssssssssssssssssesssssssesecsessssssess\", \"ssessssessssessssessssessesessesessesesseseesesessesesseseeseaeeseaseneens 1\\nWINCOWS FOPMMS .....cse\", \"ssssssssssessesseseesessecscscsesscsscsecscsucsessesucsecsesuesucsessecucscsesuesucsessecucsecsesues\", \"ucsessecuesessesuesussesseseaesseenenteaeeneeeenees 3\\nWPF .....cessesssssessssssssessecsessessessess\", \"ecsecsecuscuscuccuceuccucsussucsussucsucsussussucsucsucsscsucsscseescsecsessecuesuseuccuccucsucsucsu\", \"csussussuesussessesaeeaeeaeeaseaeeaeeaeenee 4\\nWP 2a ececsecssssssssssscssssussussussucsucsucsucsussu\", \"csucsscsucsucsucsucsucscsucsecsessecsessscussuccuccuccuccussucsuccussucsucaussucsussussucsucsessesse\", \"eaeeaeeaeeaeeaeeaeeaeeneeaeenee 4\\n\\nA tale Of two PlatfOrMs ...... ccc cccccesssssessssesssssesessess\", \"ecucsessessesussessecucsussesuessssessecussessecussussessesussessecussussesuesussessecucsesseencaess\", \"eeseensseess 5\\nPaths to MOCErMNIZATION ou... eee ecessessesessessesseseesecsesscsecsecuesscsecsesscs\", \"ecsesucsecsessesscscsecuesecsesuesucsessesucsecsesnecueseenecuesesaeeneaeaeeneeneasens 8\\nModern feat\", \"ure... cesessessesssssssssssesseesessecsecsessessessessecsecsessecsessessesuceuscussuscuceussucsussu\", \"csucsucsucsussussussssessesseeaeeseeaeeaeeaeeateaeeaeeneenee 8\\nDEPlOYMENK......eececessesessesessese\", \"ssecsssessssecussesussesussecussecussesussesussecussesussessssesussessssesussecussecsssessssesussesu\", \"ssesuesecussesnsseceesecueseeneseaneaeeneas 8\\nIStAN ATION... eee eeessesessessessesesecsessesscsesse\", \"cscsecsecuesscsessesucsessesuescsesuesscsesuesuesessessesecsecsecuesecsesucsecsesuesucsessecsesecsec\", \"uesucseeneaneaeeneenensens 8\\nWhat's new with .NET for Desktop ?..................scccccccccsscccccss\", \"sssssssssssssssssssssssssssssccccscsssssssssseees 9\\nThe Motivation Dehind .NET Core wo... eecececses\", \"ssssessesessessessesessesscsessesscssesessecucssssessesucsessesucsecsesuesucsessesucsessesuesessecne\", \"sueseeneeneasens 9\\nINTFOCUCTION TO NET COre ooeeeeeecececsesssssesseseesessesesessesnesscsecsesucscs\", \"essesucsecsesucscsecucsucsessesucsucsesuesucsessecucaesaecucasaeeneeueaeeneeneanens 11\\nJNET 5+ 1S NE\", \"T Core VNO@Xt.... ee ceececsessessssessessssscsessecscsscsecsesuesuesecscsucsssecucsussecucsusaessec\", \"ucsucsesnesucsessesuesucsessesueaeeseeueaeeaeeneaseass 11\\nJNET Framework Vs. .NET Qu. eceecessessess\", \"esessesscsecsessesucsscsessccucsecsccuesussecscsucaucsesucsucsesnesucaessesucsucsecucaueaessesuesucs\", \"esuesucaesseeueaeeaeeneeseass 12\\nDNET Standard vs. PCL wo..eececececssssssssssssessessesessessesnsse\", \"ssesscsussessesuesussecscsucassesucsussesnesucaessesucsucsesucaucaesnesuesucsesucsueaesseeueaeeaeene\", \"eneass 13\\nNew Desktop features IN NET oc cccscsssssssesssssssescsessssscsessssssccsssssssscsusssssss\", \"ussessessssussessecussessecsssussessecucsesseencsesseeseenssness 14\\nSupport for WINGOWS FOrMs ANd WP\", \"F uu... cceccessessessssessessesessessesscsessesscsucsessecucsessessesussessessesucseeseeussessesncs\", \"esseeneeneaeess 14\\nXAML ISlANS..... ee eecesseseseeseesessessesecsecucsscsecsccsesecsecucsscsesuesuc\", \"secsesuesscsecsesucsesnessesecsessesucsessesucsessesucsucsessesuesessesueaesseeneeeeseeseeenes 14\\nAc\", \"cess to all Windows 10 and WINdOWS 11 APIS uu... ececessessessssesesseseeseesecsesessessesseseeseese\", \"ssseeseseseeaeeeeeeaeeeeeenees 15\\nSide-by-side support and Self-CONtAING? EXES .......ececccsessesse\", \"sscsessessecscsessecscsssessesussessecscsecseesesussesseenesesseeseensseess 15\\nPOrfOrMane .....cecse\", \"ssssssssssssssesesscsssscsucsscsucscsecsessecsecsessecsecsessecsessecuecuscuccucsussucsucsucsussucsu\", \"ssussucsucsussesseeseeseeseeaeeaeeaseaeeaeeneeaeenee 15\\nMigrating Modern Desktop application........\", \"..............cssssssssscssssssssscscssccccescccceccccsecccessessees 16\\nCONFIGUIATION FIOS oo. eecec\", \"scsessessescsessessesscsessecsssussessecussussesussussucsecussussesussussessecussucsecsssussssecussu\", \"cseescsussessecucsesseeneaesseeseeneaeeass 16\\nCONFIGUIAatiON ON .NET Framework ......cecceccssesssss\", \"essssessecscsessessesssessesscsessesscsucsessecussssessesussessecuesesseesssessesseeessesseeseaeeaes\", \" 16\\n\\ni Contents\\nCONFIGUFATION ON .NET u.u.eecccesessessessssessesscsessecscsessessecussussecucsusses\", \"secussussecucsussussecusssssecussusseenesussessecucsussesuesussesseeussesseeneaneass 17\\n\\nMigrating C\", \"ONFIQUrATION FIIOS cee esessesessessecscsessessessssessecsssussessecussessecussussessecussesseenssus\", \"sessecussesseesesesseeseeneseeseeneeeeaes 17\\nACCESSING CataDaSeS ou... ccecsscesssssssesessessssesss\", \"ecessessssesussesussesussesussesussesucsesussessssesussecessecussesussecsssecessesessecuesecessecess\", \"eceeseensseenees 18\\n(\\u00a9) D) S| Ce ee eee 19\\nOLE DBoueeeccecssssssessessessecsessessccsecssssccsccuscu\", \"csucsucsucsussussucsucsucsucsucsucsessessessecsecsecsssuceuscuceuccucsussucsucsussussucsucsucsesaess\", \"eeseeaeeneeaeeaseaeenss 19\\nADOL.NET ....sessessssssssessessessessessecsecsscsccuscuecucsucsucsucsuss\", \"ucsussussucsucsucsucsucsucscsecsesseeaeeuecuesuecuccuccussucsucsucsucsussusssseeseeaeeseeaeeateaeeae\", \"eaeenee 19\\nEF COre VS. EFO......ceesessssessesessesessesessessssesssesussesscsesscsesucsesecsesscses\", \"essesscsesessesscsesessesessesessesecuesecsesesuesesuenececsesueaeeneaeeneaeeneaeenees 19\\nRelational\", \" database ou... eescesesssssssssssssessesseseseesessssessessesucsessssncsussessecussecsesuesussessec\", \"ucsessesuesucsessesucsessesueseaeeaeeeneeaeeneeneaees 20\\nCONSUMING SEPVICES ....esscsessssessesesses\", \"essesessescsesussesussesucsessssesussesussesussesussessssesussesussessesesussesussesussesussesuesesu\", \"ssesesseseesesesseeesseeesseeess 20\\nCONSUMING 2 COM ODJeC uu. eecessssessesessesessesessesessesesses\", \"ssesussesussesucsesscsesussesussesussesussesussesussesussessesesussesessesessesesseeesseeesseeess 21\", \"\\nMore things to CONSICES.........ccessesessessssessssessssessssesessesessesssesussesessessssesucsesu\", \"ssessssesussesussesessesussessssesussesecsesessesessesesseseeseseeseess 21\\nAPPDOMMAINS .....ecescese\", \"ssesessesessessssecssessssesussesussesussesussessssesussessesesussesussesussessssesucsesussecussesus\", \"seasssesussesussesussesussesessesesseaesseaeeseeess 21\\nREMOTING ....eecesscsessessssesessesessesesse\", \"sessesussesussesussesussesussesussesucsesussesussesusussussssussesussescsesssesessssessssessesecusse\", \"csesecssseeseaeesesecesseeeeseenees 21\\nCode Access S@CUrity (CAS) w.eeccessssssssssssessssessssessss\", \"essssssessssessesesssssssesessssessesessssessssessesessesessesessesesseseeseseeseseeseseeneseeseens \", \"22\\nSECUPItY TTANSPALENCY .....eeesessessesessesessessssessssesessesssessssessssesussessssessssesusse\", \"ssssessssessssessesesussesussesusseaussesesseausseeesseensseaneseenees 22\\nWINCOWS 10 Migration .....\", \"..........cccccccccccscccccscccssscscsssccsssssscsssssssssssssssssssssssssssssssssssssssssssescesecs\", \" 23\\nWIMRT APIS ....ceesessessessessessscscssecsccscssccucsussussucsucsucsussucsucsucsucsucsucsucsecs\", \"ecsessessessecusesscuscuscuceucsuccussussussussucsucsessessesseeseeaeeaeeaseateneeaeenee 23\\nUniversa\", \"l Windows Platform (UWP) package .......ccececssssssessessssessesscsessessessssessscsesessessecesses\", \"seesesesseeseeeseeseeneeeeses 24\\nHow to add WInRT APIs to your GESKtOP PLOje Ct... eecessesessesesse\", \"ssssessssessssessssesessesessesessesessesessesessesessesessesseseseeseens 26\\nXAML ISlANS on eeceeces\", \"sesseseesessesscseesecsecsesecsecnccscsecsecucsecsessecucsssesucsecsessesucsessesucsucsesuessesecses\", \"ucsucsecsesucaessesueseeseenesusaesseesseeaeeneeteaees 34\\nThe road to XAML Island... eeessessesssses\", \"seseesessecscscsessesucsecsecucsussessessesecsecucsessecnesussessesuesessessesecsesseeueaeeaeeneeeea\", \"eeneenenees 35\\nHOW It WOFKS ..o..eeesesesseesessessesessecsessesscsesscsscsecsecucsscsesuesscsssecuc\", \"sucsessesscssssecussecsessesucsscsecucsussessesussesaecussussessesueaessesueneeaeeneaneaees 35\\nDO YO\", \"U NEEM XAML Island ou... cesecsessessssesssscsessesessesessesessesessesessesessesessesessesessesesse\", \"sesssseseesecsesecsesecessessesecesseeesseeneseenees 38\\nThe road ahead XAML Islands: WiINUI 3.0 oe e\", \"seesessessesseseesessesesecsecscseesecsesuesessesueseeseenecsseeseeeaeeseeneeeeaeeneeenes 38\\nExample\", \" of migrating to the latest .NET...................scscccssscssssssssssssssssssssssssssssssssssssssc\", \"csssscees 41\\nMigrating from .NET Core or .NET 5 wicccecssscsesssssecscsessesscsessessesscsesseescsus\", \"ssssecussussecsssussessecussussessssussessecucsesseesesesseeseeneaeess 41\\nMigrating from .NET Fra me\", \"@woklk w....ccccsesssssessssessecscssssesscsessessecsssessessesussessecucsussessssussessecussussesue\", \"sussessecucsesseenesesseeseanessess 42\\nMigrating WITK a COOL... escsessesessessssesessesessesesseses\", \"sesessssessesessesessssessssessesessssessssessssessssesessecessessssesessesnssecnsseeesseeneseenees \", \"42\\nMigrating Dy Nand ou... ccescesessessssesessessssessssesessesessesessesessesessesessssessssessese\", \"ssesessssessssessssessssesessecessecsesesessesessecnsseeesseeneseenees 42\\nPr@ParatiONn ......ececess\", \"essssessssessssessssesessesessesessesssesssesessesessesussesessesessssessssessssessesssnssssesesssse\", \"ssesecussecessecussecessecessecessecesseeneseenees 43\\nFIX the COD!) AN\\u201d DUI. eeessessesessessessesee\", \"sessesscsessecucsecsesscsucsessecuesecsessesucsecsecucsucsesnesucsessesucsessesseseneeseeeneeaeeneen\", \"eaees 45\\nRUN ANC tOSt ou. eeecesesseesessessesessessesscsecsesscsscsessecucscsesuesscsessecucsucsesn\", \"esucsecsecuesecsessesucsecsecuesscsessesucsessecucsssecnesueaeeaeeueaeeaeeneenenees 46\\n\\nii Contents\\n\", \"Migrating a WINGOWS FOrMs Application ue ecesessssesessessessesecseseseesecsesecsecsesuesessecuesees\", \"eeneseesecsesucseeseeneseeaeeneeneaens 46\\n\\nMigrating a WPF application... cccecsssessssesssssssssess\", \"ssessssessssessssssessessssesessessssssessesessesessesessesessesessesessesessesessesesseseeseseesees\", \"s 52\\nDeploying Modern Desktop Applications ......................sssssssssssssssssscsccsscccseccccec\", \"ccccecccsssessees 55\\nThe Modern application lifECyCle cc eccccsessessesssessessesesssssecsssessssses\", \"essesssesssessessssussessesussussessesessesssensssseeseensseeseeneeeses 56\\nMSIX: The next generation\", \" Of CEplOyMeNte......ccccececssssssssesesssseesesessssseesssesssesssessesseesssesseesesessesseeeeses\", \"seenssesseeseenssess 58\\nBenefits OF MSIX ...ceecessessssssssssssssessessecsessessessessessessessecse\", \"csessecsessesscesscuscucsussussucsucsussucsussussussucsussessesseeaeeaeeaeeaeeaeeaeeaeeneeneenees 59\", \"\\nTOOIS ..eeeecsessessessesessessesscsessesscsscsessesucscsecucsucsecsecussessecucsucsesuesucsessesuc\", \"secsesuesucsessesuesecsessesucsessecucsessesucsucsessesucsessecueseeseeneeeeaeeneeenees 61\\nHow to cr\", \"eate an MSIX package from an existing Win32 GesktOp Application... eccccesesesesesseeseeeeseens 62\\nA\", \"UTO Updates IN MSIX. uc ccesssssssssssssessssessesessecssecssssssesussessssesussesussesussesussesuss\", \"ecessecussesussesessecessesessecessecessesesseeseseeesseenees 70\\n\\neee\\n\\nContents\\nCHAPTER |\\n\\nWhy moder\", \"n desktop\\napplications\\n\\nIntroduction\\n\\nA story of one company\\n\\nBack in the early 2000s, one multinati\", \"onal company started developing a distributed desktop solution\\nto exchange information between diffe\", \"rent branches of the company and execute optimized\\noperations on centralized units. They have chosen\", \" a brand-new framework called Windows Forms\\n(also known as WinForms) for their application developme\", \"nt. Over the years, the project evolved into\\na mature, well-tested, and time-proven application with\", \" hundreds of thousands of lines of code. Time\\npassed and .NET Framework 2.0 is no longer the hot new\", \" technology. The developers who are\\nworking on this application are facing a dilemma. They'd like to\", \" use the latest stack of technologies in\\ntheir development and have their application look and \\u201cfeel\", \"\\u201d modern. At the same time, they don't\\nwant to throw away the great product they have built over 15 \", \"years and rewrite the entire application\\nfrom scratch.\\n\\nYour story\\n\\nYou might find yourself in the s\", \"ame boat, where you have mature Windows Forms or Windows\\nPresentation Foundation (WPF) applications \", \"that have proved their reliability over the years. You\\nprobably want to keep using these application\", \"s for many more years. At the same time, since those\\napplications were written some time ago, they m\", \"ight be missing capabilities like modern look,\\nperformance, integration with new devices and platfor\", \"m features, and so on, which gives them a feel\\nof \\u201cold tech\\u201d. There\\u2019s another problem that might con\", \"cern you as a developer. While working on the\\nolder .NET Framework versions and maintaining applicat\", \"ions that were written a while ago, you might\\nfeel like you aren't learning new technologies and mis\", \"sing out on building modern technical skills. If\\nthat is your story \\u2014 this book is for you!\\n\\nDesktop\", \" applications nowadays\\n\\nBefore the rise of the Internet, desktop applications were the main approach\", \" to building software\\nsystems. Developers could choose any programming language, such as COBOL, Fort\", \"ran, VB6, or C++.\\n\\n1 CHAPTER 1 | Why modern desktop applications\\nBut whether they developed small to\", \"ols or complex distributed architectures, they were all desktop\\napplications.\\n\\nThen, Internet techno\", \"logies started shocking the development world and winning over more\\nengineers with advantages like e\", \"asy deployment and simplified distribution processes. The fact that\\nonce a web application was deplo\", \"yed to production all users got automatic updates made a huge\\nimpact on software agility.\\n\\nHowever, \", \"the Internet infrastructure, underlying protocols, and standards like HTTP and HTML weren't\\ndesigned\", \" for building complex applications. In fact, the major development effort back then was\\naimed at jus\", \"t one goal: to give web applications the same capabilities that desktop applications have,\\nsuch as f\", \"ast data input and state management.\\n\\nEven though web and mobile applications have grown at an incre\", \"dible pace, for certain tasks desktop\\napplications still hold the number one place in terms of effic\", \"iency and performance. That explains why\\nthere are millions of developers who are building their pro\", \"jects with WPF and WinForms and the\\namount of those applications is constantly growing.\\n\\nHere are so\", \"me reasons for choosing desktop applications in your development:\\n\\n. Desktop apps have better intera\", \"ction with the user's PC.\\n\\n. The performance of desktop applications for complex calculations is muc\", \"h higher than the\\nperformance of web applications.\\n\\n. Running custom logic on the client-side is pos\", \"sible but much harder with a web application.\\n. Using multithreading is easier and more efficient in\", \" a desktop application.\\n\\n. The learning curve for designing user interfaces (Uls) isn\\u2019t steep. And f\", \"or WinForms, it\\u2019s\\nintuitive with the drag-and-drop experience of the Windows Forms designer.\\n\\n. It's\", \" easy to start coding and testing your algorithms without the need to set up a server\\ninfrastructure\", \" or to care about connectivity problems, firewalls, and browser compatibility.\\n\\n. Debugging is power\", \"ful as compared to web debugging.\\n\\n. Access to hardware devices, such as camera, Bluetooth, or card \", \"readers, is easy.\\n\\n. Since the technology has been around for a while, there are many experts and a \", \"knowledge\\nbase available to develop desktop applications.\\n\\nSo, as you can see, developing for deskto\", \"p is great for many reasons. The technology is mature and\\ntime-tested, the development cycle is fast\", \", the debugging is powerful and arguably, desktop apps\\nhave less complexity and are easier to get st\", \"arted with.\\n\\nMicrosoft offered many UI desktop technologies throughout the years from Win32 introduc\", \"ed in 1995\\nto Universal Windows Platform (UWP) released in 2016.\\n\\n2 CHAPTER 1 | Why modern desktop a\", \"pplications\\n1995 2002 2006 2016 2019\\n\\nAccording to a survey published by Telerik on April 2016, the \", \"most popular technologies for building\\nWindows desktop apps are Windows Forms, WPF, and UWP.\\n\\nTeleri\", \"k Survey\\nWhat Technology would you choose if building for Windows Desktop?\\n\\nWiakerre\\niUnAP\\nElectron\\n\", \"\\nCorre\\n\\nOe Peer\\n\\nYou can develop in any of them using C# and Visual Basic, but let's take a closer l\", \"ook.\\n\\nWindows Forms\\n\\nFirst released in 2002, Windows Forms is a managed framework and is the oldest,\", \" most-used desktop\\ntechnology built on the Windows graphics device interface (GDI) engine. It offers\", \" a smooth drag-and-\\ndrop experience for developing user interfaces in Visual Studio. At the same tim\", \"e, Windows Forms\\nrelies on the Visual Studio Designer as the main way you develop your UI, so creati\", \"ng visual\\ncomponents from code isn't trivial.\\n\\nThe following list summarizes the main characteristic\", \"s of Windows Forms:\\n\\n. Mature technology with lots of code samples and documentation.\\n\\n. Powerful an\", \"d productive designer. Not so convenient to design UI \\u201cfrom code\\u201d.\\n. Easy and intuitive to learn, th\", \"anks to the designer's drag-and-drop experience.\\n. Supported on any Windows version.\\n\\n. Supported on\", \" .NET Core 3.0 and later versions.\\n\\n3 CHAPTER 1 | Why modern desktop applications\\nWPF\\n\\nBased on the \", \"XAML language specification, WPF favors a clear separation between UI and code. XAML\\noffers capabili\", \"ties like templating, styling, and binding, which is suited for building large applications.\\nLike Wi\", \"ndows Forms, it\\u2019s a managed framework, but the design is modular and reusable.\\n\\nHere are the main fe\", \"atures of WPF:\\n\\n. Mature technology.\\n\\n. Designer is available, but developers usually prefer to crea\", \"te the design from code using\\ndeclarative XAML.\\n\\n. The learning curve is steeper than Windows Forms.\", \"\\n. Supported on any Windows version.\\n\\n. Supported on .NET Core 3.0 and later versions.\\n\\nUWP\\n\\nUWP isn\", \"'t only a presentation framework like WPF and Windows Forms, but it's also a platform itself.\\nThis p\", \"latform has:\\n\\n\\u00b0 Its own API set (the Windows Runtime API).\\n. A new deployment system (MSIX)\\n. A mode\", \"rn application lifecycle model (for low battery consumption).\\n. A new Resource Management System (ba\", \"sed on PRI files).\\nThe platform was created to support all kinds of input systems (like ink, touch, \", \"gamepad, mouse,\\n\\nkeyboard, gaze, and so on) in all form-factors with performance and low battery con\", \"sumption in mind.\\nFor these reasons, the shell of the Windows 10 OS uses parts of the UWP platform.\\n\", \"\\n4 CHAPTER 1 | Why modern desktop applications\\nUWP\\n\\nMSIX Pidiienah\\n\\nLomponents\\n\\nPackage ID\\n\\nCertific\", \"ate\\n\\nPRI WinRT APIs\\n\\n| j VIP\\nXAML\\nnmput\\n\\nUWP app\\nmodel\\n\\nRun-Resume-Suso\\n\\nAppContainer\\n\\nStore\\n\\nUWP co\", \"ntains a presentation framework that is XAML-based, like WPF, but it has some important\\ndifferences \", \"such as:\\n\\nApplications are executed in app containers. App containers control what resources a UWP\\n\\n\", \"app can access.\\n\\nSupported only on Windows 10 and Windows 11.\\n\\nApps can be deployed through Microsof\", \"t Store for easier deployment.\\n\\nDesigned as part of the Windows Runtime API.\\n\\nContains an extensive \", \"set of rich built-in controls and additional controls are available\\nthrough the Microsoft UI Library\", \" NuGet packages (WinUI library), updated every few months.\\n\\nA tale of two platforms\\n\\nIn the last 20 \", \"years, while Ul desktop technologies were growing and following the path from\\n\\nWindows Forms to UWP,\", \" the hardware was also evolving from heavyweight PC units with small CRT\\nmonitors to high-DPI monito\", \"rs and lightweight tablets and phones with different data input\\ntechniques like Touch and Ink. These\", \" changes resulted in creating two different concepts: a Desktop\\nApplication and a Modern Application\", \". A Modern Application is one that considers different device\\nform factors, various input and output\", \" methods, and leverages modern desktop features while\\nrunning on a sandboxed execution model. The (t\", \"raditional) Desktop Application, on the other hand, is\\n\\nCHAPTER 1 | Why modern desktop applications\\n\", \"an application that needs a solid UI with a high density of controls that is best operated with a mo\", \"use\\n\\nand a keyboard.\\n\\nThe following table describes the differences between the two concepts:\\n\\nAspec\", \"t of comparison Modern Application Desktop Application\\n\\nDeployment\\n\\nDistribution\\n\\nContained executio\", \"n & Great\\nFundamentals. Designed from\\nthe ground up to respect user's\\nprivacy, manage battery life,\\n\", \"and focus to keep the device\\nsafe.\\n\\nInstallation and updates are\\nmanaged by the platform.\\n\\nTrusted D\", \"istribution & Signed\\nPackages. Distribution is\\nperformed from a trusted\\nsource and never from the\\nwe\", \"b.\\n\\nModern UI. Different input\\nmechanisms, ink, touch,\\ngamepad, keyboard, mouse,\\netc.\\n\\nCloud First D\", \"ata with Insights.\\nSource of truth in the cloud.\\nInsights to know what happens\\nwith your app and how\", \" it\\u2019s\\nperforming.\\n\\nDesigned for reuse. Reuse in\\nmind between different\\nplatforms, front end, and bac\", \"k\\nend, running assets in many\\nplaces as possible.\\n\\nUser & Admin level of security.\\nYou have native a\", \"ccess to the\\nregistry and hard drive folders.\\n\\nMSI, Custom installers &\\nUpdates. Traditionally a sou\", \"rce\\nof headaches for developers\\nand IT managers.\\n\\nWeb, SCCM & Custom\\ndistribution. No control over\\nw\", \"hat is installed, affects the\\nwhole machine.\\n\\nWindows Forms, WPF, MFC.\\nDesigned for the mouse and\\nke\", \"yboard for a dense UI and to\\nget the most productivity from\\nthe desktop.\\n\\nLocal Data. Traditional de\", \"sktop\\napplications usually need some\\nlocal data.\\n\\nDesigned for Windows\\nDesktop only\\n\\nAs a part of th\", \"e commitment to provide developers with the best tools to build applications, Microsoft\\nput forth a \", \"great effort to bring these concepts - or we can even say platforms - closer together to\\nempower dev\", \"elopers with the best of both worlds. To do that, Microsoft has performed a bidirectional\\n\\neffort be\", \"tween the two platforms.\\n\\nCHAPTER 1 | Why modern desktop applications\\nBring both platforms closer to\", \"gether\\nModem Desktop\\n\\n1. | Move Desktop Application scenarios into Modern Application platform. The \", \"traditional\\ndesktop development is still popular because it addresses certain scenarios well. It mak\", \"es\\nsense to take these common desktop scenarios and bring them into the modern desktop\\n\\nplatform to \", \"make the platform fully capable.\\n\\nMoctenn Desktop\\n\\nModern Application Desktop Application\\nPlatform S\", \"cenarios\\n\\n1. | Move Modern Application features into Desktop Applications. For existing desktop apps\", \" that\\nneed a way to leverage modern capabilities without rewriting from scratch, features from the\\nM\", \"odern Application platform are pushed into the Desktop Application.\\n\\nModern Desktop\\n\\nModern Applicat\", \"ion Desktop Applications\\n\\nPlatform Features\\n\\nCHAPTER 1 | Why modern desktop applications\\nIn this boo\", \"k, we'll focus on the second part and show how you can modernize your existing desktop\\napplications.\", \"\\n\\nPaths to modernization\\n\\nThe structure of this guide reflects three different axes to accomplish mo\", \"dernization: Modern\\nFeatures, Deployment, and Installation.\\n\\nModern features\\n\\nSay you have a working\", \" Windows Forms application that a sales representative of your company uses\\nto fill in a customer or\", \"der. A new requirement comes in to enable the customer to sign the order\\nusing a tablet pen. Inking \", \"is native in today's operating systems and technologies, but it wasn't\\navailable when the app was de\", \"veloped.\\n\\nThis path will show you how you can leverage modern desktop features into your existing de\", \"sktop\\ndevelopment.\\n\\nDeployment\\n\\nModern development cycles have stressed the importance of providing \", \"agility with regard to how new\\nversions of applications are deployed to individual users. Since Wind\", \"ows Forms and WPF applications\\nare based on a particular version of the .NET Framework that must be \", \"present on the machine, they\\ncan't take advantage of new .NET Framework version features without the\", \" intervention of the IT\\npeople with the risk of having side effects for other apps running on the sa\", \"me machine. It has limited\\nthe innovation pace for developers forcing them to stay on outdated versi\", \"ons of the .NET Framework.\\n\\nSince the launch of .NET Core 3.0, you can leverage a new approach of de\", \"ploying multiple versions of\\n.NET side by side and specifying which version of .NET each application\", \" should target. This way, you\\ncan use the newest features in one application while being confident y\", \"ou aren't going to break any\\nother applications.\\n\\nInstallation\\n\\nDesktop applications always rely on \", \"some sort of installation process before the user can start using\\nthem. This fact brought into the g\", \"ame a set of technologies, from MSI and ClickOnce to custom\\ninstallers or even XCOPY deployment. Any\", \" of these methods deals with delicate problems because\\napplications need a way to access shared reso\", \"urces on the machine. Sometimes installation needs to\\naccess the Registry to insert or update new Ke\", \"y Values, sometimes to update shared DLLs referenced\\nby the main application. This behavior causes a\", \" continuous headache for users, creating this\\nperception that once you install some application, you\", \"r computer will never be the same, even if you\\nuninstall it afterwards.\\n\\nIn this book, we'll introdu\", \"ce a new way of installing applications with MSIX that solves the problem\\ndescribed earlier. You'll \", \"learn how you can easily set up packaging, installation, and updates for your\\napplication.\\n\\n8 CHAPTE\", \"R 1 | Why modern desktop applications\\nCHAPTER 2\\n\\nWhat's new with .NET for\\nDesktop?\\n\\nDesktop applicat\", \"ions such as Windows Forms and WPF can be built using various .NET\\nimplementations, for example, .NE\", \"T Framework or .NET 7. In this chapter, we'll talk about the history\\nof each implementation, explain\", \" the differences, and show what new features await desktop\\ndevelopers in newer implementations.\\n\\nIf \", \"you've been developing Windows Forms or WPF applications for a long time, you're familiar with\\n.NET \", \"Framework. Later, .NET Core (specifically its 3.0 version) started supporting desktop applications.\\n\", \".NET Core was rebranded to .NET when .NET 5 was released. Just as there are different versions of\\n.N\", \"ET Framework, for example, 4.6, 4.7, and 4.8, there are also different versions of .NET Core: .NET\\nC\", \"ore 3.0, .NET 5, .NET 6, .NET 7, and so on.\\n\\nLet's look into the history of each implementation to u\", \"nderstand the differences and benefits of each.\\n\\nThe motivation behind .NET Core\\n\\nSince its launch i\", \"n 2002, .NET Framework has evolved to support many technologies, like Windows\\nForms, ASP.NET, Entity\", \" Framework, Windows Store, and many others. All of them are different in\\nnature. Therefore, Microsof\", \"t approached this evolution by taking parts of .NET Framework and\\ncreating a different application s\", \"tack for each technology. That way, development capabilities could\\nbe customized for the needs of th\", \"e specific stack, which maximized the potential of every platform.\\nThat led to fragmentation on the \", \"versions of .NET Framework maintained by different independent\\nteams. All of these stacks have a com\", \"mon structure, containing an app model, a framework, and a\\nruntime, but they differ in the implement\", \"ation of each of the parts.\\n\\nIf you're targeting only one of these platforms, you can use this model\", \". However, in many cases you\\nmight need more than one target platform in the same solution. For exam\", \"ple, your application may\\nhave a desktop admin part, a customer-facing web site that shares the back\", \"-end logic running on a\\nserver, and even a mobile client. In this case, you need a unified coding ex\", \"perience that can span all of\\nthese .NET verticals.\\n\\nBy the time Windows 8 was released, the concept\", \" of Portable Class Libraries (PCLs) was born.\\nOriginally, .NET Framework was designed around the ass\", \"umption that it would always be deployed as\\na single unit, so factoring wasn't a concern. To face th\", \"e problem of code sharing between verticals, the\\ndriving force was on how to refactor the framework.\", \" The idea of contracts is to provide a well-factored\\n\\n9 CHAPTER 2 | What's new with .NET for Desktop\", \"?\\nAPI surface area. Contracts are simply assemblies that you compile against and are designed with\\np\", \"roper factoring in mind taking care of the dependencies between them.\\n\\nThis led to reasoning about t\", \"he API differences between verticals at the assembly level, as opposed to\\nat the individual API leve\", \"l like previously. This aspect enabled a class library experience that can target\\nmultiple verticals\", \", also known as portable class libraries.\\n\\nRelease history of .Net Framework\\n\\nNET Core 20 NET Core 3\", \"6\\n\\nWET Core tf NET Core? 1422\\n\\nWith PCL, the experience of development is unified across verticals b\", \"ased on the API shape. And the\\nmost pressing need to create libraries running on different verticals\", \" is also addressed. But there's a\\ngreat challenge: APIs are only portable when the implementation is\", \" moved forward across all the\\nverticals.\\n\\nA better approach is to unify the implementations across v\", \"erticals by providing a well-factored\\nimplementation instead of a well-factored view. It\\u2019s a lot sim\", \"pler to ask each team that owns a specific\\ncomponent to think about how their APIs work across all v\", \"erticals than trying to retroactively provide\\na consistent API stack on top. This is where .NET Stan\", \"dard comes in.\\n\\nAnother large challenge has to do with how .NET Framework is deployed. .NET Framewor\", \"k is a\\nmachine-wide framework. Any changes made to it affect all applications that take a dependency\", \" on it.\\nAlthough this deployment model has many advantages, such as reducing disk space and centrali\", \"zed\\naccess to services, it presents some pitfalls.\\n\\nTo start with, it\\u2019s difficult for application de\", \"velopers to take a dependency on a recently released\\nframework. They either have to take a dependenc\", \"y on the latest OS or provide an application installer\\nthat installs .NET Framework along with the a\", \"pplication. If you're a web developer, you might not even\\nhave this option as the IT department esta\", \"blishes the server supported version.\\n\\nEven if you're willing to go through the trouble of providing\", \" an installer to chain in .NET Framework\\nsetup, you may find that upgrading .NET Framework can break\", \" other applications.\\n\\nDespite the efforts to provide backward compatible versions of the framework, \", \"there are compatible\\nchanges that can break applications. For example, adding an interface to an exi\", \"sting type can change\\nhow this type is serialized and cause breaking problems depending on the exist\", \"ing code. Because the\\n.NET Framework installed base is huge, fighting against these breaking scenari\", \"os slows down the pace\\nof innovations inside .NET Framework.\\n\\nTo solve all these issues, Microsoft d\", \"eveloped .NET Core as the evolution of the .NET development\\nplatform.\\n\\n10 CHAPTER 2 | What's new wit\", \"h .NET for Desktop?\\nIntroduction to .NET Core\\n\\n.NET Core, which is now referred to as just \\u201c.NET\\\", i\", \"s the evolution of Microsoft's .NET technology into\\na modular, cross-platform, open source, and clou\", \"d-ready platform. It runs on Windows, macOS, and\\nLinux, and some ARM-based architectures like Androi\", \"d and IoT.\\n\\nThe purpose of .NET Core is to provide a unified platform for all types of applications,\", \" which includes\\nWindows, cross-platform, and mobile applications. .NET Standard enabled this by prov\", \"iding shared\\nbase APls, which every application model needs, and excluding any application model-spe\", \"cific API.\\n\\nThis framework gives applications many benefits in terms of efficiency and performance, \", \"simplifying\\nthe packaging and deployment in the different supported platforms.\\n\\nThe benefits of .NET\", \" Core come from these three characteristics:\\n\\n. Cross-platform: It allows application execution on d\", \"ifferent platforms (Windows, macOS, and\\nLinux).\\n\\n. Open source: .NET Core platform is open source an\", \"d available through GitHub, fostering\\ntransparency and community contributions.\\n\\n. Supported: Micros\", \"oft officially supports .NET Core.\\n\\nStarting with .NET Core 3.0, besides the existing support for we\", \"b and cloud, there\\u2019s also support for\\ndesktop, loT, and Al domains. The goal for this framework is i\", \"mpressive: to target every type of .NET\\ndevelopment present and future.\\n\\nNET 5+ 1s .NET Core vNext\\n\\n\", \".NET 5 was the next step forward with .NET Core. .NET 5 improved .NET in a few key ways:\\n\\n. Produced\", \" a single .NET runtime and framework that can be used everywhere and that has\\nuniform runtime behavi\", \"ors and developer experiences.\\n\\n. Expanded the capabilities of .NET by taking the best of .NET Core,\", \" .NET Framework, Xamarin,\\nand Mono.\\n\\n. Built that product out of a single code-base that developers \", \"(Microsoft and the community)\\ncan work on and expand together and that improves all scenarios.\\n\\n.NET\", \" 5 was a game-changer for .NET. With .NET 5 and later versions, your code and project files look\\nand\", \" feel the same no matter which type of app you\\u2019re building. You have access to the same runtime,\\nAPI\", \"s, and language capabilities with each app. This includes new performance improvements that get\\ncomm\", \"itted to the runtime almost daily. .NET 6 and .NET 7 made further improvements in reliability,\\nperfo\", \"rmance, new APIs, and language features. For more details, see What's new in .NET 5, What's\\nnew in .\", \"NET 6, and What's new in .NET 7.\\n\\n11 CHAPTER 2 | What's new with .NET for Desktop?\\nNET \\u2014 A unified p\", \"latform\\n\\nDESKTOP WE CLOUD REORILE GA ADAG o F C <\\nrt ASE MET Azuite Marre ' ARPA? PL hit VISUAL STUG\", \"GS\\nWIS STUGRD BGR Mae\\n\\n(NET 5 0)\\n\\nVWRUAL STUDIO CODE\\n\\nIAS TRU DLE (im\\n\\nNET Framework vs. .NET\\n\\nSo no\", \"w that you understand the relevance of .NET, you might be wondering what happens with .NET\\nFramework\", \". You could be asking questions like: Do | have to abandon it? Is it going to disappear?\\nWhat are my\", \" choices to modernize the applications | have on .NET Framework?\\n\\nIn 2019, .NET Framework 4.8 was re\", \"leased. It included three major improvements for desktop\\napplications:\\n\\n. Modern browser and media c\", \"ontrols: New controls were added that take advantage of\\nMicrosoft Edge and newer media players that \", \"support the latest standards.\\n\\n. Access to UWP controls: UWP introduced controls that take advantage\", \" of the latest\\nWindows features and touch displays. With .NET Framework 4.8, you don\\u2019t have to rewri\", \"te\\nyour applications to use these new features and controls, so you can use these new features\\nin yo\", \"ur existing WPF or Windows Forms code.\\n\\n. High-DPI improvements: The resolution of displays increase\", \"d to 4K and 8K, so, .NET\\nFramework 4.8 added new HDPI improvements to make sure existing Windows For\", \"ms and\\nWPF applications can look great on these new displays.\\n\\nSince .NET Framework is installed on \", \"millions of machines, Microsoft will continue to support it but\\nwon't add new features.\\n\\n.NET (Core)\", \" is the open-source, cross-platform, and fast-moving version of the .NET family. Because of\\nits side\", \"-by-side nature, it can take changes without the fear of breaking any application. This means\\nthat .\", \"NET will get new APIs and language features over time that .NET Framework won't. Also, .NET\\nalready \", \"has features that were impossible for .NET Framework, such as:\\n\\n. Side-by-side versions of .NET supp\", \"orting Windows Forms and WPF: This solves the\\nproblem of side effects when updating the machine's fr\", \"amework version. Multiple versions of\\n.NET can be installed on the same machine and each application\", \" specifies which version of\\n\\n12 CHAPTER 2 | What's new with .NET for Desktop?\\n.NET it should use. Ev\", \"en more, now you can develop and run Windows Forms and WPF on top\\nof .NET.\\n\\n. Embed .NET directly in\", \"to an application: You can deploy .NET as part of your application\\npackage. This enables you to take\", \" advantage of the latest version, features, and APIs without\\nhaving to wait for a specific version t\", \"o be installed on the machine.\\n\\n. Take advantage of .NET features: .NET is fast-moving and open-sour\", \"ce. Its side-by-side\\nnature enables fast introduction of new innovative APIs and Base Class Library \", \"(BCL)\\nimprovements without the risk of breaking compatibility. Now Windows Forms and WPF\\napplication\", \"s can take advantage of the latest .NET features, which also includes fundamental\\nfixes for things l\", \"ike runtime performance and high-DPI support.\\n\\n.NET Framework will be fully supported and will alway\", \"s be a part of Windows. However, if you want to\\nuse the newest language features and APIs in the fut\", \"ure, you'll need to move your applications to\\n.NET. For brand-new desktop apps, we recommend startin\", \"g directly on .NET 6 or a later version. It's\\nlightweight and cross-platform, runs side by side, has\", \" high performance, and fits perfectly on\\ncontainers and microservices architectures.\\n\\nUpdate .NET Fr\", \"amework Apps Modernize Desktop Apps with .NET Core 3\\nNET Framework 4.8 Desktop Packs NET Core 3\\n28 \\u2018\", \"= = @ 4\\n\\nNET STANDARD NET STANDARD\\n\\nNET Standard vs. PCL\\n\\n.NET Standard is a formal specification of\", \" .NET APls that are intended to be available on all .NET\\nimplementations. The motivation behind .NET\", \" Standard was to establish greater uniformity in the .NET\\necosystem. .NET Standard is a specificatio\", \"n of .NET APIs that make up a uniform set of contracts to\\ncompile your code against. These contracts\", \" are implemented in each .NET flavor, thus enabling\\nportability across different .NET implementation\", \"s.\\n\\n.NET Standard enables the following key scenarios:\\n\\n. Defines uniform set of base class librarie\", \"s APIs for all .NET implementations to implement,\\nindependent of the workload.\\n\\n. Enables developers\", \" to produce portable libraries that are usable across .NET implementations,\\nusing this same set of A\", \"PIs.\\n\\n13 CHAPTER 2 | What's new with .NET for Desktop?\\n.NET Standard is the evolution of PCLs and th\", \"e following list shows the fundamental differences\\nbetween .NET Standard and PCLs:\\n\\n. .NET Standard \", \"is a set of curated APIs, picked by Microsoft. PCLs aren't.\\n\\nThe APIs that a PCL contains are depend\", \"ent on the platforms that you choose to target when\\nyou create it. This makes a PCL only sharable fo\", \"r the specific targets that you choose.\\n\\n. .NET Standard is platform-agnostic, so it can run on Wind\", \"ows, macOS, and Linux.\\n\\n. PCLs can also run cross-platform, but they can only target a limited set o\", \"f platforms.\\n\\nNew Desktop features in .NET\\n\\nSupport for Windows Forms and WPF\\n\\nWindows Forms and WPF\", \" are part of .NET Core since version 3.0. Both presentation frameworks are\\nfor Windows only, so they\", \" aren't cross-platform. You can think of WPF as a rich layer over DirectX and\\nWindows Forms as a thi\", \"nner layer over GDI+. WPF and Windows Forms do a great job of exposing\\nand exercising much of the de\", \"sktop application functionality in Windows. So Windows Forms and\\nWPF are available for .NET Core and\", \" .NET Framework. Target your new desktop applications to .NET 6\\nor later, and migrate your existing \", \"apps from .NET Framework to .NET 6 or later.\\n\\nA new version of .NET Standard, version 2.1, was relea\", \"sed at the same time as .NET Core 3.0. To see\\nwhich .NET implementations support which .NET Standard\", \" versions, see Which .NET Standard version\\n\\nto target.\\n\\nThe .NET (Core) implementations for both Win\", \"dows Forms and WPF are open source.\\n\\nXAML Islands\\n\\nXAML Islands is a set of components for developer\", \"s to use Windows 10 controls (UWP XAML controls)\\nin their WPF, Windows Forms, and native Win32 apps \", \"(like MFC). You can have your \\u201cislands\\u201d of UWP\\nXAML controls wherever you want inside your Win32 app\", \"s.\\n\\nThese XAML Islands are possible because Windows 10, version 1903 introduced a set of APIs that\\na\", \"llows hosting UWP XAML content in Win32 windows using windows handlers (HWnds). Only apps\\nrunning on\", \" Windows 10 1903 and later can use XAML Islands.\\n\\nTo make it easier to create XAML Islands for Windo\", \"ws Forms and WPF developers, the Windows\\nCommunity Toolkit introduces a set of .NET wrappers in seve\", \"ral NuGet packages. Those wrappers are\\nthe wrapped and hosting controls:\\n\\n. The WebView, WebViewComp\", \"atible, InkCanvas, MediaPlayerElement, and MapControl\\nwrapped controls wrap some UWP XAML controls i\", \"nto Windows Forms or WPF controls,\\n\\nhiding UWP concepts for those developers.\\n\\n. The WindowsXamlHost\", \" control for Windows Forms and WPF allows other not-wrapped UWP\\nXAML controls and custom controls to\", \" be loaded into a XAML Island.\\n\\n14 CHAPTER 2 | What's new with .NET for Desktop?\\nAccess to all Windo\", \"ws 10 and Windows 11 APIs\\n\\nWindows 10 and Windows 11 have a large number of APIs available for devel\", \"opers to work with.\\nThese APIs give access to a wide variety of functionality like authentication, b\", \"luetooth, appointments,\\nand contacts. Now these APIs are exposed through .NET and give Windows devel\", \"opers the chance to\\ncreate powerful desktops apps using the capabilities present on Windows 10 and W\", \"indows 11.\\n\\nSide-by-side support and self-contained EXEs\\n\\nThe .NET deployment model is one of the bi\", \"ggest benefits that Windows desktop developers will\\nexperience with .NET. The ability to globally in\", \"stall NET provides much of the same central installation\\nand servicing benefits of INET Framework, w\", \"hile not requiring in-place updates.\\n\\nWhen a new .NET version is released, you can update each app o\", \"n a machine as needed without any\\nconcern of affecting other applications. New .NET versions are ins\", \"talled in their own directories and\\nexist \\u201cside-by-side\\u201d with each other.\\n\\nIf you need to deploy wit\", \"h isolation, you can deploy .NET with your application. .NET will bundle your\\napp with the .NET runt\", \"ime as a single executable. The modular architecture used by .NET makes these\\nflexible deployment op\", \"tions possible.\\n\\nPerformance\\n\\nSince its start, targeting the web and cloud workloads, .NET has had p\", \"erformance plugged into its\\nDNA. Server-side code must be performant enough to fulfill high-concurre\", \"ncy scenarios and .NET 7\\nscores today as the best performance web platform in the market.\\n\\nOld Windo\", \"ws Forms code has been refactored for .NET, which reduced memory allocations for\\ndrawing Forms and C\", \"ontrols. By simply upgrading from .NET Framework to .NET or later, your\\napplications become much fas\", \"ter. You can take advantage of these performance improvements when\\nyou use .NET to build your next g\", \"eneration of desktop applications.\\n\\n15 CHAPTER 2 | What's new with .NET for Desktop?\\nCHAPTER\\n\\nMigrat\", \"ing Modern\\nDesktop applications\\n\\nIn this chapter, we're exploring the most common issues and challen\", \"ges you can face when migrating\\nan existing application from .NET Framework to .NET.\\n\\nIf you just wa\", \"nt to update your application to the latest .NET version using a tool and not get into the\\ndetails o\", \"f what's happening behind the scenes, feel free to skip this chapter and find step-by-step\\n\\ninstruct\", \"ions in the Example of migrating to .NET chapter.\\n\\nA complex desktop application doesn\\u2019t work in iso\", \"lation and needs some kind of interaction with\\nsubsystems that may reside on the local machine or on\", \" a remote server. It will probably need some\\nkind of database to connect with as a persistence store\", \" either locally or remotely. With the rise of\\nInternet and service-oriented architectures, it's comm\", \"on to have your application connected to some\\nsort of service residing on a remote server or in the \", \"cloud. You may need to access the machine file\\nsystem to implement some functionality. Alternatively\", \", maybe you're using a piece of functionality\\nthat resides inside a COM object outside your applicat\", \"ion, which is a common scenario If, for example,\\nyou're integrating Office assemblies in your app.\\n\\n\", \"Besides, there are differences in the API surface that is exposed by .NET Framework and .NET, and\\nso\", \"me features that are available on .NET Framework aren't available on .NET. It's important for you to\", \"\\nknow and take them into account when planning a migration.\\n\\nConfiguration files\\n\\nConfiguration file\", \"s offer the possibility to store sets of properties that are read at run time and can\\naffect the beh\", \"avior of your app, such as where to locate a database or how many times to execute a\\nloop. The beaut\", \"y of this technique is that you can modify some aspects of the application without the\\nneed to recod\", \"e and recompile. This comes in handy when, for example, the same app code runs ona\\ndevelopment envir\", \"onment with a certain set of configuration values and in production environment\\nwith a different set\", \".\\n\\nConfiguration on .NET Framework\\n\\nIf you have a working .NET Framework desktop application, chance\", \"s are you have an app.config file\\naccessed through the AppSettingsSection class from the System.Conf\", \"iguration namespace.\\n\\n16 CHAPTER 3 | Migrating Modern Desktop applications\\nWithin the .NET Framework\", \" infrastructure, there\\u2019s a hierarchy of configuration files that inherit\\nproperties from its parents\", \". You can find a machine.config file that defines many properties and\\nconfiguration sections that ca\", \"n be used or overridden in any descendant configuration file.\\n\\nConfiguration on .NET\\n\\nIn the .NET wo\", \"rld, there\\u2019s no machine.config file. And even though you can continue to use the old\\nfashioned Syste\", \"m.Configuration namespace, you may consider switching to the modern\\nMicrosoft.Extensions.Configurati\", \"on, which offers a good number of enhancements.\\n\\nThis configuration API supports the concept of a co\", \"nfiguration provider, which defines the data source\\nto be used to load the configuration. There are \", \"different kinds of built-in providers, such as:\\n\\n. In-memory .NET objects\\n\\n: INI files\\n\\n. JSON files\", \"\\n\\n: XML files\\n\\n. Command-line arguments\\n: Environment variables\\n\\n. Encrypted user store\\n\\nOr you can \", \"build your own.\\n\\nThe new configuration API allows a list of name-value pairs that can be grouped int\", \"o a multi-level\\nhierarchy. Any stored value maps to a string, and there's built-in binding support t\", \"hat allows you to\\ndeserialize settings into a custom plain old CLR object (POCO).\\n\\nThe Configuration\", \"Builder object lets you add as many configuration providers as you may need for\\nyour application. A \", \"precedence rule is used to resolve provider preference. So, the last provider you\\nadd in your code o\", \"verrides the others. This is a great feature for managing different environments for\\nexecution since\", \" you can define different configurations for development, testing, and production\\nenvironments. And \", \"you can manage them in a single function inside your code.\\n\\nMigrating configuration files\\n\\nYou can c\", \"ontinue to use your existing app.config XML file. However, you could take this opportunity\\nto migrat\", \"e your configuration to benefit from the several enhancements made in .NET.\\n\\nTo migrate from an old-\", \"style app.config to a new configuration file, you should choose between an\\n\\nXML format and a JSON fo\", \"rmat.\\n\\nIf you choose XML, the conversion is straightforward. Since the content is the same, just sav\", \"e the\\napp.config file with XML as type. Then, change the code that references AppSettings to use the\", \"\\nConfigurationBuilder class. This change should be easy.\\n\\nIf you want to use a JSON format and you d\", \"on\\u2019t want to migrate by hand, there\\u2019s a tool called dotnet-\\nconfig2json that can convert an app.conf\", \"ig file to a JSON configuration file.\\n\\nYou may come across some issues when using configuration sect\", \"ions that were defined in the\\nmachine.config file. For example, consider the following configuration\", \":\\n\\n17 CHAPTER 3 | Migrating Modern Desktop applications\\n<configuration>\\n<system.diagnostics>\\n<switch\", \"es>\\n<add name=\\\"General\\\" value=\\\"4\\\" />\\n</switches>\\n<trace autoflush=\\\"true\\\" indentsize=\\\"2\\\">\\n<listeners>\", \"\\n<add name=\\\"myListener\\\"\\ntype=\\\"System.Diagnostics.TextWriterTraceListener,\\nSystem, Version=1.0.3300.8\", \"@, Culture=neutral,\\nPublicKeyToken=b77a5c561934e089\\\"\\ninitializeData=\\\"MyListener. log\\\"\\ntraceOutputOpt\", \"ions=\\\"ProcessId, LogicalOperationStack, Timestamp,\\nThreadId, Callstack, DateTime\\\" />\\n</listeners>\\n</\", \"trace>\\n\\n</system.diagnostics>\\n</configuration>\\nIf you take this configuration to a .NET app, you'll \", \"get an exception:\\nUnrecognized configuration section System.Diagnostics\\n\\nThis exception occurs becau\", \"se that section and the assembly responsible for handling that section\\nwas defined in the machine.co\", \"nfig file, which now doesn't exist.\\n\\nTo easily fix the issue, you can copy the section definition fr\", \"om your old machine.config to your new\\nconfiguration file:\\n\\n<configSections>\\n<section name=\\\"system.d\", \"iagnostics\\\"\\u201d\\ntype=\\\"System.Diagnostics.SystemDiagnosticsSection,\\n\\nSystem, Version=4.0.0.0, Culture=ne\", \"utral,\\nPublickKeyToken=b77a5c561934e089\\\"/>\\n</configSections>\\n\\nAccessing databases\\n\\nAlmost every desk\", \"top application needs some kind of database. For desktop, it\\u2019s common to find\\nclient-server architec\", \"tures with a direct connection between the desktop app and the database\\nengine. These databases can \", \"be local or remote depending on the need to share information between\\ndifferent users.\\n\\nFrom the cod\", \"e perspective, there have been many technologies and frameworks to give the developer\\nthe possibilit\", \"y to connect, query, and update a database.\\n\\nThe most common examples of database you can find when \", \"talking about Windows Desktop\\napplication are Microsoft Access and Microsoft SQL Server. If you have\", \" more than 20 years of\\nexperience programming for the desktop, names like ODBC, OLEDB, RDO, ADO, ADO\", \".NET, LINQ, and\\nEntity Framework will sound familiar.\\n\\n18 CHAPTER 3 | Migrating Modern Desktop appli\", \"cations\\nODBC\\n\\nYou can continue to use ODBC on .NET since Microsoft is providing the System.Data.Odbc\", \" library\\ncompatible with .NET Standard 2.0.\\n\\nOLE DB\\n\\nOLE DB has been a great way to access various d\", \"ata sources in a uniform manner. But it was based on\\nCOM, which is a Windows-only technology, and as\", \" such wasn\\u2019t the best fit for a cross-platform\\ntechnology such as .NET. It's also unsupported in SQL\", \" Server versions 2014 and later. For those\\nreasons, OLE DB won't be supported by .NET.\\n\\nADO.NET\\n\\nYou\", \" can still use ADO.NET from your existing desktop code on .NET. You just need to update some\\nNuGet p\", \"ackages.\\n\\nEF Core vs. EF6\\n\\nThere are two currently supported versions of Entity Framework (EF), Enti\", \"ty Framework 6 (EF6) and EF\\nCore.\\n\\nThe latest technology released as part of the .NET Framework worl\", \"d is Entity Framework, with 6.4\\nbeing the latest version. With the launch of .NET Core, Microsoft al\", \"so released a new data access stack\\nbased on Entity Framework and called Entity Framework Core.\\n\\nYou\", \" can use EF 6.4 and EF Core from both .NET Framework and .NET. So, what are the decision drivers\\nto \", \"help to decide between the two?\\n\\nEF 6.3 is the first version of EF6 that can run on .NET and work cr\", \"oss-platform. In fact, the main goal of\\nthis release was to make it easier to migrate existing appli\", \"cations that use EF6 to .NET.\\n\\nEF Core was designed to provide a developer experience similar to EF6\", \". Most of the top-level APIs\\nremain the same, so EF Core will feel familiar to developers who have u\", \"sed EF6.\\n\\nAlthough compatible, there are differences on the implementation you should check before m\", \"aking a\\ndecision. For more information, see Compare EF Core & EF6.\\n\\nThe recommendation Is to use EF \", \"Core if:\\n\\n. The app needs the capabilities of .NET.\\n\\n. EF Core supports all of the features that the\", \" app requires.\\n\\nConsider using EF6 if both of the following conditions are true:\\n\\n. The app will run\", \" on Windows and .NET Framework 4.0 or later.\\n\\n. EF6 supports all of the features that the app requir\", \"es.\\n\\n19 CHAPTER 3 | Migrating Modern Desktop applications\\nRelational databases\\n\\nSQL Server\\n\\nSQL Serv\", \"er has been one of the databases of choice if you were developing for the desktop some\\nyears ago. Wi\", \"th the use of System.Data.SglClient in .NET Framework, you could access versions of SQL\\nServer, whic\", \"h encapsulates database-specific protocols.\\n\\nIn .NET, you can find a new Sq[Client class, fully comp\", \"atible with the one existing in the .NET\\nFramework but located in the Microsoft.Data.Sq|Client libra\", \"ry. You just have to add a reference to the\\nMicrosoft.Data.SqiClient NuGet package and do some renam\", \"ing for the namespaces and everything\\nshould work as expected.\\n\\nMicrosoft Access\\n\\nMicrosoft Access h\", \"as been used for years when the sophisticated and more scalable SQL Server wasn't\\nneeded. You can st\", \"ill connect to Microsoft Access using the System.Data.Odbc library.\\n\\nConsuming services\\n\\nWith the ri\", \"se of service-oriented architectures, desktop applications began to evolve from a client-\\nserver mod\", \"el to the three-layer approach. In the client-server approach, a direct database connection\\nis estab\", \"lished from the client holding the business logic, usually inside a single EXE file. On the other\\nha\", \"nd, the three-layer approach establishes an intermediate service layer implementing business logic\\na\", \"nd database access, allowing for better security, scalability, and reusability. Instead of working\\nd\", \"irectly with underlying data, the layered approach relies on a set of services implementing contract\", \"s\\nand typed objects for data transfer.\\n\\nIf you have a desktop application using a WCF service and yo\", \"u want to migrate it to .NET, there are\\nsome things to consider.\\n\\nThe first thing is how to resolve \", \"the configuration to access the service. Because the configuration Is\\ndifferent on .NET, you'll need\", \" to make some updates in your configuration file.\\n\\nSecond, you'll need to regenerate the service cli\", \"ent with the new tools present on Visual Studio 2019\\nand Visual Studio 2022. In this step, you must \", \"consider activating the generation of the synchronous\\noperations to make the client compatible with \", \"your existing code.\\n\\nAfter the migration, if you find that there are libraries you need that aren't \", \"present on .NET, you can\\nadd a reference to the Microsoft.Windows.Compatibility NuGet package and se\", \"e if the missing\\nfunctions are there.\\n\\nIf you're using the WebRequest class to perform web service c\", \"alls, you may find some differences on\\n.NET. The recommendation is to use HttpClient instead.\\n\\n20 CH\", \"APTER 3 | Migrating Modern Desktop applications\\nConsuming a COM Object\\n\\nCurrently, there\\u2019s no way to\", \" add a reference to a COM object from Visual Studio 2019 or Visual Studio\\n2022 to use with .NET. So,\", \" you have to manually modify the project file.\\n\\nInsert a COMReference structure inside the project f\", \"ile like in the following example:\\n\\n<ItemGroup>\\n<COMReference Include=\\\"MSHTML\\\" >\\n<Guid>{3050F1C5 -98\", \"B5-11CF -BB82 - @@AA@OBDCE@B } \\\\</Guid>\\n<VersionMajor>4</VersionMajor>\\n<VersionMinor>@</VersionMinor\", \">\\n\\n<Lcid>@</Lcid>\\n<WrapperTool>primary</WrapperTool>\\n<Isolated>false</Isolated>\\n</COMReference>\\n</It\", \"emGroup>\\n\\nMore things to consider\\n\\nSeveral technologies available to .NET Framework libraries aren't\", \" available for .NET Core or .NET 7. If\\nyour code relies on some of these technologies, consider the \", \"alternative approaches outlined in this\\nsection.\\n\\nThe Windows Compatibility Pack provides access to \", \"APIs that were previously available only for .NET\\nFramework. It can be used on .NET Core and .NET St\", \"andard projects.\\n\\nFor more information on API compatibility, you can find documentation about breaki\", \"ng changes and\\n\\ndeprecated/legacy APIs at https://learn.microsoft.com/dotnet/core/compatibility/fx-c\", \"ore.\\n\\nAppDomains\\n\\nApplication domains (AppDomains) isolate apps from one another. AppDomains require\", \" runtime\\nsupport and are expensive. Creating additional app domains isn't supported. For code isolat\", \"ion, we\\nrecommend separate processes or using containers as an alternative. For the dynamic loading \", \"of\\nassemblies, we recommend the new AssemblyLoadContext class.\\n\\nTo make code migration from .NET Fra\", \"mework easier, .NET exposes some of the AppDomain API\\nsurface. Some of the APIs function normally (f\", \"or example, AppDomain.UnhandledException), some\\nmembers do nothing (for example, SetCachePath), and \", \"some of them throw\\n\\nPlatformNotSupportedException (for example, CreateDomain).\\n\\nRemoting\\n\\n.NET Remot\", \"ing was used for cross-AppDomain communication, which is no longer supported. Also,\\nRemoting require\", \"s runtime support, which is expensive to maintain. For these reasons, .NET Remoting\\nisn't supported \", \"on .NET.\\n\\nFor communication across processes, you should consider inter-process communication (IPC)\\n\", \"mechanisms as an alternative to Remoting, such as the or the MemoryMappedfFile class.\\n\\n21 CHAPTER 3 \", \"| Migrating Modern Desktop applications\\nAcross machines, use a network-based solution as an alternat\", \"ive. Preferably, use a low-overhead\\nplaintext protocol, such as HTTP. The Kestrel web server, the we\", \"b server used by ASP.NET Core, is an\\noption here.\\n\\nCode Access Security (CAS)\\n\\nSandboxing, which rel\", \"ies on the runtime or the framework to constrain which resources a managed\\napplication or library us\", \"es or runs, isn't supported on .NET.\\n\\nUse security boundaries that are provided by the operating sys\", \"tem, such as virtualization, containers,\\n\\nor user accounts, for running processes with the minimum s\", \"et of privileges.\\n\\nSecurity Transparency\\n\\nSimilar to CAS, Security Transparency separates sandboxed \", \"code from security critical code in a\\ndeclarative fashion but is no longer supported as a security b\", \"oundary.\\n\\nUse security boundaries that are provided by the operating system, such as virtualization,\", \" containers,\\nor user accounts, for running processes with the least set of privileges.\\n\\n22 CHAPTER 3\", \" | Migrating Modern Desktop applications\\nCHAPTER |\\n\\nWindows 10 migration\\n\\nConsider the following sit\", \"uation: You have a working desktop application that was developed in the\\nWindows 7 days. It\\u2019s using \", \"WPF technology available at that time and working fine but it has an\\noutdated UI and behaviors when \", \"you run it on Windows 10 or Windows 11. It is like when you watch a\\nfuturistic movie like Matrix and\", \" you see Neo using the Nokia 8110 device. The film works great after\\n20 years but it would rather be\", \"nefit from a device modernization.\\n\\nWith the release of Windows 10, Microsoft introduced many innova\", \"tions to support scenarios like\\ntablets and touch devices and to provide the best experience for use\", \"rs for a Microsoft operating\\nsystem ever. For example, you can:\\n\\n. Sign in with your face using Wind\", \"ows Hello.\\n\\n. Use a pen to draw or handwrite text that is automatically recognized and digitalized.\\n\", \"\\n. Run locally customized Al models built on the cloud using WinML.\\nAll these features are enabled f\", \"or Windows developers through Windows Runtime (WinRT) libraries.\\nYou can take advantage of these fea\", \"tures in your existing desktop apps because the libraries are\\n\\nexposed to both the .NET Framework an\", \"d .NET as well. You can even modernize your UI with the use\\nof XAML Islands and improve the visuals \", \"and behavior of your apps according to the times.\\n\\nOne important thing to note here is that you don\\u2019\", \"t need to abandon .NET Framework technology to\\nfollow this modernization path. You can safely stay o\", \"n there and have all the benefits of Windows 10\\nand Windows 11 without the pressure to migrate to .N\", \"ET. So, you get both the power and the\\nflexibility to choose your modernization path.\\n\\nWinRT APIs\\n\\nW\", \"inRT APIs are object-oriented, well-structured application programming interfaces (APIs) that give\\nW\", \"indows 10 and Windows 11 developers access to everything the operating system has to offer.\\nThrough \", \"WinRT APIs, you can integrate functionalities like Push Notifications, Device APIs, Microsoft\\nInk, a\", \"nd WinML, among others on your desktop apps.\\n\\nIn general, WinRT APIs can be called from a classic de\", \"sktop app. However, two main areas present an\\nexception to this rule:\\n\\n. APIs that require a package\", \" identity.\\n\\n. APIs that require visualization like XAML or Composition.\\n\\n23 CHAPTER 4 | Windows 10 m\", \"igration\\nUniversal Windows Platform (UWP) packages\\n\\nApplication Package Identity\\n\\nUWP apps have a de\", \"ployment system where the OS manages the installation and uninstallation of\\napplication. That requir\", \"es the installation to be declarative, meaning that no user code is executed\\nduring install. Instead\", \", everything the app wants to integrate with the system, such as protocols, file\\ntypes, and extensio\", \"ns, is declared in the application manifest. At deployment time, the deployment\\npipeline configures \", \"those integration points. The only way for the OS to manage all this functionality\\nand keep track of\", \" it is for each \\u2018package\\u2019 to have an identity, a unique identifier for the application.\\n\\nSome WinRT \", \"APIs require this package identity to work as expected. However, classic desktop apps\\nlike native C+\", \"+ or .NET apps, use different deployment systems that don\\u2019t require a package identity.\\nIf you want \", \"to use these WinRT APIs in your desktop application, you need to provide them a package\\nidentity.\\n\\nO\", \"ne way to proceed is to build an additional packaging project. Inside the packaging project, you\\npoi\", \"nt to the original source code project and specify the Identity information you want to provide. If\\n\", \"you install the package and run the installed app, it will automatically get an identify enabling yo\", \"ur\\ncode to call all WinRT APIs requiring Identity.\\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\" ?>\\n<Package\", \" xmlns=\\\"http://schemas.microsoft.com/appx/manifest/foundation/windows10\\\"\\nxmlns:uap=\\\"http://schemas.m\", \"icrosoft.com/appx/manifest/uap/windows10\\\" >\\n<Identity Name=\\\"YOUR-APP-GUID \\\"\\n\\nPublisher=\\\"CN=YOUR COMP\", \"ANY\\\"\\nVersion=\\\"1.x.x.x\\\" />\\n\\n</Package>\\n\\nYou can check which APIs need a packaged application identity\", \" by inspecting if the type that contains\\nthe API is marked with the DualApiPartition attribute. If i\", \"t is, you can call if from an unpackaged\\ntraditional desktop app. Otherwise, you must convert your c\", \"lassic desktop app to a UWP with the help\\nof a packaging project.\\n\\nBenefits of packaging\\n\\nBesides gi\", \"ving you access to these APIs, you get some additional benefits by creating a Windows App\\npackage fo\", \"r your desktop application including:\\n\\n. Streamlined deployment. Apps have a great deployment experi\", \"ence ensuring that users can\\nconfidently install an application and update it. If a user chooses to \", \"uninstall the app, it\\u2019s\\nremoved completely with no trace left behind preventing the Windows rot prob\", \"lem.\\n\\n. Automatic updates and licensing. Your application can participate in the Microsoft Store's\\nb\", \"uilt-in licensing and automatic update facilities. Automatic update is a highly reliable and\\nefficie\", \"nt mechanism, because only the changed parts of files are downloaded.\\n\\n24 CHAPTER 4 | Windows 10 mig\", \"ration\\n. Increased reach and simplified monetization. Maybe not your case but if you choose to\\ndistr\", \"ibute your application through the Microsoft Store you reach millions of Windows 10 and\\nWindows 11 u\", \"sers.\\n\\n. Add UWP features. You can add UWP features to your app\\u2019s package at your own pace.\\n\\nPrepare\", \" for packaging\\n\\nBefore proceeding to package your desktop application, there are some points you hav\", \"e to address\\nbefore starting the process. Your application must respect any of the Microsoft Store r\", \"ules and\\npolicies and run in the UWP application model. For example, it has to run on the .NET Frame\", \"work 4.6.2\\nor later and writes to the HKEY_CURRENT_USER registry hive and the AppData folders will b\", \"e\\nvirtualized to a user-specific app-local location.\\n\\nThe design goal for packaging is to separate t\", \"he application state from system state while maintaining\\ncompatibility with other apps. Windows 10 a\", \"nd Windows 11 accomplish this goal by placing the\\napplication inside a UWP package. It detects and r\", \"edirects some changes to the file system and\\nregistry at run time to fulfill the promise of a truste\", \"d and clean install and uninstall behavior of an\\napplication provided by packaging.\\n\\nPackages that y\", \"ou create for your desktop application are desktop-only, full-trust applications that\\naren't sandbox\", \"ed, although there's lightweight virtualization applied to the app for writes to HKCU\\nand AppData. T\", \"his virtualization allows them to interact with other apps the same way classic desktop\\napplications\", \" do.\\n\\nInstallation\\n\\nApp packages are installed under %ProgramFiles%\\\\WindowsApps\\\\package_name, with t\", \"he executable\\ntitled app_name.exe. Each package folder contains a manifest (named AppxManifest.xml) \", \"that contains\\na special XML namespace for packaged apps. Inside that manifest file is an <EntryPoint\", \"> element,\\nwhich references the full-trust app. When that application is launched, it doesn\\u2019t run in\", \"side an app\\ncontainer, but instead it runs as the user as it normally would.\\n\\nAfter deployment, pack\", \"age files are marked read-only and heavily locked down by the operating\\nsystem. Windows prevents app\", \"s from launching if these files are tampered with.\\n\\nFile system\\n\\nThe OS supports different levels of\", \" file system operations for packaged desktop applications,\\ndepending on the folder location.\\n\\nWhen t\", \"rying to access the user's AppData folder, the system creates a private per-user, per-app\\nlocation b\", \"ehind the scenes. This creates the illusion that the packaged application is editing the real\\nAppDat\", \"a when it's actually modifying a private copy. By redirecting writes this way, the system can\\ntrack \", \"all file modifications made by the app. It can then clean all those files when uninstalling reducing\", \"\\nsystem \\u201crot\\u201d and providing a better application removal experience for the user.\\n\\n25 CHAPTER 4 | Wi\", \"ndows 10 migration\\nRegistry\\n\\nApp packages contain a registry.dat file, which serves as the logical e\", \"quivalent of HKLM\\\\Software in\\nthe real registry. At run time, this virtual registry merges the conte\", \"nts of this hive into the native\\nsystem hive to provide a singular view of both.\\n\\nAll writes are kep\", \"t during package upgrade and only deleted when the application is uninstalled.\\n\\nUninstallation\\n\\nWhen\", \" the user uninstalls a package, all files and folders located under C:\\\\Program\\nFiles\\\\WindowsApps\\\\pac\", \"kage_name are removed, as well as any redirected writes to AppData or the\\nregistry that were capture\", \"d during the process.\\n\\nFor details about how a packaged application handles installation, file acces\", \"s, registry, and\\nuninstallation, see https://learn.microsoft.com/windows/msix/desktop/desktop-to-uwp\", \"-behind-the-\\n\\nSCenes.\\n\\nYou can get a complete list of things to check on\\n\\nhttps://learn.microsoft.co\", \"m/windows/msix/desktop/desktop-to-uwp-prepare.\\n\\nHow to add WinRT APIs to your desktop project\\n\\nIn th\", \"is section, you can find a walkthrough on how to integrate Toast Notifications in an existing WPF\\nap\", \"plication. Although it\\u2019s simple from the code perspective, it helps illustrate the whole process.\\nNo\", \"tifications are one of the many available WinRT APIs available that you can use in .NET app. In this\", \"\\ncase, the API requires a Package Identity. This process is more straightforward if the APls don\\u2019t r\", \"equire\\nPackage Identity.\\n\\nLet's take an existing WPF sample app that reads files and shows its conte\", \"nts on the screen. The goal\\nis to display a Toast Notification when the application starts.\\n\\n26 CHAP\", \"TER 4 | Windows 10 migration\\n[BS File Loaded: C:\\\\Users\\\\martafuentes\\\\ Desktop TestFile.bet \\u2014 O bs\\n\\nCa\", \"ll Windows 10 APIs:\\nTest content file\\n\\nFirst, you should check in the following link whether the Win\", \"dows 10 or Windows 11 API that you'll\\nuse requires a Package Identity:\\n\\nhttps://learn.microsoft.com/\", \"windows/apps/desktop/modernize/desktop -to-uwp-supported-api\\n\\nOur sample will use the Windows.UI.Not\", \"ifications.Notification API that requires a packaged identity:\\n\\nbol | BP Notiication Can Wie xX OY -\", \" S x\\n\\u20ac \\u00a9 a docs. microso\\u201c.com Ped * \\u00a3\\nH+ Microsoft | Windows Dev Center Uwrancr Getctated Gengr Deve\", \"lop = Pubech Rescarces Dathbosed oO\\nNotificatern Cav Fl feedback Shure 3 There\\n* * *\\n\\\" Notification \", \"Class wha\\nWieiows Ul Notre ators Nurneguece = Whinetow Moti shorn | Detiretion\\nAdaptiveNotificatonCo\", \"rtentiGed Amamrm\\u00e9siet Wiewdows LI Notifications dll Wecow \\u00a2 , 2\\n\\nAdagtiveNiotticatear Text\\nRepresent\", \"s a notification\\n\\nBadgeNotficabon\\nNacige Teenplate Type co BCopy\\nRadgeUpdateManager\\npublic sealed cl\", \"ass Notificatior\\n\\u00bb Racige ipdiete Manager forluer\\n\\u00bb BadgeUpdater\\n\\nArributes ActivatableAririwte, Com\", \"tractVersionArinliate\\nUdaptreNonticanonconent 7 , ;\\n\\nRawr Achagetrwe Pec fc ator writs\\n\\nWindows 10 r\", \"equirements\\n\\nKnovrAdaptvettoticaton Test Styles\\n\\nKnowrtictshic shontendings Device tammy \\u00abWindows 10\", \" Anniversary Edition Getroduced wt0.0 14303.0)\\nNowtcanon\\nNotetficateon\\n& tht page Sebee\\u201d .\\n+ Downloa\", \"d POF Constructors | vee fh ve |\\n\\n| | oO sities matador ad iaoemenswpuer td Od  nvew or, @|\\n\\nTo acce\", \"ss the WinRT API, add a reference to the Microsoft.Windows.SDK.Contracts NuGet package\\nand this pack\", \"age will do the magic behind the scenes (see details at\\nhttps://blogs.windows.com/windowsdeveloper/2\", \"019/04/30/calling-windows-10-apis-from-a-desktop-\\n\\napplication-just-got-easier/).\\n\\nYou're now prepar\", \"ed to start adding some code.\\n\\n27 CHAPTER 4 | Windows 10 migration\\nCreate a ShowToastNotification me\", \"thod that will be called on application startup. It just builds a toast\\nnotification from an XML pat\", \"tern:\\n\\nprivate void ShowNotification(string title, string content, string image)\\n{\\n\\nstring xmlString\", \" = $@\\\"<toast><visual><binding template =\\n\\\"ToastGeneric' ><text>{title}</text><text>{content}</text><\", \"image\\nsrc=>'{image}'</image></binding></visual></toast>\\\";\\n\\nXm1Document toastXml = new XmlDocument() \", \";\\ntoastXml.LoadXm1(xm1String) ;\\n\\nToastNotification toast = new ToastNotification(toastxXmL1) ;\\nToast\", \"NotificationManager .CreateToastNotifier().Show(toast) ;\\n\\nAlthough the project builds, there are err\", \"ors because the Notifications API requires a Package Identity\\nand you didn't provide it. Adding a Wi\", \"ndows Packaging Project to the solution will fix the issue:\\n\\nAdd New Project ? x\\nb Recent * Sort by:\", \" | Default ~ [eee Search (Ctrl+E) P-\\n@ Installed Na Blank App (Universal Windows) Visual C# Type: Vi\", \"suel Ce\\n4 Visual C# A project that creates packages containing\\nGet Started a ri Class Library (Unive\", \"rsal Windows) Visual C= Windows applications for side-loading or\\n: t distribution via the Windows St\", \"ore\\nWindows Universal _\\nWindows Desktop ar Windows Runtime Component (Universal Windows) Visual C#\\n>\", \"b Web -\\nb Office/SharePoint ar Optional Code Package (Universal Windows) Visual C#\\n-NET Core *\\n-NET \", \"Standard ral Unit Test App (Universal Windows) Visual C#\\nAndroid \\u00ab\\nApple TV ral Coded UI Test Projec\", \"t (Universal Windows) Visual C#\\nApple Watch\\nCloud =. Windows Application Packaging Project Visual C#\", \"\\nCross-Platform\\nExtensibility\\niOS Extensions\\niPhone & iPad\\nTest\\nWCF\\nWorkflow\\n> Azure Data Lake\\n> Azu\", \"re Stream Analytics v\\n\\nNot finding what you are looking for?\\n\\nOpen Visual Studio Installer\\n\\nName: Sh\", \"owFileWPFApp.Package\\nLocation: C:\\\\Users\\\\martafuentes\\\\source\\\\repos\\\\ShowFileWPFApplication ~| Browse..\", \".\\n\\nCancel\\n\\nSelect the minimum Windows version you want to support and the version you're targeting. \", \"Not all\\nthe WinRT APIs are supported in all Windows 10 and Windows 11 versions. Each Windows 10 or\\nW\", \"indows 11 update adds new APIs that are only available from this version; down-level support isn\\u2019t\\na\", \"vailable.\\n\\n28 CHAPTER 4 | Windows 10 migration\\nNew Universal Windows Platform Project 8\\n\\nSelect the \", \"target and minimum platform versions that your UWP application will support.\\n\\nTarget version: Window\", \"s 10, version 1803 (10.0: Build 1713-4) po\\n\\nMinimum version: | Windows 10 Creators Update (10.0: Bui\", \"ld 15063) we\\n\\nWhich version should | choose? Cancel\\n\\nNext step is to add the WPF application to the \", \"Windows Packaging Project by adding a project\\nreference:\\n\\n29 CHAPTER 4 | Windows 10 migration\\nNysoub\", \"eg\\n\\n@a-|e-sap|s\\u2014=\\nSearch Solution Explorer (Ctri+\\\")\\n\\nfg] Solution 'ShowFileWPFApplication' (2 projec\", \"ts)\\nF | ShowFileW pf\\n> J Properties\\n\\n5 | \\u2018a Oo}\\n\\nadoud\\n\\n> mM References\\n#2 App.config\\n4! App.xaml\\n\\nS\", \"al\\n\\n>b TY App.xaml.cs\\n4 /) MainWindow.xaml\\n> FF) MainWindow.xaml.cs\\n4 \\u00a9] ShowFileWPFApp.Package\\n\\nAdd\", \" Reference...\\n\\nPackage.appxmanitest\\nFe] ShowFileWPFApp.Package_TemporaryKey.ptx\\n\\nReference Manager -\", \" ShowFileWPFApp.Package ? x\\n4 Projects Search (Ctrl+E) P-\\nSolution Name Path Name:\\n\\nShowFileW pf C:\\\\\", \"Users\\\\martafuentes\\\\source\\\\repos\\\\ShowFileWPFApplication... ShowFileWpf\\n\\nA Windows Packaging Project c\", \"an package several apps so you should set which one is the Entry\\nPoint:\\n\\n30 CHAPTER 4 | Windows 10 m\", \"igration\\n@m&-| o-sSae|s\\u2014\\nSearch Solution Explorer (Ctri+\\\")\\n\\nNyouBbeig\\n\\n5 | \\u2018a oO}\\n\\nfa] Solution \\u2018Sho\", \"wFileWPFApplication' (2 projects)\\n7 ShowFileW pt\\n\\n> J Properties\\n\\n> mM References\\n\\n#2] App.config\\n\\np\", \"ada,\\n\\n4! App.xaml\\n>b TY) App.xaml.cs\\n4 ]) MainWindow.xaml\\n> FF) MainWindow.xaml.cs\\n4 \\u00a9) ShowFileWPFA\", \"pp.Package\\n4 = Applications\\n\\nfF] ShowFileWPFApp.Package_TemporaryKey.pfx\\n\\nNext step is to set the WP\", \"F Project as the startup Project in the solution configuration. You can press\\nF5 to compile and buil\", \"d and see the results.\\n\\nFae tt View 3 Prepect Bult = Cebug Teen foot Anchtettee Tet Anaiyre 6 Widow \", \"8 Help\\no- owe\\n\\u00a9 Detugge petommance may be engraved by heeding fewer tymbok ym\\u00e9ch cptera Lawn mere Ne\", \"ver show Sw rumnage ayter\\n\\nES Lange Ttescete- TMigag\\nES LegeT\\u00e9escale-20 pag\\nFa] Lange The scate-400 \", \"pag\\nES Sratl terete org\\nES Set Ttencate- Uh peg\\nEX SatiTtescole- gag\\nES SeratT te scat Wong\\nEj Sena \", \"Tercale-4N org\\nEF Spleen Screen oc ahe- 100 png\\nED Sete Screen scate: 15 peg\\nES] Splewicreen scale 1\", \"Si.pag\\n\\nES Sptewixreen scale DO png\\n\\n5 Sele icreen ot she a0 peng\\n\\nES Squarette! Kh oge.scate: pag\\nE\", \"S Square tie 1 SLogo.scate- tit.pag\\nEE Square 31 KR ope scale- ti png\\nCS Square te RA oge scale BO p\", \"ag\\nfymnbel loading ES Square xT MLoge. scale pag\\nES] Squanrebekdl ogo sittoren-enpleted te\\nCE) Sepse\", \"rptinttl og sttorm unpleted te\\nPy Squares\\u00e9eStlogo aittorm- unpleted te\\nE] Squserebdebsl ogo sittoem-\", \"unpluted ta\\n\\nsca. toe C\\\\Lher mrartatventer AppOete\\nPeer po\\n\\nne\\n\\nNi\\n\\nexe\\u201d (Wind): Unicoded \\u2018C: \\\\iinco\", \"es Vi cresof: T\\\\eee \\u2019 C_WGIL \\\\ System. Mueerice. Vectors \\\\w4.0 4.0.0.0 859549\\\") lcteele\\\\ System, tum\", \"erics.Vectors.dll\\nfone\\\" (CLS wS.8. WO329: Shoe lL lewpt eur): & J] Vas MOOS Lc +? \\\\anpewt ly VO4C_F5\", \"11 \\\\Syeten. Numer ice. Vectors \\\\v4.0_4.8.0.8_ S830S0741 bedeele\\\\Syatew tumerics.Vectors.c11\\\". Sy\\nexe\", \"\\u2019 (Wind): Losded \\\"C) \\\\Mindows ese iy et ives: a_Y , . yiten,. Wmerics \\\\S4ers Mat lesOca006 Sat 2 141\", \"70 5\\\\ System. Memerice.of. dbl\\n+2 Microsett Wet Lansently VOAC_PSIL System, emer ics 4. 0_4.0.0.0__B\", \"77aScS6lP 140800 Sypstew. Mumerics. dll\\\", Spetels loaded\\n<t. nines\\u2019. Module wes Suilt withewt syetci\", \"s,\\n\\nADI}: Loades \\u201cC) \\\\airdows (Sy sods ebetet etete\\\\uindows deeotdcs.wined\\u2019. Module wes Oudlt withou\", \"t syenels\\nere\\u2019 (MLAR2)) Unbeeted 'C) \\\\atlntoers \\\\Sy eters \\\\ntieetet etete wl tows Greonics wired\\nane\", \"\\u2019 (COM wh .@, 9018) Shee Llewpt ene): Looted \\u00b0C) \\\\WWiMeetd\\\\syetend2 wietetecete\\\\Mindews .Grepnics \\u00abi\", \"ned. Metele wes Gellt elimet syemels\\n\\noO Excribe aqul para Guscar\\n\\nLet's generate the package so you\", \" can install your app. Right click on Store > Create App Packages.\\n\\n31 CHAPTER 4 | Windows 10 migrat\", \"ion\\nyy\\n\\nDk\\n\\nV ot ay\\n\\ni\\na\\nx\\n\\nCc\\n&\\n\\nBuild\\nRebuild\\n\\nDeploy\\nClean\\n\\nPower Commands\\nOverview\\n\\nScope to Thi\", \"s\\n\\nNew Solution Explorer View\\nShow on Code Map\\n\\nEdit ShowFileWPFApp.Package.wapproy\\nBuild Dependenci\", \"es\\n\\nAdd\\n\\nStore\\n\\nSet as StartUp Project\\nDebug\\n\\nCut\\n\\nRemove\\n\\nRename\\nUnload Project\\nOpen Folder in File\", \" Explorer\\n\\nProperties\\n\\nuUBeIg\\n\\n@a&- o-sSae s-\\nSearch Solution Explorer (Ctrl+\\\")\\nfa] Solution 'ShowFi\", \"leWPFApplication' (2 projects)\\nr ShowFileWpf\\n\\nJ Properties\\nBB References\\n\\n4/00] al}Si\\n\\nsalpadol,\\n\\nq_\", \"] App.config\\n\\ncE) App.xaml\\n\\n>b oP) App.xami.cs\\n\\nEC) MainWindow.xaml\\n\\n>b PF MainWindow.xaml.cs\\n\\n<age.\", \"appxmanitest\\nwFileWPFApp.Package_TemporaryKey.ptx\\n\\nAssociate App with the Store...\\nConvert Content G\", \"roup Map File\\nr Create App Packages...\\nCtrl+X\\nDel\\nAlt+ Enter\\n\\nSelect the sideloading option to deplo\", \"y the app from your machine:\\n\\n32\\n\\nCHAPTER 4 | Windows 10 migration\\nCreate App Packages ? bs\\n\\nCreate \", \"Your Packages\\n\\nHow do you want to distribute your application?\\n() | want to create packages to uploa\", \"d to the Microsoft Store using a new app name.\\n(@) | want to create packages for sideloading.\\nEnable\", \" automatic updates\\nWhat ts sideloading?\\n\\nA Automatic updates are not available for the configured Ta\", \"rget Platform Minimum Version. Help me choose the version.\\n\\nPrevious Cancel\\n\\nSelect the application \", \"architecture of your app:\\n\\n33 CHAPTER 4 | Windows 10 migration\\nCreate App Packages\\n\\nPA Select and Co\", \"nfigure Packages\\n\\nOutput location:\\n\\nCAUsers\\\\martafuentes\\\\source\\\\vepos\\\\ShowFileWPFApplication\\\\ShowF i\", \"leWPFApp.Package\\\\AppPackages\\\\ |. |\\nVersion:\\n1 |.fo|.fo \\u2014_\\u2018|.{o\\n\\nAutomatically increment\\n\\nMore inform\", \"ation\\n\\nGenerate app bundle:\\nAlways \\u2122\\nWhat does an app bundle mean?\\n\\nSelect the packages to create an\", \"d the solution configuration mappings:\\n\\nArchitecture Solution Configuration @ To run validation loca\", \"lly, you must select at least one solution\\nconfiguration that is both non-Debug and contains an\\n\\nNeu\", \"tral Debug (Any CPU) \\u2122 architecture that runs on the local machine.\\nL] x86 Debug (x86) *\\nL] x64 Debu\", \"g (x64) -\\n\\nARM None\\n\\nInclude full PDB symbol files, if any, to enable crash analytics for the app. L\", \"earn More\\n\\nFinally, create the package by clicking on Create.\\n\\nXAML Islands\\n\\nXAML Islands are a set \", \"of components that enable Windows desktop developers to use UWP XAML\\ncontrols on their existing Win3\", \"2 applications, including Windows Forms and WPF.\\n\\n34 CHAPTER 4 | Windows 10 migration\\n~ UWP aN\\n// \\u201cs\", \"ix \\\\ \\u2014 \\u2014\\n\\n| _\\u2014 | \\u201cUwe ap) \\\\\\n\\n\\u2014 : TA Model / Pp \\\\ \\\\\\n/ \\\\ / Package ID | \\\\ 4 model \\\\ \\\\\\n| | Certificate \", \"/ NN / | \\\\\\n\\nWin32 | WinForms ( WPF | \\\\ a ae \\u2014 Run-Resume-Susp _//\\n} \\\\ | =)\\n\\n\\\\ | nN a \\u2122. AppContai\\n\\nU\", \"WP UWP \\\\N |\\n@/ \\\\@/ \\\\ Ge) | | / PRI A WinRT APIs Yo |\\n\\\\ / |\\n\\n\\\\ \\\\  Resw / \\\\ fo - \\\\\\n\\\\ Komer) / \\u2014 (i) \\\\ \", \"( Sto re) | /\\n( Inpu i /\\nWin32 app model \\\\ | C pat | a /\\n\\\\ \\\\ \\u2014 ff \\\\ | :\\n\\u2018 \\\\ ( Com >) \\\\ / .\\nYS N S/\\n\\u2014\", \" NN\\nA 7\\nee _ -\\na \\u2014 _\\u2014_\\u2014\\n\\nYou can image your Win32 app with your standard controls and among them an \", \"\\u201cisland\\u201d of UWP UI\\ncontaining controls from the modern world. The concept is similar to having an iF\", \"rame inside a web\\npage that shows content from a different page.\\n\\nBesides adding functionality from \", \"the Windows 10 and Windows 11 APIs, you can add pieces of UWP\\nXAML inside of your app using XAML Isl\", \"ands.\\n\\nWindows 10 1903 update introduced a set of APIs that allow hosting UWP XAML content in Win32\\n\", \"windows. Only apps running on Windows 10 1903 or later can use XAML Islands.\\n\\nThe road to XAML Islan\", \"ds\\n\\nThe road to XAML Islands started in 2012 when Microsoft introduced the WinRT APIs as a framework\", \"\\nto modernize the Win32 apps (Windows Forms, WPF, and native Win32 apps). However, the new UI\\ncontro\", \"ls inside WinRT were available for new applications but not for existing ones.\\n\\nIn 2015, along with \", \"Windows 10, UWP was born. UWP allows you to create apps that work across\\nWindows devices like XBox, \", \"Mobile, and Desktop. One year later, Microsoft announced Desktop\\nBridge (formerly known as Project C\", \"entennial). Desktop Bridge is a set of tools that allowed\\ndevelopers to bring their existing Win32 a\", \"pps to the Microsoft Store. More capabilities were added in\\n2017, allowing developers to enhance the\", \"ir Win32 apps leveraging some of the new Windows 10 APIs,\\nlike live tiles and notifications on the a\", \"ction center. But still, no new UI controls.\\n\\nAt Build 2018, Microsoft announced a way for developer\", \"s to use the new Windows 10 XAML controls\\ninto their current Win32 apps, without fully migrating the\", \"ir apps to UWP. It was branded as UWP\\nXAML Islands.\\n\\nHow it works\\n\\nThe Windows 10 1903 update introd\", \"uced several XAML hosting APls. Two of them are\\nWindowsXamlIManager and DesktopWindowXamlSource.\\n\\n35\", \" CHAPTER 4 | Windows 10 migration\\nThe WindowsXam|Manager class handles the UWP XAML Framework. Its I\", \"nitializeForCurrentThread\\nmethod loads the UWP XAML Framework inside the current thread of the Win32\", \" app.\\n\\nThe DesktopWindowXamlSource is the instance of your XAML Island content. It has the Content\\np\", \"roperty, which you're responsible for instantiating and setting. The DesktopWindowXamlSource\\nrenders\", \" and gets its input from an HWND. It needs to know to which other HWND it will attach the\\nXAML Islan\", \"d's one, and you're responsible for sizing and positioning the parent's HWND.\\n\\nWPF or Windows Forms \", \"developers don't usually deal with HWND inside their code, so it may be hard\\nto understand and handl\", \"e HWND pointers and the underlying wiring stuff to communicate Win32 and\\nUWP worlds.\\n\\nThe XAML Islan\", \"ds .NET Wrappers\\n\\nThe Windows Community Toolkit has a set the XAML Islands .NET wrappers for WPF or \", \"Windows\\nForms that make easier to use XAML Islands. These wrappers manage the HWNDs, the focus\\nmanag\", \"ement, among other things. Windows Forms and WPF developers should use these wrappers.\\n\\nThe Windows \", \"Community Toolkit offers two types of controls: Wrapped Controls and Hosting\\nControls.\\n\\nWrapped Cont\", \"rols\\n\\nThese wrapped controls wrap some UWP controls into Windows Forms or WPF controls, hiding UWP\\nc\", \"oncepts for those developers. These controls are:\\n\\nWebView and WebViewCompatible\\nInkCanvas and InkTo\", \"olbar\\nMediaPlayerElement\\n\\nMapControl\\n\\nAdd the Microsoft.Toolkit.Wpf.UI.Controls package to your proj\", \"ect, include the reference to the\\nnamespace, and start using them.\\n\\n<Window\\n\\nxmlns:uwpControls=\\\"clr-\", \"\\n\\nnamespace:Microsoft. Toolkit .Wpf.UI.Controls;assembly=Microsoft.Toolkit.Wpf.UI.Controls\\\">\\n<Grid>\\n\", \"\\n<Grid.RowDefinitions>\\n<RowDefinition Height=\\\"Auto\\\"/>\\n<RowDefinition Height=\\\"\\\\*\\\"/>\\n\\n</Grid.RowDefini\", \"tions>\\n\\n<uwpControls:InkToolbar TargetInkCanvas=\\\"{x:Reference Name=inkCanvas}\\\"/>\\n\\n<uwpControls:InkCa\", \"nvas Grid.Row=\\\"1\\\" x:Name=\\\"inkCanvas\\\" />\\n\\n</Grid>\\n\\nHosting controls\\n\\nThe power of XAML Islands extend\", \"s to most first-party controls, third-party controls, and custom\\ncontrols developed for UWP, which c\", \"an be integrated into Windows Forms and WPF as \\u201cIslands\\u201d with\\nfully functional Ul. The WindowsXamlHo\", \"st control for WPF and Windows Forms allows doing this.\\n\\n36\\n\\nCHAPTER 4 | Windows 10 migration\\nFor ex\", \"ample, to use the WindowsXamlHost control in WPF, add a reference to the\\nMicrosoft.Toolkit.Wpf.UI.Xa\", \"mlHost package provided by the Windows Community Toolkit.\\n\\nOnce you've placed your WindowsXamlHost i\", \"nto your UI code, specify which UWP type you want to\\nload. You can choose to use a wrapped control l\", \"ike a Button or a more complex one composed of\\nseveral different controls, which are a custom UWP co\", \"ntrol.\\n\\nThe following example shows how to add a UWP Button:\\n\\n<Window\\n\\nxmins:xamlhost=\\\"clr-\\n\\nnamespa\", \"ce:Microsoft.Toolkit.Wpf.UI.XamlHost;assembly=Microsoft.Toolkit.Wpf.UI.XamlHost\\\">\\n\\n<xamLhost:Windows\", \"XamlHost x:Name=\\\"myUwpButton\\\"\\nInitialTypeName=\\\"Windows.UI.Xaml.Controls.Button\\\" />\\n\\nThere's a clear \", \"recommendation on how to approach this and it's better to have one single and bigger\\nXAML Island con\", \"taining a custom composite control than to have several islands with one control on\\neach.\\n\\nOne of th\", \"e core features of XAML is binding and it works between your Win32 code and the island.\\nSo, you can \", \"bind, for instance, a Win32 Textbox with a UWP Textbox. One important thing to consider\\nis that thes\", \"e bindings are one-way bindings, from UWP to Win32, so if you update the Textbox inside\\nthe XAML Isl\", \"and the Win32 Textbox will be updated, but not the other way around.\\n\\nTo see a walkthrough about how\", \" to use XAML Islands, see:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop/modernize/host-standard\", \"-control-with-xaml-\\n\\nislands\\n\\nAdding UWP XAML custom controls\\n\\nA XAML custom control is a control (o\", \"r user control) created by you or by third parties (including\\nWinUI 2.x controls). To host a custom \", \"UWP control in a Windows Forms or WPF app, you'll need:\\n\\n. To use the WindowsXamlHost UWP control in\", \" your .NET app.\\n. To create a UWP app project that defines a XamlApplication object.\\n\\nYour WPF or Wi\", \"ndows Forms project must have access to an instance of the\\nMicrosoft.Toolkit.Win32.UI.XamlHost.XamlA\", \"pplication class provided by the Windows Community\\nToolkit. This object acts as a root metadata prov\", \"ider for loading metadata for custom UWP XAML\\ntypes in assemblies in the current directory of your a\", \"pplication. The recommended way to do this is to\\nadd a Blank App (Universal Windows) project to the \", \"same solution as your WPF or Windows Forms\\nproject and revise the default App class in this project.\", \"\\n\\nThe custom UWP XAML control can be included on this UWP app or in an independent UWP Class\\nLibrary\", \" project that you reference in the same solution as your WPF or Windows Forms project.\\n\\nYou can chec\", \"k a detailed step-by-step process description at:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop/\", \"modernize/host-custom-control-with-xaml-\\n\\nislands\\n\\n37 CHAPTER 4 | Windows 10 migration\\nThe Windows U\", \"I Library (WinUI 2)\\n\\nBesides the inbox Windows 10 controls that comes with the OS, the same UWP XAML\", \" team also\\ndelivers additional controls in the Windows UI Library (WinUI 2). WinUI 2 provides offici\", \"al native\\nMicrosoft UI controls and features for Windows UWP apps and these controls can be used ins\", \"ide of\\nXAML Islands.\\n\\nWinUl 2 is open source and you can find information at https://github.com/micr\", \"osoft/microsoft-ui-\\n\\nxaml.\\n\\nThe following article demonstrates how to host a UWP XAML control from t\", \"he WinUI 2 library:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop/modernize/host-custom-control-\", \"with-xaml-\\n\\nislands\\n\\nDo you need XAML Islands\\n\\nXAML Islands are intended for existing Win32 apps tha\", \"t want to improve their user experience by\\nleveraging new UWP controls and behaviors without a full \", \"rewrite of the app. You could already\\nleverage Windows 10 and Windows 11 APIs, but up until XAML Isl\", \"ands, only non-UI related APIs.\\n\\nIf you're developing a new Windows App, a UWP App is probably the r\", \"ight approach.\\n\\nThe road ahead XAML Islands: WinUI 3.0\\n\\nSince Windows 8, the Windows UI platform, in\", \"cluding the XAML UI framework, visual composition\\nlayer, and input processing has been shipped as an\", \" integral part of Windows. This means that to\\nbenefit from the latest improvements on UI technologie\", \"s, you must upgrade to the latest version of\\nthe UI, slowing down the pace of innovation when you de\", \"velop your apps. To decouple these two\\nevolution cycles and foster innovation, Microsoft is actively\", \" working on the WinUI project.\\n\\nStarting with WinUI 2 in 2018, Microsoft started shipping some new X\", \"AML UI controls and features as\\nseparate NuGet packages that build on top of the UWP SDK.\\n\\n38 CHAPTE\", \"R 4 | Windows 10 migration\\nWinUI 2.0: controls + styles\\n\\nMicrosoft.UI.Xaml.Controls\\n\\nUniversal Windo\", \"ws Platform\\nWindows.UI.Xaml.*\\nWindows.UI.Composition.*\\nWindows.UI.Input.*\\n\\nSurface Devices +\\n\\nWindow\", \"s PCs Xbox HoloLens Hub loT\\n\\nWinUI 3 is under active development and will greatly expand the scope o\", \"f WinUI to include the full UI\\nplatform, which will be fully decoupled from the UWP SDK:\\n\\nWinUI 3.0:\", \" the Windows UI platform\\n\\nMicrosoft.UI.Xaml.*\\nMicrosoft.UI.Composition.*\\nMicrosoft.UI.Input.*\\n\\nUnive\", \"rsal Windows Platform\\n\\nSurface Devices +\\n\\nWindows PCs Xbox HoloLens Hub loT\\n\\nXAML framework will now\", \" be developed on GitHub and shipped out of band as NuGet packages.\\n\\nThe existing UWP XAML APIs that \", \"ship as part of the OS will no longer receive new feature updates.\\nThey will still receive security \", \"updates and critical fixes according to the Windows 10 support lifecycle.\\n\\nThe Universal Windows Pla\", \"tform contains more than just the XAML framework (for example,\\napplication and security model, media\", \" pipeline, Xbox and Windows 10 shell integrations, broad device\\nsupport) and will continue to evolve\", \". All new XAML features will just be developed and ship as part of\\nWinUI instead.\\n\\nWinUI 3 in deskto\", \"p app and WinUI XAML Islands\\n\\nAs you can see, WinUI 3 is the evolution of UWP XAML and it works natu\", \"rally within the UWP app\\nmodel and all its requirements (MSIX packaged ID, sandbox, CoreWindow, and \", \"so on. To use just\\nWinUl 3 in a Win32 app model, the WinUI content should be hosted by another UI Fr\", \"amework\\n(Windows Forms, WPF, and so on) using WinUI XAML Islands. This is the right path if you want\", \" to\\n\\n39 CHAPTER 4 | Windows 10 migration\\nevolve your app and mix technologies. However, if you want \", \"to replace your entire old Ul for WinUI,\\nyour app shouldn't load Ul Frameworks for just hosting WinU\", \"I.\\n\\nWinUI 3 will address this critical feedback adding WinUI in desktop apps. This will allow that W\", \"in32\\napps can use WinUI 3 as standalone UI Framework; no need to load Windows Forms or WPF.\\n\\nWithin \", \"this aggregation, WinUI 3 will let developers easily mix and match the right combination of:\\n\\nApp mo\", \"del: UWP, Win32\\n\\nPlatform: .NET or Native\\n\\nLanguage: .NET (C#, Visual Basic), standard C++\\n\\nPackagin\", \"g: MSIX, AppX for the Microsoft Store, unpackaged\\n\\nInterop: use WinUI 3 to extend existing WPF, WinF\", \"orms, and MFC apps using WinUI XAML\\nIslands.\\n\\nIf you want to know more details, Microsoft is sharing\", \" this roadmap in\\n\\nhttps://github.com/microsoft/microsoft-ui-xaml/blob/main/docs/roadmap.md.\\n\\n40\\n\\nCHA\", \"PTER 4 | Windows 10 migration\\nCHAPTER 5\\n\\nExample of migrating to\\nthe latest .NET\\n\\nIn this chapter, w\", \"e'll show how to migrate your applications to the latest version of .NET. You can\\nmigrate to .NET 7 \", \"from .NET Framework, .NET Core, or .NET 5. We'll introduce a tool that can do all the\\nwork for you i\", \"n most cases. If your application has special cases or complicated dependencies, we'll\\nalso show how\", \" to do the whole migration process by hand. Additionally, we'll cover the most common\\nissues and cha\", \"llenges you can face when migrating an existing application from .NET Framework to\\n.NET.\\n\\nMigrating \", \"from .NET Core or .NET 5\\n\\nUpdating your applications to target the latest version of .NET is easy if\", \" you already are on .NET Core\\nor .NET 5. If this is the case, then in Visual Studio, simply right-cl\", \"ick on your project in Solution\\nExplorer and choose Properties. Under Application > General > Target\", \" framework, choose .NET\\n7.0. Save and rebuild your application. You're done! Your app now runs on th\", \"e latest version of .NET.\\nIn the future when new versions become available, you can upgrade in the s\", \"ame way.\\n\\nAl CHAPTER 5 | Example of migrating to the latest .NET\\nSearch properties\\n\\n4 Application . \", \".\\nApplication\\nGeneral\\nWin32 Resources\\nPackaging General Output type\\n\\u00bb Global Usings Specifies the ty\", \"pe of application to build.\\n| Windows Application .\\nb Build\\nb Package\\n& Target framework \\u00a9\\nb Code An\", \"alysis Specifies the version of .NET that the application targets. This option can have different va\", \"lues\\ndepending on which versions of .NET are installed on your computer.\\nb Debug NET 6.0 |\\nb Resourc\", \"es .NET 5.0\\n|\\nb Settings \\u2018LNETOO\\nNET 7.0\\n-NET Core 3.0\\nNET Core 3.1\\nWindows *\\n\\nMigrating from .NET F\", \"ramework\\n\\nMigrating from .NET Framework is a more complicated process because there are more differe\", \"nces\\nbetween .NET Framework and other platforms that were built on top of .NET Core. But the good ne\", \"ws\\nis that there\\u2019s a tool that will do all the work for you in most cases.\\n\\nMigrating with a tool\\n\\nT\", \"he Upgrade Assistant is a migration tool. Using it is easy and there are step-by-step instructions\\na\", \"vailable on the .NET website. In this chapter, we'll look at what is happening behind the scenes and\", \"\\nhow to port your application by hand. When the Upgrade Assistant is unable to migrate your\\napplicat\", \"ion, you'll learn the underlying mechanics so that you might be able to migrate manually.\\n\\nMigrating\", \" by hand\\nThe migration process consists of four sequential steps:\\n\\n1. Preparation: Understand the de\", \"pendencies the project has to have an idea of what's ahead.\\nIn this step, you take the current proje\", \"ct into a state that simplifies the startup point for the\\nmigration.\\n\\n2. Migrate Project File: .NET \", \"projects use the new SDK-style project format. Create a new\\nproject file with this format or update \", \"the one you have to use the SDK style.\\n\\n3. Fix code and build: Build the code in .NET addressing API\", \"-level differences between .NET\\nFramework and .NET. If needed, update third-party packages to the on\", \"es that support .NET.\\n\\n42 CHAPTER 5 | Example of migrating to the latest .NET\\n4.  Runand test: There\", \" might be differences that don\\u2019t show up until run time. So, don\\u2019t forget\\nto run the application and\", \" test that everything works as expected.\\n\\nPreparation\\n\\nMigrate packages.config file\\n\\nIn a .NET Frame\", \"work application, all references to external packages are declared in the\\npackages.config file. In .\", \"NET, there\\u2019s no longer the need to use the packages.config file. Instead, use the\\nPackageReference p\", \"roperty inside the project file to specify the NuGet packages for your app.\\n\\nSo, you need to transit\", \"ion from one format to another. You can do the update manually, taking the\\ndependencies contained in\", \" the packages.config file and migrating them to the project file with the\\nPackageReference format. O\", \"r, you can let Visual Studio do the work for you: right-click on the\\npackages.config file and select\", \" the Migrate packages.config to PackageReference option.\\n\\nVerify every dependency compatibility in .\", \"NET\\n\\nOnce you've migrated the package references, you must check each reference for compatibility. Y\", \"ou\\ncan explore the dependencies of each NuGet package your application is using on nuget.org. If the\", \"\\npackage has .NET Standard dependencies, then it's going to work on .NET 7 because .NET supports all\", \"\\nversions of .NET Standard. The following image shows the dependencies for the Castle.Windsor\\npackag\", \"e:\\n\\nBa | \\u2018@ NuGet Gallery| Castlev X | \\u2014- v = oa x\\n\\n< \\u2018.) @ Not secure www.nuget.org * b \\u00a3 @\\n\\nrv.) n\", \"uget Packages\\n\\nCastle.Windsor soo Info\\n\\nCastle Windsor\\n\\nD last updated 4 months ago\\n\\nCastle Windsor \", \"is best of breed, mature Inversion of Control container available for .NET. @\\u00ae Project Site\\n\\nietrcae\", \"ierime .NETCLI PackageReference Paket CLI \\u00a9 Source repository\\n\\nY Dependencies\\n\\n\\u201c@ Download package (\", \"415.32 KB)\\n-NETFramework 4.5\\nStatistics\\n\\n.NETStandard 1.6\\n\\ntl (>= 431 \\u00a3 5.671.279 total downloads\\n\\nM\", \"icrosoft.Extensions.DependencyModel (>= 1.1.2 fh 71.308 downloads of current\\nNETStandard.Library (>=\", \" 1.6.1) version\\n\\nSystem.Runtime Serialization.Formatters (>= 4.3.0 @i 1.842 downloads per day (avg)\\n\", \"\\nView full stats\\n\\nY Version History Owners\\n\\nTo check the package compatibility, you can use the tool\", \" https://fuget.org that offers a more detailed\\ninformation about versions and dependencies.\\n\\nMaybe t\", \"he project is referencing older package versions that don\\u2019t support .NET, but you might find\\nnewer v\", \"ersions that do support it. So, updating packages to newer versions is generally a good\\n\\n43 CHAPTER \", \"5 | Example of migrating to the latest .NET\\nrecommendation. However, you should consider that updati\", \"ng the package version can introduce\\nsome breaking changes that would force you to update your code.\", \"\\n\\nWhat happens if you don't find a compatible version? What if you just don\\u2019t want to update the\\nver\", \"sion of a package because of these breaking changes? Don't worry because it's possible to depend\\non \", \".NET Framework packages from a .NET application. Don't forget to test it extensively because it can\\n\", \"cause run-time errors if the external package calls an API that isn\\u2019t available on .NET. This is gre\", \"at for\\nwhen you're using an old package that isn't going to be updated and you can just retarget to \", \"work on\\n.NET.\\n\\nCheck for API compatibility\\n\\nSince the API surface in .NET Framework and .NET is simi\", \"lar but not identical, you must check which\\nAPIs are available on .NET and which aren't. You can use\", \" the .NET Portability Analyzer tool to surface\\nAPIs used that aren't present on .NET. It looks at th\", \"e binary level of your app, extracts all the APIs that\\nare called, and then lists which APIs aren't \", \"available on your target framework (.NET 7 in this case).\\n\\nYou can find more information about this \", \"tool at:\\n\\nhttps://learn.microsoft.com/dotnet/standard/analyzers/portability-analyzer\\n\\nAn interesting\", \" aspect of this tool is that it only surfaces the differences from your own code and not\\ncode from e\", \"xternal packages, which you can't change. Remember you should have updated most of\\nthese packages to\", \" make them work with .NET.\\n\\nMigrate\\n1. Create the new .NET project\\n\\nIn most cases, you'll want to up\", \"date your existing project to the new .NET format. However, you can\\nalso create a new project while \", \"maintaining the old one. The main drawback from updating the old\\nproject is that you lose designer s\", \"upport, which may be important to you and your development\\nteam. If you want to keep using the desig\", \"ner, you must create a new .NET project in parallel with the\\nold one and share assets. If you need t\", \"o modify Ul elements in the designer, you can switch to the old\\nproject to do that. And since assets\", \" are linked, they'll be updated in the .NET project as well.\\n\\nThe SDkK-style project for .NET is a l\", \"ot simpler than .NET Framework\\u2019s project format. Apart from the\\npreviously mentioned PackageReferenc\", \"e entries, you won't need to do much more. The new project\\nformat includes files with certain extens\", \"ions by default, such as .cs and .xaml files, without the need to\\nexplicitly include them in the pro\", \"ject file.\\n\\nAssemblyInfo considerations\\n\\nAttributes are autogenerated on .NET projects. If the proje\", \"ct contains an Assemblyinfo.cs file, the\\ndefinitions will be duplicated, which will cause compilatio\", \"n conflicts. You can delete the older\\nAssemblyInfo.cs file or disable autogeneration by adding the f\", \"ollowing entry to the .NET project file:\\n\\n<Project Sdk=\\\"Microsoft.NET.Sdk\\\">\\n<PropertyGroup>\\n<Generat\", \"eAssemblyInfo>false</GenerateAssemblyInfo>\\n\\n44 CHAPTER 5 | Example of migrating to the latest .NET\\n<\", \"/PropertyGroup>\\n</Project>\\n\\nResources\\n\\nEmbedded resources are included automatically but resources a\", \"ren't, so you need to migrate the\\nresources to the new project file.\\n\\nPackage references\\n\\nWith the M\", \"igrate packages.config to PackageReference option, you can easily move your external\\npackage referen\", \"ces to the new format as previously mentioned.\\n\\nUpdate package references\\n\\nUpdate the versions of th\", \"e packages you've found to be compatible, as shown in the previous section.\\n\\nFix the code and build\\n\", \"\\nMicrosoft.Windows.Compatibility\\n\\nIf your application depends on APIs that aren't available on .NET,\", \" such as Registry or ACLs, you have\\nto include a reference to the Microsoft.Windows.Compatibility pa\", \"ckage to add these Windows-\\nspecific APIs. They work on .NET but aren't included as they aren't cros\", \"s-platform.\\n\\nThere\\u2019s a tool called Platform compatibility analyzer\\n\\n(https://learn.microsoft.com/dot\", \"net/standard/analyzers/platform-compat-analyzer) that helps you\\nidentify APIs that aren\\u2019t compatible\", \" with your code.\\n\\nUse #if directives\\n\\nIf you need different execution paths when targeting .NET Fram\", \"ework and .NET, you should use\\ncompilation constants. Add some #if directives to your code to keep t\", \"he same codebase for both\\ntargets.\\n\\nTechnologies not available on .NET\\n\\nSome technologies aren't ava\", \"ilable on .NET, such as:\\n\\n. AppDomains\\n\\n. Remoting\\n\\n. Code Access Security\\n. Windows Workflow\\n\\nThat'\", \"s why you need to find a replacement for these technologies if you're using them in your\\n\\napplicatio\", \"n. For more information, see the .NET Framework technologies unavailable on .NET Core and\\n.NET 5+ ar\", \"ticle.\\n\\n45 CHAPTER 5 | Example of migrating to the latest .NET\\nRegenerate autogenerated clients\\n\\nIf \", \"your application uses autogenerated code, such as a WCF client, you may need to regenerate this\\ncode\", \" to target .NET. Sometimes, you can find some missing references since they may not be included\\nas p\", \"art of the default .NET assemblies set. Using a tool like https://apisof.net/, you can easily locate\", \"\\nthe assembly the missing reference lives in and add it from NuGet.\\n\\nRolling back package versions\\n\\n\", \"As a general rule, we've previously stated that you better update every single package version to be\", \"\\ncompatible with .NET. However, you can find that targeting an updated and compatible version of an\\n\", \"assembly just doesn\\u2019t pay off. If the cost of change isn't acceptable, you can consider rolling back\", \"\\npackage versions keeping the ones you use on .NET Framework. Although they may not be targeting\\n.NE\", \"T, they should work well unless they call some unsupported APIs.\\n\\nRun and test\\n\\nOnce you have your a\", \"pplication building with no errors, you can start the last step of the migration by\\ntesting every fu\", \"nctionality.\\n\\nIn this final step, you can find several different issues depending on the complexity \", \"of your application\\nand the dependencies and APIs you're using.\\n\\nFor example, if you use configurati\", \"on files (app.config), you may find some errors at run time like\\nConfiguration Sections not present.\", \" Using the Microsoft.Extensions.Configuration NuGet package\\nshould fix that error.\\n\\nAnother reason f\", \"or errors is the use of the BeginInvoke and EndInvoke methods because they aren't\\nsupported on .NET.\", \" They aren't supported on .NET because they have a dependency on Remoting,\\nwhich doesn't exist on .N\", \"ET. To solve this issue, try to use the await keyword (when available) or the\\nTask.Run method.\\n\\nYou \", \"can use compatibility analyzers to let you identify APIs and code patterns in your code that can\\n\\npo\", \"tentially cause problems at run time with .NET. Go to https://github.com/dotnet/platform-compat\\n\\nand\", \" use the .NET API analyzer on your project.\\n\\nMigrating a Windows Forms application\\n\\nTo showcase a co\", \"mplete migration process of a Windows Forms application, we've chosen to migrate\\n\\nthe eShop sample a\", \"pplication available at https://github.com/dotnet-\\narchitecture/eShopModernizing/tree/master/eShopLe\", \"gacyNTier/src/eShopWinForms. You can find\\nthe complete result of the migration at https://github.com\", \"/dotnet-\\narchitecture/eShopModernizing/tree/master/eShopModernizedNTier/src/eShopWinForms.\\n\\nThis app\", \"lication shows a product catalog and allows the user to navigate, filter, and search for\\nproducts. F\", \"rom an architecture point of view, the app relies on an external WCF service that serves as\\na facade\", \" to a back-end database.\\n\\nYou can see the main application window in the following picture:\\n\\n46 CHAP\", \"TER 5 | Example of migrating to the latest .NET\\na eShop WinForms - o x\\n\\nle} SRCONTAINERS\\n\\nMain Catal\", \"og Inventory\\n\\nType fa] \\u201c| Brand a\\n\\nDescription\\n\\nf\\n| 3 12 Cup<T> TShirt Cup<T> Tshirt $12,00\\n\\nCup<T>\\n\", \"\\nO Escribe aqui para buscar G\\n\\neShopWinForms.csproj #\\n1 = <?xml version=\\\"1.0\\\" encoding=\\u201cutf-8\\\"?>\\n2 4\", \"<Project ToolsVersion=\\\"15.0\\\" xmlns=\\\"http://schemas microsoft .com/developer/msbuild/2@@3\\\">\\n<Import P\", \"roject=\\\"$(MSBuildExtensionsPath)\\\\$(MSBuildToolsVersion)\\\\Microsoft.Common.props\\u201d Condition=\\\"Exists('$\", \"(MSBuildExtensionsPath)\\n\\n4 4 <PropertyGroup>\\n\\n5 <Configuration Condition=\\\"_ '$(Configuration)' == ''\", \" \\\">Debug</Configuration>\\n\\n6 <Platform Condition=\\\" '$(Platform)' ** \\u201cSaAnyCPu</Platform>\\n\\n7 <ProjectG\", \"uid>{AE32989C - 9EE6-4ECE-B407-D23A15A1FEED}</ProjectGuid>\\n\\n8 <OutputType>WinExe< /OutputType> -\\n\\n9 \", \"<RootNamespace>eShopWinForms< /RootNamespace>\\n18 <Assemb 1 yName>eShopWinForms</AssemblyName>\\n11 <Ta\", \"rgetFrameworkVersion>v4.7</TargetFrameworkVersion>\\n12 <FileAlignment >512</FileAlignment > -\\n13 <Aut\", \"oGenerateBindingRedirects>true</AutoGenerateBindingRedirects> \\u2014\\n14 <TargetFrameworkProfile /> =\\n15 <\", \"PublishUr1>publish\\\\</PublishUrl> \\u2014\\n16 <Install>true</Install> oe\\n17 <InstallFrom>Disk</InstallFrom> \", \"===\\n18 <UpdateEnabled>false</UpdateEnabled> \\u2014\\u2014\\u2014\\u2014s\\n19 <UpdateMode>Foreground< /UpdateMode> =\\n26 <Upda\", \"teInterval>?</UpdateInterval> ==\\n21 <UpdateIntervalUnits>Days</UpdateIntervalUnits> Lene\\n22 <UpdateP\", \"eriodically>false</UpdatePeriodically> =\\n23 <UpdateRequired>false</UpdateRequired> Dnt\\n24 <MapFileEx\", \"tensions>true</MapFileExtensions> ae\\n25 <ApplicationRevision>@</ApplicationRevision> ct\\n26 <Applicat\", \"ionVersion>1.0.0.%2a</ApplicationVersion> tome.\\n27 <IsWebBoot strapper>false</IsWebBootstrapper> \\u2014~\\n\", \"28 <UseApplicationTrust>false</UseApplicationTrust> ==\\n29 <BootstrapperEnabled>true</BootstrapperEna\", \"bled> \\u2014\\n30 </PropertyGroup> \\u2014\\n31 4 <PropertyGroup Condition=\\\" \\u2018$(Configuration)|$(Platform)' == \\\"Deb\", \"ug|AnyCPU' \\u201c> \\u2014\\u2014\\n32 <PlatformTarget >AnyCPU< /PlatformTarget> =\\u2014_\\u2014\\n33 <DebugSymbols>true< /DebugSymb\", \"ols> all\\n34 <Debuglype>full</Debuglype> \\u2014\\n35 <Optimize>false</Optimize>\\n\\n36 <OutputPath>bin\\\\Debug\\\\< \", \"/OutputPath>\\n37 <DefineConstants>DEBUG; TRACE</DefineConstants>\\n\\n38 <ErrorReport >prompt</ErrorRepor\", \"t>\\n39 <WarningLevel>4</WarnineLevel>\\n100% * \\u00a9 No issues found 4 >\\n\\nAs previously mentioned, a .NET p\", \"roject has a more compact style and you need to migrate the\\nproject structure to the new .NET SDK st\", \"yle.\\n\\nIn Solution Explorer, right-click on the Windows Forms project and select Unload Project > Edi\", \"t.\\n\\nNow you can update the .csproj file. You'll delete the entire contents and replace it with the f\", \"ollowing\\ncode:\\n\\n<Project Sdk=\\\"Microsoft.NET.Sdk\\\">\\n<PropertyGroup>\\n<OutputType>WinExe< /OutputType>\\n<\", \"TargetFramework>net7.0-windows</TargetFramework>\\n<UseWindowsForms>true</UseWindowsForms >\\n<GenerateA\", \"ssemblyInfo>false</GenerateAssemblyInfo>\\n\\n47 CHAPTER 5 | Example of migrating to the latest .NET\\n</P\", \"ropertyGroup>\\n</Project>\\n\\nSave and reload the project. You're now done updating the project file and\", \" the project is targeting\\n.NET 7.\\n\\nIf you compile the project at this point, you'll find some errors\", \" related to the WCF client reference.\\nSince this code is autogenerated, you must regenerate it to ta\", \"rget .NET.\\n\\nEntire Solution bd iT) 120 Errors ic O Warnings | \\u00a9 0 Messages ad Build + IntelliSense ,\", \" Search Error List --\\n\\u201c Code Description Project File Line SuppressionSt.. Yo +\\nrx) CS0234 The type \", \"or namespace name \\u2018ServiceContractAttributeAttribute\\u2019 does not exist in the namespace \\u2018System.Servic\", \"eModel' (are you missing an assembly reference?) eShopWinForms Reference.cs 498 Active\\nrx) CS0234 Th\", \"e type or namespace name \\u2018ServiceContractAttribute\\u2019 does not exist in the namespace \\u2018System.ServiceM\", \"odel' (are you missing an assembly reference?) eShopWinForms Reference.cs 498 Active\\n\\u20ac (50246 The ty\", \"pe or namespace name \\u2018ConfigurationName\\u2019 could not be found (are you missing a using directive or an\", \" assembly reference?) eShopWinForms Reference.cs 498 Active\\nx] CS0234 The type or namespace name \\u2018Op\", \"erationContractAttributeAttribute\\u2019 does not exist in the namespace \\u2018System.ServiceModel' (are you mi\", \"ssing an assembly reference?) eShopWinForms Reference.cs 501 Active\\n\\u20ac} (S0234 The type or namespace \", \"name \\u2018OperationContractAttribute\\u2019 does not exist in the namespace \\u2018System.ServiceModel\\u2019 (are you mis\", \"sing an assembly reference?) eShopWinForms Reference.cs 501 Active\\n\\nThe type name \\u2018Action\\u2019 could not\", \" be found in the namespace \\u2018System\\u2019. This type has been forwarded to assembly \\u2018System.Runtime, Versi\", \"on=4,2.1.0, Culture=neutral,\\n\\n8 Ca1069 PublicKeyToken=b03f5f7f11d50a3a' Consider adding a reference \", \"to that assembly. Shop Winkorms SSE Ste ine\\noe CS0246 The type or namespace name \\u2018ReplyAction\\u2019 could\", \" not be found (are you missing a using directive or an assembly reference?) eShopWinforms Reference.\", \"cs 501 Active\\nix] CS0234 The type or namespace name \\u2018OperationContractAttributeAttribute\\u2019 does not e\", \"xist in the namespace System.ServiceModel\\u2019 (are you missing an assembly reference?) eShopWinForms Re\", \"ference.cs 504 Active\\nrx) CS0234 The type or namespace name \\u2018OperationContractAttribute\\u2019 does not ex\", \"ist in the namespace \\u2018System.ServiceModel\\u2019 (are you missing an assembly reference?) eShopWinforms Re\", \"ference.cs 504 Active\\n\\u00b0 51069 Hesse speuliraives a9 oon sich 7 aaa clea Sanne fone se been forwarded\", \" to assembly \\u2018System.Runtime, Version=4.2.1.0, Culture=neutral, eShopWinForms endsilichts 504 Active\", \"\\n\\u20ac S0246 The type or namespace name \\u2018ReplyAction\\u2019 could not be found (are you missing a using direct\", \"ive or an assembly reference?) eShopWinForms Reference.cs 504 Active\\n\\nDelete the Reference.cs file a\", \"nd generate a new Service Client.\\n\\nRight-click on Connected Services and select the Add Connected Se\", \"rvice option.\\n\\nSs\\n\\n{H-\\\\o-5a@ s\\u2014 3\\nSearch Solution Explorer (Ctrl+\\\") fr 5\\nfa] Solution \\u2018eShopLegacyNt\", \"lier (2 of 2 projects) a\\\")\\n> 2] eShopWCFService 3\\ni eShopWinForms Be\\n\\nCp qnnercted Senirces\\n# Pro * \", \"Add Connected Service\\nP| Ac)\\n\\nme Cc\\n\\u00ae He New Solution Explorer View\\n\\n\\u00a5\\n\\nScope to This\\n\\nFF YF Ye\\n\\n\\u00a9 V\", \"ie C Open Folder in File Explorer\\n#) Ar \\u00a57\\na) ap\\n#_) packages.config\\n> c* Program.cs\\n\\nProperties Alt\", \"+Enter\\n\\nThe Connected Services window opens. Select the Microsoft WCF Web Service option.\\n\\n48 CHAPTE\", \"R 5 | Example of migrating to the latest .NET\\ni | File Edit View Project Build Debug Test Analyze To\", \"ols Extensions Window Help Search Visual Studio (Ctrl+Q) ? eShopLegacyNTier\\n=@-O) 8-2 Wey) O-CO ~) D\", \"ebug ~ AnycPu + D IIS Express (Google Chrome) - G >| BH 5\\n\\nConnected Services = Connected Services\\n\\n\", \"Publish Add code and dependencies for one of these services to your application\\n\\nCloud Storage with \", \"Azure Storage\\n\\nStore and access data with Azure Storage using blobs, queues, or tables.\\n\\nMicrosoft W\", \"CF Web Service Reference Provider\\n\\ng\\nAdd a WCF web sery~ \\u2014\\u2014 ;\\nAdd a WCF web service reference to you\", \"r project.\\n\\nFind more services...\\n\\nIf you have the WCF Service in the same solution as we have in th\", \"is example, you can select the\\nDiscover option instead of specifying a service URL.\\n\\nSpecify the ser\", \"vice to add\\n\\nge Configure WCF Web Service Reference\\n\\nTo see a list of available services on a specif\", \"ic server, enter a service URL and select Go. To find available\\nservices in the solution, select Dis\", \"cover. To load a service metadata from a WSDL file, select Browse.\\n\\nURI:\\n\\nService Endpoint\\n\\nData Typ\", \"e Options\\n\\nClient Options\\n\\nGo Discover Browse...\\n\\nServices: Operations:\\n\\nStatus:\\n\\nNamespace:\\n\\nServic\", \"eReference1\\n\\nMore Information < Prev Next > Finish Cancel\\n\\nOnce the service is located, the tool ref\", \"lects the API contract implemented by the service. Change the\\nname of the namespace to be eShopServi\", \"ceReference as shown in the following image:\\n\\n49 CHAPTER 5 | Example of migrating to the latest .NET\", \"\\n& x\\n\\nConfigure WCF Web Service Reference\\n\\nGZ Specify the service to add\\n\\nService Endpoint\\n\\nData Typ\", \"e Options\\n\\nClient Options\\n\\nTo see a list of available services on a specific server, enter a service\", \" URL and select Go. To find available\\nservices in the solution, select Discover. To load a service m\", \"etadata from a WSDL file, select Browse.\\n\\nURI:\\n\\n| http://localhost:623 14/CatalogService.svc bal\\nSto\", \"p\\nServices: Operations:\\n4 3 CatalogService \\u00a9 FindCatalogitem -\\n*\\u00a9 |CatalogService @ GetCatalogBrands\", \"\\n\\n\\u00a9 GetCatalogltems\\n@ GetCatalogTypes\\n\\u00a9 GetAvailableStock\\n\\n= se om,\\n\\nStatus:\\n\\nNamespace:\\n\\neShopServi\", \"ceReference\\nMore Information Next > Cancel\\n\\nSelect the Finish button. After a while, you'll see the \", \"generated code.\\n\\nYou should see three autogenerated files:\\n\\n1. Getting Started: a link to GitHub to \", \"provide some information on WCF.\\n\\n2. ConnectedService.json: configuration parameters to connect to t\", \"he service.\\n\\n3. Reference.cs: the actual WCF client code.\\n\\n50\\n\\nCHAPTER 5 | Example of migrating to t\", \"he latest .NET\\n@m-|o-sqag|\\\\|sr-\\nSearch Solution Explorer (Ctrl+\\\")\\nfa] Solution \\u2018eShopLegacyNtlier (2\", \" of 2 projects)\\na eShopWinForms\\n4 & Connected Services\\n4 \\u00a9 eShopServiceReference\\nGetting Started\\n\\u00a3J \", \"ConnectedServicejson\\n> c*\\u00ae Reference.cs\\n\\nUONEINON\\n\\ni\\n\\nc\\n\\naiuiedold\\n\\ni\\n\\nc\\n\\non Dependencies\\nJ Properti\", \"es\\n\\n1) Assets\\n\\n!) Controllers\\n\\n1) Helpers\\n\\n1 Views\\n\\n?) App.contig\\n\\nasi app.manifest\\n\\u00a2_. packages.con\", \"tig\\nc* Program.cs\\n\\nSolution Explorer\\n\\nIf you compile again, you'll see many errors coming from .cs f\", \"iles inside the Helper folder. This folder\\nwas present in the .NET Framework version but not include\", \"d in the old .csproj. But with the new SDK-\\nstyle project, every code file present underneath the pr\", \"oject file location is included by default. That is,\\nthe new .NET Core project tries to compile the \", \"files inside the Helper folder. Since that folder isn't\\nneeded, you can safely delete it.\\n\\nIf you co\", \"mpile the project again and execute it, you won't see the product images. The problem is that\\nnow th\", \"e path to the files has slightly changed. To fix this issue, you need to add another level of depth\\n\", \"in the path, updating in the file CatalogView.cs the line:\\n\\n51 CHAPTER 5 | Example of migrating to t\", \"he latest .NET\\nstring image name = Environment.CurrentDirectory +\\n\\\"\\\\\\\\..\\\\\\\\..\\\\\\\\Assets\\\\\\\\Images\\\\\\\\Catalog\", \"\\\\\\\\\\\" + catalogiItems.Picturefilename;\\n\\nto\\n\\nstring image name = Environment.CurrentDirectory +\\n\\\"\\\\\\\\..\\\\\\\\\", \"..\\\\\\\\..\\\\\\\\Assets\\\\\\\\Images\\\\\\\\Catalog\\\\\\\\\\\" + catalogItems.Picturefilename;\\n\\nAfter this change, you can check\", \" that the application launches and runs as expected on .NET 7.\\n\\nMigrating a WPF application\\n\\nWe'll u\", \"se the Shop.ClassicWPF sample application to perform the migration. The following image\\nshows a scre\", \"enshot of the app before migration:\\n\\n&' eShop - Classic WPF Sample \\u2014 L] x\\nSearch Catalog Type Fe re)\", \" [a] ire} alog Brand\\nView All ew All \\u00a5\\n\\nMicrosoft Azure Black Cap\\nCap\\nAzure\\n\\nMicrosoft Azure Black M\", \"ug\\nMug\\nAzure\\n\\nMicrosoft Azure Black T-Shirt\\nT-Shirt\\nAzure\\n\\nMicrosoft Azure Blue Cap\\nCap\\nAzure\\n\\nMicro\", \"soft Azure Blue Mug\\nMug\\nAzure\\n\\nThis application uses a local SQL Server Express database to hold the\", \" product catalog information.\\nThis database is accessed directly from the WPF application.\\n\\nFirst, y\", \"ou must update the .csproj file to the new SDK style used by .NET Core applications. You'll\\nfollow t\", \"he same steps described in the Windows Forms migration: you'll unload the project, open the\\n.csproj \", \"file, update its contents, and reload the project.\\n\\nIn this case, delete all the content of the .csp\", \"roj file and replace it with the following code:\\n\\n52 CHAPTER 5 | Example of migrating to the latest \", \".NET\\n<Project Sdk=\\\"Microsoft.NET.Sdk\\\">\\n<PropertyGroup>\\n<OutputType>WinExe< /OutputType>\\n<TargetFrame\", \"work>net7.0-windows</TargetFramework>\\n\\n<UseWpf>true</UseWpf >\\n<GenerateAssemblyInfo>false</GenerateA\", \"ssemblyInfo>\\n</PropertyGroup>\\n</Project>\\n\\nIf you reload the project and compile it, you'll get the f\", \"ollowing error:\\n\\nError List\\nEntire Solution A OWarnings \\u00a9 0 Messages Build Only a\\n\\u201d Code Description\", \"\\n\\nThe type or namespace name \\u2018Sq|Provider' does not exist in the namespace \\u2018eShop\\u2019 (are you missing \", \"an assembly\\n\\n\\u00a9 cs0234 reference?)\\n\\nSince you've deleted all the .csproj contents, you've lost a proj\", \"ect reference specification present in the\\nold project. You just need to add this line to the .cspro\", \"j file to include the project reference back:\\n\\n<ItemGroup>\\n\\n<ProjectReference Include=\\\"..\\\\\\\\eShop.Sql\", \"Provider\\\\\\\\eShop.SqlProvider.csproj\\\" />\\n<ItemGroup>\\n\\nYou can also let Visual Studio help you by right\", \"-clicking on the Dependencies node and selecting\\nAdd Project Reference. Select the project from the \", \"solution and select OK:\\n\\n53 CHAPTER 5 | Example of migrating to the latest .NET\\nReference Manager - \", \"eShop.ClassicWPF\\n\\n4 Projects\\nSolution\\n\\nb Shared Projects\\n\\n> Browse\\n\\nSearch (Ctrl+E) P-\\nName Path oe\\n\", \"eShop.Server E\\\\\\\\ModernizeAppsNET..._ eShop.Sq|Provider\\n\\neShop.SqIProvider E:\\\\ModernizeAppsNET...\\neSh\", \"op.UWP E:\\\\ModernizeAppsNET...\\n\\nBrowse... Cancel\\n\\nOnce you add the missing project reference, the app\", \"lication compiles and runs as expected on .NET.\\n\\n54\\n\\nCHAPTER 5 | Example of migrating to the latest \", \".NET\\nCHAPTER\\n\\nDeploying Modern\\nDesktop Applications\\n\\nWhen you develop desktop applications, one thin\", \"g to consider is how your application is going to be\\npackaged and deployed to the users\\u2019 machines. T\", \"he problem with packaging, deployment, and\\ninstallation is that it usually falls under the umbrella \", \"of the IT professionals, who care about different\\nthings than developers.\\n\\nThese days, we're all fam\", \"iliar with the DevOps concept, where developers and IT Pros work closely to\\nmove applications to the\", \"ir production environments. But if you've been in the desktop battle for more\\nthan 10 years, you mig\", \"ht have seen the following story. A team of developers works together hard to\\nmeet the project deadl\", \"ines. Business people are nervous since they need the system working on many\\nusers\\u2019 machines to run \", \"the company. On \\u201cD-Day\\u201d, the project manager checks with every developer\\nthat their code is working \", \"well and that everything is fine, so they can ship. Then, the package team\\ncomes in generating the s\", \"etup for the app, distribute it to every user machine and a set of test users\\nrun the application. W\", \"ell, they try, because before showing any Ul, the application throws an\\nexception that says \\u201cMethod \", \"~ of object ~ failed\\u201d. Panic starts flowing through the air and a brief\\ninvestigation points to a yo\", \"ung and tired developer that has introduced a third-party control, that\\ncertainly \\u201cworked on the dev\", \" machine\\u201d.\\n\\nInstalling desktop applications have traditionally been a nightmare for two main reasons\", \":\\n\\n\\u00b0 Lack of close collaboration culture between dev and IT teams.\\n\\n\\u00b0 Lack of a solid packaging and \", \"deploying technology we can build upon.\\n\\nIn fact, we've been living with the fact that sometimes you\", \" regret that you installed an app because:\\n. It ends up having some undesired side effects on your m\", \"achine.\\n. Some applications that were previously installed stop working.\\n\\nAdditionally, you can\\u2019t ju\", \"st restore the system to its original state by uninstalling the app. We're so\\nused to living with th\", \"is situation that we've coined terms like \\u201cDLL Hell\\u201d or \\u201cWinrot\\u201d.\\n\\nIn this chapter, we'll talk about\", \" MSIX. MSIX is the new technology from Microsoft that tries to capture\\nthe best of previous technolo\", \"gies to provide a solid foundation for the packaging technology of the\\nfuture.\\n\\nWhat does a packagin\", \"g technology have to do with modernization? Well, it turns out that packaging\\nis fundamental for the\", \" enterprise IT with lots of money invested there. Modernization isn't only related\\n\\n55 CHAPTER 6 | D\", \"eploying Modern Desktop Applications\\nto using the latest technologies. It's also related to reducing\", \" time to market from the moment a\\nbusiness requirement is defined until your company delivers the fe\", \"ature to your client.\\n\\nThe modern application lifecycle\\n\\nToday, developers write and build the code \", \"for an app and then pass the generated assets to the IT\\nPros. Then, the IT Pros reconfigure the app \", \"and repackage it, typically in an MSI or more recently in an\\nApp-V packaging format. The app is then\", \" deployed through different channels and tools. One of the\\nmain problems with this approach is commo\", \"nly known as \\u201cpackaging paralysis\\u201d. The problem is that\\nthis cycle repeats every time there's an app\", \" update or an OS update.\\n\\nYou can see the process reflected on the following picture:\\n\\nModern IT: Ap\", \"plication Lifecycle Today\\n\\nDeveloper IT Pro\\n7 (Re)Package to\\n. Microsoft Microsoft\\nVisual\\nStudio App\", \"-V Intune\\nCustom Tools for System Center\\nMSI Configuration Manager\\n\\nRepeat IT Pro repackaging for ev\", \"ery OS and App update\\n\\nCompanies need a way to break this packaging cycle into three independent cyc\", \"les:\\n\\n. OS updates\\n. Application updates\\n\\n\\u00b0 Customization\\n\\n56 CHAPTER 6 | Deploying Modern Desktop A\", \"pplications\\nMicrosoft Store Microsoft Store\\nor any CDN for Business\\nor Mgmt Server\\n\\nAuto IT\\nUpdate C\", \"ustomize\\n\\nCustomization\\n\\nApp\\nUpdate iT\\nCustomize\\n\\nModern IT\\n\\nThe previous diagram shows that you can\", \":\\n\\n. Update the underlying OS without having to repackage your apps.\\n\\n. Enable customizations from I\", \"T without the need to repackage the original developer package.\\n\\nThis radical change leads us to the\", \" new and modern IT lifecycle as shown in the following picture:\\n\\n57 CHAPTER 6 | Deploying Modern Des\", \"ktop Applications\\nModern IT: Application Lifecycle\\n\\nDeveloper IT Pro\\nCreate Package Configure\\nVisual\", \" | Tools | | Microsoft Store |\\nfor Business\\n\\nStudio MSIX\\n\\nMicrosoft Intune\\n\\nDevelopers create the ap\", \"p and generate an MSIX package that IT Pros can consume and configure\\nwithout the need of repackagin\", \"g. Along with the MSIX technology, Microsoft has created tools to\\nallow IT to customize and configur\", \"e packages without repackaging.\\n\\nMSIX: The next generation of deployment\\n\\nBefore MSIX, there were se\", \"veral packaging technologies available like setup wizards, MSI, ClickOnce,\\nApp-V, and scripting. Eac\", \"h of these technologies has their own strengths and Microsoft has decided\\nto pick the best of all to\", \" build MSIX. MSIX is built on the foundations of these existing technologies\\npicking the best of eac\", \"h:\\n\\n. App-V => Containerization\\n. ClickOnce => Auto updating\\n. MSI => Easy to distribute\\n\\nWith MSIX,\", \" you get one installer technology with all these features.\\n\\n58 CHAPTER 6 | Deploying Modern Desktop \", \"Applications\\nrn ClickOnce\\n\\u00a5 a)\\n\\nM S i\\n\\nApplication\\nVirtualization\\n\\ns\\n\\nscript.vbs\\n\\nsetup.exe\\n\\nMSIX\\n\\nB\", \"enefits of MSIX\\n\\nNever regret installing an app\\n\\nMSIX provides a predictable, reliable, and safe dep\", \"loyment. The declarative method contained in the\\npackage manifest lets the OS keep track of every as\", \"set your application needs. It also provides a true\\nclean uninstall with no side effects.\\n\\nDisk spac\", \"e optimization\\n\\nMSIX is optimized to reduce the footprint that an application has on the user\\u2019s mach\", \"ine disk space. It\\ncreates a single instance storage of your files. That is, if you have two differe\", \"nt packages with the\\nsame DLL, the DLL isn't installed twice. The platform takes care of that proble\", \"m because it knows all\\nthe files that a particular app installed thanks to its declarative nature. I\", \"t also allows you to have\\ndifferent versions of a DLL working side by side.\\n\\nWith the use of resourc\", \"e packages, you can easily create multilingual apps and the OS takes care of\\n\\ninstalling the ones th\", \"at are used.\\n\\nNetwork optimization\\n\\nMSIX detects the differences on the files at the byte block leve\", \"l enabling a feature called differential\\nupdates. What this means is that only the updated byte bloc\", \"ks are downloaded on application\\nupdates.\\n\\n59 CHAPTER 6 | Deploying Modern Desktop Applications\\nDiff\", \"erential updates\\n\\nHR APP Version 1.0.0.0 HR APP Version 1.2.0.0\\n\\nHRApp. exe HRApDp exe\\n\\nHR APP Versi\", \"on 1.2.0.0\\n\\nHRApp.exe\\n\\nWith streaming installation, the user can quickly start working on your appli\", \"cation while other parts of\\nthe app are downloaded on the background. This feature contributes to an\", \" engaging experience for\\nyour users.\\n\\nWith the optional packages feature, you achieve componentizati\", \"on on your app deployment, so you\\ncan download them when needed.\\n\\nSimple packaging and deployment\\n\\nT\", \"he AppManifest declares the versioning, device targeting and identity in a standard way for every\\nap\", \"plication. It also provides a way to sign your assets providing a solid security foundation.\\n\\nOS man\", \"aged\\n\\nThe OS handles all the processes for installing, updating, and removing an application. Applic\", \"ations\\nare installed per user but downloaded only once, minimizing the disk footprint. Microsoft is \", \"working\\non providing the MSIX experience also on Windows 7.\\n\\nWindows provides integrity for the app\\n\", \"\\nWith the use of digital signatures, you can guarantee that you don't install an application from\\nun\", \"trusted sources. MSIX also prevents tampering because:\\n\\n. It keeps a record of file hashes.\\n\\n\\u00b0 It de\", \"tects if a file has been modified after installation.\\n\\n60 CHAPTER 6 | Deploying Modern Desktop Appli\", \"cations\\nWorks for the entire App Catalog\\n\\nOne of the coolest things about MSIX is that it works for \", \"the entire application catalog, Windows\\nForms, WPF, MFC/ATL, Delphi, even if you want to do xCopy de\", \"ployment, ClickOnce, or going to the\\nStore, you can use the same MSIX package.\\n\\nTools\\n\\nWindows Appli\", \"cation Packaging Project\\n\\nYou can use the Windows Application Packaging Project project in Visual St\", \"udio to generate a\\npackage for your desktop app. Then, you can publish that package to the Microsoft\", \" Store or sideload\\nit onto one or more PCs.\\n\\nMSIX Packaging Tool\\n\\nThe MSIX Packaging Tool enables yo\", \"u to repackage your existing Win32 applications to the MSIX\\nformat. It offers both an interactive Ul\", \" and a command line for conversions and gives you the ability to\\nconvert an application without havi\", \"ng the source code.\\n\\n61 CHAPTER 6 | Deploying Modern Desktop Applications\\nMSIX Packaging Too! (Previ\", \"ew) - O x\\n\\nCreate new package Open package editor \\u00a303\\nSelect package type\\n\\n. \\u2014\\n\\nModification\\npackage\", \"\\n\\nApplication jon\\npackage modif\\n\\nCreate a package that modifies\\n\\nCreate your app package an existing\", \" app\\n\\nPackage Support Framework\\n\\nThe Package Support Framework is an open-source kit that helps you \", \"apply fixes to your existing\\nWin32 application when you don't have access to the source code, so tha\", \"t it can run in an MSIX\\ncontainer. The Package Support Framework helps your application follow the b\", \"est practices of the\\nmodern runtime environment.\\n\\nApp Installer\\n\\nApp Installer allows Windows 10 and\", \" Windows 11 apps to be installed by double-clicking the app\\npackage. This means that users don't nee\", \"d to use PowerShell or other developer tools to deploy\\nWindows 10/Windows 11 apps. The App Installer\", \" can also install an app from the web, optional\\npackages, and related sets.\\n\\nHow to create an MSIX p\", \"ackage from an existing\\nWin32 desktop application\\n\\nLet\\u2019s go through the process to create an MSIX pa\", \"ckage from an existing Win32 application. In this\\nexample, we'll use a Windows Forms app.\\n\\n62 CHAPTE\", \"R 6 | Deploying Modern Desktop Applications\\nTo start, add a new project to your solution, select the\", \" Windows Application Packaging Project, and\\ngive it a name.\\n\\n*8) CouponDemo - Microsoft Visual Studi\", \"o YB auick Launch (ctri+Q) Pe @ xX\\nFile Edit View Project Build Debug Team Tools Test Analyze Window\", \" Help Adam Braden ~ an |\\n[2.2 ;\\n\\nAdd New Project\\n\\nToolbox a \\u00b0\\n> Recent Sort by: | Default ae Search \", \"(Ctri+E)\\n\\nb Microsoft. Toolkit.Forms.U\\n\\ninstaned NJ Blank App (Universal Windows) Visual C# Type: Vi\", \"sual C#\\n\\nb Microsoft.Toolkit.Forms.U 4 visual C# A project that creates packages\\n> All Windows Forms\", \" Get Started Console App C# (Universal Windows) Visual C# containing Windows applications for\\n4 Comm\", \"on Controls side-loading or distribution via the\\n\\nk Pointer Windows Universal Class Library (Univers\", \"al Windows) Visual C# Windows Store\\n@ Button\\n\\nCheckBox\\n\\nWindows Desktop\\nWeb Windows Runtime Componen\", \"t (Universal Windows) Visual C#\\nNET Core\\nCheckedListBox NET Standard Optional Code Package (Universa\", \"l Windows) Visual C#\\nComboBox\\n\\nCloud\\n\\nDateTimePicker Test Unit Test App (Universal Windows) Visual C\", \"#\\nes\\n\\nLabel WCF\\n\\nCoded UI Test Project (Universal Windows) Visual C#\\nLinkLabel\\n\\n> Visual Basic\\n\\n|\\nir\", \"s\\na\\nA\\nA\\n\\nListBox > Visual C++ Windows Application Packaging Project Visual C#\\nListView\\n\\nNot finding \", \"what you are looking for? ; ; ;\\nMaskedTextBox Windows Template Studio (Universal Windows) Visual C#\\n\", \"Open Visual Studio Installer\\n\\nBWOR H&A Bs\\n\\nMonthCalendar ouponDemo\\nNotifylcon Name: [Coupon. Package\", \" Debug|Any CPU\\n\\nNumericUpDown | Location: C:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talks\\\\Devintersection2018\\\\Cou\", \"ponDemo a Browse...\\nPictureBox :\\\\Users\\\\adambr\\\\source\\\\r\\n\\noupon.Forms\\n\\nProgressBar\\n\\nRadioButton Cancel\", \"\\n\\nRichTextBox The name of the solution file.\\nTextBox\\n\\nYou'll see the structure of the packaging proj\", \"ect and note a special folder called Applications. Inside\\nthis folder, you can specify which applica\", \"tions you want to include in the package. It can be more than\\none.\\n\\n63 CHAPTER 6 | Deploying Modern \", \"Desktop Applications\\nG\\u00b0O @ &-\\nSearch Solution Explorer (Ctrl+;)\\n\\nb \\u00a2* CouponService.cs\\nb EE] Form1.c\", \"s\\nb\\n\\ne-s@\\n\\nc* Program.cs\\nE) tail.ico\\nCoupon.Package\\nal Applications\\n\\nb \\u00a9 Images\\n\\n4\\n\\n=e\\n\\n@ | \\u00bb|--|\\nfe\", \"\\n\\na\\n\\n= Coupon.Package_TemporaryKey.pfx\\nPackage.appxmanifest\\n\\nSolution Explorer MICE mS te)lelets\\n\\nRi\", \"ght-click on the Applications folder and select the Windows Forms project you want to package\\n\\nfrom \", \"the Visual Studio solution.\\n\\n64\\n\\nCHAPTER 6 | Deploying Modern Desktop Applications\\na) CouponDemo - M\", \"icrosoft Visual Studio XY quick taunch (Ctri+Q) P-\\u2014_- @ xX\\nFile Edit View Project Build Debug Team T\", \"ools Test Analyze Window Help Adam Braden * a |\\n\\u00b0o-\\n\\nReference Manager - Coupon.Package\\nToolbox 4 Pr\", \"oj\\nSearch Too\\n\\nSolution ,\\n4 General , Name:\\n\\nCoupon.Forms\\nThere are\\n\\n[ [RK I Cancel |\\n\\neelgeie Outpu\", \"t\\n\\nfp Type here to search\\n\\nAt this point, you can compile and generate the package but let\\u2019s examine\", \" a couple of things. To have\\na better user experience, Visual Studio can autogenerate all the visual\", \" assets a modern application\\nneeds to handle icons and tile assets for the tile bar and start menu. \", \"Open the Package.appxmanifest\\nfile to access the Manifest Designer. You can then generate all the vi\", \"sual assets from a given image\\npresent on your project just by clicking Create.\\n\\n| Package.appxmanif\", \"est. smmeags Coupon.Package \\u00a5 | Solution Explorer\\n\\n@\\u00aeAM-|o-sa@| [|\\n\\nSearch Solution Explorer (Ctrl+;\", \") Pp:\\n\\nNuGet: Coupon.Forms\\n\\nDeclarations Content URIs Packaging\\n\\nb \\u00a2* CouponService.cs\\n\\nApplication \", \"Visual Assets Capabilities b EE] Form1.cs\\n_ b \\u00a2* Program.cs\\ntail.ico\\n\\nSource 'C.\\\\Users\\\\adambr\\\\source\", \"\\\\repos\\\\talks\\\\De\\\\\\n\\nAll Visual Assets 4 \\u00a9 Coupon.Package\\n\\nDestination _|Images b Applications\\ni > \\u00a9 Im\", \"ages\\nSmall Til r T g\\nmas | Assets Small Tile, Medium Tile, Wide Tile, La... ~\\n\\nfd Coupon.Package_Tem\", \"poraryKey.pfx\\nPackage.appxmanifest\\n\\nMedium Tile Scales All Scales '\\n: fans Solution Explorer Bickle \", \"syellelc-is\\nWide Tile 0 Scaling Mode | Bicubic (Sharper Edges)\\nx . :\\nP Apply recommended padding ioe\", \"\\nLarge Tile\\n\\nGenerate ~ Boziz! Vad\\n\\nOutput\\n\\nShow output from: Debug ~ || | =| 2a\\n\\nThe thread @x553c \", \"has exited with code @ (exe). -\\nThe thread @x2ae@ has exited with code @ (@x@).\\nThe program '[19988]\", \" Coupon.Forms.exe\\u2019 has exited with code @ (@x@).\\n\\n4\\nError List M@Wisel\\u00a5hs\\n\\nIf you open the code for \", \"the Package.appxmanifest file, you can see a couple of interesting things.\\n\\nRight under <Package>, t\", \"here\\u2019s an <Identity> node. This is where your packaged application is going\\nto get its identity, whi\", \"ch will be managed by the OS.\\n\\n65 CHAPTER 6 | Deploying Modern Desktop Applications\\nPackage.appxmani\", \"fest ' | Coupon.Package Coupon.cs NuGet: Coupon.Forms\\n\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n-|<Pac\", \"kage xmlns=\\\"http://schema icrosoft.com/appx/manifest/foundation/windows10\\\" >\\n<Identity Name=' 436b-9\", \"b: icb9e853df3\\\" Publisher=\\\"CN=adambr\\\" Vers\\n<Properties>\\n<DisplayName>Coupon.Package</DisplayName>\\n<P\", \"ublisherDisplayName>adambr</PublisherDisplayName>\\n<Logo>Images\\\\StoreLogo. png</Logo>\\n</Properties> J\", \"\\n<Dependencies>\\n<TargetDeviceFamily Name=\\\"Windows.Universal\\\" MinVersion=\\\"10.0.0.0\\\" MaxVersion]\\n<Targ\", \"etDeviceFamily Name=\\\"Windows.Desktop\\\" MinVersion=\\\"10.0.14393.0\\\" MaxVersic\\n</Dependencies>\\n<Resources\", \">\\n<Resource Language=\\\"x-generate\\u201d />\\n</Resources>\\n<Applications>\\n<Application Id=\\\"App\\\" Executable=\\\"$\", \"targetnametoken$.exe\\\" EntryPoint=\\\"$targeter\\n<uap:VisualElements DisplayName=\\\"Coupon.Package\\\" Descrip\", \"tion=\\\"Coupon. Package\\n<uap:DefaultTile Wide310x150Logo=\\\"Images\\\\Wide310x15@Logo.png\\\" Square310x31 ~\\n\\n\", \"Show output from: Visual Assets y | | = | = | \\u201ca\\n\\nSaVEU. Ls \\\\USErS \\\\dUdmMDr \\\\SOUMCe \\\\PepOs \\\\Ld KS \\\\U\", \"EVITILErSeCLlOlnz20i1d \\\\LOUPOTIVEMO \\\\LOUPOUI!. Fad C Kd Be \\\\ Lid Bes \\\\S>LOreLlopo\\nSaved: C:\\\\Users\\\\ad\", \"ambr\\\\source\\\\repos\\\\talks\\\\DevIntersection2018\\\\CouponDemo\\\\Coupon. Package \\\\Images\\\\StoreLogo\\nSaved: C:\\\\U\", \"sers\\\\adambr\\\\source\\\\repos\\\\talks\\\\DevIntersection2018\\\\CouponDemo\\\\Coupon. Package\\\\Images\\\\StoreLogo\\nSaved\", \": C:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talks\\\\DeviIntersection2018\\\\CouponDemo\\\\Coupon. Package\\\\Images\\\\StoreLog\", \"o\\n\\nError List\\n\\nIn the <Capabilities> node, you can find all the requirements the application needs, \", \"paying special\\nattention to the <rescap:Capability Name=\\\"runFullTrust\\\" \\\\>, which tells the OS to run\", \" the app in full\\ntrust mode since it\\u2019s a Win32 application.\\n\\n66 CHAPTER 6 | Deploying Modern Desktop\", \" Applications\\nCoupon.Package Coupon.cs NuGet: Coupon.Forms\\n<Applications> al\\n<Application Id=\\\"App\\\" E\", \"xecutable=\\\"$targetnametoken$.exe\\\" EntryPoint=\\\"$targeter +\\n<uap:VisualElements DisplayName=\\\"Coupon.Pa\", \"ckage\\\" Description=\\\"Coupon. Package\\n<uap:DefaultTile Wide310x15@Logo=\\\"Images\\\\Wide310x15@Logo. png\\\" S\", \"quare310x31\\n</uap:DefaultTile>\\n<uap:SplashScreen Image=\\\"Images\\\\SplashScreen.png\\\" />\\n</uap:VisualElem\", \"ents>\\n</Application>\\n</Applications>\\n-| <Capabilities>\\nsupa lity Name=\\\" \\u2018internetClient\\u201d />\\nap | y N\", \"ame=\\\"runFullTrust\\\" />\\nee\\n</Package>\\n\\nOutput\\n\\nShow output from: Visual Assets = | | | z= \\u201ca\\n\\nSAaVEU. \", \"Ls \\\\USENS \\\\dUdMOMr \\\\SOUPCE \\\\PEPpOSs \\\\Ld KS \\\\UEVITILErSeCLlonz20i1d \\\\COUPOUTIVEMIO \\\\LOUPOT!. Fd C Kd \", \"Be \\\\ Lila pes \\\\S>LOreLOpo.SCdilt\\nSaved: C:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talks\\\\DevIntersection2018\\\\Coupo\", \"nDemo\\\\Coupon. Package\\\\Images\\\\StoreLogo. scale\\nSaved: C:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talks\\\\DevIntersect\", \"ion2018\\\\CouponDemo\\\\Coupon. Package\\\\Images\\\\StoreLogo. scale\\n\\nSaved: C:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talk\", \"s\\\\DeviIntersection2018\\\\CouponDemo\\\\Coupon. Package\\\\Images\\\\StoreLogo. scale\\nWw\\n\\n>\\n\\nSicelmacia Output\\n\\n\", \"Set the packaging project as the startup project for the solution and select Run. This is going to:\\n\", \"\\n. Compile the Windows Forms application.\\n\\n. Create an MSIX package out of the build results.\\n. Depl\", \"oy the packages.\\n\\n. Install it locally on the development machine.\\n\\n. Launch the app.\\n\\n67 CHAPTER 6 \", \"| Deploying Modern Desktop Applications\\nRecently added\\n\\nTr Coupon.Package\\n\\n+A Pin to Start\\n@ Microso\", \"ft Graph |\\nMore\\n\\nExpenses.Packag\\u00e9\\n| Uninstall\\n\\na\\n\\nee\\n\\nExplore\\n\\nPhotos\\n\\nAstronomy Picture of the Day\\n\", \"\\na Azure Information Protection Viewer\\nB\\n\\nMicrosoft Store\\nSs} Blend for Visual Studio 2017\\n\\ncf Blend\", \" for Visual Studio 2019 Preview\\nal |\\n\\nv Brave\\n\\n.\\n\\nPL Type here to search\\n\\nWith this, you have the cl\", \"ean install and uninstall experience that MSIX provides fully integrated into\\nWindows 10/Windows 11.\", \"\\n\\nThe final stage is about how you deploy the MSIX package to another machine.\\n\\nRight-click on the p\", \"ackaging project, select the Store menu, and then select the Create App\\nPackages option.\\n\\nThen, you \", \"can choose between creating a package to upload to the store or creating packages for\\nsideloading. I\", \"n most modernization scenarios, you'll choose I want to create packages for\\nsideloading.\\nCreate App \", \"Packages\\n\\nSelect and Configure Packages\\n\\nOutput location:\\nC:\\\\Users\\\\adambr\\\\source\\\\repos\\\\talks\\\\Devinte\", \"rsection2018\\\\CouponDemo\\\\Coupon.Package\\\\AppPackages\\\\ [ |\\n\\n>\\n\\nVersion:\\n1 | 10 0 10\\n\\nAutomatically incr\", \"ement\\nMore information\\n\\nGenerate app bundle:\\n\\nvr\\n\\nAlways\\nWhat does an app bundle mean?\\n\\nSelect the p\", \"ackages to create and the solution configuration mappings:\\n\\n\\u00a9 To run validation locally, you must se\", \"lect at least one\\n\\nArchitecture Solution Configuration\\nsolution configuration that is both non-Debug\", \" and\\n\\nNeutral Debug (Any CPU) *| contains an architecture that runs on the local machine.\\n[| x86 Deb\", \"ug (x86) \\u2019\\nC1 x64 [Debug(64) sisi\\n\\nARM None\\n\\nInclude full PDB symbol files, if any, to enable crash \", \"analytics for the app. Learn More\\n\\nThere you can select the different architectures you want to targ\", \"et as you can include as many as you\\n\\nwant into the same MSIX package.\\n\\nThe final step is to declare\", \" where you want to deploy the final installation assets.\\n\\n69 CHAPTER 6 | Deploying Modern Desktop Ap\", \"plications\\nCreate App Packages\\nPA Configure Update Settings\\n\\nInstallation URL: http(s) or UNC path o\", \"r file share:\\n\\nhttp://apps.contoso.com/MyUniversalAp\\n\\nHow can | publish my application?\\nSpecify how \", \"often the application should check for updates:\\n\\n@) Check everytime the application runs\\n\\n\\u00a9 Check ev\", \"ery: 7 Day(s)\\n\\nYou can choose to use a web server or a shared UNC path on your enterprise file serve\", \"rs. Pay\\nattention to the settings to specify how you want to update your application. We'll cover ap\", \"plication\\nupdates in the next section.\\n\\nFor a detailed step-by-step guide, see Package a desktop app\", \" from source code using Visual Studio.\\n\\nAuto Updates in MSIX\\n\\nThe Windows Store has a great updating\", \" mechanism using Windows Update. In most enterprise\\nscenarios, you don't use the Store to distribute\", \" your desktop apps. So, you need a similar way to\\nconfigure updates for your application and pull th\", \"em to your users.\\n\\nUsing a combination of Windows 10/Windows 11 features and MSIX packages, you can \", \"provide a\\ngreat updating experience for your users. In fact, the user doesn't need to be technical a\", \"t all but still\\nbenefits from a seamless application update experience.\\n\\nYou can configure your upda\", \"tes to interact with the user in two different ways:\\n\\n70 CHAPTER 6 | Deploying Modern Desktop Applic\", \"ations\\n. User prompted updates: The OS shows some autogenerated nice UI to notify the user about\\nthe\", \" application it's about to install. It builds this Ul based on the properties you specify on\\nyour in\", \"stallation files.\\n\\n. Silent updates in the background. With this option, your users don\\u2019t need to be\", \" aware of the\\nupdates.\\n\\nYou can also configure when you want to perform updates: either when the app\", \"lication launches or\\non a regular basis. Thanks to the side-loading features, you can even get these\", \" updates while the\\napplication is running.\\n\\nWhen you use this type of deployment, a special file is \", \"created called .appinstaller. This simple file\\ncontains the following sections:\\n\\n. The location of t\", \"he .appinstaller file\\n. The application's main MSIX package properties\\n. The update behavior\\n\\n<?xml \", \"-version=\\\"1.0\\\" -encoding=\\\"UTF-8\\\" ?> +\\n\\n<AppInstaller\\n\\nUrie\\\"\\u201chttp: //sampleapppackages.azurewebsites.\", \"net/MSIX HR Demo/HR.appinstaller\\u201d\\n6] Version=\\\"2.0.0.0\\\"\\n\\nxmins=\\\"http;: //schemas .microsoft.com/appx/\", \"appinstal ler /2017/2\\u201d>\\n\\n\\u2018 <MainPackage\\nle Uri=\\\"http://sampleapppackages.azurewebsites .net/MSIX HR \", \"Demo/HumanResourcesV2.msix\\u201d\\nli Version=\\\"2.8.0.90\\\"\\n\\nPublisher=\\\"CN=nonasir\\u201d\\nName=\\\"*0b79d23-947c -403f-\", \"bebS-@4fc1637a7fe\\\"\\nProcessorArchitecture:=:\\\"x86\\\"/>\\n\\n<UpdateSettings>\\n\\n<OnLaunch -HoursBetweenUpdateC\", \"hecks=\\\"0\\\"/>\\n</UpdateSettings>\\n\\n</AppInstaller>\\n\\nIn combination with this file, Microsoft has designe\", \"d a special URL protocol to launch the installation\\nprocess from a link:\\n\\n<a href=\\\"ms-appinstaller: \", \"?source=http://mywebservice.azureedge.net/MyApp.msix\\\">Install\\napp package </a>\\n\\nThis protocol works \", \"on all browsers and launches the installation process with a great user experience\\non Windows 10/Win\", \"dows 11. Since the OS manages the installation process, it's aware of the location\\nthis application \", \"was installed from and tracks all the files affected by the process.\\n\\nMSIX creates a user interface \", \"for installation automatically showing some properties of the package.\\nThis allows for a common inst\", \"allation experience for every app.\\n\\n71 CHAPTER 6 | Deploying Modern Desktop Applications\\nOnce you've\", \" generated the new MSIX package and moved it to the deployment server, you just have\\nto edit the .ap\", \"pinstaller file to reflect these changes: mainly the version and the path to the new MSIX\\nfile. The \", \"next time the user launches the application, the system will detect the change and download\\nthe file\", \"s for the new version in the background. When the download is finished, installation will\\nexecute tr\", \"ansparently for your user on new application launch.\\n\\n72 CHAPTER 6 | Deploying Modern Desktop Applic\", \"ations\\n\"]"