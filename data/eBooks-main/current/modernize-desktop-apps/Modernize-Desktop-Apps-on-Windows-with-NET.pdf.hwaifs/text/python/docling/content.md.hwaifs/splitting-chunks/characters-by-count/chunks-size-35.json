"[\"<!-- image -->\\n\\n<!-- image -->\\n\\nMiguel Angel Castej\\u00f3n Dominguez Olia Gavrysh\\n\\n## EDITION v1.0.3 - Up\", \"dated to .NET 7\\n\\nRefer to the changelog for the book updates and community contributions.\\n\\nPUBLISHED\", \" BY\\n\\nMicrosoft Developer Division, .NET, and Visual Studio product teams\\n\\nA division of Microsoft Co\", \"rporation\\n\\nOne Microsoft Way\\n\\nRedmond, Washington 98052-6399\\n\\nCopyright \\u00a9 2022 by Microsoft Corporat\", \"ion\\n\\nAll rights reserved. No part of the contents of this book may be reproduced or transmitted in a\", \"ny form or by any means without the written permission of the publisher.\\n\\nThis book is provided 'as \", \"-is' and expresses the author's views and opinions. The views, opinions, and information expressed i\", \"n this book, including URL and other Internet website references, may change without notice.\\n\\nSome e\", \"xamples depicted herein are provided for illustration only and are fictitious. No real association o\", \"r connection is intended or should be inferred.\\n\\nMicrosoft and the trademarks listed at https://www.\", \"microsoft.com on the 'Trademarks' webpage are trademarks of the Microsoft group of companies.\\n\\nMac a\", \"nd macOS are trademarks of Apple Inc.\\n\\nAll other marks and logos are property of their respective ow\", \"ners.\\n\\nCo-Authors:\\n\\nOlia Gavrysh , Program Manager, .NET team, Microsoft\\n\\nMiguel Angel Castej\\u00f3n Domi\", \"nguez , Innovation Architect, Kabel\\n\\nParticipants and reviewers:\\n\\nMaira Wenzel , Senior Program Mana\", \"ger, .NET team, Microsoft\\n\\nAndy De Gorge , Senior Content Developer, .NET docs team, Microsoft\\n\\nMigu\", \"el Ramos , Senior Program Manager, Windows Developer Platform team, Microsoft\\n\\nAdam Braden , Princip\", \"al Program Manager, Windows Developer Platform team, Microsoft\\n\\nRicardo Minguez Pablos , Senior Prog\", \"ram Manager, Azure IoT team, Microsoft\\n\\nNish Anil , Senior Program Manager, .NET team, Microsoft\\n\\nBe\", \"th Massi , Senior Product Marketing Manager, Microsoft\\n\\nScott Hunter , Partner Director Program Mana\", \"ger, .NET team, Microsoft\\n\\nMarta Fuentes Lara , Kabel\\n\\n<!-- image -->\\n\\nRa\\u00fal Fern\\u00e1ndez de C\\u00f3rdoba , K\", \"abel\\n\\nAntonio Manuel Fern\\u00e1ndez Cantos , Kabel\\n\\n## Introduction\\n\\nThis book is about strategies you ca\", \"n adopt to move your existing desktop applications through the path of modernization and incorporate\", \" the latest runtime, language, and platform features. You'll discover that there's no unique recipe \", \"as each application is different, and so are your requirements and preferences. The good news is tha\", \"t there are common approaches you can apply to add new features and capabilities to your application\", \"s. Some of them won't even require major modifications of your code. In this book, we'll reveal how \", \"all those features work behind the scenes and explain the mechanics of their implementations. Moreov\", \"er, you'll find some common scenarios for modernizing existing desktop applications shown in detail \", \"so you can find inspiration for evolving your projects.\\n\\nMicrosoft's approach to modernizing existin\", \"g applications is to give you the flexibility to create your own customized path. All the modernizat\", \"ion strategies described in this book are mostly independent. You can choose ones that are relevant \", \"for your appl ication and skip others that aren't important for you. In other words, you can mix and\", \" match the strategies to best address your application needs.\\n\\n## Who should use the book\\n\\nThis book\", \" for developers and solution architects who want to modernize existing Windows Forms and WPF desktop\", \" applications to leverage the benefits of .NET and Windows 10.\\n\\nYou might also find this book useful\", \" if you're a technical decision maker, such as an enterprise architect or a development lead or dire\", \"ctor who wants an overview of the benefits of updating existing desktop applications.\\n\\n## How to use\", \" the book\\n\\nThis book addresses the 'why'why you might want to modernize your existing applications, \", \"and the specific benefits you get from using NET and MSIX to modernize your desktop apps. The conten\", \"t of the book is designed for architects and technical decision makers who want an overview, but who\", \" don't need to focus on implementation and technical, step -by-step details.\\n\\nAlong the different ch\", \"apters, sample implementation code snippets and screenshots are provided, with chapter 5 devoted to \", \"showcase a complete migration process for sample applications.\\n\\n## What this book doesn't cover\\n\\nThi\", \"s book covers a specific subset of scenarios that are focused on lift-and-shift scenarios, outlining\", \" the way to gain the benefits of modernizing without the effort of rewriting code.\\n\\nThis book isn't \", \"about developing modern applications with .NET from scratch or about getting started with Windows Fo\", \"rms and WPF. It focuses on how you can update existing desktop applications with the latest technolo\", \"gies for desktop development.\\n\\n<!-- image -->\\n\\n## Samples used in this book\\n\\nTo highlight the necess\", \"ary steps to perform a modernization, we'll be using a sample application called eShopModernizing. T\", \"his application has two flavors, Windows Forms and WPF, and we'll show a step-by-step process on how\", \" to perform the modernization on both of them to .NET.\\n\\nAlso, on the GitHub repository for this book\", \", you'll find the results of the process, which you can consult with if you decide to follow the ste\", \"p-by-step tutorial.\\n\\n<!-- image -->\\n\\n## Contents\\n\\n| Why modern desktop applications ................\", \"....................................................................... 1                           \", \"                                            |\\n|-----------------------------------------------------\", \"----------------------------------------------------------------------------------------------------\", \"----------------------------------------|\\n| Introduction ...........................................\", \"....................................................................................................\", \"................................1   |\\n| A story of one company......................................\", \"....................................................................................................\", \".........1                      |\\n| Your story......................................................\", \"....................................................................................................\", \".....................1      |\\n| Desktop applications nowadays ......................................\", \"..................................................................................................1 \", \"                        |\\n| Windows Forms...........................................................\", \"....................................................................................................\", \"....3               |\\n| WPF.........................................................................\", \"....................................................................................................\", \"..............4 |\\n| UWP.............................................................................\", \"....................................................................................................\", \".........4  |\\n| A tale of two platforms.............................................................\", \".............................................................................................5      \", \"        |\\n| Paths to modernization..................................................................\", \".......................................................................................8            \", \"    |\\n| Modern features.............................................................................\", \".....................................................................................8              \", \"|\\n| Deployment......................................................................................\", \".....................................................................................8          |\\n| \", \"Installation........................................................................................\", \"......................................................................................8     |\\n| What\", \"'s new with .NET for Desktop? ......................................................................\", \"................ 9                                                                      |\\n| The moti\", \"vation behind .NET Core.............................................................................\", \"........................................................9                           |\\n| Introduction\", \" to .NET Core ......................................................................................\", \"........................................................... 11                  |\\n| .NET 5+ is .NET \", \"Core vNext..........................................................................................\", \"..................................................... 11                    |\\n| .NET Framework vs. .\", \"NET.................................................................................................\", \"................................................... 12                  |\\n| .NET Standard vs. PCL ..\", \"....................................................................................................\", \"................................................... 13              |\\n| New Desktop features in .NET\", \"....................................................................................................\", \"..................................... 14                        |\\n| Support for Windows Forms and WP\", \"F...................................................................................................\", \".................14                                         |\\n| XAML Islands........................\", \"....................................................................................................\", \"..........................................14            |\\n| Access to all Windows 10 and Windows 11 \", \"APIs ...............................................................................................\", \".15                                                 |\\n| Side-by-side support and self-contained EXEs\", \"....................................................................................................\", \"15                                              |\\n| Performance.....................................\", \"....................................................................................................\", \"..............................15            |\\n| Migrating Modern Desktop applications...............\", \"............................................................. 16                                    \", \"                                        |\\n| Configuration files ....................................\", \"....................................................................................................\", \"........................ 16         |\\n\\n| Configuration on .NET......................................\", \"....................................................................................................\", \"..........17                 |                                                                      \", \"                                                                                                    \", \" |\\n|------------------------------------------------------------------------------------------------\", \"---------------------------------------------------------------------------------------------|------\", \"----------------------------------------------------------------------------------------------------\", \"-----------------------------------------------------------------|\\n| Migrating configuration files..\", \"....................................................................................................\", \".................................17                      |                                          \", \"                                                                                                    \", \"                             |\\n| Accessing databases................................................\", \"....................................................................................................\", \"........             | 18                                                                           \", \"                                                                                             |\\n| ODB\", \"C...................................................................................................\", \"..................................................................................19 |              \", \"                                                                                                    \", \"                                                         |\\n| OLE DB.................................\", \"....................................................................................................\", \".............................................19  |                                                  \", \"                                                                                                    \", \"                     |\\n| ADO.NET....................................................................\", \"....................................................................................................\", \"......19     |                                                                                      \", \"                                                                                     |\\n| EF Core vs.\", \" EF6................................................................................................\", \"...................................................................19        |                      \", \"                                                                                                    \", \"                                                 |\\n| Relational databases...........................\", \"....................................................................................................\", \"........................20               |                                                          \", \"                                                                                                    \", \"             |\\n| Consuming services ................................................................\", \".............................................................................................       \", \"     | 20                                                                                           \", \"                                                                             |\\n| Consuming a COM Obj\", \"ect ................................................................................................\", \"................................................                     | 21                           \", \"                                                                                                    \", \"                                         |\\n| More things to consider................................\", \"....................................................................................................\", \".................                | 21                                                               \", \"                                                                                                    \", \"     |\\n| AppDomains ................................................................................\", \"......................................................................................21         |  \", \"                                                                                                    \", \"                                                                     |\\n| Remoting...................\", \"....................................................................................................\", \"......................................................21     |                                      \", \"                                                                                                    \", \"                                 |\\n| Code Access Security (CAS) ....................................\", \"....................................................................................................\", \".22                      |                                                                          \", \"                                                                                                 |\\n|\", \" Security Transparency .............................................................................\", \".......................................................................22                |          \", \"                                                                                                    \", \"                                                             |\\n| Windows 10 migration ..............\", \"...........................................................................................         \", \"                                                     | 23                                           \", \"                                                                                                    \", \"                         |\\n| WinRT APIs ............................................................\", \"....................................................................................................\", \"..............   | 23                                                                               \", \"                                                                                         |\\n| Univers\", \"al Windows Platform (UWP) packages..................................................................\", \"...................................24                                            |                  \", \"                                                                                                    \", \"                                                     |\\n| How to add WinRT APIs to your desktop proje\", \"ct..................................................................................................\", \"..                                           | 26                                                   \", \"                                                                                                    \", \"                 |\\n| XAML Islands ..................................................................\", \"....................................................................................................\", \"....     | 34                                                                                       \", \"                                                                                 |\\n| The road to XAM\", \"L Islands...........................................................................................\", \"..................................................35                     |                          \", \"                                                                                                    \", \"                                             |\\n| How it works ......................................\", \"....................................................................................................\", \"............................35       |                                                              \", \"                                                                                                    \", \"         |\\n| Do you need XAML Islands...............................................................\", \"...........................................................................38                       \", \" |                                                                                                  \", \"                                                                         |\\n| The road ahead XAML Isl\", \"ands: WinUI 3.0 ....................................................................................\", \"..........................38                                     |                                  \", \"                                                                                                    \", \"                                     |\\n| Example of migrating to the latest .NET....................\", \".........................................................                                           \", \"                             | 41                                                                   \", \"                                                                                                    \", \" |\\n| Migrating from .NET Core or .NET 5 ............................................................\", \".................................................................                            | 41   \", \"                                                                                                    \", \"                                                                 |\\n| Migrating from .NET Framework..\", \"....................................................................................................\", \"..............................                           | 42                                       \", \"                                                                                                    \", \"                             |\\n| Migrating with a tool..............................................\", \"....................................................................................................\", \"....42               |                                                                              \", \"                                                                                             |\\n| Mig\", \"rating by hand......................................................................................\", \".....................................................................42              |              \", \"                                                                                                    \", \"                                                         |\\n| Preparation ...........................\", \"....................................................................................................\", \"..........................................43     |                                                  \", \"                                                                                                    \", \"                     |\\n| Fix the code and build.....................................................\", \"...............................................................................................45   \", \"             |                                                                                      \", \"                                                                                     |\\n| Run and tes\", \"t                                                                                                   \", \"                                                                             | .....................\", \"....................................................................................................\", \"..............................................46 |\\n\\n| Migrating a Windows Forms application ........\", \"....................................................................................................\", \"........                                    | 46   |\\n|----------------------------------------------\", \"----------------------------------------------------------------------------------------------------\", \"---------------------------------------------|------|\\n| Migrating a WPF application.................\", \"....................................................................................................\", \".......................                       | 52   |\\n| Deploying Modern Desktop Applications .....\", \".....................................................................                               \", \"                                               | 55   |\\n| The modern application lifecycle..........\", \"....................................................................................................\", \"......................                          | 56   |\\n| MSIX: The next generation of deployment..\", \"....................................................................................................\", \"...........                                      | 58   |\\n| Benefits of MSIX .......................\", \"....................................................................................................\", \"....................................59            |      |\\n| Tools..................................\", \"....................................................................................................\", \"................................................61 |      |\\n| How to create an MSIX package from an \", \"existing Win32 desktop application...........................................                       \", \"                                                    | 62   |\\n| Auto Updates in MSIX.................\", \"....................................................................................................\", \"....................................                 | 70   |\\n\\n## Why modern desktop applications\\n\\n#\", \"# Introduction\\n\\n## A story of one company\\n\\nBack in the early 2000s, one multinational company starte\", \"d developing a distributed desktop solution to exchange information between different branches of th\", \"e company and execute optimized operations on centralized units. They have chosen a brand-new framew\", \"ork called Windows Forms (also known as WinForms) for their application development. Over the years,\", \" the project evolved into a mature, well-tested, and time-proven application with hundreds of thousa\", \"nds of lines of code. Time passed and .NET Framework 2.0 is no longer the hot new technology. The de\", \"velopers who are working on this application are facing a dilemma. They'd like to use the latest sta\", \"ck of technologies in their development and have their application look and 'feel' modern. At the sa\", \"me time, they don't want to throw away the great product they have built over 15 years and rewrite t\", \"he entire application from scratch.\\n\\n## Your story\\n\\nYou might find yourself in the same boat, where \", \"you have mature Windows Forms or Windows Presentation Foundation (WPF) applications that have proved\", \" their reliability over the years. You probably want to keep using these applications for many more \", \"years. At the same time, since those applications were written some time ago, they might be missing \", \"capabilities like modern look, performance, integration with new devices and platform features, and \", \"so on, which gives them a feel of 'old tech'. There's another pr oblem that might concern you as a d\", \"eveloper. While working on the older .NET Framework versions and maintaining applications that were \", \"written a while ago, you might feel like you aren't learning new technologies and missing out on bui\", \"lding modern technica l skills. If that is your story -this book is for you!\\n\\n## Desktop application\", \"s nowadays\\n\\nBefore the rise of the Internet, desktop applications were the main approach to building\", \" software systems. Developers could choose any programming language, such as COBOL, Fortran, VB6, or\", \" C++.\\n\\nBut whether they developed small tools or complex distributed architectures, they were all de\", \"sktop applications.\\n\\nThen, Internet technologies started shocking the development world and winning \", \"over more engineers with advantages like easy deployment and simplified distribution processes. The \", \"fact that once a web application was deployed to production all users got automatic updates made a h\", \"uge impact on software agility.\\n\\nHowever, the Internet infrastructure, underlying protocols, and sta\", \"ndards like HTTP and HTML weren't designed for building complex applications. In fact, the major dev\", \"elopment effort back then was aimed at just one goal: to give web applications the same capabilities\", \" that desktop applications have, such as fast data input and state management.\\n\\nEven though web and \", \"mobile applications have grown at an incredible pace, for certain tasks desktop applications still h\", \"old the number one place in terms of efficiency and performance. That explains why there are million\", \"s of developers who are building their projects with WPF and WinForms and the amount of those applic\", \"ations is constantly growing.\\n\\nHere are some reasons for choosing desktop applications in your devel\", \"opment:\\n\\n- Desktop apps have better interaction with the user's PC.\\n- The performance of desktop app\", \"lications for complex calculations is much higher than the performance of web applications.\\n- Runnin\", \"g custom logic on the client-side is possible but much harder with a web application.\\n- Using multit\", \"hreading is easier and more efficient in a desktop application.\\n- The learning curve for designing u\", \"ser interfaces (UIs) isn't steep. And for WinForms, it's intuitive with the drag-and-drop experience\", \" of the Windows Forms designer.\\n- It's easy to start coding and testing your algorithms without the \", \"need to set up a server infrastructure or to care about connectivity problems, firewalls, and browse\", \"r compatibility.\\n- Debugging is powerful as compared to web debugging.\\n- Access to hardware devices,\", \" such as camera, Bluetooth, or card readers, is easy.\\n- Since the technology has been around for a w\", \"hile, there are many experts and a knowledge base available to develop desktop applications.\\n\\nSo, as\", \" you can see, developing for desktop is great for many reasons. The technology is mature and time-te\", \"sted, the development cycle is fast, the debugging is powerful and arguably, desktop apps have less \", \"complexity and are easier to get started with.\\n\\nMicrosoft offered many UI desktop technologies throu\", \"ghout the years from Win32 introduced in 1995 to Universal Windows Platform (UWP) released in 2016.\\n\", \"\\n1995\\n\\nWPF\\n\\nWinForms\\n\\nUWP\\n\\nElectron\\n\\nConsole\\n\\nOther\\n\\n2002\\n\\nTelerik Survey\\n\\n2006\\n\\nWhat Technology wou\", \"ld you choose if building for Windows Desktop?\\n\\nWin32\\n\\nWinForms\\n\\n<!-- image -->\\n\\nAccording to a surv\", \"ey published by Telerik on April 2016, the most popular technologies for building Windows desktop ap\", \"ps are Windows Forms, WPF, and UWP.\\n\\n<!-- image -->\\n\\nYou can develop in any of them using C# and Vis\", \"ual Basic, but let's take a closer look.\\n\\n## Windows Forms\\n\\nFirst released in 2002, Windows Forms is\", \" a managed framework and is the oldest, most-used desktop technology built on the Windows graphics d\", \"evice interface (GDI) engine. It offers a smooth drag-anddrop experience for developing user interfa\", \"ces in Visual Studio. At the same time, Windows Forms relies on the Visual Studio Designer as the ma\", \"in way you develop your UI, so creating visual components from code isn't trivial.\\n\\nThe following li\", \"st summarizes the main characteristics of Windows Forms:\\n\\n- Mature technology with lots of code samp\", \"les and documentation.\\n- Powerful and productive designer. Not so convenient to design UI 'from code\", \"'.\\n- Easy and intuitive to learn, thanks to the designer's drag -and-drop experience.\\n- Supported on\", \" any Windows version.\\n- Supported on .NET Core 3.0 and later versions.\\n\\n2016\\n\\n2019\\n\\n## WPF\\n\\nBased on\", \" the XAML language specification, WPF favors a clear separation between UI and code. XAML offers cap\", \"abilities like templating, styling, and binding, which is suited for building large applications. Li\", \"ke Windows Forms, it's a managed framework, but the design is modular and reusable.\\n\\nHere are the ma\", \"in features of WPF:\\n\\n- Mature technology.\\n- Designer is available, but developers usually prefer to \", \"create the design from code using declarative XAML.\\n- The learning curve is steeper than Windows For\", \"ms.\\n- Supported on any Windows version.\\n- Supported on .NET Core 3.0 and later versions.\\n\\n## UWP\\n\\nUW\", \"P isn't only a presentation framework like WPF and Windows Forms, but it's also a platform itself. T\", \"his platform has:\\n\\n- Its own API set (the Windows Runtime API).\\n- A new deployment system (MSIX)\\n- A\", \" modern application lifecycle model (for low battery consumption).\\n- A new Resource Management Syste\", \"m (based on PRI files).\\n\\nThe platform was created to support all kinds of input systems (like ink, t\", \"ouch, gamepad, mouse, keyboard, gaze, and so on) in all form-factors with performance and low batter\", \"y consumption in mind. For these reasons, the shell of the Windows 10 OS uses parts of the UWP platf\", \"orm.\\n\\nPRI\\n\\nResw\\n\\nMRT\\n\\nMSIX\\n\\nPackage ID\\n\\nCertificate\\n\\nUWP\\n\\n<!-- image -->\\n\\nUWP contains a presentatio\", \"n framework that is XAML-based, like WPF, but it has some important differences such as:\\n\\n- Applicat\", \"ions are executed in app containers. App containers control what resources a UWP app can access.\\n- S\", \"upported only on Windows 10 and Windows 11.\\n- Apps can be deployed through Microsoft Store for easie\", \"r deployment.\\n- Designed as part of the Windows Runtime API.\\n- Contains an extensive set of rich bui\", \"lt-in controls and additional controls are available through the Microsoft UI Library NuGet packages\", \" (WinUI library), updated every few months.\\n\\n## A tale of two platforms\\n\\nIn the last 20 years, while\", \" UI desktop technologies were growing and following the path from Windows Forms to UWP, the hardware\", \" was also evolving from heavyweight PC units with small CRT monitors to high-DPI monitors and lightw\", \"eight tablets and phones with different data input techniques like Touch and Ink. These changes resu\", \"lted in creating two different concepts: a Desktop Application and a Modern Application. A Modern Ap\", \"plication is one that considers different device form factors, various input and output methods, and\", \" leverages modern desktop features while running on a sandboxed execution model. The (traditional) D\", \"esktop Application, on the other hand, is\\n\\nan application that needs a solid UI with a high density \", \"of controls that is best operated with a mouse and a keyboard.\\n\\nThe following table describes the di\", \"fferences between the two concepts:\\n\\n| Aspect of comparison   | Modern Application                  \", \"                                                                                                    \", \"                 | Desktop Application                                                              \", \"                                              |\\n|------------------------|--------------------------\", \"----------------------------------------------------------------------------------------------------\", \"----------------------------|-----------------------------------------------------------------------\", \"---------------------------------------------------------|\\n| Security               | Contained exec\", \"ution & Great Fundamentals. Designed from the ground up to respect user's privacy, manage battery li\", \"fe, and focus to keep the device safe. | User & Admin level of security. You have native access to t\", \"he registry and hard drive folders.                                 |\\n| Deployment             | Ins\", \"tallation and updates are managed by the platform.                                                  \", \"                                                  | MSI, Custom installers & Updates. Traditionally \", \"a source of headaches for developers and IT managers.                          |\\n| Distribution     \", \"      | Trusted Distribution & Signed Packages. Distribution is performed from a trusted source and \", \"never from the web.                                          | Web, SCCM & Custom distribution. No c\", \"ontrol over what is installed, affects the whole machine.                                 |\\n| UI    \", \"                 | Modern UI. Different input mechanisms, ink, touch, gamepad, keyboard, mouse, etc.\", \"                                                                        | Windows Forms, WPF, MFC. D\", \"esigned for the mouse and keyboard for a dense UI and to get the most productivity from the desktop.\", \" |\\n| Data                   | Cloud First Data with Insights. Source of truth in the cloud. Insights\", \" to know what happens with your app and how it's performing.                       | Local Data. Tra\", \"ditional desktop applications usually need some local data.                                         \", \"            |\\n| Design                 | Designed for reuse. Reuse in mind between different platfor\", \"ms, front end, and back end, running assets in many places as possible.                       | Desi\", \"gned for Windows Desktop only                                                                       \", \"                       |\\n\\nAs a part of the commitment to provide developers with the best tools to b\", \"uild applications, Microsoft put forth a great effort to bring these concepts - or we can even say p\", \"latforms - closer together to empower developers with the best of both worlds. To do that, Microsoft\", \" has performed a bidirectional effort between the two platforms.\\n\\nModern\\n\\nBring both platforms close\", \"r together\\n\\nModern\\n\\nModem\\n\\nDesktop\\n\\nDesktop\\n\\nDesktop\\n\\n## Modern Application Platform Desktop Applica\", \"tion Scenarios Modern Application Desktop Applications\\n\\nModern Application\\n\\nPlatform Features\\n\\nPlatf\", \"orm\\n\\n<!-- image -->\\n\\n1. Move Desktop Application scenarios into Modern Application platform. The tra\", \"ditional desktop development is still popular because it addresses certain scenarios well. It makes \", \"sense to take these common desktop scenarios and bring them into the modern desktop platform to make\", \" the platform fully capable.\\n1. Move Modern Application features into Desktop Applications. For exis\", \"ting desktop apps that need a way to leverage modern capabilities without rewriting from scratch, fe\", \"atures from the Modern Application platform are pushed into the Desktop Application.\\n\\n<!-- image -->\", \"\\n\\n<!-- image -->\\n\\nIn this book, we'll focus on the second part and show how you can modernize your e\", \"xisting desktop applications.\\n\\n## Paths to modernization\\n\\nThe structure of this guide reflects three\", \" different axes to accomplish modernization: Modern Features, Deployment, and Installation.\\n\\n## Mode\", \"rn features\\n\\nSay you have a working Windows Forms application that a sales representative of your co\", \"mpany uses to fill in a customer order. A new requirement comes in to enable the customer to sign th\", \"e order using a tablet pen. Inking is native in today's operating systems and technologies, but it w\", \"asn't available when the app was developed.\\n\\nThis path will show you how you can leverage modern des\", \"ktop features into your existing desktop development.\\n\\n## Deployment\\n\\nModern development cycles have\", \" stressed the importance of providing agility with regard to how new versions of applications are de\", \"ployed to individual users. Since Windows Forms and WPF applications are based on a particular versi\", \"on of the .NET Framework that must be present on the machine, they can't take advantage of new .NET \", \"Framework version features without the intervention of the IT people with the risk of having side ef\", \"fects for other apps running on the same machine. It has limited the innovation pace for developers \", \"forcing them to stay on outdated versions of the .NET Framework.\\n\\nSince the launch of .NET Core 3.0,\", \" you can leverage a new approach of deploying multiple versions of .NET side by side and specifying \", \"which version of .NET each application should target. This way, you can use the newest features in o\", \"ne application while b eing confident you aren't going to break any other applications.\\n\\n## Installa\", \"tion\\n\\nDesktop applications always rely on some sort of installation process before the user can star\", \"t using them. This fact brought into the game a set of technologies, from MSI and ClickOnce to custo\", \"m installers or even XCOPY deployment. Any of these methods deals with delicate problems because app\", \"lications need a way to access shared resources on the machine. Sometimes installation needs to acce\", \"ss the Registry to insert or update new Key Values, sometimes to update shared DLLs referenced by th\", \"e main application. This behavior causes a continuous headache for users, creating this perception t\", \"hat once you install some application, your computer will never be the same, even if you uninstall i\", \"t afterwards.\\n\\nIn this book, we'll introduce a new way of installing applications with MSIX that sol\", \"ves the problem described earlier. You'll learn how you can easily set up packaging, installation, a\", \"nd updates for your application.\\n\\n## What's new with .NET for Desktop?\\n\\nDesktop applications such as\", \" Windows Forms and WPF can be built using various .NET implementations, for example, .NET Framework \", \"or .NET 7. In this chapter, we'll talk about the history of each implementation, explain the differe\", \"nces, and show what new features await desktop developers in newer implementations.\\n\\nIf you've been \", \"developing Windows Forms or WPF applications for a long time, you're familiar with .NET Framework. L\", \"ater, .NET Core (specifically its 3.0 version) started supporting desktop applications. .NET Core wa\", \"s rebranded to .NET when .NET 5 was released. Just as there are different versions of .NET Framework\", \", for example, 4.6, 4.7, and 4.8, there are also different versions of .NET Core: .NET Core 3.0, .NE\", \"T 5, .NET 6, .NET 7, and so on.\\n\\nLet's look into the history of each implementation to understand th\", \"e differences and benefits of each.\\n\\n## The motivation behind .NET Core\\n\\nSince its launch in 2002, .\", \"NET Framework has evolved to support many technologies, like Windows Forms, ASP.NET, Entity Framewor\", \"k, Windows Store, and many others. All of them are different in nature. Therefore, Microsoft approac\", \"hed this evolution by taking parts of .NET Framework and creating a different application stack for \", \"each technology. That way, development capabilities could be customized for the needs of the specifi\", \"c stack, which maximized the potential of every platform. That led to fragmentation on the versions \", \"of .NET Framework maintained by different independent teams. All of these stacks have a common struc\", \"ture, containing an app model, a framework, and a runtime, but they differ in the implementation of \", \"each of the parts.\\n\\nIf you're targeting only one of these platforms, you can use this model. However\", \", in many cases you might need more than one target platform in the same solution. For example, your\", \" application may have a desktop admin part, a customer-facing web site that shares the back-end logi\", \"c running on a server, and even a mobile client. In this case, you need a unified coding experience \", \"that can span all of these .NET verticals.\\n\\nBy the time Windows 8 was released, the concept of Porta\", \"ble Class Libraries (PCLs) was born. Originally, .NET Framework was designed around the assumption t\", \"hat it would always be deployed as a single unit, so factoring wasn't a concern. To face the problem\", \" of code sharing between verticals, the driving force was on how to refactor the framework. The idea\", \" of contracts is to provide a well-factored\\n\\nVersion f.1\\n\\nsval Studio 2003\\n\\nVersion 1.D\\n\\nVesool Stud\", \"io NET\\n\\nVersion 3.0\\n\\nRelease history of .Net Framework\\n\\nVersion 4.0\\n\\nVoual Studio 2010\\n\\nVersion 451\\n\", \"\\nVitual Studio 2013\\n\\nversion af\\n\\nNal Studo 2019\\n\\nVersion 4.7\\n\\n(mun Studo 2017)\\n\\nNET Core 20\\n\\nVersion\", \" 43\\n\\nVisual Seudo 2019\\n\\nNET Core 3.0\\n\\nAPI surface area. Contracts are simply assemblies that you com\", \"pile against and are designed with proper factoring in mind taking care of the dependencies between \", \"them. Version 472\\n\\nsusi Studio 2005\\n\\nVisual Studio 2012\\n\\nNET Core 1.0\\n\\nNET Core 218 22\\n\\nThis led to \", \"reasoning about the API differences between verticals at the assembly level, as opposed to at the in\", \"dividual API level like previously. This aspect enabled a class library experience that can target m\", \"ultiple verticals, also known as portable class libraries.\\n\\n<!-- image -->\\n\\nWith PCL, the experience\", \" of development is unified across verticals based on the API shape. And the most pressing need to cr\", \"eate libraries running on different verticals is also addressed. But there's a great challenge: APIs\", \" are only portable when the implementation is moved forward across all the verticals.\\n\\nA better appr\", \"oach is to unify the implementations across verticals by providing a well-factored implementation in\", \"stead of a wellfactored view. It's a lot simpler to ask each team that owns a specific component to \", \"think about how their APIs work across all verticals than trying to retroactively provide a consiste\", \"nt API stack on top. This is where .NET Standard comes in.\\n\\nAnother large challenge has to do with h\", \"ow .NET Framework is deployed. .NET Framework is a machine-wide framework. Any changes made to it af\", \"fect all applications that take a dependency on it. Although this deployment model has many advantag\", \"es, such as reducing disk space and centralized access to services, it presents some pitfalls.\\n\\nTo s\", \"tart with, it's difficult for application developers to take a dependency on a recently released fra\", \"mework. They either have to take a dependency on the latest OS or provide an application installer t\", \"hat installs .NET Framework along with the applicati on. If you're a web developer, you might not ev\", \"en have this option as the IT department establishes the server supported version.\\n\\nEven if you're w\", \"illing to go through the trouble of providing an installer to chain in .NET Framework setup, you may\", \" find that upgrading .NET Framework can break other applications.\\n\\nDespite the efforts to provide ba\", \"ckward compatible versions of the framework, there are compatible changes that can break application\", \"s. For example, adding an interface to an existing type can change how this type is serialized and c\", \"ause breaking problems depending on the existing code. Because the .NET Framework installed base is \", \"huge, fighting against these breaking scenarios slows down the pace of innovations inside .NET Frame\", \"work.\\n\\nTo solve all these issues, Microsoft developed .NET Core as the evolution of the .NET develop\", \"ment platform.\\n\\n## Introduction to .NET Core\\n\\n.NET Core, which is now referred to as just '.NET', is\", \" the evolution of Microsoft's .NET technology into a modular, cross-platform, open source, and cloud\", \"-ready platform. It runs on Windows, macOS, and Linux, and some ARM-based architectures like Android\", \" and IoT.\\n\\nThe purpose of .NET Core is to provide a unified platform for all types of applications, \", \"which includes Windows, cross-platform, and mobile applications. .NET Standard enabled this by provi\", \"ding shared base APIs, which every application model needs, and excluding any application model-spec\", \"ific API.\\n\\nThis framework gives applications many benefits in terms of efficiency and performance, s\", \"implifying the packaging and deployment in the different supported platforms.\\n\\nThe benefits of .NET \", \"Core come from these three characteristics:\\n\\n- Cross-platform: It allows application execution on di\", \"fferent platforms (Windows, macOS, and Linux).\\n- Open source: .NET Core platform is open source and \", \"available through GitHub, fostering transparency and community contributions.\\n- Supported: Microsoft\", \" officially supports .NET Core.\\n\\nStarting with .NET Core 3.0, besides the existing support for web a\", \"nd cloud, there's also support for desktop, IoT, and AI domains. The goal for this framework is impr\", \"essive: to target every type of .NET development present and future.\\n\\n## .NET 5+ is .NET Core vNext\\n\", \"\\n.NET 5 was the next step forward with .NET Core. .NET 5 improved .NET in a few key ways:\\n\\n- Produce\", \"d a single .NET runtime and framework that can be used everywhere and that has uniform runtime behav\", \"iors and developer experiences.\\n- Expanded the capabilities of .NET by taking the best of .NET Core,\", \" .NET Framework, Xamarin, and Mono.\\n- Built that product out of a single code-base that developers (\", \"Microsoft and the community) can work on and expand together and that improves all scenarios.\\n\\n.NET \", \"5 was a game-changer for .NET. With .NET 5 and later versions, your code and project files look and \", \"feel the same no matter which type of app you're building. You have access to the same runtime, APIs\", \", and language capabilities with each app. This includes new performance improvements that get commi\", \"tted to the runtime almost daily. .NET 6 and .NET 7 made further improvements in reliability, perfor\", \"mance, new APIs, and language features. For more details, see What's new in .NET 5 , What's new in .\", \"NET 6, and What's new in .NET 7 .\\n\\n.NET - A unified platform\\n\\nDESKTOP\\n\\n## WEL CLOUD MOBILE GAMING lo\", \"T Al\\n\\nWPF\\n\\nWindows Forms\\n\\nUMP\\n\\nRUNTIME COMPONENTS\\n\\nASP NET\\n\\nXamarin\\n\\nUnity\\n\\nARM32\\n\\nMLNET\\n\\nNET for\\n\\nT\", \"OOLS\\n\\nVISUAL STUDIO\\n\\n<!-- image -->\\n\\n## .NET Framework vs. .NET\\n\\nSo now that you understand the rele\", \"vance of .NET, you might be wondering what happens with .NET Framework. You could be asking question\", \"s like: Do I have to abandon it? Is it going to disappear? What are my choices to modernize the appl\", \"ications I have on .NET Framework?\\n\\nIn 2019, .NET Framework 4.8 was released. It included three majo\", \"r improvements for desktop applications:\\n\\n- Modern browser and media controls : New controls were ad\", \"ded that take advantage of Microsoft Edge and newer media players that support the latest standards.\", \"\\n- Access to UWP controls : UWP introduced controls that take advantage of the latest Windows featur\", \"es and touch displays. With .NET Framework 4.8, you don't have to rewrite your applications to use t\", \"hese new features and controls, so you can use these new features in your existing WPF or Windows Fo\", \"rms code.\\n- High-DPI improvements : The resolution of displays increased to 4K and 8K, so, .NET Fram\", \"ework 4.8 added new HDPI improvements to make sure existing Windows Forms and WPF applications can l\", \"ook great on these new displays.\\n\\nSince .NET Framework is installed on millions of machines, Microso\", \"ft will continue to support it but won't add new features.\\n\\n.NET (Core) is the open-source, cross-pl\", \"atform, and fast-moving version of the .NET family. Because of its side-by-side nature, it can take \", \"changes without the fear of breaking any application. This means that .NET will get new APIs and lan\", \"guage features o ver time that .NET Framework won't. Also, .NET already has features that were impos\", \"sible for .NET Framework, such as:\\n\\n- Side-by-side versions of .NET supporting Windows Forms and WPF\", \" : This solves the problem of side effects when updating the machine's framework version. Multiple v\", \"ersions of .NET can be installed on the same machine and each application specifies which version of\", \"\\n\\nUpdate .NET Framework Apps\\n\\nExistind\\n\\nHighly\\n\\nApp compatible\\n\\nupdates\\n\\nModernize Desktop Apps with\", \" NET Core 3\\n\\nNET Core\\n\\nDesktop\\n\\n3.0 with\\n\\nPacks testall NET\\n\\nper your\\n\\nCore updates needs\\n\\n.NET it s\", \"hould use. Even more, now you can develop and run Windows Forms and WPF on top of .NET.\\n\\n- Embed .NE\", \"T directly into an application : You can deploy .NET as part of your application package. This enabl\", \"es you to take advantage of the latest version, features, and APIs without having to wait for a spec\", \"ific version to be installed on the machine.\\n- Take advantage of .NET features : .NET is fast-moving\", \" and open-source. Its side-by-side nature enables fast introduction of new innovative APIs and Base \", \"Class Library (BCL) improvements without the risk of breaking compatibility. Now Windows Forms and W\", \"PF applications can take advantage of the latest .NET features, which also includes fundamental fixe\", \"s for things like runtime performance and high-DPI support. NET STANDARD\\n\\n.NET Framework will be ful\", \"ly supported and will always be a part of Windows. However, if you want to use the newest language f\", \"eatures and APIs in the future, you'll need to move your applications to .NET. For brand-new desktop\", \" apps, we recommend starting d irectly on .NET 6 or a later version. It's lightweight and cross-plat\", \"form, runs side by side, has high performance, and fits perfectly on containers and microservices ar\", \"chitectures.\\n\\n<!-- image -->\\n\\n## .NET Standard vs. PCL\\n\\n.NET Standard is a formal specification of .\", \"NET APIs that are intended to be available on all .NET implementations. The motivation behind .NET S\", \"tandard was to establish greater uniformity in the .NET ecosystem. .NET Standard is a specification \", \"of .NET APIs that make up a uniform set of contracts to compile your code against. These contracts a\", \"re implemented in each .NET flavor, thus enabling portability across different .NET implementations.\", \"\\n\\n.NET Standard enables the following key scenarios:\\n\\n- Defines uniform set of base class libraries \", \"APIs for all .NET implementations to implement, independent of the workload.\\n- Enables developers to\", \" produce portable libraries that are usable across .NET implementations, using this same set of APIs\", \".\\n\\n.NET Standard is the evolution of PCLs and the following list shows the fundamental differences b\", \"etween .NET Standard and PCLs:\\n\\n- .NET Standard is a set of curated APIs, picked by Microsoft. PCLs \", \"aren't.\\n- The APIs that a PCL contains are dependent on the platforms that you choose to target when\", \" you create it. This makes a PCL only sharable for the specific targets that you choose.\\n- .NET Stan\", \"dard is platform-agnostic, so it can run on Windows, macOS, and Linux.\\n- PCLs can also run cross-pla\", \"tform, but they can only target a limited set of platforms.\\n\\n## New Desktop features in .NET\\n\\n## Sup\", \"port for Windows Forms and WPF\\n\\nWindows Forms and WPF are part of .NET Core since version 3.0. Both \", \"presentation frameworks are for Windows only, so they aren't cross -platform. You can think of WPF a\", \"s a rich layer over DirectX and Windows Forms as a thinner layer over GDI+. WPF and Windows Forms do\", \" a great job of exposing and exercising much of the desktop application functionality in Windows. So\", \" Windows Forms and WPF are available for .NET Core and .NET Framework. Target your new desktop appli\", \"cations to .NET 6 or later, and migrate your existing apps from .NET Framework to .NET 6 or later.\\n\\n\", \"A new version of .NET Standard, version 2.1, was released at the same time as .NET Core 3.0. To see \", \"which .NET implementations support which .NET Standard versions, see Which .NET Standard version to \", \"target.\\n\\nThe .NET (Core) implementations for both Windows Forms and WPF are open source.\\n\\n## XAML Is\", \"lands\\n\\nXAML Islands is a set of components for developers to use Windows 10 controls (UWP XAML contr\", \"ols) in their WPF, Windows Forms, and native Win32 apps (like MFC). You can have your 'islands' of U\", \"WP XAML controls wherever you want inside your Win32 apps.\\n\\nThese XAML Islands are possible because \", \"Windows 10, version 1903 introduced a set of APIs that allows hosting UWP XAML content in Win32 wind\", \"ows using windows handlers (HWnds). Only apps running on Windows 10 1903 and later can use XAML Isla\", \"nds.\\n\\nTo make it easier to create XAML Islands for Windows Forms and WPF developers, the Windows Com\", \"munity Toolkit introduces a set of .NET wrappers in several NuGet packages. Those wrappers are the w\", \"rapped and hosting controls:\\n\\n- The WebView, WebViewCompatible, InkCanvas, MediaPlayerElement, and M\", \"apControl wrapped controls wrap some UWP XAML controls into Windows Forms or WPF controls, hiding UW\", \"P concepts for those developers.\\n- The WindowsXamlHost control for Windows Forms and WPF allows othe\", \"r not-wrapped UWP XAML controls and custom controls to be loaded into a XAML Island.\\n\\n## Access to a\", \"ll Windows 10 and Windows 11 APIs\\n\\nWindows 10 and Windows 11 have a large number of APIs available f\", \"or developers to work with. These APIs give access to a wide variety of functionality like authentic\", \"ation, bluetooth, appointments, and contacts. Now these APIs are exposed through .NET and give Windo\", \"ws developers the chance to create powerful desktops apps using the capabilities present on Windows \", \"10 and Windows 11.\\n\\n## Side-by-side support and self-contained EXEs\\n\\nThe .NET deployment model is on\", \"e of the biggest benefits that Windows desktop developers will experience with .NET. The ability to \", \"globally install .NET provides much of the same central installation and servicing benefits of .NET \", \"Framework, while not requiring in-place updates.\\n\\nWhen a new .NET version is released, you can updat\", \"e each app on a machine as needed without any concern of affecting other applications. New .NET vers\", \"ions are installed in their own directories and exist 'side -byside' with each other.\\n\\nIf you need t\", \"o deploy with isolation, you can deploy .NET with your application. .NET will bundle your app with t\", \"he .NET runtime as a single executable. The modular architecture used by .NET makes these flexible d\", \"eployment options possible.\\n\\n## Performance\\n\\nSince its start, targeting the web and cloud workloads,\", \" .NET has had performance plugged into its DNA. Server-side code must be performant enough to fulfil\", \"l high-concurrency scenarios and .NET 7 scores today as the best performance web platform in the mar\", \"ket.\\n\\nOld Windows Forms code has been refactored for .NET, which reduced memory allocations for draw\", \"ing Forms and Controls. By simply upgrading from .NET Framework to .NET or later, your applications \", \"become much faster. You can take advantage of these performance improvements when you use .NET to bu\", \"ild your next generation of desktop applications.\\n\\n## Migrating Modern Desktop applications\\n\\nIn this\", \" chapter, we're exploring the most common issues and challenges you can face when migrating an exist\", \"ing application from .NET Framework to .NET.\\n\\nIf you just want to update your application to the lat\", \"est .NET version using a tool and not get into the details of what's happening behind the scenes, fe\", \"el free to skip this chapter and find step -by-step instructions in the Example of migrating to .NET\", \" chapter.\\n\\nA complex desktop application doesn't work in isolation and needs some kind of interactio\", \"n with subsystems that may reside on the local machine or on a remote server. It will probably need \", \"some kind of database to connect with as a persistence store either locally or remotely. With the ri\", \"se of Internet and serviceoriented architectures, it's common to have your application connected to \", \"some sort of service residing on a remote server or in the cloud. You may need to access the machine\", \" file system to implem ent some functionality. Alternatively, maybe you're using a piece of function\", \"ality that resides inside a COM object outside your application, which is a common scenario if, for \", \"example, you're integrating Office assemblies in your app.\\n\\nBesides, there are differences in the AP\", \"I surface that is exposed by .NET Framework and .NET, and some features that are available on .NET F\", \"ramework aren't available on .NET. It's important for you to know and take them into account when pl\", \"anning a migration.\\n\\n## Configuration files\\n\\nConfiguration files offer the possibility to store sets\", \" of properties that are read at run time and can affect the behavior of your app, such as where to l\", \"ocate a database or how many times to execute a loop. The beauty of this technique is that you can m\", \"odify some aspects of the application without the need to recode and recompile. This comes in handy \", \"when, for example, the same app code runs on a development environment with a certain set of configu\", \"ration values and in production environment with a different set.\\n\\n## Configuration on .NET Framewor\", \"k\\n\\nIf you have a working .NET Framework desktop application, chances are you have an app.config file\", \" accessed through the AppSettingsSection class from the System.Configuration namespace.\\n\\nWithin the \", \".NET Framework infrastructure, there's a hierarchy of configuration files that inherit properties fr\", \"om its parents. You can find a machine.config file that defines many properties and configuration se\", \"ctions that can be used or overridden in any descendant configuration file.\\n\\n## Configuration on .NE\", \"T\\n\\nIn the .NET world, there's no machine.config file. And even though you can continue to use the ol\", \"d fashioned System.Configuration namespace, you may consider switching to the modern Microsoft.Exten\", \"sions.Configuration, which offers a good number of enhancements.\\n\\nThis configuration API supports th\", \"e concept of a configuration provider, which defines the data source to be used to load the configur\", \"ation. There are different kinds of built-in providers, such as:\\n\\n- In-memory .NET objects\\n- INI fil\", \"es\\n- JSON files\\n- XML files\\n- Command-line arguments\\n- Environment variables\\n- Encrypted user store\\n\", \"\\nOr you can build your own.\\n\\nThe new configuration API allows a list of name-value pairs that can be\", \" grouped into a multi-level hierarchy. Any stored value maps to a string, and there's built -in bind\", \"ing support that allows you to deserialize settings into a custom plain old CLR object (POCO).\\n\\nThe \", \"ConfigurationBuilder object lets you add as many configuration providers as you may need for your ap\", \"plication. A precedence rule is used to resolve provider preference. So, the last provider you add i\", \"n your code overrides the others. This is a great feature for managing different environments for ex\", \"ecution since you can define different configurations for development, testing, and production envir\", \"onments. And you can manage them in a single function inside your code.\\n\\n## Migrating configuration \", \"files\\n\\nYou can continue to use your existing app.config XML file. However, you could take this oppor\", \"tunity to migrate your configuration to benefit from the several enhancements made in .NET.\\n\\nTo migr\", \"ate from an old-style app.config to a new configuration file, you should choose between an XML forma\", \"t and a JSON format.\\n\\nIf you choose XML, the conversion is straightforward. Since the content is the\", \" same, just save the app.config file with XML as type. Then, change the code that references AppSett\", \"ings to use the ConfigurationBuilder class. This change should be easy.\\n\\nIf you want to use a JSON f\", \"ormat and you don't want to migrate by hand, there's a tool called dotnetconfig2json that can conver\", \"t an app.config file to a JSON configuration file.\\n\\nYou may come across some issues when using confi\", \"guration sections that were defined in the machine.config file. For example, consider the following \", \"configuration:\\n\\n```\\n< configuration > < system.diagnostics > < switches > < add name=\\\"General\\\" value\", \"=\\\"4\\\" /> </ switches > < trace autoflush=\\\"true\\\" indentsize=\\\"2\\\"> < listeners > < add name=\\\"myListener\\\"\", \" type=\\\"System.Diagnostics.TextWriterTraceListener, System, Version=1.0.3300.0, Culture=neutral, Publ\", \"icKeyToken=b77a5c561934e089\\\" initializeData=\\\"MyListener.log\\\" traceOutputOptions=\\\"ProcessId, LogicalO\", \"perationStack, Timestamp, ThreadId, Callstack, DateTime\\\" /> </ listeners > </ trace > </ system.diag\", \"nostics > </ configuration >\\n```\\n\\nIf you take this configuration to a .NET app, you'll get an except\", \"ion:\\n\\nUnrecognized configuration section System.Diagnostics\\n\\nThis exception occurs because that sect\", \"ion and the assembly responsible for handling that section was defined in the machine.config file, w\", \"hich now doesn't exist.\\n\\nTo easily fix the issue, you can copy the section definition from your old \", \"machine.config to your new configuration file:\\n\\n```\\n< configSections > < section name=\\\"system.diagno\", \"stics\\\" type=\\\"System.Diagnostics.SystemDiagnosticsSection, System, Version=4.0.0.0, Culture=neutral, \", \"PublicKeyToken=b77a5c561934e089\\\"/> </ configSections >\\n```\\n\\n## Accessing databases\\n\\nAlmost every des\", \"ktop application needs some kind of database. For desktop, it's common to find client-server archite\", \"ctures with a direct connection between the desktop app and the database engine. These databases can\", \" be local or remote depending on the need to share information between different users.\\n\\nFrom the co\", \"de perspective, there have been many technologies and frameworks to give the developer the possibili\", \"ty to connect, query, and update a database.\\n\\nThe most common examples of database you can find when\", \" talking about Windows Desktop application are Microsoft Access and Microsoft SQL Server. If you hav\", \"e more than 20 years of experience programming for the desktop, names like ODBC, OLEDB, RDO, ADO, AD\", \"O.NET, LINQ, and Entity Framework will sound familiar.\\n\\n## ODBC\\n\\nYou can continue to use ODBC on .NE\", \"T since Microsoft is providing the System.Data.Odbc library compatible with .NET Standard 2.0.\\n\\n## O\", \"LE DB\\n\\nOLE DB has been a great way to access various data sources in a uniform manner. But it was ba\", \"sed on COM, which is a Windowsonly technology, and as such wasn't the best fit for a cross -platform\", \" technology such as .NET. It's also unsupported in SQL Server version s 2014 and later. For those re\", \"asons, OLE DB won't be supported by .NET.\\n\\n## ADO.NET\\n\\nYou can still use ADO.NET from your existing \", \"desktop code on .NET. You just need to update some NuGet packages.\\n\\n## EF Core vs. EF6\\n\\nThere are tw\", \"o currently supported versions of Entity Framework (EF), Entity Framework 6 (EF6) and EF Core.\\n\\nThe \", \"latest technology released as part of the .NET Framework world is Entity Framework, with 6.4 being t\", \"he latest version. With the launch of .NET Core, Microsoft also released a new data access stack bas\", \"ed on Entity Framework and called Entity Framework Core.\\n\\nYou can use EF 6.4 and EF Core from both .\", \"NET Framework and .NET. So, what are the decision drivers to help to decide between the two?\\n\\nEF 6.3\", \" is the first version of EF6 that can run on .NET and work cross-platform. In fact, the main goal of\", \" this release was to make it easier to migrate existing applications that use EF6 to .NET.\\n\\nEF Core \", \"was designed to provide a developer experience similar to EF6. Most of the top-level APIs remain the\", \" same, so EF Core will feel familiar to developers who have used EF6.\\n\\nAlthough compatible, there ar\", \"e differences on the implementation you should check before making a decision. For more information,\", \" see Compare EF Core &amp; EF6.\\n\\nThe recommendation is to use EF Core if:\\n\\n- The app needs the capab\", \"ilities of .NET.\\n- EF Core supports all of the features that the app requires.\\n\\nConsider using EF6 i\", \"f both of the following conditions are true:\\n\\n- The app will run on Windows and .NET Framework 4.0 o\", \"r later.\\n- EF6 supports all of the features that the app requires.\\n\\n## Relational databases\\n\\n## SQL \", \"Server\\n\\nSQL Server has been one of the databases of choice if you were developing for the desktop so\", \"me years ago. With the use of System.Data.SqlClient in .NET Framework, you could access versions of \", \"SQL Server, which encapsulates database-specific protocols.\\n\\nIn .NET, you can find a new SqlClient c\", \"lass, fully compatible with the one existing in the .NET Framework but located in the Microsoft.Data\", \".SqlClient library. You just have to add a reference to the Microsoft.Data.SqlClient NuGet package a\", \"nd do some renaming for the namespaces and everything should work as expected.\\n\\n## Microsoft Access\\n\", \"\\nMicrosoft Access has been used for years when the sophisticated and more scalable SQL Server wasn't\", \" needed. You can still connect to Microsoft Access using the System.Data.Odbc library.\\n\\n## Consuming\", \" services\\n\\nWith the rise of service-oriented architectures, desktop applications began to evolve fro\", \"m a clientserver model to the three-layer approach. In the client-server approach, a direct database\", \" connection is established from the client holding the business logic, usually inside a single EXE f\", \"ile. On the other hand, the three-layer approach establishes an intermediate service layer implement\", \"ing business logic and database access, allowing for better security, scalability, and reusability. \", \"Instead of working directly with underlying data, the layered approach relies on a set of services i\", \"mplementing contracts and typed objects for data transfer.\\n\\nIf you have a desktop application using \", \"a WCF service and you want to migrate it to .NET, there are some things to consider.\\n\\nThe first thin\", \"g is how to resolve the configuration to access the service. Because the configuration is different \", \"on .NET, you'll need to make some updates in your configuration file.\\n\\nSecond, you'll need to regene\", \"rate the service client with the new tools present on Visual Studio 2019 and Visual Studio 2022. In \", \"this step, you must consider activating the generation of the synchronous operations to make the cli\", \"ent compatible with your existing code.\\n\\nAfter the migration, if you find that there are libraries y\", \"ou need that aren't present on .NET, you can add a reference to the Microsoft.Windows.Compatibility \", \"NuGet package and see if the missing functions are there.\\n\\nIf you're using the WebRequest class to p\", \"erform web service calls, you may find some differences on .NET. The recommendation is to use HttpCl\", \"ient instead.\\n\\n## Consuming a COM Object\\n\\nCurrently, there's no way to add a reference to a COM obje\", \"ct from Visual Studio 2019 or Visual Studio 2022 to use with .NET. So, you have to manually modify t\", \"he project file.\\n\\nInsert a COMReference structure inside the project file like in the following exam\", \"ple:\\n\\n```\\n< ItemGroup > < COMReference Include=\\\"MSHTML\\\"> < Guid >{3050F1C5-98B5-11CF-BB82-00AA00BDCE\", \"0B}\\\\</ Guid > < VersionMajor >4</ VersionMajor > < VersionMinor >0</ VersionMinor > < Lcid >0</ Lcid\", \" > < WrapperTool >primary</ WrapperTool > < Isolated >false</ Isolated > </ COMReference > </ ItemGr\", \"oup >\\n```\\n\\n## More things to consider\\n\\nSeveral technologies available to .NET Framework libraries ar\", \"en't available for .NET Core or .NET 7. If your code relies on some of these technologies, consider \", \"the alternative approaches outlined in this section.\\n\\nThe Windows Compatibility Pack provides access\", \" to APIs that were previously available only for .NET Framework. It can be used on .NET Core and .NE\", \"T Standard projects.\\n\\nFor more information on API compatibility, you can find documentation about br\", \"eaking changes and deprecated/legacy APIs at https://learn.microsoft.com/dotnet/core/compatibility/f\", \"x-core.\\n\\n## AppDomains\\n\\nApplication domains (AppDomains) isolate apps from one another. AppDomains r\", \"equire runtime support and are expensive. Creating additional app domains isn't supported. For code \", \"isolation, we recommend separate processes or using containers as an alternative. For the dynamic lo\", \"ading of assemblies, we recommend the new AssemblyLoadContext class.\\n\\nTo make code migration from .N\", \"ET Framework easier, .NET exposes some of the AppDomain API surface. Some of the APIs function norma\", \"lly (for example, AppDomain.UnhandledException), some members do nothing (for example, SetCachePath)\", \", and some of them throw PlatformNotSupportedException (for example, CreateDomain).\\n\\n## Remoting\\n\\n.N\", \"ET Remoting was used for cross-AppDomain communication, which is no longer supported. Also, Remoting\", \" requires runtime support, which is expensive to maintain. For these reasons, .NET Remoting isn't su\", \"pported on .NET.\\n\\nFor communication across processes, you should consider inter-process communicatio\", \"n (IPC) mechanisms as an alternative to Remoting, such as the  or the MemoryMappedFile class.\\n\\nAcros\", \"s machines, use a network-based solution as an alternative. Preferably, use a low-overhead plaintext\", \" protocol, such as HTTP. The Kestrel web server, the web server used by ASP.NET Core, is an option h\", \"ere.\\n\\n## Code Access Security (CAS)\\n\\nSandboxing, which relies on the runtime or the framework to con\", \"strain which resources a managed application or library uses or runs, isn't supported on .NET.\\n\\nUse \", \"security boundaries that are provided by the operating system, such as virtualization, containers, o\", \"r user accounts, for running processes with the minimum set of privileges.\\n\\n## Security Transparency\", \"\\n\\nSimilar to CAS, Security Transparency separates sandboxed code from security critical code in a de\", \"clarative fashion but is no longer supported as a security boundary.\\n\\nUse security boundaries that a\", \"re provided by the operating system, such as virtualization, containers, or user accounts, for runni\", \"ng processes with the least set of privileges.\\n\\n## Windows 10 migration\\n\\nConsider the following situ\", \"ation: You have a working desktop application that was developed in the Windows 7 days. It's using W\", \"PF technology available at that time and working fine but it has an outdated UI and behaviors when y\", \"ou run it on Windows 10 or Windows 11. It is like when you watch a futuristic movie like Matrix and \", \"you see Neo using the Nokia 8110 device. The film works great after 20 years but it would rather ben\", \"efit from a device modernization.\\n\\nWith the release of Windows 10, Microsoft introduced many innovat\", \"ions to support scenarios like tablets and touch devices and to provide the best experience for user\", \"s for a Microsoft operating system ever. For example, you can:\\n\\n- Sign in with your face using Windo\", \"ws Hello.\\n- Use a pen to draw or handwrite text that is automatically recognized and digitalized.\\n- \", \"Run locally customized AI models built on the cloud using WinML.\\n\\nAll these features are enabled for\", \" Windows developers through Windows Runtime (WinRT) libraries. You can take advantage of these featu\", \"res in your existing desktop apps because the libraries are exposed to both the .NET Framework and .\", \"NET as well. You can even modernize your UI with the use of XAML Islands and improve the visuals and\", \" behavior of your apps according to the times.\\n\\nOne important thing to note here is that you don't n\", \"eed to abandon .NET Framework technology to follow this modernization path. You can safely stay on t\", \"here and have all the benefits of Windows 10 and Windows 11 without the pressure to migrate to .NET.\", \" So, you get both the power and the flexibility to choose your modernization path.\\n\\n## WinRT APIs\\n\\nW\", \"inRT APIs are object-oriented, well-structured application programming interfaces (APIs) that give W\", \"indows 10 and Windows 11 developers access to everything the operating system has to offer. Through \", \"WinRT APIs, you can integrate functionalities like Push Notifications, Device APIs, Microsoft Ink, a\", \"nd WinML, among others on your desktop apps.\\n\\nIn general, WinRT APIs can be called from a classic de\", \"sktop app. However, two main areas present an exception to this rule:\\n\\n- APIs that require a package\", \" identity.\\n- APIs that require visualization like XAML or Composition.\\n\\n<!-- image -->\\n\\n## Universal\", \" Windows Platform (UWP) packages\\n\\n## Application Package Identity\\n\\nUWP apps have a deployment system\", \" where the OS manages the installation and uninstallation of application. That requires the installa\", \"tion to be declarative, meaning that no user code is executed during install. Instead, everything th\", \"e app wants to integrate with the system, such as protocols, file types, and extensions, is declared\", \" in the application manifest. At deployment time, the deployment pipeline configures those integrati\", \"on points. The only way for the OS to manage all this functionality and keep tr ack of it is for eac\", \"h 'package' to have an identity, a unique identifier for the application.\\n\\nSome WinRT APIs require t\", \"his package identity to work as expected. However, classic desktop apps like native C++ or .NET apps\", \", use different deployment systems that don't require a package identity. If you want to use these W\", \"inRT APIs in your desktop application, you need to provide them a package identity.\\n\\nOne way to proc\", \"eed is to build an additional packaging project. Inside the packaging project, you point to the orig\", \"inal source code project and specify the Identity information you want to provide. If you install th\", \"e package and run the installed app, it will automatically get an identify enabling your code to cal\", \"l all WinRT APIs requiring Identity.\\n\\n```\\n<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?> < Package xmlns=\\\"ht\", \"tp://schemas.microsoft.com/appx/manifest/foundation/windows10\\\" xmlns:uap=\\\"http://schemas.microsoft.c\", \"om/appx/manifest/uap/windows10\\\"> < Identity Name=\\\"YOUR-APP-GUID \\\" Publisher=\\\"CN=YOUR COMPANY\\\" Versio\", \"n=\\\"1.x.x.x\\\" /> </ Package >\\n```\\n\\nYou can check which APIs need a packaged application identity by in\", \"specting if the type that contains the API is marked with the DualApiPartition attribute. If it is, \", \"you can call if from an unpackaged traditional desktop app. Otherwise, you must convert your classic\", \" desktop app to a UWP with the help of a packaging project.\\n\\nhttps://learn.microsoft.com/windows/des\", \"ktop/apiindex/uwp-apis-callable-from-a-classic-desktop-app\\n\\n## Benefits of packaging\\n\\nBesides giving\", \" you access to these APIs, you get some additional benefits by creating a Windows App package for yo\", \"ur desktop application including:\\n\\n- Streamlined deployment . Apps have a great deployment experienc\", \"e ensuring that users can confidently install an application and update it. If a user chooses to uni\", \"nstall the app, it's removed completely with no trace left behind preventing the Windows rot problem\", \".\\n- Automatic updates and licensing . Your application can participate in the Microsoft Store's buil\", \"t-in licensing and automatic update facilities. Automatic update is a highly reliable and efficient \", \"mechanism, because only the changed parts of files are downloaded.\\n\\n- Increased reach and simplified\", \" monetization . Maybe not your case but if you choose to distribute your application through the Mic\", \"rosoft Store you reach millions of Windows 10 and Windows 11 users.\\n- Add UWP features . You can add\", \" UWP features to your app's package at your own pace.\\n\\n## Prepare for packaging\\n\\nBefore proceeding t\", \"o package your desktop application, there are some points you have to address before starting the pr\", \"ocess. Your application must respect any of the Microsoft Store rules and policies and run in the UW\", \"P application model. For example, it has to run on the .NET Framework 4.6.2 or later and writes to t\", \"he HKEY\\\\_CURRENT\\\\_USER registry hive and the AppData folders will be virtualized to a user-specific \", \"app-local location.\\n\\nThe design goal for packaging is to separate the application state from system \", \"state while maintaining compatibility with other apps. Windows 10 and Windows 11 accomplish this goa\", \"l by placing the application inside a UWP package. It detects and redirects some changes to the file\", \" system and registry at run time to fulfill the promise of a trusted and clean install and uninstall\", \" behavior of an application provided by packaging.\\n\\nPackages that you create for your desktop applic\", \"ation are desktop-only, full-trust applications that aren't sandboxed, although there's lightweight \", \"virtualization applied to the app for writes to HKCU and AppData. This virtualization allows them to\", \" interact with other apps the same way classic desktop applications do.\\n\\n## Installation\\n\\nApp packag\", \"es are installed under %ProgramFiles%\\\\WindowsApps\\\\package\\\\_name , with the executable titled app\\\\_na\", \"me.exe. Each package folder contains a manifest (named AppxManifest.xml) that contains a special XML\", \" namespace for packaged apps. Inside that manifest file is an &lt;EntryPoint&gt; element, which refe\", \"rences the full-trust app. When that application is launched, it doesn't run inside an app container\", \", but instead it runs as the user as it normally would.\\n\\nAfter deployment, package files are marked \", \"read-only and heavily locked down by the operating system. Windows prevents apps from launching if t\", \"hese files are tampered with.\\n\\n## File system\\n\\nThe OS supports different levels of file system opera\", \"tions for packaged desktop applications, depending on the folder location.\\n\\nWhen trying to access th\", \"e user's AppData folder, the system creates a private per-user, per-app location behind the scenes. \", \"This creates the illusion that the packaged application is editing the real AppData when it's actual\", \"ly modifying a private copy. By redirecting writes this way, the system can track all file modificat\", \"ions made by the app. It can then clean all those files when uninstalling reducing system 'rot' and \", \"providing a better application removal experience for the user.\\n\\n## Registry\\n\\nApp packages contain a\", \" registry.dat file, which serves as the logical equivalent of HKLM\\\\Software in the real registry. At\", \" run time, this virtual registry merges the contents of this hive into the native system hive to pro\", \"vide a singular view of both.\\n\\nAll writes are kept during package upgrade and only deleted when the \", \"application is uninstalled.\\n\\n## Uninstallation\\n\\nWhen the user uninstalls a package, all files and fo\", \"lders located under C:\\\\Program Files\\\\WindowsApps\\\\package\\\\_name are removed, as well as any redirecte\", \"d writes to AppData or the registry that were captured during the process.\\n\\nFor details about how a \", \"packaged application handles installation, file access, registry, and uninstallation, see https://le\", \"arn.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-thescenes.\\n\\nYou can get a complete list\", \" of things to check on https://learn.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare.\\n\\n## \", \"How to add WinRT APIs to your desktop project\\n\\nIn this section, you can find a walkthrough on how to\", \" integrate Toast Notifications in an existing WPF application. Although it's simple from the code pe\", \"rspective, it helps illustrate the whole process. Notifications are one of the many available WinRT \", \"APIs available that you can use in .NET app. In this case, the API requires a Package Identity. This\", \" process is more straightforward if the APIs don't require Package Identity.\\n\\nLet's take an existing\", \" WPF sample app that reads files and shows its contents on the screen. The goal is to display a Toas\", \"t Notification when the application starts.\\n\\nNotification Class (Winc https://docs.microsoft.com/en-\", \"w//Uwp/apv/w\\n\\n\\u2022E File Loaded: C:\\\\Users\\\\martafuentes\\\\Desktop\\\\TestFile.txt\\n\\nMicrosoft\\n\\nClear \\u2022\\n\\nWrao C\", \"ontent indows ut notifications not/fication\\n\\nWindows Dev Center UP appr\\n\\nDrop a single file below Ep\", \"\\n\\nGet started Design Develop Publch Resources -\\n\\nDoc / Windows / UWP. / APt reference / WindowUlNotf\", \"ications / Notification\\n\\nCall Windows 10 APls:\\n\\nFilter by title\\n\\nTest content file\\n\\nWindow Ul Notifi\", \"cations\\n\\nAdaptiveNotificationContent\\n\\n&gt; AdaptiveNobficationTest\\n\\n\\u2022 BadgeNotification\\n\\nBadge Templ\", \"ate Type\\n\\n&gt; Badgedpdate Manager\\n\\n\\u00bb BadgeLpdateManagerfortiser\\n\\n&gt; BadgeUpdater\\n\\n\\u2022 AdaptiveNotif\", \"icationContent\\n\\n\\u2022 KnownAdaptiveNotificationkints\\n\\n*\\n\\n*\\n\\nDashboard\\n\\nMents.\\n\\nCev (Feedback @ Share ** \", \"Theme Sign in\\n\\nIn this article\\n\\n[Definition\\n\\nComtructors\\n\\n1029\\n\\n1044 IS 1100/2019 F\\n\\nFirst, you shou\", \"ld check in the following link whether the Windows 10 or Windows 11 API that you'll use requires a P\", \"ackage Identity:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop/modernize/desktop-to-uwp-supporte\", \"d-api\\n\\nOur sample will use the Windows.UI.Notifications.Notification API that requires a packaged id\", \"entity:\\n\\n<!-- image -->\\n\\nTo access the WinRT API, add a reference to the Microsoft.Windows.SDK.Contr\", \"acts NuGet package and this package will do the magic behind the scenes (see details at https://blog\", \"s.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktopapplication-just-got\", \"-easier/).\\n\\nYou're now prepared to start adding some code.\\n\\n<!-- image -->\\n\\n\\u203a KnownAdaptiveNotificat\", \"ionTextStyles\\n\\n\\u2022 Known Notification\\u00aeindings\\n\\n- Notification\\n\\nNotification\\n\\n+ Download PDF\\n\\n\\u2022 Escribe\", \" aqui para buscar\\n\\nNotification Class\\n\\nWindows 10 requirements\\n\\nDevice turniy\\n\\nWindows 10 Anniversar\", \"y Edition fetroduced v10.0.14393 0)\\n\\nA/s contract\\n\\nWindows. Foundation UniversalApiContractintroduce\", \"d v3)\\n\\nConstructors\\n\\nX\\n\\nAdd New Project\\n\\n\\u2022 Recent\\n\\n4 Installed\\n\\n\\u2022 Visual C#\\n\\nGet Started\\n\\nWindows De\", \"sktop\\n\\n\\u2022 Web\\n\\n\\u2022 Office/SharePoint\\n\\n.NET Core\\n\\n.NET Standard\\n\\nAndroid\\n\\nApple TV\\n\\nApple Watch\\n\\nCloud\\n\\n\", \"Cross-Platform\\n\\nExtensibility iOS Extensions\\n\\niPhone &amp; iPad\\n\\nTest\\n\\nWCF\\n\\nWorkflow\\n\\n\\u2022 Azure Data L\", \"ake\\n\\nAlthough the project builds, there are errors because the Notifications API requires a Package \", \"Identity and you didn't provide it. Adding a Windows Packaging Project to the solution will fix the \", \"issue:\\n\\nNot finding what you are looking for?\\n\\nOpen Visual Studio Installer\\n\\nName:\\n\\nLocation:\\n\\n<!-- \", \"image -->\\n\\nSelect the minimum Windows version you want to support and the version you're targeting. \", \"Not all the WinRT APIs are supported in all Windows 10 and Windows 11 versions. Each Windows 10 or W\", \"indows 11 update adds new APIs that are only available from this version; downlevel support isn't av\", \"ailable.\\n\\nSort by: Default\\n\\n\\u2022 # E\\n\\nBlank App (Universal Windows)\\n\\nClass Library (Universal Windows)\\n\", \"\\nVisual C#\\n\\nVisual C#\\n\\nSearch (CtrI+ E)\\n\\nType: Visual C#\\n\\nA project that creates packages containing\", \"\\n\\nWindows applications for side-loading or\\n\\nCreate a ShowToastNotification method that will be calle\", \"d on application startup. It just builds a toast notification from an XML pattern:\\n\\n```\\nprivate void\", \" ShowNotification(string title, string content, string image) { string xmlString = $@\\\"<toast><visual\", \"><binding template = 'ToastGeneric'><text>{title}</text><text>{content}</text><image src=>'{image}'<\", \"/image></binding></visual></toast>\\\"; XmlDocument toastXml = new XmlDocument(); toastXml.LoadXml(xmlS\", \"tring); ToastNotification toast = new ToastNotification(toastXml); ToastNotificationManager.CreateTo\", \"astNotifier().Show(toast); } Optional Code Package (Universal Windows) Unit Test App (Universal Wind\", \"ows) Visual C# Visual C#\\n```\\n\\n?\\n\\nNew Universal Windows Platform Project\\n\\nSelect the target and minim\", \"um platform versions that your UWP application will support.\\n\\nTarget version:\\n\\nMinimum version:\\n\\nWhi\", \"ch version should I choose?\\n\\n<!-- image -->\\n\\nNext step is to add the WPF application to the Windows \", \"Packaging Project by adding a project reference:\\n\\nSolution Explorer\\n\\n-\\n\\nSearch Solution Explorer (Ct\", \"rl+\\\")\\n\\na. Solution 'ShowFileWPFApplication' (2 projects)\\n\\nC*\\n\\nShowFileWpf\\n\\n/ Properties\\n\\n\\u2022-\\u2022 Referen\", \"ces\\n\\nApp.config\\n\\nApp.xaml\\n\\n\\u2022 ShowFileWPFApp.Package\\n\\n\\u2022 Apalicatinna\\n\\nIm\\n\\nReference Manager - ShowFil\", \"eWPFApp.Package\\n\\n4 Projects\\n\\nSolution\\n\\n<!-- image -->\\n\\nX\\n\\nP-\\n\\n<!-- image -->\\n\\nA Windows Packaging Pr\", \"oject can package several apps so you should set which one is the Entry Point:\\n\\nDiagnostic lools Pro\", \"perties\\n\\n?\\n\\n#\\n\\nSolution Explorer\\n\\nDebug\\n\\nTeam\\n\\nTest Acalyse\\n\\nHelp:\\n\\n0 Debugge performance may be ing\", \"roved by kading fener symbel Symbols options Lemmert Nevershows\\n\\n5. -\\n\\nApplication\\n\\n\\u2022 Wao Contene\\n\\nS\", \"earch Solution Explorer (Ctrl+*) |\\n\\nSmall Tie\\n\\nMedium Tie\\n\\n] Solution 'ShowFileWPApplication' (2 pro\", \"jects)\\n\\nWide Tee\\n\\nLarge Tie\\n\\nApp icon\\n\\nBadge Loge\\n\\nShowFileWpf\\n\\nProperties\\n\\n\\u2022-\\u2022 References\\n\\n+ App.co\", \"nfig\\n\\n\\u2022 Display Settings\\n\\nShort name\\n\\n\\u2022 App.xaml\\n\\n\\u2022 \\u20a9 App.xaml.cs\\n\\n\\u2022 \\u2022 MainWindow.xaml\\n\\n\\\"Shoef11mpf-\", \"exe\\\"\\n\\n.(Hi432): Loaded Ci1Mindows15ysM0/41MSn/etaostaiMind\\n\\n\\u2022 # ShowFileWPFApp.Package show Steief.e\", \"xe\\n\\nApplications\\n\\n(41432)1 Loades C/145n00515y5400641450\\n\\nmmedate Window\\n\\n\\u2022 Image\\n\\nEscribe aqui para\", \" buscar\\n\\nPacka\\n\\nP - 5 \\u00d7\\n\\nMaita Fuentes Lana - Mil\\n\\nLa Papeti Laplom\\n\\n9 LangeT escale-150 png\\n\\n<!-- i\", \"mage -->\\n\\nNext step is to set the WPF Project as the startup Project in the solution configuration. \", \"You can press F5 to compile and build and see the results.\\n\\n<!-- image -->\\n\\nLet's generate the packa\", \"ge so you can install your app. Right click on Store &gt; Create App Packages .\\n\\nEl LargeTaescale-20\", \"0 pag roperties\\n\\n\\u2022 0 x\\n\\n1627\\n\\n\\u2022\\n\\nP\\n\\n\\u2022 O\\n\\nDiagnostic Tools Properties\\n\\nDick Land (00-2\\n\\nBuild\\n\\nRebuil\", \"d\\n\\nDeploy\\n\\nClean\\n\\nPower Commands\\n\\nOverview\\n\\nScope to This\\n\\nNew Solution Explorer View\\n\\nShow on Code \", \"Map\\n\\nEdit ShowFileWPFApp.Package.wapproj\\n\\nBuild Dependencies\\n\\nAdd\\n\\nStore\\n\\nSet as StartUp Project\\n\\nDe\", \"bug\\n\\n* Cut\\n\\nX\\n\\nRemove\\n\\nRename\\n\\nUnload Project\\n\\n\\u2022 Open Folder in File Explorer\\n\\nProperties\\n\\nSolution \", \"Explorer\\n\\nSearch Solution Explorer (Ctrl+ )\\n\\na] Solution 'ShowFileWPApplication' (2 projects)\\n\\n<!-- \", \"image -->\\n\\nSelect the sideloading option to deploy the app from your machine:\\n\\n- 4 X\\n\\nDiagnostic Too\", \"ls Properties\\n\\nCreate App Packages\\n\\nCreate Your Packages\\n\\nHow do you want to distribute your applica\", \"tion?\\n\\nI want to create packages for sideloading.\\n\\nEnable automatic updates\\n\\nWhat is sideloading?\\n\\n<\", \"!-- image -->\\n\\n?\\n\\nX\\n\\nCreate App Packages\\n\\nSelect and Configure Packages\\n\\nOutput location:\\n\\nC:\\\\Users\\\\\", \"martafuentes\\\\source\\\\repos\\\\ShowFileWPFApplication\\\\ShowFileWPFApp.Package/AppPackages\\\\\\n\\nVersion:\\n\\n1 0\\n\", \"\\n. 0.0\\n\\nV Automatically increment\\n\\nMore information\\n\\nGenerate app bundle:\\n\\nAlways\\n\\nWhat does an app \", \"bundle mean?\\n\\nSelect the packages to create and the solution configuration mappings:\\n\\nArchitecture S\", \"olution Configuration\\n\\nNeutral x86\\n\\nx64\\n\\nARM\\n\\n\\u2022 Include full PDB symbol files, if any, to enable cra\", \"sh analytics for the app. Learn More\\n\\n<!-- image -->\\n\\nFinally, create the package by clicking on Cre\", \"ate .\\n\\n## XAML Islands\\n\\nXAML Islands are a set of components that enable Windows desktop developers \", \"to use UWP XAML controls on their existing Win32 applications, including Windows Forms and WPF.\\n\\n?\\n\\n\", \"X\\n\\nWin32\\n\\nUWP\\n\\nXAML\\n\\nMSIX\\n\\nUWP\\n\\nWinRT\\n\\n<!-- image -->\\n\\nYou can image your Win32 app with your standa\", \"rd controls and among them an 'island' of UWP UI containing controls from the modern world. The conc\", \"ept is similar to having an iFrame inside a web page that shows content from a different page.\\n\\nBesi\", \"des adding functionality from the Windows 10 and Windows 11 APIs, you can add pieces of UWP XAML ins\", \"ide of your app using XAML Islands.\\n\\nWindows 10 1903 update introduced a set of APIs that allow host\", \"ing UWP XAML content in Win32 windows. Only apps running on Windows 10 1903 or later can use XAML Is\", \"lands.\\n\\n## The road to XAML Islands\\n\\nThe road to XAML Islands started in 2012 when Microsoft introdu\", \"ced the WinRT APIs as a framework to modernize the Win32 apps (Windows Forms, WPF, and native Win32 \", \"apps). However, the new UI controls inside WinRT were available for new applications but not for exi\", \"sting ones.\\n\\nIn 2015, along with Windows 10, UWP was born. UWP allows you to create apps that work a\", \"cross Windows devices like XBox, Mobile, and Desktop. One year later, Microsoft announced Desktop Br\", \"idge (formerly known as Project Centennial). Desktop Bridge is a set of tools that allowed developer\", \"s to bring their existing Win32 apps to the Microsoft Store. More capabilities were added in 2017, a\", \"llowing developers to enhance their Win32 apps leveraging some of the new Windows 10 APIs, like live\", \" tiles and notifications on the action center. But still, no new UI controls.\\n\\nAt Build 2018, Micros\", \"oft announced a way for developers to use the new Windows 10 XAML controls into their current Win32 \", \"apps, without fully migrating their apps to UWP. It was branded as UWP XAML Islands.\\n\\n## How it work\", \"s\\n\\nThe Windows 10 1903 update introduced several XAML hosting APIs. Two of them are WindowsXamlManag\", \"er and DesktopWindowXamlSource.\\n\\nThe WindowsXamlManager class handles the UWP XAML Framework. Its In\", \"itializeForCurrentThread method loads the UWP XAML Framework inside the current thread of the Win32 \", \"app.\\n\\nThe DesktopWindowXamlSource is the instance of your XAML Island content. It has the Content pr\", \"operty, which you're responsible for instantiating and setting. The DesktopWindowXamlSource renders \", \"and gets its input from an HWND. It needs to know to which other HWND it will attach the XAML Island\", \"'s one, and you're responsible for sizing and positioning the parent's HWND.\\n\\nWPF or Windows Forms d\", \"evelopers don't usually deal with HWND inside their code, so it may be hard to understand and handle\", \" HWND pointers and the underlying wiring stuff to communicate Win32 and UWP worlds.\\n\\n## The XAML Isl\", \"ands .NET Wrappers\\n\\nThe Windows Community Toolkit has a set the XAML Islands .NET wrappers for WPF o\", \"r Windows Forms that make easier to use XAML Islands. These wrappers manage the HWNDs, the focus man\", \"agement, among other things. Windows Forms and WPF developers should use these wrappers.\\n\\nThe Window\", \"s Community Toolkit offers two types of controls: Wrapped Controls and Hosting Controls.\\n\\n## Wrapped\", \" Controls\\n\\nThese wrapped controls wrap some UWP controls into Windows Forms or WPF controls, hiding \", \"UWP concepts for those developers. These controls are:\\n\\n- WebView and WebViewCompatible\\n- InkCanvas \", \"and InkToolbar\\n- MediaPlayerElement\\n- MapControl\\n\\nAdd the Microsoft.Toolkit.Wpf.UI.Controls package \", \"to your project, include the reference to the namespace, and start using them.\\n\\n```\\n< Window ... xml\", \"ns:uwpControls=\\\"clrnamespace:Microsoft.Toolkit.Wpf.UI.Controls;assembly=Microsoft.Toolkit.Wpf.UI.Con\", \"trols\\\"> < Grid > < Grid.RowDefinitions > < RowDefinition Height=\\\"Auto\\\"/> < RowDefinition Height=\\\"\\\\*\\\"\", \"/> </ Grid.RowDefinitions > < uwpControls:InkToolbar TargetInkCanvas=\\\"{x:Reference Name=inkCanvas}\\\"/\", \"> < uwpControls:InkCanvas Grid.Row=\\\"1\\\" x:Name=\\\"inkCanvas\\\" /> </ Grid >\\n```\\n\\n## Hosting controls\\n\\nThe\", \" power of XAML Islands extends to most first-party controls, third-party controls, and custom contro\", \"ls developed for UWP, which can be integrated into Windows Forms and WPF as 'Islands' with fully fun\", \"ctional UI. The WindowsXamlHost control for WPF and Windows Forms allows doing this.\\n\\nFor example, t\", \"o use the WindowsXamlHost control in WPF, add a reference to the Microsoft.Toolkit.Wpf.UI.XamlHost p\", \"ackage provided by the Windows Community Toolkit.\\n\\nOnce you've placed your WindowsXamlHost into your\", \" UI code, specify which UWP type you want to load. You can choose to use a wrapped control like a Bu\", \"tton or a more complex one composed of several different controls, which are a custom UWP control.\\n\\n\", \"The following example shows how to add a UWP Button:\\n\\n```\\n< Window ... xmlns:xamlhost=\\\"clrnamespace:\", \"Microsoft.Toolkit.Wpf.UI.XamlHost;assembly=Microsoft.Toolkit.Wpf.UI.XamlHost\\\"> < xamlhost:WindowsXam\", \"lHost x:Name=\\\"myUwpButton\\\" InitialTypeName=\\\"Windows.UI.Xaml.Controls.Button\\\" />\\n```\\n\\nThere's a clear\", \" recommendation on how to approach this and it's better to have one single and bigger XAML Island co\", \"ntaining a custom composite control than to have several islands with one control on each.\\n\\nOne of t\", \"he core features of XAML is binding and it works between your Win32 code and the island. So, you can\", \" bind, for instance, a Win32 Textbox with a UWP Textbox. One important thing to consider is that the\", \"se bindings are one-way bindings, from UWP to Win32, so if you update the Textbox inside the XAML Is\", \"land the Win32 Textbox will be updated, but not the other way around.\\n\\nTo see a walkthrough about ho\", \"w to use XAML Islands, see:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop/modernize/host-standar\", \"d-control-with-xamlislands\\n\\n## Adding UWP XAML custom controls\\n\\nA XAML custom control is a control (\", \"or user control) created by you or by third parties (including WinUI 2.x controls). To host a custom\", \" UWP control in a Windows Forms or WPF app, you'll need:\\n\\n- To use the WindowsXamlHost UWP control i\", \"n your .NET app.\\n- To create a UWP app project that defines a XamlApplication object.\\n\\nYour WPF or W\", \"indows Forms project must have access to an instance of the Microsoft.Toolkit.Win32.UI.XamlHost.Xaml\", \"Application class provided by the Windows Community Toolkit. This object acts as a root metadata pro\", \"vider for loading metadata for custom UWP XAML types in assemblies in the current directory of your \", \"application. The recommended way to do this is to add a Blank App (Universal Windows) project to the\", \" same solution as your WPF or Windows Forms project and revise the default App class in this project\", \".\\n\\nThe custom UWP XAML control can be included on this UWP app or in an independent UWP Class Librar\", \"y project that you reference in the same solution as your WPF or Windows Forms project.\\n\\nYou can che\", \"ck a detailed step-by-step process description at:\\n\\nhttps://learn.microsoft.com/windows/apps/desktop\", \"/modernize/host-custom-control-with-xamlislands\\n\\n## The Windows UI Library (WinUI 2)\\n\\nBesides the in\", \"box Windows 10 controls that comes with the OS, the same UWP XAML team also delivers additional cont\", \"rols in the Windows UI Library ( WinUI 2 ). WinUI 2 provides official native Microsoft UI controls a\", \"nd features for Windows UWP apps and these controls can be used inside of XAML Islands.\\n\\nWinUI 2 is \", \"open source and you can find information at https://github.com/microsoft/microsoft-uixaml.\\n\\nThe foll\", \"owing article demonstrates how to host a UWP XAML control from the WinUI 2 library: https://learn.mi\", \"crosoft.com/windows/apps/desktop/modernize/host-custom-control-with-xamlislands\\n\\n## Do you need XAML\", \" Islands\\n\\nXAML Islands are intended for existing Win32 apps that want to improve their user experien\", \"ce by leveraging new UWP controls and behaviors without a full rewrite of the app. You could already\", \" leverage Windows 10 and Windows 11 APIs, but up until XAML Islands, only non-UI related APIs.\\n\\nIf y\", \"ou're developing a new Windows App, a UWP App is probably the right approach.\\n\\n## The road ahead XAM\", \"L Islands: WinUI 3.0\\n\\nSince Windows 8, the Windows UI platform, including the XAML UI framework, vis\", \"ual composition layer, and input processing has been shipped as an integral part of Windows. This me\", \"ans that to benefit from the latest improvements on UI technologies, you must upgrade to the latest \", \"version of the UI, slowing down the pace of innovation when you develop your apps. To decouple these\", \" two evolution cycles and foster innovation, Microsoft is actively working on the WinUI project.\\n\\nSt\", \"arting with WinUI 2 in 2018, Microsoft started shipping some new XAML UI controls and features as se\", \"parate NuGet packages that build on top of the UWP SDK.\\n\\nWin32\\n\\nWinUl 2.0: controls + styles\\n\\nWinUl \", \"3.0: the Windows Ul platform\\n\\nMicrosoft.Ul.Xaml.*\\n\\nMicrosoft.Ul.Composition.*\\n\\nMicrosoft.Ul.Xaml.Con\", \"trols\\n\\nMicrosoft.Ul.Input.*\\n\\n<!-- image -->\\n\\nWin32\\n\\nWinUI 3 is under active development and will gre\", \"atly expand the scope of WinUI to include the full UI platform, which will be fully decoupled from t\", \"he UWP SDK:\\n\\nXAML framework will now be developed on GitHub and shipped out of band as NuGet package\", \"s.\\n\\n<!-- image -->\\n\\nThe existing UWP XAML APIs that ship as part of the OS will no longer receive ne\", \"w feature updates. They will still receive security updates and critical fixes according to the Wind\", \"ows 10 support lifecycle.\\n\\nThe Universal Windows Platform contains more than just the XAML framework\", \" (for example, application and security model, media pipeline, Xbox and Windows 10 shell integration\", \"s, broad device support) and will continue to evolve. All new XAML features will just be developed a\", \"nd ship as part of WinUI instead.\\n\\n## WinUI 3 in desktop app and WinUI XAML Islands\\n\\nAs you can see,\", \" WinUI 3 is the evolution of UWP XAML and it works naturally within the UWP app model and all its re\", \"quirements (MSIX packaged ID, sandbox, CoreWindow, and so on. To use just WinUI 3 in a Win32 app mod\", \"el, the WinUI content should be hosted by another UI Framework (Windows Forms, WPF, and so on) using\", \" WinUI XAML Islands . This is the right path if you want to\\n\\nevolve your app and mix technologies. H\", \"owever, if you want to replace your entire old UI for WinUI, your app shouldn't load UI Frameworks f\", \"or just hosting WinUI.\\n\\nWinUI 3 will address this critical feedback adding WinUI in desktop apps . T\", \"his will allow that Win32 apps can use WinUI 3 as standalone UI Framework; no need to load Windows F\", \"orms or WPF.\\n\\nWithin this aggregation, WinUI 3 will let developers easily mix and match the right co\", \"mbination of:\\n\\n- App model: UWP, Win32\\n- Platform: .NET or Native\\n- Language: .NET (C#, Visual Basic\", \"), standard C++\\n- Packaging: MSIX, AppX for the Microsoft Store, unpackaged\\n- Interop: use WinUI 3 t\", \"o extend existing WPF, WinForms, and MFC apps using WinUI XAML Islands.\\n\\nIf you want to know more de\", \"tails, Microsoft is sharing this roadmap in https://github.com/microsoft/microsoft-ui-xaml/blob/main\", \"/docs/roadmap.md.\\n\\n## Example of migrating to the latest .NET\\n\\nIn this chapter, we'll show how to mi\", \"grate your applications to the latest version of .NET. You can migrate to .NET 7 from .NET Framework\", \", .NET Core, or .NET 5. We'll introduce a tool that can do all the work for you in most cases. If yo\", \"ur application has special cases or complicated dependencies, we'll also show how to do the whole mi\", \"gration process by hand. Additionally, we'll co ver the most common issues and challenges you can fa\", \"ce when migrating an existing application from .NET Framework to .NET.\\n\\n## Migrating from .NET Core \", \"or .NET 5\\n\\nUpdating your applications to target the latest version of .NET is easy if you already ar\", \"e on .NET Core or .NET 5. If this is the case, then in Visual Studio, simply right-click on your pro\", \"ject in Solution Explorer and choose Properties . Under Application &gt; General &gt; Target framewo\", \"rk , choose .NET 7.0. Save and rebuild your application. You're done! Your app now runs on the lates\", \"t version of .NET. In the future when new versions become available, you can upgrade in the same way\", \".\\n\\neShopWinForms * X\\n\\nSearch properties\\n\\n4 Application\\n\\nGeneral\\n\\nWin32 Resources\\n\\nPackaging\\n\\n\\u2022 Globa\", \"l Usings\\n\\n\\u2022 Build\\n\\n\\u2022 Package\\n\\n\\u2022 Code Analysis\\n\\n\\u2022 Debug\\n\\n\\u2022 Resources\\n\\n\\u2022 Settings\\n\\nApplication\\n\\n<!-- i\", \"mage -->\\n\\n## Migrating from .NET Framework\\n\\nMigrating from .NET Framework is a more complicated proc\", \"ess because there are more differences between .NET Framework and other platforms that were built on\", \" top of .NET Core. But the good news is that there's a tool that will do all the work for you in mos\", \" t cases.\\n\\n## Migrating with a tool\\n\\nThe Upgrade Assistant is a migration tool. Using it is easy and\", \" there are step-by-step instructions available on the .NET website . In this chapter, we'll look at \", \"what is happening behind the scenes and how to port your application by hand. When the Upgrade Assis\", \"tant is unable to migrate your application, you'll learn the underlying mechanics so that you might \", \"be able to migrate manu ally.\\n\\n## Migrating by hand\\n\\nThe migration process consists of four sequenti\", \"al steps:\\n\\n1. Preparation : Understand the dependencies the project has to have an idea of what's ah\", \"ead. In this step, you take the current project into a state that simplifies the startup point for t\", \"he migration.\\n2. Migrate Project File: .NET projects use the new SDK-style project format. Create a \", \"new project file with this format or update the one you have to use the SDK style.\\n3. Fix code and b\", \"uild: Build the code in .NET addressing API-level differences between .NET Framework and .NET. If ne\", \"eded, update third-party packages to the ones that support .NET.\\n\\n&lt; &gt;\\n\\n\\u2022 Not secure https://ww\", \"w.nuget.org/packages/Castle.Windsor/\\n\\nSign in\\n\\n4. Run and test: There might be differences that don'\", \"t show up until run time. So, don't forget to run the application and test that everything works as \", \"expected.\\n\\nCastle Windsor is best of breed, mature Inversion of Control container available for .NET\", \".\\n\\n## Preparation Package Manager\\n\\nPaket CU\\n\\n## Migrate packages.config file\\n\\nNETFramework 4.5\\n\\nIn a\", \" .NET Framework application, all references to external packages are declared in the packages.config\", \" file. In .NET, there's no longer the need to use the packages.config file. Instead, use the Package\", \"Reference property inside the project file to specify the NuGet packages for your app.\\n\\nSystem.Runti\", \"me.Loader (&gt; = 4.3.0)\\n\\nSystem.Runtime.Serialization.Formatters (&gt; = 4.3.0)\\n\\n\\u1ea9i 1.842 downloads\", \" per day (avg)\\n\\nSo, you need to transition from one format to another. You can do the update manuall\", \"y, taking the dependencies contained in the packages.config file and migrating them to the project f\", \"ile with the PackageReference format. Or, you can let Visual Studio do the work for you: right-click\", \" on the packages.config file and select the Migrate packages.config to PackageReference option.\\n\\n## \", \"Verify every dependency compatibility in .NET\\n\\nOnce you've migrated the package references, you must\", \" check each reference for compatibility. You can explore the dependencies of each NuGet package your\", \" application is using on nuget.org. If the package has .NET Standard dependencies, then it's going t\", \"o work on .NET 7 because .NET supports all versions of .NET Standard. The following image shows the \", \"dependencies for the Castle.Windsor package:\\n\\n<!-- image -->\\n\\nTo check the package compatibility, yo\", \"u can use the tool https://fuget.org that offers a more detailed information about versions and depe\", \"ndencies.\\n\\nMaybe the project is referencing older package versions that don't support .NET, but you \", \"might find newer versions that do support it. So, updating packages to newer versions is generally a\", \" good\\n\\n\\u00a9 Project Site\\n\\n\\u2022 Source repository\\n\\n\\u2022 License Info\\n\\n\\u2022 Contact owners fo Report\\n\\n\\u2022 Download p\", \"ackage (415.32 KB)\\n\\n\\u2022 *\\n\\n- OX\\n\\n* 2 \\u00ae ...\\n\\nrecommendation. However, you should consider that updating\", \" the package version can introduce some breaking changes that would force you to update your code.\\n\\n\", \"What happens if you don't find a compatible version? What if you just don't want to update the versi\", \"on of a package because of these breaking changes? Don't worry because it's possible to depend on .N\", \"ET Framework packages from a .NET application. Don't for get to test it extensively because it can c\", \"ause runtime errors if the external package calls an API that isn't available on .NET. This is great\", \" for when you're using an old package that isn't going to be updated and you can just retarget to wo\", \"rk on .NET.\\n\\n## Check for API compatibility\\n\\nSince the API surface in .NET Framework and .NET is sim\", \"ilar but not identical, you must check which APIs are available on .NET and which aren't. You can us\", \"e the .NET Portability Analyzer tool to surface APIs used that aren't present on .NET. It looks at t\", \"h e binary level of your app, extracts all the APIs that are called, and then lists which APIs aren'\", \"t available on your target framework (.NET 7 in this case).\\n\\nYou can find more information about thi\", \"s tool at:\\n\\nhttps://learn.microsoft.com/dotnet/standard/analyzers/portability-analyzer\\n\\nAn interesti\", \"ng aspect of this tool is that it only surfaces the differences from your own code and not code from\", \" external packages, which you can't change. Remember you should have updated most of these packages \", \"to make them work with .NET.\\n\\n## Migrate\\n\\n1. Create the new .NET project\\n\\nIn most cases, you'll want\", \" to update your existing project to the new .NET format. However, you can also create a new project \", \"while maintaining the old one. The main drawback from updating the old project is that you lose desi\", \"gner support, which may be important to you and your development team. If you want to keep using the\", \" designer, you must create a new .NET project in parallel with the old one and share assets. If you \", \"need to modify UI elements in the designer, you can switch to the old project to do th at. And since\", \" assets are linked, they'll be updated in the .NET project as well.\\n\\nThe SDK-style project for .NET \", \"is a lot simpler than .NET Framework's project format. Apart from the previously mentioned PackageRe\", \"ference entries, you won't need to do much more. The new project format includes files with certain \", \"extensions by default, such as .cs and .xaml files, without the need to explicitly include them in t\", \"he project file.\\n\\n## AssemblyInfo considerations\\n\\nAttributes are autogenerated on .NET projects. If \", \"the project contains an AssemblyInfo.cs file, the definitions will be duplicated, which will cause c\", \"ompilation conflicts. You can delete the older AssemblyInfo.cs file or disable autogeneration by add\", \"ing the following entry to the .NET project file:\\n\\n```\\n< Project Sdk=\\\"Microsoft.NET.Sdk\\\"> < Property\", \"Group >\\n```\\n\\n```\\n< GenerateAssemblyInfo >false</ GenerateAssemblyInfo >\\n```\\n\\n| </ PropertyGroup >   \", \"|\\n|----------------------|\\n| </ Project >         |\\n\\n## Resources\\n\\nEmbedded resources are included a\", \"utomatically but resources aren't, so you need to migrate the resources to the new project file.\\n\\n##\", \" Package references\\n\\nWith the Migrate packages.config to PackageReference option, you can easily mov\", \"e your external package references to the new format as previously mentioned.\\n\\n## Update package ref\", \"erences\\n\\nUpdate the versions of the packages you've found to be compatible, as shown in the previous\", \" section.\\n\\n## Fix the code and build\\n\\n## Microsoft.Windows.Compatibility\\n\\nIf your application depend\", \"s on APIs that aren't available on .NET, such as Registry or ACLs, you have to include a reference t\", \"o the Microsoft.Windows.Compatibility package to add these Windowsspecific APIs. They work on .NET b\", \"ut aren't included as they aren't cross -platform.\\n\\nThere's a tool called Platform compatibility ana\", \"lyzer\\n\\n(https://learn.microsoft.com/dotnet/standard/analyzers/platform-compat-analyzer) that helps y\", \"ou identify APIs that aren't compatible with your code.\\n\\n## Use #if directives\\n\\nIf you need differen\", \"t execution paths when targeting .NET Framework and .NET, you should use compilation constants. Add \", \"some #if directives to your code to keep the same codebase for both targets.\\n\\n## Technologies not av\", \"ailable on .NET\\n\\nSome technologies aren't available on .NET, such as:\\n\\n- AppDomains\\n- Remoting\\n- Cod\", \"e Access Security\\n- Windows Workflow\\n\\nThat's why you need to find a replacement for these technologi\", \"es if you're using them in your application. For more information, see the .NET Framework technologi\", \"es unavailable on .NET Core and .NET 5+ article.\\n\\n## Regenerate autogenerated clients\\n\\nIf your appli\", \"cation uses autogenerated code, such as a WCF client, you may need to regenerate this code to target\", \" .NET. Sometimes, you can find some missing references since they may not be included as part of the\", \" default .NET assemblies set. Using a tool like https://apisof.net/, you can easily locate the assem\", \"bly the missing reference lives in and add it from NuGet.\\n\\n## Rolling back package versions\\n\\nAs a ge\", \"neral rule, we've previously stated that you better update every single package version to be compat\", \"ible with .NET. However, you can find that targeting an updated and compatible version of an assembl\", \"y just doesn't pay off. If the cost of change isn't acceptable, you can consider rolling back packag\", \"e versions keeping the ones you use on .NET Framework. Although they may not be targeting .NET, they\", \" should work well unless they call some unsupported APIs.\\n\\n## Run and test\\n\\nOnce you have your appli\", \"cation building with no errors, you can start the last step of the migration by testing every functi\", \"onality.\\n\\nIn this final step, you can find several different issues depending on the complexity of y\", \"our application and the dependencies and APIs you're using.\\n\\nFor example, if you use configuration f\", \"iles ( app.config ), you may find some errors at run time like Configuration Sections not present. U\", \"sing the Microsoft.Extensions.Configuration NuGet package should fix that error.\\n\\nAnother reason for\", \" errors is the use of the BeginInvoke and EndInvoke methods because they aren't supported on .NET. T\", \"hey aren't supported on .NET because they have a dependency on Remoting, which doesn't exist on .NET\", \". To solve this issue, try to use the await keyword (when available) or the Task.Run method.\\n\\nYou ca\", \"n use compatibility analyzers to let you identify APIs and code patterns in your code that can poten\", \"tially cause problems at run time with .NET. Go to https://github.com/dotnet/platform-compat and use\", \" the .NET API analyzer on your project.\\n\\n## Migrating a Windows Forms application\\n\\nTo showcase a com\", \"plete migration process of a Windows Forms application, we've chosen to migrate the eShop sample app\", \"lication available at https://github.com/dotnetarchitecture/eShopModernizing/tree/master/eShopLegacy\", \"NTier/src/eShopWinForms. You can find the complete result of the migration at https://github.com/dot\", \"netarchitecture/eShopModernizing/tree/master/eShopModernizedNTier/src/eShopWinForms.\\n\\nThis applicati\", \"on shows a product catalog and allows the user to navigate, filter, and search for products. From an\", \" architecture point of view, the app relies on an external WCF service that serves as a fa\\u00e7ade to a \", \"back-end database.\\n\\nYou can see the main application window in the following picture:\\n\\neShopWinforms\", \".csproj\\n\\n\\u2022y eShop WinForms\\n\\n\\u2039}xm] version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?\\u203a\\n\\neSHOP\\n\\nOnCONTAINERS\\n\\n2 \\u2039Project \", \"ToolsVersion=\\\"15.0\\\" xmlns=\\\"http://schemas.microsoft.com/developer/msbuild/2003\\\"&gt;\\n\\n\\u2039Import Project\", \"=\\\"$(MSBuildExtensionsPath) \\\\$(MSBuildToolsVersion) \\\\Microsoft.Common.props\\\" Condition=\\\"Exists('$(MSB\", \"uildExtensionsPath)|\\n\\n&lt;PropertyGroup&gt;\\n\\n\\u2039Configuration Condition=\\\" '(Configuration)' == '\\u2022 \\\"\\u203aDe\", \"bug&lt;/Configuration&gt;\\n\\n\\u2039Platform Condition=\\\" 'S(Platform)' .. \\\"\\u2022 \\\"\\u203aAnyCPU&lt;/Platform&gt;\\n\\n&lt;\", \"ProjectGuid&gt;(AE32909C-9EE6-4ECE-B407-D23A15A1FEED}&lt;/ProjectGuid&gt;\\n\\n\\u2039OutputType\\u203aWinExe&lt;/Ou\", \"tputType&gt;\\n\\n&lt;RootNamespace&gt;eShoplinForms&lt;/RootNamespace&gt;\\n\\n&lt;AssemblyName&gt;eShopwin\", \"Forms&lt;/AssemblyName&gt;\\n\\n&lt; TargetFrameworkVersion)v4.7\\u2039/TargetFrameworkVersion&gt;\\n\\n&lt;FileAl\", \"ignment&gt;512&lt;/FileAlignment&gt;\\n\\n&lt;AutoGenerateBindingRedirects&gt;trues/AutoGenerateBindingR\", \"edirects&gt;\\n\\n\\u2039TargetFrameworkProfile /&gt;\\n\\n&lt;PublishUr1\\u203apublish\\\\&lt;/PublishUrl&gt;\\n\\n\\u2039Install\\u203atr\", \"ue\\u2039/Install\\u203a\\n\\n\\u2039InstallFrom&gt;Disk&lt;/InstallFrom&gt;\\n\\n&lt;UpdateEnabled&gt; false\\u2039/UpdateEnabled&g\", \"t;\\n\\n\\u2039UpdateMode&gt; Foreground\\u2039/UpdateMode&gt;\\n\\n&lt;UpdateInterval\\u203a7&lt;/UpdateInterval&gt;\\n\\n&lt;Upd\", \"ateIntervalUnits&gt;Days&lt;/UpdateIntervalUnits&gt;\\n\\n\\u2039UpdatePeriodically&gt;false\\u2039/UpdatePeriodical\", \"ly&gt;\\n\\n\\u2039UpdateRequired\\u203a false\\u2039/UpdateRequired&gt;\\n\\n\\u2039MapFileExtensions&gt;true\\u2039/MapFileExtensions&gt\", \";\\n\\n(ApplicationRevision&gt;@\\u2039/ApplicationRevision&gt;\\n\\n&lt;ApplicationVersion&gt;1.0.0.%2a&lt;/Appli\", \"cationVersion&gt;\\n\\n&lt; IsWebBootstrapper&gt;falses/IskebBootstrapper&gt;\\n\\n&lt;UseApplicationTrust&g\", \"t;false&lt;/UscApplicationTrust&gt;\\n\\n\\u2039BootstrapperEnabled\\u203atrue\\u2039/BootstrapperEnabled&gt;\\n\\n&lt;/Proper\", \"tyGroup&gt;\\n\\n\\u2039PropertyGroup Condition=\\\" '(Configuration) |$(Platform)' == 'Debug|AnyCPU' \\\"&gt;\\n\\n32\\n\\n\", \"34\\n\\n35\\n\\nMain Catalog\\n\\n36\\n\\n37\\n\\nType\\n\\n38\\n\\n&lt;PlatformTarget&gt;AnyCPU&lt;/PlatformTarget&gt;\\n\\n\\u2039DebugS\", \"ymbols&gt;true&lt;/DebugSymbols&gt;|\\n\\n&lt;DebugType&gt;full&lt;/DebugType&gt;\\n\\n&lt;Optimize\\u203afalse&lt\", \";/Optimize&gt;\\n\\nInventory\\n\\n&lt;OutputPath\\u203abin\\\\Debug\\\\&lt;/OutputPath&gt;\\n\\n\\u2039DefineConstants&gt;DEBUG; \", \"TRACE&lt;/DefineConstants&gt;\\n\\n\\u2039ErrorReport\\u203aprompt\\u2039/ErrorReport&gt;\\n\\n39\\n\\nPreview\\n\\n\\u2022 \\u2022 No issues foun\", \"d\\n\\n&lt;WarningLevel&gt;4&lt;/WarnineLevel&gt;\\n\\nCup &lt;T&gt;\\n\\nEscribe aqu\\u00ed para buscar\\n\\n<!-- image -\", \"->\\n\\nIf you open the .csproj project file, you can see something like this:\\n\\n<!-- image -->\\n\\nAs previ\", \"ously mentioned, a .NET project has a more compact style and you need to migrate the project structu\", \"re to the new .NET SDK style.\\n\\nIn Solution Explorer, right-click on the Windows Forms project and se\", \"lect Unload Project &gt; Edit .\\n\\nNow you can update the .csproj file. You'll delete the entire conte\", \"nts and replace it with the following code:\\n\\n```\\n< Project Sdk=\\\"Microsoft.NET.Sdk\\\"> < PropertyGroup \", \"> < OutputType >WinExe</ OutputType > < TargetFramework >net7.0-windows</ TargetFramework > < UseWin\", \"dowsForms >true</ UseWindowsForms > < GenerateAssemblyInfo >false</ GenerateAssemblyInfo >\\n```\\n\\n100 \", \"%\\n\\n11\\n\\n12\\n\\n14\\n\\n16\\n\\n24\\n\\n25\\n\\n26\\n\\n27\\n\\n28\\n\\n29\\n\\nError List\\n\\nEntire Solution\\n\\nCode\\n\\nSolution Explorer\\n\\nCS0\", \"234\\n\\nCS0234\\n\\nCS0246\\n\\nCS0234\\n\\nCS0234\\n\\nCS1069\\n\\nCS0246\\n\\nCS0234\\n\\nCS0234\\n\\nCS1069\\n\\nCS0246|\\n\\nDescription\\n\\nT\", \"he type or namespace name \\\"ServiceContractAttributeAttribute' does not exist in the namespace System\", \" ServiceModel\\\" (are you missing an assembly reference?)\\n\\nThe type or namespace name ServiceContractA\", \"ttribute' does not exist in the namespace 'System.ServiceModel\\\" (are you missing an assembly referen\", \"ce?)\\n\\nThe type or namespace name 'ConfigurationName' could not be found (are you missing a using dir\", \"ective or an assembly reference?)\\n\\nThe type or namespace name 'OperationContractAttributeAttribute' \", \"does not exist in the namespace 'System ServiceModel\\\" (are you missing an assembly reference?)\\n\\nThe \", \"type or namespace name 'OperationContractAttribute does not exist in the namespace 'System ServiceMo\", \"del\\\" (are you missing an assembly reference?)\\n\\nThe type name \\\"Action' could not be found in the name\", \"space 'System\\\". This type has been forwarded to assembly System.Runtime, Version =4.2.1.0, Culture \\u00ab\", \"neutral,\\n\\nSearch Error List\\n\\nLine\\n\\nSuppression St....\\n\\n498\\n\\nActive\\n\\n498\\n\\n498\\n\\n501\\n\\n501\\n\\n501\\n\\nActive\\n\", \"\\nActive\\n\\nActive\\n\\nActive\\n\\nActive\\n\\n<!-- image -->\\n\\nThe type name \\\"Action' could not be found in the na\", \"mespace System. This type has been forwarded to assembly System.Runtime, Version=4.2.1.0, Culture=ne\", \"utral,\\n\\nPublicKeyToken= b0315f7f11d50a3a Consider adding a reference to that assembly.\\n\\nC#\\n\\nProject \", \"eShopWinForms\\n\\neShopWinForms eShopWinForms\\n\\neShopWinForms eShopWinForms\\n\\neShopWinForms eShopWinForms\", \"\\n\\nFile\\n\\nReference.cs\\n\\nReference.cs\\n\\nReference.cs\\n\\nReference.cs\\n\\nReference.cs\\n\\nReference.cs\\n\\nNotifica\", \"tions\\n\\nReference.cs\\n\\n504 Active\\n\\nSave and reload the project. You're now done updating the project f\", \"ile and the project is targeting .NET 7.\\n\\nIf you compile the project at this point, you'll find some\", \" errors related to the WCF client reference. Since this code is autogenerated, you must regenerate i\", \"t to target .NET.\\n\\n<!-- image -->\\n\\nProperties\\n\\nDelete the Reference.cs\\n\\nAlt+ Enter file and generate\", \" a new Service Client.\\n\\nRight-click on Connected Services and select the Add Connected Service optio\", \"n.\\n\\n<!-- image -->\\n\\nThe Connected Services window opens. Select the Microsoft WCF Web Service option\", \".\\n\\n*\\n\\n*\\n\\n* 120 Errors\\n\\n0 Warnings\\n\\n) 0 Messages\\n\\nBuild + IntelliSense\\n\\nY\\n\\nP-\\n\\nFile Edit View Project\", \" Build Debug Test Analyze Tools Extensions Window\\n\\n30 - 0\\n\\nHelp\\n\\nSearch Visual Studio (Ctrl+Q)\\n\\nDebu\", \"g - Any CPU\\n\\neShopWinForms * x\\n\\nConfigure WCF Web Service Reference\\n\\nSpecify the service to add\\n\\nCon\", \"nected Services\\n\\nPublish\\n\\nService Endpoint\\n\\nData Type Options\\n\\nClient Options\\n\\nConnected Services\\n\\n<\", \"!-- image -->\\n\\nIf you have the WCF Service in the same solution as we have in this example, you can \", \"select the Discover option instead of specifying a service URL.\\n\\n<!-- image -->\\n\\nOnce the service is\", \" located, the tool reflects the API contract implemented by the service. Change the name of the name\", \"space to be eShopServiceReference as shown in the following image:\\n\\n- \\u2022 IIS Express (Google Chrome) \", \"- C - \\u2022 =\\n\\neShopLegacyNTier\\n\\nConfigure WCF Web Service Reference\\n\\nSpecify the service to add\\n\\nServic\", \"e Endpoint\\n\\nData Type Options\\n\\nClient Options\\n\\n<!-- image -->\\n\\nSelect the Finish button. After a whi\", \"le, you'll see the generated code.\\n\\nYou should see three autogenerated files:\\n\\n1. Getting Started : \", \"a link to GitHub to provide some information on WCF.\\n2. ConnectedService.json : configuration parame\", \"ters to connect to the service.\\n3. Reference.cs : the actual WCF client code.\\n\\nSolution Explorer\\n\\n= \", \"\\u20ac\\n\\nSearch Solution Explorer (Ctrl+\\\")\\n\\neShopWinForms\\n\\nD\\n\\nD\\n\\nC# Program.cs\\n\\nSolution Explorer\\n\\n<!-- im\", \"age -->\\n\\nIf you compile again, you'll see many errors coming from .cs files inside the Helper folder\", \". This folder was present in the .NET Framework version but not included in the old .csproj . But wi\", \"th the new SDKstyle project, every code file present underneath the project file location is include\", \"d by default. That is, the new .NET Core project tries to compile the files inside the Helper folder\", \". Since that folder isn't needed, you can safely delete it.\\n\\nIf you compile the project again and ex\", \"ecute it, you won't see the product images. The problem is that now the path to the files has slight\", \"ly changed. To fix this issue, you need to add another level of depth in the path, updating in the f\", \"ile CatalogView.cs the line:\\n\\nNotifications\\n\\neShop - Classic WPF Sample\\n\\nSearch\\n\\nSearch\\n\\nCatalog Typ\", \"e Fo\\n\\nView All talog Brand\\n\\nriew All\\n\\n```\\nstring image_name = Environment.CurrentDirectory + \\\"\\\\\\\\..\\\\\\\\\", \"..\\\\\\\\Assets\\\\\\\\Images\\\\\\\\Catalog\\\\\\\\\\\" + catalogItems.Picturefilename; to string image_name = Environment.Cu\", \"rrentDirectory + \\\"\\\\\\\\..\\\\\\\\..\\\\\\\\..\\\\\\\\Assets\\\\\\\\Images\\\\\\\\Catalog\\\\\\\\\\\" + catalogItems.Picturefilename; Azure\\n```\", \"\\n\\nAzure\\n\\nAfter this change, you can check that the application launches and runs as expected on .NET\", \" 7.\\n\\nMicrosoft Azure Black T-Shirt\\n\\n## Migrating a WPF application\\n\\nWe'll use the Shop.ClassicWPF sa\", \"mple application to perform the migration. The following image shows a screenshot of the app before \", \"migration:\\n\\nCap\\n\\n<!-- image -->\\n\\nThis application uses a local SQL Server Express database to hold t\", \"he product catalog information. This database is accessed directly from the WPF application.\\n\\nFirst,\", \" you must update the .csproj file to the new SDK style used by .NET Core applications. You'll follow\", \" the same steps described in the Windows Forms migration: you'll unload the project, open the .cspro\", \"j file, update its contents, and reload the project.\\n\\nIn this case, delete all the content of the .c\", \"sproj file and replace it with the following code:\\n\\n\\u2022\\n\\nError List\\n\\nEntire Solution\\n\\n* Code\\n\\n* CS0234\", \"\\n\\nDescription\\n\\nThe type or namespace name 'SqlProvider' does not exist in the namespace 'eShop' (are\", \" you missing an assembly\\n\\n```\\n< Project Sdk=\\\"Microsoft.NET.Sdk\\\"> < PropertyGroup > < OutputType >Win\", \"Exe</ OutputType > < TargetFramework >net7.0-windows</ TargetFramework > < UseWpf >true</ UseWpf > <\", \" GenerateAssemblyInfo >false</ GenerateAssemblyInfo > </ PropertyGroup > </ Project >\\n```\\n\\nIf you re\", \"load the project and compile it, you'll get the following error:\\n\\n<!-- image -->\\n\\nSince you've delet\", \"ed all the .csproj contents, you've lost a project reference specification present in the old projec\", \"t. You just need to add this line to the .csproj file to include the project reference back:\\n\\n<!-- i\", \"mage -->\\n\\nYou can also let Visual Studio help you by right-clicking on the Dependencies node and sel\", \"ecting Add Project Reference . Select the project from the solution and select OK :\\n\\n1 Error |\\n\\nA O \", \"Warnings i O Messages\\n\\n2888000------\\n\\nBuild Only\\n\\nReference Manager - eShop. ClassicWPF\\n\\n4 Projects\\n\", \"\\nSolution\\n\\n\\u2022 Shared Projects\\n\\n\\u2022 Browse\\n\\nName eShop.Server\\n\\nPath\\n\\nE: \\\\ModernizeAppsNET...\\n\\n<!-- image\", \" -->\\n\\nSearch (Ctrl+E)\\n\\nName:\\n\\neShop.SqlProvider\\n\\nOnce you add the missing project reference, the app\", \"lication compiles and runs as expected on .NET.\\n\\n?\\n\\nX\\n\\n8 -\\n\\n## Deploying Modern Desktop Applications\", \"\\n\\nWhen you develop desktop applications, one thing to consider is how your application is going to b\", \"e packaged and deployed to the users' machines. The problem with packaging, deployment, and installa\", \"tion is that it usually falls under the umbrella of the IT professionals, who care about different t\", \"hings than developers.\\n\\nThese days, we're all familiar with the DevOps concept, where developers and\", \" IT Pros work closely to move applications to their production environments. But if you've been in t\", \"he desktop battle for more than 10 years, you might have seen the following story. A team of develop\", \"ers works together hard to meet the project deadlines. Business people are nervous since they need t\", \"he system working on many users' machines to run the company. On 'D -Day', the project manager check\", \"s with every developer that their code is working well and that everything is fine, so they can ship\", \". Then, the package team comes in generating the setup for the app, distribute it to every user mach\", \"ine and a set of test users run the application. Well, they try, because before showing any UI, the \", \"application throws an exception that says 'Method ~ of object ~ failed'. Panic starts flowing throug\", \"h the air and a brief investigation points to a young and tired developer that has introduced a thir\", \"d-party control, that certainly 'worked on the dev machine'.\\n\\nInstalling desktop applications have t\", \"raditionally been a nightmare for two main reasons:\\n\\n- Lack of close collaboration culture between d\", \"ev and IT teams.\\n- Lack of a solid packaging and deploying technology we can build upon.\\n\\nIn fact, w\", \"e've been living with the fact that sometimes you regret that you installed an app because:\\n\\n- It en\", \"ds up having some undesired side effects on your machine.\\n- Some applications that were previously i\", \"nstalled stop working.\\n\\nAdditionally, you can't just restore the system to its original state by uni\", \"nstalling the app. We're so used to living with this situation that we've coined terms like 'DLL Hel\", \"l' or 'Winrot'.\\n\\nIn this chapter, we'll talk about MSIX. MSIX is the new technology from Microsoft t\", \"hat tries to capture the best of previous technologies to provide a solid foundation for the packagi\", \"ng technology of the future.\\n\\nWhat does a packaging technology have to do with modernization? Well, \", \"it turns out that packaging is fundamental for the enterprise IT with lots of money invested there. \", \"Modernization isn't only related\\n\\nModern IT: Application Lifecycle Today to using the latest technol\", \"ogies. It's also related to reducing time to market from the moment a business requirement is define\", \"d until your company delivers the feature to your client.\\n\\n(Re)Package to\\n\\n## The modern application\", \" lifecycle\\n\\nDeploy\\n\\nToday, developers write and build the code for an app and then pass the generate\", \"d assets to the IT Pros. Then, the IT Pros reconfigure the app and repackage it, typically in an MSI\", \" or more recently in an App-V packaging format. The app is then deployed through different channels \", \"and tools. One of the main problems with this approach is commonly known as 'packaging paralysis'. T\", \"he problem is that this cycle repeats every time there's an app update or an OS update.\\n\\nYou can see\", \" the process reflected on the following picture:\\n\\n<!-- image -->\\n\\nCompanies need a way to break this\", \" packaging cycle into three independent cycles:\\n\\n- OS updates\\n- Application updates\\n- Customization\\n\", \"\\nModern IT Virtuous Cycle\\n\\nWindows\\n\\nUpdate\\n\\nMicrosoft Store or any CDN\\n\\nMicrosoft Store for Business\", \"\\n\\n<!-- image -->\\n\\nThe previous diagram shows that you can:\\n\\n- Update the underlying OS without havin\", \"g to repackage your apps.\\n- Enable customizations from IT without the need to repackage the original\", \" developer package.\\n\\nThis radical change leads us to the new and modern IT lifecycle as shown in the\", \" following picture:\\n\\nModern IT: Application Lifecycle\\n\\nDeveloper\\n\\nCreate\\n\\nApp\\n\\n* Sisdil\\n\\nStudio\\n\\n## \", \"Package\\n\\nto MSIX\\n\\nConfigure\\n\\nCustomize\\n\\nIT Pro\\n\\nSign\\n\\nDeploy\\n\\n<!-- image -->\\n\\nDevelopers create the \", \"app and generate an MSIX package that IT Pros can consume and configure without the need of repackag\", \"ing. Along with the MSIX technology, Microsoft has created tools to allow IT to customize and config\", \"ure packages without repackaging.\\n\\n## MSIX: The next generation of deployment\\n\\nBefore MSIX, there we\", \"re several packaging technologies available like setup wizards, MSI, ClickOnce, App-V, and scripting\", \". Each of these technologies has their own strengths and Microsoft has decided to pick the best of a\", \"ll to build MSIX. MSIX is built on the foundations of these existing technologies picking the best o\", \"f each:\\n\\n- App-V =&gt; Containerization\\n- ClickOnce =&gt; Auto updating\\n- MSI =&gt; Easy to distribu\", \"te\\n\\nWith MSIX, you get one installer technology with all these features.\\n\\n\\u203aetup.ex\\n\\nWindows\\n\\nClickOn\", \"ce\\n\\n<!-- image -->\\n\\n## Benefits of MSIX\\n\\n## Never regret installing an app\\n\\nMSIX provides a predicta\", \"ble, reliable, and safe deployment. The declarative method contained in the package manifest lets th\", \"e OS keep track of every asset your application needs. It also provides a true clean uninstall with \", \"no side effects.\\n\\n## Disk space optimization\\n\\nMSIX is optimized to reduce the footprint that an appl\", \"ication has on the user's machine disk space. It creates a single instance storage of your files. Th\", \"at is, if you have two different packages with the same DLL, the DLL isn't installed twice. The plat\", \"fo rm takes care of that problem because it knows all the files that a particular app installed than\", \"ks to its declarative nature. It also allows you to have different versions of a DLL working side by\", \" side.\\n\\nWith the use of resource packages, you can easily create multilingual apps and the OS takes \", \"care of installing the ones that are used.\\n\\n## Network optimization\\n\\nMSIX detects the differences on\", \" the files at the byte block level enabling a feature called differential updates. What this means i\", \"s that only the updated byte blocks are downloaded on application updates.\\n\\nApplicatior\\n\\nDifferentia\", \"l updates\\n\\nHR APP Version 1.0.0.0\\n\\nHRApp.exe\\n\\nSE\\n\\nHR APP Version 1.2.0.0\\n\\nHRApp.exe\\n\\nEmployeen.dat\\n\\n\", \"Expenses di\\n\\n<!-- image -->\\n\\nWith streaming installation, the user can quickly start working on your\", \" application while other parts of the app are downloaded on the background. This feature contributes\", \" to an engaging experience for your users.\\n\\nWith the optional packages feature, you achieve componen\", \"tization on your app deployment, so you can download them when needed.\\n\\n## Simple packaging and depl\", \"oyment\\n\\nThe AppManifest declares the versioning, device targeting and identity in a standard way for\", \" every application. It also provides a way to sign your assets providing a solid security foundation\", \".\\n\\n## OS managed\\n\\nThe OS handles all the processes for installing, updating, and removing an applica\", \"tion. Applications are installed per user but downloaded only once, minimizing the disk footprint. M\", \"icrosoft is working on providing the MSIX experience also on Windows 7.\\n\\n## Windows provides integri\", \"ty for the app\\n\\nWith the use of digital signatures, you can guarantee that you don't install an appl\", \"ication from untrusted sources. MSIX also prevents tampering because:\\n\\n- It keeps a record of file h\", \"ashes.\\n- It detects if a file has been modified after installation.\\n\\n## Works for the entire App Cat\", \"alog\\n\\nOne of the coolest things about MSIX is that it works for the entire application catalog, Wind\", \"ows Forms, WPF, MFC/ATL, Delphi, even if you want to do xCopy deployment, ClickOnce, or going to the\", \" Store, you can use the same MSIX package.\\n\\n## Tools\\n\\n## Windows Application Packaging Project\\n\\nYou \", \"can use the Windows Application Packaging Project project in Visual Studio to generate a package for\", \" your desktop app. Then, you can publish that package to the Microsoft Store or sideload it onto one\", \" or more PCs.\\n\\n## MSIX Packaging Tool\\n\\nThe MSIX Packaging Tool enables you to repackage your existin\", \"g Win32 applications to the MSIX format. It offers both an interactive UI and a command line for con\", \"versions and gives you the ability to convert an application without having the source code.\\n\\n[7 MSI\", \"X Packaging Tool (Preview)\\n\\nCreate new package Open package editor\\n\\nSelect package type\\n\\nApplication\", \" package\\n\\nCreate your app package\\n\\nX\\n\\n203\\n\\n<!-- image -->\\n\\n## Package Support Framework\\n\\nThe Package\", \" Support Framework is an open-source kit that helps you apply fixes to your existing Win32 applicati\", \"on when you don't have access to the source code, so that it can run in an MSIX container. The Packa\", \"ge Support Framework helps your application follow the best practices of the modern runtime environm\", \"ent.\\n\\n## App Installer\\n\\nApp Installer allows Windows 10 and Windows 11 apps to be installed by doubl\", \"e-clicking the app package. This means that users don't need to use PowerShell or other developer to\", \"ols to deploy Windows 10/Windows 11 apps. The App Installer can also install an app from the web, op\", \"tional packages, and related sets.\\n\\n## How to create an MSIX package from an existing Win32 desktop \", \"application\\n\\nLet's go through the process to create an MSIX package from an existing Win32 applicati\", \"on. In this example, we'll use a Windows Forms app.\\n\\nCouponDemo - Microsoft Visual Studio\\n\\nFile\\n\\nToo\", \"lbox\\n\\nSearch Toolbox\\n\\n\\u2022 Microsoft.Toolkit.Forms.U\\n\\n\\u2022 Microsoft.Toolkit.Forms.U\\n\\nP All Windows Forms\\n\", \"\\n\\u2022 Common Controls\\n\\nPointer\\n\\nButton\\n\\nCheckBox\\n\\nCheckedListBox\\n\\nComboBox\\n\\nDateTimePicker\\n\\nLabel\\n\\nLink\", \"Label\\n\\nListBox\\n\\nListView\\n\\nMaskedTextBox\\n\\nMonthCalendar\\n\\nNotifylcon\\n\\nNumericUpDown\\n\\nPictureBox\\n\\nProgr\", \"essBar\\n\\nRadioButton\\n\\nRichTextBox\\n\\nTextBox type here to search\\n\\nEdit\\n\\nView\\n\\nProject Build Debug\\n\\nAdd \", \"New Project\\n\\n\\u2022 Recent\\n\\n4 Installed\\n\\n4 Visual C#\\n\\nSearch (Ctri+E)\\n\\nType: Visual C#\\n\\nA project that cr\", \"eates packages\\n\\nTo start, add a new project to your solution, select the Windows Application Packagi\", \"ng Project, and give it a name. Windows Universal Class Library (Universal Windows) Visual C# Window\", \"s Store\\n\\n\\u2022 Web\\n\\nName:\\n\\nLocation:\\n\\nVisual C#\\n\\n<!-- image -->\\n\\nYou'll see the structure of the packagi\", \"ng project and note a special folder called Applications . Inside this folder, you can specify which\", \" applications you want to include in the package. It can be more than one.\\n\\nWindows Runtime Componen\", \"t (Universal Windows)\\n\\n(.).\\n\\n- Team\\n\\nTools\\n\\nWindow\\n\\nTest Analyze\\n\\nSort by:\\n\\nHelp\\n\\nDefault\\n\\nBlank App\", \" (Universal Windows)\\n\\nVisual C#\\n\\nQuick Launch (Ctri+Q)\\n\\n?\\n\\nX\\n\\nP-\\n\\n50\\n\\nStri+:)\\n\\nP - &amp;\\n\\nAdam Brade\", \"n *\\n\\n+ 4 \\u00d7\\n\\n\\u2022 P\\n\\nP\\n\\nSolution Explorer\\n\\nSearch Solution Explorer (Ctrl+;)\\n\\n\\u2022\\n\\nSolution Explorer\\n\\n<!--\", \" image -->\\n\\nRight-click on the Applications folder and select the Windows Forms project you want to \", \"package from the Visual Studio solution.\\n\\n- Ji\\n\\nCouponDemo - Microsoft Visual Studio\\n\\nCoupon. Packag\", \"e\\n\\nPackage.appxmanifest \\u2192\\n\\nFile Edit View Project Build Debug Team\\n\\n.. o\\n\\nCoupon.cs\\n\\nNuGet: Coupon.F\", \"orms\\n\\nTools Test Analyze Window Help\\n\\nReference Manager - Coupon.Package\\n\\nDeclarations\\n\\nToolbox\\n\\nSea\", \"rch Tooll\\n\\n4 General\\n\\nThere are n this group\\n\\nthis tex!\\n\\nAll Visual Assets\\n\\nSmall Tile\\n\\nMedium Tile\\n\", \"\\nWide Tile\\n\\nLarge Tile\\n\\nOutput\\n\\nShow output from: Debug\\n\\nThe thread 0x553c has exited with code \\u2022 (0\", \"x0).\\n\\nThe thread 0x2a0 has exited with code 0(0x0).\\n\\nThe program ' [19988] Coupon. Forms. exe' has e\", \"xited with code 0(0x0).\\n\\nError List\\n\\n\\u2022 This item does not support previewing.\\n\\nOutput\\n\\nP Type here t\", \"o search\\n\\n4 Projects\\n\\nSolution\\n\\nApplication\\n\\nName\\n\\n~ Coupon.Forms\\n\\nContent URIs\\n\\nVisual Assets\\n\\nPath\", \"\\n\\nUsers\\\\adambr\\\\source\\\\repos\\\\ talks\\\\Devintersection201...\\n\\n7 P\\n\\nQuick Launch (Ctri+Q)\\n\\nSolution Explo\", \"rer\\n\\n?\\n\\nSearch Solution Explorer (Ctrl+:)\\n\\nSearch (Ctri+ E)\\n\\nc* CouponService.cs\\n\\nForm1.cs\\n\\nName:\\n\\nC\", \"oupon.Forms\\n\\nP- 6\\n\\n4 X\\n\\nAdam Braden *\\n\\n\\u0434 -\\n\\nP-\\n\\n-\\n\\nP\\n\\nPackaging\\n\\nCapabilities\\n\\n<!-- image -->\\n\\nAt th\", \"is point, you can compile and generate the package but let's examine a couple of things. To have a b\", \"etter user experience, Visual Studio can autogenerate all the visual assets a modern application nee\", \"ds to handle icons and tile assets for the tile bar and start menu. Open the Package.appxmanifest fi\", \"le to access the Manifest Designer. You can then generate all the visual assets from a given image p\", \"resent on your project just by clicking Create .\\n\\n<!-- image -->\\n\\nIf you open the code for the Packa\", \"ge.appxmanifest file, you can see a couple of interesting things.\\n\\nRight under &lt;Package&gt;, ther\", \"e's an &lt;Identity&gt; node. This is where your packaged application is going to get its identity, \", \"which will be managed by the OS.\\n\\nProgram.cs\\n\\nPackage.appxmanifest + x\\n\\nCoupon.Package\\n\\n1\\n\\nCoupon.cs\", \"\\n\\n\\u2039?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;\\n\\n+\\n\\nE&lt;Package xmlns=\\\"http://schemas.microsoft.com/app\", \"x/manifest/foundation/windows10\\\" )\\n\\n&lt;Identity Name=\\\"7c387b13-ce2b-436b-9b2e-49cb9e853df3\\\" Publish\", \"er=\\\"CN=adambr\\\" Vers-\\n\\n&lt;Properties&gt;\\n\\n<!-- image -->\\n\\n3\\n\\n4\\n\\n5\\n\\n6\\n\\n7\\n\\n8\\n\\n9\\n\\n10\\n\\n11\\n\\n12\\n\\n13\\n\\n14\\n\\n1\", \"5\\n\\n16\\n\\n17\\n\\n18\\n\\n19\\n\\n110 %\\n\\nOutput\\n\\nShow output from: Visual Assets\\n\\nError List\\n\\nOutput\\n\\nIn the &lt;Ca\", \"pabilities&gt; node, you can find all the requirements the application needs, paying special attenti\", \"on to the &lt;rescap:Capability Name=\\\"runFullTrust\\\" \\\\&gt;, which tells the OS to run the app in full\", \" trust mode since it's a Win32 application.\\n\\n=\\n\\nNuGet: Coupon.Forms\\n\\nPackage.appxmanifest + X\\n\\nCoupo\", \"n. Package\\n\\n16\\n\\n17\\n\\n18\\n\\n19\\n\\n20\\n\\n21\\n\\n22\\n\\n23\\n\\n24\\n\\n25\\n\\n26\\n\\n27\\n\\n28\\n\\n29\\n\\n110 % = 4\\n\\nOutput\\n\\nShow output f\", \"rom: Visual Assets\\n\\nError List\\n\\n&lt;Applications&gt;\\n\\n\\u2039Application Id=\\\"App\\\" Executable=\\\"$targetnamet\", \"oken$.exe\\\" EntryPoint=\\\"$targeter\\n\\n&lt;uap: VisualElements DisplayName=\\\"Coupon. Package\\\" Description=\", \"\\\"Coupon. Package\\n\\n&lt;uap:DefaultTile Wide310x150Logo=\\\"Images\\\\Wide310x150Logo.png\\\" Square310x31\\n\\n&lt\", \";/Package&gt;\\n\\n<!-- image -->\\n\\nOutput\\n\\nSet the packaging project as the startup project for the solu\", \"tion and select Run . This is going to:\\n\\n- Compile the Windows Forms application.\\n- Create an MSIX p\", \"ackage out of the build results.\\n- Deploy the packages.\\n- Install it locally on the development mach\", \"ine.\\n- Launch the app.\\n\\nCoupon.cs\\n\\nNuGet: Coupon.Forms\\n\\n+\\n\\nRecently added\\n\\nCoupon.Package\\n\\nMicrosoft\", \" Graph !\\n\\nExpand v\\n\\n#\\n\\nA\\n\\nPin to Start\\n\\nMirrosoft skill with containers at a\\n\\nsernetes on Azure work\", \"shop\\n\\n<!-- image -->\\n\\nWith this, you have the clean install and uninstall experience that MSIX provi\", \"des fully integrated into Windows 10/Windows 11.\\n\\nThe final stage is about how you deploy the MSIX p\", \"ackage to another machine.\\n\\nRight-click on the packaging project, select the Store menu, and then se\", \"lect the Create App Packages option.\\n\\nThen, you can choose between creating a package to upload to t\", \"he store or creating packages for sideloading. In most modernization scenarios, you'll choose I want\", \" to create packages for sideloading .\\n\\nCreate\\n\\nCreate App Packages\\n\\nSelect and Configure Packages\\n\\nO\", \"utput location:\\n\\nVersion:\\n\\n. 0.0. 0\\n\\n/ Automatically increment\\n\\nMore information\\n\\nGenerate app bundl\", \"e:\\n\\nAlways\\n\\nWhat does an app bundle mean?\\n\\nSelect the packages to create and the solution configurat\", \"ion mappings:\\n\\nArchitecture Solution Configuration\\n\\nNeutral x86\\n\\nx64\\n\\nARM\\n\\n<!-- image -->\\n\\nThere you\", \" can select the different architectures you want to target as you can include as many as you want in\", \"to the same MSIX package.\\n\\nThe final step is to declare where you want to deploy the final installat\", \"ion assets.\\n\\n\\u2022\\n\\n?\\n\\nX\\n\\nCreate App Packages\\n\\nConfigure Update Settings\\n\\nInstallation URL: http(s) or U\", \"NC path or file share:\\n\\nhttp://apps.contoso.com/MyUniversalApp\\n\\nHow can I publish my application?\\n\\nS\", \"pecify how often the application should check for updates:\\n\\n\\u2022 Check everytime the application runs\\n\\n\", \"\\u2022 Check every: |1\\n\\n<!-- image -->\\n\\nYou can choose to use a web server or a shared UNC path on your e\", \"nterprise file servers. Pay attention to the settings to specify how you want to update your applica\", \"tion. We'll cover application updates in the next section.\\n\\nFor a detailed step-by-step guide, see P\", \"ackage a desktop app from source code using Visual Studio.\\n\\n## Auto Updates in MSIX\\n\\nThe Windows Sto\", \"re has a great updating mechanism using Windows Update. In most enterprise scenarios, you don't use \", \"the Store to distribute your desktop apps. So, you need a similar way to configure updates for your \", \"application and pull them to your users.\\n\\nUsing a combination of Windows 10/Windows 11 features and \", \"MSIX packages, you can provide a great updating experience for your users. In fact, the user doesn't\", \" need to be technical at all but still benefits from a seamless application update experience.\\n\\nYou \", \"can configure your updates to interact with the user in two different ways:\\n\\n?\\n\\nX\\n\\nHRappinstaller\\n\\n1\", \"\\n\\n2\\n\\n3\\n\\n4\\n\\n5\\n\\n6]\\n\\n7\\n\\n8\\n\\n9\\n\\n10\\n\\n11\\n\\n12\\n\\n13\\n\\n14\\n\\n15\\n\\n16\\n\\n17\\n\\n18\\n\\n19\\n\\n20\\n\\n21\\n\\n\\u2039?xm1 version=\\\"1.0\\\"- enco\", \"ding\\n\\nE&lt;AppInstaller-\\n\\n-Uri-\\\"http://sampleapppackages.azurewebsites.net/MSIX\\\\_HR\\\\_Demo/HR.appinst\", \"aller'\\n\\n- User prompted updates: The OS shows some autogenerated nice UI to notify the user about th\", \"e application it's about to install. It builds this UI based on the properties you specify on your i\", \"nstallation files.\\n\\n\\u2022Version=\\\"2.0.0.0\\\"\\n\\n- Silent updates in the background. With this option, your u\", \"sers don't need to be aware of the updates. =\\u00b7 \\\"x86\\\"/&gt;\\n\\nYou can also configure when you want to p\", \"erform updates: either when the application launches or on a regular basis. Thanks to the side-loadi\", \"ng features, you can even get these updates while the application is running.\\n\\nWhen you use this typ\", \"e of deployment, a special file is created called .appinstaller . This simple file contains the foll\", \"owing sections:\\n\\n- The location of the .appinstaller file\\n- The application's main MSIX package prop\", \"erties\\n- The update behavior\\n\\n<!-- image -->\\n\\nIn combination with this file, Microsoft has designed \", \"a special URL protocol to launch the installation process from a link:\\n\\n&lt; a href=\\\"ms-appinstaller\", \":?source=http://mywebservice.azureedge.net/MyApp.msix\\\"&gt;Install app package &lt;/ a &gt;\\n\\nThis pro\", \"tocol works on all browsers and launches the installation process with a great user experience on Wi\", \"ndows 10/Windows 11. Since the OS manages the installation process, it's aware of the location this \", \"application was installed from and tracks all the files affected by the process.\\n\\nMSIX creates a use\", \"r interface for installation automatically showing some properties of the package. This allows for a\", \" common installation experience for every app.\\n\\n133 %\\n\\n-\\\"UTF-8\\\"?\\u203a\\n\\nOnce you've generated the new MSI\", \"X package and moved it to the deployment server, you just have to edit the .appinstaller file to ref\", \"lect these changes: mainly the version and the path to the new MSIX file. The next time the user lau\", \"nches the application, the system will detect the change and download the files for the new version \", \"in the background. When the download is finished, installation will execute transparently for your u\", \"ser on new application launch.\"]"