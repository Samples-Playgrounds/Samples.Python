,0
0,public async Task SubmitAsync(
1,"string buyerId,"
2,"string buyerEmail,"
3,"string street,"
4,"string city,"
5,"string state,"
6,"string country,"
7,CustomerBasket basket)
8,{
9,var orderState = new OrderState
10,{
11,"OrderDate = DateTime.UtcNow,"
12,"OrderStatus = OrderStatus.Submitted,"
13,"Description = ""Submitted"","
14,Address = new OrderAddressState
15,{
16,"Street = street,"
17,"City = city,"
18,"State = state,"
19,Country = country
20,"},"
21,"BuyerId = buyerId,"
22,"BuyerEmail = buyerEmail,"
23,OrderItems = basket.Items
24,.Select(item => new OrderItemState
25,{
26,"ProductId = item.ProductId,"
27,"ProductName = item.ProductName,"
28,"UnitPrice = item.UnitPrice,"
29,"Units = item.Quantity,"
30,PictureFileName = item.PictureFileName
31,})
32,.ToList()
33,};
34,
35,"await StateManager.SetStateAsync(OrderDetailsStateName, orderState);"
36,"await StateManager.SetStateAsync(OrderStatusStateName, OrderStatus.Submitted);"
37,
38,await RegisterReminderAsync(
39,"GracePeriodElapsedReminder,"
40,"null,"
41,"TimeSpan.FromSeconds(_settings.Value.GracePeriodTime),"
42,TimeSpan.FromMilliseconds(-1));
