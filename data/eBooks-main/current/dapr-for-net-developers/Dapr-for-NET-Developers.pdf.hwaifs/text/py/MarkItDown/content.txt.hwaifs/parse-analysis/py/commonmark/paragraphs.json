[
    "EDITION v1.2",
    "EDITION v1.2",
    "PUBLISHED BY",
    "PUBLISHED BY",
    "Microsoft Developer Division, .NET, and Azure Incubations teams",
    "Microsoft Developer Division, .NET, and Azure Incubations teams",
    "A division of Microsoft Corporation",
    "A division of Microsoft Corporation",
    "One Microsoft Way",
    "One Microsoft Way",
    "Redmond, Washington 98052-6399",
    "Redmond, Washington 98052-6399",
    "Copyright \u00a9 2023 by Microsoft Corporation",
    "Copyright \u00a9 2023 by Microsoft Corporation",
    "All rights reserved. No part of the contents of this book may be reproduced or transmitted in any",
    "All rights reserved. No part of the contents of this book may be reproduced or transmitted in any",
    "This book is provided \u201cas-is\u201d and expresses the author\u2019s views and opinions. The views, opinions, and",
    "This book is provided \u201cas-is\u201d and expresses the author\u2019s views and opinions. The views, opinions, and",
    "Some examples depicted herein are provided for illustration only and are fictitious. No real association",
    "Some examples depicted herein are provided for illustration only and are fictitious. No real association",
    "Microsoft and the trademarks listed at https://www.microsoft.com on the \u201cTrademarks\u201d webpage are",
    "Microsoft and the trademarks listed at https://www.microsoft.com on the \u201cTrademarks\u201d webpage are",
    "Mac and macOS are trademarks of Apple Inc.",
    "Mac and macOS are trademarks of Apple Inc.",
    "The Docker whale logo is a registered trademark of Docker, Inc. Used by permission.",
    "The Docker whale logo is a registered trademark of Docker, Inc. Used by permission.",
    "All other marks and logos are property of their respective owners.",
    "All other marks and logos are property of their respective owners.",
    "Authors:",
    "Authors:",
    "Rob Vettor, Principal Cloud Solution Architect - thinkingincloudnative.com, Microsoft",
    "Rob Vettor, Principal Cloud Solution Architect - thinkingincloudnative.com, Microsoft",
    "Sander Molenkamp, Principal Cloud Architect/Microsoft MVP - sandermolenkamp.com, Info Support",
    "Sander Molenkamp, Principal Cloud Architect/Microsoft MVP - sandermolenkamp.com, Info Support",
    "Edwin van Wijk, Principal Solution Architect/Microsoft MVP - defaultconstructor.com, Info Support",
    "Edwin van Wijk, Principal Solution Architect/Microsoft MVP - defaultconstructor.com, Info Support",
    "Participants and Reviewers:",
    "Participants and Reviewers:",
    "Mark Russinovich, Azure CTO and Technical Fellow, Azure Office of CTO, Microsoft",
    "Mark Russinovich, Azure CTO and Technical Fellow, Azure Office of CTO, Microsoft",
    "Nish Anil, Senior Program Manager, .NET team, Microsoft",
    "Nish Anil, Senior Program Manager, .NET team, Microsoft",
    "Mark Fussell, Principal Program Manager, Azure Incubations, Microsoft",
    "Mark Fussell, Principal Program Manager, Azure Incubations, Microsoft",
    "Yaron Schneider, Principal Software Engineer, Azure Incubations, Microsoft",
    "Yaron Schneider, Principal Software Engineer, Azure Incubations, Microsoft",
    "Ori Zohar, Senior Program Manager, Azure Incubations, Microsoft",
    "Ori Zohar, Senior Program Manager, Azure Incubations, Microsoft",
    "Editors:",
    "Editors:",
    "David Pine, Senior Content Developer, .NET team, Microsoft",
    "David Pine, Senior Content Developer, .NET team, Microsoft",
    "Maira Wenzel, Senior Program Manager, .NET team, Microsoft",
    "Maira Wenzel, Senior Program Manager, .NET team, Microsoft",
    "Steve \u201cardalis\u201d Smith, Senior Architect and Trainer, NimblePros",
    "Steve \u201cardalis\u201d Smith, Senior Architect and Trainer, NimblePros",
    "Version",
    "Version",
    "This guide has been written to cover the Dapr 1.9 version. .NET samples are based on .NET 7.",
    "This guide has been written to cover the Dapr 1.9 version. .NET samples are based on .NET 7.",
    "Who should use this guide",
    "Who should use this guide",
    "The audience for this guide is mainly developers, development leads, and architects who are",
    "The audience for this guide is mainly developers, development leads, and architects who are",
    "A secondary audience is technical decision-makers who plan to choose whether to build their",
    "A secondary audience is technical decision-makers who plan to choose whether to build their",
    "How you can use this guide",
    "How you can use this guide",
    "This guide is available both in PDF form and online. Feel free to forward this document or links to its",
    "This guide is available both in PDF form and online. Feel free to forward this document or links to its",
    "Contents",
    "Contents",
    "Foreword - Dapr for .NET Developers ................................................................................... 1",
    "Foreword - Dapr for .NET Developers ................................................................................... 1",
    "The world is distributed .......................................................................................................... 3",
    "The world is distributed .......................................................................................................... 3",
    "Summary ..................................................................................................................................................................................... 7",
    "Summary ..................................................................................................................................................................................... 7",
    "Dapr at 20,000 feet ................................................................................................................. 8",
    "Dapr at 20,000 feet ................................................................................................................. 8",
    "Dapr and the problem it solves .......................................................................................................................................... 8",
    "Dapr and the problem it solves .......................................................................................................................................... 8",
    "Dapr architecture ..................................................................................................................................................................... 9",
    "Dapr architecture ..................................................................................................................................................................... 9",
    "Building blocks ..................................................................................................................................................................... 9",
    "Building blocks ..................................................................................................................................................................... 9",
    "Components ....................................................................................................................................................................... 11",
    "Components ....................................................................................................................................................................... 11",
    "Sidecar architecture ......................................................................................................................................................... 13",
    "Sidecar architecture ......................................................................................................................................................... 13",
    "Hosting environments .................................................................................................................................................... 14",
    "Hosting environments .................................................................................................................................................... 14",
    "Dapr performance considerations ................................................................................................................................. 15",
    "Dapr performance considerations ................................................................................................................................. 15",
    "Dapr and service meshes ................................................................................................................................................... 16",
    "Dapr and service meshes ................................................................................................................................................... 16",
    "Summary .................................................................................................................................................................................. 18",
    "Summary .................................................................................................................................................................................. 18",
    "References ........................................................................................................................................................................... 18",
    "References ........................................................................................................................................................................... 18",
    "Get started with Dapr ........................................................................................................... 19",
    "Get started with Dapr ........................................................................................................... 19",
    "Install Dapr into your local environment ..................................................................................................................... 19",
    "Install Dapr into your local environment ..................................................................................................................... 19",
    "Build your first Dapr application ..................................................................................................................................... 19",
    "Build your first Dapr application ..................................................................................................................................... 19",
    "Create the application .................................................................................................................................................... 19",
    "Create the application .................................................................................................................................................... 19",
    "Add Dapr State Management ..................................................................................................................................... 20",
    "Add Dapr State Management ..................................................................................................................................... 20",
    "Component configuration files ....................................................................................................................................... 21",
    "Component configuration files ....................................................................................................................................... 21",
    "Build a multi-container Dapr application .................................................................................................................... 23",
    "Build a multi-container Dapr application .................................................................................................................... 23",
    "Create the application .................................................................................................................................................... 23",
    "Create the application .................................................................................................................................................... 23",
    "Add Dapr service invocation ........................................................................................................................................ 27",
    "Add Dapr service invocation ........................................................................................................................................ 27",
    "Add container support ................................................................................................................................................... 29",
    "Add container support ................................................................................................................................................... 29",
    "Summary .................................................................................................................................................................................. 35",
    "Summary .................................................................................................................................................................................. 35",
    "References ........................................................................................................................................................................... 35",
    "References ........................................................................................................................................................................... 35",
    "Traffic Control sample application ...................................................................................... 36",
    "Traffic Control sample application ...................................................................................... 36",
    "Using Dapr building blocks............................................................................................................................................... 39",
    "Using Dapr building blocks............................................................................................................................................... 39",
    "i",
    "i",
    "Contents",
    "Contents",
    "Hosting ...................................................................................................................................................................................... 40",
    "Hosting ...................................................................................................................................................................................... 40",
    "Self-hosted mode ............................................................................................................................................................ 40",
    "Self-hosted mode ............................................................................................................................................................ 40",
    "Kubernetes .......................................................................................................................................................................... 41",
    "Kubernetes .......................................................................................................................................................................... 41",
    "Summary .................................................................................................................................................................................. 41",
    "Summary .................................................................................................................................................................................. 41",
    "References ........................................................................................................................................................................... 41",
    "References ........................................................................................................................................................................... 41",
    "The Dapr state management building block ...................................................................... 42",
    "The Dapr state management building block ...................................................................... 42",
    "What it solves ......................................................................................................................................................................... 42",
    "What it solves ......................................................................................................................................................................... 42",
    "How it works ........................................................................................................................................................................... 43",
    "How it works ........................................................................................................................................................................... 43",
    "Consistency ......................................................................................................................................................................... 43",
    "Consistency ......................................................................................................................................................................... 43",
    "Concurrency ....................................................................................................................................................................... 45",
    "Concurrency ....................................................................................................................................................................... 45",
    "Transactions ....................................................................................................................................................................... 45",
    "Transactions ....................................................................................................................................................................... 45",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 46",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 46",
    "ASP.NET Core integration ............................................................................................................................................. 47",
    "ASP.NET Core integration ............................................................................................................................................. 47",
    "State store components ..................................................................................................................................................... 47",
    "State store components ..................................................................................................................................................... 47",
    "Configuration ..................................................................................................................................................................... 48",
    "Configuration ..................................................................................................................................................................... 48",
    "Key prefix strategies ........................................................................................................................................................ 49",
    "Key prefix strategies ........................................................................................................................................................ 49",
    "Sample application: Dapr Traffic Control .................................................................................................................... 50",
    "Sample application: Dapr Traffic Control .................................................................................................................... 50",
    "Summary .................................................................................................................................................................................. 51",
    "Summary .................................................................................................................................................................................. 51",
    "References ........................................................................................................................................................................... 52",
    "References ........................................................................................................................................................................... 52",
    "The Dapr service invocation building block ....................................................................... 53",
    "The Dapr service invocation building block ....................................................................... 53",
    "What it solves ......................................................................................................................................................................... 53",
    "What it solves ......................................................................................................................................................................... 53",
    "How it works ........................................................................................................................................................................... 53",
    "How it works ........................................................................................................................................................................... 53",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 55",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 55",
    "Invoke HTTP services using HttpClient .................................................................................................................... 55",
    "Invoke HTTP services using HttpClient .................................................................................................................... 55",
    "Invoke HTTP services using DaprClient ................................................................................................................... 57",
    "Invoke HTTP services using DaprClient ................................................................................................................... 57",
    "Invoke gRPC services using DaprClient ................................................................................................................... 58",
    "Invoke gRPC services using DaprClient ................................................................................................................... 58",
    "Name resolution components ......................................................................................................................................... 58",
    "Name resolution components ......................................................................................................................................... 58",
    "Configuration ..................................................................................................................................................................... 58",
    "Configuration ..................................................................................................................................................................... 58",
    "Sample application: Dapr Traffic Control .................................................................................................................... 59",
    "Sample application: Dapr Traffic Control .................................................................................................................... 59",
    "Summary .................................................................................................................................................................................. 60",
    "Summary .................................................................................................................................................................................. 60",
    "References ........................................................................................................................................................................... 60",
    "References ........................................................................................................................................................................... 60",
    "ii",
    "ii",
    "Contents",
    "Contents",
    "The Dapr publish ",
    "The Dapr publish ",
    "What it solves ......................................................................................................................................................................... 61",
    "What it solves ......................................................................................................................................................................... 61",
    "How it works ........................................................................................................................................................................... 62",
    "How it works ........................................................................................................................................................................... 62",
    "Competing consumers ................................................................................................................................................... 66",
    "Competing consumers ................................................................................................................................................... 66",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 66",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 66",
    "Pub/sub components .......................................................................................................................................................... 68",
    "Pub/sub components .......................................................................................................................................................... 68",
    "Configuration ..................................................................................................................................................................... 68",
    "Configuration ..................................................................................................................................................................... 68",
    "Sample application: Dapr Traffic Control .................................................................................................................... 69",
    "Sample application: Dapr Traffic Control .................................................................................................................... 69",
    "Summary .................................................................................................................................................................................. 71",
    "Summary .................................................................................................................................................................................. 71",
    "References ........................................................................................................................................................................... 71",
    "References ........................................................................................................................................................................... 71",
    "The Dapr bindings building block ....................................................................................... 72",
    "The Dapr bindings building block ....................................................................................... 72",
    "What it solves ......................................................................................................................................................................... 72",
    "What it solves ......................................................................................................................................................................... 72",
    "How it works ........................................................................................................................................................................... 73",
    "How it works ........................................................................................................................................................................... 73",
    "Input bindings ................................................................................................................................................................... 73",
    "Input bindings ................................................................................................................................................................... 73",
    "Output bindings ............................................................................................................................................................... 74",
    "Output bindings ............................................................................................................................................................... 74",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 76",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 76",
    "Binding components ........................................................................................................................................................... 76",
    "Binding components ........................................................................................................................................................... 76",
    "Cron binding ...................................................................................................................................................................... 77",
    "Cron binding ...................................................................................................................................................................... 77",
    "Sample application: Dapr Traffic Control .................................................................................................................... 78",
    "Sample application: Dapr Traffic Control .................................................................................................................... 78",
    "MQTT input binding ........................................................................................................................................................ 79",
    "MQTT input binding ........................................................................................................................................................ 79",
    "SMTP output binding ..................................................................................................................................................... 81",
    "SMTP output binding ..................................................................................................................................................... 81",
    "Summary .................................................................................................................................................................................. 83",
    "Summary .................................................................................................................................................................................. 83",
    "References ........................................................................................................................................................................... 83",
    "References ........................................................................................................................................................................... 83",
    "The Dapr actors building block ............................................................................................ 84",
    "The Dapr actors building block ............................................................................................ 84",
    "What it solves ......................................................................................................................................................................... 84",
    "What it solves ......................................................................................................................................................................... 84",
    "How it works ........................................................................................................................................................................... 85",
    "How it works ........................................................................................................................................................................... 85",
    "Turn-based access model ............................................................................................................................................. 88",
    "Turn-based access model ............................................................................................................................................. 88",
    "Timers and reminders ..................................................................................................................................................... 89",
    "Timers and reminders ..................................................................................................................................................... 89",
    "State persistence .............................................................................................................................................................. 89",
    "State persistence .............................................................................................................................................................. 89",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 90",
    "Use the Dapr .NET SDK ....................................................................................................................................................... 90",
    "Call actors from ASP.NET Core clients ..................................................................................................................... 93",
    "Call actors from ASP.NET Core clients ..................................................................................................................... 93",
    "iii",
    "iii",
    "Contents",
    "Contents",
    "Call non-.NET actors........................................................................................................................................................ 94",
    "Call non-.NET actors........................................................................................................................................................ 94",
    "Timers and reminders ..................................................................................................................................................... 95",
    "Timers and reminders ..................................................................................................................................................... 95",
    "Sample application: Dapr Traffic Control .................................................................................................................... 97",
    "Sample application: Dapr Traffic Control .................................................................................................................... 97",
    "Summary .................................................................................................................................................................................. 98",
    "Summary .................................................................................................................................................................................. 98",
    "References ........................................................................................................................................................................... 99",
    "References ........................................................................................................................................................................... 99",
    "The Dapr observability building block .............................................................................. 100",
    "The Dapr observability building block .............................................................................. 100",
    "What it solves ....................................................................................................................................................................... 101",
    "What it solves ....................................................................................................................................................................... 101",
    "How it works ......................................................................................................................................................................... 101",
    "How it works ......................................................................................................................................................................... 101",
    "Distributed tracing ......................................................................................................................................................... 102",
    "Distributed tracing ......................................................................................................................................................... 102",
    "Metrics ................................................................................................................................................................................ 109",
    "Metrics ................................................................................................................................................................................ 109",
    "Logging .............................................................................................................................................................................. 111",
    "Logging .............................................................................................................................................................................. 111",
    "Health status .................................................................................................................................................................... 113",
    "Health status .................................................................................................................................................................... 113",
    "Dapr dashboard .............................................................................................................................................................. 114",
    "Dapr dashboard .............................................................................................................................................................. 114",
    "Use the Dapr .NET SDK ..................................................................................................................................................... 115",
    "Use the Dapr .NET SDK ..................................................................................................................................................... 115",
    "Sample application: Dapr Traffic Control .................................................................................................................. 115",
    "Sample application: Dapr Traffic Control .................................................................................................................. 115",
    "Summary ................................................................................................................................................................................ 117",
    "Summary ................................................................................................................................................................................ 117",
    "References ............................................................................................................................................................................. 118",
    "References ............................................................................................................................................................................. 118",
    "The Dapr secrets management building block ................................................................ 119",
    "The Dapr secrets management building block ................................................................ 119",
    "What it solves ....................................................................................................................................................................... 119",
    "What it solves ....................................................................................................................................................................... 119",
    "How it works ......................................................................................................................................................................... 120",
    "How it works ......................................................................................................................................................................... 120",
    "Use the Dapr .NET SDK ..................................................................................................................................................... 121",
    "Use the Dapr .NET SDK ..................................................................................................................................................... 121",
    "Secret store components ................................................................................................................................................. 122",
    "Secret store components ................................................................................................................................................. 122",
    "Configuration ................................................................................................................................................................... 123",
    "Configuration ................................................................................................................................................................... 123",
    "Indirectly consume Dapr secrets .............................................................................................................................. 123",
    "Indirectly consume Dapr secrets .............................................................................................................................. 123",
    "Local file ............................................................................................................................................................................. 124",
    "Local file ............................................................................................................................................................................. 124",
    "Kubernetes secret .......................................................................................................................................................... 126",
    "Kubernetes secret .......................................................................................................................................................... 126",
    "Azure Key Vault ............................................................................................................................................................... 126",
    "Azure Key Vault ............................................................................................................................................................... 126",
    "Scope secrets ................................................................................................................................................................... 129",
    "Scope secrets ................................................................................................................................................................... 129",
    "Sample application: Dapr Traffic Control .................................................................................................................. 129",
    "Sample application: Dapr Traffic Control .................................................................................................................. 129",
    "Secrets ................................................................................................................................................................................ 131",
    "Secrets ................................................................................................................................................................................ 131",
    "SMTP server credentials .............................................................................................................................................. 132",
    "SMTP server credentials .............................................................................................................................................. 132",
    "Redis server credentials ............................................................................................................................................... 133",
    "Redis server credentials ............................................................................................................................................... 133",
    "iv",
    "iv",
    "Contents",
    "Contents",
    "FineCalculator component license key .................................................................................................................. 134",
    "FineCalculator component license key .................................................................................................................. 134",
    "Summary ................................................................................................................................................................................ 135",
    "Summary ................................................................................................................................................................................ 135",
    "References ............................................................................................................................................................................. 135",
    "References ............................................................................................................................................................................. 135",
    "Dapr reference application ................................................................................................. 137",
    "Dapr reference application ................................................................................................. 137",
    "eShopOnContainers ........................................................................................................................................................... 137",
    "eShopOnContainers ........................................................................................................................................................... 137",
    "eShopOnDapr ....................................................................................................................................................................... 138",
    "eShopOnDapr ....................................................................................................................................................................... 138",
    "Application of Dapr building blocks............................................................................................................................ 139",
    "Application of Dapr building blocks............................................................................................................................ 139",
    "State management ........................................................................................................................................................ 140",
    "State management ........................................................................................................................................................ 140",
    "Service invocation .......................................................................................................................................................... 142",
    "Service invocation .......................................................................................................................................................... 142",
    "Publish ",
    "Publish ",
    "Bindings ............................................................................................................................................................................. 150",
    "Bindings ............................................................................................................................................................................. 150",
    "Actors .................................................................................................................................................................................. 152",
    "Actors .................................................................................................................................................................................. 152",
    "Observability .................................................................................................................................................................... 158",
    "Observability .................................................................................................................................................................... 158",
    "Secrets ................................................................................................................................................................................ 159",
    "Secrets ................................................................................................................................................................................ 159",
    "Benefits of applying Dapr to eShop ............................................................................................................................ 160",
    "Benefits of applying Dapr to eShop ............................................................................................................................ 160",
    "Summary ................................................................................................................................................................................ 161",
    "Summary ................................................................................................................................................................................ 161",
    "References ......................................................................................................................................................................... 161",
    "References ......................................................................................................................................................................... 161",
    "Summary and the road ahead ............................................................................................ 162",
    "Summary and the road ahead ............................................................................................ 162",
    "The road ahead .................................................................................................................................................................... 165",
    "The road ahead .................................................................................................................................................................... 165",
    "v",
    "v",
    "Contents",
    "Contents",
    "CHAPTER  1",
    "CHAPTER  1",
    "Foreword - Dapr for .NET",
    "Foreword - Dapr for .NET",
    "With the wave of cloud adoption underway, there is a major shift happening towards \u201ccloud native\u201d",
    "With the wave of cloud adoption underway, there is a major shift happening towards \u201ccloud native\u201d",
    "Dapr is designed as an enterprise, developer-focused, microservices programming model platform",
    "Dapr is designed as an enterprise, developer-focused, microservices programming model platform",
    "To address the wide range of scenarios that developers face, Dapr provides features such as state",
    "To address the wide range of scenarios that developers face, Dapr provides features such as state",
    "1",
    "1",
    "CHAPTER 1 | Foreword - Dapr for .NET Developers",
    "CHAPTER 1 | Foreword - Dapr for .NET Developers",
    "and incorporate service SDKs into their code, or worry about authentication, secret management,",
    "and incorporate service SDKs into their code, or worry about authentication, secret management,",
    "This book shows how Dapr reduces your development time and overall code maintenance by",
    "This book shows how Dapr reduces your development time and overall code maintenance by",
    "We publicly announced Dapr with the v0.1 release in Oct 2019 and now, a year and half later, I am",
    "We publicly announced Dapr with the v0.1 release in Oct 2019 and now, a year and half later, I am",
    "Dapr is just getting started, though, and you should expect to see more Dapr capabilities and more",
    "Dapr is just getting started, though, and you should expect to see more Dapr capabilities and more",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently",
    "Mark Russinovich Azure CTO and Technical Fellow Microsoft",
    "Mark Russinovich Azure CTO and Technical Fellow Microsoft",
    "2",
    "2",
    "CHAPTER 1 | Foreword - Dapr for .NET Developers",
    "CHAPTER 1 | Foreword - Dapr for .NET Developers",
    "CHAPTER  2",
    "CHAPTER  2",
    "The world is distributed",
    "The world is distributed",
    "Just ask any \u2018cool kid\u2019: Modern, distributed systems are in, and monolithic apps are out",
    "Just ask any \u2018cool kid\u2019: Modern, distributed systems are in, and monolithic apps are out",
    "But, it\u2019s not just \u201ccool kids.\u201d Progressive IT Leaders, corporate architects, and astute developers are",
    "But, it\u2019s not just \u201ccool kids.\u201d Progressive IT Leaders, corporate architects, and astute developers are",
    "But, this evolution raises many questions\u2026",
    "But, this evolution raises many questions\u2026",
    "\u2022  What exactly is a distributed application?",
    "\u2022  What exactly is a distributed application?",
    "\u2022  Why are they gaining popularity?",
    "\u2022  Why are they gaining popularity?",
    "\u2022  What are the costs?",
    "\u2022  What are the costs?",
    "\u2022",
    "\u2022",
    "And, importantly, what are the tradeoffs?",
    "And, importantly, what are the tradeoffs?",
    "To start, let\u2019s rewind and look at the past 15 years. During this period, we typically constructed",
    "To start, let\u2019s rewind and look at the past 15 years. During this period, we typically constructed",
    "Figure 1-1. Monolithic architecture.",
    "Figure 1-1. Monolithic architecture.",
    "Note how the modules for Ordering, Identity, and Marketing execute in a single-server process.",
    "Note how the modules for Ordering, Identity, and Marketing execute in a single-server process.",
    "In many ways, monolithic apps are straightforward. They\u2019re straightforward to:",
    "In many ways, monolithic apps are straightforward. They\u2019re straightforward to:",
    "Build",
    "Build",
    "\u2022",
    "\u2022",
    "3",
    "3",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER 2 | The world is distributed",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Test",
    "Test",
    "Deploy",
    "Deploy",
    "Troubleshoot",
    "Troubleshoot",
    "Scale vertically (scale up)",
    "Scale vertically (scale up)",
    "However, monolithic architectures can present significant challenges.",
    "However, monolithic architectures can present significant challenges.",
    "Over time, you may reach a point where you begin to lose control\u2026",
    "Over time, you may reach a point where you begin to lose control\u2026",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The monolith has become so overwhelmingly complicated that no single person understands it.",
    "The monolith has become so overwhelmingly complicated that no single person understands it.",
    "You fear making changes as each brings unintended and costly side effects.",
    "You fear making changes as each brings unintended and costly side effects.",
    "New features/fixes become time-consuming and expensive to implement.",
    "New features/fixes become time-consuming and expensive to implement.",
    "Even the smallest change requires full deployment of the entire application - expensive and",
    "Even the smallest change requires full deployment of the entire application - expensive and",
    "One unstable component can crash the entire system.",
    "One unstable component can crash the entire system.",
    "Adding new technologies and frameworks aren\u2019t an option.",
    "Adding new technologies and frameworks aren\u2019t an option.",
    "Implementing agile delivery methodologies are difficult.",
    "Implementing agile delivery methodologies are difficult.",
    "Architectural erosion sets in as the code base deteriorates with never-ending \u201cspecial cases.\u201d",
    "Architectural erosion sets in as the code base deteriorates with never-ending \u201cspecial cases.\u201d",
    "Eventually the consultants come in and tell you to rewrite it.",
    "Eventually the consultants come in and tell you to rewrite it.",
    "IT practitioners call this condition the Fear Cycle. If you\u2019ve been in the technology business for any",
    "IT practitioners call this condition the Fear Cycle. If you\u2019ve been in the technology business for any",
    "Instead of fear, businesses require speed and agility. They seek an architectural style with which",
    "Instead of fear, businesses require speed and agility. They seek an architectural style with which",
    "An early attempt to gain speed and agility came in the form of Service Oriented Architecture, or SOA.",
    "An early attempt to gain speed and agility came in the form of Service Oriented Architecture, or SOA.",
    "4",
    "4",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER 2 | The world is distributed",
    "Figure 1-2. SOA architecture.",
    "Figure 1-2. SOA architecture.",
    "With SOA, centralized service providers registered with the ESB. Business logic would be built into the",
    "With SOA, centralized service providers registered with the ESB. Business logic would be built into the",
    "Despite the promises of SOA, implementing this approach often increased complexity and introduced",
    "Despite the promises of SOA, implementing this approach often increased complexity and introduced",
    "Nowadays, many organizations have realized speed and agility by adopting a distributed microservice",
    "Nowadays, many organizations have realized speed and agility by adopting a distributed microservice",
    "5",
    "5",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER 2 | The world is distributed",
    "Figure 1-3. Distributed architecture.",
    "Figure 1-3. Distributed architecture.",
    "Note how the same application is decomposed across a set of distributed services. Each is self-",
    "Note how the same application is decomposed across a set of distributed services. Each is self-",
    "But, while distributed services can provide agility and speed, they present a different set of challenges.",
    "But, while distributed services can provide agility and speed, they present a different set of challenges.",
    "\u2022",
    "\u2022",
    "6",
    "6",
    "How can distributed services discover each other and communicate synchronously?",
    "How can distributed services discover each other and communicate synchronously?",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER 2 | The world is distributed",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "How can they implement asynchronous messaging?",
    "How can they implement asynchronous messaging?",
    "How can they maintain contextual information across a transaction?",
    "How can they maintain contextual information across a transaction?",
    "How can they become resilient to failure?",
    "How can they become resilient to failure?",
    "How can they scale to meet fluctuating demand?",
    "How can they scale to meet fluctuating demand?",
    "How are they monitored and observed?",
    "How are they monitored and observed?",
    "For each of these challenges, multiple products are often available. But, shielding your application",
    "For each of these challenges, multiple products are often available. But, shielding your application",
    "This book introduces Dapr. Dapr is a distributed application runtime. It directly addresses many of the",
    "This book introduces Dapr. Dapr is a distributed application runtime. It directly addresses many of the",
    "Summary",
    "Summary",
    "In this chapter, we discussed the adoption of distributed applications. We contrasted a monolithic",
    "In this chapter, we discussed the adoption of distributed applications. We contrasted a monolithic",
    "Now, sit back, relax, and let us introduce you the new world of Dapr.",
    "Now, sit back, relax, and let us introduce you the new world of Dapr.",
    "7",
    "7",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER 2 | The world is distributed",
    "CHAPTER  3",
    "CHAPTER  3",
    "Dapr at 20,000 feet",
    "Dapr at 20,000 feet",
    "In chapter 1, we discussed the appeal of distributed microservice applications. But, we also pointed",
    "In chapter 1, we discussed the appeal of distributed microservice applications. But, we also pointed",
    "Dapr, or Distributed Application Runtime, is a new way to build modern distributed applications.",
    "Dapr, or Distributed Application Runtime, is a new way to build modern distributed applications.",
    "What started as a prototype has evolved into a highly successful open-source project. Its sponsor,",
    "What started as a prototype has evolved into a highly successful open-source project. Its sponsor,",
    "This book looks at Dapr from the viewpoint of a .NET developer. In this chapter, you\u2019ll build a",
    "This book looks at Dapr from the viewpoint of a .NET developer. In this chapter, you\u2019ll build a",
    "Imagine flying in a jet at 20,000 feet. You look out the window and see the landscape below from a",
    "Imagine flying in a jet at 20,000 feet. You look out the window and see the landscape below from a",
    "Dapr and the problem it solves",
    "Dapr and the problem it solves",
    "Dapr addresses a large challenge inherent in modern distributed applications: Complexity.",
    "Dapr addresses a large challenge inherent in modern distributed applications: Complexity.",
    "Through an architecture of pluggable components, Dapr greatly simplifies the plumbing behind",
    "Through an architecture of pluggable components, Dapr greatly simplifies the plumbing behind",
    "Consider a requirement to make one of your services stateful? What would be your design. You could",
    "Consider a requirement to make one of your services stateful? What would be your design. You could",
    "Figure 2-1 shows Dapr from 20,000 feet.",
    "Figure 2-1 shows Dapr from 20,000 feet.",
    "8",
    "8",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-1. Dapr at 20,000 feet.",
    "Figure 2-1. Dapr at 20,000 feet.",
    "In the top row of the figure, note how Dapr provides language-specific SDKs for popular development",
    "In the top row of the figure, note how Dapr provides language-specific SDKs for popular development",
    "While language-specific SDKs enhance the developer experience, Dapr is platform agnostic. Under the",
    "While language-specific SDKs enhance the developer experience, Dapr is platform agnostic. Under the",
    "The blue boxes across the center of the figure represent the Dapr building blocks. Each exposes a",
    "The blue boxes across the center of the figure represent the Dapr building blocks. Each exposes a",
    "The bottom row highlights the portability of Dapr and the diverse environments across which it can",
    "The bottom row highlights the portability of Dapr and the diverse environments across which it can",
    "Dapr architecture",
    "Dapr architecture",
    "At this point, the jet turns around and flies back over Dapr, descending in altitude, giving you a closer",
    "At this point, the jet turns around and flies back over Dapr, descending in altitude, giving you a closer",
    "Building blocks",
    "Building blocks",
    "From the new perspective, you see a more detailed view of the Dapr building blocks.",
    "From the new perspective, you see a more detailed view of the Dapr building blocks.",
    "A building block encapsulates a distributed infrastructure capability. You can access the functionality",
    "A building block encapsulates a distributed infrastructure capability. You can access the functionality",
    "9",
    "9",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-2. Dapr building blocks.",
    "Figure 2-2. Dapr building blocks.",
    "The following table describes the infrastructure services provided by each block.",
    "The following table describes the infrastructure services provided by each block.",
    "Building block",
    "Building block",
    "Description",
    "Description",
    "State management  Support contextual information for long running stateful services.",
    "State management  Support contextual information for long running stateful services.",
    "Service invocation",
    "Service invocation",
    "Invoke direct, secure service-to-service calls using platform agnostic protocols",
    "Invoke direct, secure service-to-service calls using platform agnostic protocols",
    "Publish and",
    "Publish and",
    "10",
    "10",
    "Implement secure, scalable pub/sub messaging between services.",
    "Implement secure, scalable pub/sub messaging between services.",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Building block",
    "Building block",
    "Bindings",
    "Bindings",
    "Description",
    "Description",
    "Trigger code from events raised by external resources with bi-directional",
    "Trigger code from events raised by external resources with bi-directional",
    "Observability",
    "Observability",
    "Monitor and measure message calls across networked services.",
    "Monitor and measure message calls across networked services.",
    "Secrets",
    "Secrets",
    "Actors",
    "Actors",
    "Securely access external secret stores.",
    "Securely access external secret stores.",
    "Encapsulate logic and data in reusable actor objects.",
    "Encapsulate logic and data in reusable actor objects.",
    "Building blocks abstract the implementation of distributed application capabilities from your services.",
    "Building blocks abstract the implementation of distributed application capabilities from your services.",
    "Figure 2-3. Dapr building block integration.",
    "Figure 2-3. Dapr building block integration.",
    "Building blocks invoke Dapr components that provide the concrete implementation for each resource.",
    "Building blocks invoke Dapr components that provide the concrete implementation for each resource.",
    "We provide detailed explanation and code samples for each Dapr building block in the upcoming",
    "We provide detailed explanation and code samples for each Dapr building block in the upcoming",
    "Components",
    "Components",
    "While building blocks expose an API to invoke distributed application capabilities, Dapr components",
    "While building blocks expose an API to invoke distributed application capabilities, Dapr components",
    "11",
    "11",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Consider, the Dapr state store component. It provides a uniform way to manage state for CRUD",
    "Consider, the Dapr state store component. It provides a uniform way to manage state for CRUD",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "AWS DynamoDB",
    "AWS DynamoDB",
    "Aerospike",
    "Aerospike",
    "Azure Blob Storage",
    "Azure Blob Storage",
    "Azure CosmosDB",
    "Azure CosmosDB",
    "Azure Table Storage",
    "Azure Table Storage",
    "Cassandra",
    "Cassandra",
    "Cloud Firestore (Datastore mode)",
    "Cloud Firestore (Datastore mode)",
    "CloudState",
    "CloudState",
    "Couchbase",
    "Couchbase",
    "Etcd",
    "Etcd",
    "HashiCorp Consul",
    "HashiCorp Consul",
    "Hazelcast",
    "Hazelcast",
    "\u2022  Memcached",
    "\u2022  Memcached",
    "\u2022  MongoDB",
    "\u2022  MongoDB",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "SQL Server",
    "SQL Server",
    "Zookeeper",
    "Zookeeper",
    "Each component provides the necessary implementation through a common state management",
    "Each component provides the necessary implementation through a common state management",
    "type Store interface {",
    "type Store interface {",
    "Tip",
    "Tip",
    "The Dapr runtime as well as all of the Dapr components have been written in the Golang, or Go,",
    "The Dapr runtime as well as all of the Dapr components have been written in the Golang, or Go,",
    "Perhaps you start with Azure Redis Cache as your state store. You specify it with the following",
    "Perhaps you start with Azure Redis Cache as your state store. You specify it with the following",
    "12",
    "12",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Component  metadata:    name:",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Component  metadata:    name:",
    "In the spec section, you configure Dapr to use the Redis Cache for state management. The section",
    "In the spec section, you configure Dapr to use the Redis Cache for state management. The section",
    "At a later time, the application is ready to go to production. For the production environment, you may",
    "At a later time, the application is ready to go to production. For the production environment, you may",
    "At the time of this writing, the following component types are provided by Dapr:",
    "At the time of this writing, the following component types are provided by Dapr:",
    "Component",
    "Component",
    "Description",
    "Description",
    "Service",
    "Service",
    "State",
    "State",
    "Pub/sub",
    "Pub/sub",
    "Bindings",
    "Bindings",
    "Used by the service invocation building block to integrate with the hosting",
    "Used by the service invocation building block to integrate with the hosting",
    "Provides a uniform interface to interact with a wide variety of state store",
    "Provides a uniform interface to interact with a wide variety of state store",
    "Provides a uniform interface to interact with a wide variety of message bus",
    "Provides a uniform interface to interact with a wide variety of message bus",
    "Provides a uniform interface to trigger application events from external systems and",
    "Provides a uniform interface to trigger application events from external systems and",
    "Middleware",
    "Middleware",
    "Allows custom middleware to plug into the request processing pipeline and invoke",
    "Allows custom middleware to plug into the request processing pipeline and invoke",
    "Secret stores",
    "Secret stores",
    "Provides a uniform interface to interact with external secret stores, including cloud,",
    "Provides a uniform interface to interact with external secret stores, including cloud,",
    "As the jet completes its fly over of Dapr, you look back once more and can see how it connects",
    "As the jet completes its fly over of Dapr, you look back once more and can see how it connects",
    "Sidecar architecture",
    "Sidecar architecture",
    "Dapr exposes its building blocks and components through a sidecar architecture. A sidecar enables",
    "Dapr exposes its building blocks and components through a sidecar architecture. A sidecar enables",
    "13",
    "13",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-4. Sidecar architecture.",
    "Figure 2-4. Sidecar architecture.",
    "This pattern is named Sidecar because it resembles a sidecar attached to a motorcycle. In the previous",
    "This pattern is named Sidecar because it resembles a sidecar attached to a motorcycle. In the previous",
    "Hosting environments",
    "Hosting environments",
    "Dapr has cross-platform support and can run in many different environments. These environments",
    "Dapr has cross-platform support and can run in many different environments. These environments",
    "For local development, the easiest way to get started is with self-hosted mode. In self-hosted mode,",
    "For local development, the easiest way to get started is with self-hosted mode. In self-hosted mode,",
    "Figure 2-5 shows an application and Dapr hosted in two separate memory processes communicating",
    "Figure 2-5 shows an application and Dapr hosted in two separate memory processes communicating",
    "14",
    "14",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-5. Self-hosted Dapr sidecar.",
    "Figure 2-5. Self-hosted Dapr sidecar.",
    "By default, Dapr installs Docker containers for Redis and Zipkin to provide default state management",
    "By default, Dapr installs Docker containers for Redis and Zipkin to provide default state management",
    "Dapr also runs in containerized environments, such as Kubernetes. Figure 2-6 shows Dapr running in a",
    "Dapr also runs in containerized environments, such as Kubernetes. Figure 2-6 shows Dapr running in a",
    "Figure 2-6. Kubernetes-hosted Dapr sidecar.",
    "Figure 2-6. Kubernetes-hosted Dapr sidecar.",
    "Dapr performance considerations",
    "Dapr performance considerations",
    "As you\u2019ve seen, Dapr exposes a sidecar architecture to decouple your application from distributed",
    "As you\u2019ve seen, Dapr exposes a sidecar architecture to decouple your application from distributed",
    "15",
    "15",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-7. Dapr traffic patterns.",
    "Figure 2-7. Dapr traffic patterns.",
    "Looking at the previous figure, one might question the latency and overhead incurred for each call.",
    "Looking at the previous figure, one might question the latency and overhead incurred for each call.",
    "The Dapr team has invested heavily in performance. A tremendous amount of engineering effort has",
    "The Dapr team has invested heavily in performance. A tremendous amount of engineering effort has",
    "To increase performance, developers can call the Dapr building blocks with gRPC.",
    "To increase performance, developers can call the Dapr building blocks with gRPC.",
    "gRPC is a modern, high-performance framework that evolves the age-old remote procedure call (RPC)",
    "gRPC is a modern, high-performance framework that evolves the age-old remote procedure call (RPC)",
    "\u2022  Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1",
    "\u2022  Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1",
    "limits processing to one request/response message at a time.",
    "limits processing to one request/response message at a time.",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Bidirectional full-duplex communication for sending both client requests and server responses",
    "Bidirectional full-duplex communication for sending both client requests and server responses",
    "Built-in streaming enabling requests and responses to asynchronously stream large data sets.",
    "Built-in streaming enabling requests and responses to asynchronously stream large data sets.",
    "To learn more, check out the gRPC overview from the Architecting Cloud-Native .NET Apps for Azure",
    "To learn more, check out the gRPC overview from the Architecting Cloud-Native .NET Apps for Azure",
    "Dapr and service meshes",
    "Dapr and service meshes",
    "Service mesh is another rapidly evolving technology for distributed applications.",
    "Service mesh is another rapidly evolving technology for distributed applications.",
    "A service mesh is a configurable infrastructure layer with built-in capabilities to handle service-to-",
    "A service mesh is a configurable infrastructure layer with built-in capabilities to handle service-to-",
    "Figure 2-8 shows an application that implements service mesh technology.",
    "Figure 2-8 shows an application that implements service mesh technology.",
    "16",
    "16",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-8. Service mesh with a side car.",
    "Figure 2-8. Service mesh with a side car.",
    "The previous figure shows how messages are intercepted by a sidecar proxy that runs alongside each",
    "The previous figure shows how messages are intercepted by a sidecar proxy that runs alongside each",
    "So the question becomes, \u201cIs Dapr a service mesh?\u201d.",
    "So the question becomes, \u201cIs Dapr a service mesh?\u201d.",
    "While both use a sidecar architecture, each technology has a different purpose. Dapr provides",
    "While both use a sidecar architecture, each technology has a different purpose. Dapr provides",
    "As each works at a different level, both can work together in the same application. For example, a",
    "As each works at a different level, both can work together in the same application. For example, a",
    "Figure 2-9 shows an application that implements both Dapr and service mesh technology.",
    "Figure 2-9 shows an application that implements both Dapr and service mesh technology.",
    "17",
    "17",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "Figure 2-9. Dapr and service mesh together.",
    "Figure 2-9. Dapr and service mesh together.",
    "The Dapr online documentation cover Dapr and service mesh integration.",
    "The Dapr online documentation cover Dapr and service mesh integration.",
    "Summary",
    "Summary",
    "This chapter introduced you to Dapr, a Distributed Application Runtime.",
    "This chapter introduced you to Dapr, a Distributed Application Runtime.",
    "Dapr is an open-source project sponsored by Microsoft with close collaboration from customers and",
    "Dapr is an open-source project sponsored by Microsoft with close collaboration from customers and",
    "At its core, Dapr helps reduce the inherent complexity of distributed microservice applications. It\u2019s",
    "At its core, Dapr helps reduce the inherent complexity of distributed microservice applications. It\u2019s",
    "In the next chapters, we present practical, hands-on instruction on how to use Dapr in your",
    "In the next chapters, we present practical, hands-on instruction on how to use Dapr in your",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "18",
    "18",
    "Dapr documentation",
    "Dapr documentation",
    "Learning Dapr",
    "Learning Dapr",
    ".NET Microservices: Architecture for Containerized .NET applications",
    ".NET Microservices: Architecture for Containerized .NET applications",
    "Architecting Cloud-Native .NET Apps for Azure",
    "Architecting Cloud-Native .NET Apps for Azure",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER 3 | Dapr at 20,000 feet",
    "CHAPTER  4",
    "CHAPTER  4",
    "Get started with Dapr",
    "Get started with Dapr",
    "In the first two chapters, you learned basic concepts about Dapr. It\u2019s time to take it for a test drive. This",
    "In the first two chapters, you learned basic concepts about Dapr. It\u2019s time to take it for a test drive. This",
    "Install Dapr into your local environment",
    "Install Dapr into your local environment",
    "You\u2019ll start by installing Dapr on your development computer. Once complete, you can build and run",
    "You\u2019ll start by installing Dapr on your development computer. Once complete, you can build and run",
    "Install the Dapr CLI. It enables you to launch, run, and manage Dapr instances. It also provides",
    "Install the Dapr CLI. It enables you to launch, run, and manage Dapr instances. It also provides",
    "Install Docker Desktop. If you\u2019re running on Windows, make sure that Docker Desktop for",
    "Install Docker Desktop. If you\u2019re running on Windows, make sure that Docker Desktop for",
    "[",
    "[",
    "Initialize Dapr. This step sets up your development environment by installing the latest Dapr",
    "Initialize Dapr. This step sets up your development environment by installing the latest Dapr",
    "Install the .NET 7 SDK.",
    "Install the .NET 7 SDK.",
    "Now that Dapr is installed, it\u2019s time to build your first Dapr application",
    "Now that Dapr is installed, it\u2019s time to build your first Dapr application",
    "Build your first Dapr application",
    "Build your first Dapr application",
    "You\u2019ll start by building a simple .NET Console application that consumes the Dapr state management",
    "You\u2019ll start by building a simple .NET Console application that consumes the Dapr state management",
    "Create the application",
    "Create the application",
    "Open up the command shell or terminal of your choice. You might consider the terminal",
    "Open up the command shell or terminal of your choice. You might consider the terminal",
    "capabilities in Visual Studio Code. Navigate to the root folder in which you want to build your",
    "capabilities in Visual Studio Code. Navigate to the root folder in which you want to build your",
    "dotnet new console -o DaprCounter",
    "dotnet new console -o DaprCounter",
    "The command scaffolds a simple ",
    "The command scaffolds a simple ",
    "19",
    "19",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.",
    "1.",
    "Then, navigate into the new directory created by the previous command:",
    "Then, navigate into the new directory created by the previous command:",
    "cd DaprCounter",
    "cd DaprCounter",
    "Run the newly created application using the dotnet run command. Doing so writes \u201cHello",
    "Run the newly created application using the dotnet run command. Doing so writes \u201cHello",
    "dotnet run",
    "dotnet run",
    "Add Dapr State Management",
    "Add Dapr State Management",
    "Next, you\u2019ll use the Dapr state management building block to implement a stateful counter in the",
    "Next, you\u2019ll use the Dapr state management building block to implement a stateful counter in the",
    "You can invoke Dapr APIs across any development platform using Dapr\u2019s native support for HTTP and",
    "You can invoke Dapr APIs across any development platform using Dapr\u2019s native support for HTTP and",
    "From the terminal window, add the Dapr.Client NuGet package to your application:",
    "From the terminal window, add the Dapr.Client NuGet package to your application:",
    "dotnet add package Dapr.Client",
    "dotnet add package Dapr.Client",
    "Open the Program.cs file in your favorite editor and update its contents to the following code:",
    "Open the Program.cs file in your favorite editor and update its contents to the following code:",
    "using Dapr.Client",
    "using Dapr.Client",
    "The updated code implements the following steps:",
    "The updated code implements the following steps:",
    "First a new ",
    "First a new ",
    "From the state store, ",
    "From the state store, ",
    "The code then iterates, writing the ",
    "The code then iterates, writing the ",
    "The Dapr CLI run command starts the application. It invokes the underlying Dapr runtime and",
    "The Dapr CLI run command starts the application. It invokes the underlying Dapr runtime and",
    "[",
    "[",
    "20",
    "20",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "state key for each key/value pair. If the application id changes, you can no longer access the",
    "state key for each key/value pair. If the application id changes, you can no longer access the",
    "Now run the application with the following command:",
    "Now run the application with the following command:",
    "dapr run --app-id DaprCounter dotnet run",
    "dapr run --app-id DaprCounter dotnet run",
    "Try stopping and restarting the application. You",
    "Try stopping and restarting the application. You",
    "Important",
    "Important",
    "It\u2019s important to understand your sample application communicates with a pre-configured state",
    "It\u2019s important to understand your sample application communicates with a pre-configured state",
    "You might be wondering, where exactly is the state stored?",
    "You might be wondering, where exactly is the state stored?",
    "Component configuration files",
    "Component configuration files",
    "When you first initialized Dapr for your local environment, it automatically provisioned a Redis",
    "When you first initialized Dapr for your local environment, it automatically provisioned a Redis",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "Note",
    "Note",
    "Default component configuration files are stored in the $HOME/.dapr/components folder on",
    "Default component configuration files are stored in the $HOME/.dapr/components folder on",
    "Note the format of the previous component configuration file:",
    "Note the format of the previous component configuration file:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "21",
    "21",
    "Each component has a name. In the sample above, the component is named statestore. We",
    "Each component has a name. In the sample above, the component is named statestore. We",
    "Each component configuration file has a spec section. It contains a type field that specifies the",
    "Each component configuration file has a spec section. It contains a type field that specifies the",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "contains information that the component requires, such as connection details and other settings.",
    "contains information that the component requires, such as connection details and other settings.",
    "A Dapr sidecar can consume any Dapr component configured in your application. But, what if you had",
    "A Dapr sidecar can consume any Dapr component configured in your application. But, what if you had",
    "To do so, you could define a namespace for the production environment. You might name it",
    "To do so, you could define a namespace for the production environment. You might name it",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "Important",
    "Important",
    "A namespaced component is only accessible to applications running in the same namespace. If your",
    "A namespaced component is only accessible to applications running in the same namespace. If your",
    "If needed, you could further restrict a component to a particular application. Within the production",
    "If needed, you could further restrict a component to a particular application. Within the production",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "22",
    "22",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "value: localhost:6379",
    "value: localhost:6379",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "DaprCounter",
    "DaprCounter",
    "Build a multi-container Dapr application",
    "Build a multi-container Dapr application",
    "In the first example, you created a simple .NET console application that ran side-by-side with a Dapr",
    "In the first example, you created a simple .NET console application that ran side-by-side with a Dapr",
    "In the next example, you\u2019ll create a multi-container application. You\u2019ll also use the Dapr service",
    "In the next example, you\u2019ll create a multi-container application. You\u2019ll also use the Dapr service",
    "Make sure you\u2019ve configured your local environment for Dapr and installed the .NET 7 Development",
    "Make sure you\u2019ve configured your local environment for Dapr and installed the .NET 7 Development",
    "Additionally, you\u2019ll need to complete this sample using Visual Studio 2022 with the ASP.NET and web",
    "Additionally, you\u2019ll need to complete this sample using Visual Studio 2022 with the ASP.NET and web",
    "Create the application",
    "Create the application",
    "In Visual Studio 2022, create an ASP.NET Core Web App project:",
    "In Visual Studio 2022, create an ASP.NET Core Web App project:",
    "23",
    "23",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.  Name your project MyFrontEnd and your solution DaprMultiContainer:",
    "1.  Name your project MyFrontEnd and your solution DaprMultiContainer:",
    "24",
    "24",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.",
    "1.",
    "In the final dialog, keep the defaults. Don\u2019t select Enable Docker Support. You\u2019ll add Docker",
    "In the final dialog, keep the defaults. Don\u2019t select Enable Docker Support. You\u2019ll add Docker",
    "25",
    "25",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.",
    "1.",
    "For the backend, add an ASP.NET Core Web API project to the same solution:",
    "For the backend, add an ASP.NET Core Web API project to the same solution:",
    "26",
    "26",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.  Name the project MyBackEnd:",
    "1.  Name the project MyBackEnd:",
    "By default, a Dapr sidecar relies on the network boundary to limit access to its public API. So,",
    "By default, a Dapr sidecar relies on the network boundary to limit access to its public API. So,",
    "[",
    "[",
    "Add Dapr service invocation",
    "Add Dapr service invocation",
    "Now, you\u2019ll configure communication between the services using Dapr service invocation building",
    "Now, you\u2019ll configure communication between the services using Dapr service invocation building",
    "27",
    "27",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.",
    "1.",
    "In Visual Studio, open the Package Manager Console (Tools > NuGet Package Manager >",
    "In Visual Studio, open the Package Manager Console (Tools > NuGet Package Manager >",
    "Install-Package Dapr.AspNetCore",
    "Install-Package Dapr.AspNetCore",
    "In the MyFrontEnd project, open the Program.cs file and add a call to",
    "In the MyFrontEnd project, open the Program.cs file and add a call to",
    "var builder = WebApplication.CreateBuilder(args)",
    "var builder = WebApplication.CreateBuilder(args)",
    "The ",
    "The ",
    "Add a new C# class file named WeatherForecast to the MyFrontEnd project:",
    "Add a new C# class file named WeatherForecast to the MyFrontEnd project:",
    "namespace MyFrontEnd",
    "namespace MyFrontEnd",
    "Open the Index.cshtml.cs file in the Pages folder, and replace its contents with the following",
    "Open the Index.cshtml.cs file in the Pages folder, and replace its contents with the following",
    "code:",
    "code:",
    "using Dapr.Client;",
    "using Dapr.Client;",
    "}",
    "}",
    "You add Dapr capabilities into the web app by injecting the ",
    "You add Dapr capabilities into the web app by injecting the ",
    "28",
    "28",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "whenever a user visits the home page. You use the",
    "whenever a user visits the home page. You use the",
    "Replace the contents of the Index.cshtml file in the Pages folder, with the following code. It",
    "Replace the contents of the Index.cshtml file in the Pages folder, with the following code. It",
    "@page",
    "@page",
    "Add container support",
    "Add container support",
    "In the final part of this example, you\u2019ll add container support and run the solution using Docker",
    "In the final part of this example, you\u2019ll add container support and run the solution using Docker",
    "Right-click the MyFrontEnd project, and choose Add > Container Orchestrator Support\u2026. The",
    "Right-click the MyFrontEnd project, and choose Add > Container Orchestrator Support\u2026. The",
    "Choose ",
    "Choose ",
    "In the next dialog, select Linux as the Target OS:",
    "In the next dialog, select Linux as the Target OS:",
    "29",
    "29",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "Visual Studio creates a ",
    "Visual Studio creates a ",
    "30",
    "30",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "The ",
    "The ",
    "version: ",
    "version: ",
    "The ",
    "The ",
    "31",
    "31",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "In the root of the ",
    "In the root of the ",
    "The ",
    "The ",
    "FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base",
    "FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base",
    "The preceding ",
    "The preceding ",
    "Pulls the ",
    "Pulls the ",
    "Sets the working directory to ",
    "Sets the working directory to ",
    "Exposes port ",
    "Exposes port ",
    "Pulls the ",
    "Pulls the ",
    "Sets the working directory to ",
    "Sets the working directory to ",
    "Copies the ",
    "Copies the ",
    "Calls ",
    "Calls ",
    "Copies everything from the root directory into the image",
    "Copies everything from the root directory into the image",
    "Sets the working directory to ",
    "Sets the working directory to ",
    "Calls ",
    "Calls ",
    "Targeting the ",
    "Targeting the ",
    "Initializes a new build stage from the existing ",
    "Initializes a new build stage from the existing ",
    "Calls ",
    "Calls ",
    "Targeting the ",
    "Targeting the ",
    "Initializes a new build stage from the existing ",
    "Initializes a new build stage from the existing ",
    "Sets the working directory to ",
    "Sets the working directory to ",
    "Copies the ",
    "Copies the ",
    "Sets the entry point as the image to ",
    "Sets the entry point as the image to ",
    "32",
    "32",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "1.",
    "1.",
    "In the MyBackEnd web API project, right-click on the project node, and choose Add > Container",
    "In the MyBackEnd web API project, right-click on the project node, and choose Add > Container",
    "In the root of the MyBackEnd project directory, a new Dockerfile was created. The Dockerfile",
    "In the root of the MyBackEnd project directory, a new Dockerfile was created. The Dockerfile",
    "FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base",
    "FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base",
    "Open the ",
    "Open the ",
    "version: ",
    "version: ",
    "To use Dapr building blocks from inside a containerized application, you\u2019ll need to add the Dapr",
    "To use Dapr building blocks from inside a containerized application, you\u2019ll need to add the Dapr",
    "version: ",
    "version: ",
    "33",
    "33",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "- myfrontend",
    "- myfrontend",
    "In the updated file, we",
    "In the updated file, we",
    "The sidecars use the ",
    "The sidecars use the ",
    "Each service defined in the Compose file has its own network namespace for network",
    "Each service defined in the Compose file has its own network namespace for network",
    "The ports on which the Dapr sidecars are listening for gRPC communication (by",
    "The ports on which the Dapr sidecars are listening for gRPC communication (by",
    "Run the solution (F5 or Ctrl+F5) to verify that it works as expected. If everything is configured",
    "Run the solution (F5 or Ctrl+F5) to verify that it works as expected. If everything is configured",
    "34",
    "34",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "Running locally with Docker Compose and Visual Studio, you can set breakpoints and",
    "Running locally with Docker Compose and Visual Studio, you can set breakpoints and",
    "To learn more about the Dapr service invocation building block used in this",
    "To learn more about the Dapr service invocation building block used in this",
    "Summary",
    "Summary",
    "In this chapter, you had an opportunity to test drive Dapr. Using the Dapr .NET SDK, you saw how",
    "In this chapter, you had an opportunity to test drive Dapr. Using the Dapr .NET SDK, you saw how",
    "The first example was a simple, stateful, .NET Console application that used the Dapr state",
    "The first example was a simple, stateful, .NET Console application that used the Dapr state",
    "The second example involved a multi-container application running in Docker. By using Visual Studio",
    "The second example involved a multi-container application running in Docker. By using Visual Studio",
    "You also got a closer look at Dapr component configuration files. They configure the actual",
    "You also got a closer look at Dapr component configuration files. They configure the actual",
    "In the upcoming chapters, you\u2019ll dive deep into the building blocks offered by Dapr.",
    "In the upcoming chapters, you\u2019ll dive deep into the building blocks offered by Dapr.",
    "References",
    "References",
    "Dapr documentation - Getting started",
    "Dapr documentation - Getting started",
    "eShopOnDapr",
    "eShopOnDapr",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "35",
    "35",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER 4 | Get started with Dapr",
    "CHAPTER  5",
    "CHAPTER  5",
    "Traffic Control sample",
    "Traffic Control sample",
    "In the first chapters, you\u2019ve learned about basic Dapr concepts. You saw how Dapr can help you and",
    "In the first chapters, you\u2019ve learned about basic Dapr concepts. You saw how Dapr can help you and",
    "Note",
    "Note",
    "Download the sample application code from the Dapr Traffic Control GitHub repo. This repository",
    "Download the sample application code from the Dapr Traffic Control GitHub repo. This repository",
    "The Traffic Control sample application simulates a highway traffic control system. Its purpose is to",
    "The Traffic Control sample application simulates a highway traffic control system. Its purpose is to",
    "Although the simulation is simple, responsibilities within the system are separated into several",
    "Although the simulation is simple, responsibilities within the system are separated into several",
    "36",
    "36",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "37",
    "37",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "Figure 4-1. The services in the sample application.",
    "Figure 4-1. The services in the sample application.",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The Camera Simulation is a console application that simulates vehicles and sends messages to",
    "The Camera Simulation is a console application that simulates vehicles and sends messages to",
    "The TrafficControl service is an ASP.NET Core Web API application that exposes the /entrycam",
    "The TrafficControl service is an ASP.NET Core Web API application that exposes the /entrycam",
    "The FineCollection service is an ASP.NET Core Web API application that offers 1 endpoint:",
    "The FineCollection service is an ASP.NET Core Web API application that offers 1 endpoint:",
    "The VehicleRegistration service is an ASP.NET Core Web API application that offers 1 endpoint:",
    "The VehicleRegistration service is an ASP.NET Core Web API application that offers 1 endpoint:",
    "The sequence diagram in figure 4.2 shows the simulation flow:",
    "The sequence diagram in figure 4.2 shows the simulation flow:",
    "Figure 4-2. Sequence diagram of the simulation flow.",
    "Figure 4-2. Sequence diagram of the simulation flow.",
    "The services communicate by directly invoking each other\u2019s APIs. This design works fine, but it has",
    "The services communicate by directly invoking each other\u2019s APIs. This design works fine, but it has",
    "38",
    "38",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "The biggest challenge is that the call-chain will break if one of the services is off-line. Decoupling",
    "The biggest challenge is that the call-chain will break if one of the services is off-line. Decoupling",
    "Another drawback is that the vehicle state for every vehicle is stored in memory in the TrafficControl",
    "Another drawback is that the vehicle state for every vehicle is stored in memory in the TrafficControl",
    "Using Dapr building blocks",
    "Using Dapr building blocks",
    "One of the goals of Dapr is to provide cloud-native capabilities for microservices applications. The",
    "One of the goals of Dapr is to provide cloud-native capabilities for microservices applications. The",
    "Figure 4-3. Traffic Control application with Dapr building blocks.",
    "Figure 4-3. Traffic Control application with Dapr building blocks.",
    "Service invocation The Dapr service invocation building block handles request/response",
    "Service invocation The Dapr service invocation building block handles request/response",
    "Publish ",
    "Publish ",
    "State management The TrafficControl service uses the state management building block to",
    "State management The TrafficControl service uses the state management building block to",
    "Output binding The FineCollection service sends fines to the owners of speeding vehicles by",
    "Output binding The FineCollection service sends fines to the owners of speeding vehicles by",
    "email. The Dapr output binding for SMTP abstracts the email transmission using the SMTP",
    "email. The Dapr output binding for SMTP abstracts the email transmission using the SMTP",
    "39",
    "39",
    "Input binding The CameraSimulation sends messages with simulated car info to the",
    "Input binding The CameraSimulation sends messages with simulated car info to the",
    "Secrets management The FineCollectionService needs credentials for connecting to the smtp",
    "Secrets management The FineCollectionService needs credentials for connecting to the smtp",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "7.  Actors The TrafficControlService has an alternative implementation based on Dapr actors. In this",
    "7.  Actors The TrafficControlService has an alternative implementation based on Dapr actors. In this",
    "Figure 4.4 shows a sequence diagram of the flow of the simulation with all the Dapr building blocks in",
    "Figure 4.4 shows a sequence diagram of the flow of the simulation with all the Dapr building blocks in",
    "Figure 4-4. Sequence diagram of simulation flow with Dapr building blocks.",
    "Figure 4-4. Sequence diagram of simulation flow with Dapr building blocks.",
    "The rest of this book features a chapter for each of the Dapr building blocks. Each chapter explains in",
    "The rest of this book features a chapter for each of the Dapr building blocks. Each chapter explains in",
    "Hosting",
    "Hosting",
    "The Traffic Control sample application can run in self-hosted mode or in Kubernetes.",
    "The Traffic Control sample application can run in self-hosted mode or in Kubernetes.",
    "Self-hosted mode",
    "Self-hosted mode",
    "The sample repository contains PowerShell scripts to start the infrastructure services (Redis,",
    "The sample repository contains PowerShell scripts to start the infrastructure services (Redis,",
    "40",
    "40",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "Kubernetes",
    "Kubernetes",
    "The src/k8s folder in the sample repository contains the Kubernetes manifest files to run the",
    "The src/k8s folder in the sample repository contains the Kubernetes manifest files to run the",
    "Summary",
    "Summary",
    "The Traffic Control sample application is a microservices application that simulates a highway speed",
    "The Traffic Control sample application is a microservices application that simulates a highway speed",
    "The application uses several Dapr building blocks to make it robust and cloud-native. The domain is",
    "The application uses several Dapr building blocks to make it robust and cloud-native. The domain is",
    "The application will be used in the following chapters that focus on Dapr building block.",
    "The application will be used in the following chapters that focus on Dapr building block.",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr Traffic Control Sample",
    "Dapr Traffic Control Sample",
    "41",
    "41",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER 5 | Traffic Control sample application",
    "CHAPTER  6",
    "CHAPTER  6",
    "The Dapr state",
    "The Dapr state",
    "Distributed applications are composed of independent services. While each service should be",
    "Distributed applications are composed of independent services. While each service should be",
    "To try out the state management building block, have a look at the counter application sample in",
    "To try out the state management building block, have a look at the counter application sample in",
    "What it solves",
    "What it solves",
    "Tracking state in a distributed application can be challenging. For example:",
    "Tracking state in a distributed application can be challenging. For example:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The application may require different types of data stores.",
    "The application may require different types of data stores.",
    "Different consistency levels may be required for accessing and updating data.",
    "Different consistency levels may be required for accessing and updating data.",
    "\u2022  Multiple users may update data at the same time, requiring conflict resolution.",
    "\u2022  Multiple users may update data at the same time, requiring conflict resolution.",
    "\u2022",
    "\u2022",
    "Services must retry any short-lived transient errors that occur while interacting with the data",
    "Services must retry any short-lived transient errors that occur while interacting with the data",
    "The Dapr state management building block addresses these challenges. It streamlines tracking state",
    "The Dapr state management building block addresses these challenges. It streamlines tracking state",
    "Important",
    "Important",
    "Dapr state management offers a key/value API. The feature doesn\u2019t support relational or graph data",
    "Dapr state management offers a key/value API. The feature doesn\u2019t support relational or graph data",
    "42",
    "42",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "How it works",
    "How it works",
    "The application interacts with a Dapr sidecar to store and retrieve key/value data. Under the hood, the",
    "The application interacts with a Dapr sidecar to store and retrieve key/value data. Under the hood, the",
    "The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "http://localhost:",
    "http://localhost:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "<dapr-port>",
    "<dapr-port>",
    "<store-name>",
    "<store-name>",
    "Figure 5-1 shows how a Dapr-enabled shopping basket service stores a key/value pair using the Dapr",
    "Figure 5-1 shows how a Dapr-enabled shopping basket service stores a key/value pair using the Dapr",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/state-management-flow.png\u201d alt-",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/state-management-flow.png\u201d alt-",
    "Figure 5-1. Storing a key/value pair in a Dapr state store.",
    "Figure 5-1. Storing a key/value pair in a Dapr state store.",
    "Note the steps in the previous figure:",
    "Note the steps in the previous figure:",
    "The basket service calls the state management API on the Dapr sidecar. The body of the request",
    "The basket service calls the state management API on the Dapr sidecar. The body of the request",
    "The Dapr sidecar determines the state store based on the component configuration file. In this",
    "The Dapr sidecar determines the state store based on the component configuration file. In this",
    "The sidecar persists the data to the Redis cache.",
    "The sidecar persists the data to the Redis cache.",
    "Retrieving the stored data is a similar API call. In the example below, a curl command retrieves the",
    "Retrieving the stored data is a similar API call. In the example below, a curl command retrieves the",
    "curl http://localhost:3500/v1.0/state/statestore/basket1",
    "curl http://localhost:3500/v1.0/state/statestore/basket1",
    "The command returns the stored state in the response body:",
    "The command returns the stored state in the response body:",
    "{",
    "{",
    "The following sections explain how to use the more advanced features of the state management",
    "The following sections explain how to use the more advanced features of the state management",
    "Consistency",
    "Consistency",
    "The CAP theorem is a set of principles that apply to distributed systems that store state. Figure 5-2",
    "The CAP theorem is a set of principles that apply to distributed systems that store state. Figure 5-2",
    "43",
    "43",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/cap-theorem.png\u201d alt-text=\u201cThe CAP",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/cap-theorem.png\u201d alt-text=\u201cThe CAP",
    "Figure 5-2. The CAP theorem.",
    "Figure 5-2. The CAP theorem.",
    "The theorem states that distributed data systems offer a trade-off between consistency, availability,",
    "The theorem states that distributed data systems offer a trade-off between consistency, availability,",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Consistency (C). Every node in the cluster responds with the most recent data, even if the system",
    "Consistency (C). Every node in the cluster responds with the most recent data, even if the system",
    "Availability (A). Every node returns an immediate response, even if that response isn\u2019t the most",
    "Availability (A). Every node returns an immediate response, even if that response isn\u2019t the most",
    "Partition Tolerance (P). Guarantees the system continues to operate even if a replicated data",
    "Partition Tolerance (P). Guarantees the system continues to operate even if a replicated data",
    "Distributed applications must handle the P property. As services communicate among each other with",
    "Distributed applications must handle the P property. As services communicate among each other with",
    "AP applications choose availability over consistency. Dapr supports this choice with its eventual",
    "AP applications choose availability over consistency. Dapr supports this choice with its eventual",
    "CP applications choose consistency over availability. Dapr supports this choice with its strong",
    "CP applications choose consistency over availability. Dapr supports this choice with its strong",
    "The consistency level for a state operation is specified by attaching a consistency hint to the operation.",
    "The consistency level for a state operation is specified by attaching a consistency hint to the operation.",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "44",
    "44",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "Important",
    "Important",
    "It is up to the Dapr state store component to fulfill the consistency hint attached to the operation. Not",
    "It is up to the Dapr state store component to fulfill the consistency hint attached to the operation. Not",
    "Concurrency",
    "Concurrency",
    "In a multi-user application, there\u2019s a chance that multiple users will update the same data concurrently",
    "In a multi-user application, there\u2019s a chance that multiple users will update the same data concurrently",
    "Dapr supports optimistic concurrency control (OCC) using ETags. An ETag is a value associated with a",
    "Dapr supports optimistic concurrency control (OCC) using ETags. An ETag is a value associated with a",
    "Dapr also supports a last-write-wins strategy. With this approach, the client doesn\u2019t attach an ETag",
    "Dapr also supports a last-write-wins strategy. With this approach, the client doesn\u2019t attach an ETag",
    "Transactions",
    "Transactions",
    "Dapr can write multi-item changes to a data store as a single operation implemented as a transaction.",
    "Dapr can write multi-item changes to a data store as a single operation implemented as a transaction.",
    "In the example below, a multi-item operation is sent to the state store in a single transaction. All",
    "In the example below, a multi-item operation is sent to the state store in a single transaction. All",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "45",
    "45",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "]",
    "]",
    "For data stores that don\u2019t support transactions, multiple keys can still be sent as a single request. The",
    "For data stores that don\u2019t support transactions, multiple keys can still be sent as a single request. The",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "curl -X POST http://localhost:3500/v1.0/state/",
    "For bulk operations, Dapr will submit each key/value pair update as a separate request to the data",
    "For bulk operations, Dapr will submit each key/value pair update as a separate request to the data",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "The Dapr .NET SDK provides language-specific support for the .NET platform. Developers can use the",
    "The Dapr .NET SDK provides language-specific support for the .NET platform. Developers can use the",
    "var weatherForecast = await daprClient.GetStateAsync",
    "var weatherForecast = await daprClient.GetStateAsync",
    "If the state store contains no data for key AMS, the result will be default(WeatherForecast).",
    "If the state store contains no data for key AMS, the result will be default(WeatherForecast).",
    "To write data to the data store, use the DaprClient.SaveStateAsync",
    "To write data to the data store, use the DaprClient.SaveStateAsync",
    "daprClient.SaveStateAsync(",
    "daprClient.SaveStateAsync(",
    "The example uses the last-write-wins strategy as an ETag value isn\u2019t passed to the state store",
    "The example uses the last-write-wins strategy as an ETag value isn\u2019t passed to the state store",
    "var (weatherForecast, etag) = await",
    "var (weatherForecast, etag) = await",
    "// ... make some changes to the retrieved weather forecast",
    "// ... make some changes to the retrieved weather forecast",
    "var result = await daprClient.TrySaveStateAsync(",
    "var result = await daprClient.TrySaveStateAsync(",
    "The DaprClient.TrySaveStateAsync method fails when the data (and associated ETag) has been",
    "The DaprClient.TrySaveStateAsync method fails when the data (and associated ETag) has been",
    "If you always want a write to succeed regardless of other changes to the data, use the last-write-wins",
    "If you always want a write to succeed regardless of other changes to the data, use the last-write-wins",
    "The SDK provides other methods to retrieve data in bulk, delete data, and execute transactions. For",
    "The SDK provides other methods to retrieve data in bulk, delete data, and execute transactions. For",
    "46",
    "46",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "ASP.NET Core integration",
    "ASP.NET Core integration",
    "Dapr also supports ASP.NET Core, a cross-platform framework for building modern cloud-based web",
    "Dapr also supports ASP.NET Core, a cross-platform framework for building modern cloud-based web",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "Once configured, Dapr can inject a key/value pair directly into a controller action using the ASP.NET",
    "Once configured, Dapr can inject a key/value pair directly into a controller action using the ASP.NET",
    "[",
    "[",
    "}",
    "}",
    "In the example, the controller loads the weather forecast using the FromState attribute. The first",
    "In the example, the controller loads the weather forecast using the FromState attribute. The first",
    "The StateEntry class contains properties for all the information that is retrieved for a single key/value",
    "The StateEntry class contains properties for all the information that is retrieved for a single key/value",
    "[",
    "[",
    "}",
    "}",
    "State store components",
    "State store components",
    "At the time of this writing, Dapr provides support for the following transactional state stores:",
    "At the time of this writing, Dapr provides support for the following transactional state stores:",
    "47",
    "47",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Azure CosmosDB",
    "Azure CosmosDB",
    "Azure SQL Server",
    "Azure SQL Server",
    "CockroachDB",
    "CockroachDB",
    "In Memory",
    "In Memory",
    "\u2022  MongoDB",
    "\u2022  MongoDB",
    "\u2022  MySQL",
    "\u2022  MySQL",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Oracle Database",
    "Oracle Database",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "Dapr also includes support for state stores that support CRUD operations, but not transactional",
    "Dapr also includes support for state stores that support CRUD operations, but not transactional",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Aerospike",
    "Aerospike",
    "Apache Cassandra",
    "Apache Cassandra",
    "AWS DynamoDB",
    "AWS DynamoDB",
    "Azure Blob Storage",
    "Azure Blob Storage",
    "Azure Table Storage",
    "Azure Table Storage",
    "Couchbase",
    "Couchbase",
    "GCP Firestore",
    "GCP Firestore",
    "Hashicorp Consul",
    "Hashicorp Consul",
    "Hazelcast",
    "Hazelcast",
    "JetStream KV",
    "JetStream KV",
    "\u2022  Memcached",
    "\u2022  Memcached",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Oracle Object Storage",
    "Oracle Object Storage",
    "Zookeeper",
    "Zookeeper",
    "Configuration",
    "Configuration",
    "When initialized for local, self-hosted development, Dapr registers Redis as the default state store.",
    "When initialized for local, self-hosted development, Dapr registers Redis as the default state store.",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "48",
    "48",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "[",
    "[",
    "The Redis state store requires redisHost and redisPassword metadata to connect to the Redis",
    "The Redis state store requires redisHost and redisPassword metadata to connect to the Redis",
    "The other metadata field, actorStateStore, indicates whether the state store can be consumed by",
    "The other metadata field, actorStateStore, indicates whether the state store can be consumed by",
    "Key prefix strategies",
    "Key prefix strategies",
    "State store components enable different strategies to store key/value pairs in the underlying store.",
    "State store components enable different strategies to store key/value pairs in the underlying store.",
    "curl -X POST http://localhost:3500/v1.0/state/statestore ",
    "curl -X POST http://localhost:3500/v1.0/state/statestore ",
    "Using the Redis Console tool, look inside the Redis cache to see how the Redis state store component",
    "Using the Redis Console tool, look inside the Redis cache to see how the Redis state store component",
    "127.0.0.1:6379> KEYS ",
    "127.0.0.1:6379> KEYS ",
    "\"",
    "\"",
    "127.0.0.1:6379> HGETALL basketservice||basket1",
    "127.0.0.1:6379> HGETALL basketservice||basket1",
    "\"",
    "\"",
    "\"",
    "\"",
    "\"",
    "\"",
    "\"",
    "\"",
    "The output shows the full Redis key for the data as basketservice||basket1. By default, Dapr uses",
    "The output shows the full Redis key for the data as basketservice||basket1. By default, Dapr uses",
    "That said, it\u2019s possible to configure a constant value for the key prefix in the keyPrefix metadata field",
    "That said, it\u2019s possible to configure a constant value for the key prefix in the keyPrefix metadata field",
    "spec:",
    "spec:",
    "name: keyPrefix",
    "name: keyPrefix",
    "value: MyPrefix",
    "value: MyPrefix",
    "49",
    "49",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "A constant key prefix enables the state store to be accessed across multiple Dapr applications. What\u2019s",
    "A constant key prefix enables the state store to be accessed across multiple Dapr applications. What\u2019s",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "In the Dapr Traffic Control sample app, the TrafficControl service uses the Dapr state management",
    "In the Dapr Traffic Control sample app, the TrafficControl service uses the Dapr state management",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/dapr-solution-state-management.png\u201d",
    ":::image type=\u201ccontent\u201d source=\u201c./media/state-management/dapr-solution-state-management.png\u201d",
    "Figure 5-3. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 5-3. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Entry and exit event logic is handled by the TrafficController class, an ordinary ASP.NET Controller.",
    "Entry and exit event logic is handled by the TrafficController class, an ordinary ASP.NET Controller.",
    "// store vehicle state",
    "// store vehicle state",
    "In the preceding code snippet, the abstraction ",
    "In the preceding code snippet, the abstraction ",
    "public class DaprVehicleStateRepository : IVehicleStateRepository",
    "public class DaprVehicleStateRepository : IVehicleStateRepository",
    "}",
    "}",
    "As the preceding code snippet shows, the implementation of the DaprVehicleStateRepository class",
    "As the preceding code snippet shows, the implementation of the DaprVehicleStateRepository class",
    "50",
    "50",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "to save the state to the configured Dapr state store. It uses the vehicle\u2019s license number as the key.",
    "to save the state to the configured Dapr state store. It uses the vehicle\u2019s license number as the key.",
    "The TrafficControl service uses Redis as its underlying data store. Looking at the code, you\u2019d never",
    "The TrafficControl service uses Redis as its underlying data store. Looking at the code, you\u2019d never",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "Note",
    "Note",
    "The component configuration file includes an element secretKeyRef. The application uses it to",
    "The component configuration file includes an element secretKeyRef. The application uses it to",
    "The type element in the configuration, state.redis instructs the building block to manage state with",
    "The type element in the configuration, state.redis instructs the building block to manage state with",
    "The scopes element in the configuration constrains application access to the state store component.",
    "The scopes element in the configuration constrains application access to the state store component.",
    "Summary",
    "Summary",
    "The Dapr state management building block offers an API for storing key/value data across various",
    "The Dapr state management building block offers an API for storing key/value data across various",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Bulk operations",
    "Bulk operations",
    "Strong and eventual consistency",
    "Strong and eventual consistency",
    "Optimistic concurrency control",
    "Optimistic concurrency control",
    "\u2022  Multi-item transactions",
    "\u2022  Multi-item transactions",
    "The .NET SDK provides language-specific support for .NET and ASP.NET Core. Model binding",
    "The .NET SDK provides language-specific support for .NET and ASP.NET Core. Model binding",
    "In the Dapr Traffic Control sample application, the benefits of using Dapr state management are clear:",
    "In the Dapr Traffic Control sample application, the benefits of using Dapr state management are clear:",
    "51",
    "51",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "1.",
    "1.",
    "It abstracts away the complexity of using third-party SDKs, such as StackExchange.Redis.",
    "It abstracts away the complexity of using third-party SDKs, such as StackExchange.Redis.",
    "Replacing the underlying Redis cache with a different type of data store only requires changes to",
    "Replacing the underlying Redis cache with a different type of data store only requires changes to",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr supported state stores",
    "Dapr supported state stores",
    "52",
    "52",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER 6 | The Dapr state management building block",
    "CHAPTER  7",
    "CHAPTER  7",
    "The Dapr service",
    "The Dapr service",
    "Across a distributed system, one service often needs to communicate with another to complete a",
    "Across a distributed system, one service often needs to communicate with another to complete a",
    "What it solves",
    "What it solves",
    "Making calls between services in a distributed application may appear easy, but there are many",
    "Making calls between services in a distributed application may appear easy, but there are many",
    "\u2022  Where the other services are located.",
    "\u2022  Where the other services are located.",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "How to call a service securely, given the service address.",
    "How to call a service securely, given the service address.",
    "How to handle retries when short-lived transient errors occur.",
    "How to handle retries when short-lived transient errors occur.",
    "Lastly, as distributed applications compose many different services, capturing insights across service",
    "Lastly, as distributed applications compose many different services, capturing insights across service",
    "The service invocation building block addresses these challenges by using a Dapr sidecar as a reverse",
    "The service invocation building block addresses these challenges by using a Dapr sidecar as a reverse",
    "How it works",
    "How it works",
    "Let\u2019s start with an example. Consider two services, \u201cService A\u201d and \u201cService B\u201d. Service A needs to call",
    "Let\u2019s start with an example. Consider two services, \u201cService A\u201d and \u201cService B\u201d. Service A needs to call",
    "53",
    "53",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "Figure 6-1. How Dapr service invocation works.",
    "Figure 6-1. How Dapr service invocation works.",
    "Note the steps from the previous figure:",
    "Note the steps from the previous figure:",
    "Service A makes a call to the catalog/items endpoint in Service B by invoking the service",
    "Service A makes a call to the catalog/items endpoint in Service B by invoking the service",
    "[",
    "[",
    "The Service A sidecar forwards the request to the Service B sidecar.",
    "The Service A sidecar forwards the request to the Service B sidecar.",
    "The Service B sidecar makes the actual catalog/items request against the Service B API.",
    "The Service B sidecar makes the actual catalog/items request against the Service B API.",
    "Service B executes the request and returns a response back to its sidecar.",
    "Service B executes the request and returns a response back to its sidecar.",
    "The Service B sidecar forwards the response back to the Service A sidecar.",
    "The Service B sidecar forwards the response back to the Service A sidecar.",
    "The Service A sidecar returns the response back to Service A.",
    "The Service A sidecar returns the response back to Service A.",
    "Because the calls flow through sidecars, Dapr can inject some useful cross-cutting behaviors:",
    "Because the calls flow through sidecars, Dapr can inject some useful cross-cutting behaviors:",
    "\u2022",
    "\u2022",
    "Automatically retry calls upon failure.",
    "Automatically retry calls upon failure.",
    "\u2022  Make calls between services secure with mutual (mTLS) authentication, including automatic",
    "\u2022  Make calls between services secure with mutual (mTLS) authentication, including automatic",
    "certificate rollover.",
    "certificate rollover.",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "54",
    "54",
    "Control what operations clients can do using access control policies.",
    "Control what operations clients can do using access control policies.",
    "Capture traces and metrics for all calls between services to provide insights and diagnostics.",
    "Capture traces and metrics for all calls between services to provide insights and diagnostics.",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "Any application can invoke a Dapr sidecar by using the native invoke API built into Dapr. The API can",
    "Any application can invoke a Dapr sidecar by using the native invoke API built into Dapr. The API can",
    "http://localhost:",
    "http://localhost:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "<dapr-port>",
    "<dapr-port>",
    "<application-id>",
    "<application-id>",
    "<method-name>",
    "<method-name>",
    "In the following example, a curl call is made to the catalog/items \u2018GET\u2019 endpoint of Service B:",
    "In the following example, a curl call is made to the catalog/items \u2018GET\u2019 endpoint of Service B:",
    "curl http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "curl http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "Note",
    "Note",
    "The Dapr APIs enable any application stack that supports HTTP or gRPC to use Dapr building blocks.",
    "The Dapr APIs enable any application stack that supports HTTP or gRPC to use Dapr building blocks.",
    "In the next section, you\u2019ll learn how to use the .NET SDK to simplify service invocation calls.",
    "In the next section, you\u2019ll learn how to use the .NET SDK to simplify service invocation calls.",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "The Dapr .NET SDK provides .NET developers with an intuitive and language-specific way to interact",
    "The Dapr .NET SDK provides .NET developers with an intuitive and language-specific way to interact",
    "Invoke HTTP services using HttpClient",
    "Invoke HTTP services using HttpClient",
    "Invoke HTTP services using DaprClient",
    "Invoke HTTP services using DaprClient",
    "Invoke gRPC services using DaprClient",
    "Invoke gRPC services using DaprClient",
    "Invoke HTTP services using HttpClient",
    "Invoke HTTP services using HttpClient",
    "The preferred way to call an HTTP endpoint is to use Dapr\u2019s rich integration with HttpClient. The",
    "The preferred way to call an HTTP endpoint is to use Dapr\u2019s rich integration with HttpClient. The",
    "var httpClient = DaprClient.CreateInvokeHttpClient();",
    "var httpClient = DaprClient.CreateInvokeHttpClient();",
    "In the example, DaprClient.CreateInvokeHttpClient returns an HttpClient instance that is used to",
    "In the example, DaprClient.CreateInvokeHttpClient returns an HttpClient instance that is used to",
    "http://127.0.0.1:3500/v1/invoke/orderservice/method/submit",
    "http://127.0.0.1:3500/v1/invoke/orderservice/method/submit",
    "This example uses the default value for the Dapr HTTP endpoint, which is http://127.0.0.1:",
    "This example uses the default value for the Dapr HTTP endpoint, which is http://127.0.0.1:",
    "55",
    "55",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "Alternatively, you can configure a custom endpoint in the call to",
    "Alternatively, you can configure a custom endpoint in the call to",
    "var httpClient = DaprClient.CreateInvokeHttpClient(daprEndpoint: ",
    "var httpClient = DaprClient.CreateInvokeHttpClient(daprEndpoint: ",
    "You can also directly set the base address by specifying the application ID. Doing so enables relative",
    "You can also directly set the base address by specifying the application ID. Doing so enables relative",
    "var httpClient = DaprClient.CreateInvokeHttpClient(",
    "var httpClient = DaprClient.CreateInvokeHttpClient(",
    "The HttpClient object is intended to be long-lived. A single HttpClient instance can be reused for",
    "The HttpClient object is intended to be long-lived. A single HttpClient instance can be reused for",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "In the snippet above, the OrderServiceClient is registered as a singleton with the ASP.NET Core",
    "In the snippet above, the OrderServiceClient is registered as a singleton with the ASP.NET Core",
    "The OrderServiceClient itself has no Dapr-specific code. Even though Dapr service invocation is",
    "The OrderServiceClient itself has no Dapr-specific code. Even though Dapr service invocation is",
    "public class OrderServiceClient : IOrderServiceClient",
    "public class OrderServiceClient : IOrderServiceClient",
    "}",
    "}",
    "Using the HttpClient class with Dapr service invocation has many benefits:",
    "Using the HttpClient class with Dapr service invocation has many benefits:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "56",
    "56",
    "HttpClient is a well-known class that many developers already use in their code. Using HttpClient",
    "HttpClient is a well-known class that many developers already use in their code. Using HttpClient",
    "HttpClient supports advanced scenarios, such as custom headers, and full control over request",
    "HttpClient supports advanced scenarios, such as custom headers, and full control over request",
    "In .NET 5, HttpClient supports automatic serialization and deserialization using System.Text.Json.",
    "In .NET 5, HttpClient supports automatic serialization and deserialization using System.Text.Json.",
    "HttpClient integrates with many existing frameworks and libraries, such as Refit, RestSharp, and",
    "HttpClient integrates with many existing frameworks and libraries, such as Refit, RestSharp, and",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "Invoke HTTP services using DaprClient",
    "Invoke HTTP services using DaprClient",
    "While HttpClient is the preferred way to invoke services using HTTP semantics, you can also use the",
    "While HttpClient is the preferred way to invoke services using HTTP semantics, you can also use the",
    "var daprClient = new DaprClientBuilder().Build();",
    "var daprClient = new DaprClientBuilder().Build();",
    "The third argument, an order object, is serialized internally (with System.Text.JsonSerializer) and",
    "The third argument, an order object, is serialized internally (with System.Text.JsonSerializer) and",
    "The next example demonstrates how you can make an HTTP GET request by specifying the",
    "The next example demonstrates how you can make an HTTP GET request by specifying the",
    "var catalogItems = await",
    "var catalogItems = await",
    "For some scenarios, you may require more control over the request message. For example, when you",
    "For some scenarios, you may require more control over the request message. For example, when you",
    "var request = daprClient.CreateInvokeMethodRequest(",
    "var request = daprClient.CreateInvokeMethodRequest(",
    "The HttpRequestMessage now has the following properties set:",
    "The HttpRequestMessage now has the following properties set:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Url = http://127.0.0.1:3500/v1.0/invoke/orderservice/method/submit",
    "Url = http://127.0.0.1:3500/v1.0/invoke/orderservice/method/submit",
    "HttpMethod = POST",
    "HttpMethod = POST",
    "Content = JsonContent object containing the JSON-serialized order",
    "Content = JsonContent object containing the JSON-serialized order",
    "Headers.Authorization = \u201cbearer ",
    "Headers.Authorization = \u201cbearer ",
    "Once you\u2019ve got the request set up the way you want, use DaprClient.InvokeMethodAsync to send it:",
    "Once you\u2019ve got the request set up the way you want, use DaprClient.InvokeMethodAsync to send it:",
    "var orderConfirmation = await daprClient.InvokeMethodAsync",
    "var orderConfirmation = await daprClient.InvokeMethodAsync",
    "DaprClient.InvokeMethodAsync deserializes the response to an OrderConfirmation object if the",
    "DaprClient.InvokeMethodAsync deserializes the response to an OrderConfirmation object if the",
    "57",
    "57",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "var response = await daprClient.InvokeMethodWithResponseAsync(request);",
    "var response = await daprClient.InvokeMethodWithResponseAsync(request);",
    "var orderConfirmation = response.Content.ReadFromJsonAsync",
    "var orderConfirmation = response.Content.ReadFromJsonAsync",
    "Note",
    "Note",
    "For service invocation calls using HTTP, it\u2019s worth considering using the Dapr HttpClient integration",
    "For service invocation calls using HTTP, it\u2019s worth considering using the Dapr HttpClient integration",
    "Invoke gRPC services using DaprClient",
    "Invoke gRPC services using DaprClient",
    "DaprClient provides a family of InvokeMethodGrpcAsync methods for calling gRPC endpoints. The",
    "DaprClient provides a family of InvokeMethodGrpcAsync methods for calling gRPC endpoints. The",
    "var daprClient = new DaprClientBuilder().Build();",
    "var daprClient = new DaprClientBuilder().Build();",
    "In the example above, DaprClient serializes the given order object using Protobuf and uses the result",
    "In the example above, DaprClient serializes the given order object using Protobuf and uses the result",
    "Name resolution components",
    "Name resolution components",
    "At the time of writing, Dapr provides support for the following name resolution components:",
    "At the time of writing, Dapr provides support for the following name resolution components:",
    "\u2022  mDNS (default when running self-hosted)",
    "\u2022  mDNS (default when running self-hosted)",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Kubernetes Name Resolution (default when running in Kubernetes)",
    "Kubernetes Name Resolution (default when running in Kubernetes)",
    "HashiCorp Consul",
    "HashiCorp Consul",
    "Configuration",
    "Configuration",
    "To use a non-default name resolution component, add a nameResolution spec to the application\u2019s",
    "To use a non-default name resolution component, add a nameResolution spec to the application\u2019s",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "58",
    "58",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "name: dapr-config",
    "name: dapr-config",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "In Dapr Traffic Control sample app, the FineCollection service uses the Dapr service invocation",
    "In Dapr Traffic Control sample app, the FineCollection service uses the Dapr service invocation",
    ":::image type=\u201ccontent\u201d source=\u201c./media/service-invocation/dapr-solution-service-invocation.png\u201d",
    ":::image type=\u201ccontent\u201d source=\u201c./media/service-invocation/dapr-solution-service-invocation.png\u201d",
    "Figure 6-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 6-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Information is retrieved by the ASP.NET CollectionController class in the FineCollection service.",
    "Information is retrieved by the ASP.NET CollectionController class in the FineCollection service.",
    ":::{custom-style=CodeBox} ",
    ":::{custom-style=CodeBox} ",
    "// get owner info (Dapr service invocation)",
    "// get owner info (Dapr service invocation)",
    "// ...",
    "// ...",
    "} ",
    "} ",
    "The code uses a proxy of type VehicleRegistrationService to call the VehicleRegistration service.",
    "The code uses a proxy of type VehicleRegistrationService to call the VehicleRegistration service.",
    ":::{custom-style=CodeBox} csharp  public CollectionController(      ILogger",
    ":::{custom-style=CodeBox} csharp  public CollectionController(      ILogger",
    "The VehicleRegistrationService class contains a single method: GetVehicleInfo. It uses the",
    "The VehicleRegistrationService class contains a single method: GetVehicleInfo. It uses the",
    ":::{custom-style=CodeBox} ",
    ":::{custom-style=CodeBox} ",
    "public async Task",
    "public async Task",
    "59",
    "59",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "$",
    "$",
    "} ",
    "} ",
    "The code doesn\u2019t depend on any Dapr classes directly. It instead leverages the Dapr ASP.NET Core",
    "The code doesn\u2019t depend on any Dapr classes directly. It instead leverages the Dapr ASP.NET Core",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "The DaprClient.CreateInvokeHttpClient creates an HttpClient instance that calls the",
    "The DaprClient.CreateInvokeHttpClient creates an HttpClient instance that calls the",
    "Using Dapr service invocation in the Traffic Control sample application provides several benefits:",
    "Using Dapr service invocation in the Traffic Control sample application provides several benefits:",
    "Decouples the location of the target service.",
    "Decouples the location of the target service.",
    "Adds resiliency with automatic retry features.",
    "Adds resiliency with automatic retry features.",
    "Ability to reuse an existing HttpClient based proxy (offered by the ASP.NET Core integration).",
    "Ability to reuse an existing HttpClient based proxy (offered by the ASP.NET Core integration).",
    "Summary",
    "Summary",
    "In this chapter, you learned about the service invocation building block. You saw how to invoke",
    "In this chapter, you learned about the service invocation building block. You saw how to invoke",
    "The Dapr .NET SDK provides multiple ways to invoke remote methods. HttpClient support is great for",
    "The Dapr .NET SDK provides multiple ways to invoke remote methods. HttpClient support is great for",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr service invocation building block",
    "Dapr service invocation building block",
    "\u2022  Monitoring distributed cloud-native applications",
    "\u2022  Monitoring distributed cloud-native applications",
    "60",
    "60",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER 7 | The Dapr service invocation building block",
    "CHAPTER  8",
    "CHAPTER  8",
    "The Dapr publish ",
    "The Dapr publish ",
    "The Publish-Subscribe pattern (often referred to as \u201cpub/sub\u201d) is a well-known and widely used",
    "The Publish-Subscribe pattern (often referred to as \u201cpub/sub\u201d) is a well-known and widely used",
    "What it solves",
    "What it solves",
    "The primary advantage of the Publish-Subscribe pattern is loose coupling, sometimes referred to as",
    "The primary advantage of the Publish-Subscribe pattern is loose coupling, sometimes referred to as",
    "Figure 7-1 shows the high-level architecture of the pub/sub pattern.",
    "Figure 7-1 shows the high-level architecture of the pub/sub pattern.",
    "Figure 7-1. The pub/sub pattern.",
    "Figure 7-1. The pub/sub pattern.",
    "From the previous figure, note the steps of the pattern:",
    "From the previous figure, note the steps of the pattern:",
    "61",
    "61",
    "Publishers send messages to the message broker.",
    "Publishers send messages to the message broker.",
    "Subscribers bind to a subscription on the message broker.",
    "Subscribers bind to a subscription on the message broker.",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "3.",
    "3.",
    "The message broker forwards a copy of the message to interested subscriptions.",
    "The message broker forwards a copy of the message to interested subscriptions.",
    "Subscribers consume messages from their subscriptions.",
    "Subscribers consume messages from their subscriptions.",
    "Most message brokers encapsulate a queueing mechanism that can persist messages once received.",
    "Most message brokers encapsulate a queueing mechanism that can persist messages once received.",
    "Tip",
    "Tip",
    "If your service can only process a message once, you\u2019ll need to provide an idempotency check to",
    "If your service can only process a message once, you\u2019ll need to provide an idempotency check to",
    "There are several message broker products available - both commercially and open-source. Each has",
    "There are several message broker products available - both commercially and open-source. Each has",
    "The Dapr publish ",
    "The Dapr publish ",
    "How it works",
    "How it works",
    "The Dapr publish ",
    "The Dapr publish ",
    "The service calls the pub/sub API on the Dapr sidecar. The sidecar then makes calls into a pre-defined",
    "The service calls the pub/sub API on the Dapr sidecar. The sidecar then makes calls into a pre-defined",
    "62",
    "62",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "Figure 7-2. The Dapr pub/sub stack.",
    "Figure 7-2. The Dapr pub/sub stack.",
    "The Dapr publish ",
    "The Dapr publish ",
    "At the lowest level, any programming platform can invoke the building block over HTTP or gRPC",
    "At the lowest level, any programming platform can invoke the building block over HTTP or gRPC",
    "http://localhost:",
    "http://localhost:",
    "There are several Dapr specific URL segments in the above call:",
    "There are several Dapr specific URL segments in the above call:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "<dapr-port>",
    "<dapr-port>",
    "<pub-sub-name>",
    "<pub-sub-name>",
    "<topic>",
    "<topic>",
    "Using the curl command-line tool to publish a message, you can try it out:",
    "Using the curl command-line tool to publish a message, you can try it out:",
    "curl -X POST http://localhost:3500/v1.0/publish/pubsub/newOrder ",
    "curl -X POST http://localhost:3500/v1.0/publish/pubsub/newOrder ",
    "You receive messages by subscribing to a topic. At startup, the Dapr runtime will call the application",
    "You receive messages by subscribing to a topic. At startup, the Dapr runtime will call the application",
    "http://localhost:",
    "http://localhost:",
    "63",
    "63",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "\u2022",
    "\u2022",
    "<appPort>",
    "<appPort>",
    "You can implement this endpoint yourself. But Dapr provides more intuitive ways of implementing it.",
    "You can implement this endpoint yourself. But Dapr provides more intuitive ways of implementing it.",
    "The response from the call contains a list of topics to which the applications will subscribe. Each",
    "The response from the call contains a list of topics to which the applications will subscribe. Each",
    "[",
    "[",
    "In the JSON response, you can see the application wants to subscribe to topics newOrder and",
    "In the JSON response, you can see the application wants to subscribe to topics newOrder and",
    "Figure 7-3 presents the flow of the example.",
    "Figure 7-3 presents the flow of the example.",
    "64",
    "64",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "Figure 7-3. Pub/sub flow with Dapr.",
    "Figure 7-3. Pub/sub flow with Dapr.",
    "From the previous figure, note the flow:",
    "From the previous figure, note the flow:",
    "The Dapr sidecar for Service B calls the /dapr/subscribe endpoint from Service B (the",
    "The Dapr sidecar for Service B calls the /dapr/subscribe endpoint from Service B (the",
    "The Dapr sidecar for Service B creates the requested subscriptions on the message broker.",
    "The Dapr sidecar for Service B creates the requested subscriptions on the message broker.",
    "Service A publishes a message at the /v1.0/publish/",
    "Service A publishes a message at the /v1.0/publish/",
    "The Service A sidecar publishes the message to the message broker.",
    "The Service A sidecar publishes the message to the message broker.",
    "The message broker sends a copy of the message to the Service B sidecar.",
    "The message broker sends a copy of the message to the Service B sidecar.",
    "The Service B sidecar calls the endpoint corresponding to the subscription (in this case /orders)",
    "The Service B sidecar calls the endpoint corresponding to the subscription (in this case /orders)",
    "In the example, the message is handled successfully. But if something goes wrong while Service B is",
    "In the example, the message is handled successfully. But if something goes wrong while Service B is",
    "65",
    "65",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "Service B can explicitly specify what needs to happen with the message by including a JSON payload",
    "Service B can explicitly specify what needs to happen with the message by including a JSON payload",
    "{",
    "{",
    "The following table shows the available status values:",
    "The following table shows the available status values:",
    "Status",
    "Status",
    "Action",
    "Action",
    "SUCCESS",
    "SUCCESS",
    "The message is considered as processed successfully and dropped.",
    "The message is considered as processed successfully and dropped.",
    "RETRY",
    "RETRY",
    "DROP",
    "DROP",
    "The message is retried.",
    "The message is retried.",
    "A warning is logged and the message is dropped.",
    "A warning is logged and the message is dropped.",
    "Any other status  The message is retried.",
    "Any other status  The message is retried.",
    "Competing consumers",
    "Competing consumers",
    "When scaling out an application that subscribes to a topic, you have to deal with competing",
    "When scaling out an application that subscribes to a topic, you have to deal with competing",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "For .NET Developers, the Dapr .NET SDK provides a more productive way of working with Dapr. The",
    "For .NET Developers, the Dapr .NET SDK provides a more productive way of working with Dapr. The",
    "To publish a message, the DaprClient exposes a PublishEventAsync method.",
    "To publish a message, the DaprClient exposes a PublishEventAsync method.",
    "var data = new OrderData",
    "var data = new OrderData",
    "var daprClient = new DaprClientBuilder().Build();",
    "var daprClient = new DaprClientBuilder().Build();",
    "await daprClient.PublishEventAsync",
    "await daprClient.PublishEventAsync",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "66",
    "66",
    "The first argument pubsub is the name of the Dapr component that provides the message broker",
    "The first argument pubsub is the name of the Dapr component that provides the message broker",
    "The second argument neworder provides the name of the topic to send the message to.",
    "The second argument neworder provides the name of the topic to send the message to.",
    "The third argument is the payload of the message.",
    "The third argument is the payload of the message.",
    "You can specify the .NET type of the message using the generic type parameter of the method.",
    "You can specify the .NET type of the message using the generic type parameter of the method.",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "To receive messages, you bind an endpoint to a subscription for a registered topic. The AspNetCore",
    "To receive messages, you bind an endpoint to a subscription for a registered topic. The AspNetCore",
    "[",
    "[",
    "Important",
    "Important",
    "You must add a reference to the Dapr.AspNetCore NuGet package in your project to consume the",
    "You must add a reference to the Dapr.AspNetCore NuGet package in your project to consume the",
    "To bind this action method to a topic, you decorate it with the Topic attribute:",
    "To bind this action method to a topic, you decorate it with the Topic attribute:",
    "[",
    "[",
    "You specify two key elements with this attribute:",
    "You specify two key elements with this attribute:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The Dapr pub/sub component to target (in this case pubsub).",
    "The Dapr pub/sub component to target (in this case pubsub).",
    "The topic to subscribe to (in this case newOrder).",
    "The topic to subscribe to (in this case newOrder).",
    "Dapr then invokes that action method as it receives messages for that topic.",
    "Dapr then invokes that action method as it receives messages for that topic.",
    "You\u2019ll also need to enable ASP.NET Core to use Dapr. The Dapr .NET SDK provides several extension",
    "You\u2019ll also need to enable ASP.NET Core to use Dapr. The Dapr .NET SDK provides several extension",
    "In the Program.cs file, you must call the following extension method on the WebApplication builder",
    "In the Program.cs file, you must call the following extension method on the WebApplication builder",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "Appending the AddDapr extension method to the AddControllers extension method registers the",
    "Appending the AddDapr extension method to the AddControllers extension method registers the",
    "After the WebApplication has been created, you must add the following middleware components to",
    "After the WebApplication has been created, you must add the following middleware components to",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "The call to UseCloudEvents adds CloudEvents middleware into to the ASP.NET Core middleware",
    "The call to UseCloudEvents adds CloudEvents middleware into to the ASP.NET Core middleware",
    "67",
    "67",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "Note",
    "Note",
    "CloudEvents is a standardized messaging format, providing a common way to describe event",
    "CloudEvents is a standardized messaging format, providing a common way to describe event",
    "The call to MapSubscribeHandler in the endpoint routing configuration will add a Dapr subscribe",
    "The call to MapSubscribeHandler in the endpoint routing configuration will add a Dapr subscribe",
    "Pub/sub components",
    "Pub/sub components",
    "Dapr pub/sub components handle the actual transport of the messages. Several are available. Each",
    "Dapr pub/sub components handle the actual transport of the messages. Several are available. Each",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Apache Kafka",
    "Apache Kafka",
    "AWS SNS/SQS",
    "AWS SNS/SQS",
    "Azure Event Hubs",
    "Azure Event Hubs",
    "Azure Service Bus",
    "Azure Service Bus",
    "GCP Pub/Sub",
    "GCP Pub/Sub",
    "Hazelcast",
    "Hazelcast",
    "In Memory",
    "In Memory",
    "JetStream",
    "JetStream",
    "\u2022  MQTT",
    "\u2022  MQTT",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "NATS Streaming",
    "NATS Streaming",
    "Pulsar",
    "Pulsar",
    "RabbitMQ",
    "RabbitMQ",
    "Redis Streams",
    "Redis Streams",
    "Note",
    "Note",
    "The Azure cloud stack has both messaging functionality (Azure Service Bus) and event streaming",
    "The Azure cloud stack has both messaging functionality (Azure Service Bus) and event streaming",
    "These components are created by the community in a component-contrib repository on GitHub.",
    "These components are created by the community in a component-contrib repository on GitHub.",
    "Configuration",
    "Configuration",
    "Using a Dapr configuration file, you can specify the pub/sub component(s) to use. This configuration",
    "Using a Dapr configuration file, you can specify the pub/sub component(s) to use. This configuration",
    "68",
    "68",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "Below you see an example of a Dapr configuration file for configuring a RabbitMQ message broker",
    "Below you see an example of a Dapr configuration file for configuring a RabbitMQ message broker",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: host",
    "name: host",
    "name: durable",
    "name: durable",
    "In this example, you can see that you can specify any message broker-specific configuration in the",
    "In this example, you can see that you can specify any message broker-specific configuration in the",
    "Next to the programmatic way of subscribing to a topic from code, Dapr pub/sub also provides a",
    "Next to the programmatic way of subscribing to a topic from code, Dapr pub/sub also provides a",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "ServiceB",
    "ServiceB",
    "ServiceC",
    "ServiceC",
    "You have to specify several elements with every subscription:",
    "You have to specify several elements with every subscription:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The name of the Dapr pub/sub component you want to use (in this case pubsub).",
    "The name of the Dapr pub/sub component you want to use (in this case pubsub).",
    "The name of the topic to subscribe to (in this case newOrder).",
    "The name of the topic to subscribe to (in this case newOrder).",
    "The API operation that needs to be called for this topic (in this case /orders).",
    "The API operation that needs to be called for this topic (in this case /orders).",
    "The scope can specify which services can publish and subscribe to a topic.",
    "The scope can specify which services can publish and subscribe to a topic.",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "In Dapr Traffic Control sample app, the TrafficControl service uses the Dapr pub/sub building block to",
    "In Dapr Traffic Control sample app, the TrafficControl service uses the Dapr pub/sub building block to",
    "69",
    "69",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "of the Dapr Traffic Control sample application. The Dapr pub/sub building block is used in flows",
    "of the Dapr Traffic Control sample application. The Dapr pub/sub building block is used in flows",
    ":::image type=\u201ccontent\u201d source=\u201c./media/publish-subscribe/dapr-solution-pub-sub.png\u201d alt-",
    ":::image type=\u201ccontent\u201d source=\u201c./media/publish-subscribe/dapr-solution-pub-sub.png\u201d alt-",
    "Figure 7-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 7-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Speeding violations are handled by the CollectionController, an ordinary ASP.NET Core Controller.",
    "Speeding violations are handled by the CollectionController, an ordinary ASP.NET Core Controller.",
    "[",
    "[",
    "The method is decorated with the Dapr Topic attribute. It specifies that the pub/sub component",
    "The method is decorated with the Dapr Topic attribute. It specifies that the pub/sub component",
    "The TrafficControl service sends speeding violations. Near the end of the VehicleExit method in the",
    "The TrafficControl service sends speeding violations. Near the end of the VehicleExit method in the",
    "/// ...",
    "/// ...",
    "var speedingViolation = new SpeedingViolation",
    "var speedingViolation = new SpeedingViolation",
    "// publish speedingviolation (Dapr publish / subscribe)",
    "// publish speedingviolation (Dapr publish / subscribe)",
    "/// ...",
    "/// ...",
    "Note how the DaprClient object reduces the call to a single line of code, again, binding to the",
    "Note how the DaprClient object reduces the call to a single line of code, again, binding to the",
    "While the Traffic Control app uses RabbitMQ as the message broker, it never directly references",
    "While the Traffic Control app uses RabbitMQ as the message broker, it never directly references",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "70",
    "70",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "version: v1",
    "version: v1",
    "name: host",
    "name: host",
    "name: durable",
    "name: durable",
    "name: deletedWhenUnused",
    "name: deletedWhenUnused",
    "name: autoAck",
    "name: autoAck",
    "name: reconnectWait",
    "name: reconnectWait",
    "name: concurrency",
    "name: concurrency",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "finecollectionservice",
    "finecollectionservice",
    "The type element in the configuration, pubsub.rabbitmq instructs the building block to use the Dapr",
    "The type element in the configuration, pubsub.rabbitmq instructs the building block to use the Dapr",
    "The scopes element in the configuration constrains application access to the RabbitMQ component.",
    "The scopes element in the configuration constrains application access to the RabbitMQ component.",
    "Using Dapr pub/sub in the Traffic Control sample application offers the following benefits:",
    "Using Dapr pub/sub in the Traffic Control sample application offers the following benefits:",
    "No infrastructural abstraction of a message broker to maintain.",
    "No infrastructural abstraction of a message broker to maintain.",
    "Services are temporally decoupled, which increases robustness.",
    "Services are temporally decoupled, which increases robustness.",
    "Publisher and subscribers are unaware of each other. This means that additional services could",
    "Publisher and subscribers are unaware of each other. This means that additional services could",
    "Summary",
    "Summary",
    "The pub/sub pattern helps you decouple services in a distributed application. The Dapr publish ",
    "The pub/sub pattern helps you decouple services in a distributed application. The Dapr publish ",
    "Through Dapr pub/sub, you can publish messages to a specific topic. As well, the building block will",
    "Through Dapr pub/sub, you can publish messages to a specific topic. As well, the building block will",
    "You can use Dapr pub/sub natively over HTTP or by using one of the language-specific SDKs, such as",
    "You can use Dapr pub/sub natively over HTTP or by using one of the language-specific SDKs, such as",
    "With Dapr, you can plug a supported message broker product into your application. You can then",
    "With Dapr, you can plug a supported message broker product into your application. You can then",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr supported pub/sub brokers",
    "Dapr supported pub/sub brokers",
    "71",
    "71",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER 8 | The Dapr publish ",
    "CHAPTER  9",
    "CHAPTER  9",
    "The Dapr bindings",
    "The Dapr bindings",
    "Cloud-based serverless offerings, such as Azure Functions and AWS Lambda, have gained wide",
    "Cloud-based serverless offerings, such as Azure Functions and AWS Lambda, have gained wide",
    "What it solves",
    "What it solves",
    "Dapr resource bindings enable your services to integrate business operations across external",
    "Dapr resource bindings enable your services to integrate business operations across external",
    "Consider, for example, a Twitter account that triggers an event whenever a user tweets a keyword.",
    "Consider, for example, a Twitter account that triggers an event whenever a user tweets a keyword.",
    "Figure 8-1. Conceptual architecture of a Dapr resource binding.",
    "Figure 8-1. Conceptual architecture of a Dapr resource binding.",
    "At first glance, resource binding behavior may appear similar to the Publish/Subscribe pattern",
    "At first glance, resource binding behavior may appear similar to the Publish/Subscribe pattern",
    "72",
    "72",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "focuses on asynchronous communication between Dapr services. Resource binding has a much wider",
    "focuses on asynchronous communication between Dapr services. Resource binding has a much wider",
    "How it works",
    "How it works",
    "Dapr resource binding starts with a component configuration file. This YAML file describes the type of",
    "Dapr resource binding starts with a component configuration file. This YAML file describes the type of",
    "Note",
    "Note",
    "Binding configurations are presented in detail later in the Components section.",
    "Binding configurations are presented in detail later in the Components section.",
    "Input bindings",
    "Input bindings",
    "Input bindings trigger your code with incoming events from external resources. To receive events and",
    "Input bindings trigger your code with incoming events from external resources. To receive events and",
    "Figure 8-2. Dapr input binding flow.",
    "Figure 8-2. Dapr input binding flow.",
    "Figure 8.2 describes the steps for receiving events from an external Twitter account:",
    "Figure 8.2 describes the steps for receiving events from an external Twitter account:",
    "73",
    "73",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "1.",
    "1.",
    "The Dapr sidecar reads the binding configuration file and subscribes to the event specified for",
    "The Dapr sidecar reads the binding configuration file and subscribes to the event specified for",
    "When a matching Tweet is published on Twitter, the binding component running in the Dapr",
    "When a matching Tweet is published on Twitter, the binding component running in the Dapr",
    "sidecar picks it up and triggers an event.",
    "sidecar picks it up and triggers an event.",
    "The Dapr sidecar invokes the endpoint (that is, event handler) configured for the binding. In the",
    "The Dapr sidecar invokes the endpoint (that is, event handler) configured for the binding. In the",
    "After handling the event, the service returns an HTTP status code 200 OK.",
    "After handling the event, the service returns an HTTP status code 200 OK.",
    "The following ASP.NET Core controller provides an example of handling an event triggered by the",
    "The following ASP.NET Core controller provides an example of handling an event triggered by the",
    "[",
    "[",
    "}",
    "}",
    "If the operation should error, you would return the appropriate 400 or 500 level HTTP status code. For",
    "If the operation should error, you would return the appropriate 400 or 500 level HTTP status code. For",
    "Output bindings",
    "Output bindings",
    "Dapr also includes output binding capabilities. They enable your service to trigger an event that",
    "Dapr also includes output binding capabilities. They enable your service to trigger an event that",
    "74",
    "74",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "Figure 8-3. Dapr output binding flow.",
    "Figure 8-3. Dapr output binding flow.",
    "The Dapr sidecar reads the binding configuration file with the information on how to connect to",
    "The Dapr sidecar reads the binding configuration file with the information on how to connect to",
    "Your application invokes the /v1.0/bindings/sms endpoint on the Dapr sidecar. In this case, it",
    "Your application invokes the /v1.0/bindings/sms endpoint on the Dapr sidecar. In this case, it",
    "The binding component running in the Dapr sidecar calls the external messaging system to send",
    "The binding component running in the Dapr sidecar calls the external messaging system to send",
    "As an example, you can invoke an output binding by invoking the Dapr API using curl:",
    "As an example, you can invoke an output binding by invoking the Dapr API using curl:",
    "curl -X POST http://localhost:3500/v1.0/bindings/sms ",
    "curl -X POST http://localhost:3500/v1.0/bindings/sms ",
    "Note that the HTTP port is the same as used by the Dapr sidecar (in this case, the default Dapr HTTP",
    "Note that the HTTP port is the same as used by the Dapr sidecar (in this case, the default Dapr HTTP",
    "The structure of the payload (that is, message sent) will vary per binding. In the example above, the",
    "The structure of the payload (that is, message sent) will vary per binding. In the example above, the",
    "75",
    "75",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "that defines the operation the binding will execute. The above example specifies a create operation",
    "that defines the operation the binding will execute. The above example specifies a create operation",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "create",
    "create",
    "get",
    "get",
    "delete",
    "delete",
    "list",
    "list",
    "It\u2019s up to the author of the binding which operations the binding supports. The documentation for",
    "It\u2019s up to the author of the binding which operations the binding supports. The documentation for",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "The Dapr .NET SDK provides language-specific support for .NET developers. In the following example,",
    "The Dapr .NET SDK provides language-specific support for .NET developers. In the following example,",
    "private async Task SendSMSAsync(",
    "private async Task SendSMSAsync(",
    "The method expects the metadata and message values.",
    "The method expects the metadata and message values.",
    "When used to invoke a binding, the DaprClient uses gRPC to call the Dapr API on the Dapr sidecar.",
    "When used to invoke a binding, the DaprClient uses gRPC to call the Dapr API on the Dapr sidecar.",
    "Binding components",
    "Binding components",
    "Under the hood, resource bindings are implemented with Dapr binding components. They\u2019re",
    "Under the hood, resource bindings are implemented with Dapr binding components. They\u2019re",
    "Note",
    "Note",
    "Dapr and all of its components are written in the Golang (Go) language. Go is considered a modern,",
    "Dapr and all of its components are written in the Golang (Go) language. Go is considered a modern,",
    "You configure bindings using a YAML configuration file. Here\u2019s an example configuration for the",
    "You configure bindings using a YAML configuration file. Here\u2019s an example configuration for the",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "76",
    "76",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "namespace: default",
    "namespace: default",
    "name: consumerKey",
    "name: consumerKey",
    "name: consumerSecret",
    "name: consumerSecret",
    "name: accessToken",
    "name: accessToken",
    "name: accessSecret",
    "name: accessSecret",
    "name: query",
    "name: query",
    "Each binding configuration contains a general metadata element with a name and namespace field.",
    "Each binding configuration contains a general metadata element with a name and namespace field.",
    "In the spec element, you specify the type of the binding along with binding specific metadata. The",
    "In the spec element, you specify the type of the binding along with binding specific metadata. The",
    "A binding can be configured for input, output, or both. Interestingly, the binding doesn\u2019t explicitly",
    "A binding can be configured for input, output, or both. Interestingly, the binding doesn\u2019t explicitly",
    "The Dapr documentation for resource bindings provides a complete list of the available bindings and",
    "The Dapr documentation for resource bindings provides a complete list of the available bindings and",
    "Cron binding",
    "Cron binding",
    "Pay close attention to Dapr\u2019s Cron binding. It doesn\u2019t subscribe to events from an external system.",
    "Pay close attention to Dapr\u2019s Cron binding. It doesn\u2019t subscribe to events from an external system.",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: schedule",
    "name: schedule",
    "77",
    "77",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "In this example, Dapr triggers a service by invoking the /checkOrderBacklog endpoint every 30",
    "In this example, Dapr triggers a service by invoking the /checkOrderBacklog endpoint every 30",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "In the Dapr Traffic Control sample application, the TrafficControl service uses the MQTT input binding",
    "In the Dapr Traffic Control sample application, the TrafficControl service uses the MQTT input binding",
    "Figure 8-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 8-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "78",
    "78",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "MQTT input binding",
    "MQTT input binding",
    "MQTT is a lightweight pub/sub messaging protocol, often used in IoT scenarios. Producers sent MQTT",
    "MQTT is a lightweight pub/sub messaging protocol, often used in IoT scenarios. Producers sent MQTT",
    "The CameraSimulation doesn\u2019t depend on any Dapr building blocks. It uses the System.Net.Mqtt",
    "The CameraSimulation doesn\u2019t depend on any Dapr building blocks. It uses the System.Net.Mqtt",
    "// ...",
    "// ...",
    "// simulate entry",
    "// simulate entry",
    "// ...",
    "// ...",
    "The code uses a proxy of type ITrafficControlService to call the TrafficControl service. .NET injects",
    "The code uses a proxy of type ITrafficControlService to call the TrafficControl service. .NET injects",
    ":::{custom-style=CodeBox} csharp public CameraSimulation(int camNumber, ITrafficControlService",
    ":::{custom-style=CodeBox} csharp public CameraSimulation(int camNumber, ITrafficControlService",
    "The MqttTrafficControlService class implements the ITrafficControlService interface. It",
    "The MqttTrafficControlService class implements the ITrafficControlService interface. It",
    "public async Task SendVehicleEntryAsync(VehicleRegistered vehicleRegistered)",
    "public async Task SendVehicleEntryAsync(VehicleRegistered vehicleRegistered)",
    "public async Task SendVehicleExitAsync(VehicleRegistered vehicleRegistered)",
    "public async Task SendVehicleExitAsync(VehicleRegistered vehicleRegistered)",
    "The constructor sets up the MQTT client to send messages to the MQTT broker (Mosquitto) running",
    "The constructor sets up the MQTT client to send messages to the MQTT broker (Mosquitto) running",
    "On the other end, the TrafficControl service uses the MQTT input binding to receive",
    "On the other end, the TrafficControl service uses the MQTT input binding to receive",
    "79",
    "79",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "separate component configuration file in the /dapr/components folder. The first one is",
    "separate component configuration file in the /dapr/components folder. The first one is",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: url",
    "name: url",
    "name: topic",
    "name: topic",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "The configuration specifies the binding type: bindings.mqtt. It also specifies that the broker runs on",
    "The configuration specifies the binding type: bindings.mqtt. It also specifies that the broker runs on",
    "When the TrafficControl service starts, the Dapr sidecar automatically subscribes to the",
    "When the TrafficControl service starts, the Dapr sidecar automatically subscribes to the",
    "[",
    "[",
    "The exitcam.yaml component configuration file configures everything for the exitcam endpoint:",
    "The exitcam.yaml component configuration file configures everything for the exitcam endpoint:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: url",
    "name: url",
    "name: topic",
    "name: topic",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "80",
    "80",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "SMTP output binding",
    "SMTP output binding",
    "The FineCollection service uses the Dapr SMTP output binding to send emails. Figure 8-5 shows the",
    "The FineCollection service uses the Dapr SMTP output binding to send emails. Figure 8-5 shows the",
    "Figure 8-5. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 8-5. Conceptual architecture of the Dapr Traffic Control sample application.",
    "The CollectFine method on the CollectionController in the FineCollection service contains code that",
    "The CollectFine method on the CollectionController in the FineCollection service contains code that",
    "// ...",
    "// ...",
    "// send fine by email (Dapr output binding)",
    "// send fine by email (Dapr output binding)",
    "81",
    "81",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "[",
    "[",
    "// ...",
    "// ...",
    "The code uses a simple utility class to create an HTML email body containing the necessary",
    "The code uses a simple utility class to create an HTML email body containing the necessary",
    "The following arguments are required to invoke the binding:",
    "The following arguments are required to invoke the binding:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The name of the binding component. In this case sendmail.",
    "The name of the binding component. In this case sendmail.",
    "The operation the binding needs to perform. In this case create.",
    "The operation the binding needs to perform. In this case create.",
    "The body of the message to send. In this case, the HTML email body.",
    "The body of the message to send. In this case, the HTML email body.",
    "The metadata for sending the email.",
    "The metadata for sending the email.",
    "The Dapr output binding named sendmail is configured in the email.yaml component configuration",
    "The Dapr output binding named sendmail is configured in the email.yaml component configuration",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: host",
    "name: host",
    "name: port",
    "name: port",
    "name: user",
    "name: user",
    "name: password",
    "name: password",
    "name: skipTLSVerify",
    "name: skipTLSVerify",
    "finecollectionservice",
    "finecollectionservice",
    "The configuration specifies the binding type: bindings.smtp.",
    "The configuration specifies the binding type: bindings.smtp.",
    "The metadata section contains the information for connecting to the SMTP server. See the binding\u2019s",
    "The metadata section contains the information for connecting to the SMTP server. See the binding\u2019s",
    "The scopes element specifies that only the service with app-id finecollectonservice can access this",
    "The scopes element specifies that only the service with app-id finecollectonservice can access this",
    "82",
    "82",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "The Traffic Control sample application uses MailDev. MailDev is a development SMTP server that",
    "The Traffic Control sample application uses MailDev. MailDev is a development SMTP server that",
    "Using Dapr bindings in the Traffic Control sample application provides the following benefits:",
    "Using Dapr bindings in the Traffic Control sample application provides the following benefits:",
    "Using MQTT messaging and SMTP without the need to learn this protocol or a specific MQTT",
    "Using MQTT messaging and SMTP without the need to learn this protocol or a specific MQTT",
    "API.",
    "API.",
    "Using SMTP to send an email without the need to learn this protocol or a specific SMTP API.",
    "Using SMTP to send an email without the need to learn this protocol or a specific SMTP API.",
    "Summary",
    "Summary",
    "Dapr resource bindings enable you to integrate with different external resources and systems without",
    "Dapr resource bindings enable you to integrate with different external resources and systems without",
    "Input bindings (or triggers) react to events occurring in an external system. They invoke the public",
    "Input bindings (or triggers) react to events occurring in an external system. They invoke the public",
    "Output bindings will send messages to an external system. You trigger an output binding by doing an",
    "Output bindings will send messages to an external system. You trigger an output binding by doing an",
    "You implement a binding with a Dapr component. These components are contributed by the",
    "You implement a binding with a Dapr component. These components are contributed by the",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr documentation for resource bindings",
    "Dapr documentation for resource bindings",
    "\u2022  Mosquitto MQTT broker",
    "\u2022  Mosquitto MQTT broker",
    "\u2022  MailDev development SMTP server",
    "\u2022  MailDev development SMTP server",
    "83",
    "83",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER 9 | The Dapr bindings building block",
    "CHAPTER  10",
    "CHAPTER  10",
    "The Dapr actors building",
    "The Dapr actors building",
    "The actor model originated in 1973. It was proposed by Carl Hewitt as a conceptual model of",
    "The actor model originated in 1973. It was proposed by Carl Hewitt as a conceptual model of",
    "In the actor model, the actor is an independent unit of compute and state. Actors are completely",
    "In the actor model, the actor is an independent unit of compute and state. Actors are completely",
    "The reason why the actor model makes writing concurrent systems easier is that it provides a turn-",
    "The reason why the actor model makes writing concurrent systems easier is that it provides a turn-",
    "What it solves",
    "What it solves",
    "Actor model implementations are usually tied to a specific language or platform. With the Dapr actors",
    "Actor model implementations are usually tied to a specific language or platform. With the Dapr actors",
    "Dapr\u2019s implementation is based on the virtual actor pattern introduced by Project \u201cOrleans\u201d. With the",
    "Dapr\u2019s implementation is based on the virtual actor pattern introduced by Project \u201cOrleans\u201d. With the",
    "While the actor model can provide great benefits, it\u2019s important to carefully consider the actor design.",
    "While the actor model can provide great benefits, it\u2019s important to carefully consider the actor design.",
    "\u2022",
    "\u2022",
    "Your problem space involves concurrency. Without actors, you\u2019d have to introduce explicit",
    "Your problem space involves concurrency. Without actors, you\u2019d have to introduce explicit",
    "84",
    "84",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Your problem space can be partitioned into small, independent, and isolated units of state and",
    "Your problem space can be partitioned into small, independent, and isolated units of state and",
    "You don\u2019t need low-latency reads of the actor state. Low-latency reads cannot be guaranteed",
    "You don\u2019t need low-latency reads of the actor state. Low-latency reads cannot be guaranteed",
    "You don\u2019t need to query state across a set of actors. Querying across actors is inefficient because",
    "You don\u2019t need to query state across a set of actors. Querying across actors is inefficient because",
    "One design pattern that fits these criteria quite well is the orchestration-based saga or process",
    "One design pattern that fits these criteria quite well is the orchestration-based saga or process",
    "How it works",
    "How it works",
    "The Dapr sidecar provides the HTTP/gRPC API to invoke actors. This is the base URL of the HTTP API:",
    "The Dapr sidecar provides the HTTP/gRPC API to invoke actors. This is the base URL of the HTTP API:",
    "http://localhost:",
    "http://localhost:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "<daprPort>",
    "<daprPort>",
    "<actorType>",
    "<actorType>",
    "<actorId>",
    "<actorId>",
    "The sidecar manages how, when and where each actor runs, and also routes messages between",
    "The sidecar manages how, when and where each actor runs, and also routes messages between",
    "The sidecar API is only one part of the equation. The service itself also needs to implement an API",
    "The sidecar API is only one part of the equation. The service itself also needs to implement an API",
    "85",
    "85",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "Figure 11-1. API calls between actor service and Dapr sidecar.",
    "Figure 11-1. API calls between actor service and Dapr sidecar.",
    "To provide scalability and reliability, actors are partitioned across all the instances of the actor service.",
    "To provide scalability and reliability, actors are partitioned across all the instances of the actor service.",
    ":::image type=\u201ccontent\u201d source=\u201c./media/actors/placement.png\u201d alt-text=\u201cDiagram of the actor",
    ":::image type=\u201ccontent\u201d source=\u201c./media/actors/placement.png\u201d alt-text=\u201cDiagram of the actor",
    "Figure 11-2. Actor placement service.",
    "Figure 11-2. Actor placement service.",
    "On startup, the sidecar makes a call to the actor service to get the registered actor types as well",
    "On startup, the sidecar makes a call to the actor service to get the registered actor types as well",
    "as actor configuration settings.",
    "as actor configuration settings.",
    "The sidecar sends the list of registered actor types to the placement service.",
    "The sidecar sends the list of registered actor types to the placement service.",
    "The placement service broadcasts the updated partitioning information to all actor service",
    "The placement service broadcasts the updated partitioning information to all actor service",
    "Important",
    "Important",
    "Because actors are randomly distributed across service instances, it should be expected that an actor",
    "Because actors are randomly distributed across service instances, it should be expected that an actor",
    "86",
    "86",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "The next figure shows an ordering service instance running in Pod 1 call the ship method of an",
    "The next figure shows an ordering service instance running in Pod 1 call the ship method of an",
    "Figure 11-3. Calling an actor method.",
    "Figure 11-3. Calling an actor method.",
    "The service calls the actor API on the sidecar. The JSON payload in the request body contains the",
    "The service calls the actor API on the sidecar. The JSON payload in the request body contains the",
    "The sidecar uses the locally cached partitioning information from the placement service to",
    "The sidecar uses the locally cached partitioning information from the placement service to",
    "The sidecar instance in pod 2 calls the service instance to invoke the actor. The service instance",
    "The sidecar instance in pod 2 calls the service instance to invoke the actor. The service instance",
    "87",
    "87",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "Turn-based access model",
    "Turn-based access model",
    "The turn-based access model ensures that at any time there\u2019s at most one thread active inside an",
    "The turn-based access model ensures that at any time there\u2019s at most one thread active inside an",
    "public int Increment()",
    "public int Increment()",
    "}",
    "}",
    "Let\u2019s assume that the current value returned by the GetValue method is 1. When two threads call the",
    "Let\u2019s assume that the current value returned by the GetValue method is 1. When two threads call the",
    "In traditional programming models, you can solve this problem by introducing locking mechanisms.",
    "In traditional programming models, you can solve this problem by introducing locking mechanisms.",
    "public int Increment()",
    "public int Increment()",
    "}",
    "}",
    "Unfortunately, using explicit locking mechanisms is error-prone. They can easily lead to deadlocks and",
    "Unfortunately, using explicit locking mechanisms is error-prone. They can easily lead to deadlocks and",
    "Thanks to the turn-based access model, you don\u2019t need to worry about multiple threads with actors,",
    "Thanks to the turn-based access model, you don\u2019t need to worry about multiple threads with actors,",
    "public async Task",
    "public async Task",
    "88",
    "88",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "await StateManager.SetStateAsync(",
    "await StateManager.SetStateAsync(",
    "}",
    "}",
    "Timers and reminders",
    "Timers and reminders",
    "Actors can use timers and reminders to schedule calls to themselves. Both concepts support the",
    "Actors can use timers and reminders to schedule calls to themselves. Both concepts support the",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Timers will only stay active as long as the actor is activated. Timers will not reset the idle-timer,",
    "Timers will only stay active as long as the actor is activated. Timers will not reset the idle-timer,",
    "Reminders outlive actor activations. If an actor is deactivated, a reminder will re-activate the",
    "Reminders outlive actor activations. If an actor is deactivated, a reminder will re-activate the",
    "Timers are registered by making a call to the actor API. In the following example, a timer is registered",
    "Timers are registered by making a call to the actor API. In the following example, a timer is registered",
    "curl -X POST http://localhost:3500/v1.0/actors/",
    "curl -X POST http://localhost:3500/v1.0/actors/",
    "Because the due time is 0, the timer will fire immediately. After a timer callback has finished, the timer",
    "Because the due time is 0, the timer will fire immediately. After a timer callback has finished, the timer",
    "Reminders are registered in a similar way. The following example shows a reminder registration with a",
    "Reminders are registered in a similar way. The following example shows a reminder registration with a",
    "curl -X POST http://localhost:3500/v1.0/actors/",
    "curl -X POST http://localhost:3500/v1.0/actors/",
    "This reminder will fire in 5 minutes. Because the given period is empty, this will be a one-time",
    "This reminder will fire in 5 minutes. Because the given period is empty, this will be a one-time",
    "Note",
    "Note",
    "Timers and reminders both respect the turn-based access model. When a timer or reminder fires, the",
    "Timers and reminders both respect the turn-based access model. When a timer or reminder fires, the",
    "State persistence",
    "State persistence",
    "Actor state is persisted using the Dapr state management building block. Because actors can execute",
    "Actor state is persisted using the Dapr state management building block. Because actors can execute",
    "89",
    "89",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "\u2022",
    "\u2022",
    "Azure Cosmos DB",
    "Azure Cosmos DB",
    "\u2022  MongoDB",
    "\u2022  MongoDB",
    "\u2022  MySQL",
    "\u2022  MySQL",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "SQL Server",
    "SQL Server",
    "To configure a state store component for use with actors, you need to append the following metadata",
    "To configure a state store component for use with actors, you need to append the following metadata",
    "name: actorStateStore",
    "name: actorStateStore",
    "Here\u2019s a complete example for a Redis state store:",
    "Here\u2019s a complete example for a Redis state store:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "You can create an actor model implementation using only HTTP/gRPC calls. However, it\u2019s much more",
    "You can create an actor model implementation using only HTTP/gRPC calls. However, it\u2019s much more",
    "To get started with the .NET Dapr actors SDK, you add a package reference to Dapr.Actors to your",
    "To get started with the .NET Dapr actors SDK, you add a package reference to Dapr.Actors to your",
    "public interface IScoreActor : IActor",
    "public interface IScoreActor : IActor",
    "}",
    "}",
    "90",
    "90",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "Important",
    "Important",
    "The return type of an actor method must be Task or Task",
    "The return type of an actor method must be Task or Task",
    "Next, implement the actor by deriving a ScoreActor class from Actor. The ScoreActor class must also",
    "Next, implement the actor by deriving a ScoreActor class from Actor. The ScoreActor class must also",
    "public class ScoreActor : Actor, IScoreActor",
    "public class ScoreActor : Actor, IScoreActor",
    "}",
    "}",
    "The constructor in the snippet above takes a host argument of type ActorHost. The ActorHost class",
    "The constructor in the snippet above takes a host argument of type ActorHost. The ActorHost class",
    "Let\u2019s now implement the IncrementScoreAsync method of the interface:",
    "Let\u2019s now implement the IncrementScoreAsync method of the interface:",
    "public Task",
    "public Task",
    "In the snippet above, a single call to StateManager.AddOrUpdateStateAsync provides the full",
    "In the snippet above, a single call to StateManager.AddOrUpdateStateAsync provides the full",
    "The key of the state to update.",
    "The key of the state to update.",
    "The value to write if no score is stored in the state store yet.",
    "The value to write if no score is stored in the state store yet.",
    "A Func to call if there already is a score stored in the state store. It takes the state key and",
    "A Func to call if there already is a score stored in the state store. It takes the state key and",
    "The GetScoreAsync implementation reads the current score from the state store and returns it to the",
    "The GetScoreAsync implementation reads the current score from the state store and returns it to the",
    "public async Task",
    "public async Task",
    "91",
    "91",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "return 0;",
    "return 0;",
    "To host actors in an ASP.NET Core service, you must add a reference to the Dapr.Actors.AspNetCore",
    "To host actors in an ASP.NET Core service, you must add a reference to the Dapr.Actors.AspNetCore",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "The actors endpoints are necessary because the Dapr sidecar calls the application to host and interact",
    "The actors endpoints are necessary because the Dapr sidecar calls the application to host and interact",
    "Important",
    "Important",
    "Make sure your Program (or Startup) class does not contain an app.UseHttpsRedirection call to",
    "Make sure your Program (or Startup) class does not contain an app.UseHttpsRedirection call to",
    "The Program file is also the place to register the specific actor types. The following example registers",
    "The Program file is also the place to register the specific actor types. The following example registers",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "At this point, the ASP.NET Core service is ready to host the ScoreActor and accept incoming requests.",
    "At this point, the ASP.NET Core service is ready to host the ScoreActor and accept incoming requests.",
    "var actorId = new ActorId(",
    "var actorId = new ActorId(",
    "var proxy = ActorProxy.Create",
    "var proxy = ActorProxy.Create",
    "var score = await proxy.IncrementScoreAsync();",
    "var score = await proxy.IncrementScoreAsync();",
    "Console.WriteLine($",
    "Console.WriteLine($",
    "The above example uses the Dapr.Actors package to call the actor service. To invoke an operation on",
    "The above example uses the Dapr.Actors package to call the actor service. To invoke an operation on",
    "92",
    "92",
    "The actor type uniquely identifies the actor implementation across the whole application. By",
    "The actor type uniquely identifies the actor implementation across the whole application. By",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "2.",
    "2.",
    "The ActorId uniquely identifies an instance of an actor type. You can also use this class to",
    "The ActorId uniquely identifies an instance of an actor type. You can also use this class to",
    "The example uses ActorProxy.Create to create a proxy instance for the ScoreActor. The Create",
    "The example uses ActorProxy.Create to create a proxy instance for the ScoreActor. The Create",
    "The final step in the example calls the IncrementScoreAsync method on the actor and outputs the",
    "The final step in the example calls the IncrementScoreAsync method on the actor and outputs the",
    "Call actors from ASP.NET Core clients",
    "Call actors from ASP.NET Core clients",
    "The console client example in the previous section uses the static ActorProxy.Create method directly",
    "The console client example in the previous section uses the static ActorProxy.Create method directly",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "});",
    "});",
    "The call to AddActors registers the IActorProxyFactory for .NET dependency injection. This allows",
    "The call to AddActors registers the IActorProxyFactory for .NET dependency injection. This allows",
    "[",
    "[",
    "93",
    "93",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "var scoreActor = ",
    "var scoreActor = ",
    "}",
    "}",
    "Actors can also call other actors directly. The Actor base class exposes an IActorProxyFactory class",
    "Actors can also call other actors directly. The Actor base class exposes an IActorProxyFactory class",
    "public class OrderActor : Actor, IOrderActor",
    "public class OrderActor : Actor, IOrderActor",
    "}",
    "}",
    "Note",
    "Note",
    "By default, Dapr actors aren\u2019t reentrant. This means that a Dapr actor cannot be called more than once",
    "By default, Dapr actors aren\u2019t reentrant. This means that a Dapr actor cannot be called more than once",
    "Call non-.NET actors",
    "Call non-.NET actors",
    "So far, the examples used strongly-typed actor proxies based on .NET interfaces to illustrate actor",
    "So far, the examples used strongly-typed actor proxies based on .NET interfaces to illustrate actor",
    "You create weakly-typed proxies in a similar way to strongly-typed proxies. Instead of relying on a",
    "You create weakly-typed proxies in a similar way to strongly-typed proxies. Instead of relying on a",
    "[",
    "[",
    "94",
    "94",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "{",
    "{",
    "}",
    "}",
    "Timers and reminders",
    "Timers and reminders",
    "Use the RegisterTimerAsync method of the Actor base class to schedule actor timers. In the",
    "Use the RegisterTimerAsync method of the Actor base class to schedule actor timers. In the",
    "public class TimerActor : Actor, ITimerActor",
    "public class TimerActor : Actor, ITimerActor",
    "}",
    "}",
    "The StartTimerAsync method calls RegisterTimerAsync to schedule the timer. RegisterTimerAsync",
    "The StartTimerAsync method calls RegisterTimerAsync to schedule the timer. RegisterTimerAsync",
    "The name of the timer.",
    "The name of the timer.",
    "The name of the method to call when the timer fires.",
    "The name of the method to call when the timer fires.",
    "The state to pass to the callback method.",
    "The state to pass to the callback method.",
    "The amount of time to wait before the callback method is first invoked.",
    "The amount of time to wait before the callback method is first invoked.",
    "The time interval between callback method invocations. You can specify",
    "The time interval between callback method invocations. You can specify",
    "The TimerCallbackAsync method receives the user state in binary form. In the example, the callback",
    "The TimerCallbackAsync method receives the user state in binary form. In the example, the callback",
    "Timers can be stopped by calling UnregisterTimerAsync:",
    "Timers can be stopped by calling UnregisterTimerAsync:",
    "95",
    "95",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "public class TimerActor : Actor, ITimerActor",
    "public class TimerActor : Actor, ITimerActor",
    "}",
    "}",
    "Remember that timers do not reset the actor idle timer. When no other calls are made on the actor, it",
    "Remember that timers do not reset the actor idle timer. When no other calls are made on the actor, it",
    "To use reminders in an actor, your actor class must implement the IRemindable interface:",
    "To use reminders in an actor, your actor class must implement the IRemindable interface:",
    "public interface IRemindable",
    "public interface IRemindable",
    "The ReceiveReminderAsync method is called when a reminder is fired. It takes 4 arguments:",
    "The ReceiveReminderAsync method is called when a reminder is fired. It takes 4 arguments:",
    "The name of the reminder.",
    "The name of the reminder.",
    "The user state provided during registration.",
    "The user state provided during registration.",
    "The invocation due time provided during registration.",
    "The invocation due time provided during registration.",
    "The invocation period provided during registration.",
    "The invocation period provided during registration.",
    "To register a reminder, use the RegisterReminderAsync method of the actor base class. The following",
    "To register a reminder, use the RegisterReminderAsync method of the actor base class. The following",
    "public class ReminderActor : Actor, IReminderActor, IRemindable",
    "public class ReminderActor : Actor, IReminderActor, IRemindable",
    "96",
    "96",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "}",
    "}",
    "}",
    "}",
    "The RegisterReminderAsync method is similar to RegisterTimerAsync but you don\u2019t have to specify",
    "The RegisterReminderAsync method is similar to RegisterTimerAsync but you don\u2019t have to specify",
    "Reminders both reset the idle timer and are persistent. Even if your actor is deactivated, it will be",
    "Reminders both reset the idle timer and are persistent. Even if your actor is deactivated, it will be",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "The default version of Dapr Traffic Control does not use the actor model. However, it does contain an",
    "The default version of Dapr Traffic Control does not use the actor model. However, it does contain an",
    "#define USE",
    "#define USE",
    "When the actor model is enabled, the application uses actors to represent vehicles. The operations",
    "When the actor model is enabled, the application uses actors to represent vehicles. The operations",
    "public interface IVehicleActor : IActor",
    "public interface IVehicleActor : IActor",
    "The (simulated) entry cameras call the RegisterEntryAsync method when a new vehicle is first",
    "The (simulated) entry cameras call the RegisterEntryAsync method when a new vehicle is first",
    "var vehicleState = new VehicleState",
    "var vehicleState = new VehicleState",
    "When the vehicle reaches the end of the speed camera zone, the exit camera calls the",
    "When the vehicle reaches the end of the speed camera zone, the exit camera calls the",
    "var vehicleState = await StateManager.GetStateAsync",
    "var vehicleState = await StateManager.GetStateAsync",
    "97",
    "97",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "Note",
    "Note",
    "The code above currently assumes that a VehicleState instance has already been saved by the",
    "The code above currently assumes that a VehicleState instance has already been saved by the",
    "After the state is updated, the RegisterExitAsync method checks if the vehicle was driving too fast. If",
    "After the state is updated, the RegisterExitAsync method checks if the vehicle was driving too fast. If",
    "int violation = ",
    "int violation = ",
    "if (violation > 0)",
    "if (violation > 0)",
    "}",
    "}",
    "The code above uses two external dependencies. The ",
    "The code above uses two external dependencies. The ",
    "Both dependencies are registered in the Program.cs class and injected into the actor using constructor",
    "Both dependencies are registered in the Program.cs class and injected into the actor using constructor",
    "private readonly DaprClient ",
    "private readonly DaprClient ",
    "public VehicleActor(",
    "public VehicleActor(",
    "The actor based implementation no longer uses the Dapr state management building block directly.",
    "The actor based implementation no longer uses the Dapr state management building block directly.",
    "Summary",
    "Summary",
    "The Dapr actors building block makes it easier to write correct concurrent systems. Actors are small",
    "The Dapr actors building block makes it easier to write correct concurrent systems. Actors are small",
    "98",
    "98",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "from memory when no operations are performed. Any state stored in the actor is automatically",
    "from memory when no operations are performed. Any state stored in the actor is automatically",
    "Actors support timers and reminders to schedule future work. Timers do not reset the idle timer and",
    "Actors support timers and reminders to schedule future work. Timers do not reset the idle timer and",
    "Actor state is persisted using the Dapr state management building block. Any state store that",
    "Actor state is persisted using the Dapr state management building block. Any state store that",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Dapr supported state stores",
    "Dapr supported state stores",
    "99",
    "99",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER 10 | The Dapr actors building block",
    "CHAPTER  11",
    "CHAPTER  11",
    "The Dapr observability",
    "The Dapr observability",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently",
    "With so many separate, moving parts, how do you make sense of what is going on? Unfortunately,",
    "With so many separate, moving parts, how do you make sense of what is going on? Unfortunately,",
    "The system information used to gain observability is referred to as telemetry. It can be divided into",
    "The system information used to gain observability is referred to as telemetry. It can be divided into",
    "Distributed tracing provides insights into the traffic between services involved in distributed",
    "Distributed tracing provides insights into the traffic between services involved in distributed",
    "business transactions.",
    "business transactions.",
    "Metrics provides insights into the performance of a service and its resource consumption.",
    "Metrics provides insights into the performance of a service and its resource consumption.",
    "Logging provides insights into how code is executing and if errors have occurred.",
    "Logging provides insights into how code is executing and if errors have occurred.",
    "Health endpoints provide insight into the availability of a service.",
    "Health endpoints provide insight into the availability of a service.",
    "The depth of telemetry is determined by the observability features of an application platform.",
    "The depth of telemetry is determined by the observability features of an application platform.",
    "However, what if an application can\u2019t use Azure PaaS and IaaS resources? Is it still possible to take",
    "However, what if an application can\u2019t use Azure PaaS and IaaS resources? Is it still possible to take",
    "With Dapr, you can. Let\u2019s look at how Dapr can add observability to our distributed applications.",
    "With Dapr, you can. Let\u2019s look at how Dapr can add observability to our distributed applications.",
    "100",
    "100",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "What it solves",
    "What it solves",
    "The Dapr observability building block decouples observability from the application. It automatically",
    "The Dapr observability building block decouples observability from the application. It automatically",
    "As Dapr abstracts away the plumbing, the application is unaware of how observability is implemented.",
    "As Dapr abstracts away the plumbing, the application is unaware of how observability is implemented.",
    "How it works",
    "How it works",
    "Dapr\u2019s sidecar architecture enables built-in observability features. As services communicate, Dapr",
    "Dapr\u2019s sidecar architecture enables built-in observability features. As services communicate, Dapr",
    "Dapr provides collectors that can publish telemetry to different back-end monitoring tools. These",
    "Dapr provides collectors that can publish telemetry to different back-end monitoring tools. These",
    "Figure 10-1. Dapr observability architecture.",
    "Figure 10-1. Dapr observability architecture.",
    "Service A calls an operation on Service B. The call is routed from a Dapr sidecar for Service A to a",
    "Service A calls an operation on Service B. The call is routed from a Dapr sidecar for Service A to a",
    "When Service B completes the operation, a response is sent back to Service A through the Dapr",
    "When Service B completes the operation, a response is sent back to Service A through the Dapr",
    "The configured collector ingests the telemetry and sends it to the monitoring back end.",
    "The configured collector ingests the telemetry and sends it to the monitoring back end.",
    "101",
    "101",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "As a developer, keep in mind that adding observability is different from configuring other Dapr",
    "As a developer, keep in mind that adding observability is different from configuring other Dapr",
    "At the beginning of this chapter, four categories of telemetry were identified. The following sections",
    "At the beginning of this chapter, four categories of telemetry were identified. The following sections",
    "Distributed tracing",
    "Distributed tracing",
    "Distributed tracing provides insight into traffic that flows across services in a distributed application.",
    "Distributed tracing provides insight into traffic that flows across services in a distributed application.",
    "Dapr uses the W3C Trace Context to correlate related messages. It injects the same context",
    "Dapr uses the W3C Trace Context to correlate related messages. It injects the same context",
    "Note",
    "Note",
    "The trace context is often referred to as a correlation token in microservice terminology.",
    "The trace context is often referred to as a correlation token in microservice terminology.",
    "Figure 10-2. W3C Trace Context example.",
    "Figure 10-2. W3C Trace Context example.",
    "Service A invokes an operation on Service B. As Service A starts the call, Dapr creates a unique",
    "Service A invokes an operation on Service B. As Service A starts the call, Dapr creates a unique",
    "Service B receives the request and invokes an operation on Service C. Dapr detects that the",
    "Service B receives the request and invokes an operation on Service C. Dapr detects that the",
    "Service C receives the request and handles it. Dapr detects that the incoming request contains a",
    "Service C receives the request and handles it. Dapr detects that the incoming request contains a",
    "Service B receives the response and handles it. It then creates a new response and propagates",
    "Service B receives the response and handles it. It then creates a new response and propagates",
    "A set of requests and responses that belong together is called a trace. Figure 10-3 shows a trace:",
    "A set of requests and responses that belong together is called a trace. Figure 10-3 shows a trace:",
    "102",
    "102",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-3. Traces and spans.",
    "Figure 10-3. Traces and spans.",
    "In the figure, note how the trace represents a unique application transaction that takes place across",
    "In the figure, note how the trace represents a unique application transaction that takes place across",
    "The next sections discuss how to inspect tracing telemetry by publishing it to a monitoring back end.",
    "The next sections discuss how to inspect tracing telemetry by publishing it to a monitoring back end.",
    "Use a Zipkin monitoring back end",
    "Use a Zipkin monitoring back end",
    "Zipkin is an open-source distributed tracing system. It can ingest and visualize telemetry data. Dapr",
    "Zipkin is an open-source distributed tracing system. It can ingest and visualize telemetry data. Dapr",
    "Enable and configure tracing",
    "Enable and configure tracing",
    "To start, tracing must be enabled for the Dapr runtime using a Dapr configuration file. Here\u2019s an",
    "To start, tracing must be enabled for the Dapr runtime using a Dapr configuration file. Here\u2019s an",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "The samplingRate attribute specifies the interval used for publishing traces. The value must be",
    "The samplingRate attribute specifies the interval used for publishing traces. The value must be",
    "kubectl apply -f dapr-config.yaml",
    "kubectl apply -f dapr-config.yaml",
    "103",
    "103",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Install the Zipkin server",
    "Install the Zipkin server",
    "When installing Dapr in self-hosted mode, a Zipkin server is automatically installed and tracing is",
    "When installing Dapr in self-hosted mode, a Zipkin server is automatically installed and tracing is",
    "When installing Dapr on a Kubernetes cluster, Zipkin must be deployed manually. Use the following",
    "When installing Dapr on a Kubernetes cluster, Zipkin must be deployed manually. Use the following",
    "kind: Deployment",
    "kind: Deployment",
    "kind: Service",
    "kind: Service",
    "The deployment uses the standard openzipkin/zipkin-slim container image. The Zipkin service",
    "The deployment uses the standard openzipkin/zipkin-slim container image. The Zipkin service",
    "104",
    "104",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Kubernetes CLI to apply the Zipkin manifest file to the Kubernetes cluster and deploy the Zipkin",
    "Kubernetes CLI to apply the Zipkin manifest file to the Kubernetes cluster and deploy the Zipkin",
    "kubectl apply -f zipkin.yaml",
    "kubectl apply -f zipkin.yaml",
    "Configure the services to use the tracing configuration",
    "Configure the services to use the tracing configuration",
    "Now everything is set up correctly to start publishing telemetry. Every Dapr sidecar that is deployed as",
    "Now everything is set up correctly to start publishing telemetry. Every Dapr sidecar that is deployed as",
    "apiVersion: apps/v1",
    "apiVersion: apps/v1",
    "Inspect the telemetry in Zipkin",
    "Inspect the telemetry in Zipkin",
    "Once the application is started, the Dapr sidecars will emit telemetry to the Zipkin server. To inspect",
    "Once the application is started, the Dapr sidecars will emit telemetry to the Zipkin server. To inspect",
    "105",
    "105",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-4. Zipkin front end.",
    "Figure 10-4. Zipkin front end.",
    "On the Find a trace tab, you can query traces. Pressing the RUN QUERY button without specifying any",
    "On the Find a trace tab, you can query traces. Pressing the RUN QUERY button without specifying any",
    "Figure 10-5. Zipkin traces overview.",
    "Figure 10-5. Zipkin traces overview.",
    "Clicking the SHOW button next to a specific trace, will show the details of that trace:",
    "Clicking the SHOW button next to a specific trace, will show the details of that trace:",
    "106",
    "106",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-6. Zipkin trace details.",
    "Figure 10-6. Zipkin trace details.",
    "Each item on the details page, is a span that represents a request that is part of the selected trace.",
    "Each item on the details page, is a span that represents a request that is part of the selected trace.",
    "Inspect the dependencies between services",
    "Inspect the dependencies between services",
    "Because Dapr sidecars handle traffic between services, Zipkin can use the trace information to",
    "Because Dapr sidecars handle traffic between services, Zipkin can use the trace information to",
    "107",
    "107",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-7. Zipkin dependencies.",
    "Figure 10-7. Zipkin dependencies.",
    "The animated dots on the lines between the services represent requests and move from source to",
    "The animated dots on the lines between the services represent requests and move from source to",
    "Use a Jaeger or New Relic monitoring back end",
    "Use a Jaeger or New Relic monitoring back end",
    "Beyond Zipkin, other monitoring back-end software can also ingest telemetry with the Zipkin format.",
    "Beyond Zipkin, other monitoring back-end software can also ingest telemetry with the Zipkin format.",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name:",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name:",
    "To try out New Relic, specify the endpoint of the New Relic API. Here\u2019s an example of a configuration",
    "To try out New Relic, specify the endpoint of the New Relic API. Here\u2019s an example of a configuration",
    ":::{custom-style=CodeBox} yaml apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name:",
    ":::{custom-style=CodeBox} yaml apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name:",
    "108",
    "108",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Check out the Jaeger and New Relic websites for more information on how to use them.",
    "Check out the Jaeger and New Relic websites for more information on how to use them.",
    "Metrics",
    "Metrics",
    "Metrics provide insight into performance and resource consumption. Under the hood, Dapr emits a",
    "Metrics provide insight into performance and resource consumption. Under the hood, Dapr emits a",
    "Figure 10-8. Scraping Prometheus metrics.",
    "Figure 10-8. Scraping Prometheus metrics.",
    "Each sidecar and system service exposes a metric endpoint that listens on port 9090. The Prometheus",
    "Each sidecar and system service exposes a metric endpoint that listens on port 9090. The Prometheus",
    "Service discovery",
    "Service discovery",
    "You might wonder how the metrics scraper knows where to collect metrics. Prometheus can integrate",
    "You might wonder how the metrics scraper knows where to collect metrics. Prometheus can integrate",
    "Metrics list",
    "Metrics list",
    "Dapr generates a large set of metrics for Dapr system services and its runtime. Some examples",
    "Dapr generates a large set of metrics for Dapr system services and its runtime. Some examples",
    "109",
    "109",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Metric",
    "Metric",
    "dapr",
    "dapr",
    "Source",
    "Source",
    "System",
    "System",
    "dapr",
    "dapr",
    "System",
    "System",
    "Description",
    "Description",
    "The total number of Dapr services created",
    "The total number of Dapr services created",
    "The total number of sidecar injection",
    "The total number of sidecar injection",
    "dapr",
    "dapr",
    "System",
    "System",
    "The total number of hosts reported to the",
    "The total number of hosts reported to the",
    "dapr",
    "dapr",
    "System",
    "System",
    "The number of certificate signing requests",
    "The number of certificate signing requests",
    "dapr",
    "dapr",
    "Runtime  The number of successfully loaded Dapr",
    "Runtime  The number of successfully loaded Dapr",
    "components.",
    "components.",
    "dapr",
    "dapr",
    "Runtime  Count of gRPC calls by method and status.",
    "Runtime  Count of gRPC calls by method and status.",
    "dapr",
    "dapr",
    "Runtime  Number of HTTP requests started in an",
    "Runtime  Number of HTTP requests started in an",
    "dapr",
    "dapr",
    "HTTP server.",
    "HTTP server.",
    "Runtime  Total bytes sent in request body (not",
    "Runtime  Total bytes sent in request body (not",
    "For more information on available metrics, see the Dapr metrics documentation.",
    "For more information on available metrics, see the Dapr metrics documentation.",
    "Configure Dapr metrics",
    "Configure Dapr metrics",
    "At run time, you can disable the metrics collection endpoint by including the --enable-",
    "At run time, you can disable the metrics collection endpoint by including the --enable-",
    "You can also use a Dapr configuration file to statically enable or disable runtime metrics collection:",
    "You can also use a Dapr configuration file to statically enable or disable runtime metrics collection:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "Visualize Dapr metrics",
    "Visualize Dapr metrics",
    "With the Prometheus scraper collecting and publishing metrics into the monitoring back end, how do",
    "With the Prometheus scraper collecting and publishing metrics into the monitoring back end, how do",
    "110",
    "110",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-9. Grafana dashboard.",
    "Figure 10-9. Grafana dashboard.",
    "The Dapr documentation includes a tutorial for installing Prometheus and Grafana.",
    "The Dapr documentation includes a tutorial for installing Prometheus and Grafana.",
    "Logging",
    "Logging",
    "Logging provides insight into what is happening with a service at run time. When running an",
    "Logging provides insight into what is happening with a service at run time. When running an",
    "Log entry structure",
    "Log entry structure",
    "Dapr emits structured logging. Each log entry has the following format:",
    "Dapr emits structured logging. Each log entry has the following format:",
    "Field",
    "Field",
    "Description",
    "Description",
    "Example",
    "Example",
    "time",
    "time",
    "level",
    "level",
    "type",
    "type",
    "msg",
    "msg",
    "ISO8601 formatted timestamp",
    "ISO8601 formatted timestamp",
    "2021-01-10T14:19:31.000Z",
    "2021-01-10T14:19:31.000Z",
    "Level of the entry (debug, info, warn, or error)  info",
    "Level of the entry (debug, info, warn, or error)  info",
    "Log Type",
    "Log Type",
    "Log Message",
    "Log Message",
    "log",
    "log",
    "metrics server started on :62408/",
    "metrics server started on :62408/",
    "scope",
    "scope",
    "Logging Scope",
    "Logging Scope",
    "instance  Hostname where Dapr runs",
    "instance  Hostname where Dapr runs",
    "dapr.runtime",
    "dapr.runtime",
    "TSTSRV01",
    "TSTSRV01",
    "111",
    "111",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Field",
    "Field",
    "Description",
    "Description",
    "Example",
    "Example",
    "app",
    "app",
    "Dapr App ID",
    "Dapr App ID",
    "ver",
    "ver",
    "Dapr Runtime Version",
    "Dapr Runtime Version",
    "finecollectionservice",
    "finecollectionservice",
    "1.0",
    "1.0",
    "When searching through logging entries in a troubleshooting scenario, the time and level fields are",
    "When searching through logging entries in a troubleshooting scenario, the time and level fields are",
    "Plain text versus JSON format",
    "Plain text versus JSON format",
    "By default, Dapr emits structured logging in plain-text format. Every log entry is formatted as a string",
    "By default, Dapr emits structured logging in plain-text format. Every log entry is formatted as a string",
    "== DAPR == time=",
    "== DAPR == time=",
    "version 1.0 -- commit 196483d",
    "version 1.0 -- commit 196483d",
    "While simple, this format is difficult to parse. If viewing log entries with a monitoring tool, you\u2019ll want",
    "While simple, this format is difficult to parse. If viewing log entries with a monitoring tool, you\u2019ll want",
    "{",
    "{",
    "To enable JSON formatting, you need to configure each Dapr sidecar. In self-hosted mode, you can",
    "To enable JSON formatting, you need to configure each Dapr sidecar. In self-hosted mode, you can",
    "dapr run --app-id finecollectionservice --log-level info --log-as-json dotnet run",
    "dapr run --app-id finecollectionservice --log-level info --log-as-json dotnet run",
    "In Kubernetes, you can add a dapr.io/log-as-json annotation to each deployment for the",
    "In Kubernetes, you can add a dapr.io/log-as-json annotation to each deployment for the",
    "annotations:",
    "annotations:",
    "When you install Dapr in a Kubernetes cluster using Helm, you can enable JSON formatted logging for",
    "When you install Dapr in a Kubernetes cluster using Helm, you can enable JSON formatted logging for",
    "112",
    "112",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "helm repo add dapr https://dapr.github.io/helm-charts/",
    "helm repo add dapr https://dapr.github.io/helm-charts/",
    "Collect logs",
    "Collect logs",
    "The logs emitted by Dapr can be fed into a monitoring back end for analysis. A log collector is a",
    "The logs emitted by Dapr can be fed into a monitoring back end for analysis. A log collector is a",
    "Health status",
    "Health status",
    "The health status of a service provides insight into its availability. Each Dapr sidecar exposes a health",
    "The health status of a service provides insight into its availability. Each Dapr sidecar exposes a health",
    "GET http://localhost:3500/v1.0/healthz",
    "GET http://localhost:3500/v1.0/healthz",
    "The operation returns two HTTP status codes:",
    "The operation returns two HTTP status codes:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "204: When the sidecar is healthy",
    "204: When the sidecar is healthy",
    "500: when the sidecar isn\u2019t healthy",
    "500: when the sidecar isn\u2019t healthy",
    "When running in self-hosted mode, the health API isn\u2019t automatically invoked. You can invoke the API",
    "When running in self-hosted mode, the health API isn\u2019t automatically invoked. You can invoke the API",
    "When running in Kubernetes, the Dapr sidecar-injector automatically configures Kubernetes to use the",
    "When running in Kubernetes, the Dapr sidecar-injector automatically configures Kubernetes to use the",
    "Kubernetes uses liveness probes to determine whether a container is up and running. If a liveness",
    "Kubernetes uses liveness probes to determine whether a container is up and running. If a liveness",
    "Kubernetes uses readiness probes to determine whether a container is ready to start accepting traffic.",
    "Kubernetes uses readiness probes to determine whether a container is ready to start accepting traffic.",
    "Liveness and readiness probes have several configurable parameters. Both are configured in the",
    "Liveness and readiness probes have several configurable parameters. Both are configured in the",
    "livenessProbe:",
    "livenessProbe:",
    "113",
    "113",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "readinessProbe:",
    "readinessProbe:",
    "The following parameters are available for the probes:",
    "The following parameters are available for the probes:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The path specifies the Dapr health API endpoint.",
    "The path specifies the Dapr health API endpoint.",
    "The port specifies the Dapr health API port.",
    "The port specifies the Dapr health API port.",
    "The initialDelaySecondsspecifies the number of seconds Kubernetes will wait before it starts",
    "The initialDelaySecondsspecifies the number of seconds Kubernetes will wait before it starts",
    "The periodSeconds specifies the number of seconds Kubernetes will wait between each probe.",
    "The periodSeconds specifies the number of seconds Kubernetes will wait between each probe.",
    "The timeoutSeconds specifies the number of seconds Kubernetes will wait on a response from",
    "The timeoutSeconds specifies the number of seconds Kubernetes will wait on a response from",
    "The failureThresholdspecifies the number of failed status code Kubernetes will accept before",
    "The failureThresholdspecifies the number of failed status code Kubernetes will accept before",
    "Dapr dashboard",
    "Dapr dashboard",
    "Dapr offers a dashboard that presents status information on Dapr applications, components, and",
    "Dapr offers a dashboard that presents status information on Dapr applications, components, and",
    "dapr dashboard",
    "dapr dashboard",
    "For Dapr application running in Kubernetes, use the following command:",
    "For Dapr application running in Kubernetes, use the following command:",
    "dapr dashboard -k",
    "dapr dashboard -k",
    "The dashboard opens with an overview of all services in your application that have a Dapr sidecar. The",
    "The dashboard opens with an overview of all services in your application that have a Dapr sidecar. The",
    ":::image type=\u201ccontent\u201d source=\u201c./media/observability/dapr-dashboard-overview.png\u201d alt-text=\u201cDapr",
    ":::image type=\u201ccontent\u201d source=\u201c./media/observability/dapr-dashboard-overview.png\u201d alt-text=\u201cDapr",
    "Figure 10-10. Dapr dashboard overview.",
    "Figure 10-10. Dapr dashboard overview.",
    "The Dapr dashboard is invaluable when troubleshooting a Dapr application. It provides information",
    "The Dapr dashboard is invaluable when troubleshooting a Dapr application. It provides information",
    "The dashboard also shows the configured components (and their configuration) for an application:",
    "The dashboard also shows the configured components (and their configuration) for an application:",
    ":::image type=\u201ccontent\u201d source=\u201c./media/observability/dapr-dashboard-components.png\u201d alt-",
    ":::image type=\u201ccontent\u201d source=\u201c./media/observability/dapr-dashboard-components.png\u201d alt-",
    "Figure 10-11. Dapr dashboard components.",
    "Figure 10-11. Dapr dashboard components.",
    "114",
    "114",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "There\u2019s a large amount of information available through the dashboard. You can discover it by",
    "There\u2019s a large amount of information available through the dashboard. You can discover it by",
    "Check out the Dapr dashboard CLI command reference in the Dapr docs for more information on the",
    "Check out the Dapr dashboard CLI command reference in the Dapr docs for more information on the",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "The Dapr .NET SDK doesn\u2019t contain any specific observability features. All observability features are",
    "The Dapr .NET SDK doesn\u2019t contain any specific observability features. All observability features are",
    "If you want to emit telemetry from your .NET application code, you should consider the",
    "If you want to emit telemetry from your .NET application code, you should consider the",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "Because the Traffic Control sample application runs with Dapr, all the telemetry described in this",
    "Because the Traffic Control sample application runs with Dapr, all the telemetry described in this",
    "Figure 10-12. Zipkin end-to-end tracing example.",
    "Figure 10-12. Zipkin end-to-end tracing example.",
    "This trace shows the communication that occurs when a speeding violation has been detected:",
    "This trace shows the communication that occurs when a speeding violation has been detected:",
    "115",
    "115",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "1.",
    "1.",
    "An exiting vehicle triggers the MQTT input binding that sends a message containing the vehicle",
    "An exiting vehicle triggers the MQTT input binding that sends a message containing the vehicle",
    "The MQTT input binding invokes the TrafficControl service with the message.",
    "The MQTT input binding invokes the TrafficControl service with the message.",
    "The TrafficControl service retrieves the state for the vehicle, appends the entry, and saves the",
    "The TrafficControl service retrieves the state for the vehicle, appends the entry, and saves the",
    "The TrafficControl service publishes the speeding violation using pub/sub to the",
    "The TrafficControl service publishes the speeding violation using pub/sub to the",
    "The FineCollection service receives the speeding violation using a pub/sub subscription on the",
    "The FineCollection service receives the speeding violation using a pub/sub subscription on the",
    "The FineCollection service invokes the vehicleinfo endpoint of the VehicleRegistration service",
    "The FineCollection service invokes the vehicleinfo endpoint of the VehicleRegistration service",
    "The FineCollection service invokes an output binding for sending the email.",
    "The FineCollection service invokes an output binding for sending the email.",
    "Click any trace line (span) to see more details. If you click on the last line, you\u2019ll see the sendmail",
    "Click any trace line (span) to see more details. If you click on the last line, you\u2019ll see the sendmail",
    "116",
    "116",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Figure 10-13. Output binding trace details.",
    "Figure 10-13. Output binding trace details.",
    "Summary",
    "Summary",
    "Detailed observability is critical to running a distributed system in production.",
    "Detailed observability is critical to running a distributed system in production.",
    "Dapr provides different types of telemetry, including distributed tracing, logging, metrics, and health",
    "Dapr provides different types of telemetry, including distributed tracing, logging, metrics, and health",
    "Dapr only produces telemetry for the Dapr system services and sidecars. Telemetry from your",
    "Dapr only produces telemetry for the Dapr system services and sidecars. Telemetry from your",
    "117",
    "117",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "Dapr telemetry is produced in an open-standards based format so that it can be ingested by a large",
    "Dapr telemetry is produced in an open-standards based format so that it can be ingested by a large",
    "You\u2019ll need a telemetry scraper that ingests telemetry and publishes it to the monitoring back end.",
    "You\u2019ll need a telemetry scraper that ingests telemetry and publishes it to the monitoring back end.",
    "Dapr can be configured to emit structured logging. Structured logging is favored as it can be indexed",
    "Dapr can be configured to emit structured logging. Structured logging is favored as it can be indexed",
    "Dapr offers a dashboard that presents information about the Dapr services and configuration.",
    "Dapr offers a dashboard that presents information about the Dapr services and configuration.",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Azure Application Insights",
    "Azure Application Insights",
    "Open Telemetry",
    "Open Telemetry",
    "Zipkin",
    "Zipkin",
    "\u2022  W3C Trace Context",
    "\u2022  W3C Trace Context",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Jaeger",
    "Jaeger",
    "New Relic",
    "New Relic",
    "Prometheus",
    "Prometheus",
    "Grafana",
    "Grafana",
    "Open Telemetry SDK for .NET",
    "Open Telemetry SDK for .NET",
    "Fluentd",
    "Fluentd",
    "ELK stack",
    "ELK stack",
    "Seq",
    "Seq",
    "Serilog",
    "Serilog",
    "118",
    "118",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER 11 | The Dapr observability building block",
    "CHAPTER  12",
    "CHAPTER  12",
    "The Dapr secrets",
    "The Dapr secrets",
    "Enterprise applications require secrets. Common examples include:",
    "Enterprise applications require secrets. Common examples include:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "A database connection string that contains a username and password.",
    "A database connection string that contains a username and password.",
    "An API key for calling an external web API.",
    "An API key for calling an external web API.",
    "A client certificate for authenticating to an external system.",
    "A client certificate for authenticating to an external system.",
    "Secrets must be carefully managed so that they\u2019re never disclosed outside of the application.",
    "Secrets must be carefully managed so that they\u2019re never disclosed outside of the application.",
    "Not long ago, it was popular to store application secrets in a configuration file inside the application",
    "Not long ago, it was popular to store application secrets in a configuration file inside the application",
    "A widely accepted methodology for constructing modern distributed applications is The Twelve-",
    "A widely accepted methodology for constructing modern distributed applications is The Twelve-",
    "To address this concern, the .NET platform includes a Secret Manager feature that stores sensitive",
    "To address this concern, the .NET platform includes a Secret Manager feature that stores sensitive",
    "A more modern and secure practice is to isolate secrets in a secrets management tool like Hashicorp",
    "A more modern and secure practice is to isolate secrets in a secrets management tool like Hashicorp",
    "Dapr offers a building block that simplifies managing secrets.",
    "Dapr offers a building block that simplifies managing secrets.",
    "What it solves",
    "What it solves",
    "The Dapr secrets management building block abstracts away the complexity of working with secrets",
    "The Dapr secrets management building block abstracts away the complexity of working with secrets",
    "119",
    "119",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "It hides the underlying plumbing through a unified interface.",
    "It hides the underlying plumbing through a unified interface.",
    "It supports various pluggable secret store components, which can vary between development",
    "It supports various pluggable secret store components, which can vary between development",
    "Applications don\u2019t require direct dependencies on secret store libraries.",
    "Applications don\u2019t require direct dependencies on secret store libraries.",
    "Developers don\u2019t require detailed knowledge of each secret store.",
    "Developers don\u2019t require detailed knowledge of each secret store.",
    "Dapr handles all of the above concerns.",
    "Dapr handles all of the above concerns.",
    "Access to the secrets is secured through authentication and authorization. Only an application with",
    "Access to the secrets is secured through authentication and authorization. Only an application with",
    "How it works",
    "How it works",
    "Applications use the secrets management building block in two ways:",
    "Applications use the secrets management building block in two ways:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Retrieve a secret directly from the building block.",
    "Retrieve a secret directly from the building block.",
    "Reference a secret indirectly from a Dapr component configuration.",
    "Reference a secret indirectly from a Dapr component configuration.",
    "Retrieving secrets directly is covered first. Referencing a secret from a Dapr component configuration",
    "Retrieving secrets directly is covered first. Referencing a secret from a Dapr component configuration",
    "The application interacts with a Dapr sidecar when using the secrets management building block. The",
    "The application interacts with a Dapr sidecar when using the secrets management building block. The",
    "http://localhost:",
    "http://localhost:",
    "The URL contains the following segments:",
    "The URL contains the following segments:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "<dapr-port>",
    "<dapr-port>",
    "<store-name>",
    "<store-name>",
    "<name>",
    "<name>",
    "<metadata>",
    "<metadata>",
    "[",
    "[",
    "The JSON response contains the key and value of the secret.",
    "The JSON response contains the key and value of the secret.",
    "Figure 11-1 shows how Dapr handles a request for the secrets API:",
    "Figure 11-1 shows how Dapr handles a request for the secrets API:",
    "120",
    "120",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Figure 11-1. Retrieving a secret with the Dapr secrets API.",
    "Figure 11-1. Retrieving a secret with the Dapr secrets API.",
    "The service calls the Dapr secrets API, along with the name of the secret store, and secret to",
    "The service calls the Dapr secrets API, along with the name of the secret store, and secret to",
    "The Dapr sidecar retrieves the specified secret from the secret store.",
    "The Dapr sidecar retrieves the specified secret from the secret store.",
    "The Dapr sidecar returns the secret information back to the service.",
    "The Dapr sidecar returns the secret information back to the service.",
    "Some secret stores support storing multiple key/value pairs in a single secret. For those scenarios, the",
    "Some secret stores support storing multiple key/value pairs in a single secret. For those scenarios, the",
    "GET http://localhost:3500/v1.0/secrets/secret-store/interestRates?metadata.version",
    "GET http://localhost:3500/v1.0/secrets/secret-store/interestRates?metadata.version",
    "{",
    "{",
    "The Dapr secrets API also offers an operation to retrieve all the secrets the application has access to:",
    "The Dapr secrets API also offers an operation to retrieve all the secrets the application has access to:",
    "http://localhost:",
    "http://localhost:",
    "Use the Dapr .NET SDK",
    "Use the Dapr .NET SDK",
    "For .NET developers, the Dapr .NET SDK streamlines Dapr secret management. Consider the",
    "For .NET developers, the Dapr .NET SDK streamlines Dapr secret management. Consider the",
    "121",
    "121",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "var metadata = new Dictionary",
    "var metadata = new Dictionary",
    "Arguments for the GetSecretAsync method include:",
    "Arguments for the GetSecretAsync method include:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The name of the Dapr secret store component (\u2018secret-store\u2019)",
    "The name of the Dapr secret store component (\u2018secret-store\u2019)",
    "The secret to retrieve (\u2018eshopsecrets\u2019)",
    "The secret to retrieve (\u2018eshopsecrets\u2019)",
    "Optional metadata key/value pairs (\u2018version",
    "Optional metadata key/value pairs (\u2018version",
    "The method responds with a dictionary object as a secret can contain multiple key/value pairs. In the",
    "The method responds with a dictionary object as a secret can contain multiple key/value pairs. In the",
    "The Dapr .NET SDK also features a .NET configuration provider. It loads specified secrets into the",
    "The Dapr .NET SDK also features a .NET configuration provider. It loads specified secrets into the",
    "The secrets configuration provider is available from the Dapr.Extensions.Configuration NuGet",
    "The secrets configuration provider is available from the Dapr.Extensions.Configuration NuGet",
    "var builder = WebApplication.CreateBuilder(args);",
    "var builder = WebApplication.CreateBuilder(args);",
    "The above example loads the eshopsecrets secrets collection into the .NET configuration system at",
    "The above example loads the eshopsecrets secrets collection into the .NET configuration system at",
    "Once loaded, you can retrieve secrets directly from application code:",
    "Once loaded, you can retrieve secrets directly from application code:",
    "public void GetCustomer(IConfiguration config)",
    "public void GetCustomer(IConfiguration config)",
    "Secret store components",
    "Secret store components",
    "The secrets management building block supports several secret store components. At the time of",
    "The secrets management building block supports several secret store components. At the time of",
    "AlibabaCloud OOS Parameter Store",
    "AlibabaCloud OOS Parameter Store",
    "AWS Secrets Manager",
    "AWS Secrets Manager",
    "AWS SSM Parameter Store",
    "AWS SSM Parameter Store",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "122",
    "122",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Azure Key Vault",
    "Azure Key Vault",
    "GCP Secret Manager",
    "GCP Secret Manager",
    "HashiCorp Vault",
    "HashiCorp Vault",
    "Kubernetes secrets",
    "Kubernetes secrets",
    "Local environment variables",
    "Local environment variables",
    "Local file",
    "Local file",
    "Important",
    "Important",
    "The local environment variables and file components are designed for development workloads only.",
    "The local environment variables and file components are designed for development workloads only.",
    "The following sections show how to configure a secret store.",
    "The following sections show how to configure a secret store.",
    "Configuration",
    "Configuration",
    "You configure a secret store using a Dapr component configuration file. The typical structure of the",
    "You configure a secret store using a Dapr component configuration file. The typical structure of the",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: ",
    "name: ",
    "All Dapr component configuration files require a name along with an optional namespace value.",
    "All Dapr component configuration files require a name along with an optional namespace value.",
    "Indirectly consume Dapr secrets",
    "Indirectly consume Dapr secrets",
    "As mentioned earlier in this chapter, applications can also consume secrets by referencing them in",
    "As mentioned earlier in this chapter, applications can also consume secrets by referencing them in",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "123",
    "123",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "The above configuration file contains a clear-text password for connecting to the Redis server.",
    "The above configuration file contains a clear-text password for connecting to the Redis server.",
    "The following examples demonstrate this using several different secret stores.",
    "The following examples demonstrate this using several different secret stores.",
    "Local file",
    "Local file",
    "The local file component is designed for development scenarios. It stores secrets on the local",
    "The local file component is designed for development scenarios. It stores secrets on the local",
    "{",
    "{",
    "You place this file in a components folder that you specify when running the Dapr application.",
    "You place this file in a components folder that you specify when running the Dapr application.",
    "The following secret store configuration file consumes the JSON file as a secret store. It\u2019s also placed",
    "The following secret store configuration file consumes the JSON file as a secret store. It\u2019s also placed",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: secretsFile",
    "name: secretsFile",
    "name: nestedSeparator",
    "name: nestedSeparator",
    "The component type is secretstore.local.file. The secretsFile metadata element specifies the",
    "The component type is secretstore.local.file. The secretsFile metadata element specifies the",
    "Important",
    "Important",
    "The path to a secrets file can be a absolute or relative path. The relative path is based on the folder in",
    "The path to a secrets file can be a absolute or relative path. The relative path is based on the folder in",
    "From the application folder, start the Dapr application specifying the components path as a command-",
    "From the application folder, start the Dapr application specifying the components path as a command-",
    "dapr run --app-id basket-api --components-path ./components dotnet run",
    "dapr run --app-id basket-api --components-path ./components dotnet run",
    "124",
    "124",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Note",
    "Note",
    "This above example applies to running Dapr in self-hosted mode. For Kubernetes hosting, consider",
    "This above example applies to running Dapr in self-hosted mode. For Kubernetes hosting, consider",
    "The nestedSeparator in a Dapr configuration file specifies a character to flatten a JSON hierarchy.",
    "The nestedSeparator in a Dapr configuration file specifies a character to flatten a JSON hierarchy.",
    "{",
    "{",
    "Using a colon as a separator, you can retrieve the customerdb connection-string using the key",
    "Using a colon as a separator, you can retrieve the customerdb connection-string using the key",
    "Note",
    "Note",
    "The colon : is the default separator value.",
    "The colon : is the default separator value.",
    "In the next example, a state management configuration file references the local secret store",
    "In the next example, a state management configuration file references the local secret store",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "The secretKeyRef element references the secret containing the password. It replaces the earlier clear-",
    "The secretKeyRef element references the secret containing the password. It replaces the earlier clear-",
    "You might wonder why eShopRedisPassword is identical for both the name and key in the secret",
    "You might wonder why eShopRedisPassword is identical for both the name and key in the secret",
    "125",
    "125",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Kubernetes secret",
    "Kubernetes secret",
    "This second example focuses on a Dapr application running in Kubernetes. It uses the standard secrets",
    "This second example focuses on a Dapr application running in Kubernetes. It uses the standard secrets",
    "kubectl create secret generic eshopsecrets --from-literal=redisPassword=e$h0p0nD@pr -n",
    "kubectl create secret generic eshopsecrets --from-literal=redisPassword=e$h0p0nD@pr -n",
    "Once created, you can reference the secret in the component configuration file for state management:",
    "Once created, you can reference the secret in the component configuration file for state management:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "The secretKeyRef element specifies the name of the Kubernetes secret and the secret\u2019s key,",
    "The secretKeyRef element specifies the name of the Kubernetes secret and the secret\u2019s key,",
    "Note",
    "Note",
    "Auth is the default value when using Kubernetes secrets and can be omitted.",
    "Auth is the default value when using Kubernetes secrets and can be omitted.",
    "In a production setting, secrets are typically created as part of an automated CI/CD pipeline. Doing so",
    "In a production setting, secrets are typically created as part of an automated CI/CD pipeline. Doing so",
    "Azure Key Vault",
    "Azure Key Vault",
    "The next example is geared toward a real-world production scenario. It uses Azure Key Vault as the",
    "The next example is geared toward a real-world production scenario. It uses Azure Key Vault as the",
    "For this example to work, the following prerequisites must be satisfied:",
    "For this example to work, the following prerequisites must be satisfied:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "126",
    "126",
    "You\u2019ve secured administrative access to an Azure subscription.",
    "You\u2019ve secured administrative access to an Azure subscription.",
    "You\u2019ve provisioned an Azure Key Vault named eshopkv that holds a secret named",
    "You\u2019ve provisioned an Azure Key Vault named eshopkv that holds a secret named",
    "You\u2019ve created service principal in Azure Active Directory.",
    "You\u2019ve created service principal in Azure Active Directory.",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "\u2022",
    "\u2022",
    "You\u2019ve installed an X509 certificate for this service principal (containing both the public and",
    "You\u2019ve installed an X509 certificate for this service principal (containing both the public and",
    "Note",
    "Note",
    "A service principal is an identity that can be used by an application to authenticate an Azure service.",
    "A service principal is an identity that can be used by an application to authenticate an Azure service.",
    "The Dapr Azure Key Vault secret store documentation provides step-by-step instructions to create",
    "The Dapr Azure Key Vault secret store documentation provides step-by-step instructions to create",
    "Use Key Vault when running in self-hosted mode",
    "Use Key Vault when running in self-hosted mode",
    "Using Azure Key Vault in Dapr self-hosted mode requires the following component configuration file:",
    "Using Azure Key Vault in Dapr self-hosted mode requires the following component configuration file:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: vaultName",
    "name: vaultName",
    "name: spnTenantId",
    "name: spnTenantId",
    "name: spnClientId",
    "name: spnClientId",
    "name: spnCertificateFile",
    "name: spnCertificateFile",
    "The secret store type is secretstores.azure.keyvault. The metadata element provides access to the",
    "The secret store type is secretstores.azure.keyvault. The metadata element provides access to the",
    "The vaultName contains the name of the Azure Key Vault.",
    "The vaultName contains the name of the Azure Key Vault.",
    "The spnTenantId contains the tenant ID of the service principal used to authenticate against the",
    "The spnTenantId contains the tenant ID of the service principal used to authenticate against the",
    "The spnClientId contains the app ID of the service principal used to authenticate against the",
    "The spnClientId contains the app ID of the service principal used to authenticate against the",
    "The spnCertificateFile contains the path to the certificate file for the service principal to",
    "The spnCertificateFile contains the path to the certificate file for the service principal to",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Tip",
    "Tip",
    "You can copy the service principal information from the Azure portal or Azure CLI .",
    "You can copy the service principal information from the Azure portal or Azure CLI .",
    "Now the application can retrieve the Redis password from the Azure Key Vault.",
    "Now the application can retrieve the Redis password from the Azure Key Vault.",
    "127",
    "127",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Use Key Vault when running on Kubernetes",
    "Use Key Vault when running on Kubernetes",
    "Consuming Azure Key Vault with Dapr and Kubernetes also requires a service principal to authenticate",
    "Consuming Azure Key Vault with Dapr and Kubernetes also requires a service principal to authenticate",
    "First, create a Kubernetes secret that contains a certificate file using the kubectl CLI tool:",
    "First, create a Kubernetes secret that contains a certificate file using the kubectl CLI tool:",
    "kubectl create secret generic ",
    "kubectl create secret generic ",
    "The command requires two command-line arguments:",
    "The command requires two command-line arguments:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "[",
    "[",
    "[",
    "[",
    "Once created, you can reference the Kubernetes secret in the secret store component configuration",
    "Once created, you can reference the Kubernetes secret in the secret store component configuration",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: vaultName",
    "name: vaultName",
    "name: spnTenantId",
    "name: spnTenantId",
    "name: spnClientId",
    "name: spnClientId",
    "name: spnCertificate",
    "name: spnCertificate",
    "At this point, an application running in Kubernetes can retrieve the Redis password from the Azure",
    "At this point, an application running in Kubernetes can retrieve the Redis password from the Azure",
    "Important",
    "Important",
    "It\u2019s critical to keep the X509 certificate file for the service principal in a safe place. It\u2019s best to place it in",
    "It\u2019s critical to keep the X509 certificate file for the service principal in a safe place. It\u2019s best to place it in",
    "128",
    "128",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "When running in Azure Kubernetes Service (AKS), it\u2019s preferable to use an Azure Managed Identity for",
    "When running in Azure Kubernetes Service (AKS), it\u2019s preferable to use an Azure Managed Identity for",
    "Scope secrets",
    "Scope secrets",
    "Secret scopes allow you to control which secrets your application can access. You configure scopes in",
    "Secret scopes allow you to control which secrets your application can access. You configure scopes in",
    "Here\u2019s an example of a Dapr sidecar configuration file that contains secret scopes:",
    "Here\u2019s an example of a Dapr sidecar configuration file that contains secret scopes:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "You specify scopes per secret store. In the above example, the secret store is named eshop-azurekv-",
    "You specify scopes per secret store. In the above example, the secret store is named eshop-azurekv-",
    "Property",
    "Property",
    "Value",
    "Value",
    "Description",
    "Description",
    "defaultAccess",
    "defaultAccess",
    "allow or",
    "allow or",
    "Allows or denies access to all secrets in the specified secret store.",
    "Allows or denies access to all secrets in the specified secret store.",
    "allowedSecrets  List of",
    "allowedSecrets  List of",
    "secret keys",
    "secret keys",
    "Secrets specified in the array will be accessible. This property is",
    "Secrets specified in the array will be accessible. This property is",
    "deniedSecrets",
    "deniedSecrets",
    "List of",
    "List of",
    "Secrets specified in the array will NOT be accessible. This property is",
    "Secrets specified in the array will NOT be accessible. This property is",
    "The allowedSecrets and deniedSecrets properties take precedence over the defaultAccess",
    "The allowedSecrets and deniedSecrets properties take precedence over the defaultAccess",
    "Sample application: Dapr Traffic Control",
    "Sample application: Dapr Traffic Control",
    "In Dapr Traffic Control sample app, the secrets management building block is used in several places.",
    "In Dapr Traffic Control sample app, the secrets management building block is used in several places.",
    "129",
    "129",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Figure 10-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 10-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "The FineCollection service uses an SMTP output binding for sending emails (see the Bindings chapter).",
    "The FineCollection service uses an SMTP output binding for sending emails (see the Bindings chapter).",
    "The TrafficControl service stores vehicle information in a Redis state store (see the State management",
    "The TrafficControl service stores vehicle information in a Redis state store (see the State management",
    "Because the Traffic Control sample application can run in self-hosted mode or in Kubernetes, there are",
    "Because the Traffic Control sample application can run in self-hosted mode or in Kubernetes, there are",
    "A local JSON file",
    "A local JSON file",
    "A Kubernetes secret",
    "A Kubernetes secret",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "130",
    "130",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "Secrets",
    "Secrets",
    "Examine the secrets-file.yaml component configuration file in the dapr/components folder:",
    "Examine the secrets-file.yaml component configuration file in the dapr/components folder:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: secretsFile",
    "name: secretsFile",
    "name: nestedSeparator",
    "name: nestedSeparator",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "finecollectionservice",
    "finecollectionservice",
    "The file describes a secrets management component entitled trafficcontrol-secrets. The type",
    "The file describes a secrets management component entitled trafficcontrol-secrets. The type",
    "{",
    "{",
    "In the sample application the Redis server is used without a password. To connect to the SMTP server,",
    "In the sample application the Redis server is used without a password. To connect to the SMTP server,",
    "While secrets are stored at nested levels, the secrets management building block flattens this",
    "While secrets are stored at nested levels, the secrets management building block flattens this",
    "When running in Kubernetes, the secrets are specified using the built-in Kubernetes secrets store.",
    "When running in Kubernetes, the secrets are specified using the built-in Kubernetes secrets store.",
    "apiVersion: v1",
    "apiVersion: v1",
    "131",
    "131",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "type: Opaque",
    "type: Opaque",
    "The component is also named trafficcontrol-secrets. Secrets are stored as Base64 encoded",
    "The component is also named trafficcontrol-secrets. Secrets are stored as Base64 encoded",
    "Important",
    "Important",
    "Base64 representations encode, but do not encrypt data. Base64 isn\u2019t secure for production scenarios.",
    "Base64 representations encode, but do not encrypt data. Base64 isn\u2019t secure for production scenarios.",
    "The following paragraphs describe how secrets are used in the Traffic Control sample application.",
    "The following paragraphs describe how secrets are used in the Traffic Control sample application.",
    "SMTP server credentials",
    "SMTP server credentials",
    "Examine the email.yaml component configuration file located in the dapr/components folder:",
    "Examine the email.yaml component configuration file located in the dapr/components folder:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: host",
    "name: host",
    "name: port",
    "name: port",
    "name: user",
    "name: user",
    "name: password",
    "name: password",
    "name: skipTLSVerify",
    "name: skipTLSVerify",
    "finecollectionservice",
    "finecollectionservice",
    "The auth section references the secrets management component named trafficcontrol-secrets.",
    "The auth section references the secrets management component named trafficcontrol-secrets.",
    "When running in Kubernetes, the built-in Kubernetes secrets store is used. The email.yaml manifest",
    "When running in Kubernetes, the built-in Kubernetes secrets store is used. The email.yaml manifest",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "132",
    "132",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "metadata:",
    "metadata:",
    "name: host",
    "name: host",
    "name: port",
    "name: port",
    "name: user",
    "name: user",
    "name: password",
    "name: password",
    "name: skipTLSVerify",
    "name: skipTLSVerify",
    "finecollectionservice",
    "finecollectionservice",
    "Unlike the local secrets store, the Kubernetes store doesn\u2019t explicitly specify a secrets management",
    "Unlike the local secrets store, the Kubernetes store doesn\u2019t explicitly specify a secrets management",
    "Redis server credentials",
    "Redis server credentials",
    "Next, examine the statestore.yaml component configuration file in the dapr/components folder:",
    "Next, examine the statestore.yaml component configuration file in the dapr/components folder:",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "trafficcontrolservice",
    "trafficcontrolservice",
    "Once again, the auth section references the secrets management component named",
    "Once again, the auth section references the secrets management component named",
    "133",
    "133",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "FineCalculator component license key",
    "FineCalculator component license key",
    "The FineCollection service uses a component that calculates the fine based on the information of a",
    "The FineCollection service uses a component that calculates the fine based on the information of a",
    "public interface IFineCalculator",
    "public interface IFineCalculator",
    "The CalculateFine method expects a string containing a licenseKey as its first argument. This key",
    "The CalculateFine method expects a string containing a licenseKey as its first argument. This key",
    "The implementation simulates a check on the licenseKey that is passed in. The",
    "The implementation simulates a check on the licenseKey that is passed in. The",
    "134",
    "134",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "// set finecalculator component license-key",
    "// set finecalculator component license-key",
    "The code determines whether the service is running in Kubernetes or self-hosted mode. This check is",
    "The code determines whether the service is running in Kubernetes or self-hosted mode. This check is",
    "Using Dapr secrets management offers several benefits:",
    "Using Dapr secrets management offers several benefits:",
    "No sensitive information is stored in code or application configuration files.",
    "No sensitive information is stored in code or application configuration files.",
    "No need to learn any new API for interacting with a secrets store.",
    "No need to learn any new API for interacting with a secrets store.",
    "Summary",
    "Summary",
    "The Dapr secrets management building block provides capabilities for storing and retrieving sensitive",
    "The Dapr secrets management building block provides capabilities for storing and retrieving sensitive",
    "The building block supports several different secret stores and hides their complexity with the Dapr",
    "The building block supports several different secret stores and hides their complexity with the Dapr",
    "The Dapr .NET SDK provides a DaprClient object to retrieve secrets. It also includes a .NET",
    "The Dapr .NET SDK provides a DaprClient object to retrieve secrets. It also includes a .NET",
    "You can use secret scopes to control access to specific secrets.",
    "You can use secret scopes to control access to specific secrets.",
    "References",
    "References",
    "\u2022",
    "\u2022",
    "Beyond the Twelve-Factor Application",
    "Beyond the Twelve-Factor Application",
    "135",
    "135",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "\u2022",
    "\u2022",
    "Dapr supported secret stores",
    "Dapr supported secret stores",
    "136",
    "136",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER 12 | The Dapr secrets management building block",
    "CHAPTER  13",
    "CHAPTER  13",
    "Dapr reference application",
    "Dapr reference application",
    "Over the course of this book, you\u2019ve learned about the foundational benefits of Dapr. You saw how",
    "Over the course of this book, you\u2019ve learned about the foundational benefits of Dapr. You saw how",
    "But, first a little history.",
    "But, first a little history.",
    "eShopOnContainers",
    "eShopOnContainers",
    "Several years ago, Microsoft, in partnership with leading community experts, released a popular",
    "Several years ago, Microsoft, in partnership with leading community experts, released a popular",
    "Figure 12-1. .NET Microservices: Architecture for Containerized .NET Applications.",
    "Figure 12-1. .NET Microservices: Architecture for Containerized .NET Applications.",
    "The book dove deep into the principles, patterns, and best practices for building distributed",
    "The book dove deep into the principles, patterns, and best practices for building distributed",
    "137",
    "137",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Figure 12-2. Original ShopOnContainers reference application.",
    "Figure 12-2. Original ShopOnContainers reference application.",
    "As you can see, eShopOnContainers includes many moving parts:",
    "As you can see, eShopOnContainers includes many moving parts:",
    "Three different frontend clients.",
    "Three different frontend clients.",
    "An application gateway to abstract backend services from the frontend.",
    "An application gateway to abstract backend services from the frontend.",
    "Several backend core microservices.",
    "Several backend core microservices.",
    "An event bus component that enables asynchronous pub/sub messaging.",
    "An event bus component that enables asynchronous pub/sub messaging.",
    "The eShopOnContainers reference application has been widely accepted across the .NET community",
    "The eShopOnContainers reference application has been widely accepted across the .NET community",
    "eShopOnDapr",
    "eShopOnDapr",
    "An updated version of eShop accompanies this book. It\u2019s called eShopOnDapr. The update evolves",
    "An updated version of eShop accompanies this book. It\u2019s called eShopOnDapr. The update evolves",
    "[",
    "[",
    "Figure 12-3. eShopOnDapr reference application architecture.",
    "Figure 12-3. eShopOnDapr reference application architecture.",
    "While eShopOnDapr focuses on Dapr, the architecture has also been streamlined and simplified.",
    "While eShopOnDapr focuses on Dapr, the architecture has also been streamlined and simplified.",
    "138",
    "138",
    "A Single Page Application running on Blazor WebAssembly sends user requests to an API",
    "A Single Page Application running on Blazor WebAssembly sends user requests to an API",
    "The API gateway abstracts the backend core microservices from the frontend client. It\u2019s",
    "The API gateway abstracts the backend core microservices from the frontend client. It\u2019s",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "requests to backend microservices. Most requests are simple CRUD operations (for example, get",
    "requests to backend microservices. Most requests are simple CRUD operations (for example, get",
    "Other requests are more logically complex and require multiple microservice calls to work",
    "Other requests are more logically complex and require multiple microservice calls to work",
    "The core backend microservices implement the required functionality for an e-Commerce store.",
    "The core backend microservices implement the required functionality for an e-Commerce store.",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "The basket service manages the customer\u2019s shopping basket experience.",
    "The basket service manages the customer\u2019s shopping basket experience.",
    "The catalog service manages product items available for sale.",
    "The catalog service manages product items available for sale.",
    "The identity service manages authentication and identity.",
    "The identity service manages authentication and identity.",
    "The ordering service handles all aspects of placing and managing orders.",
    "The ordering service handles all aspects of placing and managing orders.",
    "The payment service transacts the customer\u2019s payment.",
    "The payment service transacts the customer\u2019s payment.",
    "Adhering to best practices, each microservice maintains its own persistent storage. The",
    "Adhering to best practices, each microservice maintains its own persistent storage. The",
    "Finally, the event bus wraps the Dapr publish/subscribe components. It enables asynchronous",
    "Finally, the event bus wraps the Dapr publish/subscribe components. It enables asynchronous",
    "Application of Dapr building blocks",
    "Application of Dapr building blocks",
    "In eShopOnDapr, Dapr building blocks replace a large amount of complex, error-prone plumbing",
    "In eShopOnDapr, Dapr building blocks replace a large amount of complex, error-prone plumbing",
    "Figure 12-4 shows the Dapr integration in the application.",
    "Figure 12-4 shows the Dapr integration in the application.",
    "Figure 12-4. Dapr integration in eShopOnDapr.",
    "Figure 12-4. Dapr integration in eShopOnDapr.",
    "139",
    "139",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "The above figure shows the Dapr building blocks (represented as green numbered boxes) that each",
    "The above figure shows the Dapr building blocks (represented as green numbered boxes) that each",
    "The API gateway and web shopping aggregator services use the service invocation building",
    "The API gateway and web shopping aggregator services use the service invocation building",
    "The backend services communicate asynchronously using the publish ",
    "The backend services communicate asynchronously using the publish ",
    "The basket service uses the state management building block to store the state of the",
    "The basket service uses the state management building block to store the state of the",
    "The original eShopOnContainers demonstrates DDD concepts and patterns in the ordering",
    "The original eShopOnContainers demonstrates DDD concepts and patterns in the ordering",
    "The ordering service sends order confirmation e-mails using the bindings building block.",
    "The ordering service sends order confirmation e-mails using the bindings building block.",
    "Secret management is done by the secrets building block.",
    "Secret management is done by the secrets building block.",
    "The following sections provide more detail on how the Dapr building blocks are applied in",
    "The following sections provide more detail on how the Dapr building blocks are applied in",
    "State management",
    "State management",
    "In eShopOnDapr, the Basket service uses the state management building block to persist the contents",
    "In eShopOnDapr, the Basket service uses the state management building block to persist the contents",
    "public class RedisBasketRepository : IBasketRepository",
    "public class RedisBasketRepository : IBasketRepository",
    "}",
    "}",
    "140",
    "140",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "This code uses the third party StackExchange.Redis NuGet package. The following steps are required",
    "This code uses the third party StackExchange.Redis NuGet package. The following steps are required",
    "Inject a Redis ConnectionMultiplexer into the constructor. The ConnectionMultiplexer is",
    "Inject a Redis ConnectionMultiplexer into the constructor. The ConnectionMultiplexer is",
    "services.AddSingleton",
    "services.AddSingleton",
    "Use the ConnectionMultiplexer to create an IDatabase instance in each consuming class.",
    "Use the ConnectionMultiplexer to create an IDatabase instance in each consuming class.",
    "Use the IDatabase instance to execute a Redis StringGet call using the given customerId as the",
    "Use the IDatabase instance to execute a Redis StringGet call using the given customerId as the",
    "key.",
    "key.",
    "Check if data is loaded from Redis; if not, return null.",
    "Check if data is loaded from Redis; if not, return null.",
    "Deserialize the data from Redis to a CustomerBasket object and return the result.",
    "Deserialize the data from Redis to a CustomerBasket object and return the result.",
    "In the updated eShopOnDapr reference application, a new DaprBasketRepository class replaces the",
    "In the updated eShopOnDapr reference application, a new DaprBasketRepository class replaces the",
    "public class DaprBasketRepository : IBasketRepository",
    "public class DaprBasketRepository : IBasketRepository",
    "}",
    "}",
    "The updated code uses the Dapr .NET SDK to read and write data using the state management",
    "The updated code uses the Dapr .NET SDK to read and write data using the state management",
    "Inject a DaprClient into the constructor. The DaprClient is registered with the dependency",
    "Inject a DaprClient into the constructor. The DaprClient is registered with the dependency",
    "Use the DaprClient.GetStateAsync method to load the customer\u2019s shopping basket items from",
    "Use the DaprClient.GetStateAsync method to load the customer\u2019s shopping basket items from",
    "the configured state store and return the result.",
    "the configured state store and return the result.",
    "The updated implementation still uses Redis as the underlying data store. But, note how Dapr",
    "The updated implementation still uses Redis as the underlying data store. But, note how Dapr",
    "141",
    "141",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "The Dapr implementation also simplifies changing the underlying data store. Switching to Azure Table",
    "The Dapr implementation also simplifies changing the underlying data store. Switching to Azure Table",
    "Service invocation",
    "Service invocation",
    "The original eShopOnContainers used a mix of HTTP/REST and gRPC services. The use of gRPC was",
    "The original eShopOnContainers used a mix of HTTP/REST and gRPC services. The use of gRPC was",
    "Figure 12-5. gRPC and HTTP/REST calls in eShopOnContainers.",
    "Figure 12-5. gRPC and HTTP/REST calls in eShopOnContainers.",
    "Note the steps from the previous figure:",
    "Note the steps from the previous figure:",
    "The frontend calls the API gateway using HTTP/REST.",
    "The frontend calls the API gateway using HTTP/REST.",
    "142",
    "142",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "2.",
    "2.",
    "The API gateway forwards simple CRUD (Create, Read, Update, Delete) requests directly to a core",
    "The API gateway forwards simple CRUD (Create, Read, Update, Delete) requests directly to a core",
    "The API gateway forwards complex requests that involve coordinated backend service calls to",
    "The API gateway forwards complex requests that involve coordinated backend service calls to",
    "The aggregator service uses gRPC to call core backend services.",
    "The aggregator service uses gRPC to call core backend services.",
    "In the updated eShopOnDapr implementation, Dapr sidecars are added to the services and API",
    "In the updated eShopOnDapr implementation, Dapr sidecars are added to the services and API",
    "Figure 12-6. Updated eShop architecture using Dapr.",
    "Figure 12-6. Updated eShop architecture using Dapr.",
    "Note the updated steps from the previous figure:",
    "Note the updated steps from the previous figure:",
    "The frontend still uses HTTP/REST to call the API gateway.",
    "The frontend still uses HTTP/REST to call the API gateway.",
    "The API gateway forwards HTTP requests to its Dapr sidecar.",
    "The API gateway forwards HTTP requests to its Dapr sidecar.",
    "The API gateway sidecar sends the request to the sidecar of the aggregator or backend service.",
    "The API gateway sidecar sends the request to the sidecar of the aggregator or backend service.",
    "The aggregator service uses the Dapr .NET SDK to call backend services through their sidecar",
    "The aggregator service uses the Dapr .NET SDK to call backend services through their sidecar",
    "Dapr implements calls between sidecars with gRPC. So even if you\u2019re invoking a remote service with",
    "Dapr implements calls between sidecars with gRPC. So even if you\u2019re invoking a remote service with",
    "The eShopOnDapr reference application benefits from the Dapr service invocation building block. The",
    "The eShopOnDapr reference application benefits from the Dapr service invocation building block. The",
    "Forward HTTP requests using Envoy and Dapr",
    "Forward HTTP requests using Envoy and Dapr",
    "Both the original and updated eShop application leverage the Envoy proxy as an API gateway. Envoy",
    "Both the original and updated eShop application leverage the Envoy proxy as an API gateway. Envoy",
    "143",
    "143",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "In the original eShopOnContainers implementation, the Envoy API gateway forwarded incoming HTTP",
    "In the original eShopOnContainers implementation, the Envoy API gateway forwarded incoming HTTP",
    "Envoy is configured using a YAML definition file to control the proxy\u2019s behavior. To enable Envoy to",
    "Envoy is configured using a YAML definition file to control the proxy\u2019s behavior. To enable Envoy to",
    "clusters:",
    "clusters:",
    "name: dapr",
    "name: dapr",
    "socket",
    "socket",
    "The Envoy route configuration is updated to rewrite incoming requests as calls to the Dapr sidecar",
    "The Envoy route configuration is updated to rewrite incoming requests as calls to the Dapr sidecar",
    "name: ",
    "name: ",
    "Consider a scenario where the frontend client wants to retrieve a list of catalog items. The Catalog API",
    "Consider a scenario where the frontend client wants to retrieve a list of catalog items. The Catalog API",
    "[",
    "[",
    "First, the frontend makes a direct HTTP call to the Envoy API gateway.",
    "First, the frontend makes a direct HTTP call to the Envoy API gateway.",
    "GET http://",
    "GET http://",
    "The Envoy proxy matches the route, rewrites the HTTP request, and forwards it to the invoke API of its",
    "The Envoy proxy matches the route, rewrites the HTTP request, and forwards it to the invoke API of its",
    "GET http://127.0.0.1:3500/v1.0/invoke/catalog-api/method/api/v1/catalog/items",
    "GET http://127.0.0.1:3500/v1.0/invoke/catalog-api/method/api/v1/catalog/items",
    "144",
    "144",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "The sidecar handles service discovery and routes the request to the Catalog API sidecar. Finally, the",
    "The sidecar handles service discovery and routes the request to the Catalog API sidecar. Finally, the",
    "GET http://localhost/api/v1/catalog/items",
    "GET http://localhost/api/v1/catalog/items",
    "Make aggregated service calls using the .NET SDK",
    "Make aggregated service calls using the .NET SDK",
    "Most calls from the eShop frontend are simple CRUD calls. The API gateway forwards them to a single",
    "Most calls from the eShop frontend are simple CRUD calls. The API gateway forwards them to a single",
    "Figure 12-7. Backend call requiring multiple services.",
    "Figure 12-7. Backend call requiring multiple services.",
    "The aggregator service first retrieves catalog items from the Catalog API. It then validates item",
    "The aggregator service first retrieves catalog items from the Catalog API. It then validates item",
    "The aggregator service contains a BasketController that provides an endpoint for updating the",
    "The aggregator service contains a BasketController that provides an endpoint for updating the",
    "[",
    "[",
    "145",
    "145",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "if (data.Items is null || ",
    "if (data.Items is null || ",
    "basket.",
    "basket.",
    "}",
    "}",
    "The UpdateAllBasketAsync method gets the Authorization header of the incoming request using a",
    "The UpdateAllBasketAsync method gets the Authorization header of the incoming request using a",
    "After receiving a request to update the basket, the aggregator service calls the Catalog API to get the",
    "After receiving a request to update the basket, the aggregator service calls the Catalog API to get the",
    "public class CatalogService : ICatalogService",
    "public class CatalogService : ICatalogService",
    "}",
    "}",
    "146",
    "146",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Notice how no Dapr-specific code is required to make the service invocation call. All communication is",
    "Notice how no Dapr-specific code is required to make the service invocation call. All communication is",
    "The Dapr HttpClient is configured for the CatalogService class on program startup:",
    "The Dapr HttpClient is configured for the CatalogService class on program startup:",
    "builder.Services.AddSingleton",
    "builder.Services.AddSingleton",
    "The other call made by the aggregator service is to the Basket API. It only allows authorized requests.",
    "The other call made by the aggregator service is to the Basket API. It only allows authorized requests.",
    "public class BasketService : IBasketService",
    "public class BasketService : IBasketService",
    "}",
    "}",
    "In this example too, only standard HttpClient functionality is used to call the service. This allows",
    "In this example too, only standard HttpClient functionality is used to call the service. This allows",
    "Publish ",
    "Publish ",
    "Both eShopOnContainers and eShopOnDapr use the pub/sub pattern for communicating integration",
    "Both eShopOnContainers and eShopOnDapr use the pub/sub pattern for communicating integration",
    "\u2022  When a user checks-out a shopping basket.",
    "\u2022  When a user checks-out a shopping basket.",
    "\u2022  When a payment for an order has succeeded.",
    "\u2022  When a payment for an order has succeeded.",
    "\u2022  When the grace-period of a purchase has expired.",
    "\u2022  When the grace-period of a purchase has expired.",
    "Note",
    "Note",
    "Think of an Integration Event as an event that takes place across multiple services.",
    "Think of an Integration Event as an event that takes place across multiple services.",
    "Eventing in eShopOnContainers is based on the following IEventBus interface:",
    "Eventing in eShopOnContainers is based on the following IEventBus interface:",
    "public interface IEventBus",
    "public interface IEventBus",
    "}",
    "}",
    "147",
    "147",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Concrete implementations of this interface for both RabbitMQ and Azure Service Bus are found in",
    "Concrete implementations of this interface for both RabbitMQ and Azure Service Bus are found in",
    "The newer eShopOnDapr significantly simplifies pub/sub behavior by using Dapr. To start, the",
    "The newer eShopOnDapr significantly simplifies pub/sub behavior by using Dapr. To start, the",
    "public interface IEventBus",
    "public interface IEventBus",
    "Publish events",
    "Publish events",
    "In eShopOnDapr, a single DaprEventBus implementation can support any Dapr-supported message",
    "In eShopOnDapr, a single DaprEventBus implementation can support any Dapr-supported message",
    "public class DaprEventBus : IEventBus",
    "public class DaprEventBus : IEventBus",
    "(object)integrationEvent);",
    "(object)integrationEvent);",
    "As you can see in the code snippet, the topic name is derived from event type\u2019s name. Because all",
    "As you can see in the code snippet, the topic name is derived from event type\u2019s name. Because all",
    "148",
    "148",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Important",
    "Important",
    "The Dapr SDK uses System.Text.Json to serialize/deserialize messages. However, System.Text.Json",
    "The Dapr SDK uses System.Text.Json to serialize/deserialize messages. However, System.Text.Json",
    "With Dapr, pub/sub infrastructure code is dramatically simplified. The application doesn\u2019t need to",
    "With Dapr, pub/sub infrastructure code is dramatically simplified. The application doesn\u2019t need to",
    "Subscribe to events",
    "Subscribe to events",
    "The earlier eShopOnContainers app contains SubscriptionManagers to handle the subscription",
    "The earlier eShopOnContainers app contains SubscriptionManagers to handle the subscription",
    "eShopOnDapr streamlines the plumbing for event subscriptions by using Dapr ASP.NET Core",
    "eShopOnDapr streamlines the plumbing for event subscriptions by using Dapr ASP.NET Core",
    "[",
    "[",
    "}",
    "}",
    "In the Topic attribute, the name of the .NET type of the event is used as the topic name. For handling",
    "In the Topic attribute, the name of the .NET type of the event is used as the topic name. For handling",
    "149",
    "149",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Use pub/sub components",
    "Use pub/sub components",
    "Within the eShopOnDapr repository, a deployment folder contains files for deploying the application",
    "Within the eShopOnDapr repository, a deployment folder contains files for deploying the application",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: host",
    "name: host",
    "The configuration specifies RabbitMQ as the underlying infrastructure. To change message brokers,",
    "The configuration specifies RabbitMQ as the underlying infrastructure. To change message brokers,",
    "You can also easily use multiple message brokers in a single application. Many times a system will",
    "You can also easily use multiple message brokers in a single application. Many times a system will",
    "Bindings",
    "Bindings",
    "eShopOnDapr uses the bindings building block for sending e-mails. When a user places an order, the",
    "eShopOnDapr uses the bindings building block for sending e-mails. When a user places an order, the",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: host",
    "name: host",
    "name: port",
    "name: port",
    "name: user",
    "name: user",
    "150",
    "150",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "key: Smtp.User",
    "key: Smtp.User",
    "name: password",
    "name: password",
    "name: skipTLSVerify",
    "name: skipTLSVerify",
    "ordering-api",
    "ordering-api",
    "Dapr gets the username and password for connecting to the SMTP server from a secret reference. This",
    "Dapr gets the username and password for connecting to the SMTP server from a secret reference. This",
    "The binding configuration specifies a binding component that can be invoked using the /sendmail",
    "The binding configuration specifies a binding component that can be invoked using the /sendmail",
    "public Task Handle(OrderStartedDomainEvent notification, CancellationToken",
    "public Task Handle(OrderStartedDomainEvent notification, CancellationToken",
    "public Task SendOrderConfirmationAsync(Order order)",
    "public Task SendOrderConfirmationAsync(Order order)",
    "}",
    "}",
    "As you can see in this example, message contains the message body. The CreateEmailBody method",
    "As you can see in this example, message contains the message body. The CreateEmailBody method",
    "151",
    "151",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Actors",
    "Actors",
    "In the original eShopOnContainers solution, the Ordering service provides a great example of how to",
    "In the original eShopOnContainers solution, the Ordering service provides a great example of how to",
    "The ordering process consists of the following steps:",
    "The ordering process consists of the following steps:",
    "The customer submits the order. There\u2019s a grace period before any further processing occurs.",
    "The customer submits the order. There\u2019s a grace period before any further processing occurs.",
    "The system checks that there\u2019s available stock.",
    "The system checks that there\u2019s available stock.",
    "The system processes the payment.",
    "The system processes the payment.",
    "The system ships the order.",
    "The system ships the order.",
    "The process is implemented using a single OrderingProcessActor actor type. Here\u2019s the interface for",
    "The process is implemented using a single OrderingProcessActor actor type. Here\u2019s the interface for",
    "public interface IOrderingProcessActor : IActor",
    "public interface IOrderingProcessActor : IActor",
    "}",
    "}",
    "The process is started when a customer checks out some products. Upon checkout, the Basket service",
    "The process is started when a customer checks out some products. Upon checkout, the Basket service",
    "[",
    "[",
    "integrationEvent.UserName,",
    "integrationEvent.UserName,",
    "152",
    "152",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "integrationEvent.Street, integrationEvent.City, integrationEvent.ZipCode,",
    "integrationEvent.Street, integrationEvent.City, integrationEvent.ZipCode,",
    "In the example above, the Ordering service first uses the original request ID from the",
    "In the example above, the Ordering service first uses the original request ID from the",
    "public async Task SubmitAsync(",
    "public async Task SubmitAsync(",
    "153",
    "153",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "await ",
    "await ",
    "There\u2019s a lot going on in the Submit method:",
    "There\u2019s a lot going on in the Submit method:",
    "The method takes the given arguments to create an OrderState object and saves it in the actor",
    "The method takes the given arguments to create an OrderState object and saves it in the actor",
    "The method saves the current status of the process (OrderStatus.Submitted) in the actor state.",
    "The method saves the current status of the process (OrderStatus.Submitted) in the actor state.",
    "The method registers a reminder to signal the end of the grace period. Order processing is",
    "The method registers a reminder to signal the end of the grace period. Order processing is",
    "Lastly, the method publishes an OrderStatusChangedToSubmittedIntegrationEvent to notify",
    "Lastly, the method publishes an OrderStatusChangedToSubmittedIntegrationEvent to notify",
    "When the reminder for the grace period ending fires, the actor runtime calls the",
    "When the reminder for the grace period ending fires, the actor runtime calls the",
    "public Task ReceiveReminderAsync(",
    "public Task ReceiveReminderAsync(",
    "As shown in the snippet above, the ReceiveReminderAsync method handles not just the grace period",
    "As shown in the snippet above, the ReceiveReminderAsync method handles not just the grace period",
    "public async Task OnGracePeriodElapsedAsync()",
    "public async Task OnGracePeriodElapsedAsync()",
    "OrderStatusChangedToAwaitingStockValidationIntegrationEvent(",
    "OrderStatusChangedToAwaitingStockValidationIntegrationEvent(",
    "154",
    "154",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "order.UserName,",
    "order.UserName,",
    "The OnGracePeriodElapsedAsync method first tries to update the order status to the new",
    "The OnGracePeriodElapsedAsync method first tries to update the order status to the new",
    "Let\u2019s look at the TryUpdateOrderStatusAsync method to see under which circumstances it may fail to",
    "Let\u2019s look at the TryUpdateOrderStatusAsync method to see under which circumstances it may fail to",
    "private async Task",
    "private async Task",
    "{ExpectedStatus}",
    "{ExpectedStatus}",
    "}",
    "}",
    "First, the TryUpdateOrderStatusAsync method checks whether there even is a current order status. If",
    "First, the TryUpdateOrderStatusAsync method checks whether there even is a current order status. If",
    "The other steps in the ordering process are all implemented in a very similar way to the grace period",
    "The other steps in the ordering process are all implemented in a very similar way to the grace period",
    "155",
    "155",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Order cancellation",
    "Order cancellation",
    "Customers are allowed to cancel any order that has not been paid or shipped yet. The",
    "Customers are allowed to cancel any order that has not been paid or shipped yet. The",
    "public async Task",
    "public async Task",
    "OrderStatus.Shipped.Id)",
    "OrderStatus.Shipped.Id)",
    "}",
    "}",
    "The CancelAsync method consists of the following steps:",
    "The CancelAsync method consists of the following steps:",
    "First, the method ensures that the order exists by retrieving the current order status.",
    "First, the method ensures that the order exists by retrieving the current order status.",
    "If the order exists, the method checks whether it\u2019s eligible for cancellation. Any order not in the",
    "If the order exists, the method checks whether it\u2019s eligible for cancellation. Any order not in the",
    "If the order can be cancelled, the order status is changed to Cancelled.",
    "If the order can be cancelled, the order status is changed to Cancelled.",
    "Lastly, the order details are retrieved from state and used to publish an",
    "Lastly, the order details are retrieved from state and used to publish an",
    "The CancelAsync method is a great example of the usefulness of the turn-based access model of",
    "The CancelAsync method is a great example of the usefulness of the turn-based access model of",
    "156",
    "156",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "Order details",
    "Order details",
    "Customers can check the status and details of their order in the eShopOnDapr UI. They can also view",
    "Customers can check the status and details of their order in the eShopOnDapr UI. They can also view",
    "Low-latency reads cannot be guaranteed because actor operations execute serially.",
    "Low-latency reads cannot be guaranteed because actor operations execute serially.",
    "Querying across actors is inefficient because each actor\u2019s state needs to be read individually and",
    "Querying across actors is inefficient because each actor\u2019s state needs to be read individually and",
    "can introduce more unpredictable latencies.",
    "can introduce more unpredictable latencies.",
    "To fix this issue, eShopOnDapr uses a separate read model for any queries on order data. The read",
    "To fix this issue, eShopOnDapr uses a separate read model for any queries on order data. The read",
    "The following snippet shows the code for handling the",
    "The following snippet shows the code for handling the",
    "[",
    "[",
    "semantics).",
    "semantics).",
    "}",
    "}",
    "The handler contains the code for all the actions that must occur after an order is submitted",
    "The handler contains the code for all the actions that must occur after an order is submitted",
    "The handler performs the following steps:",
    "The handler performs the following steps:",
    "157",
    "157",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "1.",
    "1.",
    "First, the method creates an actor proxy and uses it to retrieve the order details from the actor",
    "First, the method creates an actor proxy and uses it to retrieve the order details from the actor",
    "The method maps the order details to the read model and stores it in the database. Due to the",
    "The method maps the order details to the read model and stores it in the database. Due to the",
    "The method publishes a push notification for the status update using SignalR.",
    "The method publishes a push notification for the status update using SignalR.",
    "Lastly, if enabled, the method sends a confirmation e-mail to the customer.",
    "Lastly, if enabled, the method sends a confirmation e-mail to the customer.",
    "Subsequent order status updates are all handled equally to each other. The following snippet shows",
    "Subsequent order status updates are all handled equally to each other. The following snippet shows",
    "[",
    "[",
    "private async Task UpdateReadModelAndSendNotificationAsync(",
    "private async Task UpdateReadModelAndSendNotificationAsync(",
    "}",
    "}",
    "In the snippet, the handler calls the UpdateReadModelAndSendNotificationAsync helper method to",
    "In the snippet, the handler calls the UpdateReadModelAndSendNotificationAsync helper method to",
    "The helper method first loads the current order from the database.",
    "The helper method first loads the current order from the database.",
    "If that succeeds, it updates the OrderStatus and Description fields and saves the updated",
    "If that succeeds, it updates the OrderStatus and Description fields and saves the updated",
    "Lastly, it sends a push notification to notify the client UI.",
    "Lastly, it sends a push notification to notify the client UI.",
    "Observability",
    "Observability",
    "eShopOnDapr uses Zipkin to visualize distributed traces collected by Dapr. Seq aggregates the",
    "eShopOnDapr uses Zipkin to visualize distributed traces collected by Dapr. Seq aggregates the",
    "158",
    "158",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "eShopOnDapr also includes a custom health dashboard that gives insight into the health of the eShop",
    "eShopOnDapr also includes a custom health dashboard that gives insight into the health of the eShop",
    "Secrets",
    "Secrets",
    "The eShopOnDapr reference application uses the secrets building block for various secrets:",
    "The eShopOnDapr reference application uses the secrets building block for various secrets:",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "The password for connecting to the Redis cache.",
    "The password for connecting to the Redis cache.",
    "The username and password for the SMTP server.",
    "The username and password for the SMTP server.",
    "The connection strings for the SQL databases.",
    "The connection strings for the SQL databases.",
    "When running the application using Docker Compose, the local file secret store is used. The",
    "When running the application using Docker Compose, the local file secret store is used. The",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: secretsFile",
    "name: secretsFile",
    "name: nestedSeparator",
    "name: nestedSeparator",
    "The configuration file references the local store file eshop-secretstore.json located in the same",
    "The configuration file references the local store file eshop-secretstore.json located in the same",
    "{",
    "{",
    "The components folder is specified in the command-line and mounted as a local folder inside the Dapr",
    "The components folder is specified in the command-line and mounted as a local folder inside the Dapr",
    "catalog-api-dapr:",
    "catalog-api-dapr:",
    "159",
    "159",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "\"",
    "\"",
    "The /components volume mount and --components-path command-line argument are passed into",
    "The /components volume mount and --components-path command-line argument are passed into",
    "Once configured, other component configuration files can also reference the secrets. Here\u2019s an",
    "Once configured, other component configuration files can also reference the secrets. Here\u2019s an",
    "apiVersion: dapr.io/v1alpha1",
    "apiVersion: dapr.io/v1alpha1",
    "name: redisHost",
    "name: redisHost",
    "name: redisPassword",
    "name: redisPassword",
    "name: actorStateStore",
    "name: actorStateStore",
    "basket-api",
    "basket-api",
    "ordering-api",
    "ordering-api",
    "Benefits of applying Dapr to eShop",
    "Benefits of applying Dapr to eShop",
    "In general, the use of Dapr building blocks adds observability and flexibility to the application:",
    "In general, the use of Dapr building blocks adds observability and flexibility to the application:",
    "Observability: By using the Dapr building blocks, you gain rich distributed tracing for calls",
    "Observability: By using the Dapr building blocks, you gain rich distributed tracing for calls",
    "between services and to Dapr components without having to write any code. In",
    "between services and to Dapr components without having to write any code. In",
    "Flexibility: You can now swap out infrastructure simply by changing a component configuration",
    "Flexibility: You can now swap out infrastructure simply by changing a component configuration",
    "Here are some more examples of benefits offered by specific building blocks:",
    "Here are some more examples of benefits offered by specific building blocks:",
    "\u2022",
    "\u2022",
    "Service Invocation",
    "Service Invocation",
    "\u2013  With Dapr\u2019s support for mTLS, services now communicate through encrypted channels.",
    "\u2013  With Dapr\u2019s support for mTLS, services now communicate through encrypted channels.",
    "\u2013  When transient errors occur, service calls are automatically retried.",
    "\u2013  When transient errors occur, service calls are automatically retried.",
    "160",
    "160",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "\u2013",
    "\u2013",
    "Automatic service discovery reduces the amount of configuration needed for services to",
    "Automatic service discovery reduces the amount of configuration needed for services to",
    "\u2022",
    "\u2022",
    "Publish/Subscribe",
    "Publish/Subscribe",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "eShopOnContainers included a large amount of custom code to support both Azure",
    "eShopOnContainers included a large amount of custom code to support both Azure",
    "eShopOnDapr uses Dapr\u2019s rich ASP.NET Core integration to use pub/sub. You add Topic",
    "eShopOnDapr uses Dapr\u2019s rich ASP.NET Core integration to use pub/sub. You add Topic",
    "\u2013  Messages routed to the service as HTTP calls enable the use of ASP.NET Core",
    "\u2013  Messages routed to the service as HTTP calls enable the use of ASP.NET Core",
    "middleware to add functionality, without introducing new concepts or SDKs to learn.",
    "middleware to add functionality, without introducing new concepts or SDKs to learn.",
    "\u2022",
    "\u2022",
    "Bindings",
    "Bindings",
    "\u2013",
    "\u2013",
    "The eShopOnContainers solution contained a to-do item for e-mailing an order",
    "The eShopOnContainers solution contained a to-do item for e-mailing an order",
    "\u2022",
    "\u2022",
    "Actors",
    "Actors",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "The actors building block makes it easy to create long running, stateful workflows.",
    "The actors building block makes it easy to create long running, stateful workflows.",
    "The complexity of the grace period implementation is greatly reduced by using actor",
    "The complexity of the grace period implementation is greatly reduced by using actor",
    "Summary",
    "Summary",
    "In this chapter, you\u2019re introduced to the eShopOnDapr reference application. It\u2019s an evolution of the",
    "In this chapter, you\u2019re introduced to the eShopOnDapr reference application. It\u2019s an evolution of the",
    "References",
    "References",
    "eShopOnDapr",
    "eShopOnDapr",
    "eShopOnContainers",
    "eShopOnContainers",
    ".NET Microservices for Containerized .NET Applications",
    ".NET Microservices for Containerized .NET Applications",
    "Architecting Cloud-Native .NET Apps for Azure",
    "Architecting Cloud-Native .NET Apps for Azure",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "161",
    "161",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER 13 | Dapr reference application",
    "CHAPTER  14",
    "CHAPTER  14",
    "Summary and the road",
    "Summary and the road",
    "We\u2019re at the end of our Dapr flight. The jet plane flying at 20,000 feet from chapter 2 is on final",
    "We\u2019re at the end of our Dapr flight. The jet plane flying at 20,000 feet from chapter 2 is on final",
    "As the plane taxis to the gate, let\u2019s take a minute to review some important conclusions from this",
    "As the plane taxis to the gate, let\u2019s take a minute to review some important conclusions from this",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Dapr - Dapr is a Distributed Application Runtime that streamlines how you build distributed",
    "Dapr - Dapr is a Distributed Application Runtime that streamlines how you build distributed",
    "Open source and cross-platform - The native Dapr API can be consumed by any platform that",
    "Open source and cross-platform - The native Dapr API can be consumed by any platform that",
    "Building blocks - Dapr building blocks encapsulate distributed application functionality. At the",
    "Building blocks - Dapr building blocks encapsulate distributed application functionality. At the",
    "162",
    "162",
    "CHAPTER 14 | Summary and the road ahead",
    "CHAPTER 14 | Summary and the road ahead",
    "Figure 13-1. Dapr building blocks.",
    "Figure 13-1. Dapr building blocks.",
    "\u2022",
    "\u2022",
    "Components - Dapr components provide the concrete implementation for each Dapr building",
    "Components - Dapr components provide the concrete implementation for each Dapr building",
    "163",
    "163",
    "CHAPTER 14 | Summary and the road ahead",
    "CHAPTER 14 | Summary and the road ahead",
    "Figure 13-2. Dapr building block integration.",
    "Figure 13-2. Dapr building block integration.",
    "\u2022",
    "\u2022",
    "Sidecars - Dapr runs alongside your application in a sidecar architecture, either as a separate",
    "Sidecars - Dapr runs alongside your application in a sidecar architecture, either as a separate",
    "Figure 13-3. Sidecar architecture.",
    "Figure 13-3. Sidecar architecture.",
    "164",
    "164",
    "CHAPTER 14 | Summary and the road ahead",
    "CHAPTER 14 | Summary and the road ahead",
    "\u2022",
    "\u2022",
    "\u2022",
    "\u2022",
    "Hosting environments Dapr has cross-platform support and can run in multiple environments.",
    "Hosting environments Dapr has cross-platform support and can run in multiple environments.",
    "eShopOnDapr - This book includes an accompanying reference application entitled",
    "eShopOnDapr - This book includes an accompanying reference application entitled",
    "The road ahead",
    "The road ahead",
    "Looking forward, Dapr has the potential to have a profound impact on distributed application",
    "Looking forward, Dapr has the potential to have a profound impact on distributed application",
    "At the time of writing, the list of proposed enhancements for Dapr include:",
    "At the time of writing, the list of proposed enhancements for Dapr include:",
    "\u2022",
    "\u2022",
    "Feature enhancements to existing building blocks:",
    "Feature enhancements to existing building blocks:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "Query capabilities in state management enabling you to retrieve multiple values.",
    "Query capabilities in state management enabling you to retrieve multiple values.",
    "Topic filtering in pub/sub enabling you to filter topics based on their content.",
    "Topic filtering in pub/sub enabling you to filter topics based on their content.",
    "An application tracing API in observability that provides tracing in the application",
    "An application tracing API in observability that provides tracing in the application",
    "Binding and pub/sub support for actors providing event driven capabilities to the actor",
    "Binding and pub/sub support for actors providing event driven capabilities to the actor",
    "\u2022",
    "\u2022",
    "New building blocks:",
    "New building blocks:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "Configuration API building block for reading and writing configuration data. The block",
    "Configuration API building block for reading and writing configuration data. The block",
    "Http scale-to-zero autoscale.",
    "Http scale-to-zero autoscale.",
    "Leader election building block to provide singleton instances and locking semantic",
    "Leader election building block to provide singleton instances and locking semantic",
    "Transparent proxying building block for service invocation, enabling you to route",
    "Transparent proxying building block for service invocation, enabling you to route",
    "Resiliency building block (circuit breakers, bulkheads ",
    "Resiliency building block (circuit breakers, bulkheads ",
    "\u2022",
    "\u2022",
    "Integration with frameworks and cloud native technologies. Some examples include:",
    "Integration with frameworks and cloud native technologies. Some examples include:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "Django",
    "Django",
    "Nodejs",
    "Nodejs",
    "Express",
    "Express",
    "Kyma",
    "Kyma",
    "\u2013  Midway",
    "\u2013  Midway",
    "\u2022",
    "\u2022",
    "New language SDKs:",
    "New language SDKs:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "JavaScript",
    "JavaScript",
    "RUST",
    "RUST",
    "C++",
    "C++",
    "165",
    "165",
    "CHAPTER 14 | Summary and the road ahead",
    "CHAPTER 14 | Summary and the road ahead",
    "\u2022",
    "\u2022",
    "New hosting platforms:",
    "New hosting platforms:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "VMs",
    "VMs",
    "Azure IoT Edge",
    "Azure IoT Edge",
    "Azure Stack Edge",
    "Azure Stack Edge",
    "Azure Service Fabric",
    "Azure Service Fabric",
    "\u2022",
    "\u2022",
    "Developer and operator productivity tooling:",
    "Developer and operator productivity tooling:",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "\u2013",
    "VS Code extension.",
    "VS Code extension.",
    "Remote Dev Containers for local debugging a DevOps pipeline development.",
    "Remote Dev Containers for local debugging a DevOps pipeline development.",
    "Dapr operational dashboard enhancements that will provide deeper visibility into the",
    "Dapr operational dashboard enhancements that will provide deeper visibility into the",
    "Dapr version 1.0 provides developers with a compelling toolbox for building distributed applications.",
    "Dapr version 1.0 provides developers with a compelling toolbox for building distributed applications.",
    "166",
    "166",
    "CHAPTER 14 | Summary and the road ahead",
    "CHAPTER 14 | Summary and the road ahead"
]