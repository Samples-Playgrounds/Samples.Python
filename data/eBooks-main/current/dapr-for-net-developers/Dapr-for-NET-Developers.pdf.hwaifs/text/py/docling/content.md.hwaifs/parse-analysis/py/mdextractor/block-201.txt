private async Task<bool> TryUpdateOrderStatusAsync(OrderStatus expectedOrderStatus, OrderStatus newOrderStatus) { var orderStatus = await StateManager.TryGetStateAsync<OrderStatus>(OrderStatusStateName); if (!orderStatus.HasValue) { _logger.LogWarning( "Order with Id: {OrderId} cannot be updated because it doesn't exist", OrderId); return false ; } if (orderStatus.Value.Id != expectedOrderStatus.Id) { _logger.LogWarning( "Order with Id: {OrderId} is in status {Status} instead of expected status {ExpectedStatus}", OrderId, orderStatus.Value.Name, expectedOrderStatus.Name); return false ; } await StateManager.SetStateAsync(OrderStatusStateName, newOrderStatus); return true ; }