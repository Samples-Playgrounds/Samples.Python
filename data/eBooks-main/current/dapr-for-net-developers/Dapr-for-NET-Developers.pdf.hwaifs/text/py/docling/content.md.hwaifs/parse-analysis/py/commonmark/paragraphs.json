[
    "Foreword by Mark Russinovich, Microsoft Azure CTO and Technical Fellow",
    "Foreword by Mark Russinovich, Microsoft Azure CTO and Technical Fellow",
    "Robert Vettor Sander Molenkamp Edwin van Wijk",
    "Robert Vettor Sander Molenkamp Edwin van Wijk",
    "PUBLISHED BY Microsoft Developer Division, .NET, and Azure Incubations teams A division of Microsoft Corporation One Microsoft Way Redmond, Washington 98052-6399 Copyright \u00a9 2023 by Microsoft Corporation All rights reserved. No part of the contents of this book may be reproduced or transmitted in any form or by any means without the written permission of the publisher. This book is provided ",
    "PUBLISHED BY Microsoft Developer Division, .NET, and Azure Incubations teams A division of Microsoft Corporation One Microsoft Way Redmond, Washington 98052-6399 Copyright \u00a9 2023 by Microsoft Corporation All rights reserved. No part of the contents of this book may be reproduced or transmitted in any form or by any means without the written permission of the publisher. This book is provided ",
    "Maira Wenzel , Senior Program Manager, .NET team, Microsoft",
    "Maira Wenzel , Senior Program Manager, .NET team, Microsoft",
    "Steve ",
    "Steve ",
    "This guide has been written to cover the Dapr 1.9 version. .NET samples are based on .NET 7 .",
    "This guide has been written to cover the Dapr 1.9 version. .NET samples are based on .NET 7 .",
    "The audience for this guide is mainly developers, development leads, and architects who are interested in learning how to build applications designed for the cloud.",
    "The audience for this guide is mainly developers, development leads, and architects who are interested in learning how to build applications designed for the cloud.",
    "A secondary audience is technical decision-makers who plan to choose whether to build their applications using a cloud-native approach.",
    "A secondary audience is technical decision-makers who plan to choose whether to build their applications using a cloud-native approach.",
    "This guide is available both in PDF form and online. Feel free to forward this document or links to its online version to your team to help ensure common understanding of these topics. Most of these topics benefit from a consistent understanding of the underlying principles and patterns, as well as the trade-offs involved in decisions related to these topics. Our goal with this document is to equip teams and their leaders with the information they need to make well-informed decisions for their applications",
    "This guide is available both in PDF form and online. Feel free to forward this document or links to its online version to your team to help ensure common understanding of these topics. Most of these topics benefit from a consistent understanding of the underlying principles and patterns, as well as the trade-offs involved in decisions related to these topics. Our goal with this document is to equip teams and their leaders with the information they need to make well-informed decisions for their applications",
    "| Foreword - Dapr for .NET Developers................................................................................... 1                                                                      |",
    "| Foreword - Dapr for .NET Developers................................................................................... 1                                                                      |",
    "| Hosting......................................................................................................................................................................................   | 40   |",
    "| Hosting......................................................................................................................................................................................   | 40   |",
    "| The Dapr publish ",
    "| The Dapr publish ",
    "| Call non-.NET                                                                                                                                                                               | actors........................................................................................................................................................94   |",
    "| Call non-.NET                                                                                                                                                                               | actors........................................................................................................................................................94   |",
    "| FineCalculator component license key..................................................................................................................134                                   |",
    "| FineCalculator component license key..................................................................................................................134                                   |",
    "With the wave of cloud adoption underway, there is a major shift happening towards ",
    "With the wave of cloud adoption underway, there is a major shift happening towards ",
    "Dapr is designed as an enterprise, developer-focused, microservices programming model platform wi th the mantra ",
    "Dapr is designed as an enterprise, developer-focused, microservices programming model platform wi th the mantra ",
    "To address the wide range of scenarios that developers face, Dapr provides features such as state management, service-to-service invocation, pub/sub, and integration to external systems with I/O bindings, which are based on the triggers and bindings of Azure Functions. These in turn take advantage of Dapr",
    "To address the wide range of scenarios that developers face, Dapr provides features such as state management, service-to-service invocation, pub/sub, and integration to external systems with I/O bindings, which are based on the triggers and bindings of Azure Functions. These in turn take advantage of Dapr",
    "and incorporate service SDKs into their code, or worry about authentication, secret management, retries, or conditional code that targets specific deployment environments.",
    "and incorporate service SDKs into their code, or worry about authentication, secret management, retries, or conditional code that targets specific deployment environments.",
    "This book shows how Dapr reduces your development time and overall code maintenance by incrementally ",
    "This book shows how Dapr reduces your development time and overall code maintenance by incrementally ",
    "We publicly announced Dapr with the v0.1 release in Oct 2019 and now, a year and half later, I am thrilled to say that Dapr is ready for production usage with the v1.0 release. Getting Dapr to v1.0 has truly been a community effort. It has been amazing to see the open-source community coalesce around Dapr and grow since it was first announced -from 114 contributors in October 2019 to over 700 in early 2021 - a six-fold increase in 16 months",
    "We publicly announced Dapr with the v0.1 release in Oct 2019 and now, a year and half later, I am thrilled to say that Dapr is ready for production usage with the v1.0 release. Getting Dapr to v1.0 has truly been a community effort. It has been amazing to see the open-source community coalesce around Dapr and grow since it was first announced -from 114 contributors in October 2019 to over 700 in early 2021 - a six-fold increase in 16 months",
    "Dapr is just getting started, though, and you should expect to see more Dapr capabilities and more support for Dapr in Azure services. I hope that you will take advantage of Dapr to enable you to focus on your core business logic and accelerate your microservices development. I am excited to have you join us in the Dapr community on this journey at https://github.com/dapr/ and on Discord https://aka.ms/dapr-discord.",
    "Dapr is just getting started, though, and you should expect to see more Dapr capabilities and more support for Dapr in Azure services. I hope that you will take advantage of Dapr to enable you to focus on your core business logic and accelerate your microservices development. I am excited to have you join us in the Dapr community on this journey at https://github.com/dapr/ and on Discord https://aka.ms/dapr-discord.",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently deployable services. These services cross process and server boundaries. They then consume different kinds of infrastructure backing services (databases, message brokers, key vaults). Finally, these disparate pieces compose together to form an application.",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently deployable services. These services cross process and server boundaries. They then consume different kinds of infrastructure backing services (databases, message brokers, key vaults). Finally, these disparate pieces compose together to form an application.",
    "Mark Russinovich Azure CTO and Technical Fellow Microsoft",
    "Mark Russinovich Azure CTO and Technical Fellow Microsoft",
    "Client app",
    "Client app",
    "Mobile app valzzzaral",
    "Mobile app valzzzaral",
    "Web app",
    "Web app",
    "API",
    "API",
    "Server app",
    "Server app",
    "Modules",
    "Modules",
    "Identity",
    "Identity",
    "Catalog",
    "Catalog",
    "database",
    "database",
    "Marketing",
    "Marketing",
    "Location",
    "Location",
    "Just ask any ",
    "Just ask any ",
    "But, it",
    "But, it",
    "But, this evolution raises m any questions\u2026",
    "But, this evolution raises m any questions\u2026",
    "What exactly is a distributed application?",
    "What exactly is a distributed application?",
    "Why are they gaining popularity?",
    "Why are they gaining popularity?",
    "What are the costs?",
    "What are the costs?",
    "And, importantly, what are the tradeoffs?",
    "And, importantly, what are the tradeoffs?",
    "To start, let",
    "To start, let",
    "Figure 1-1. Monolithic architecture.",
    "Figure 1-1. Monolithic architecture.",
    "Note how the modules for Ordering, Identity, and Marketing execute in a single-server process. Application data is stored in a shared database. Business functionality is exposed via HTML and RESTful interfaces.",
    "Note how the modules for Ordering, Identity, and Marketing execute in a single-server process. Application data is stored in a shared database. Business functionality is exposed via HTML and RESTful interfaces.",
    "In many ways, monolithic apps are straightforward . They",
    "In many ways, monolithic apps are straightforward . They",
    "Build",
    "Build",
    "Infrastructure",
    "Infrastructure",
    "Test",
    "Test",
    "Deploy",
    "Deploy",
    "Troubleshoot",
    "Troubleshoot",
    "Scale vertically (scale up)",
    "Scale vertically (scale up)",
    "However, monolithic architectures can present significant challenges.",
    "However, monolithic architectures can present significant challenges.",
    "Over time, you may reach a point where you begin to lose control\u2026",
    "Over time, you may reach a point where you begin to lose control\u2026",
    "The monolith has become so overwhelmingly complicated that no single person understands it.",
    "The monolith has become so overwhelmingly complicated that no single person understands it.",
    "You fear making changes as each brings unintended and costly side effects.",
    "You fear making changes as each brings unintended and costly side effects.",
    "New features/fixes become time-consuming and expensive to implement.",
    "New features/fixes become time-consuming and expensive to implement.",
    "Even the smallest change requires full deployment of the entire application - expensive and risky.",
    "Even the smallest change requires full deployment of the entire application - expensive and risky.",
    "One unstable component can crash the entire system.",
    "One unstable component can crash the entire system.",
    "Adding new technologies and frameworks aren",
    "Adding new technologies and frameworks aren",
    "Implementing agile delivery methodologies are difficult.",
    "Implementing agile delivery methodologies are difficult.",
    "Architectural erosion sets in as the code base deteriorates with neverending ",
    "Architectural erosion sets in as the code base deteriorates with neverending ",
    "Eventually the consultants come in and tell you to rewrite it.",
    "Eventually the consultants come in and tell you to rewrite it.",
    "IT practitioners call this condition the Fear Cycle . If you",
    "IT practitioners call this condition the Fear Cycle . If you",
    "Instead of fear, businesses require speed and agility . They seek an architectural style with which they can rapidly respond to market conditions. They need to instantaneously update and individually scale small areas of a live application.",
    "Instead of fear, businesses require speed and agility . They seek an architectural style with which they can rapidly respond to market conditions. They need to instantaneously update and individually scale small areas of a live application.",
    "An early attempt to gain speed and agility came in the form of Service Oriented Architecture, or SOA . In this model, service consumers and service providers collaborated via middleware messaging components, often referred to as an Enterprise Service Bus, or ESB . Figure 1-2 shows the architecture.",
    "An early attempt to gain speed and agility came in the form of Service Oriented Architecture, or SOA . In this model, service consumers and service providers collaborated via middleware messaging components, often referred to as an Enterprise Service Bus, or ESB . Figure 1-2 shows the architecture.",
    "provider",
    "provider",
    "Consumers",
    "Consumers",
    "Figure 1-2. SOA architecture.",
    "Figure 1-2. SOA architecture.",
    "With SOA, centralized service providers registered with the ESB. Business logic would be built into the ESB to integrate providers and consumers. Service consumers could then find and communicate with these providers using the ESB.",
    "With SOA, centralized service providers registered with the ESB. Business logic would be built into the ESB to integrate providers and consumers. Service consumers could then find and communicate with these providers using the ESB.",
    "Despite the promises of SOA, implementing this approach often increased complexity and introduced bottlenecks. Maintenance costs became high and ESB middleware expensive. Services tended to be large. They often shared dependencies and data storage. In the end, SOAs often resulted in a ",
    "Despite the promises of SOA, implementing this approach often increased complexity and introduced bottlenecks. Maintenance costs became high and ESB middleware expensive. Services tended to be large. They often shared dependencies and data storage. In the end, SOAs often resulted in a ",
    "Nowadays, many organizations have realized speed and agility by adopting a distributed microservice architectural approach to building systems. Figure 1-3 shows the same system built using distributed techniques and practices.",
    "Nowadays, many organizations have realized speed and agility by adopting a distributed microservice architectural approach to building systems. Figure 1-3 shows the same system built using distributed techniques and practices.",
    "Ordering microservice",
    "Ordering microservice",
    "API",
    "API",
    "Consumers",
    "Consumers",
    "Figure 1-3. Distributed architecture.",
    "Figure 1-3. Distributed architecture.",
    "Note how the same application is decomposed across a set of distributed services. Each is selfcontained and encapsulates its own code, data, and dependencies. Each is deployed in a software container and managed by a container orchestrator. Instead of a single database shared by multiple services, each service own s a private database. Other services can",
    "Note how the same application is decomposed across a set of distributed services. Each is selfcontained and encapsulates its own code, data, and dependencies. Each is deployed in a software container and managed by a container orchestrator. Instead of a single database shared by multiple services, each service own s a private database. Other services can",
    "But, while distributed services can provide agility and speed, they present a different set of challenges. Consider the following\u2026",
    "But, while distributed services can provide agility and speed, they present a different set of challenges. Consider the following\u2026",
    "How can distributed services discover each other and communicate synchronously?",
    "How can distributed services discover each other and communicate synchronously?",
    "How can they implement asynchronous messaging?",
    "How can they implement asynchronous messaging?",
    "How can they maintain contextual information across a transaction?",
    "How can they maintain contextual information across a transaction?",
    "How can they become resilient to failure?",
    "How can they become resilient to failure?",
    "How can they scale to meet fluctuating demand?",
    "How can they scale to meet fluctuating demand?",
    "How are they monitored and observed?",
    "How are they monitored and observed?",
    "For each of these challenges, multiple products are often available. But, shielding your application from product differences and keeping code maintainable and portable become a challenge.",
    "For each of these challenges, multiple products are often available. But, shielding your application from product differences and keeping code maintainable and portable become a challenge.",
    "This book introduces Dapr. Dapr is a distributed application runtime. It directly addresses many of the challenges found that come along with distributed applications. Looking ahead, Dapr has the potential to have a profound impact on distributed application development.",
    "This book introduces Dapr. Dapr is a distributed application runtime. It directly addresses many of the challenges found that come along with distributed applications. Looking ahead, Dapr has the potential to have a profound impact on distributed application development.",
    "In this chapter, we discussed the adoption of distributed applications. We contrasted a monolithic system approach with that of distributed services. We pointed out many of the common challenges when considering a distributed approach.",
    "In this chapter, we discussed the adoption of distributed applications. We contrasted a monolithic system approach with that of distributed services. We pointed out many of the common challenges when considering a distributed approach.",
    "Now, sit back, relax, and let us introduce you the new world of Dapr.",
    "Now, sit back, relax, and let us introduce you the new world of Dapr.",
    "In chapter 1, we discussed the appeal of distributed microservice applications. But, we also pointed out that they dramatically increase architectural and operational complexity. With that in mind, the question becomes, how can you ",
    "In chapter 1, we discussed the appeal of distributed microservice applications. But, we also pointed out that they dramatically increase architectural and operational complexity. With that in mind, the question becomes, how can you ",
    "Dapr, or Distributed Application Runtime , is a new way to build modern distributed applications.",
    "Dapr, or Distributed Application Runtime , is a new way to build modern distributed applications.",
    "What started as a prototype has evolved into a highly successful open-source project. Its sponsor, Microsoft, has closely partnered with customers and the open-source community to design and build Dapr. The Dapr project brings together developers from all backgrounds to solve some of the toughest challenges of developing distributed applications.",
    "What started as a prototype has evolved into a highly successful open-source project. Its sponsor, Microsoft, has closely partnered with customers and the open-source community to design and build Dapr. The Dapr project brings together developers from all backgrounds to solve some of the toughest challenges of developing distributed applications.",
    "This book looks at Dapr from the viewpoint of a .NET developer. In this chapter, you",
    "This book looks at Dapr from the viewpoint of a .NET developer. In this chapter, you",
    "Imagine flying in a jet at 20,000 feet. You look out the window and see the landscape below from a wide perspective. Let",
    "Imagine flying in a jet at 20,000 feet. You look out the window and see the landscape below from a wide perspective. Let",
    "Dapr addresses a large challenge inherent in modern distributed applications: Complexity .",
    "Dapr addresses a large challenge inherent in modern distributed applications: Complexity .",
    "Through an architecture of pluggable components, Dapr greatly simplifies the plumbing behind distributed applications. It provides a dynamic glue that binds your application with infrastructure capabilities from the Dapr runtime.",
    "Through an architecture of pluggable components, Dapr greatly simplifies the plumbing behind distributed applications. It provides a dynamic glue that binds your application with infrastructure capabilities from the Dapr runtime.",
    "Consider a requirement to make one of your services stateful? What would be your design. You could write custom code that targets a state store such as Redis Cache. However, Dapr provides state management capabilities out-of-the-box. Your service invokes the Dapr state management building block that dynamically binds to a state store component via a Dapr component configuration yaml file. Dapr ships with several pre-built state store components, including Redis. With this model, your service delegates state management to the Dapr runtime. Your service has no SDK, library, or direct reference to the underlying component. You can even change state stores, say, from Redis to MySQL or Cassandra, with no code changes.",
    "Consider a requirement to make one of your services stateful? What would be your design. You could write custom code that targets a state store such as Redis Cache. However, Dapr provides state management capabilities out-of-the-box. Your service invokes the Dapr state management building block that dynamically binds to a state store component via a Dapr component configuration yaml file. Dapr ships with several pre-built state store components, including Redis. With this model, your service delegates state management to the Dapr runtime. Your service has no SDK, library, or direct reference to the underlying component. You can even change state stores, say, from Redis to MySQL or Cassandra, with no code changes.",
    "Figure 2-1 shows Dapr from 20,000 feet.",
    "Figure 2-1 shows Dapr from 20,000 feet.",
    "dapr",
    "dapr",
    "Any code or framework...",
    "Any code or framework...",
    "=GO",
    "=GO",
    "Application code",
    "Application code",
    "Microservices written in nodeo",
    "Microservices written in nodeo",
    "python",
    "python",
    ".NET",
    ".NET",
    "\u2192 lava",
    "\u2192 lava",
    "Figure 2-1. Dapr at 20,000 feet.",
    "Figure 2-1. Dapr at 20,000 feet.",
    "In the top row of the figure, note how Dapr provides language-specific SDKs for popular development platforms. Dapr v1.0 includes support for Go, Node.js, Python, .NET, Java, and JavaScript. This book focuses on the Dapr .NET SDK, which also provides direct support for ASP.NET Core integration.",
    "In the top row of the figure, note how Dapr provides language-specific SDKs for popular development platforms. Dapr v1.0 includes support for Go, Node.js, Python, .NET, Java, and JavaScript. This book focuses on the Dapr .NET SDK, which also provides direct support for ASP.NET Core integration.",
    "While language-specific SDKs enhance the developer experience, Dapr is platform agnostic. Under the hood, Dapr",
    "While language-specific SDKs enhance the developer experience, Dapr is platform agnostic. Under the hood, Dapr",
    "The blue boxes across the center of the figure represent the Dapr building blocks. Each exposes a distributed application capability that your application can consume.",
    "The blue boxes across the center of the figure represent the Dapr building blocks. Each exposes a distributed application capability that your application can consume.",
    "The bottom row highlights the portability of Dapr and the diverse environments across which it can run.",
    "The bottom row highlights the portability of Dapr and the diverse environments across which it can run.",
    "At this point, the jet turns around and flies back over Dapr, descending in altitude, giving you a closer look at how Dapr works.",
    "At this point, the jet turns around and flies back over Dapr, descending in altitude, giving you a closer look at how Dapr works.",
    "From the new perspective, you see a more detailed view of the Dapr building blocks .",
    "From the new perspective, you see a more detailed view of the Dapr building blocks .",
    "A building block encapsulates a distributed infrastructure capability. You can access the functionality through the HTTP or gRPC APIs. Figure 2-2 shows the available blocks for Dapr v 1.0.",
    "A building block encapsulates a distributed infrastructure capability. You can access the functionality through the HTTP or gRPC APIs. Figure 2-2 shows the available blocks for Dapr v 1.0.",
    "State management",
    "State management",
    "Publish ",
    "Publish ",
    "subscribe",
    "subscribe",
    "Bindings",
    "Bindings",
    "Extensibility",
    "Extensibility",
    "Figure 2-2. Dapr building blocks.",
    "Figure 2-2. Dapr building blocks.",
    "The following table describes the infrastructure services provided by each block.",
    "The following table describes the infrastructure services provided by each block.",
    "| Building block        | Description                                                                                                |",
    "| Building block        | Description                                                                                                |",
    "Service invocation",
    "Service invocation",
    "Dapr API",
    "Dapr API",
    "HTTP /",
    "HTTP /",
    "gRPC",
    "gRPC",
    "Your service",
    "Your service",
    "| Building block   | Description                                                                              |",
    "| Building block   | Description                                                                              |",
    "Building blocks abstract the implementation of distributed application capabilities from your services. Figure 2-3 shows this interaction.",
    "Building blocks abstract the implementation of distributed application capabilities from your services. Figure 2-3 shows this interaction.",
    "Figure 2-3. Dapr building block integration.",
    "Figure 2-3. Dapr building block integration.",
    "Building blocks invoke Dapr components that provide the concrete implementation for each resource. The code for your service is only aware of the building block. It takes no dependencies on external SDKs or libraries - Dapr handles the plumbing for you. Each building block is independent. You can use one, some, or all of them in your application. As a value-add, Dapr building blocks bake in industry best practices including comprehensive observability.",
    "Building blocks invoke Dapr components that provide the concrete implementation for each resource. The code for your service is only aware of the building block. It takes no dependencies on external SDKs or libraries - Dapr handles the plumbing for you. Each building block is independent. You can use one, some, or all of them in your application. As a value-add, Dapr building blocks bake in industry best practices including comprehensive observability.",
    "We provide detailed explanation and code samples for each Dapr building block in the upcoming chapters. At this point, the jet descends even more. From the new perspective, you now have a closer look at the Dapr components layer.",
    "We provide detailed explanation and code samples for each Dapr building block in the upcoming chapters. At this point, the jet descends even more. From the new perspective, you now have a closer look at the Dapr components layer.",
    "While building blocks expose an API to invoke distributed application capabilities, Dapr components provide the concrete implementation to make it happen.",
    "While building blocks expose an API to invoke distributed application capabilities, Dapr components provide the concrete implementation to make it happen.",
    "Consider, the Dapr state store component. It provides a uniform way to manage state for CRUD operations. Without any change to your service code, you could switch between any of the following Dapr state components:",
    "Consider, the Dapr state store component. It provides a uniform way to manage state for CRUD operations. Without any change to your service code, you could switch between any of the following Dapr state components:",
    "AWS DynamoDB",
    "AWS DynamoDB",
    "Aerospike",
    "Aerospike",
    "Azure Blob Storage",
    "Azure Blob Storage",
    "Azure CosmosDB",
    "Azure CosmosDB",
    "Azure Table Storage",
    "Azure Table Storage",
    "Cassandra",
    "Cassandra",
    "Cloud Firestore (Datastore mode)",
    "Cloud Firestore (Datastore mode)",
    "CloudState",
    "CloudState",
    "Couchbase",
    "Couchbase",
    "Etcd",
    "Etcd",
    "HashiCorp Consul",
    "HashiCorp Consul",
    "Hazelcast",
    "Hazelcast",
    "Memcached",
    "Memcached",
    "MongoDB",
    "MongoDB",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "SQL Server",
    "SQL Server",
    "Zookeeper",
    "Zookeeper",
    "Each component provides the necessary implementation through a common state management interface:",
    "Each component provides the necessary implementation through a common state management interface:",
    "Perhaps you start with Azure Redis Cache as your state store. You specify it with the following configuration:",
    "Perhaps you start with Azure Redis Cache as your state store. You specify it with the following configuration:",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Component  metadata:    name: statestore    namespace: default  spec:    type: state.redis    version: v1    metadata:    - name: redisHost value: ",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Component  metadata:    name: statestore    namespace: default  spec:    type: state.redis    version: v1    metadata:    - name: redisHost value: ",
    "In the spec section, you configure Dapr to use the Redis Cache for state management. The section also contains component-specific metadata. In this case, you can use it to configure additional Redis settings.",
    "In the spec section, you configure Dapr to use the Redis Cache for state management. The section also contains component-specific metadata. In this case, you can use it to configure additional Redis settings.",
    "At a later time, the application is ready to go to production. For the production environment, you may want to change your state management to Azure Table Storage. Azure Table Storage provides state management capabilities that are affordable and highly durable.",
    "At a later time, the application is ready to go to production. For the production environment, you may want to change your state management to Azure Table Storage. Azure Table Storage provides state management capabilities that are affordable and highly durable.",
    "At the time of this writing, the following component types are provided by Dapr:",
    "At the time of this writing, the following component types are provided by Dapr:",
    "| Component         | Description                                                                                                                               |",
    "| Component         | Description                                                                                                                               |",
    "As the jet completes its fly over of Dapr, you look back once more and can see how it connects together.",
    "As the jet completes its fly over of Dapr, you look back once more and can see how it connects together.",
    "Dapr exposes its building blocks and components through a sidecar architecture. A sidecar enables Dapr to run in a separate memory process or separate container alongside your service. Sidecars provide isolation and encapsulation as they aren",
    "Dapr exposes its building blocks and components through a sidecar architecture. A sidecar enables Dapr to run in a separate memory process or separate container alongside your service. Sidecars provide isolation and encapsulation as they aren",
    "Sidecar",
    "Sidecar",
    "Dapr API",
    "Dapr API",
    "dapr",
    "dapr",
    "Component",
    "Component",
    "(Redis Cache)",
    "(Redis Cache)",
    "Figure 2-4. Sidecar architecture.",
    "Figure 2-4. Sidecar architecture.",
    "This pattern is named Sidecar because it resembles a sidecar attached to a motorcycle. In the previous figure, note how the Dapr sidecar is attached to your service to provide distributed application capabilities.",
    "This pattern is named Sidecar because it resembles a sidecar attached to a motorcycle. In the previous figure, note how the Dapr sidecar is attached to your service to provide distributed application capabilities.",
    "Dapr has cross-platform support and can run in many different environments. These environments include Kubernetes, a group of VMs, or edge environments such as Azure IoT Edge.",
    "Dapr has cross-platform support and can run in many different environments. These environments include Kubernetes, a group of VMs, or edge environments such as Azure IoT Edge.",
    "For local development, the easiest way to get started is with self-hosted mode. In self-hosted mode, the microservices and Dapr sidecars run in separate local processes without a container orchestrator such as Kubernetes. For more information, see download and install the Dapr CLI.",
    "For local development, the easiest way to get started is with self-hosted mode. In self-hosted mode, the microservices and Dapr sidecars run in separate local processes without a container orchestrator such as Kubernetes. For more information, see download and install the Dapr CLI.",
    "Figure 2-5 shows an application and Dapr hosted in two separate memory processes communicating via HTTP or gRPC.",
    "Figure 2-5 shows an application and Dapr hosted in two separate memory processes communicating via HTTP or gRPC.",
    "HTTP /",
    "HTTP /",
    "Primary service",
    "Primary service",
    "Your",
    "Your",
    "Pod",
    "Pod",
    "Container",
    "Container",
    "Application",
    "Application",
    "Code",
    "Code",
    "Application",
    "Application",
    "Service",
    "Service",
    "Invocation",
    "Invocation",
    "Pub/Sub",
    "Pub/Sub",
    "State",
    "State",
    "Management",
    "Management",
    "Secrets",
    "Secrets",
    "@ Container",
    "@ Container",
    "Figure 2-5. Self-hosted Dapr sidecar.",
    "Figure 2-5. Self-hosted Dapr sidecar.",
    "By default, Dapr installs Docker containers for Redis and Zipkin to provide default state management and observability. If you don",
    "By default, Dapr installs Docker containers for Redis and Zipkin to provide default state management and observability. If you don",
    "Dapr also runs in containerized environments, such as Kubernetes. Figure 2-6 shows Dapr running in a separate side-car container along with the application container in the same Kubernetes pod.",
    "Dapr also runs in containerized environments, such as Kubernetes. Figure 2-6 shows Dapr running in a separate side-car container along with the application container in the same Kubernetes pod.",
    "Figure 2-6. Kubernetes-hosted Dapr sidecar.",
    "Figure 2-6. Kubernetes-hosted Dapr sidecar.",
    "As you",
    "As you",
    "dapr",
    "dapr",
    "App",
    "App",
    "\"",
    "\"",
    "App",
    "App",
    "\"",
    "\"",
    "dapr",
    "dapr",
    "Sidecar",
    "Sidecar",
    "Figure 2-7. Dapr traffic patterns.",
    "Figure 2-7. Dapr traffic patterns.",
    "Looking at the previous figure, one might question the latency and overhead incurred for each call.",
    "Looking at the previous figure, one might question the latency and overhead incurred for each call.",
    "The Dapr team has invested heavily in performance. A tremendous amount of engineering effort has gone into making Dapr efficient. Calls between Dapr sidecars are always made with gRPC, which delivers high performance and small binary payloads. In most cases, the additional overhead should be sub-millisecond.",
    "The Dapr team has invested heavily in performance. A tremendous amount of engineering effort has gone into making Dapr efficient. Calls between Dapr sidecars are always made with gRPC, which delivers high performance and small binary payloads. In most cases, the additional overhead should be sub-millisecond.",
    "To increase performance, developers can call the Dapr building blocks with gRPC.",
    "To increase performance, developers can call the Dapr building blocks with gRPC.",
    "gRPC is a modern, high-performance framework that evolves the age-old remote procedure call (RPC) protocol. gRPC uses HTTP/2 for its transport protocol, which provides significant performance enhancements over HTTP RESTFul service, including:",
    "gRPC is a modern, high-performance framework that evolves the age-old remote procedure call (RPC) protocol. gRPC uses HTTP/2 for its transport protocol, which provides significant performance enhancements over HTTP RESTFul service, including:",
    "Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.",
    "Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.",
    "Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.",
    "Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.",
    "Built-in streaming enabling requests and responses to asynchronously stream large data sets.",
    "Built-in streaming enabling requests and responses to asynchronously stream large data sets.",
    "To learn more, check out the gRPC overview from the Architecting Cloud-Native .NET Apps for Azure eBook.",
    "To learn more, check out the gRPC overview from the Architecting Cloud-Native .NET Apps for Azure eBook.",
    "Service mesh is another rapidly evolving technology for distributed applications.",
    "Service mesh is another rapidly evolving technology for distributed applications.",
    "A service mesh is a configurable infrastructure layer with built-in capabilities to handle service-toservice communication, resiliency, load balancing, and telemetry capture. It moves the responsibility for these concerns out of the services and into the service mesh layer. Like Dapr, a service mesh also follows a sidecar architecture.",
    "A service mesh is a configurable infrastructure layer with built-in capabilities to handle service-toservice communication, resiliency, load balancing, and telemetry capture. It moves the responsibility for these concerns out of the services and into the service mesh layer. Like Dapr, a service mesh also follows a sidecar architecture.",
    "Figure 2-8 shows an application that implements service mesh technology.",
    "Figure 2-8 shows an application that implements service mesh technology.",
    "microservice",
    "microservice",
    "Sidecar",
    "Sidecar",
    "Sidecar microservice",
    "Sidecar microservice",
    "Figure 2-8. Service mesh with a side car.",
    "Figure 2-8. Service mesh with a side car.",
    "The previous figure shows how messages are intercepted by a sidecar proxy that runs alongside each service. Each proxy can be configured with traffic rules specific to the service. It understands messages and can route them across your services and the outside world.",
    "The previous figure shows how messages are intercepted by a sidecar proxy that runs alongside each service. Each proxy can be configured with traffic rules specific to the service. It understands messages and can route them across your services and the outside world.",
    "So the question becomes, ",
    "So the question becomes, ",
    "While both use a sidecar architecture, each technology has a different purpose. Dapr provides distributed application features. A service mesh provides a dedicated network infrastructure layer.",
    "While both use a sidecar architecture, each technology has a different purpose. Dapr provides distributed application features. A service mesh provides a dedicated network infrastructure layer.",
    "As each works at a different level, both can work together in the same application. For example, a service mesh could provide networking communication between services. Dapr could provide application services such as state management or actor services.",
    "As each works at a different level, both can work together in the same application. For example, a service mesh could provide networking communication between services. Dapr could provide application services such as state management or actor services.",
    "Figure 2-9 shows an application that implements both Dapr and service mesh technology.",
    "Figure 2-9 shows an application that implements both Dapr and service mesh technology.",
    "microservice microservice",
    "microservice microservice",
    "linkerd",
    "linkerd",
    "Service A",
    "Service A",
    "Service mesh",
    "Service mesh",
    "Service B",
    "Service B",
    "Figure 2-9. Dapr and service mesh together.",
    "Figure 2-9. Dapr and service mesh together.",
    "The Dapr online documentation cover Dapr and service mesh integration.",
    "The Dapr online documentation cover Dapr and service mesh integration.",
    "This chapter introduced you to Dapr, a Distributed Application Runtime.",
    "This chapter introduced you to Dapr, a Distributed Application Runtime.",
    "Dapr is an open-source project sponsored by Microsoft with close collaboration from customers and the open-source community.",
    "Dapr is an open-source project sponsored by Microsoft with close collaboration from customers and the open-source community.",
    "At its core, Dapr helps reduce the inherent complexity of distributed microservice applications. It",
    "At its core, Dapr helps reduce the inherent complexity of distributed microservice applications. It",
    "In the next chapters, we present practical, hands-on instruction on how to use Dapr in your applications.",
    "In the next chapters, we present practical, hands-on instruction on how to use Dapr in your applications.",
    "Dapr documentation",
    "Dapr documentation",
    "Learning Dapr",
    "Learning Dapr",
    ".NET Microservices: Architecture for Containerized .NET applications",
    ".NET Microservices: Architecture for Containerized .NET applications",
    "Architecting Cloud-Native .NET Apps for Azure",
    "Architecting Cloud-Native .NET Apps for Azure",
    "In the first two chapters, you learned basic concepts about Dapr. It",
    "In the first two chapters, you learned basic concepts about Dapr. It",
    "You",
    "You",
    "Install the Dapr CLI. It enables you to launch, run, and manage Dapr instances. It also provides debugging support.",
    "Install the Dapr CLI. It enables you to launch, run, and manage Dapr instances. It also provides debugging support.",
    "Install Docker Desktop . If you",
    "Install Docker Desktop . If you",
    "experience. To run Dapr outside of Docker, you can skip this step and execute a slim initialization. The examples in this chapter require you use Docker containers.",
    "experience. To run Dapr outside of Docker, you can skip this step and execute a slim initialization. The examples in this chapter require you use Docker containers.",
    "Initialize Dapr. This step sets up your development environment by installing the latest Dapr binaries and container images.",
    "Initialize Dapr. This step sets up your development environment by installing the latest Dapr binaries and container images.",
    "Install the .NET 7 SDK.",
    "Install the .NET 7 SDK.",
    "Now that Dapr is installed, it",
    "Now that Dapr is installed, it",
    "You",
    "You",
    "Open up the command shell or terminal of your choice. You might consider the terminal capabilities in Visual Studio Code. Navigate to the root folder in which you want to build your application. Once there, enter the following command to create a new .NET Console application:",
    "Open up the command shell or terminal of your choice. You might consider the terminal capabilities in Visual Studio Code. Navigate to the root folder in which you want to build your application. Once there, enter the following command to create a new .NET Console application:",
    "dotnet new console -o DaprCounter",
    "dotnet new console -o DaprCounter",
    "The command scaffolds a simple ",
    "The command scaffolds a simple ",
    "Then, navigate into the new directory created by the previous command:",
    "Then, navigate into the new directory created by the previous command:",
    "Run the newly created application using the dotnet run command. Doing so writes ",
    "Run the newly created application using the dotnet run command. Doing so writes ",
    "Next, you",
    "Next, you",
    "You can invoke Dapr APIs across any development platform using Dapr",
    "You can invoke Dapr APIs across any development platform using Dapr",
    "From the terminal window, add the Dapr.Client NuGet package to your application:",
    "From the terminal window, add the Dapr.Client NuGet package to your application:",
    "Open the Program.cs file in your favorite editor and update its contents to the following code:",
    "Open the Program.cs file in your favorite editor and update its contents to the following code:",
    "The updated code implements the following steps:",
    "The updated code implements the following steps:",
    "First a new ",
    "First a new ",
    "From the state store, ",
    "From the state store, ",
    "The code then iterates, writing the ",
    "The code then iterates, writing the ",
    "The Dapr CLI run command starts the application. It invokes the underlying Dapr runtime and enables both the application and Dapr sidecar to run together. If you omit the app-id , Dapr will generate a unique name for the application. The final segment of the command, dotnet run , instructs the Dapr runtime to run the .NET application.",
    "The Dapr CLI run command starts the application. It invokes the underlying Dapr runtime and enables both the application and Dapr sidecar to run together. If you omit the app-id , Dapr will generate a unique name for the application. The final segment of the command, dotnet run , instructs the Dapr runtime to run the .NET application.",
    "[",
    "[",
    "state key for each key/value pair. If the application id changes, you can no longer access the previously stored state.",
    "state key for each key/value pair. If the application id changes, you can no longer access the previously stored state.",
    "Now run the application with the following command:",
    "Now run the application with the following command:",
    "Try stopping and restarting the application. You",
    "Try stopping and restarting the application. You",
    "You might be wondering, where exactly is the state stored?",
    "You might be wondering, where exactly is the state stored?",
    "When you first initialized Dapr for your local environment, it automatically provisioned a Redis container. Dapr then configured the Redis container as the default state store component with a component configuration file, entitled statestore.yaml . Here",
    "When you first initialized Dapr for your local environment, it automatically provisioned a Redis container. Dapr then configured the Redis container as the default state store component with a component configuration file, entitled statestore.yaml . Here",
    "Note the format of the previous component configuration file:",
    "Note the format of the previous component configuration file:",
    "Each component has a name. In the sample above, the component is named statestore . We used that name in our first code example to tell the Dapr sidecar which component to use.",
    "Each component has a name. In the sample above, the component is named statestore . We used that name in our first code example to tell the Dapr sidecar which component to use.",
    "Each component configuration file has a spec section. It contains a type field that specifies the component type. The version field specifies the component version. The metadata field",
    "Each component configuration file has a spec section. It contains a type field that specifies the component type. The version field specifies the component version. The metadata field",
    "contains information that the component requires, such as connection details and other settings. The metadata values will vary for the different types of components.",
    "contains information that the component requires, such as connection details and other settings. The metadata values will vary for the different types of components.",
    "A Dapr sidecar can consume any Dapr component configured in your application. But, what if you had an architectural justification to limit the accessibility of a component? How could you restrict the Redis component to Dapr sidecars running only in a production environment?",
    "A Dapr sidecar can consume any Dapr component configured in your application. But, what if you had an architectural justification to limit the accessibility of a component? How could you restrict the Redis component to Dapr sidecars running only in a production environment?",
    "To do so, you could define a namespace for the production environment. You might name it production . In self-hosted mode, you specify the namespace of a Dapr sidecar by setting the NAMESPACE environment variable. When configured, the Dapr sidecar will only load the components that match the namespace. For Kubernetes deployments, the Kubernetes namespace determines the components that are loaded. The following sample shows the Redis component placed in a production namespace. Note the namespace declaration in the metadata element:",
    "To do so, you could define a namespace for the production environment. You might name it production . In self-hosted mode, you specify the namespace of a Dapr sidecar by setting the NAMESPACE environment variable. When configured, the Dapr sidecar will only load the components that match the namespace. For Kubernetes deployments, the Kubernetes namespace determines the components that are loaded. The following sample shows the Redis component placed in a production namespace. Note the namespace declaration in the metadata element:",
    "A namespaced component is only accessible to applications running in the same namespace. If your Dapr application fails to load a component, make sure that the application namespace matches the component namespace. This can be especially tricky in self-hosted mode where the application namespace is stored in a NAMESPACE environment variable.",
    "A namespaced component is only accessible to applications running in the same namespace. If your Dapr application fails to load a component, make sure that the application namespace matches the component namespace. This can be especially tricky in self-hosted mode where the application namespace is stored in a NAMESPACE environment variable.",
    "If needed, you could further restrict a component to a particular application. Within the production namespace, you may want to limit access of the Redis cache to only the DaprCounter application. You do so by specifying scopes in the component configuration. The following example shows how to restrict access to the Redis statestore component to the application DaprCounter in the production namespace:",
    "If needed, you could further restrict a component to a particular application. Within the production namespace, you may want to limit access of the Redis cache to only the DaprCounter application. You do so by specifying scopes in the component configuration. The following example shows how to restrict access to the Redis statestore component to the application DaprCounter in the production namespace:",
    "| - value:   | value: localhost:6379 name: redisPassword ",
    "| - value:   | value: localhost:6379 name: redisPassword ",
    "In the first example, you created a simple .NET console application that ran side-by-side with a Dapr sidecar. Modern distributed applications, however, often consist of many moving parts. They can simultaneously run independent microservices. These modern applications are typically containerized and require container orchestration tools such as Docker Compose or Kubernetes.",
    "In the first example, you created a simple .NET console application that ran side-by-side with a Dapr sidecar. Modern distributed applications, however, often consist of many moving parts. They can simultaneously run independent microservices. These modern applications are typically containerized and require container orchestration tools such as Docker Compose or Kubernetes.",
    "In the next example, you",
    "In the next example, you",
    "Make sure you",
    "Make sure you",
    "Additionally, you",
    "Additionally, you",
    "In Visual Studio 2022, create an ASP.NET Core Web App project:",
    "In Visual Studio 2022, create an ASP.NET Core Web App project:",
    "Create a new project",
    "Create a new project",
    "Recent project templates",
    "Recent project templates",
    "A list of your recently accessed templates will be displayed here.",
    "A list of your recently accessed templates will be displayed here.",
    "Search for templates (Alt+S)",
    "Search for templates (Alt+S)",
    "All languages",
    "All languages",
    "All platforms",
    "All platforms",
    "All project types",
    "All project types",
    "Name your project MyFrontEnd and your solution DaprMultiContainer :",
    "Name your project MyFrontEnd and your solution DaprMultiContainer :",
    "P",
    "P",
    "X",
    "X",
    "Configure your new project",
    "Configure your new project",
    "ASP.NET Core Web App c",
    "ASP.NET Core Web App c",
    "Project name",
    "Project name",
    "MyFrontEnd",
    "MyFrontEnd",
    "Location",
    "Location",
    "C:",
    "C:",
    "Solution",
    "Solution",
    "Create new solution",
    "Create new solution",
    "Solution name i",
    "Solution name i",
    "DaprMultiContainer",
    "DaprMultiContainer",
    "Place solution and project in the same directory",
    "Place solution and project in the same directory",
    "Linux macos",
    "Linux macos",
    "Windows",
    "Windows",
    "Cloud",
    "Cloud",
    "Service",
    "Service",
    "Web",
    "Web",
    "In the final dialog, keep the defaults. Don",
    "In the final dialog, keep the defaults. Don",
    "Additional information",
    "Additional information",
    "ASP.NET Core Web App c",
    "ASP.NET Core Web App c",
    "Framework f",
    "Framework f",
    ".NET 6.0 (Long-term support)",
    ".NET 6.0 (Long-term support)",
    "Authentication type O",
    "Authentication type O",
    "None",
    "None",
    "\u2022 Configure for HTTPS O",
    "\u2022 Configure for HTTPS O",
    "L Enable Docker \u00ae",
    "L Enable Docker \u00ae",
    "Docker OS O",
    "Docker OS O",
    "Linux",
    "Linux",
    "Linux macOS",
    "Linux macOS",
    "Windows",
    "Windows",
    "Cloud",
    "Cloud",
    "Service",
    "Service",
    "Web",
    "Web",
    "For the backend, add an ASP.NET Core Web API project to the same solution:",
    "For the backend, add an ASP.NET Core Web API project to the same solution:",
    "Add a new project",
    "Add a new project",
    "Recent project templates a ASP.NET Core Web App",
    "Recent project templates a ASP.NET Core Web App",
    "Search for templates (Alt+S)",
    "Search for templates (Alt+S)",
    "All languages",
    "All languages",
    "All platforms",
    "All platforms",
    "All project types",
    "All project types",
    "Name the project MyBackEnd :",
    "Name the project MyBackEnd :",
    "By default, a Dapr sidecar relies on the network boundary to limit access to its public API. So, clear the checkbox for Configure for HTTPS :",
    "By default, a Dapr sidecar relies on the network boundary to limit access to its public API. So, clear the checkbox for Configure for HTTPS :",
    ">",
    ">",
    "Now, you",
    "Now, you",
    "In Visual Studio, open the Package Manager Console ( Tools ",
    "In Visual Studio, open the Package Manager Console ( Tools ",
    "In the MyFrontEnd project, open the Program.cs file and add a call to builder.Services.AddDaprClient :",
    "In the MyFrontEnd project, open the Program.cs file and add a call to builder.Services.AddDaprClient :",
    "The ",
    "The ",
    "Add a new C# class file named WeatherForecast to the MyFrontEnd project:",
    "Add a new C# class file named WeatherForecast to the MyFrontEnd project:",
    "Open the Index.cshtml.cs file in the Pages folder, and replace its contents with the following code:",
    "Open the Index.cshtml.cs file in the Pages folder, and replace its contents with the following code:",
    "You add Dapr capabilities into the web app by injecting the ",
    "You add Dapr capabilities into the web app by injecting the ",
    "Add Container Orchestrator Support",
    "Add Container Orchestrator Support",
    "Container orchestrator:",
    "Container orchestrator:",
    "Docker Compose",
    "Docker Compose",
    "Replace the contents of the Index.cshtml file in the Pages folder, with the following code. It displays the weather forecasts stored in the view data to the user:",
    "Replace the contents of the Index.cshtml file in the Pages folder, with the following code. It displays the weather forecasts stored in the view data to the user:",
    "In the final part of this example, you",
    "In the final part of this example, you",
    "Right-click the MyFrontEnd project, and choose Add ",
    "Right-click the MyFrontEnd project, and choose Add ",
    "Choose ",
    "Choose ",
    "In the next dialog, select Linux as the Target OS:",
    "In the next dialog, select Linux as the Target OS:",
    "Docker Support Options",
    "Docker Support Options",
    "Target OS:",
    "Target OS:",
    "Linux",
    "Linux",
    "Windows",
    "Windows",
    "Visual Studio creates a ",
    "Visual Studio creates a ",
    "Solution Explorer",
    "Solution Explorer",
    "Search Solution Explorer (Ctrl+;)",
    "Search Solution Explorer (Ctrl+;)",
    "Fa Solution ",
    "Fa Solution ",
    "YML",
    "YML",
    "e",
    "e",
    "C# Program.cs",
    "C# Program.cs",
    "MyFrontEnd",
    "MyFrontEnd",
    "\u2022 wwwroot",
    "\u2022 wwwroot",
    "\u2022 Pages",
    "\u2022 Pages",
    "\u2022 Dockerfile",
    "\u2022 Dockerfile",
    "C# Program.cs",
    "C# Program.cs",
    "\u2022 C# WeatherForecast.cs",
    "\u2022 C# WeatherForecast.cs",
    "4 x",
    "4 x",
    "The ",
    "The ",
    "The ",
    "The ",
    "D",
    "D",
    "D",
    "D",
    "The ",
    "The ",
    "The preceding ",
    "The preceding ",
    "In the MyBackEnd web API project, right-click on the project node, and choose Add ",
    "In the MyBackEnd web API project, right-click on the project node, and choose Add ",
    "In the root of the MyBackEnd project directory, a new Dockerfile was created. The Dockerfile contains the following commands:",
    "In the root of the MyBackEnd project directory, a new Dockerfile was created. The Dockerfile contains the following commands:",
    "Open the ",
    "Open the ",
    "To use Dapr building blocks from inside a containerized application, you",
    "To use Dapr building blocks from inside a containerized application, you",
    "In the updated file, we",
    "In the updated file, we",
    "The sidecars use the ",
    "The sidecars use the ",
    "Each service defined in the Compose file has its own network namespace for network isolation purposes. The sidecars use ",
    "Each service defined in the Compose file has its own network namespace for network isolation purposes. The sidecars use ",
    "The ports on which the Dapr sidecars are listening for gRPC communication (by default 50001) must be exposed to allow the sidecars to communicate with each other.",
    "The ports on which the Dapr sidecars are listening for gRPC communication (by default 50001) must be exposed to allow the sidecars to communicate with each other.",
    "Run the solution (F5 or Ctrl+F5) to verify that it works as expected. If everything is configured correctly, you should see the weather forecast data:",
    "Run the solution (F5 or Ctrl+F5) to verify that it works as expected. If everything is configured correctly, you should see the weather forecast data:",
    "lE Home page - MyFrontEnd",
    "lE Home page - MyFrontEnd",
    "<",
    "<",
    "MyFrontEnd Home Privacy",
    "MyFrontEnd Home Privacy",
    "\u00a9 2021 - MyFrontEnd - Privacy",
    "\u00a9 2021 - MyFrontEnd - Privacy",
    "Running locally with Docker Compose and Visual Studio, you can set breakpoints and debug into the application. For production scenarios, it",
    "Running locally with Docker Compose and Visual Studio, you can set breakpoints and debug into the application. For production scenarios, it",
    "To learn more about the Dapr service invocation building block used in this walkthrough, refer to ",
    "To learn more about the Dapr service invocation building block used in this walkthrough, refer to ",
    "In this chapter, you had an opportunity to test drive Dapr. Using the Dapr .NET SDK, you saw how Dapr integrates with the .NET application platform.",
    "In this chapter, you had an opportunity to test drive Dapr. Using the Dapr .NET SDK, you saw how Dapr integrates with the .NET application platform.",
    "The first example was a simple, stateful, .NET Console application that used the Dapr state management building block.",
    "The first example was a simple, stateful, .NET Console application that used the Dapr state management building block.",
    "The second example involved a multi-container application running in Docker. By using Visual Studio with Docker Compose, you experienced the familiar F5 debugging experience available across all .NET apps.",
    "The second example involved a multi-container application running in Docker. By using Visual Studio with Docker Compose, you experienced the familiar F5 debugging experience available across all .NET apps.",
    "You also got a closer look at Dapr component configuration files. They configure the actual infrastructure implementation used by the Dapr building blocks. You can use namespaces and scopes to restrict component access to particular environments and applications.",
    "You also got a closer look at Dapr component configuration files. They configure the actual infrastructure implementation used by the Dapr building blocks. You can use namespaces and scopes to restrict component access to particular environments and applications.",
    "In the upcoming chapters, you",
    "In the upcoming chapters, you",
    "Dapr documentation - Getting started",
    "Dapr documentation - Getting started",
    "eShopOnDapr",
    "eShopOnDapr",
    "In the first chapters, you",
    "In the first chapters, you",
    "Download the sample application code from the Dapr Traffic Control GitHub repo. This repository contains a detailed description on how you can run the sample application on your machine.",
    "Download the sample application code from the Dapr Traffic Control GitHub repo. This repository contains a detailed description on how you can run the sample application on your machine.",
    "The Traffic Control sample application simulates a highway traffic control system. Its purpose is to detect speeding vehicles and send the offending driver a fine notice. These systems actually exist in real life and here",
    "The Traffic Control sample application simulates a highway traffic control system. Its purpose is to detect speeding vehicles and send the offending driver a fine notice. These systems actually exist in real life and here",
    "Although the simulation is simple, responsibilities within the system are separated into several microservices. Figure 4.1 shows an overview of the services that are part of the application:",
    "Although the simulation is simple, responsibilities within the system are separated into several microservices. Figure 4.1 shows an overview of the services that are part of the application:",
    "Camera",
    "Camera",
    "Simulation",
    "Simulation",
    "Service",
    "Service",
    "/entrycam",
    "/entrycam",
    "/collectfine",
    "/collectfine",
    "/vehicleinfo",
    "/vehicleinfo",
    "Interval",
    "Interval",
    "Camera",
    "Camera",
    "Simulation",
    "Simulation",
    "POST /entrycam",
    "POST /entrycam",
    "Figure 4-1. The services in the sample application.",
    "Figure 4-1. The services in the sample application.",
    "Store",
    "Store",
    "The Camera Simulation is a console application that simulates vehicles and sends messages to the TrafficControl service. Every simulated car invokes both the entry and exit service endpoints.",
    "The Camera Simulation is a console application that simulates vehicles and sends messages to the TrafficControl service. Every simulated car invokes both the entry and exit service endpoints.",
    "The TrafficControl service is an ASP.NET Core Web API application that exposes the /entrycam and /exitcam endpoints. Invoking an endpoint simulates a car passing under one of the entryor exit-cameras respectively. The request message payload simply contains the license plate of the car (no actual OCR is implemented).",
    "The TrafficControl service is an ASP.NET Core Web API application that exposes the /entrycam and /exitcam endpoints. Invoking an endpoint simulates a car passing under one of the entryor exit-cameras respectively. The request message payload simply contains the license plate of the car (no actual OCR is implemented).",
    "The FineCollection service is an ASP.NET Core Web API application that offers 1 endpoint: /collectfine . Invoking this endpoint will send a fine notice to the driver of the speeding vehicle. The payload of the request contains all the information about the speeding violation.",
    "The FineCollection service is an ASP.NET Core Web API application that offers 1 endpoint: /collectfine . Invoking this endpoint will send a fine notice to the driver of the speeding vehicle. The payload of the request contains all the information about the speeding violation.",
    "Fine",
    "Fine",
    "The VehicleRegistration service is an ASP.NET Core Web API application that offers 1 endpoint: /vehicleinfo/{licensenumber} . It",
    "The VehicleRegistration service is an ASP.NET Core Web API application that offers 1 endpoint: /vehicleinfo/{licensenumber} . It",
    "The sequence diagram in figure 4.2 shows the simulation flow:",
    "The sequence diagram in figure 4.2 shows the simulation flow:",
    "Figure 4-2. Sequence diagram of the simulation flow.",
    "Figure 4-2. Sequence diagram of the simulation flow.",
    "The services communicate by directly i nvoking each other",
    "The services communicate by directly i nvoking each other",
    "Random",
    "Random",
    "Traffic Control",
    "Traffic Control",
    "Service",
    "Service",
    "Fine Collection",
    "Fine Collection",
    "Service",
    "Service",
    "Vehicle Registration",
    "Vehicle Registration",
    "Service",
    "Service",
    "The biggest challenge is that the call-chain will break if one of the services is off-line. Decoupling services by replacing direct calls with asynchronous messaging would solve this issue. Asynchronous messaging is typically implemented with a message broker like RabbitMQ or Azure Service Bus.",
    "The biggest challenge is that the call-chain will break if one of the services is off-line. Decoupling services by replacing direct calls with asynchronous messaging would solve this issue. Asynchronous messaging is typically implemented with a message broker like RabbitMQ or Azure Service Bus.",
    "Another drawback is that the vehicle state for every vehicle is stored in memory in the TrafficControl service. This state is lost when the service is restarted after an update or a crash. To increase system durability, state should be stored outside the service.",
    "Another drawback is that the vehicle state for every vehicle is stored in memory in the TrafficControl service. This state is lost when the service is restarted after an update or a crash. To increase system durability, state should be stored outside the service.",
    "One of the goals of Dapr is to provide cloud-native capabilities for microservices applications. The Traffic Control application uses Dapr building blocks to increase robustness and mitigate the design drawbacks described in the previous paragraph. Figure 4.shows a Dapr-enabled version of the traffic control application:",
    "One of the goals of Dapr is to provide cloud-native capabilities for microservices applications. The Traffic Control application uses Dapr building blocks to increase robustness and mitigate the design drawbacks described in the previous paragraph. Figure 4.shows a Dapr-enabled version of the traffic control application:",
    "Figure 4-3. Traffic Control application with Dapr building blocks.",
    "Figure 4-3. Traffic Control application with Dapr building blocks.",
    "Service invocation The Dapr service invocation building block handles request/response communication between the FineCollectionService and the VehicleRegistrationService. Because the call is a query to retrieve required data to complete the operation, a synchronous call is acceptable here. The service invocation building block provides service discovery. The FineCollection service no longer has to know where the VehicleRegistration service lives. It also implements automatic retries if the VehicleRegistration service is off-line.",
    "Service invocation The Dapr service invocation building block handles request/response communication between the FineCollectionService and the VehicleRegistrationService. Because the call is a query to retrieve required data to complete the operation, a synchronous call is acceptable here. The service invocation building block provides service discovery. The FineCollection service no longer has to know where the VehicleRegistration service lives. It also implements automatic retries if the VehicleRegistration service is off-line.",
    "Publish ",
    "Publish ",
    "State management The TrafficControl service uses the state management building block to persist vehicle state outside of the service in a Redis cache. As with pub/sub, developers don",
    "State management The TrafficControl service uses the state management building block to persist vehicle state outside of the service in a Redis cache. As with pub/sub, developers don",
    "Output binding The FineCollection service sends fines to the owners of speeding vehicles by email. The Dapr output binding for SMTP abstracts the email transmission using the SMTP protocol.",
    "Output binding The FineCollection service sends fines to the owners of speeding vehicles by email. The Dapr output binding for SMTP abstracts the email transmission using the SMTP protocol.",
    "Input binding The CameraSimulation sends messages with simulated car info to the TrafficControl service using the MQTT protocol. It uses a .NET MQTT library for sending messages to Mosquitto - a lightweight MQTT broker. The TrafficControl service uses the Dapr input binding for MQTT to subscribe to the MQTT broker and receive messages.",
    "Input binding The CameraSimulation sends messages with simulated car info to the TrafficControl service using the MQTT protocol. It uses a .NET MQTT library for sending messages to Mosquitto - a lightweight MQTT broker. The TrafficControl service uses the Dapr input binding for MQTT to subscribe to the MQTT broker and receive messages.",
    "Secrets management The FineCollectionService needs credentials for connecting to the smtp server and a license-key for a fine calculator component it uses internally. It uses the secrets management building block to obtain the credentials and the license-key.",
    "Secrets management The FineCollectionService needs credentials for connecting to the smtp server and a license-key for a fine calculator component it uses internally. It uses the secrets management building block to obtain the credentials and the license-key.",
    "camera",
    "camera",
    "Simulation",
    "Simulation",
    "Mosquitto",
    "Mosquitto",
    "VehicleRegistered",
    "VehicleRegistered",
    "Random",
    "Random",
    "Interval",
    "Interval",
    "VehicleRegistered",
    "VehicleRegistered",
    "dapr",
    "dapr",
    "Sidecar",
    "Sidecar",
    "VehicleRegistered",
    "VehicleRegistered",
    "POST /entrycam",
    "POST /entrycam",
    "Store vehicle state",
    "Store vehicle state",
    "Store vehicle state",
    "Store vehicle state",
    "Actors The TrafficControlService has an alternative implementation based on Dapr actors. In this implementation, the TrafficControl service creates a new actor for every vehicle that is registered by the entry camera. The license number of the vehicle forms the unique actor Id. The actor encapsulates the vehicle state, which it persists in the Redis cache. When a vehicle is registered by the exit camera, it invokes the actor. The actor then calculate the average speed and possibly issue a speeding violation.",
    "Actors The TrafficControlService has an alternative implementation based on Dapr actors. In this implementation, the TrafficControl service creates a new actor for every vehicle that is registered by the entry camera. The license number of the vehicle forms the unique actor Id. The actor encapsulates the vehicle state, which it persists in the Redis cache. When a vehicle is registered by the exit camera, it invokes the actor. The actor then calculate the average speed and possibly issue a speeding violation.",
    "Speeding Violation",
    "Speeding Violation",
    "Figure 4.4 shows a sequence diagram of the flow of the simulation with all the Dapr building blocks in place: Calculate Fine invoke vehilcleinto/KL-714-V",
    "Figure 4.4 shows a sequence diagram of the flow of the simulation with all the Dapr building blocks in place: Calculate Fine invoke vehilcleinto/KL-714-V",
    "invoke vehicleinfo/KL-714-V",
    "invoke vehicleinfo/KL-714-V",
    "Figure 4-4. Sequence diagram of simulation flow with Dapr building blocks.",
    "Figure 4-4. Sequence diagram of simulation flow with Dapr building blocks.",
    "The rest of this book features a chapter for each of the Dapr building blocks. Each chapter explains in detail how the building block works, its configuration, and how to use it. Each chapter explains how the Traffic Control sample application uses the building block.",
    "The rest of this book features a chapter for each of the Dapr building blocks. Each chapter explains in detail how the building block works, its configuration, and how to use it. Each chapter explains how the Traffic Control sample application uses the building block.",
    "The Traffic Control sample application can run in self-hosted mode or in Kubernetes.",
    "The Traffic Control sample application can run in self-hosted mode or in Kubernetes.",
    "The sample repository contains PowerShell scripts to start the infrastructure services (Redis, RabbitMQ, and Mosquitto) as Docker containers on your machine. They",
    "The sample repository contains PowerShell scripts to start the infrastructure services (Redis, RabbitMQ, and Mosquitto) as Docker containers on your machine. They",
    "Traffic",
    "Traffic",
    "Control",
    "Control",
    "Service",
    "Service",
    "Redis",
    "Redis",
    "RabbitMQ",
    "RabbitMQ",
    "dapi",
    "dapi",
    "Sidecar",
    "Sidecar",
    "Fine",
    "Fine",
    "Collection",
    "Collection",
    "Service dap",
    "Service dap",
    "Sidecar",
    "Sidecar",
    "Vehicle",
    "Vehicle",
    "Registration",
    "Registration",
    "Service",
    "Service",
    "MailDev",
    "MailDev",
    "The src/k8s folder in the sample repository contains the Kubernetes manifest files to run the application (including the infrastructure services) with Dapr in Kubernetes. This folder also contains a start.ps1 and stop.ps1 PowerShell script to start and stop the solution in Kubernetes. All services will run in the dapr-trafficcontrol namespace.",
    "The src/k8s folder in the sample repository contains the Kubernetes manifest files to run the application (including the infrastructure services) with Dapr in Kubernetes. This folder also contains a start.ps1 and stop.ps1 PowerShell script to start and stop the solution in Kubernetes. All services will run in the dapr-trafficcontrol namespace.",
    "The Traffic Control sample application is a microservices application that simulates a highway speed trap.",
    "The Traffic Control sample application is a microservices application that simulates a highway speed trap.",
    "The application uses several Dapr building blocks to make it robust and cloud-native. The domain is kept simple to keep the focus on Dapr.",
    "The application uses several Dapr building blocks to make it robust and cloud-native. The domain is kept simple to keep the focus on Dapr.",
    "The application will be used in the following chapters that focus on Dapr building block.",
    "The application will be used in the following chapters that focus on Dapr building block.",
    "Dapr Traffic Control Sample",
    "Dapr Traffic Control Sample",
    "Distributed applications are composed of independent services. While each service should be stateless, some services must track state to complete business operations. Consider a shopping basket service for an eCommerce site. If the service can",
    "Distributed applications are composed of independent services. While each service should be stateless, some services must track state to complete business operations. Consider a shopping basket service for an eCommerce site. If the service can",
    "To try out the state management building block, have a look at the counter application sample in chapter 3.",
    "To try out the state management building block, have a look at the counter application sample in chapter 3.",
    "Tracking state in a distributed application can be challenging. For example:",
    "Tracking state in a distributed application can be challenging. For example:",
    "The application may require different types of data stores.",
    "The application may require different types of data stores.",
    "Different consistency levels may be required for accessing and updating data.",
    "Different consistency levels may be required for accessing and updating data.",
    "Multiple users may update data at the same time, requiring conflict resolution.",
    "Multiple users may update data at the same time, requiring conflict resolution.",
    "Services must retry any short-lived transient errors that occur while interacting with the data store.",
    "Services must retry any short-lived transient errors that occur while interacting with the data store.",
    "The Dapr state management building block addresses these challenges. It streamlines tracking state without dependencies or a learning curve on third-party storage SDKs.",
    "The Dapr state management building block addresses these challenges. It streamlines tracking state without dependencies or a learning curve on third-party storage SDKs.",
    "Dapr state management offers a key/value API. The feature doesn",
    "Dapr state management offers a key/value API. The feature doesn",
    "The application interacts with a Dapr sidecar to store and retrieve key/value data. Under the hood, the sidecar API consumes a configurable state store component to persist data. Developers can choose from a growing collection of supported state stores that include Azure Cosmos DB, SQL Server, and Cassandra.",
    "The application interacts with a Dapr sidecar to store and retrieve key/value data. Under the hood, the sidecar API consumes a configurable state store component to persist data. Developers can choose from a growing collection of supported state stores that include Azure Cosmos DB, SQL Server, and Cassandra.",
    "The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "<",
    "<",
    "<",
    "<",
    "Figure 5-1 shows how a Dapr-enabled shopping basket service stores a key/value pair using the Dapr state store component named statestore .",
    "Figure 5-1 shows how a Dapr-enabled shopping basket service stores a key/value pair using the Dapr state store component named statestore .",
    ":::image type=",
    ":::image type=",
    "Figure 5-1. Storing a key/value pair in a Dapr state store.",
    "Figure 5-1. Storing a key/value pair in a Dapr state store.",
    "Note the steps in the previous figure:",
    "Note the steps in the previous figure:",
    "The basket service calls the state management API on the Dapr sidecar. The body of the request encloses a JSON array that can contain multiple key/value pairs.",
    "The basket service calls the state management API on the Dapr sidecar. The body of the request encloses a JSON array that can contain multiple key/value pairs.",
    "The Dapr sidecar determines the state store based on the component configuration file. In this case, it",
    "The Dapr sidecar determines the state store based on the component configuration file. In this case, it",
    "The sidecar persists the data to the Redis cache.",
    "The sidecar persists the data to the Redis cache.",
    "Retrieving the stored data is a similar API call. In the example below, a curl command retrieves the data by calling the Dapr sidecar API:",
    "Retrieving the stored data is a similar API call. In the example below, a curl command retrieves the data by calling the Dapr sidecar API:",
    "The command returns the stored state in the response body:",
    "The command returns the stored state in the response body:",
    "The following sections explain how to use the more advanced features of the state management building block.",
    "The following sections explain how to use the more advanced features of the state management building block.",
    "The CAP theorem is a set of principles that apply to distributed systems that store state. Figure 5-2 shows the three properties of the CAP theorem.",
    "The CAP theorem is a set of principles that apply to distributed systems that store state. Figure 5-2 shows the three properties of the CAP theorem.",
    ":::image type=",
    ":::image type=",
    "Figure 5-2. The CAP theorem.",
    "Figure 5-2. The CAP theorem.",
    "The theorem states that distributed data systems offer a trade-off between consistency, availability, and partition tolerance. And, that any datastore can only guarantee two of the three properties :",
    "The theorem states that distributed data systems offer a trade-off between consistency, availability, and partition tolerance. And, that any datastore can only guarantee two of the three properties :",
    "Consistency ( C ). Every node in the cluster responds with the most recent data, even if the system must block the request until all replicas update. If you query a ",
    "Consistency ( C ). Every node in the cluster responds with the most recent data, even if the system must block the request until all replicas update. If you query a ",
    "Availability ( A ). Every node returns an immediate response, even if that response isn",
    "Availability ( A ). Every node returns an immediate response, even if that response isn",
    "Partition Tolerance ( P ). Guarantees the system continues to operate even if a replicated data node fails or loses connectivity with other replicated data nodes.",
    "Partition Tolerance ( P ). Guarantees the system continues to operate even if a replicated data node fails or loses connectivity with other replicated data nodes.",
    "Distributed applications must handle the P property. As services communicate among each other with network calls, network disruptions ( P ) will occur. With that in mind, distributed applications must either be AP or CP .",
    "Distributed applications must handle the P property. As services communicate among each other with network calls, network disruptions ( P ) will occur. With that in mind, distributed applications must either be AP or CP .",
    "AP applications choose availability over consistency. Dapr supports this choice with its eventual consistency strategy. Consider an underlying data store, such as Azure CosmosDB, which stores redundant data on multiple replicas. With eventual consistency, the state store writes the update to one replica and completes the write request with the client. After this time, the store will asynchronously update its replicas. Read requests can return data from any of the replicas, including those replicas that haven",
    "AP applications choose availability over consistency. Dapr supports this choice with its eventual consistency strategy. Consider an underlying data store, such as Azure CosmosDB, which stores redundant data on multiple replicas. With eventual consistency, the state store writes the update to one replica and completes the write request with the client. After this time, the store will asynchronously update its replicas. Read requests can return data from any of the replicas, including those replicas that haven",
    "CP applications choose consistency over availability. Dapr supports this choice with its strong consistency strategy. In this scenario, the state store will synchronously update all (or, in some cases, a quorum of) required replicas before completing the write request. Read operations will return the most up-to-date data consistently across replicas.",
    "CP applications choose consistency over availability. Dapr supports this choice with its strong consistency strategy. In this scenario, the state store will synchronously update all (or, in some cases, a quorum of) required replicas before completing the write request. Read operations will return the most up-to-date data consistently across replicas.",
    "The consistency level for a state operation is specified by attaching a consistency hint to the operation. The following curl command writes a Hello=World key/value pair to a state store using a strong consistency hint:",
    "The consistency level for a state operation is specified by attaching a consistency hint to the operation. The following curl command writes a Hello=World key/value pair to a state store using a strong consistency hint:",
    "It is up to the Dapr state store component to fulfill the consistency hint attached to the operation. Not all data stores support both consistency levels. If no consistency hint is set, the default behavior is eventual .",
    "It is up to the Dapr state store component to fulfill the consistency hint attached to the operation. Not all data stores support both consistency levels. If no consistency hint is set, the default behavior is eventual .",
    "In a multiuser application, there",
    "In a multiuser application, there",
    "Dapr supports optimistic concurrency control (OCC) using ETags. An ETag is a value associated with a specific version of a stored key/value pair. Each time a key/value pair updates, the ETag value updates as well. When a client retrieves a key/value pair, the response includes the current ETag value. When a client updates or deletes a key/value pair, it must send that ETag value back in the request body. If another client has updated the data in the meantime, the ETags won",
    "Dapr supports optimistic concurrency control (OCC) using ETags. An ETag is a value associated with a specific version of a stored key/value pair. Each time a key/value pair updates, the ETag value updates as well. When a client retrieves a key/value pair, the response includes the current ETag value. When a client updates or deletes a key/value pair, it must send that ETag value back in the request body. If another client has updated the data in the meantime, the ETags won",
    "Dapr also supports a last-write-wins strategy. With this approach, the client doesn",
    "Dapr also supports a last-write-wins strategy. With this approach, the client doesn",
    "Dapr can write multi-item changes to a data store as a single operation implemented as a transaction. This functionality is only available for data stores that support ACID transactions. At the time of this writing, these stores include Redis, MongoDB, PostgreSQL, SQL Server, and Azure CosmosDB.",
    "Dapr can write multi-item changes to a data store as a single operation implemented as a transaction. This functionality is only available for data stores that support ACID transactions. At the time of this writing, these stores include Redis, MongoDB, PostgreSQL, SQL Server, and Azure CosmosDB.",
    "In the example below, a multi-item operation is sent to the state store in a single transaction. All operations must succeed for the transaction to commit. If one or more of the operations fail, the entire transaction rolls back.",
    "In the example below, a multi-item operation is sent to the state store in a single transaction. All operations must succeed for the transaction to commit. If one or more of the operations fail, the entire transaction rolls back.",
    "For data stores that don",
    "For data stores that don",
    "For bulk operations, Dapr will submit each key/value pair update as a separate request to the data store.",
    "For bulk operations, Dapr will submit each key/value pair update as a separate request to the data store.",
    "The Dapr .NET SDK provides language-specific support for the .NET platform. Developers can use the DaprClient class introduced in chapter 3 to read and write data. The following example shows how to use the DaprClient.GetStateAsync",
    "The Dapr .NET SDK provides language-specific support for the .NET platform. Developers can use the DaprClient class introduced in chapter 3 to read and write data. The following example shows how to use the DaprClient.GetStateAsync",
    "If the state store contains no data for key AMS , the result will be default(WeatherForecast) .",
    "If the state store contains no data for key AMS , the result will be default(WeatherForecast) .",
    "To write data to the data store, use the DaprClient.SaveStateAsync",
    "To write data to the data store, use the DaprClient.SaveStateAsync",
    "The example uses the last-write-wins strategy as an ETag value isn",
    "The example uses the last-write-wins strategy as an ETag value isn",
    "The DaprClient.TrySaveStateAsync method fails when the data (and associated ETag) has been changed in the state store after the data was retrieved. The method returns a boolean value to indicate whether the call succeeded. A strategy to handle the failure is to simply reload the updated data from the state store, make the change again, and resubmit the update.",
    "The DaprClient.TrySaveStateAsync method fails when the data (and associated ETag) has been changed in the state store after the data was retrieved. The method returns a boolean value to indicate whether the call succeeded. A strategy to handle the failure is to simply reload the updated data from the state store, make the change again, and resubmit the update.",
    "If you always want a write to succeed regardless of other changes to the data, use the last-write-wins strategy.",
    "If you always want a write to succeed regardless of other changes to the data, use the last-write-wins strategy.",
    "The SDK provides other methods to retrieve data in bulk, delete data, and execute transactions. For more information, see the Dapr .NET SDK repository.",
    "The SDK provides other methods to retrieve data in bulk, delete data, and execute transactions. For more information, see the Dapr .NET SDK repository.",
    "Dapr also supports ASP.NET Core, a cross-platform framework for building modern cloud-based web applications. The Dapr SDK integrates state management capabilities directly into the ASP.NET Core model binding capabilities. Configuration is simple. In the Program.cs file, call the following extension method on the WebApplication builder:",
    "Dapr also supports ASP.NET Core, a cross-platform framework for building modern cloud-based web applications. The Dapr SDK integrates state management capabilities directly into the ASP.NET Core model binding capabilities. Configuration is simple. In the Program.cs file, call the following extension method on the WebApplication builder:",
    "Once configured, Dapr can inject a key/value pair directly into a controller action using the ASP.NET Core FromState attribute. Referencing the DaprClient object is no longer necessary. The next example shows a Web API that returns the weather forecast for a given city:",
    "Once configured, Dapr can inject a key/value pair directly into a controller action using the ASP.NET Core FromState attribute. Referencing the DaprClient object is no longer necessary. The next example shows a Web API that returns the weather forecast for a given city:",
    "In the example, the controller loads the weather forecast using the FromState attribute. The first attribute parameter is the state store, statestore . The second attribute parameter, city , is the name of the route template variable to get the state key. If you omit the second parameter, the name of the bound method parameter ( forecast ) is used to look up the route template variable.",
    "In the example, the controller loads the weather forecast using the FromState attribute. The first attribute parameter is the state store, statestore . The second attribute parameter, city , is the name of the route template variable to get the state key. If you omit the second parameter, the name of the bound method parameter ( forecast ) is used to look up the route template variable.",
    "The StateEntry class contains properties for all the information that is retrieved for a single key/value pair: StoreName , Key , Value , and ETag . The ETag is useful for implementing optimistic concurrency control (OCC) strategy. The class also provides methods to delete or update retrieved key/value data without requiring a DaprClient instance. In the next example, the TrySaveAsync method is used to update the retrieved weather forecast using OCC.",
    "The StateEntry class contains properties for all the information that is retrieved for a single key/value pair: StoreName , Key , Value , and ETag . The ETag is useful for implementing optimistic concurrency control (OCC) strategy. The class also provides methods to delete or update retrieved key/value data without requiring a DaprClient instance. In the next example, the TrySaveAsync method is used to update the retrieved weather forecast using OCC.",
    "At the time of this writing, Dapr provides support for the following transactional state stores:",
    "At the time of this writing, Dapr provides support for the following transactional state stores:",
    "Azure CosmosDB",
    "Azure CosmosDB",
    "Azure SQL Server",
    "Azure SQL Server",
    "CockroachDB",
    "CockroachDB",
    "In Memory",
    "In Memory",
    "MongoDB",
    "MongoDB",
    "MySQL",
    "MySQL",
    "Oracle Database",
    "Oracle Database",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "Dapr also includes support for state stores that support CRUD operations, but not transactional capabilities:",
    "Dapr also includes support for state stores that support CRUD operations, but not transactional capabilities:",
    "Aerospike",
    "Aerospike",
    "Apache Cassandra",
    "Apache Cassandra",
    "AWS DynamoDB",
    "AWS DynamoDB",
    "Azure Blob Storage",
    "Azure Blob Storage",
    "Azure Table Storage",
    "Azure Table Storage",
    "Couchbase",
    "Couchbase",
    "GCP Firestore",
    "GCP Firestore",
    "Hashicorp Consul",
    "Hashicorp Consul",
    "Hazelcast",
    "Hazelcast",
    "JetStream KV",
    "JetStream KV",
    "Memcached",
    "Memcached",
    "Oracle Object Storage",
    "Oracle Object Storage",
    "Zookeeper",
    "Zookeeper",
    "When initialized for local, self-hosted development, Dapr registers Redis as the default state store. Here",
    "When initialized for local, self-hosted development, Dapr registers Redis as the default state store. Here",
    "[",
    "[",
    "The Redis state store requires redisHost and redisPassword metadata to connect to the Redis instance. In the example above, the Redis password (which is an empty string by default) is stored as a plain string. The best practice is to avoid clear-text strings and always use secret references. To learn more about secret management, see chapter 10.",
    "The Redis state store requires redisHost and redisPassword metadata to connect to the Redis instance. In the example above, the Redis password (which is an empty string by default) is stored as a plain string. The best practice is to avoid clear-text strings and always use secret references. To learn more about secret management, see chapter 10.",
    "The other metadata field, actorStateStore , indicates whether the state store can be consumed by the actors building block.",
    "The other metadata field, actorStateStore , indicates whether the state store can be consumed by the actors building block.",
    "State store components enable different strategies to store key/value pairs in the underlying store. Recall the earlier example of a shopping basket service storing items a customer wishes to purchase:",
    "State store components enable different strategies to store key/value pairs in the underlying store. Recall the earlier example of a shopping basket service storing items a customer wishes to purchase:",
    "Using the Redis Console tool, look inside the Redis cache to see how the Redis state store component persisted the data:",
    "Using the Redis Console tool, look inside the Redis cache to see how the Redis state store component persisted the data:",
    "The output shows the full Redis key for the data as basketservice||basket1 . By default, Dapr uses the application id of the Dapr instance ( basketservice ) as a prefix for the key. This naming convention enables multiple Dapr instances to share the same data store without key name collisions. For the developer, it",
    "The output shows the full Redis key for the data as basketservice||basket1 . By default, Dapr uses the application id of the Dapr instance ( basketservice ) as a prefix for the key. This naming convention enables multiple Dapr instances to share the same data store without key name collisions. For the developer, it",
    "That said, it",
    "That said, it",
    "A constant key prefix enables the state store to be accessed across multiple Dapr applications. What",
    "A constant key prefix enables the state store to be accessed across multiple Dapr applications. What",
    "In the Dapr Traffic Control sample app, the TrafficControl service uses the Dapr state management building block to persist the entry and exit timestamps of each passing vehicle. Figure 5-3 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr state management building block is used in flows marked with number 3 in the diagram:",
    "In the Dapr Traffic Control sample app, the TrafficControl service uses the Dapr state management building block to persist the entry and exit timestamps of each passing vehicle. Figure 5-3 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr state management building block is used in flows marked with number 3 in the diagram:",
    ":::image type=",
    ":::image type=",
    "Figure 5-3. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 5-3. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Entry and exit event logic is handled by the TrafficController class, an ordinary ASP.NET Controller. The TrafficController.VehicleEntry method accepts an incoming VehicleRegistered message and saves the enclosed vehicle state:",
    "Entry and exit event logic is handled by the TrafficController class, an ordinary ASP.NET Controller. The TrafficController.VehicleEntry method accepts an incoming VehicleRegistered message and saves the enclosed vehicle state:",
    "In the preceding code snippet, the abstraction ",
    "In the preceding code snippet, the abstraction ",
    "As the preceding code snippet shows, the implementation of the DaprVehicleStateRepository class is pretty straightforward. The SaveVehicleStateAsync method uses the injected DaprClient object",
    "As the preceding code snippet shows, the implementation of the DaprVehicleStateRepository class is pretty straightforward. The SaveVehicleStateAsync method uses the injected DaprClient object",
    "to save the state to the configured Dapr state store. It uses the vehicle",
    "to save the state to the configured Dapr state store. It uses the vehicle",
    "The TrafficControl service uses Redis as its underlying data store. Looking at the code, you",
    "The TrafficControl service uses Redis as its underlying data store. Looking at the code, you",
    "The component configuration file includes an element secretKeyRef . The application uses it to reference the Redis password value from the Dapr secrets building block. See chapter 10 to learn more about managing secrets with Dapr.",
    "The component configuration file includes an element secretKeyRef . The application uses it to reference the Redis password value from the Dapr secrets building block. See chapter 10 to learn more about managing secrets with Dapr.",
    "The type element in the configuration, state.redis instructs the building block to manage state with Dapr Redis component.",
    "The type element in the configuration, state.redis instructs the building block to manage state with Dapr Redis component.",
    "The scopes element in the configuration constrains application access to the state store component. Only the TrafficControl service can access the state store.",
    "The scopes element in the configuration constrains application access to the state store component. Only the TrafficControl service can access the state store.",
    "The Dapr state management building block offers an API for storing key/value data across various data stores. The API provides support for:",
    "The Dapr state management building block offers an API for storing key/value data across various data stores. The API provides support for:",
    "Bulk operations",
    "Bulk operations",
    "Strong and eventual consistency",
    "Strong and eventual consistency",
    "Optimistic concurrency control",
    "Optimistic concurrency control",
    "Multi-item transactions",
    "Multi-item transactions",
    "The .NET SDK provides language-specific support for .NET and ASP.NET Core. Model binding integration simplifies accessing and updating state from ASP.NET Core controller action methods.",
    "The .NET SDK provides language-specific support for .NET and ASP.NET Core. Model binding integration simplifies accessing and updating state from ASP.NET Core controller action methods.",
    "In the Dapr Traffic Control sample application, the benefits of using Dapr state management are clear:",
    "In the Dapr Traffic Control sample application, the benefits of using Dapr state management are clear:",
    "It abstracts away the complexity of using third-party SDKs, such as StackExchange.Redis .",
    "It abstracts away the complexity of using third-party SDKs, such as StackExchange.Redis .",
    "Replacing the underlying Redis cache with a different type of data store only requires changes to the component configuration file.",
    "Replacing the underlying Redis cache with a different type of data store only requires changes to the component configuration file.",
    "Dapr supported state stores",
    "Dapr supported state stores",
    "Across a distributed system, one service often needs to communicate with another to complete a business operation. The Dapr service invocation building block can help streamline the communication between services.",
    "Across a distributed system, one service often needs to communicate with another to complete a business operation. The Dapr service invocation building block can help streamline the communication between services.",
    "Making calls between services in a distributed application may appear easy, but there are many challenges involved. For example:",
    "Making calls between services in a distributed application may appear easy, but there are many challenges involved. For example:",
    "Where the other services are located.",
    "Where the other services are located.",
    "How to call a service securely, given the service address.",
    "How to call a service securely, given the service address.",
    "How to handle retries when short-lived transient errors occur.",
    "How to handle retries when short-lived transient errors occur.",
    "Lastly, as distributed applications compose many different services, capturing insights across service call graphs are critical to diagnosing production issues.",
    "Lastly, as distributed applications compose many different services, capturing insights across service call graphs are critical to diagnosing production issues.",
    "The service invocation building block addresses these challenges by using a Dapr sidecar as a reverse proxy for your service.",
    "The service invocation building block addresses these challenges by using a Dapr sidecar as a reverse proxy for your service.",
    "Let",
    "Let",
    "GET http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "GET http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "Service A",
    "Service A",
    "Service B",
    "Service B",
    "Figure 6-1. How Dapr service invocation works.",
    "Figure 6-1. How Dapr service invocation works.",
    "Note the steps from the previous figure:",
    "Note the steps from the previous figure:",
    "Service A makes a call to the catalog/items endpoint in Service B by invoking the service invocation API on the Service A sidecar.",
    "Service A makes a call to the catalog/items endpoint in Service B by invoking the service invocation API on the Service A sidecar.",
    "[",
    "[",
    "The Service A sidecar forwards the request to the Service B sidecar.",
    "The Service A sidecar forwards the request to the Service B sidecar.",
    "The Service B sidecar makes the actual catalog/items request against the Service B API.",
    "The Service B sidecar makes the actual catalog/items request against the Service B API.",
    "Service B executes the request and returns a response back to its sidecar.",
    "Service B executes the request and returns a response back to its sidecar.",
    "The Service B sidecar forwards the response back to the Service A sidecar.",
    "The Service B sidecar forwards the response back to the Service A sidecar.",
    "The Service A sidecar returns the response back to Service A.",
    "The Service A sidecar returns the response back to Service A.",
    "Because the calls flow through sidecars, Dapr can inject some useful cross-cutting behaviors:",
    "Because the calls flow through sidecars, Dapr can inject some useful cross-cutting behaviors:",
    "Automatically retry calls upon failure.",
    "Automatically retry calls upon failure.",
    "Make calls between services secure with mutual (mTLS) authentication, including automatic certificate rollover.",
    "Make calls between services secure with mutual (mTLS) authentication, including automatic certificate rollover.",
    "Control what operations clients can do using access control policies.",
    "Control what operations clients can do using access control policies.",
    "Capture traces and metrics for all calls between services to provide insights and diagnostics.",
    "Capture traces and metrics for all calls between services to provide insights and diagnostics.",
    "Any application can invoke a Dapr sidecar by using the native invoke API built into Dapr. The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "Any application can invoke a Dapr sidecar by using the native invoke API built into Dapr. The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "http://localhost:",
    "http://localhost:",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "In the following example, a curl call is made to the catalog/items ",
    "In the following example, a curl call is made to the catalog/items ",
    "curl http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "curl http://localhost:3500/v1.0/invoke/serviceb/method/catalog/items",
    "The Dapr APIs enable any application stack that supports HTTP or gRPC to use Dapr building blocks. Therefore, the service invocation building block can act as a bridge between protocols. Services can communicate with each other using HTTP, gRPC or a combination of both.",
    "The Dapr APIs enable any application stack that supports HTTP or gRPC to use Dapr building blocks. Therefore, the service invocation building block can act as a bridge between protocols. Services can communicate with each other using HTTP, gRPC or a combination of both.",
    "In the next section, you",
    "In the next section, you",
    "The Dapr .NET SDK provides .NET developers with an intuitive and language-specific way to interact with Dapr. The SDK offers developers three ways of making remote service invocation calls:",
    "The Dapr .NET SDK provides .NET developers with an intuitive and language-specific way to interact with Dapr. The SDK offers developers three ways of making remote service invocation calls:",
    "Invoke HTTP services using HttpClient",
    "Invoke HTTP services using HttpClient",
    "Invoke HTTP services using DaprClient",
    "Invoke HTTP services using DaprClient",
    "Invoke gRPC services using DaprClient",
    "Invoke gRPC services using DaprClient",
    "The preferred way to call an HTTP endpoint is to use Dapr",
    "The preferred way to call an HTTP endpoint is to use Dapr",
    "await httpClient.PostAsJsonAsync(",
    "await httpClient.PostAsJsonAsync(",
    "In the example, DaprClient.CreateInvokeHttpClient returns an HttpClient instance that is used to perform Dapr service invocation. The returned HttpClient uses a special Dapr message handler that rewrites URIs of outgoing requests. The host name is interpreted as the application ID of the service to call. The rewritten request that",
    "In the example, DaprClient.CreateInvokeHttpClient returns an HttpClient instance that is used to perform Dapr service invocation. The returned HttpClient uses a special Dapr message handler that rewrites URIs of outgoing requests. The host name is interpreted as the application ID of the service to call. The rewritten request that",
    "This example uses the default value for the Dapr HTTP endpoint, which is http://127.0.0.1:",
    "This example uses the default value for the Dapr HTTP endpoint, which is http://127.0.0.1:",
    "Alternatively, you can configure a custom endpoint in the call to DaprClient.CreateInvokeHttpClient :",
    "Alternatively, you can configure a custom endpoint in the call to DaprClient.CreateInvokeHttpClient :",
    "You can also directly set the base address by specifying the application ID. Doing so enables relative URIs when making a call:",
    "You can also directly set the base address by specifying the application ID. Doing so enables relative URIs when making a call:",
    "The HttpClient object is intended to be long-lived. A single HttpClient instance can be reused for the lifetime of the application. The next scenario demonstrates how an OrderServiceClient class reuses a Dapr HttpClient instance:",
    "The HttpClient object is intended to be long-lived. A single HttpClient instance can be reused for the lifetime of the application. The next scenario demonstrates how an OrderServiceClient class reuses a Dapr HttpClient instance:",
    "In the snippet above, the OrderServiceClient is registered as a singleton with the ASP.NET Core dependency injection system. An implementation factory creates a new HttpClient instance by calling DaprClient.CreateInvokeHttpClient . It then uses the newly created HttpClient to instantiate the OrderServiceClient object. By registering the OrderServiceClient as a singleton, it will be reused for the lifetime of the application.",
    "In the snippet above, the OrderServiceClient is registered as a singleton with the ASP.NET Core dependency injection system. An implementation factory creates a new HttpClient instance by calling DaprClient.CreateInvokeHttpClient . It then uses the newly created HttpClient to instantiate the OrderServiceClient object. By registering the OrderServiceClient as a singleton, it will be reused for the lifetime of the application.",
    "The OrderServiceClient itself has no Dapr-specific code. Even though Dapr service invocation is used under the hood, you can treat the Dapr HttpClient like any other HttpClient:",
    "The OrderServiceClient itself has no Dapr-specific code. Even though Dapr service invocation is used under the hood, you can treat the Dapr HttpClient like any other HttpClient:",
    "Using the HttpClient class with Dapr service invocation has many benefits:",
    "Using the HttpClient class with Dapr service invocation has many benefits:",
    "HttpClient is a well-known class that many developers already use in their code. Using HttpClient for Dapr service invocation allows developers to reuse their existing skills.",
    "HttpClient is a well-known class that many developers already use in their code. Using HttpClient for Dapr service invocation allows developers to reuse their existing skills.",
    "HttpClient supports advanced scenarios, such as custom headers, and full control over request and response messages.",
    "HttpClient supports advanced scenarios, such as custom headers, and full control over request and response messages.",
    "In .NET 5, HttpClient supports automatic serialization and deserialization using System.Text.Json.",
    "In .NET 5, HttpClient supports automatic serialization and deserialization using System.Text.Json.",
    "HttpClient integrates with many existing frameworks and libraries, such as Refit, RestSharp, and Polly.",
    "HttpClient integrates with many existing frameworks and libraries, such as Refit, RestSharp, and Polly.",
    "While HttpClient is the preferred way to invoke services using HTTP semantics, you can also use the DaprClient.InvokeMethodAsync family of methods. The following example submits an order by calling the submit method of the orderservice application:",
    "While HttpClient is the preferred way to invoke services using HTTP semantics, you can also use the DaprClient.InvokeMethodAsync family of methods. The following example submits an order by calling the submit method of the orderservice application:",
    "The third argument, an order object, is serialized internally (with System.Text.JsonSerializer ) and sent as the request payload. The .NET SDK takes care of the call to the sidecar. It also deserializes the response to an OrderConfirmation object. Because no HTTP method is specified, the request is executed as an HTTP POST.",
    "The third argument, an order object, is serialized internally (with System.Text.JsonSerializer ) and sent as the request payload. The .NET SDK takes care of the call to the sidecar. It also deserializes the response to an OrderConfirmation object. Because no HTTP method is specified, the request is executed as an HTTP POST.",
    "The next example demonstrates how you can make an HTTP GET request by specifying the HttpMethod :",
    "The next example demonstrates how you can make an HTTP GET request by specifying the HttpMethod :",
    "For some scenarios, you may require more control over the request message. For example, when you need to specify request headers, or you want to use a custom serializer for the payload. DaprClient.CreateInvokeMethodRequest creates an HttpRequestMessage . The following example demonstrates how to add an HTTP authorization header to a request message:",
    "For some scenarios, you may require more control over the request message. For example, when you need to specify request headers, or you want to use a custom serializer for the payload. DaprClient.CreateInvokeMethodRequest creates an HttpRequestMessage . The following example demonstrates how to add an HTTP authorization header to a request message:",
    "The HttpRequestMessage now has the following properties set:",
    "The HttpRequestMessage now has the following properties set:",
    "Url = http://127.0.0.1:3500/v1.0/invoke/orderservice/method/submit",
    "Url = http://127.0.0.1:3500/v1.0/invoke/orderservice/method/submit",
    "HttpMethod = POST",
    "HttpMethod = POST",
    "Content = JsonContent object containing the JSON-serialized order",
    "Content = JsonContent object containing the JSON-serialized order",
    "Headers.Authorization = ",
    "Headers.Authorization = ",
    "Once you",
    "Once you",
    "DaprClient.InvokeMethodAsync deserializes the response to an OrderConfirmation object if the request is successful. Alternatively, you can use DaprClient.InvokeMethodWithResponseAsync to get full access to the underlying HttpResponseMessage :",
    "DaprClient.InvokeMethodAsync deserializes the response to an OrderConfirmation object if the request is successful. Alternatively, you can use DaprClient.InvokeMethodWithResponseAsync to get full access to the underlying HttpResponseMessage :",
    "For service invocation calls using HTTP, it",
    "For service invocation calls using HTTP, it",
    "DaprClient provides a family of InvokeMethodGrpcAsync methods for calling gRPC endpoints. The main difference with the HTTP methods is the use of a Protobuf serializer instead of JSON. The following example invokes the submitOrder method of the orderservice over gRPC.",
    "DaprClient provides a family of InvokeMethodGrpcAsync methods for calling gRPC endpoints. The main difference with the HTTP methods is the use of a Protobuf serializer instead of JSON. The following example invokes the submitOrder method of the orderservice over gRPC.",
    "In the example above, DaprClient serializes the given order object using Protobuf and uses the result as the gRPC request body. Likewise, the response body is Protobuf deserialized and returned to the caller. Protobuf typically provides better performance than the JSON payloads used in HTTP service invocation.",
    "In the example above, DaprClient serializes the given order object using Protobuf and uses the result as the gRPC request body. Likewise, the response body is Protobuf deserialized and returned to the caller. Protobuf typically provides better performance than the JSON payloads used in HTTP service invocation.",
    "At the time of writing, Dapr provides support for the following name resolution components:",
    "At the time of writing, Dapr provides support for the following name resolution components:",
    "mDNS (default when running self-hosted)",
    "mDNS (default when running self-hosted)",
    "Kubernetes Name Resolution (default when running in Kubernetes)",
    "Kubernetes Name Resolution (default when running in Kubernetes)",
    "HashiCorp Consul",
    "HashiCorp Consul",
    "To use a non-default name resolution component, add a nameResolution spec to the application",
    "To use a non-default name resolution component, add a nameResolution spec to the application",
    "In Dapr Traffic Control sample app, the FineCollection service uses the Dapr service invocation building block to retrieve vehicle and owner information from the VehicleRegistration service. Figure 6-2 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr service invocation building block is used in flows marked with number 1 in the diagram:",
    "In Dapr Traffic Control sample app, the FineCollection service uses the Dapr service invocation building block to retrieve vehicle and owner information from the VehicleRegistration service. Figure 6-2 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr service invocation building block is used in flows marked with number 1 in the diagram:",
    "The code doesn",
    "The code doesn",
    "The DaprClient.CreateInvokeHttpClient creates an HttpClient instance that calls the VehicleRegistration service using the service invocation building block under the covers. It expects both the Dapr app-id of the target service and the URL of its Dapr sidecar. At start time, the daprHttpPort argument contains the port number used for HTTP communication with the Dapr sidecar.",
    "The DaprClient.CreateInvokeHttpClient creates an HttpClient instance that calls the VehicleRegistration service using the service invocation building block under the covers. It expects both the Dapr app-id of the target service and the URL of its Dapr sidecar. At start time, the daprHttpPort argument contains the port number used for HTTP communication with the Dapr sidecar.",
    "Using Dapr service invocation in the Traffic Control sample application provides several benefits:",
    "Using Dapr service invocation in the Traffic Control sample application provides several benefits:",
    "Decouples the location of the target service.",
    "Decouples the location of the target service.",
    "Adds resiliency with automatic retry features.",
    "Adds resiliency with automatic retry features.",
    "Ability to reuse an existing HttpClient based proxy (offered by the ASP.NET Core integration).",
    "Ability to reuse an existing HttpClient based proxy (offered by the ASP.NET Core integration).",
    "In this chapter, you learned about the service invocation building block. You saw how to invoke remote methods both by making direct HTTP calls to the Dapr sidecar, and by using the Dapr .NET SDK.",
    "In this chapter, you learned about the service invocation building block. You saw how to invoke remote methods both by making direct HTTP calls to the Dapr sidecar, and by using the Dapr .NET SDK.",
    "The Dapr .NET SDK provides multiple ways to invoke remote methods. HttpClient support is great for developers wanting to reuse existing skills and is compatible with many existing frameworks and libraries. DaprClient offers support for directly using the Dapr service invocation API using either HTTP or gRPC semantics.",
    "The Dapr .NET SDK provides multiple ways to invoke remote methods. HttpClient support is great for developers wanting to reuse existing skills and is compatible with many existing frameworks and libraries. DaprClient offers support for directly using the Dapr service invocation API using either HTTP or gRPC semantics.",
    "Dapr service invocation building block",
    "Dapr service invocation building block",
    "Monitoring distributed cloud-native applications",
    "Monitoring distributed cloud-native applications",
    "Publisher",
    "Publisher",
    "Message broker",
    "Message broker",
    "The Publish-Subscribe pattern (often referred to as ",
    "The Publish-Subscribe pattern (often referred to as ",
    "The primary advantage of the Publish-Subscribe pattern is loose coupling , sometimes referred to as temporal decoupling. The pattern decouples services that send messages (the publishers ) from services that consume messages (the subscribers ). Both publishers and subscribers are unaware of each other - both are dependent on a centralized message broker that distributes the messages.",
    "The primary advantage of the Publish-Subscribe pattern is loose coupling , sometimes referred to as temporal decoupling. The pattern decouples services that send messages (the publishers ) from services that consume messages (the subscribers ). Both publishers and subscribers are unaware of each other - both are dependent on a centralized message broker that distributes the messages.",
    "Figure 7-1 shows the high-level architecture of the pub/sub pattern.",
    "Figure 7-1 shows the high-level architecture of the pub/sub pattern.",
    "Figure 7-1. The pub/sub pattern.",
    "Figure 7-1. The pub/sub pattern.",
    "From the previous figure, note the steps of the pattern:",
    "From the previous figure, note the steps of the pattern:",
    "Publishers send messages to the message broker.",
    "Publishers send messages to the message broker.",
    "Subscribers bind to a subscription on the message broker.",
    "Subscribers bind to a subscription on the message broker.",
    "The message broker forwards a copy of the message to interested subscriptions.",
    "The message broker forwards a copy of the message to interested subscriptions.",
    "Subscribers consume messages from their subscriptions.",
    "Subscribers consume messages from their subscriptions.",
    "Most message brokers encapsulate a queueing mechanism that can persist messages once received. With it, the message broker guarantees durability by storing the message. Subscribers don",
    "Most message brokers encapsulate a queueing mechanism that can persist messages once received. With it, the message broker guarantees durability by storing the message. Subscribers don",
    "If your service can only process a message once, you",
    "If your service can only process a message once, you",
    "There are several message broker products available - both commercially and open-source. Each has advantages and drawbacks. Your job is to match your system requirements to the appropriate broker. Once selected, it",
    "There are several message broker products available - both commercially and open-source. Each has advantages and drawbacks. Your job is to match your system requirements to the appropriate broker. Once selected, it",
    "The Dapr publish ",
    "The Dapr publish ",
    "The Dapr publish ",
    "The Dapr publish ",
    "The service calls the pub/sub API on the Dapr sidecar. The sidecar then makes calls into a pre-defined Dapr pub/sub component that encapsulates a specific message broker product. Figure 7-2 shows the Dapr pub/sub messaging stack.",
    "The service calls the pub/sub API on the Dapr sidecar. The sidecar then makes calls into a pre-defined Dapr pub/sub component that encapsulates a specific message broker product. Figure 7-2 shows the Dapr pub/sub messaging stack.",
    "RabbitMQ",
    "RabbitMQ",
    "component",
    "component",
    "Figure 7-2. The Dapr pub/sub stack.",
    "Figure 7-2. The Dapr pub/sub stack.",
    "The Dapr publish ",
    "The Dapr publish ",
    "At the lowest level, any programming platform can invoke the building block over HTTP or gRPC using the Dapr native API . To publish a message, you make the following API call:",
    "At the lowest level, any programming platform can invoke the building block over HTTP or gRPC using the Dapr native API . To publish a message, you make the following API call:",
    "There are several Dapr specific URL segments in the above call:",
    "There are several Dapr specific URL segments in the above call:",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "Using the curl command-line tool to publish a message, you can try it out:",
    "Using the curl command-line tool to publish a message, you can try it out:",
    "You receive messages by subscribing to a topic. At startup, the Dapr runtime will call the application on a well-known endpoint to identify and create the required subscriptions:",
    "You receive messages by subscribing to a topic. At startup, the Dapr runtime will call the application on a well-known endpoint to identify and create the required subscriptions:",
    "http://localhost:",
    "http://localhost:",
    "<",
    "<",
    "You can implement this endpoint yourself. But Dapr provides more intuitive ways of implementing it. We",
    "You can implement this endpoint yourself. But Dapr provides more intuitive ways of implementing it. We",
    "The response from the call contains a list of topics to which the applications will subscribe. Each includes an endpoint to call when the topic receives a message. Here",
    "The response from the call contains a list of topics to which the applications will subscribe. Each includes an endpoint to call when the topic receives a message. Here",
    "In the JSON response, you can see the application wants to subscribe to topics newOrder and newProduct . It registers the endpoints /orders and /productCatalog/products for each, respectively. For both subscriptions, the application is binding to the Dapr component named pubsub .",
    "In the JSON response, you can see the application wants to subscribe to topics newOrder and newProduct . It registers the endpoints /orders and /productCatalog/products for each, respectively. For both subscriptions, the application is binding to the Dapr component named pubsub .",
    "Figure 7-3 presents the flow of the example.",
    "Figure 7-3 presents the flow of the example.",
    "POST http://localhost:3500/v1.0/publish/pubsub/newOrder",
    "POST http://localhost:3500/v1.0/publish/pubsub/newOrder",
    "Service A",
    "Service A",
    "Service B",
    "Service B",
    "Figure 7-3. Pub/sub flow with Dapr.",
    "Figure 7-3. Pub/sub flow with Dapr.",
    "The Dapr sidecar for Service B calls the /dapr/subscribe endpoint from Service B (the consumer). The service responds with the subscriptions it wants to create.",
    "The Dapr sidecar for Service B calls the /dapr/subscribe endpoint from Service B (the consumer). The service responds with the subscriptions it wants to create.",
    "The Dapr sidecar for Service B creates the requested subscriptions on the message broker.",
    "The Dapr sidecar for Service B creates the requested subscriptions on the message broker.",
    "Service A publishes a message at the /v1.0/publish/",
    "Service A publishes a message at the /v1.0/publish/",
    "The Service A sidecar publishes the message to the message broker.",
    "The Service A sidecar publishes the message to the message broker.",
    "The message broker sends a copy of the message to the Service B sidecar.",
    "The message broker sends a copy of the message to the Service B sidecar.",
    "The Service B sidecar calls the endpoint corresponding to the subscription (in this case /orders ) on Service B. The service responds with an HTTP status-code 200 OK so the sidecar will consider the message as being handled successfully.",
    "The Service B sidecar calls the endpoint corresponding to the subscription (in this case /orders ) on Service B. The service responds with an HTTP status-code 200 OK so the sidecar will consider the message as being handled successfully.",
    "In the example, the message is handled successfully. But if something goes wrong while Service B is handling the request, it can use the response to specify what needs to happen with the message. When it returns an HTTP status-code 404 , an error is logged and the message is dropped. With any other status-code than 200 or 404 , a warning is logged and the message is retried. Alternatively,",
    "In the example, the message is handled successfully. But if something goes wrong while Service B is handling the request, it can use the response to specify what needs to happen with the message. When it returns an HTTP status-code 404 , an error is logged and the message is dropped. With any other status-code than 200 or 404 , a warning is logged and the message is retried. Alternatively,",
    "Service B can explicitly specify what needs to happen with the message by including a JSON payload in the body of the response:",
    "Service B can explicitly specify what needs to happen with the message by including a JSON payload in the body of the response:",
    "The following table shows the available status values:",
    "The following table shows the available status values:",
    "| Status           | Action                                                           |",
    "| Status           | Action                                                           |",
    "When scaling out an application that subscribes to a topic, you have to deal with competing consumers. Only one application instance should handle a message sent to the topic. Luckily, Dapr handles that problem. When multiple instances of a service with the same application-id subscribe to a topic, Dapr delivers each message to only one of them.",
    "When scaling out an application that subscribes to a topic, you have to deal with competing consumers. Only one application instance should handle a message sent to the topic. Luckily, Dapr handles that problem. When multiple instances of a service with the same application-id subscribe to a topic, Dapr delivers each message to only one of them.",
    "For .NET Developers, the Dapr .NET SDK provides a more productive way of working with Dapr. The SDK exposes a DaprClient class through which you can directly invoke Dapr functionality. It",
    "For .NET Developers, the Dapr .NET SDK provides a more productive way of working with Dapr. The SDK exposes a DaprClient class through which you can directly invoke Dapr functionality. It",
    "To publish a message, the DaprClient exposes a PublishEventAsync method.",
    "To publish a message, the DaprClient exposes a PublishEventAsync method.",
    "The first argument pubsub is the name of the Dapr component that provides the message broker implementation. We",
    "The first argument pubsub is the name of the Dapr component that provides the message broker implementation. We",
    "The second argument neworder provides the name of the topic to send the message to.",
    "The second argument neworder provides the name of the topic to send the message to.",
    "The third argument is the payload of the message.",
    "The third argument is the payload of the message.",
    "You can specify the .NET type of the message using the generic type parameter of the method.",
    "You can specify the .NET type of the message using the generic type parameter of the method.",
    "To receive messages, you bind an endpoint to a subscription for a registered topic. The AspNetCore library for Dapr makes this trivial. Assume, for example, that you have an existing ASP.NET WebAPI action method entitled CreateOrder :",
    "To receive messages, you bind an endpoint to a subscription for a registered topic. The AspNetCore library for Dapr makes this trivial. Assume, for example, that you have an existing ASP.NET WebAPI action method entitled CreateOrder :",
    "Dapr ASP.NET Core integration.",
    "Dapr ASP.NET Core integration.",
    "To bind this action method to a topic, you decorate it with the Topic attribute:",
    "To bind this action method to a topic, you decorate it with the Topic attribute:",
    "You specify two key elements with this attribute:",
    "You specify two key elements with this attribute:",
    "The Dapr pub/sub component to target (in this case pubsub ).",
    "The Dapr pub/sub component to target (in this case pubsub ).",
    "The topic to subscribe to (in this case newOrder ).",
    "The topic to subscribe to (in this case newOrder ).",
    "Dapr then invokes that action method as it receives messages for that topic.",
    "Dapr then invokes that action method as it receives messages for that topic.",
    "You",
    "You",
    "In the Program.cs file, you must call the following extension method on the WebApplication builder to register Dapr:",
    "In the Program.cs file, you must call the following extension method on the WebApplication builder to register Dapr:",
    "Appending the AddDapr extension method to the AddControllers extension method registers the necessary services to integrate Dapr into the MVC pipeline. It also registers a DaprClient instance into the dependency injection container, which then can be injected anywhere into your service.",
    "Appending the AddDapr extension method to the AddControllers extension method registers the necessary services to integrate Dapr into the MVC pipeline. It also registers a DaprClient instance into the dependency injection container, which then can be injected anywhere into your service.",
    "After the WebApplication has been created, you must add the following middleware components to enable Dapr:",
    "After the WebApplication has been created, you must add the following middleware components to enable Dapr:",
    "The call to UseCloudEvents adds CloudEvents middleware into to the ASP.NET Core middleware pipeline. This middleware will unwrap requests that use the CloudEvents structured format, so the receiving method can read the event payload directly.",
    "The call to UseCloudEvents adds CloudEvents middleware into to the ASP.NET Core middleware pipeline. This middleware will unwrap requests that use the CloudEvents structured format, so the receiving method can read the event payload directly.",
    "CloudEvents is a standardized messaging format, providing a common way to describe event information across platforms. Dapr embraces CloudEvents. For more information about CloudEvents, see the cloudevents specification.",
    "CloudEvents is a standardized messaging format, providing a common way to describe event information across platforms. Dapr embraces CloudEvents. For more information about CloudEvents, see the cloudevents specification.",
    "The call to MapSubscribeHandler in the endpoint routing configuration will add a Dapr subscribe endpoint to the application. This endpoint will respond to requests on /dapr/subscribe . When this endpoint is called, it will automatically find all WebAPI action methods decorated with the Topic attribute and instruct Dapr to create subscriptions for them.",
    "The call to MapSubscribeHandler in the endpoint routing configuration will add a Dapr subscribe endpoint to the application. This endpoint will respond to requests on /dapr/subscribe . When this endpoint is called, it will automatically find all WebAPI action methods decorated with the Topic attribute and instruct Dapr to create subscriptions for them.",
    "Dapr pub/sub components handle the actual transport of the messages. Several are available. Each encapsulates a specific message broker product to implement the pub/sub functionality. At the time of writing, the following pub/sub components were available:",
    "Dapr pub/sub components handle the actual transport of the messages. Several are available. Each encapsulates a specific message broker product to implement the pub/sub functionality. At the time of writing, the following pub/sub components were available:",
    "Apache Kafka",
    "Apache Kafka",
    "AWS SNS/SQS",
    "AWS SNS/SQS",
    "Azure Event Hubs",
    "Azure Event Hubs",
    "Azure Service Bus",
    "Azure Service Bus",
    "GCP Pub/Sub",
    "GCP Pub/Sub",
    "Hazelcast",
    "Hazelcast",
    "In Memory",
    "In Memory",
    "JetStream",
    "JetStream",
    "MQTT",
    "MQTT",
    "NATS Streaming",
    "NATS Streaming",
    "Pulsar",
    "Pulsar",
    "RabbitMQ",
    "RabbitMQ",
    "Redis Streams",
    "Redis Streams",
    "The Azure cloud stack has both messaging functionality (Azure Service Bus) and event streaming (Azure Event Hub) availability.",
    "The Azure cloud stack has both messaging functionality (Azure Service Bus) and event streaming (Azure Event Hub) availability.",
    "These components are created by the community in a component-contrib repository on GitHub. You",
    "These components are created by the community in a component-contrib repository on GitHub. You",
    "Using a Dapr configuration file, you can specify the pub/sub component(s) to use. This configuration contains several fields. The name field specifies the pub/sub component that you want to use. When sending or receiving a message, you need to specify this name (as you saw earlier in the PublishEventAsync method signature).",
    "Using a Dapr configuration file, you can specify the pub/sub component(s) to use. This configuration contains several fields. The name field specifies the pub/sub component that you want to use. When sending or receiving a message, you need to specify this name (as you saw earlier in the PublishEventAsync method signature).",
    "Below you see an example of a Dapr configuration file for configuring a RabbitMQ message broker component:",
    "Below you see an example of a Dapr configuration file for configuring a RabbitMQ message broker component:",
    "In this example, you can see that you can specify any message broker-specific configuration in the metadata block. In this case, RabbitMQ is configured to create durable queues. But the RabbitMQ component has more configuration options. Each of the components",
    "In this example, you can see that you can specify any message broker-specific configuration in the metadata block. In this case, RabbitMQ is configured to create durable queues. But the RabbitMQ component has more configuration options. Each of the components",
    "Next to the programmatic way of subscribing to a topic from code, Dapr pub/sub also provides a declarative way of subscribing to a topic. This approach removes the Dapr dependency from the application code. Therefore, it also enables an existing application to subscribe to topics without any changes to the code. The following example shows a Dapr configuration file for configuring a subscription:",
    "Next to the programmatic way of subscribing to a topic from code, Dapr pub/sub also provides a declarative way of subscribing to a topic. This approach removes the Dapr dependency from the application code. Therefore, it also enables an existing application to subscribe to topics without any changes to the code. The following example shows a Dapr configuration file for configuring a subscription:",
    "You have to specify several elements with every subscription:",
    "You have to specify several elements with every subscription:",
    "The name of the Dapr pub/sub component you want to use (in this case pubsub ).",
    "The name of the Dapr pub/sub component you want to use (in this case pubsub ).",
    "The name of the topic to subscribe to (in this case newOrder ).",
    "The name of the topic to subscribe to (in this case newOrder ).",
    "The API operation that needs to be called for this topic (in this case /orders ).",
    "The API operation that needs to be called for this topic (in this case /orders ).",
    "The scope can specify which services can publish and subscribe to a topic.",
    "The scope can specify which services can publish and subscribe to a topic.",
    "In Dapr Traffic Control sample app, the TrafficControl service uses the Dapr pub/sub building block to send speeding violations to the FineCollection service. Figure 7-4 shows the conceptual architecture",
    "In Dapr Traffic Control sample app, the TrafficControl service uses the Dapr pub/sub building block to send speeding violations to the FineCollection service. Figure 7-4 shows the conceptual architecture",
    "of the Dapr Traffic Control sample application. The Dapr pub/sub building block is used in flows marked with number 2 in the diagram:",
    "of the Dapr Traffic Control sample application. The Dapr pub/sub building block is used in flows marked with number 2 in the diagram:",
    ":::image type=",
    ":::image type=",
    "Figure 7-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 7-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Speeding violations are handled by the CollectionController , an ordinary ASP.NET Core Controller. The CollectionController.CollectFine method subscribes to and handles SpeedingViolation event messages:",
    "Speeding violations are handled by the CollectionController , an ordinary ASP.NET Core Controller. The CollectionController.CollectFine method subscribes to and handles SpeedingViolation event messages:",
    "The method is decorated with the Dapr Topic attribute. It specifies that the pub/sub component named pubsub should be used to subscribe to messages sent to the speedingviolations topic.",
    "The method is decorated with the Dapr Topic attribute. It specifies that the pub/sub component named pubsub should be used to subscribe to messages sent to the speedingviolations topic.",
    "The TrafficControl service sends speeding violations. Near the end of the VehicleExit method in the TrafficController class, the DaprClient object is used to publish SpeedingViolation messages using the pub/sub building block:",
    "The TrafficControl service sends speeding violations. Near the end of the VehicleExit method in the TrafficController class, the DaprClient object is used to publish SpeedingViolation messages using the pub/sub building block:",
    "Note how the DaprClient object reduces the call to a single line of code, again, binding to the speedingviolations topic and the Dapr pubsub component.",
    "Note how the DaprClient object reduces the call to a single line of code, again, binding to the speedingviolations topic and the Dapr pubsub component.",
    "While the Traffic Control app uses RabbitMQ as the message broker, it never directly references RabbitMQ. Instead, the accompanying Dapr component configuration file named pubsub.yaml in the /dapr/components folder specifies the message broker:",
    "While the Traffic Control app uses RabbitMQ as the message broker, it never directly references RabbitMQ. Instead, the accompanying Dapr component configuration file named pubsub.yaml in the /dapr/components folder specifies the message broker:",
    "The type element in the configuration, pubsub.rabbitmq instructs the building block to use the Dapr RabbitMQ component.",
    "The type element in the configuration, pubsub.rabbitmq instructs the building block to use the Dapr RabbitMQ component.",
    "The scopes element in the configuration constrains application access to the RabbitMQ component. Only the TrafficControl and FineCollection services can consume it.",
    "The scopes element in the configuration constrains application access to the RabbitMQ component. Only the TrafficControl and FineCollection services can consume it.",
    "Using Dapr pub/sub in the Traffic Control sample application offers the following benefits:",
    "Using Dapr pub/sub in the Traffic Control sample application offers the following benefits:",
    "No infrastructural abstraction of a message broker to maintain.",
    "No infrastructural abstraction of a message broker to maintain.",
    "Services are temporally decoupled, which increases robustness.",
    "Services are temporally decoupled, which increases robustness.",
    "Publisher and subscribers are unaware of each other. This means that additional services could be introduced that will react to speeding violations in the future, without the need to change the TrafficControl service.",
    "Publisher and subscribers are unaware of each other. This means that additional services could be introduced that will react to speeding violations in the future, without the need to change the TrafficControl service.",
    "The pub/sub pattern helps you decouple services in a distributed application. The Dapr publish ",
    "The pub/sub pattern helps you decouple services in a distributed application. The Dapr publish ",
    "Through Dapr pub/sub, you can publish messages to a specific topic . As well, the building block will query your service to determine which topic(s) to subscribe to.",
    "Through Dapr pub/sub, you can publish messages to a specific topic . As well, the building block will query your service to determine which topic(s) to subscribe to.",
    "You can use Dapr pub/sub natively over HTTP or by using one of the language-specific SDKs, such as the .NET SDK for Dapr. The .NET SDK tightly integrates with the ASP.NET core platform.",
    "You can use Dapr pub/sub natively over HTTP or by using one of the language-specific SDKs, such as the .NET SDK for Dapr. The .NET SDK tightly integrates with the ASP.NET core platform.",
    "With Dapr, you can plug a supported message broker product into your application. You can then swap message brokers without requiring code changes to your application.",
    "With Dapr, you can plug a supported message broker product into your application. You can then swap message brokers without requiring code changes to your application.",
    "Dapr supported pub/sub brokers",
    "Dapr supported pub/sub brokers",
    "External",
    "External",
    "Resource",
    "Resource",
    "Twitter",
    "Twitter",
    "\u2192",
    "\u2192",
    "Dapr dapr",
    "Dapr dapr",
    "Sidecar",
    "Sidecar",
    "Your service",
    "Your service",
    "External",
    "External",
    "Resource",
    "Resource",
    "\u2192",
    "\u2192",
    "Twilio SMS",
    "Twilio SMS",
    "Cloud-based serverless offerings, such as Azure Functions and AWS Lambda, have gained wide adoption across the distributed architecture space. Among many benefits, they enable a microservice to handle events from or invoke events in an external system - abstracting away the underlying complexity and plumbing concerns. External resources are many: They include datastores, message systems, and web resources, across different platforms and vendors. The Dapr bindings building block brings these same resource binding capabilities to the doorstep of your Dapr applications.",
    "Cloud-based serverless offerings, such as Azure Functions and AWS Lambda, have gained wide adoption across the distributed architecture space. Among many benefits, they enable a microservice to handle events from or invoke events in an external system - abstracting away the underlying complexity and plumbing concerns. External resources are many: They include datastores, message systems, and web resources, across different platforms and vendors. The Dapr bindings building block brings these same resource binding capabilities to the doorstep of your Dapr applications.",
    "Dapr resource bindings enable your services to integrate business operations across external resources outside of the immediate application. An event from an external system could trigger an operation in your service passing in contextual information. Your service could then expand the operation by triggering an event in another external system, passing in contextual payload information. Your service communicates without coupling or awareness of the external resource. The plumbing is encapsulated inside pre-defined Dapr components. The Dapr component to use can be easily swapped at run time without code changes.",
    "Dapr resource bindings enable your services to integrate business operations across external resources outside of the immediate application. An event from an external system could trigger an operation in your service passing in contextual information. Your service could then expand the operation by triggering an event in another external system, passing in contextual payload information. Your service communicates without coupling or awareness of the external resource. The plumbing is encapsulated inside pre-defined Dapr components. The Dapr component to use can be easily swapped at run time without code changes.",
    "Consider, for example, a Twitter account that triggers an event whenever a user tweets a keyword. Your service exposes an event handler that receives and processes the tweet. Once complete, your service triggers an event that invokes an external Twilio service. Twilio sends an SMS message that includes the tweet. Figure 8-1 show the conceptual architecture of this operation:",
    "Consider, for example, a Twitter account that triggers an event whenever a user tweets a keyword. Your service exposes an event handler that receives and processes the tweet. Once complete, your service triggers an event that invokes an external Twilio service. Twilio sends an SMS message that includes the tweet. Figure 8-1 show the conceptual architecture of this operation:",
    "Figure 8-1. Conceptual architecture of a Dapr resource binding.",
    "Figure 8-1. Conceptual architecture of a Dapr resource binding.",
    "At first glance, resource binding behavior may appear similar to the Publish/Subscribe pattern described earlier in this book. While they share similarities, there are differences. Publish/subscribe",
    "At first glance, resource binding behavior may appear similar to the Publish/Subscribe pattern described earlier in this book. While they share similarities, there are differences. Publish/subscribe",
    "\u2192",
    "\u2192",
    "Dapr dapr",
    "Dapr dapr",
    "Sidecar",
    "Sidecar",
    "POST http://localhost:6000/tweet focuses on asynchronous communication between Dapr services. Resource binding has a much wider scope. It focuses on system interoperability across software platforms. Exchanging information between disparate applications, datastores, and services outside your microservice application.",
    "POST http://localhost:6000/tweet focuses on asynchronous communication between Dapr services. Resource binding has a much wider scope. It focuses on system interoperability across software platforms. Exchanging information between disparate applications, datastores, and services outside your microservice application.",
    "Your service",
    "Your service",
    "Dapr resource binding starts with a component configuration file. This YAML file describes the type of resource to which you",
    "Dapr resource binding starts with a component configuration file. This YAML file describes the type of resource to which you",
    "| Note                                                                            |",
    "| Note                                                                            |",
    "Binding configuration",
    "Binding configuration",
    "Input bindings trigger your code with incoming events from external resources. To receive events and data, you register a public endpoint from your service that becomes the event handler . Figure 8-2 shows the flow:",
    "Input bindings trigger your code with incoming events from external resources. To receive events and data, you register a public endpoint from your service that becomes the event handler . Figure 8-2 shows the flow:",
    "Figure 8-2. Dapr input binding flow.",
    "Figure 8-2. Dapr input binding flow.",
    "Figure 8.2 describes the steps for receiving events from an external Twitter account:",
    "Figure 8.2 describes the steps for receiving events from an external Twitter account:",
    "component",
    "component",
    "The Dapr sidecar reads the binding configuration file and subscribes to the event specified for the external resource. In the example, the event source is a Twitter account.",
    "The Dapr sidecar reads the binding configuration file and subscribes to the event specified for the external resource. In the example, the event source is a Twitter account.",
    "When a matching Tweet is published on Twitter, the binding component running in the Dapr sidecar picks it up and triggers an event.",
    "When a matching Tweet is published on Twitter, the binding component running in the Dapr sidecar picks it up and triggers an event.",
    "The Dapr sidecar invokes the endpoint (that is, event handler) configured for the binding. In the example, the service listens for an HTTP POST on the /tweet endpoint on port 6000. Because i t",
    "The Dapr sidecar invokes the endpoint (that is, event handler) configured for the binding. In the example, the service listens for an HTTP POST on the /tweet endpoint on port 6000. Because i t",
    "After handling the event, the service returns an HTTP status code 200 OK .",
    "After handling the event, the service returns an HTTP status code 200 OK .",
    "The following ASP.NET Core controller provides an example of handling an event triggered by the Twitter binding:",
    "The following ASP.NET Core controller provides an example of handling an event triggered by the Twitter binding:",
    "If the operation should error, you would return the appropriate 400 or 500 level HTTP status code. For bindings that feature at-least-once delivery guarantees, the Dapr sidecar will retry the trigger. Check out Dapr documentation for resource bindings to see whether they offer at-least-once or exactly-once delivery guarantees.",
    "If the operation should error, you would return the appropriate 400 or 500 level HTTP status code. For bindings that feature at-least-once delivery guarantees, the Dapr sidecar will retry the trigger. Check out Dapr documentation for resource bindings to see whether they offer at-least-once or exactly-once delivery guarantees.",
    "Dapr also includes output binding capabilities. They enable your service to trigger an event that invokes an external resource. Again, you start by configuring a binding configuration YAML file that describes the output binding. Once in place, you trigger an event that invokes the bindings API on the Dapr sidecar of your application. Figure 8-3 shows the flow of an output binding:",
    "Dapr also includes output binding capabilities. They enable your service to trigger an event that invokes an external resource. Again, you start by configuring a binding configuration YAML file that describes the output binding. Once in place, you trigger an event that invokes the bindings API on the Dapr sidecar of your application. Figure 8-3 shows the flow of an output binding:",
    "POST http://localhost:3500/v1.0/bindings/sms",
    "POST http://localhost:3500/v1.0/bindings/sms",
    "7=\u2022",
    "7=\u2022",
    "=",
    "=",
    "=",
    "=",
    "Your service",
    "Your service",
    "Binding configuration",
    "Binding configuration",
    "Figure 8-3. Dapr output binding flow.",
    "Figure 8-3. Dapr output binding flow.",
    "The Dapr sidecar reads the binding configuration file with the information on how to connect to the external resource. In the example, the external resource is a Twilio SMS account.",
    "The Dapr sidecar reads the binding configuration file with the information on how to connect to the external resource. In the example, the external resource is a Twilio SMS account.",
    "Your application invokes the /v1.0/bindings/sms endpoint on the Dapr sidecar. In this case, it uses an HTTP POST to invoke the API. It",
    "Your application invokes the /v1.0/bindings/sms endpoint on the Dapr sidecar. In this case, it uses an HTTP POST to invoke the API. It",
    "The binding component running in the Dapr sidecar calls the external messaging system to send the message. The message will contain the payload passed in the POST request.",
    "The binding component running in the Dapr sidecar calls the external messaging system to send the message. The message will contain the payload passed in the POST request.",
    "As an example, you can invoke an output binding by invoking the Dapr API using curl:",
    "As an example, you can invoke an output binding by invoking the Dapr API using curl:",
    "Note that the HTTP port is the same as used by the Dapr sidecar (in this case, the default Dapr HTTP port 3500 ).",
    "Note that the HTTP port is the same as used by the Dapr sidecar (in this case, the default Dapr HTTP port 3500 ).",
    "The structure of the payload (that is, message sent) will vary per binding. In the example above, the payload contains a data element with a message. Bindings to other types of external resources can be different, especially for the metadata that is sent. Each payload must also contain an operation field,",
    "The structure of the payload (that is, message sent) will vary per binding. In the example above, the payload contains a data element with a message. Bindings to other types of external resources can be different, especially for the metadata that is sent. Each payload must also contain an operation field,",
    "Dapr",
    "Dapr",
    "External",
    "External",
    "that defines the operation the binding will execute. The above example specifies a create operation that creates the SMS message. Common operations include:",
    "that defines the operation the binding will execute. The above example specifies a create operation that creates the SMS message. Common operations include:",
    "create",
    "create",
    "get",
    "get",
    "delete",
    "delete",
    "list",
    "list",
    "It",
    "It",
    "The Dapr .NET SDK provides language-specific support for .NET developers. In the following example, the call to the HttpClient.PostAsync() is replaced with the DaprClient.InvokeBindingAsync() method. This specialized method simplifies invoking a configured output binding:",
    "The Dapr .NET SDK provides language-specific support for .NET developers. In the following example, the call to the HttpClient.PostAsync() is replaced with the DaprClient.InvokeBindingAsync() method. This specialized method simplifies invoking a configured output binding:",
    "The method expects the metadata and message values.",
    "The method expects the metadata and message values.",
    "When used to invoke a binding, the DaprClient uses gRPC to call the Dapr API on the Dapr sidecar.",
    "When used to invoke a binding, the DaprClient uses gRPC to call the Dapr API on the Dapr sidecar.",
    "Under the hood, resource bindings are implemented with Dapr binding components. They",
    "Under the hood, resource bindings are implemented with Dapr binding components. They",
    "Dapr and all of its components are written in the Golang (Go) language. Go is considered a modern, cloud-native programming platform.",
    "Dapr and all of its components are written in the Golang (Go) language. Go is considered a modern, cloud-native programming platform.",
    "You configure bindings using a YAML configuration file. Here",
    "You configure bindings using a YAML configuration file. Here",
    "Each binding configuration contains a general metadata element with a name and namespace field. Dapr will determine the endpoint to invoke your service based upon the configured name field. In the above example, Dapr will invoke the method annotated with /twitter-mention in your service when an event occurs.",
    "Each binding configuration contains a general metadata element with a name and namespace field. Dapr will determine the endpoint to invoke your service based upon the configured name field. In the above example, Dapr will invoke the method annotated with /twitter-mention in your service when an event occurs.",
    "In the spec element, you specify the type of the binding along with binding specific metadata . The example specifies credentials for accessing a Twitter account using its API. The metadata can differ between input and output bindings. For example, to use Twitter as an input binding, you need to specify the text to search for in tweets using the query field. Every time a matching tweet is sent, the Dapr sidecar will invoke the /twitter-mention endpoint on the service. It will also deliver the contents of the tweet.",
    "In the spec element, you specify the type of the binding along with binding specific metadata . The example specifies credentials for accessing a Twitter account using its API. The metadata can differ between input and output bindings. For example, to use Twitter as an input binding, you need to specify the text to search for in tweets using the query field. Every time a matching tweet is sent, the Dapr sidecar will invoke the /twitter-mention endpoint on the service. It will also deliver the contents of the tweet.",
    "A binding can be configured for input, output, or both. Interestingly, the binding doesn",
    "A binding can be configured for input, output, or both. Interestingly, the binding doesn",
    "The Dapr documentation for resource bindings provides a complete list of the available bindings and their specific configuration settings.",
    "The Dapr documentation for resource bindings provides a complete list of the available bindings and their specific configuration settings.",
    "Pay close attention to Dapr",
    "Pay close attention to Dapr",
    "TrafficControl",
    "TrafficControl",
    "Camera",
    "Camera",
    "In this example, Dapr triggers a service by invoking the /checkOrderBacklog endpoint every 30 minutes. There are several patterns available for specifying the schedule value. For more information, see the Cron binding documentation.",
    "In this example, Dapr triggers a service by invoking the /checkOrderBacklog endpoint every 30 minutes. There are several patterns available for specifying the schedule value. For more information, see the Cron binding documentation.",
    "2",
    "2",
    "In the Dapr Traffic Control sample application, the TrafficControl service uses the MQTT input binding to retrieve messages from the CameraSimulation. Figure 8-4 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr input binding is used in flows marked with number 5 in the diagram:",
    "In the Dapr Traffic Control sample application, the TrafficControl service uses the MQTT input binding to retrieve messages from the CameraSimulation. Figure 8-4 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr input binding is used in flows marked with number 5 in the diagram:",
    "SendFine",
    "SendFine",
    "FineCollection",
    "FineCollection",
    "Service",
    "Service",
    "VehicleRegistration",
    "VehicleRegistration",
    "Service",
    "Service",
    "Service invocation",
    "Service invocation",
    "2",
    "2",
    "Publish / subscribe",
    "Publish / subscribe",
    "Figure 8-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 8-4. Conceptual architecture of the Dapr Traffic Control sample application.",
    "12 - 3",
    "12 - 3",
    "EntryCam",
    "EntryCam",
    "MQTT is a lightweight pub/sub messaging protocol, often used in IoT scenarios. Producers sent MQTT messages to a topic; subscribers then retrieve messages from the topic. There are several MQTT message broker products available. The Traffic Control sample application uses Eclipse Mosquitto.",
    "MQTT is a lightweight pub/sub messaging protocol, often used in IoT scenarios. Producers sent MQTT messages to a topic; subscribers then retrieve messages from the topic. There are several MQTT message broker products available. The Traffic Control sample application uses Eclipse Mosquitto.",
    "The CameraSimulation doesn",
    "The CameraSimulation doesn",
    "The code uses a proxy of type ITrafficControlService to call the TrafficControl service. .NET injects an implementation of the ITrafficControlService interface using constructor injection:",
    "The code uses a proxy of type ITrafficControlService to call the TrafficControl service. .NET injects an implementation of the ITrafficControlService interface using constructor injection:",
    ":::{custom-style=CodeBox} csharp public CameraSimulation(int camNumber, ITrafficControlService trafficControlService) {     ",
    ":::{custom-style=CodeBox} csharp public CameraSimulation(int camNumber, ITrafficControlService trafficControlService) {     ",
    "The MqttTrafficControlService class implements the ITrafficControlService interface. It exposes two methods: SendVehicleEntryAsync and SendVehicleExitAsync . They both use the MQTT client to send messages to the trafficcontrol/entrycam and trafficcontrol/exitcam topics respectively:",
    "The MqttTrafficControlService class implements the ITrafficControlService interface. It exposes two methods: SendVehicleEntryAsync and SendVehicleExitAsync . They both use the MQTT client to send messages to the trafficcontrol/entrycam and trafficcontrol/exitcam topics respectively:",
    "The constructor sets up the MQTT client to send messages to the MQTT broker (Mosquitto) running on port 1883.",
    "The constructor sets up the MQTT client to send messages to the MQTT broker (Mosquitto) running on port 1883.",
    "On the other end, the TrafficControl service uses the MQTT input binding to receive VehicleRegistered messages sent by the CameraSimulation. For each subscribed topic, there",
    "On the other end, the TrafficControl service uses the MQTT input binding to receive VehicleRegistered messages sent by the CameraSimulation. For each subscribed topic, there",
    "separate component configuration file in the /dapr/components folder. The first one is entrycam.yaml :",
    "separate component configuration file in the /dapr/components folder. The first one is entrycam.yaml :",
    "The configuration specifies the binding type: bindings.mqtt . It also specifies that the broker runs on localhost:1883 , the standard port that Mosquitto uses. It also exposes the topic , trafficcontrol/entrycam . Using scopes , the config file specifies that only the service with app-id trafficcontrolservice will have access to the binding.",
    "The configuration specifies the binding type: bindings.mqtt . It also specifies that the broker runs on localhost:1883 , the standard port that Mosquitto uses. It also exposes the topic , trafficcontrol/entrycam . Using scopes , the config file specifies that only the service with app-id trafficcontrolservice will have access to the binding.",
    "When the TrafficControl service starts, the Dapr sidecar automatically subscribes to the trafficcontrol/entrycam MQTT topic specified in the component configuration. When messages arrive on the topic, the Dapr sidecar invokes an HTTP endpoint on your service. The sidecar determines the URL of the HTTP endpoint to call by looking at the metadata.name field in the binding configuration. In the example above, the endpoint URL is /entrycam . Within the TrafficControl service, no code needs to be added to support the endpoint:",
    "When the TrafficControl service starts, the Dapr sidecar automatically subscribes to the trafficcontrol/entrycam MQTT topic specified in the component configuration. When messages arrive on the topic, the Dapr sidecar invokes an HTTP endpoint on your service. The sidecar determines the URL of the HTTP endpoint to call by looking at the metadata.name field in the binding configuration. In the example above, the endpoint URL is /entrycam . Within the TrafficControl service, no code needs to be added to support the endpoint:",
    "The exitcam.yaml component configuration file configures everything for the exitcam endpoint:",
    "The exitcam.yaml component configuration file configures everything for the exitcam endpoint:",
    "TrafficControl",
    "TrafficControl",
    "5",
    "5",
    "dapr",
    "dapr",
    "mosquitto",
    "mosquitto",
    "The FineCollection service uses the Dapr SMTP output binding to send emails. Figure 8-5 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr input binding is used in flows marked with number 4 in the diagram:",
    "The FineCollection service uses the Dapr SMTP output binding to send emails. Figure 8-5 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr input binding is used in flows marked with number 4 in the diagram:",
    "Redis",
    "Redis",
    "FineCollection",
    "FineCollection",
    "Service",
    "Service",
    "VehicleRegistration",
    "VehicleRegistration",
    "Service",
    "Service",
    "2",
    "2",
    "Figure 8-5. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 8-5. Conceptual architecture of the Dapr Traffic Control sample application.",
    "The CollectFine method on the CollectionController in the FineCollection service contains code that uses the Dapr client to invoke the output binding:",
    "The CollectFine method on the CollectionController in the FineCollection service contains code that uses the Dapr client to invoke the output binding:",
    "12 - 3",
    "12 - 3",
    "EntryCam",
    "EntryCam",
    "5",
    "5",
    "Camera",
    "Camera",
    "Simulation",
    "Simulation",
    "The code uses a simple utility class to create an HTML email body containing the necessary information. It also creates a dictionary with metadata specific to the SMTP binding. This binding component interprets the metadata when invoked.",
    "The code uses a simple utility class to create an HTML email body containing the necessary information. It also creates a dictionary with metadata specific to the SMTP binding. This binding component interprets the metadata when invoked.",
    "The following arguments are required to invoke the binding:",
    "The following arguments are required to invoke the binding:",
    "The name of the binding component. In this case sendmail .",
    "The name of the binding component. In this case sendmail .",
    "The operation the binding needs to perform. In this case create .",
    "The operation the binding needs to perform. In this case create .",
    "The body of the message to send. In this case, the HTML email body.",
    "The body of the message to send. In this case, the HTML email body.",
    "The metadata for sending the email.",
    "The metadata for sending the email.",
    "The Dapr output binding named sendmail is configured in the email.yaml component configuration file in the /dapr/components folder:",
    "The Dapr output binding named sendmail is configured in the email.yaml component configuration file in the /dapr/components folder:",
    "The configuration specifies the binding type: bindings.smtp .",
    "The configuration specifies the binding type: bindings.smtp .",
    "The metadata section contains the information for connecting to the SMTP server. See the binding",
    "The metadata section contains the information for connecting to the SMTP server. See the binding",
    "The scopes element specifies that only the service with app-id finecollectonservice can access this binding.",
    "The scopes element specifies that only the service with app-id finecollectonservice can access this binding.",
    "The Traffic Control sample application uses MailDev. MailDev is a development SMTP server that doesn",
    "The Traffic Control sample application uses MailDev. MailDev is a development SMTP server that doesn",
    "Using Dapr bindings in the Traffic Control sample application provides the following benefits:",
    "Using Dapr bindings in the Traffic Control sample application provides the following benefits:",
    "Using MQTT messaging and SMTP without the need to learn this protocol or a specific MQTT API.",
    "Using MQTT messaging and SMTP without the need to learn this protocol or a specific MQTT API.",
    "Using SMTP to send an email without the need to learn this protocol or a specific SMTP API.",
    "Using SMTP to send an email without the need to learn this protocol or a specific SMTP API.",
    "Dapr resource bindings enable you to integrate with different external resources and systems without taking dependencies on their libraries o r SDKs. These external systems don",
    "Dapr resource bindings enable you to integrate with different external resources and systems without taking dependencies on their libraries o r SDKs. These external systems don",
    "Input bindings (or triggers) react to events occurring in an external system. They invoke the public HTTP endpoints pre-configured in your application. Dapr uses the name of the binding in the configuration to determine the endpoint to call in your application.",
    "Input bindings (or triggers) react to events occurring in an external system. They invoke the public HTTP endpoints pre-configured in your application. Dapr uses the name of the binding in the configuration to determine the endpoint to call in your application.",
    "Output bindings will send messages to an external system. You trigger an output binding by doing an HTTP POST on the /v1.0/bindings/",
    "Output bindings will send messages to an external system. You trigger an output binding by doing an HTTP POST on the /v1.0/bindings/",
    "You implement a binding with a Dapr component. These components are contributed by the community. Each binding component",
    "You implement a binding with a Dapr component. These components are contributed by the community. Each binding component",
    "Dapr documentation for resource bindings",
    "Dapr documentation for resource bindings",
    "Mosquitto MQTT broker",
    "Mosquitto MQTT broker",
    "MailDev development SMTP server",
    "MailDev development SMTP server",
    "The actor model originated in 1973. It was proposed by Carl Hewitt as a conceptual model of concurrent computation, a form of computing in which several computations are executed at the same time. Highly parallel computers weren",
    "The actor model originated in 1973. It was proposed by Carl Hewitt as a conceptual model of concurrent computation, a form of computing in which several computations are executed at the same time. Highly parallel computers weren",
    "In the actor model, the actor is an independent unit of compute and state. Actors are completely isolated from each other and they will never share memory. Actors communicate with each other using messages. When an actor receives a message, it can change its internal state, and send messages to other (possibly new) actors.",
    "In the actor model, the actor is an independent unit of compute and state. Actors are completely isolated from each other and they will never share memory. Actors communicate with each other using messages. When an actor receives a message, it can change its internal state, and send messages to other (possibly new) actors.",
    "The reason why the actor model makes writing concurrent systems easier is that it provides a turnbased (or single-threaded) access model. Multiple actors can run at the same time, but each actor will process received messages one at a time. This means that you can be sure that at most one thread is active inside an actor at any time. That makes writing correct concurrent and parallel systems much easier.",
    "The reason why the actor model makes writing concurrent systems easier is that it provides a turnbased (or single-threaded) access model. Multiple actors can run at the same time, but each actor will process received messages one at a time. This means that you can be sure that at most one thread is active inside an actor at any time. That makes writing correct concurrent and parallel systems much easier.",
    "Actor model implementations are usually tied to a specific language or platform. With the Dapr actors building block however, you can leverage the actor model from any language or platform.",
    "Actor model implementations are usually tied to a specific language or platform. With the Dapr actors building block however, you can leverage the actor model from any language or platform.",
    "Dapr",
    "Dapr",
    "While th e actor model can provide great benefits, it",
    "While th e actor model can provide great benefits, it",
    "Your problem space involves concurrency. Without actors, you",
    "Your problem space involves concurrency. Without actors, you",
    "Your problem space can be partitioned into small, independent, and isolated units of state and logic.",
    "Your problem space can be partitioned into small, independent, and isolated units of state and logic.",
    "You don",
    "You don",
    "You don",
    "You don",
    "One design pattern that fits these criteria quite well is the orchestration-based saga or process manager design pattern. A saga manages a sequence of steps that must be taken to reach some outcome. The saga (or process manager) maintains the current state of the sequence and triggers the next step. If a step fails, the saga can execute compensating actions. Actors make it easy to deal with concurrency in the saga and to keep track of the current state. The eShopOnDapr reference application uses the saga pattern and Dapr actors to implement the Ordering process.",
    "One design pattern that fits these criteria quite well is the orchestration-based saga or process manager design pattern. A saga manages a sequence of steps that must be taken to reach some outcome. The saga (or process manager) maintains the current state of the sequence and triggers the next step. If a step fails, the saga can execute compensating actions. Actors make it easy to deal with concurrency in the saga and to keep track of the current state. The eShopOnDapr reference application uses the saga pattern and Dapr actors to implement the Ordering process.",
    "The Dapr sidecar provides the HTTP/gRPC API to invoke actors. This is the base URL of the HTTP API:",
    "The Dapr sidecar provides the HTTP/gRPC API to invoke actors. This is the base URL of the HTTP API:",
    "http://localhost:",
    "http://localhost:",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "The sidecar manages how, when and where each actor runs, and also routes messages between act ors. When an actor hasn",
    "The sidecar manages how, when and where each actor runs, and also routes messages between act ors. When an actor hasn",
    "The sidecar API is only one part of the equation. The service itself also needs to implement an API specification, because the actual code that you write for the actor will run inside the service itself. Figure 11-1 shows the various API calls between the service and its sidecar:",
    "The sidecar API is only one part of the equation. The service itself also needs to implement an API specification, because the actual code that you write for the actor will run inside the service itself. Figure 11-1 shows the various API calls between the service and its sidecar:",
    "Service",
    "Service",
    "Invoke actor method",
    "Invoke actor method",
    "Get/persist actor state",
    "Get/persist actor state",
    "Create/Get/Delete reminder -",
    "Create/Get/Delete reminder -",
    "\u2192",
    "\u2192",
    "Figure 11-1. API calls between actor service and Dapr sidecar.",
    "Figure 11-1. API calls between actor service and Dapr sidecar.",
    "To provide scalability and reliability, actors are partitioned across all the instances of the actor service. The Dapr placement service is responsible for keeping track of the partitioning information. When a new instance of an actor service is started, the sidecar registers the supported actor types with the placement service. The placement service calculates the updated partitioning information for the given actor type and broadcasts it to all instances. Figure 11-2 shows what happens when a service is scaled out to a second replica:",
    "To provide scalability and reliability, actors are partitioned across all the instances of the actor service. The Dapr placement service is responsible for keeping track of the partitioning information. When a new instance of an actor service is started, the sidecar registers the supported actor types with the placement service. The placement service calculates the updated partitioning information for the given actor type and broadcasts it to all instances. Figure 11-2 shows what happens when a service is scaled out to a second replica:",
    ":::image type=",
    ":::image type=",
    "Figure 11-2. Actor placement service.",
    "Figure 11-2. Actor placement service.",
    "On startup, the sidecar makes a call to the actor service to get the registered actor types as well as actor configuration settings.",
    "On startup, the sidecar makes a call to the actor service to get the registered actor types as well as actor configuration settings.",
    "The sidecar sends the list of registered actor types to the placement service.",
    "The sidecar sends the list of registered actor types to the placement service.",
    "The placement service broadcasts the updated partitioning information to all actor service instances. Each instance will keep a cached copy of the partitioning information and use it to invoke actors.",
    "The placement service broadcasts the updated partitioning information to all actor service instances. Each instance will keep a cached copy of the partitioning information and use it to invoke actors.",
    "Because actors are randomly distributed across service instances, it should be expected that an actor operation always requires a call to a different node in the network.",
    "Because actors are randomly distributed across service instances, it should be expected that an actor operation always requires a call to a different node in the network.",
    "POST http://localhost:3500/1.0/actors/OrderActor/3/method/ship",
    "POST http://localhost:3500/1.0/actors/OrderActor/3/method/ship",
    "The next figure shows an ordering service instance running in Pod 1 call the ship method of an OrderActor instance with ID 3 . Because the actor with ID 3 is placed in a different instance, this results in a call to a different node in the cluster:",
    "The next figure shows an ordering service instance running in Pod 1 call the ship method of an OrderActor instance with ID 3 . Because the actor with ID 3 is placed in a different instance, this results in a call to a different node in the cluster:",
    "Ordering",
    "Ordering",
    "Service",
    "Service",
    "Ordering",
    "Ordering",
    "Service",
    "Service",
    "Figure 11-3. Calling an actor method.",
    "Figure 11-3. Calling an actor method.",
    "The service calls the actor API on the sidecar. The JSON payload in the request body contains the data to send to the actor.",
    "The service calls the actor API on the sidecar. The JSON payload in the request body contains the data to send to the actor.",
    "The sidecar uses the locally cached partitioning information from the placement service to determine which actor service instance (partition) is responsible for hosting the actor with ID 3 . In this example, it",
    "The sidecar uses the locally cached partitioning information from the placement service to determine which actor service instance (partition) is responsible for hosting the actor with ID 3 . In this example, it",
    "The sidecar instance in pod 2 calls the service instance to invoke the actor. The service instance activates the actor (if it hasn",
    "The sidecar instance in pod 2 calls the service instance to invoke the actor. The service instance activates the actor (if it hasn",
    "Actor",
    "Actor",
    "Actor dapr Sidecar",
    "Actor dapr Sidecar",
    "The turnbased access model ensures that at any time there",
    "The turnbased access model ensures that at any time there",
    "Let",
    "Let",
    "In traditional programming models, you can solve this problem by introducing locking mechanisms. For example:",
    "In traditional programming models, you can solve this problem by introducing locking mechanisms. For example:",
    "Unfortunately, using explicit locking mechanisms is error-prone. They can easily lead to deadlocks and can have serious impact on performance.",
    "Unfortunately, using explicit locking mechanisms is error-prone. They can easily lead to deadlocks and can have serious impact on performance.",
    "Thanks to the turnbased access model, you don",
    "Thanks to the turnbased access model, you don",
    "Actors can use timers and reminders to schedule calls to themselves. Both concepts support the configuration of a due time. The difference lies in the lifetime of the callback registrations:",
    "Actors can use timers and reminders to schedule calls to themselves. Both concepts support the configuration of a due time. The difference lies in the lifetime of the callback registrations:",
    "Timers will only stay active as long as the actor is activated. Timers will not reset the idle-timer, so they cannot keep an actor active on their own.",
    "Timers will only stay active as long as the actor is activated. Timers will not reset the idle-timer, so they cannot keep an actor active on their own.",
    "Reminders outlive actor activations. If an actor is deactivated, a reminder will re-activate the actor. Reminders will reset the idle-timer.",
    "Reminders outlive actor activations. If an actor is deactivated, a reminder will re-activate the actor. Reminders will reset the idle-timer.",
    "Timers are registered by making a call to the actor API. In the following example, a timer is registered with a due time of 0 and a period of 10 seconds.",
    "Timers are registered by making a call to the actor API. In the following example, a timer is registered with a due time of 0 and a period of 10 seconds.",
    "Because the due time is 0, the timer will fire immediately. After a timer callback has finished, the timer will wait 10 seconds before firing again.",
    "Because the due time is 0, the timer will fire immediately. After a timer callback has finished, the timer will wait 10 seconds before firing again.",
    "Reminders are registered in a similar way. The following example shows a reminder registration with a due time of 5 minutes, and an empty period:",
    "Reminders are registered in a similar way. The following example shows a reminder registration with a due time of 5 minutes, and an empty period:",
    "This reminder will fire in 5 minutes. Because the given period is empty, this will be a one-time reminder.",
    "This reminder will fire in 5 minutes. Because the given period is empty, this will be a one-time reminder.",
    "Timers and reminders both respect the turn-based access model. When a timer or reminder fires, the callback will not be executed until any other method invocation or timer/reminder callback has finished.",
    "Timers and reminders both respect the turn-based access model. When a timer or reminder fires, the callback will not be executed until any other method invocation or timer/reminder callback has finished.",
    "Actor state is persisted using the Dapr state management building block. Because actors can execute multiple state operations in a single turn, the state store component must support multi-item transactions. At the time of writing, the following state stores support multi-item transactions:",
    "Actor state is persisted using the Dapr state management building block. Because actors can execute multiple state operations in a single turn, the state store component must support multi-item transactions. At the time of writing, the following state stores support multi-item transactions:",
    "Azure Cosmos DB",
    "Azure Cosmos DB",
    "MongoDB",
    "MongoDB",
    "MySQL",
    "MySQL",
    "PostgreSQL",
    "PostgreSQL",
    "Redis",
    "Redis",
    "RethinkDB",
    "RethinkDB",
    "SQL Server",
    "SQL Server",
    "To configure a state store component for use with actors, you need to append the following metadata to the state store configuration:",
    "To configure a state store component for use with actors, you need to append the following metadata to the state store configuration:",
    "Here",
    "Here",
    "You can create an actor model implementation using only HTTP/gRPC calls. However, it",
    "You can create an actor model implementation using only HTTP/gRPC calls. However, it",
    "To get started with the .NET Dapr actors SDK, you add a package reference to Dapr.Actors to your service project. The first step of creating an actual actor is to define an interface that derives from IActor . Clients use the interface to invoke operations on the actor. Here",
    "To get started with the .NET Dapr actors SDK, you add a package reference to Dapr.Actors to your service project. The first step of creating an actual actor is to define an interface that derives from IActor . Clients use the interface to invoke operations on the actor. Here",
    "The return type of an actor method must be Task or Task",
    "The return type of an actor method must be Task or Task",
    "Next, implement the actor by deriving a ScoreActor class from Actor . The ScoreActor class must also implement the IScoreActor interface:",
    "Next, implement the actor by deriving a ScoreActor class from Actor . The ScoreActor class must also implement the IScoreActor interface:",
    "The constructor in the snippet above takes a host argument of type ActorHost . The ActorHost class represents the host for an actor type within the actor runtime. You need to pass this argument to the constructor of the Actor base class. Actors also support dependency injection. Any additional arguments that you add to the actor constructor are resolved using the .NET dependency injection container.",
    "The constructor in the snippet above takes a host argument of type ActorHost . The ActorHost class represents the host for an actor type within the actor runtime. You need to pass this argument to the constructor of the Actor base class. Actors also support dependency injection. Any additional arguments that you add to the actor constructor are resolved using the .NET dependency injection container.",
    "Let",
    "Let",
    "In the snippet above, a single call to StateManager.AddOrUpdateStateAsync provides the full implementation for the IncrementScoreAsync method. The AddOrUpdateStateAsync method takes three arguments:",
    "In the snippet above, a single call to StateManager.AddOrUpdateStateAsync provides the full implementation for the IncrementScoreAsync method. The AddOrUpdateStateAsync method takes three arguments:",
    "The key of the state to update.",
    "The key of the state to update.",
    "The value to write if no score is stored in the state store yet.",
    "The value to write if no score is stored in the state store yet.",
    "A Func to call if there already is a score stored in the state store. It takes the state key and current score, and returns the updated score to write back to the state store.",
    "A Func to call if there already is a score stored in the state store. It takes the state key and current score, and returns the updated score to write back to the state store.",
    "The GetScoreAsync implementation reads the current score from the state store and returns it to the client:",
    "The GetScoreAsync implementation reads the current score from the state store and returns it to the client:",
    "To host actors in an ASP.NET Core service, you must add a reference to the Dapr.Actors.AspNetCore package and make some changes in the Program file. In the following example, the call to MapActorsHandlers registers Dapr Actor endpoints in ASP.NET Core routing:",
    "To host actors in an ASP.NET Core service, you must add a reference to the Dapr.Actors.AspNetCore package and make some changes in the Program file. In the following example, the call to MapActorsHandlers registers Dapr Actor endpoints in ASP.NET Core routing:",
    "The actors endpoints are necessary because the Dapr sidecar calls the application to host and interact with actor instances.",
    "The actors endpoints are necessary because the Dapr sidecar calls the application to host and interact with actor instances.",
    "Make sure your Program (or Startup ) class does not contain an app.UseHttpsRedirection call to redirect clients to the HTTPS endpoint. This will not work with actors. By design, a Dapr sidecar sends requests over unencrypted HTTP by default. The HTTPS middleware will block these requests when enabled.",
    "Make sure your Program (or Startup ) class does not contain an app.UseHttpsRedirection call to redirect clients to the HTTPS endpoint. This will not work with actors. By design, a Dapr sidecar sends requests over unencrypted HTTP by default. The HTTPS middleware will block these requests when enabled.",
    "The Program file is also the place to register the specific actor types. The following example registers the ScoreActor using the AddActors extension method:",
    "The Program file is also the place to register the specific actor types. The following example registers the ScoreActor using the AddActors extension method:",
    "At this point, the ASP.NET Core service is ready to host the ScoreActor and accept incoming requests. Client applications use actor proxies to invoke operations on actors. The following example shows how a console client application invokes the IncrementScoreAsync operation on a ScoreActor instance:",
    "At this point, the ASP.NET Core service is ready to host the ScoreActor and accept incoming requests. Client applications use actor proxies to invoke operations on actors. The following example shows how a console client application invokes the IncrementScoreAsync operation on a ScoreActor instance:",
    "The above example uses the Dapr.Actors package to call the actor service. To invoke an operation on an actor, you need to be able to address it. You",
    "The above example uses the Dapr.Actors package to call the actor service. To invoke an operation on an actor, you need to be able to address it. You",
    "The actor type uniquely identifies the actor implementation across the whole application. By default, the actor type is the name of the implementation class (without namespace). You can customize the actor type by adding an ActorAttribute to the implementation class and setting its TypeName property.",
    "The actor type uniquely identifies the actor implementation across the whole application. By default, the actor type is the name of the implementation class (without namespace). You can customize the actor type by adding an ActorAttribute to the implementation class and setting its TypeName property.",
    "The ActorId uniquely identifies an instance of an actor type. You can also use this class to generate a random actor id by calling ActorId.CreateRandom .",
    "The ActorId uniquely identifies an instance of an actor type. You can also use this class to generate a random actor id by calling ActorId.CreateRandom .",
    "The example uses ActorProxy.Create to create a proxy instance for the ScoreActor . The Create method takes two arguments: the ActorId identifying the specific actor and the actor type. It also has a generic type parameter to specify the actor interface that the actor type implements. As both the server and client applications need to use the actor interfaces, they",
    "The example uses ActorProxy.Create to create a proxy instance for the ScoreActor . The Create method takes two arguments: the ActorId identifying the specific actor and the actor type. It also has a generic type parameter to specify the actor interface that the actor type implements. As both the server and client applications need to use the actor interfaces, they",
    "The final step in the example calls the IncrementScoreAsync method on the actor and outputs the result. Remember that the Dapr placement service distributes the actor instances across the Dapr sidecars. Therefore, expect an actor call to be a network call to another node.",
    "The final step in the example calls the IncrementScoreAsync method on the actor and outputs the result. Remember that the Dapr placement service distributes the actor instances across the Dapr sidecars. Therefore, expect an actor call to be a network call to another node.",
    "The console client example in the previous section uses the static ActorProxy.Create method directly to get an actor proxy instance. If the client application is an ASP.NET Core application, you should use the IActorProxyFactory interface to create actor proxies. The main benefit is that it allows you to manage configuration in one place. The AddActors extension method on IServiceCollection takes a delegate that allows you to specify actor runtime options, such as the HTTP endpoint of the Dapr sidecar. The following example specifies custom JsonSerializerOptions to use for actor state persistence and message deserialization:",
    "The console client example in the previous section uses the static ActorProxy.Create method directly to get an actor proxy instance. If the client application is an ASP.NET Core application, you should use the IActorProxyFactory interface to create actor proxies. The main benefit is that it allows you to manage configuration in one place. The AddActors extension method on IServiceCollection takes a delegate that allows you to specify actor runtime options, such as the HTTP endpoint of the Dapr sidecar. The following example specifies custom JsonSerializerOptions to use for actor state persistence and message deserialization:",
    "The call to AddActors registers the IActorProxyFactory for .NET dependency injection. This allows ASP.NET Core to inject an IActorProxyFactory instance into your controller classes. The following example calls an actor method from an ASP.NET Core controller class:",
    "The call to AddActors registers the IActorProxyFactory for .NET dependency injection. This allows ASP.NET Core to inject an IActorProxyFactory instance into your controller classes. The following example calls an actor method from an ASP.NET Core controller class:",
    "Actors can also call other actors directly. The Actor base class exposes an IActorProxyFactory class through the ProxyFactory property. To create an actor proxy from within an actor, use the ProxyFactory property of the Actor base class. The following example shows an OrderActor that invokes operations on two other actors:",
    "Actors can also call other actors directly. The Actor base class exposes an IActorProxyFactory class through the ProxyFactory property. To create an actor proxy from within an actor, use the ProxyFactory property of the Actor base class. The following example shows an OrderActor that invokes operations on two other actors:",
    "By default, Dapr actors aren",
    "By default, Dapr actors aren",
    "So far, the examples used strongly-typed actor proxies based on .NET interfaces to illustrate actor invocations. This works great when both the actor host and client are .NET applications. However, if the actor host is not a .NET application, you don",
    "So far, the examples used strongly-typed actor proxies based on .NET interfaces to illustrate actor invocations. This works great when both the actor host and client are .NET applications. However, if the actor host is not a .NET application, you don",
    "You create weakly-typed proxies in a similar way to strongly-typed proxies. Instead of relying on a .NET interface, you need to pass in the actor method name as a string.",
    "You create weakly-typed proxies in a similar way to strongly-typed proxies. Instead of relying on a .NET interface, you need to pass in the actor method name as a string.",
    "Use the RegisterTimerAsync method of the Actor base class to schedule actor timers. In the following example, a TimerActor exposes a StartTimerAsync method. Clients can call the method to start a timer that repeatedly writes a given text to the log output.",
    "Use the RegisterTimerAsync method of the Actor base class to schedule actor timers. In the following example, a TimerActor exposes a StartTimerAsync method. Clients can call the method to start a timer that repeatedly writes a given text to the log output.",
    "The StartTimerAsync method calls RegisterTimerAsync to schedule the timer. RegisterTimerAsync takes five arguments:",
    "The StartTimerAsync method calls RegisterTimerAsync to schedule the timer. RegisterTimerAsync takes five arguments:",
    "The name of the timer.",
    "The name of the timer.",
    "The name of the method to call when the timer fires.",
    "The name of the method to call when the timer fires.",
    "The state to pass to the callback method.",
    "The state to pass to the callback method.",
    "The amount of time to wait before the callback method is first invoked.",
    "The amount of time to wait before the callback method is first invoked.",
    "The time interval between callback method invocations. You can specify TimeSpan.FromMilliseconds(-1) to disable periodic signaling.",
    "The time interval between callback method invocations. You can specify TimeSpan.FromMilliseconds(-1) to disable periodic signaling.",
    "The TimerCallbackAsync method receives the user state in binary form. In the example, the callback decodes the state back to a string before writing it to the log.",
    "The TimerCallbackAsync method receives the user state in binary form. In the example, the callback decodes the state back to a string before writing it to the log.",
    "Timers can be stopped by calling UnregisterTimerAsync :",
    "Timers can be stopped by calling UnregisterTimerAsync :",
    "Remember that timers do not reset the actor idle timer. When no other calls are made on the actor, it may be deactivated and the timer will be stopped automatically. To schedule work that does reset the idle timer, use reminders which we",
    "Remember that timers do not reset the actor idle timer. When no other calls are made on the actor, it may be deactivated and the timer will be stopped automatically. To schedule work that does reset the idle timer, use reminders which we",
    "To use reminders in an actor, your actor class must implement the IRemindable interface:",
    "To use reminders in an actor, your actor class must implement the IRemindable interface:",
    "The ReceiveReminderAsync method is called when a reminder is fired. It takes 4 arguments:",
    "The ReceiveReminderAsync method is called when a reminder is fired. It takes 4 arguments:",
    "The name of the reminder.",
    "The name of the reminder.",
    "The user state provided during registration.",
    "The user state provided during registration.",
    "The invocation due time provided during registration.",
    "The invocation due time provided during registration.",
    "The invocation period provided during registration.",
    "The invocation period provided during registration.",
    "To register a reminder, use the RegisterReminderAsync method of the actor base class. The following example sets a reminder to fire a single time with a due time of three minutes.",
    "To register a reminder, use the RegisterReminderAsync method of the actor base class. The following example sets a reminder to fire a single time with a due time of three minutes.",
    "The RegisterReminderAsync method is similar to RegisterTimerAsync but you don",
    "The RegisterReminderAsync method is similar to RegisterTimerAsync but you don",
    "Reminders both reset the idle timer and are persistent. Even if your actor is deactivated, it will be reactivated at the moment a reminder fires. To stop a reminder from firing, call UnregisterReminderAsync .",
    "Reminders both reset the idle timer and are persistent. Even if your actor is deactivated, it will be reactivated at the moment a reminder fires. To stop a reminder from firing, call UnregisterReminderAsync .",
    "The default version of Dapr Traffic Control does not use the actor model. However, it does contain an alternative actor-based implementation of the TrafficControl service that you can enable. To make use of actors in the TrafficControl service, open up the src/TrafficControlService/Controllers/TrafficController.cs file and uncomment the USE",
    "The default version of Dapr Traffic Control does not use the actor model. However, it does contain an alternative actor-based implementation of the TrafficControl service that you can enable. To make use of actors in the TrafficControl service, open up the src/TrafficControlService/Controllers/TrafficController.cs file and uncomment the USE",
    "When the actor model is enabled, the application uses actors to represent vehicles. The operations that can be invoked on the vehicle actors are defined in an IVehicleActor interface:",
    "When the actor model is enabled, the application uses actors to represent vehicles. The operations that can be invoked on the vehicle actors are defined in an IVehicleActor interface:",
    "The (simulated) entry cameras call the RegisterEntryAsync method when a new vehicle is first detected in the lane. The only responsibility of this method is storing the entry timestamp in the actor state:",
    "The (simulated) entry cameras call the RegisterEntryAsync method when a new vehicle is first detected in the lane. The only responsibility of this method is storing the entry timestamp in the actor state:",
    "When the vehicle reaches the end of the speed camera zone, the exit camera calls the RegisterExitAsync method. The RegisterExitAsync method first gets the current states and updates it to include the exit timestamp:",
    "When the vehicle reaches the end of the speed camera zone, the exit camera calls the RegisterExitAsync method. The RegisterExitAsync method first gets the current states and updates it to include the exit timestamp:",
    "The code above currently assumes that a VehicleState instance has already been saved by the RegisterEntryAsync method. The code could be improved by first checking to make sure the state exists. Thanks to the turn-based access model, no explicit locks are required in the code.",
    "The code above currently assumes that a VehicleState instance has already been saved by the RegisterEntryAsync method. The code could be improved by first checking to make sure the state exists. Thanks to the turn-based access model, no explicit locks are required in the code.",
    "After the state is updated, the RegisterExitAsync method checks if the vehicle was driving too fast. If it was, the actor publishes a message to the collectfine pub/sub topic:",
    "After the state is updated, the RegisterExitAsync method checks if the vehicle was driving too fast. If it was, the actor publishes a message to the collectfine pub/sub topic:",
    "The code above uses two external dependencies. The ",
    "The code above uses two external dependencies. The ",
    "Both dependencies are registered in the Program.cs class and injected into the actor using constructor dependency injection:",
    "Both dependencies are registered in the Program.cs class and injected into the actor using constructor dependency injection:",
    "The actor based implementation no longer uses the Dapr state management building block directly. Instead, the state is automatically persisted after each operation is executed.",
    "The actor based implementation no longer uses the Dapr state management building block directly. Instead, the state is automatically persisted after each operation is executed.",
    "The Dapr actors building block makes it easier to write correct concurrent systems. Actors are small units of state and logic. They use a turn-based access model which saves you from having to use locking mechanisms to write thread-safe code. Actors are created implicitly and are silently unloaded",
    "The Dapr actors building block makes it easier to write correct concurrent systems. Actors are small units of state and logic. They use a turn-based access model which saves you from having to use locking mechanisms to write thread-safe code. Actors are created implicitly and are silently unloaded",
    "from memory when no operations are performed. Any state stored in the actor is automatically persisted and loaded when the actor is reactivated. Actor model implementations are typically created for a specific language or platform. With the Dapr actors building block however, you can leverage the actor model from any language or platform.",
    "from memory when no operations are performed. Any state stored in the actor is automatically persisted and loaded when the actor is reactivated. Actor model implementations are typically created for a specific language or platform. With the Dapr actors building block however, you can leverage the actor model from any language or platform.",
    "Actors support timers and reminders to schedule future work. Timers do not reset the idle timer and will allow the actor to be deactivated when no other operations are performed. Reminders do reset the idle timer and are also persisted automatically. Both timers and reminders respect the turn-based access model, making sure that no other operations can execute while the timer/reminder events are handled.",
    "Actors support timers and reminders to schedule future work. Timers do not reset the idle timer and will allow the actor to be deactivated when no other operations are performed. Reminders do reset the idle timer and are also persisted automatically. Both timers and reminders respect the turn-based access model, making sure that no other operations can execute while the timer/reminder events are handled.",
    "Actor state is persisted using the Dapr state management building block. Any state store that supports multi-item transactions can be used to store actor state.",
    "Actor state is persisted using the Dapr state management building block. Any state store that supports multi-item transactions can be used to store actor state.",
    "Dapr supported state stores",
    "Dapr supported state stores",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently deployable services. These services cross process and server boundaries. They then consume different kinds of infrastructure backing services (databases, message brokers, key vaults). Finally, these disparate pieces compose together to form an application.",
    "Modern distributed systems are complex. You start with small, loosely coupled, independently deployable services. These services cross process and server boundaries. They then consume different kinds of infrastructure backing services (databases, message brokers, key vaults). Finally, these disparate pieces compose together to form an application.",
    "With so many separate, moving parts, how do you make sense of what is going on? Unfortunately, legacy monitoring approaches from the past aren",
    "With so many separate, moving parts, how do you make sense of what is going on? Unfortunately, legacy monitoring approaches from the past aren",
    "The system information used to gain observability is referred to as telemetry . It can be divided into four broad categories:",
    "The system information used to gain observability is referred to as telemetry . It can be divided into four broad categories:",
    "Distributed tracing provides insights into the traffic between services involved in distributed business transactions.",
    "Distributed tracing provides insights into the traffic between services involved in distributed business transactions.",
    "Metrics provides insights into the performance of a service and its resource consumption.",
    "Metrics provides insights into the performance of a service and its resource consumption.",
    "Logging provides insights into how code is executing and if errors have occurred.",
    "Logging provides insights into how code is executing and if errors have occurred.",
    "Health endpoints provide insight into the availability of a service.",
    "Health endpoints provide insight into the availability of a service.",
    "The depth of telemetry is determined by the observability features of an application platform. Consider the Azure cloud. It provides a rich telemetry experience that includes all of the telemetry categories. With little configuration, Azure IaaS and PaaS services will propagate and publish telemetry to the Azure Monitor and Azure Application Insights services. Application Insights presents system logging, tracing, and problem areas with highly visual dashboards. It can even render a diagram showing the dependencies between services based on their communication.",
    "The depth of telemetry is determined by the observability features of an application platform. Consider the Azure cloud. It provides a rich telemetry experience that includes all of the telemetry categories. With little configuration, Azure IaaS and PaaS services will propagate and publish telemetry to the Azure Monitor and Azure Application Insights services. Application Insights presents system logging, tracing, and problem areas with highly visual dashboards. It can even render a diagram showing the dependencies between services based on their communication.",
    "However, what if an application can",
    "However, what if an application can",
    "With Dapr, you can. Let",
    "With Dapr, you can. Let",
    "Service A",
    "Service A",
    "1",
    "1",
    "Service A",
    "Service A",
    "sidecar dapr",
    "sidecar dapr",
    "0",
    "0",
    "2",
    "2",
    "Collector",
    "Collector",
    "The Dapr observability building block decouples observability from the application. It automatically captures traffic generated by Dapr sidecars and Dapr system services that make up the Dapr control plane. The block correlates traffic from a single operation that spans multiple services. It also exposes performance metrics, resource utilization, and the health of the system. Telemetry is published in open-standard formats enabling information to be fed into your monitoring back end of choice. There, the information can be visualized, queried, and analyzed.",
    "The Dapr observability building block decouples observability from the application. It automatically captures traffic generated by Dapr sidecars and Dapr system services that make up the Dapr control plane. The block correlates traffic from a single operation that spans multiple services. It also exposes performance metrics, resource utilization, and the health of the system. Telemetry is published in open-standard formats enabling information to be fed into your monitoring back end of choice. There, the information can be visualized, queried, and analyzed.",
    "As Dapr abstracts away the plumbing, the application is unaware of how observability is implemented. There",
    "As Dapr abstracts away the plumbing, the application is unaware of how observability is implemented. There",
    "Dapr",
    "Dapr",
    "Dapr provides collectors that can publish telemetry to different back-end monitoring tools. These tools present Dapr telemetry for analysis and querying. Figure 10-1 shows the Dapr observability architecture:",
    "Dapr provides collectors that can publish telemetry to different back-end monitoring tools. These tools present Dapr telemetry for analysis and querying. Figure 10-1 shows the Dapr observability architecture:",
    "Figure 10-1. Dapr observability architecture.",
    "Figure 10-1. Dapr observability architecture.",
    "Service A calls an operation on Service B. The call is routed from a Dapr sidecar for Service A to a sidecar for Service B.",
    "Service A calls an operation on Service B. The call is routed from a Dapr sidecar for Service A to a sidecar for Service B.",
    "When Service B completes the operation, a response is sent back to Service A through the Dapr sidecars. They gather and publish all available telemetry for every request and response.",
    "When Service B completes the operation, a response is sent back to Service A through the Dapr sidecars. They gather and publish all available telemetry for every request and response.",
    "The configured collector ingests the telemetry and sends it to the monitoring back end.",
    "The configured collector ingests the telemetry and sends it to the monitoring back end.",
    "Service B",
    "Service B",
    "sidecar dapr",
    "sidecar dapr",
    "-2",
    "-2",
    "Service B",
    "Service B",
    "Service A",
    "Service A",
    "dapr",
    "dapr",
    "Service C",
    "Service C",
    "A",
    "A",
    "As a developer, keep in mind that adding observability is different from configuring other Dapr building blocks, like pub/sub or state management. Instead of referencing a building block, you add a collector and a monitoring back end. Figure 101 shows it",
    "As a developer, keep in mind that adding observability is different from configuring other Dapr building blocks, like pub/sub or state management. Instead of referencing a building block, you add a collector and a monitoring back end. Figure 101 shows it",
    "Service A",
    "Service A",
    "Service C",
    "Service C",
    "At the beginning of this chapter, four categories of telemetry were identified. The following sections will provide detail for each category. They",
    "At the beginning of this chapter, four categories of telemetry were identified. The following sections will provide detail for each category. They",
    "Distributed tracing provides insight into traffic that flows across services in a distributed application. The logs of exchanged request and response messages are a source of invaluable information for troubleshooting issues. The hard part is correlating messages that belong to the same business transaction.",
    "Distributed tracing provides insight into traffic that flows across services in a distributed application. The logs of exchanged request and response messages are a source of invaluable information for troubleshooting issues. The hard part is correlating messages that belong to the same business transaction.",
    "Dapr uses the W3C Trace Context to correlate related messages. It injects the same context information into requests and responses that form a unique operation. Figure 10-2 shows how correlation works:",
    "Dapr uses the W3C Trace Context to correlate related messages. It injects the same context information into requests and responses that form a unique operation. Figure 10-2 shows how correlation works:",
    "The trace context is often referred to as a correlation token in microservice terminology.",
    "The trace context is often referred to as a correlation token in microservice terminology.",
    "Figure 10-2. W3C Trace Context example.",
    "Figure 10-2. W3C Trace Context example.",
    "Service A invokes an operation on Service B. As Service A starts the call, Dapr creates a unique trace context and injects it into the request.",
    "Service A invokes an operation on Service B. As Service A starts the call, Dapr creates a unique trace context and injects it into the request.",
    "Service B receives the request and invokes an operation on Service C. Dapr detects that the incoming request contains a trace context and propagates it by injecting it into the outgoing request to Service C.",
    "Service B receives the request and invokes an operation on Service C. Dapr detects that the incoming request contains a trace context and propagates it by injecting it into the outgoing request to Service C.",
    "Service C receives the request and handles it. Dapr detects that the incoming request contains a trace context and propagates it by injecting it into the outgoing response back to Service B.",
    "Service C receives the request and handles it. Dapr detects that the incoming request contains a trace context and propagates it by injecting it into the outgoing response back to Service B.",
    "Service B receives the response and handles it. It then creates a new response and propagates the trace context by injecting it into the outgoing response back to Service A.",
    "Service B receives the response and handles it. It then creates a new response and propagates the trace context by injecting it into the outgoing response back to Service A.",
    "A set of requests and responses that belong together is called a trace . Figure 10-3 shows a trace:",
    "A set of requests and responses that belong together is called a trace . Figure 10-3 shows a trace:",
    "Service B",
    "Service B",
    "Span",
    "Span",
    "Trace",
    "Trace",
    "A =\u2192 B",
    "A =\u2192 B",
    "Figure 10-3. Traces and spans.",
    "Figure 10-3. Traces and spans.",
    "In the figure, note how the trace represents a unique application transaction that takes place across many services. A trace is a collection of spans . Each span represents a single operation or unit of work done within the trace. Spans are the requests and responses that are sent between services that implement the unique transaction.",
    "In the figure, note how the trace represents a unique application transaction that takes place across many services. A trace is a collection of spans . Each span represents a single operation or unit of work done within the trace. Spans are the requests and responses that are sent between services that implement the unique transaction.",
    "The next sections discuss how to inspect tracing telemetry by publishing it to a monitoring back end.",
    "The next sections discuss how to inspect tracing telemetry by publishing it to a monitoring back end.",
    "Zipkin is an open-source distributed tracing system. It can ingest and visualize telemetry data. Dapr offers default support for Zipkin. The following example demonstrates how to configure Zipkin to visualize Dapr telemetry.",
    "Zipkin is an open-source distributed tracing system. It can ingest and visualize telemetry data. Dapr offers default support for Zipkin. The following example demonstrates how to configure Zipkin to visualize Dapr telemetry.",
    "To start , tracing must be enabled for the Dapr runtime using a Dapr configuration file. Here",
    "To start , tracing must be enabled for the Dapr runtime using a Dapr configuration file. Here",
    "The samplingRate attribute specifies the interval used for publishing traces. The value must be between 0 (tracing disabled) and 1 (every trace is published). With a value of 0.5 , for example, every other trace is published, significantly reducing published traffic. The endpointAddress points to an endpoint on a Zipkin server running in a Kubernetes cluster. The default port for Zipkin is 9411 . The configuration must be applied to the Kubernetes cluster using the Kubernetes CLI:",
    "The samplingRate attribute specifies the interval used for publishing traces. The value must be between 0 (tracing disabled) and 1 (every trace is published). With a value of 0.5 , for example, every other trace is published, significantly reducing published traffic. The endpointAddress points to an endpoint on a Zipkin server running in a Kubernetes cluster. The default port for Zipkin is 9411 . The configuration must be applied to the Kubernetes cluster using the Kubernetes CLI:",
    "When installing Dapr in self-hosted mode, a Zipkin server is automatically installed and tracing is enabled in the default configuration file located in $HOME/.dapr/config.yaml or %USERPROFILE%",
    "When installing Dapr in self-hosted mode, a Zipkin server is automatically installed and tracing is enabled in the default configuration file located in $HOME/.dapr/config.yaml or %USERPROFILE%",
    "When installing Dapr on a Kubernetes cluster, Zipkin must be deployed manually. Use the following Kubernetes manifest file entitled zipkin.yaml to deploy a standard Zipkin server to a Kubernetes cluster:",
    "When installing Dapr on a Kubernetes cluster, Zipkin must be deployed manually. Use the following Kubernetes manifest file entitled zipkin.yaml to deploy a standard Zipkin server to a Kubernetes cluster:",
    "The deployment uses the standard openzipkin/zipkin-slim container image. The Zipkin service exposes the Zipkin web front end, which you can use to view the telemetry on port 32411 . Use the",
    "The deployment uses the standard openzipkin/zipkin-slim container image. The Zipkin service exposes the Zipkin web front end, which you can use to view the telemetry on port 32411 . Use the",
    "Kubernetes CLI to apply the Zipkin manifest file to the Kubernetes cluster and deploy the Zipkin server:",
    "Kubernetes CLI to apply the Zipkin manifest file to the Kubernetes cluster and deploy the Zipkin server:",
    "kubectl apply -f zipkin.yaml",
    "kubectl apply -f zipkin.yaml",
    "Now everything is set up correctly to start publishing telemetry. Every Dapr sidecar that is deployed as part of the application must be instructed to emit telemetry when started. To do that, add a dapr.io/config annotation that references the dapr-config configuration to the deployment of each service. Here",
    "Now everything is set up correctly to start publishing telemetry. Every Dapr sidecar that is deployed as part of the application must be instructed to emit telemetry when started. To do that, add a dapr.io/config annotation that references the dapr-config configuration to the deployment of each service. Here",
    "Once the application is started, the Dapr sidecars will emit telemetry to the Zipkin server. To inspect this telemetry, point a web-browser to http://localhost:32411 . You",
    "Once the application is started, the Dapr sidecars will emit telemetry to the Zipkin server. To inspect this telemetry, point a web-browser to http://localhost:32411 . You",
    "Zipkin",
    "Zipkin",
    "Zipkin",
    "Zipkin",
    "10 Results",
    "10 Results",
    "Root trafficcontrolservice: bindings/exitcam",
    "Root trafficcontrolservice: bindings/exitcam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/exitcam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/exitcam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/entrycam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/entrycam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/entrycam",
    "trafficcontrolservice: bindings/exitcam trafficcontrolservice: bindings/entrycam",
    "Search by trace ID",
    "Search by trace ID",
    "Search by trace ID",
    "Search by trace ID",
    "RUN GUERY",
    "RUN GUERY",
    "*",
    "*",
    "S RUN QUERY",
    "S RUN QUERY",
    "Service filters",
    "Service filters",
    "Figure 10-4. Zipkin front end.",
    "Figure 10-4. Zipkin front end.",
    "On the Find a trace tab, you can query traces. Pressing the RUN QUERY button without specifying any restrictions will show all the ingested traces :",
    "On the Find a trace tab, you can query traces. Pressing the RUN QUERY button without specifying any restrictions will show all the ingested traces :",
    "Figure 10-5. Zipkin traces overview.",
    "Figure 10-5. Zipkin traces overview.",
    "Clicking the SHOW button next to a specific trace, will show the details of that trace:",
    "Clicking the SHOW button next to a specific trace, will show the details of that trace:",
    "Q Find a trace",
    "Q Find a trace",
    "T\u00b0 Dependencies",
    "T\u00b0 Dependencies",
    "Q Find a trace Dependencies",
    "Q Find a trace Dependencies",
    "XA ENGLISH Y",
    "XA ENGLISH Y",
    "*",
    "*",
    "EXPAND ALL",
    "EXPAND ALL",
    "COLLAPSE ALL",
    "COLLAPSE ALL",
    "\u2022 Zipkin",
    "\u2022 Zipkin",
    "Q Find a trace",
    "Q Find a trace",
    "\"",
    "\"",
    "TRAFFICCONTROLSERVICE: bindings/entrycam",
    "TRAFFICCONTROLSERVICE: bindings/entrycam",
    "Duration: 5.666ms Services: 1 Depth: 2 Total Spans: 2 Trace ID: 572745da4058a2f8406446420c402657",
    "Duration: 5.666ms Services: 1 Depth: 2 Total Spans: 2 Trace ID: 572745da4058a2f8406446420c402657",
    "^ v",
    "^ v",
    "\u2022 TRAFFICCONTROLSERVICE",
    "\u2022 TRAFFICCONTROLSERVICE",
    "TRAFFICCONTROLSERVICE",
    "TRAFFICCONTROLSERVICE",
    "\u00ab",
    "\u00ab",
    "Figure 10-6. Zipkin trace details.",
    "Figure 10-6. Zipkin trace details.",
    "Each item on the details page, is a span that represents a request that is part of the selected trace.",
    "Each item on the details page, is a span that represents a request that is part of the selected trace.",
    "Because Dapr sidecars handle traffic between services, Zipkin can use the trace information to determine the dependencies between the services. To see it in action, go to the Dependencies tab on the Zipkin web page and select the button with the magnifying glass. Zipkin will show an overview of the services and their dependencies:",
    "Because Dapr sidecars handle traffic between services, Zipkin can use the trace information to determine the dependencies between the services. To see it in action, go to the Dependencies tab on the Zipkin web page and select the button with the magnifying glass. Zipkin will show an overview of the services and their dependencies:",
    "JA ENGLISH Y",
    "JA ENGLISH Y",
    "Search by trace ID",
    "Search by trace ID",
    "DOWNLOAD JSON",
    "DOWNLOAD JSON",
    "Zipkin",
    "Zipkin",
    "Select...",
    "Select...",
    "Q Find a trace",
    "Q Find a trace",
    "*",
    "*",
    "Start Time",
    "Start Time",
    "05/09/2021 09:58:51",
    "05/09/2021 09:58:51",
    "TA ENGLISH V",
    "TA ENGLISH V",
    "End Time",
    "End Time",
    "05/10/2021 09:58:51",
    "05/10/2021 09:58:51",
    "Q",
    "Q",
    "Figure 10-7. Zipkin dependencies.",
    "Figure 10-7. Zipkin dependencies.",
    "The animated dots on the lines between the services represent requests and move from source to destination. Red dots indicate a failed request.",
    "The animated dots on the lines between the services represent requests and move from source to destination. Red dots indicate a failed request.",
    "Beyond Zipkin, other monitoring back-end software can also ingest telemetry with the Zipkin format. Jaeger is an open source tracing system created by Uber Technologies. It",
    "Beyond Zipkin, other monitoring back-end software can also ingest telemetry with the Zipkin format. Jaeger is an open source tracing system created by Uber Technologies. It",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name: dapr-config    namespace: default  spec:    tracing:      samplingRate: ",
    ":::{custom-style=CodeBox} yaml  apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name: dapr-config    namespace: default  spec:    tracing:      samplingRate: ",
    "To try out New Relic, specify the endpoint of the New Relic API. Here",
    "To try out New Relic, specify the endpoint of the New Relic API. Here",
    ":::{custom-style=CodeBox} yaml apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name: dapr-config    namespace: default  spec:    tracing:      samplingRate: ",
    ":::{custom-style=CodeBox} yaml apiVersion: dapr.io/v1alpha1  kind: Configuration  metadata:    name: dapr-config    namespace: default  spec:    tracing:      samplingRate: ",
    "Search by trace ID",
    "Search by trace ID",
    "dapr dapr",
    "dapr dapr",
    "dapr dapr",
    "dapr dapr",
    "Sidecar dapr",
    "Sidecar dapr",
    "Sidecar",
    "Sidecar",
    "Check out the Jaeger and New Relic websites for more information on how to use them.",
    "Check out the Jaeger and New Relic websites for more information on how to use them.",
    "Metrics provide insight into performance and resource consumption. Under the hood, Dapr emits a wide collection of system and runtime metrics. Dapr uses Prometheus as a metric standard. Dapr sidecars and system services, expose a metrics endpoint on port 9090 . A Prometheus scraper calls this endpoint at a predefined interval to collect metrics. The scraper sends metric values to a monitoring back end. Figure 10-8 shows the scraping process: backend",
    "Metrics provide insight into performance and resource consumption. Under the hood, Dapr emits a wide collection of system and runtime metrics. Dapr uses Prometheus as a metric standard. Dapr sidecars and system services, expose a metrics endpoint on port 9090 . A Prometheus scraper calls this endpoint at a predefined interval to collect metrics. The scraper sends metric values to a monitoring back end. Figure 10-8 shows the scraping process: backend",
    "Placement service",
    "Placement service",
    "Sentry service",
    "Sentry service",
    "-04",
    "-04",
    "metrics scraper",
    "metrics scraper",
    "Figure 10-8. Scraping Prometheus metrics.",
    "Figure 10-8. Scraping Prometheus metrics.",
    "Each sidecar and system service exposes a metric endpoint that listens on port 9090. The Prometheus Metrics Scrapper captures metrics from each endpoint and published the information to the monitoring back end.",
    "Each sidecar and system service exposes a metric endpoint that listens on port 9090. The Prometheus Metrics Scrapper captures metrics from each endpoint and published the information to the monitoring back end.",
    "You might wonder how the metrics scraper knows where to collect metrics. Prometheus can integrate with discovery mechanisms built into target deployment environments. For example, when running in Kubernetes, Prometheus can integrate with the Kubernetes API to find all available Kubernetes resources running in the environment.",
    "You might wonder how the metrics scraper knows where to collect metrics. Prometheus can integrate with discovery mechanisms built into target deployment environments. For example, when running in Kubernetes, Prometheus can integrate with the Kubernetes API to find all available Kubernetes resources running in the environment.",
    "Dapr generates a large set of metrics for Dapr system services and its runtime. Some examples include:",
    "Dapr generates a large set of metrics for Dapr system services and its runtime. Some examples include:",
    "Service A",
    "Service A",
    "Service B",
    "Service B",
    "| Metric                                         | Source   | Description                                                                                    |",
    "| Metric                                         | Source   | Description                                                                                    |",
    "For more information on available metrics, see the Dapr metrics documentation.",
    "For more information on available metrics, see the Dapr metrics documentation.",
    "At run time, you can disable the metrics collection endpoint by including the --enablemetrics=false argument in the Dapr command. Or, you can also change the default port for the endpoint with the --metrics-port 9090 argument.",
    "At run time, you can disable the metrics collection endpoint by including the --enablemetrics=false argument in the Dapr command. Or, you can also change the default port for the endpoint with the --metrics-port 9090 argument.",
    "You can also use a Dapr configuration file to statically enable or disable runtime metrics collection:",
    "You can also use a Dapr configuration file to statically enable or disable runtime metrics collection:",
    "With the Prometheus scraper collecting and publishing metrics into the monitoring back end, how do you make sense of the raw data? A popular visualization tool for analyzing metrics is Grafana. With Grafana, you can create dashboards from the available metrics. Here",
    "With the Prometheus scraper collecting and publishing metrics into the monitoring back end, how do you make sense of the raw data? A popular visualization tool for analyzing metrics is Grafana. With Grafana, you can create dashboards from the available metrics. Here",
    "Q",
    "Q",
    "88",
    "88",
    "88 Dapr System Services Dashboard ",
    "88 Dapr System Services Dashboard ",
    "v Health ",
    "v Health ",
    "Uptime dapr-operator",
    "Uptime dapr-operator",
    "dapr-placement-server dapr-sentry",
    "dapr-placement-server dapr-sentry",
    "dapr-sidecar-injector v Sidecar Injector",
    "dapr-sidecar-injector v Sidecar Injector",
    "5.0",
    "5.0",
    "4.5",
    "4.5",
    "4.0",
    "4.0",
    "3.5",
    "3.5",
    "3.0",
    "3.0",
    "20:18:30",
    "20:18:30",
    "20:19:00",
    "20:19:00",
    "sidecars requests",
    "sidecars requests",
    "~ CA Sentry",
    "~ CA Sentry",
    "Root/Issuer cert expirynute",
    "Root/Issuer cert expirynute",
    "52.1 week left",
    "52.1 week left",
    "6.0 min",
    "6.0 min",
    "6.0 min",
    "6.0 min",
    "8 ms",
    "8 ms",
    "6 ms",
    "6 ms",
    "15.0 MB",
    "15.0 MB",
    "12.5 MB",
    "12.5 MB",
    "10.0 MB",
    "10.0 MB",
    "100",
    "100",
    "75",
    "75",
    "Figure 10-9. Grafana dashboard.",
    "Figure 10-9. Grafana dashboard.",
    "The Dapr documentation includes a tutorial for installing Prometheus and Grafana.",
    "The Dapr documentation includes a tutorial for installing Prometheus and Grafana.",
    "Logging provides insight into what is happening with a service at run time. When running an application, Dapr automatically emits log entries from Dapr sidecars and Dapr system services. However, logging entries instrumented in your application code aren",
    "Logging provides insight into what is happening with a service at run time. When running an application, Dapr automatically emits log entries from Dapr sidecars and Dapr system services. However, logging entries instrumented in your application code aren",
    "Dapr emits structured logging. Each log entry has the following format:",
    "Dapr emits structured logging. Each log entry has the following format:",
    "| Field    | Description                                           | Example                           |",
    "| Field    | Description                                           | Example                           |",
    "Total CPU usage (kernel and user)",
    "Total CPU usage (kernel and user)",
    "Heap Memory usage in bytes",
    "Heap Memory usage in bytes",
    "1h 4",
    "1h 4",
    "\u2022 Last 5 minutes",
    "\u2022 Last 5 minutes",
    "Number of GO routines",
    "Number of GO routines",
    "5s v",
    "5s v",
    "| Field   | Description          | Example               |",
    "| Field   | Description          | Example               |",
    "When searching through logging entries in a troubleshooting scenario, the time and level fields are especially helpful. The time field orders log entries so that you can pinpoint specific time periods. When troubleshooting, log entries at the debug level provide more information on the behavior of the code.",
    "When searching through logging entries in a troubleshooting scenario, the time and level fields are especially helpful. The time field orders log entries so that you can pinpoint specific time periods. When troubleshooting, log entries at the debug level provide more information on the behavior of the code.",
    "By default, Dapr emits structured logging in plain-text format. Every log entry is formatted as a string containing key/value pairs. Here",
    "By default, Dapr emits structured logging in plain-text format. Every log entry is formatted as a string containing key/value pairs. Here",
    "While simple, this format is difficult to parse. If viewing log entries with a monitoring tool, you",
    "While simple, this format is difficult to parse. If viewing log entries with a monitoring tool, you",
    "To enable JSON formatting, you need to configure each Dapr sidecar. In self-hosted mode, you can specify the flag --log-as-json on the command line:",
    "To enable JSON formatting, you need to configure each Dapr sidecar. In self-hosted mode, you can specify the flag --log-as-json on the command line:",
    "In Kubernetes, you can add a dapr.io/log-as-json annotation to each deployment for the application:",
    "In Kubernetes, you can add a dapr.io/log-as-json annotation to each deployment for the application:",
    "When you install Dapr in a Kubernetes cluster using Helm, you can enable JSON formatted logging for all the Dapr system services:",
    "When you install Dapr in a Kubernetes cluster using Helm, you can enable JSON formatted logging for all the Dapr system services:",
    "The logs emitted by Dapr can be fed into a monitoring back end for analysis. A log collector is a component that collects logs from a system and sends them to a monitoring back end. A popular log collector is Fluentd. Check out the How-To: Set up Fluentd, Elastic search and Kibana in Kubernetes in the Dapr documentation. This article contains instructions for setting up Fluentd as log collector and the ELK Stack (Elastic Search and Kibana) as a monitoring back end.",
    "The logs emitted by Dapr can be fed into a monitoring back end for analysis. A log collector is a component that collects logs from a system and sends them to a monitoring back end. A popular log collector is Fluentd. Check out the How-To: Set up Fluentd, Elastic search and Kibana in Kubernetes in the Dapr documentation. This article contains instructions for setting up Fluentd as log collector and the ELK Stack (Elastic Search and Kibana) as a monitoring back end.",
    "The health status of a service provides insight into its availability. Each Dapr sidecar exposes a health API that can be used by the hosting environment to determine the health of the sidecar. The API has one operation:",
    "The health status of a service provides insight into its availability. Each Dapr sidecar exposes a health API that can be used by the hosting environment to determine the health of the sidecar. The API has one operation:",
    "The operation returns two HTTP status codes:",
    "The operation returns two HTTP status codes:",
    "204: When the sidecar is healthy",
    "204: When the sidecar is healthy",
    "500: when the sidecar isn",
    "500: when the sidecar isn",
    "When running in selfhosted mode, the health API isn",
    "When running in selfhosted mode, the health API isn",
    "When running in Kubernetes, the Dapr sidecar-injector automatically configures Kubernetes to use the health API for executing liveness probes and readiness probes .",
    "When running in Kubernetes, the Dapr sidecar-injector automatically configures Kubernetes to use the health API for executing liveness probes and readiness probes .",
    "Kubernetes uses liveness probes to determine whether a container is up and running. If a liveness probe returns a failure code, Kubernetes will assume the container is dead and automatically restart it. This feature increases the overall availability of your application.",
    "Kubernetes uses liveness probes to determine whether a container is up and running. If a liveness probe returns a failure code, Kubernetes will assume the container is dead and automatically restart it. This feature increases the overall availability of your application.",
    "Kubernetes uses readiness probes to determine whether a container is ready to start accepting traffic. A pod is considered ready when all of its containers are ready. Readiness determines whether a Kubernetes service can direct traffic to a pod in a loadbalancing scenario. Pods that aren",
    "Kubernetes uses readiness probes to determine whether a container is ready to start accepting traffic. A pod is considered ready when all of its containers are ready. Readiness determines whether a Kubernetes service can direct traffic to a pod in a loadbalancing scenario. Pods that aren",
    "Liveness and readiness probes have several configurable parameters. Both are configured in the container spec section of a pod",
    "Liveness and readiness probes have several configurable parameters. Both are configured in the container spec section of a pod",
    "The following parameters are available for the probes:",
    "The following parameters are available for the probes:",
    "The path specifies the Dapr health API endpoint.",
    "The path specifies the Dapr health API endpoint.",
    "The port specifies the Dapr health API port.",
    "The port specifies the Dapr health API port.",
    "The initialDelaySeconds specifies the number of seconds Kubernetes will wait before it starts probing a container for the first time.",
    "The initialDelaySeconds specifies the number of seconds Kubernetes will wait before it starts probing a container for the first time.",
    "The periodSeconds specifies the number of seconds Kubernetes will wait between each probe.",
    "The periodSeconds specifies the number of seconds Kubernetes will wait between each probe.",
    "The timeoutSeconds specifies the number of seconds Kubernetes will wait on a response from the API before timing out. A timeout is interpreted as a failure.",
    "The timeoutSeconds specifies the number of seconds Kubernetes will wait on a response from the API before timing out. A timeout is interpreted as a failure.",
    "The failureThreshold specifies the number of failed status code Kubernetes will accept before considering the container not alive or not ready.",
    "The failureThreshold specifies the number of failed status code Kubernetes will accept before considering the container not alive or not ready.",
    "Dapr offers a dashboard that presents status information on Dapr applications, components, and configurations. Use the Dapr CLI to start the dashboard as a web-application on the local machine on port 8080:",
    "Dapr offers a dashboard that presents status information on Dapr applications, components, and configurations. Use the Dapr CLI to start the dashboard as a web-application on the local machine on port 8080:",
    "For Dapr application running in Kubernetes, use the following command:",
    "For Dapr application running in Kubernetes, use the following command:",
    "The dashboard opens with an overview of all services in your application that have a Dapr sidecar. The following screenshot shows the Dapr dashboard for the Traffic Control sample application running in Kubernetes:",
    "The dashboard opens with an overview of all services in your application that have a Dapr sidecar. The following screenshot shows the Dapr dashboard for the Traffic Control sample application running in Kubernetes:",
    ":::i mage type=",
    ":::i mage type=",
    "Figure 10-10. Dapr dashboard overview.",
    "Figure 10-10. Dapr dashboard overview.",
    "The Dapr dashboard is invaluable when troubleshooting a Dapr application. It provides information about Dapr sidecars and system services. You can drill down into the configuration of each service, including the logging entries.",
    "The Dapr dashboard is invaluable when troubleshooting a Dapr application. It provides information about Dapr sidecars and system services. You can drill down into the configuration of each service, including the logging entries.",
    "The dashboard also shows the configured components (and their configuration) for an application:",
    "The dashboard also shows the configured components (and their configuration) for an application:",
    ":::image type=",
    ":::image type=",
    "Figure 10-11. Dapr dashboard components.",
    "Figure 10-11. Dapr dashboard components.",
    "\u2022 Zipkin",
    "\u2022 Zipkin",
    "Q, Find a trace",
    "Q, Find a trace",
    "*",
    "*",
    "TRAFFICCONTROLSERVICE: bindings/exitcam",
    "TRAFFICCONTROLSERVICE: bindings/exitcam",
    "Duration: 1.785s Services: 3 Depth: 3 Total Spans: 8 Trace ID: b05e9fbd829ac2cd425295dc4c2fdf6a",
    "Duration: 1.785s Services: 3 Depth: 3 Total Spans: 8 Trace ID: b05e9fbd829ac2cd425295dc4c2fdf6a",
    "JA ENGLISH v",
    "JA ENGLISH v",
    "Search by trace ID",
    "Search by trace ID",
    "DOWNLOAD JSON",
    "DOWNLOAD JSON",
    "\u00ab",
    "\u00ab",
    "There",
    "There",
    "Check out the Dapr dashboard CLI command reference in the Dapr docs for more information on the Dapr dashboard commands.",
    "Check out the Dapr dashboard CLI command reference in the Dapr docs for more information on the Dapr dashboard commands.",
    "VEHICLEREGISTRATIONSERVICE",
    "VEHICLEREGISTRATIONSERVICE",
    "FINECOLLECTIONSERVICE",
    "FINECOLLECTIONSERVICE",
    "calllocal/vehicleregistrationservice/vehicleinfo/pl-454-f ",
    "calllocal/vehicleregistrationservice/vehicleinfo/pl-454-f ",
    "/dapr.proto.runtime.v1.dapr/invokebinding ",
    "/dapr.proto.runtime.v1.dapr/invokebinding ",
    "The Dapr .NET SDK doesn",
    "The Dapr .NET SDK doesn",
    "If you want to emit telemetry from your .NET application code, you should consider the OpenTelemetry SDK for .NET. The Open Telemetry project is cross-platform, open source, and vendor agnostic. It provides an end-to-end implementation to generate, emit, collect, process, and export telemetry data. There",
    "If you want to emit telemetry from your .NET application code, you should consider the OpenTelemetry SDK for .NET. The Open Telemetry project is cross-platform, open source, and vendor agnostic. It provides an end-to-end implementation to generate, emit, collect, process, and export telemetry data. There",
    "Because the Traffic Control sample application runs with Dapr, all the telemetry described in this chapter is available. If you run the application and open the Zipkin web fro nt end, you",
    "Because the Traffic Control sample application runs with Dapr, all the telemetry described in this chapter is available. If you run the application and open the Zipkin web fro nt end, you",
    "Figure 10-12. Zipkin end-to-end tracing example.",
    "Figure 10-12. Zipkin end-to-end tracing example.",
    "This trace shows the communication that occurs when a speeding violation has been detected:",
    "This trace shows the communication that occurs when a speeding violation has been detected:",
    "An exiting vehicle triggers the MQTT input binding that sends a message containing the vehicle license number, lane, and timestamp.",
    "An exiting vehicle triggers the MQTT input binding that sends a message containing the vehicle license number, lane, and timestamp.",
    "The MQTT input binding invokes the TrafficControl service with the message.",
    "The MQTT input binding invokes the TrafficControl service with the message.",
    "The TrafficControl service retrieves the state for the vehicle, appends the entry, and saves the updated vehicle state back to the state store.",
    "The TrafficControl service retrieves the state for the vehicle, appends the entry, and saves the updated vehicle state back to the state store.",
    "The TrafficControl service publishes the speeding violation using pub/sub to the speedingviolations topic.",
    "The TrafficControl service publishes the speeding violation using pub/sub to the speedingviolations topic.",
    "The FineCollection service receives the speeding violation using a pub/sub subscription on the speedingviolations topic.",
    "The FineCollection service receives the speeding violation using a pub/sub subscription on the speedingviolations topic.",
    "The FineCollection service invokes the vehicleinfo endpoint of the VehicleRegistration service using service invocation.",
    "The FineCollection service invokes the vehicleinfo endpoint of the VehicleRegistration service using service invocation.",
    "The FineCollection service invokes an output binding for sending the email.",
    "The FineCollection service invokes an output binding for sending the email.",
    "Click any trace line (span) to see more details. If you click on the last line, you",
    "Click any trace line (span) to see more details. If you click on the last line, you",
    "FINECOLLECTIONSERVICE",
    "FINECOLLECTIONSERVICE",
    "/dapr.proto.runtime.v1.dapr/invokebinding",
    "/dapr.proto.runtime.v1.dapr/invokebinding",
    "Span ID: 496eb0091499dd88 Parent ID:e3785a963afOec45",
    "Span ID: 496eb0091499dd88 Parent ID:e3785a963afOec45",
    "Annotations",
    "Annotations",
    "Tags dapr.api",
    "Tags dapr.api",
    "/dapr.proto.runtime.v1.Dapr/InvokeBinding dapr.protocol",
    "/dapr.proto.runtime.v1.Dapr/InvokeBinding dapr.protocol",
    "grpc db.connection",
    "grpc db.connection",
    "bindings doctane",
    "bindings doctane",
    "sendmail db.statement",
    "sendmail db.statement",
    "/dapr.proto.runtime.v1.Dapr/InvokeBinding db.system",
    "/dapr.proto.runtime.v1.Dapr/InvokeBinding db.system",
    "bindings",
    "bindings",
    "\u0433pc.service",
    "\u0433pc.service",
    "Dapr",
    "Dapr",
    "Figure 10-13. Output binding trace details.",
    "Figure 10-13. Output binding trace details.",
    "Detailed observability is critical to running a distributed system in production.",
    "Detailed observability is critical to running a distributed system in production.",
    "Dapr provides different types of telemetry, including distributed tracing, logging, metrics, and health status.",
    "Dapr provides different types of telemetry, including distributed tracing, logging, metrics, and health status.",
    "Dapr only produces telemetry for the Dapr system services and sidecars. Telemetry from your application code isn",
    "Dapr only produces telemetry for the Dapr system services and sidecars. Telemetry from your application code isn",
    "Dapr telemetry is produced in an open-standards based format so that it can be ingested by a large set of available monitoring tools. Examples include Zipkin, Azure Application Insights, the ELK Stack, New Relic, and Grafana. See Monitor your application with Dapr in the Dapr documentation for tutorials on how to monitor your Dapr applications with specific monitoring back ends.",
    "Dapr telemetry is produced in an open-standards based format so that it can be ingested by a large set of available monitoring tools. Examples include Zipkin, Azure Application Insights, the ELK Stack, New Relic, and Grafana. See Monitor your application with Dapr in the Dapr documentation for tutorials on how to monitor your Dapr applications with specific monitoring back ends.",
    "You",
    "You",
    "Dapr can be configured to emit structured logging. Structured logging is favored as it can be indexed by back-end monitoring tools. Indexed logging enables users to execute rich queries when searching through the logging.",
    "Dapr can be configured to emit structured logging. Structured logging is favored as it can be indexed by back-end monitoring tools. Indexed logging enables users to execute rich queries when searching through the logging.",
    "Dapr offers a dashboard that presents information about the Dapr services and configuration.",
    "Dapr offers a dashboard that presents information about the Dapr services and configuration.",
    "Azure Application Insights",
    "Azure Application Insights",
    "Open Telemetry",
    "Open Telemetry",
    "Zipkin",
    "Zipkin",
    "W3C Trace Context",
    "W3C Trace Context",
    "Jaeger",
    "Jaeger",
    "New Relic",
    "New Relic",
    "Prometheus",
    "Prometheus",
    "Grafana",
    "Grafana",
    "Open Telemetry SDK for .NET",
    "Open Telemetry SDK for .NET",
    "Fluentd",
    "Fluentd",
    "ELK stack",
    "ELK stack",
    "Seq",
    "Seq",
    "Serilog",
    "Serilog",
    "Enterprise applications require secrets. Common examples include:",
    "Enterprise applications require secrets. Common examples include:",
    "A database connection string that contains a username and password.",
    "A database connection string that contains a username and password.",
    "An API key for calling an external web API.",
    "An API key for calling an external web API.",
    "A client certificate for authenticating to an external system.",
    "A client certificate for authenticating to an external system.",
    "Secrets must be carefully managed so that they",
    "Secrets must be carefully managed so that they",
    "Not long ago, it was popular to store application secrets in a configuration file inside the application codebase. .NET developers will fondly recall the web.config file. While simple to implement, integrating secrets to along with code was far from secure. A common misstep was to include the file when pushing to a public GIT repository, exposing the secrets to the world.",
    "Not long ago, it was popular to store application secrets in a configuration file inside the application codebase. .NET developers will fondly recall the web.config file. While simple to implement, integrating secrets to along with code was far from secure. A common misstep was to include the file when pushing to a public GIT repository, exposing the secrets to the world.",
    "A widely accepted methodology for constructing modern distributed applications is The TwelveFactor App. It describes a set of principles and best practices. Its third factor prescribes that configuration and secrets be externalized outside of the code base.",
    "A widely accepted methodology for constructing modern distributed applications is The TwelveFactor App. It describes a set of principles and best practices. Its third factor prescribes that configuration and secrets be externalized outside of the code base.",
    "To address this concern, the .NET platform includes a Secret Manager feature that stores sensitive data in a physical folder outside of the project tree. While secrets are outside of source control, this feature doesn",
    "To address this concern, the .NET platform includes a Secret Manager feature that stores sensitive data in a physical folder outside of the project tree. While secrets are outside of source control, this feature doesn",
    "A more modern and secure practice is to isolate secrets in a secrets management tool like Hashicorp Vault or Azure Key Vault . These tools enable you to store secrets externally, vary credentials across environments, and reference them from application code. However, each tool has its complexities and learning curve.",
    "A more modern and secure practice is to isolate secrets in a secrets management tool like Hashicorp Vault or Azure Key Vault . These tools enable you to store secrets externally, vary credentials across environments, and reference them from application code. However, each tool has its complexities and learning curve.",
    "Dapr offers a building block that simplifies managing secrets.",
    "Dapr offers a building block that simplifies managing secrets.",
    "The Dapr secrets management building block abstracts away the complexity of working with secrets and secret management tools.",
    "The Dapr secrets management building block abstracts away the complexity of working with secrets and secret management tools.",
    "It hides the underlying plumbing through a unified interface.",
    "It hides the underlying plumbing through a unified interface.",
    "It supports various pluggable secret store components, which can vary between development and production.",
    "It supports various pluggable secret store components, which can vary between development and production.",
    "Applications don",
    "Applications don",
    "Developers don",
    "Developers don",
    "Dapr handles all of the above concerns.",
    "Dapr handles all of the above concerns.",
    "Access to the secrets is secured through authentication and authorization. Only an application with sufficient rights can access secrets. Applications running in Kubernetes can also use its built-in secrets management mechanism.",
    "Access to the secrets is secured through authentication and authorization. Only an application with sufficient rights can access secrets. Applications running in Kubernetes can also use its built-in secrets management mechanism.",
    "Applications use the secrets management building block in two ways:",
    "Applications use the secrets management building block in two ways:",
    "Retrieve a secret directly from the building block.",
    "Retrieve a secret directly from the building block.",
    "Reference a secret indirectly from a Dapr component configuration.",
    "Reference a secret indirectly from a Dapr component configuration.",
    "Retrieving secrets directly is covered first. Referencing a secret from a Dapr component configuration file is addressed in a later section.",
    "Retrieving secrets directly is covered first. Referencing a secret from a Dapr component configuration file is addressed in a later section.",
    "The application interacts with a Dapr sidecar when using the secrets management building block. The sidecar exposes the secrets API. The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "The application interacts with a Dapr sidecar when using the secrets management building block. The sidecar exposes the secrets API. The API can be called with either HTTP or gRPC. Use the following URL to call the HTTP API:",
    "http://localhost:",
    "http://localhost:",
    "The URL contains the following segments:",
    "The URL contains the following segments:",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "<",
    "[",
    "[",
    "The JSON response contains the key and value of the secret.",
    "The JSON response contains the key and value of the secret.",
    "Figure 11-1 shows how Dapr handles a request for the secrets API:",
    "Figure 11-1 shows how Dapr handles a request for the secrets API:",
    "{",
    "{",
    "}",
    "}",
    "GET http://localhost:3500/v1.0/secrets/secrets-store/redis-password",
    "GET http://localhost:3500/v1.0/secrets/secrets-store/redis-password",
    "Service A",
    "Service A",
    "Figure 11-1. Retrieving a secret with the Dapr secrets API.",
    "Figure 11-1. Retrieving a secret with the Dapr secrets API.",
    "The service calls the Dapr secrets API, along with the name of the secret store, and secret to retrieve.",
    "The service calls the Dapr secrets API, along with the name of the secret store, and secret to retrieve.",
    "The Dapr sidecar retrieves the specified secret from the secret store.",
    "The Dapr sidecar retrieves the specified secret from the secret store.",
    "The Dapr sidecar returns the secret information back to the service.",
    "The Dapr sidecar returns the secret information back to the service.",
    "Some secret stores support storing multiple key/value pairs in a single secret. For those scenarios, the response would contain multiple key/value pairs in a single JSON response as in the following example:",
    "Some secret stores support storing multiple key/value pairs in a single secret. For those scenarios, the response would contain multiple key/value pairs in a single JSON response as in the following example:",
    "GET http://localhost:3500/v1.0/secrets/secret-store/interestRates?metadata.version",
    "GET http://localhost:3500/v1.0/secrets/secret-store/interestRates?metadata.version",
    "The Dapr secrets API also offers an operation to retrieve all the secrets the application has access to:",
    "The Dapr secrets API also offers an operation to retrieve all the secrets the application has access to:",
    "For .NET developers, the Dapr .NET SDK streamlines Dapr secret management. Consider the DaprClient.GetSecretAsync method. It enables you to retrieve a secret directly from any Dapr secret store with minimal effort. Here",
    "For .NET developers, the Dapr .NET SDK streamlines Dapr secret management. Consider the DaprClient.GetSecretAsync method. It enables you to retrieve a secret directly from any Dapr secret store with minimal effort. Here",
    "Arguments for the GetSecretAsync method include:",
    "Arguments for the GetSecretAsync method include:",
    "The name of the Dapr secret store component (",
    "The name of the Dapr secret store component (",
    "The secret to retrieve (",
    "The secret to retrieve (",
    "Optional metadata key/value pairs (",
    "Optional metadata key/value pairs (",
    "The method responds with a dictionary object as a secret can contain multiple key/value pairs. In the example above, the secret named customerdb is referenced from the collection to return a connection string.",
    "The method responds with a dictionary object as a secret can contain multiple key/value pairs. In the example above, the secret named customerdb is referenced from the collection to return a connection string.",
    "The Dapr .NET SDK also features a .NET configuration provider. It loads specified secrets into the underlying .NET configuration API. The running application can then reference secrets from the IConfiguration dictionary that is registered in ASP.NET Core dependency injection.",
    "The Dapr .NET SDK also features a .NET configuration provider. It loads specified secrets into the underlying .NET configuration API. The running application can then reference secrets from the IConfiguration dictionary that is registered in ASP.NET Core dependency injection.",
    "The secrets configuration provider is available from the Dapr.Extensions.Configuration NuGet package. The provider can be registered in the Program.cs of an ASP.NET Web API application:",
    "The secrets configuration provider is available from the Dapr.Extensions.Configuration NuGet package. The provider can be registered in the Program.cs of an ASP.NET Web API application:",
    "The above example loads the eshopsecrets secrets collection into the .NET configuration system at startup. Registering the provider requires an instance of DaprClient to invoke the secrets API on the Dapr sidecar. The other arguments include the name of the secret store and a DaprSecretDescriptor object with the name of the secret.",
    "The above example loads the eshopsecrets secrets collection into the .NET configuration system at startup. Registering the provider requires an instance of DaprClient to invoke the secrets API on the Dapr sidecar. The other arguments include the name of the secret store and a DaprSecretDescriptor object with the name of the secret.",
    "Once loaded, you can retrieve secrets directly from application code:",
    "Once loaded, you can retrieve secrets directly from application code:",
    "The secrets management building block supports several secret store components. At the time of writing, the following secret stores are available:",
    "The secrets management building block supports several secret store components. At the time of writing, the following secret stores are available:",
    "AlibabaCloud OOS Parameter Store",
    "AlibabaCloud OOS Parameter Store",
    "AWS Secrets Manager",
    "AWS Secrets Manager",
    "AWS SSM Parameter Store",
    "AWS SSM Parameter Store",
    "Azure Key Vault",
    "Azure Key Vault",
    "GCP Secret Manager",
    "GCP Secret Manager",
    "HashiCorp Vault",
    "HashiCorp Vault",
    "Kubernetes secrets",
    "Kubernetes secrets",
    "Local environment variables",
    "Local environment variables",
    "Local file",
    "Local file",
    "The local environment variables and file components are designed for development workloads only.",
    "The local environment variables and file components are designed for development workloads only.",
    "The following sections show how to configure a secret store.",
    "The following sections show how to configure a secret store.",
    "You configure a secret store using a Dapr component configuration file. The typical structure of the file is shown below:",
    "You configure a secret store using a Dapr component configuration file. The typical structure of the file is shown below:",
    "All Dapr component configuration files require a name along with an optional namespace value. Additionally, the type field in the spec section specifies the type of secret store component. The properties in the metadata section differ per secret store.",
    "All Dapr component configuration files require a name along with an optional namespace value. Additionally, the type field in the spec section specifies the type of secret store component. The properties in the metadata section differ per secret store.",
    "As mentioned earlier in this chapter, applications can also consume secrets by referencing them in component configuration files. Consider a state management component that uses Redis cache for storing state:",
    "As mentioned earlier in this chapter, applications can also consume secrets by referencing them in component configuration files. Consider a state management component that uses Redis cache for storing state:",
    "The above configuration file contains a clear-text password for connecting to the Redis server. Hardcoded passwords are always a bad idea. Pushing this configuration file to a public repository would expose the password. Storing the password in a secret store would dramatically improve this scenario.",
    "The above configuration file contains a clear-text password for connecting to the Redis server. Hardcoded passwords are always a bad idea. Pushing this configuration file to a public repository would expose the password. Storing the password in a secret store would dramatically improve this scenario.",
    "The following examples demonstrate this using several different secret stores.",
    "The following examples demonstrate this using several different secret stores.",
    "The local file component is designed for development scenarios. It stores secrets on the local filesystem inside a JSON file. Here",
    "The local file component is designed for development scenarios. It stores secrets on the local filesystem inside a JSON file. Here",
    "You place this file in a components folder that you specify when running the Dapr application.",
    "You place this file in a components folder that you specify when running the Dapr application.",
    "The following secret store configuration file consumes the JSON file as a secret store. It",
    "The following secret store configuration file consumes the JSON file as a secret store. It",
    "The component type is secretstore.local.file . The secretsFile metadata element specifies the path to the secrets file.",
    "The component type is secretstore.local.file . The secretsFile metadata element specifies the path to the secrets file.",
    "The path to a secrets file can be a absolute or relative path. The relative path is based on the folder in which the application starts. In the example, the components folder is a sub-folder of the directory that contains the .NET application.",
    "The path to a secrets file can be a absolute or relative path. The relative path is based on the folder in which the application starts. In the example, the components folder is a sub-folder of the directory that contains the .NET application.",
    "From the application folder, start the Dapr application specifying the components path as a commandline argument:",
    "From the application folder, start the Dapr application specifying the components path as a commandline argument:",
    "This above example applies to running Dapr in self-hosted mode. For Kubernetes hosting, consider using volume mounts.",
    "This above example applies to running Dapr in self-hosted mode. For Kubernetes hosting, consider using volume mounts.",
    "The nestedSeparator in a Dapr configuration file specifies a character to flatten a JSON hierarchy. Consider the following snippet:",
    "The nestedSeparator in a Dapr configuration file specifies a character to flatten a JSON hierarchy. Consider the following snippet:",
    "Using a colon as a separator, you can retrieve the customerdb connection-string using the key connectionStrings:customerdb .",
    "Using a colon as a separator, you can retrieve the customerdb connection-string using the key connectionStrings:customerdb .",
    "Note The colon : is the default separator value.",
    "Note The colon : is the default separator value.",
    "In the next example, a state management configuration file references the local secret store component to obtain the password for connecting to the Redis server:",
    "In the next example, a state management configuration file references the local secret store component to obtain the password for connecting to the Redis server:",
    "The secretKeyRef element references the secret containing the password. It replaces the earlier cleartext value. The secret name and the key name, eShopRedisPassword , reference the secret. The name of the secret management component eshop-local-secret-store is found in the auth metadata element.",
    "The secretKeyRef element references the secret containing the password. It replaces the earlier cleartext value. The secret name and the key name, eShopRedisPassword , reference the secret. The name of the secret management component eshop-local-secret-store is found in the auth metadata element.",
    "You might wonder why eShopRedisPassword is identical for both the name and key in the secret reference. In the local file secret store, secrets aren",
    "You might wonder why eShopRedisPassword is identical for both the name and key in the secret reference. In the local file secret store, secrets aren",
    "This second example focuses on a Dapr application running in Kubernetes. It uses the standard secrets mechanism that Kubernetes offers. Use the Kubernetes CLI ( kubectl ) to create a secret named eshopredis-secret that contains the password:",
    "This second example focuses on a Dapr application running in Kubernetes. It uses the standard secrets mechanism that Kubernetes offers. Use the Kubernetes CLI ( kubectl ) to create a secret named eshopredis-secret that contains the password:",
    "kubectl create secret generic eshopsecrets --from-literal=redisPassword=e$h0p0nD@pr -n eshop",
    "kubectl create secret generic eshopsecrets --from-literal=redisPassword=e$h0p0nD@pr -n eshop",
    "Once created, you can reference the secret in the component configuration file for state management:",
    "Once created, you can reference the secret in the component configuration file for state management:",
    "The secretKeyRef element specifies the name of the Kubernetes secret and the secret",
    "The secretKeyRef element specifies the name of the Kubernetes secret and the secret",
    "Auth is the default value when using Kubernetes secrets and can be omitted.",
    "Auth is the default value when using Kubernetes secrets and can be omitted.",
    "In a production setting, secrets are typically created as part of an automated CI/CD pipeline. Doing so ensures only people with sufficient permissions can access and change the secrets. Developers create configuration files without knowing the actual value of the secrets.",
    "In a production setting, secrets are typically created as part of an automated CI/CD pipeline. Doing so ensures only people with sufficient permissions can access and change the secrets. Developers create configuration files without knowing the actual value of the secrets.",
    "The next example is geared toward a real-world production scenario. It uses Azure Key Vault as the secret store. Azure Key Vault is a managed Azure service that enables secrets to be stored securely in the cloud.",
    "The next example is geared toward a real-world production scenario. It uses Azure Key Vault as the secret store. Azure Key Vault is a managed Azure service that enables secrets to be stored securely in the cloud.",
    "For this example to work, the following prerequisites must be satisfied:",
    "For this example to work, the following prerequisites must be satisfied:",
    "You",
    "You",
    "You",
    "You",
    "You",
    "You",
    "You",
    "You",
    "A service principal is an identity that can be used by an application to authenticate an Azure service. The service principal uses a X509 certificate. The application uses this certificate as a credential to authenticate itself.",
    "A service principal is an identity that can be used by an application to authenticate an Azure service. The service principal uses a X509 certificate. The application uses this certificate as a credential to authenticate itself.",
    "The Dapr Azure Key Vault secret store documentation provides step-by-step instructions to create and configure a Key Vault environment.",
    "The Dapr Azure Key Vault secret store documentation provides step-by-step instructions to create and configure a Key Vault environment.",
    "Using Azure Key Vault in Dapr self-hosted mode requires the following component configuration file:",
    "Using Azure Key Vault in Dapr self-hosted mode requires the following component configuration file:",
    "The secret store type is secretstores.azure.keyvault . The metadata element provides access to the Key Vault with the following properties:",
    "The secret store type is secretstores.azure.keyvault . The metadata element provides access to the Key Vault with the following properties:",
    "The vaultName contains the name of the Azure Key Vault.",
    "The vaultName contains the name of the Azure Key Vault.",
    "The spnTenantId contains the tenant ID of the service principal used to authenticate against the Key Vault.",
    "The spnTenantId contains the tenant ID of the service principal used to authenticate against the Key Vault.",
    "The spnClientId contains the app ID of the service principal used to authenticate against the Key Vault.",
    "The spnClientId contains the app ID of the service principal used to authenticate against the Key Vault.",
    "The spnCertificateFile contains the path to the certificate file for the service principal to authenticate against the Key Vault.",
    "The spnCertificateFile contains the path to the certificate file for the service principal to authenticate against the Key Vault.",
    "You can copy the service principal information from the Azure portal or Azure CLI .",
    "You can copy the service principal information from the Azure portal or Azure CLI .",
    "Now the application can retrieve the Redis password from the Azure Key Vault.",
    "Now the application can retrieve the Redis password from the Azure Key Vault.",
    "Consuming Azure Key Vault with Dapr and Kubernetes also requires a service principal to authenticate against the Azure Key Vault.",
    "Consuming Azure Key Vault with Dapr and Kubernetes also requires a service principal to authenticate against the Azure Key Vault.",
    "First, create a Kubernetes secret that contains a certificate file using the kubectl CLI tool:",
    "First, create a Kubernetes secret that contains a certificate file using the kubectl CLI tool:",
    "The command requires two command-line arguments:",
    "The command requires two command-line arguments:",
    "[",
    "[",
    "[",
    "[",
    "Once created, you can reference the Kubernetes secret in the secret store component configuration file:",
    "Once created, you can reference the Kubernetes secret in the secret store component configuration file:",
    "At this point, an application running in Kubernetes can retrieve the Redis password from the Azure Key Vault.",
    "At this point, an application running in Kubernetes can retrieve the Redis password from the Azure Key Vault.",
    "It",
    "It",
    "When running in Azure Kubernetes Service (AKS), it",
    "When running in Azure Kubernetes Service (AKS), it",
    "Secret scopes allow you to control which secrets your application can access. You configure scopes in a Dapr sidecar configuration file. The Dapr configuration documentation provides instructions for scoping secrets.",
    "Secret scopes allow you to control which secrets your application can access. You configure scopes in a Dapr sidecar configuration file. The Dapr configuration documentation provides instructions for scoping secrets.",
    "Here",
    "Here",
    "You specify scopes per secret store. In the above example, the secret store is named eshop-azurekvsecret-store . You configure access to secrets using the following properties:",
    "You specify scopes per secret store. In the above example, the secret store is named eshop-azurekvsecret-store . You configure access to secrets using the following properties:",
    "| Property       | Value               | Description                                                                                                                     |",
    "| Property       | Value               | Description                                                                                                                     |",
    "The allowedSecrets and deniedSecrets properties take precedence over the defaultAccess property. Imagine specifying defaultAccess: allowed and an allowedSecrets list. In this case, only the secrets in the allowedSecrets list would be accessible by the application.",
    "The allowedSecrets and deniedSecrets properties take precedence over the defaultAccess property. Imagine specifying defaultAccess: allowed and an allowedSecrets list. In this case, only the secrets in the allowedSecrets list would be accessible by the application.",
    "In Dapr Traffic Control sample app, the secrets management building block is used in several places. Secrets are retrieved from code and referenced by Dapr component configuration files. Figure 10-2 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr secrets management building block is used in flows marked with number 6 in the diagram:",
    "In Dapr Traffic Control sample app, the secrets management building block is used in several places. Secrets are retrieved from code and referenced by Dapr component configuration files. Figure 10-2 shows the conceptual architecture of the Dapr Traffic Control sample application. The Dapr secrets management building block is used in flows marked with number 6 in the diagram:",
    "TrafficControl",
    "TrafficControl",
    "Service",
    "Service",
    "FineCollection",
    "FineCollection",
    "Service",
    "Service",
    "VehicleRegistration",
    "VehicleRegistration",
    "Service",
    "Service",
    "2",
    "2",
    "dapr",
    "dapr",
    "Sidecar",
    "Sidecar",
    "5",
    "5",
    "Camera",
    "Camera",
    "Simulation",
    "Simulation",
    "Figure 10-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "Figure 10-2. Conceptual architecture of the Dapr Traffic Control sample application.",
    "The FineCollection service uses an SMTP output binding for sending emails (see the Bindings chapter). The email component file consumes the secrets management building block to retrieve credentials to connect to the SMTP server. To calculate the fine for a speeding violation, the service uses a fictitious FineCalculator component that requires a license key. It retrieves this license key from the secrets management building block.",
    "The FineCollection service uses an SMTP output binding for sending emails (see the Bindings chapter). The email component file consumes the secrets management building block to retrieve credentials to connect to the SMTP server. To calculate the fine for a speeding violation, the service uses a fictitious FineCalculator component that requires a license key. It retrieves this license key from the secrets management building block.",
    "The TrafficControl service stores vehicle information in a Redis state store (see the State management chapter). It uses the secrets management building block for retrieving credentials to connect to the Redis server.",
    "The TrafficControl service stores vehicle information in a Redis state store (see the State management chapter). It uses the secrets management building block for retrieving credentials to connect to the Redis server.",
    "Because the Traffic Control sample application can run in self-hosted mode or in Kubernetes, there are two ways for specifying secrets:",
    "Because the Traffic Control sample application can run in self-hosted mode or in Kubernetes, there are two ways for specifying secrets:",
    "A local JSON file",
    "A local JSON file",
    "A Kubernetes secret",
    "A Kubernetes secret",
    "2 - 3 -",
    "2 - 3 -",
    "EntryCam",
    "EntryCam",
    "5",
    "5",
    "5",
    "5",
    "Examine the secrets-file.yaml component configuration file in the dapr/components folder:",
    "Examine the secrets-file.yaml component configuration file in the dapr/components folder:",
    "The file describes a secrets management component entitled trafficcontrol-secrets . The type element is set to local.file and the secretsFile to ../dapr/components/secrets.json . For selfhosted mode, use a Local file component. The path must be relatively specified from the folder from which the service starts. The secrets file contains a JSON representation of the secrets:",
    "The file describes a secrets management component entitled trafficcontrol-secrets . The type element is set to local.file and the secretsFile to ../dapr/components/secrets.json . For selfhosted mode, use a Local file component. The path must be relatively specified from the folder from which the service starts. The secrets file contains a JSON representation of the secrets:",
    "In the sample application the Redis server is used without a password. To connect to the SMTP server, the credentials are ",
    "In the sample application the Redis server is used without a password. To connect to the SMTP server, the credentials are ",
    "While secrets are stored at nested levels, the secrets management building block flattens this hierarchy when the file is read. It uses a period as a level separator (as specified in the nestedSeparator field in the component configuration file). This construct enables you to reference secrets with a flattened name, for example: smtp.user .",
    "While secrets are stored at nested levels, the secrets management building block flattens this hierarchy when the file is read. It uses a period as a level separator (as specified in the nestedSeparator field in the component configuration file). This construct enables you to reference secrets with a flattened name, for example: smtp.user .",
    "When running in Kubernetes, the secrets are specified using the built-in Kubernetes secrets store. Examine the following secrets.yaml Kubernetes manifest file in the k8s folder:",
    "When running in Kubernetes, the secrets are specified using the built-in Kubernetes secrets store. Examine the following secrets.yaml Kubernetes manifest file in the k8s folder:",
    "The component is also named trafficcontrol-secrets . Secrets are stored as Base64 encoded strings.",
    "The component is also named trafficcontrol-secrets . Secrets are stored as Base64 encoded strings.",
    "Base64 representations encode , but do not encrypt data. Base64 isn",
    "Base64 representations encode , but do not encrypt data. Base64 isn",
    "The following paragraphs describe how secrets are used in the Traffic Control sample application.",
    "The following paragraphs describe how secrets are used in the Traffic Control sample application.",
    "Examine the email.yaml component configuration file located in the dapr/components folder:",
    "Examine the email.yaml component configuration file located in the dapr/components folder:",
    "The auth section references the secrets management component named trafficcontrol-secrets . The user and password entries in the binding metadata reference the secrets: smtp.user and smtp.password respectively.",
    "The auth section references the secrets management component named trafficcontrol-secrets . The user and password entries in the binding metadata reference the secrets: smtp.user and smtp.password respectively.",
    "When running in Kubernetes, the built-in Kubernetes secrets store is used. The email.yaml manifest file found in the k8s folder references the Kubernetes secret for retrieving the credentials for connecting to the smtp server:",
    "When running in Kubernetes, the built-in Kubernetes secrets store is used. The email.yaml manifest file found in the k8s folder references the Kubernetes secret for retrieving the credentials for connecting to the smtp server:",
    "Unlike the local secrets store, the Kubernetes store doesn",
    "Unlike the local secrets store, the Kubernetes store doesn",
    "Next, examine the statestore.yaml component configuration file in the dapr/components folder:",
    "Next, examine the statestore.yaml component configuration file in the dapr/components folder:",
    "Once again, the auth section references the secrets management component named trafficcontrol-secrets . The redisPassword entries in the binding metadata reference the secret state.redisPassword .",
    "Once again, the auth section references the secrets management component named trafficcontrol-secrets . The redisPassword entries in the binding metadata reference the secret state.redisPassword .",
    "The FineCollection service uses a component that calculates the fine based on the information of a speeding violation. This component is implemented as a domain service and is abstracted by the IFineCalculator interface:",
    "The FineCollection service uses a component that calculates the fine based on the information of a speeding violation. This component is implemented as a domain service and is abstracted by the IFineCalculator interface:",
    "The CalculateFine method expects a string containing a licenseKey as its first argument. This key unlocks the third-party component used by the implementation. To keep the example simple, the implementation hard-codes a series of if statements. You can find the implementation in the HardCodedFineCalculator class in the DomainsServices folder:",
    "The CalculateFine method expects a string containing a licenseKey as its first argument. This key unlocks the third-party component used by the implementation. To keep the example simple, the implementation hard-codes a series of if statements. You can find the implementation in the HardCodedFineCalculator class in the DomainsServices folder:",
    "The implementation simulates a check on the licenseKey that is passed in. The CollectionController of the FineCollection service must pass in the correct license key argument when calling the CalculateFine method. It retrieves the license key from the Dapr secrets management building block that is exposed by the Dapr client in the Dapr SDK for .NET. If you examine the constructor of the CollectionController , you can see the call:",
    "The implementation simulates a check on the licenseKey that is passed in. The CollectionController of the FineCollection service must pass in the correct license key argument when calling the CalculateFine method. It retrieves the license key from the Dapr secrets management building block that is exposed by the Dapr client in the Dapr SDK for .NET. If you examine the constructor of the CollectionController , you can see the call:",
    "The code determines whether the service is running in Kubernetes or self-hosted mode. This check is necessary because a different secrets management component must be used for each situation. The first argument of the GetSecretAsync method is the name of the Dapr component. The second argument is the name of the secret. The metadata passed in as the third argument specifies the namespace that contains the secret. The value of the finecalculator.licensekey secret is stored in a private field for later use.",
    "The code determines whether the service is running in Kubernetes or self-hosted mode. This check is necessary because a different secrets management component must be used for each situation. The first argument of the GetSecretAsync method is the name of the Dapr component. The second argument is the name of the secret. The metadata passed in as the third argument specifies the namespace that contains the secret. The value of the finecalculator.licensekey secret is stored in a private field for later use.",
    "Using Dapr secrets management offers several benefits:",
    "Using Dapr secrets management offers several benefits:",
    "No sensitive information is stored in code or application configuration files.",
    "No sensitive information is stored in code or application configuration files.",
    "No need to learn any new API for interacting with a secrets store.",
    "No need to learn any new API for interacting with a secrets store.",
    "The Dapr secrets management building block provides capabilities for storing and retrieving sensitive configuration settings like passwords and connection-strings. It keeps secrets private and prevents them from being accidentally disclosed.",
    "The Dapr secrets management building block provides capabilities for storing and retrieving sensitive configuration settings like passwords and connection-strings. It keeps secrets private and prevents them from being accidentally disclosed.",
    "The building block supports several different secret stores and hides their complexity with the Dapr secrets API.",
    "The building block supports several different secret stores and hides their complexity with the Dapr secrets API.",
    "The Dapr .NET SDK provides a DaprClient object to retrieve secrets. It also includes a .NET configuration provider that adds secrets to the .NET configuration system. Once loaded, you can consume these secrets in your .NET code.",
    "The Dapr .NET SDK provides a DaprClient object to retrieve secrets. It also includes a .NET configuration provider that adds secrets to the .NET configuration system. Once loaded, you can consume these secrets in your .NET code.",
    "You can use secret scopes to control access to specific secrets.",
    "You can use secret scopes to control access to specific secrets.",
    "Beyond the Twelve-Factor Application",
    "Beyond the Twelve-Factor Application",
    "Dapr supported secret stores",
    "Dapr supported secret stores",
    "Microsoft",
    "Microsoft",
    ".NET Microservices:",
    ".NET Microservices:",
    "Architecture for",
    "Architecture for",
    "Containerized NET",
    "Containerized NET",
    "Applications",
    "Applications",
    "Over the co urse of this book, you",
    "Over the co urse of this book, you",
    "But, first a little history.",
    "But, first a little history.",
    "Several years ago, Microsoft, in partnership with leading community experts, released a popular guidance book, entitled .NET Microservices for Containerized .NET Applications. Figure 12-1 shows the book:",
    "Several years ago, Microsoft, in partnership with leading community experts, released a popular guidance book, entitled .NET Microservices for Containerized .NET Applications. Figure 12-1 shows the book:",
    "Figure 12-1. .NET Microservices: Architecture for Containerized .NET Applications.",
    "Figure 12-1. .NET Microservices: Architecture for Containerized .NET Applications.",
    "The book dove deep into the principles, patterns, and best practices for building distributed applications. It included a full-featured microservice reference application that showcased the architectural concepts. Entitled, eShopOnContainers, the application hosts an e-Commerce storefront that sells various items, including clothing and coffee mugs. Built in .NET, the application is crossplatform and can run in either Linux or Windows containers. Figure 12-2 shows the original eShop architecture.",
    "The book dove deep into the principles, patterns, and best practices for building distributed applications. It included a full-featured microservice reference application that showcased the architectural concepts. Entitled, eShopOnContainers, the application hosts an e-Commerce storefront that sells various items, including clothing and coffee mugs. Built in .NET, the application is crossplatform and can run in either Linux or Windows containers. Figure 12-2 shows the original eShop architecture.",
    "Client apps eShop mobile app",
    "Client apps eShop mobile app",
    "Xamarin.Forms",
    "Xamarin.Forms",
    "C#",
    "C#",
    "xPlat. OS:",
    "xPlat. OS:",
    "iOS",
    "iOS",
    "Android",
    "Android",
    "Windows eShop traditional Web app",
    "Windows eShop traditional Web app",
    "K",
    "K",
    "eShop SPA Web app",
    "eShop SPA Web app",
    "TypeScript/Angular 2",
    "TypeScript/Angular 2",
    "Figure 12-2. Original ShopOnContainers reference application.",
    "Figure 12-2. Original ShopOnContainers reference application.",
    "As you can see, eShopOnContainers includes many moving parts:",
    "As you can see, eShopOnContainers includes many moving parts:",
    "Three different frontend clients.",
    "Three different frontend clients.",
    "An application gateway to abstract backend services from the frontend.",
    "An application gateway to abstract backend services from the frontend.",
    "Several backend core microservices.",
    "Several backend core microservices.",
    "An event bus component that enables asynchronous pub/sub messaging.",
    "An event bus component that enables asynchronous pub/sub messaging.",
    "The eShopOnContainers reference application has been widely accepted across the .NET community and used to model many large commercial microservice applications.",
    "The eShopOnContainers reference application has been widely accepted across the .NET community and used to model many large commercial microservice applications.",
    "An updated version of eShop accompanies this book. It",
    "An updated version of eShop accompanies this book. It",
    "[",
    "[",
    "Figure 12-3. eShopOnDapr reference application architecture.",
    "Figure 12-3. eShopOnDapr reference application architecture.",
    "While eShopOnDapr focuses on Dapr, the architecture has also been streamlined and simplified.",
    "While eShopOnDapr focuses on Dapr, the architecture has also been streamlined and simplified.",
    "A Single Page Application running on Blazor WebAssembly sends user requests to an API gateway.",
    "A Single Page Application running on Blazor WebAssembly sends user requests to an API gateway.",
    "The API gateway abstracts the backend core microservices from the frontend client. It",
    "The API gateway abstracts the backend core microservices from the frontend client. It",
    "eShopOnContainers reference application",
    "eShopOnContainers reference application",
    "(Development environment architecture)",
    "(Development environment architecture)",
    "\u2022 Docker Host",
    "\u2022 Docker Host",
    "Identity microservice (STS+users)",
    "Identity microservice (STS+users)",
    "SQL Server database",
    "SQL Server database",
    "API Gateways/BFF Catalog microservice SQL Server",
    "API Gateways/BFF Catalog microservice SQL Server",
    "Blazor",
    "Blazor",
    "Frontend",
    "Frontend",
    "Actors",
    "Actors",
    "Secrets",
    "Secrets",
    "5",
    "5",
    "dapr",
    "dapr",
    "3",
    "3",
    "Basket",
    "Basket",
    "4",
    "4",
    "3",
    "3",
    "4",
    "4",
    "requests to backend microservices. Most requests are simple CRUD operations (for example, get the list of brands from the catalog) and handled by a direct call to a backend microservice.",
    "requests to backend microservices. Most requests are simple CRUD operations (for example, get the list of brands from the catalog) and handled by a direct call to a backend microservice.",
    "(Envoy)",
    "(Envoy)",
    "5",
    "5",
    "aggregator",
    "aggregator",
    "5",
    "5",
    "Other requests are more logically complex and require multiple microservice calls to work together. For these cases, eShopOnDapr implements an aggregator microservice that orchestrates a workflow across those microservices needed to complete the operation.",
    "Other requests are more logically complex and require multiple microservice calls to work together. For these cases, eShopOnDapr implements an aggregator microservice that orchestrates a workflow across those microservices needed to complete the operation.",
    "3",
    "3",
    "The core backend microservices implement the required functionality for an e-Commerce store. Each is self-contained and independent of the others. Following widely accepted domain decomposition patterns, each microservice isolates a specific business capability : 5",
    "The core backend microservices implement the required functionality for an e-Commerce store. Each is self-contained and independent of the others. Following widely accepted domain decomposition patterns, each microservice isolates a specific business capability : 5",
    "-The basket service manages the customer",
    "-The basket service manages the customer",
    "-The catalog service manages product items available for sale.",
    "-The catalog service manages product items available for sale.",
    "-The identity service manages authentication and identity.",
    "-The identity service manages authentication and identity.",
    "-The ordering service handles all aspects of placing and managing orders.",
    "-The ordering service handles all aspects of placing and managing orders.",
    "-The payment service transacts the customer",
    "-The payment service transacts the customer",
    "Adhering to best practices, each microservice maintains its own persistent storage. The application doesn",
    "Adhering to best practices, each microservice maintains its own persistent storage. The application doesn",
    "Finally, the event bus wraps the Dapr publish/subscribe components. It enables asynchronous publish/subscribe messaging across microservices. Developers can plug in any Dapr-supported message broker component.",
    "Finally, the event bus wraps the Dapr publish/subscribe components. It enables asynchronous publish/subscribe messaging across microservices. Developers can plug in any Dapr-supported message broker component.",
    "In eShopOnDapr, Dapr building blocks replace a large amount of complex, error-prone plumbing code.",
    "In eShopOnDapr, Dapr building blocks replace a large amount of complex, error-prone plumbing code.",
    "Figure 12-4 shows the Dapr integration in the application.",
    "Figure 12-4 shows the Dapr integration in the application.",
    "Figure 12-4. Dapr integration in eShopOnDapr.",
    "Figure 12-4. Dapr integration in eShopOnDapr.",
    "The above figure shows the Dapr building blocks (represented as green numbered boxes) that each eShopOnDapr service consumes.",
    "The above figure shows the Dapr building blocks (represented as green numbered boxes) that each eShopOnDapr service consumes.",
    "The API gateway and web shopping aggregator services use the service invocation building block to invoke methods on the backend services.",
    "The API gateway and web shopping aggregator services use the service invocation building block to invoke methods on the backend services.",
    "The backend services communicate asynchronously using the publish ",
    "The backend services communicate asynchronously using the publish ",
    "The basket service uses the state management building block to store the state of the customer",
    "The basket service uses the state management building block to store the state of the customer",
    "The original eShopOnContainers demonstrates DDD concepts and patterns in the ordering service. eShopOnDapr uses the actor building block as an alternative implementation. The turnbased access model of actors makes it easy to implement a stateful ordering process with support for cancellation.",
    "The original eShopOnContainers demonstrates DDD concepts and patterns in the ordering service. eShopOnDapr uses the actor building block as an alternative implementation. The turnbased access model of actors makes it easy to implement a stateful ordering process with support for cancellation.",
    "The ordering service sends order confirmation e-mails using the bindings building block.",
    "The ordering service sends order confirmation e-mails using the bindings building block.",
    "Secret management is done by the secrets building block.",
    "Secret management is done by the secrets building block.",
    "The following sections provide more detail on how the Dapr building blocks are applied in eShopOnDapr.",
    "The following sections provide more detail on how the Dapr building blocks are applied in eShopOnDapr.",
    "In eShopOnDapr, the Basket service uses the state management building block to persist the contents of the customer",
    "In eShopOnDapr, the Basket service uses the state management building block to persist the contents of the customer",
    "This code uses the third party StackExchange.Redis NuGet package. The following steps are required to load the shopping basket for a given customer:",
    "This code uses the third party StackExchange.Redis NuGet package. The following steps are required to load the shopping basket for a given customer:",
    "Inject a Redis ConnectionMultiplexer into the constructor. The ConnectionMultiplexer is registered with the dependency injection framework in the Program.cs file:",
    "Inject a Redis ConnectionMultiplexer into the constructor. The ConnectionMultiplexer is registered with the dependency injection framework in the Program.cs file:",
    "Use the ConnectionMultiplexer to create an IDatabase instance in each consuming class.",
    "Use the ConnectionMultiplexer to create an IDatabase instance in each consuming class.",
    "Use the IDatabase instance to execute a Redis StringGet call using the given customerId as the key.",
    "Use the IDatabase instance to execute a Redis StringGet call using the given customerId as the key.",
    "Check if data is loaded from Redis; if not, return null .",
    "Check if data is loaded from Redis; if not, return null .",
    "Deserialize the data from Redis to a CustomerBasket object and return the result.",
    "Deserialize the data from Redis to a CustomerBasket object and return the result.",
    "In the updated eShopOnDapr reference application, a new DaprBasketRepository class replaces the RedisBasketRepository class:",
    "In the updated eShopOnDapr reference application, a new DaprBasketRepository class replaces the RedisBasketRepository class:",
    "The updated code uses the Dapr .NET SDK to read and write data using the state management building block. The new steps to load the basket for a customer are dramatically simplified:",
    "The updated code uses the Dapr .NET SDK to read and write data using the state management building block. The new steps to load the basket for a customer are dramatically simplified:",
    "Inject a DaprClient into the constructor. The DaprClient is registered with the dependency injection framework in the Program.cs ",
    "Inject a DaprClient into the constructor. The DaprClient is registered with the dependency injection framework in the Program.cs ",
    "Use the DaprClient.GetStateAsync method to load the customer",
    "Use the DaprClient.GetStateAsync method to load the customer",
    "The updated implementation still uses Redis as the underlying data store. But, note how Dapr abstracts the StackExchange.Redis references and complexity from the application. The application no longer requires a direct dependency on Redis. A Dapr configuration file is all that",
    "The updated implementation still uses Redis as the underlying data store. But, note how Dapr abstracts the StackExchange.Redis references and complexity from the application. The application no longer requires a direct dependency on Redis. A Dapr configuration file is all that",
    "http",
    "http",
    "Basket",
    "Basket",
    "The Dapr implementation also simplifies changing the underlying data store. Switching to Azure Table Storage, for example, requires only changing the contents of the configuration file. No code changes are necessary.",
    "The Dapr implementation also simplifies changing the underlying data store. Switching to Azure Table Storage, for example, requires only changing the contents of the configuration file. No code changes are necessary.",
    "The original eShopOnContainers used a mix of HTTP/REST and gRPC services. The use of gRPC was limited to communication between an aggregator service and core backend services. Figure 12-5 shows the original architecture:",
    "The original eShopOnContainers used a mix of HTTP/REST and gRPC services. The use of gRPC was limited to communication between an aggregator service and core backend services. Figure 12-5 shows the original architecture:",
    "Figure 12-5. gRPC and HTTP/REST calls in eShopOnContainers.",
    "Figure 12-5. gRPC and HTTP/REST calls in eShopOnContainers.",
    "Note the steps from the previous figure:",
    "Note the steps from the previous figure:",
    "The frontend calls the API gateway using HTTP/REST.",
    "The frontend calls the API gateway using HTTP/REST.",
    "API Gateway",
    "API Gateway",
    "(Envoy)",
    "(Envoy)",
    "http",
    "http",
    "Frontend grpo",
    "Frontend grpo",
    "dapr",
    "dapr",
    "Sidecar",
    "Sidecar",
    "The API gateway forwards simple CRUD (Create, Read, Update, Delete) requests directly to a core backend service using HTTP/REST. Sidecar Sidecar catalog",
    "The API gateway forwards simple CRUD (Create, Read, Update, Delete) requests directly to a core backend service using HTTP/REST. Sidecar Sidecar catalog",
    "The API gateway forwards complex requests that involve coordinated backend service calls to the web shopping aggregator service. Sidecar - http \u2192",
    "The API gateway forwards complex requests that involve coordinated backend service calls to the web shopping aggregator service. Sidecar - http \u2192",
    "The aggregator service uses gRPC to call core backend services.",
    "The aggregator service uses gRPC to call core backend services.",
    "In the updated eShopOnDapr implementation, Dapr sidecars are added to the services and API gateway. Figure 12-6 show the updated architecture:",
    "In the updated eShopOnDapr implementation, Dapr sidecars are added to the services and API gateway. Figure 12-6 show the updated architecture:",
    "Figure 12-6. Updated eShop architecture using Dapr.",
    "Figure 12-6. Updated eShop architecture using Dapr.",
    "Note the updated steps from the previous figure:",
    "Note the updated steps from the previous figure:",
    "The frontend still uses HTTP/REST to call the API gateway.",
    "The frontend still uses HTTP/REST to call the API gateway.",
    "The API gateway forwards HTTP requests to its Dapr sidecar.",
    "The API gateway forwards HTTP requests to its Dapr sidecar.",
    "The API gateway sidecar sends the request to the sidecar of the aggregator or backend service.",
    "The API gateway sidecar sends the request to the sidecar of the aggregator or backend service.",
    "The aggregator service uses the Dapr .NET SDK to call backend services through their sidecar architecture.",
    "The aggregator service uses the Dapr .NET SDK to call backend services through their sidecar architecture.",
    "Dapr implements calls between sidecars with gRPC. So even if you",
    "Dapr implements calls between sidecars with gRPC. So even if you",
    "The eShopOnDapr reference application benefits from the Dapr service invocation building block. The benefits also include service discovery, automatic mTLS, and built-in observability.",
    "The eShopOnDapr reference application benefits from the Dapr service invocation building block. The benefits also include service discovery, automatic mTLS, and built-in observability.",
    "Both the original and updated eShop application leverage the Envoy proxy as an API gateway. Envoy is an open-source proxy and communication bus that is popular across modern distributed applications. Originating from Lyft, Envoy is owned and maintained by the Cloud-Native Computing Foundation.",
    "Both the original and updated eShop application leverage the Envoy proxy as an API gateway. Envoy is an open-source proxy and communication bus that is popular across modern distributed applications. Originating from Lyft, Envoy is owned and maintained by the Cloud-Native Computing Foundation.",
    "http\u2192",
    "http\u2192",
    "Basket",
    "Basket",
    "In the original eShopOnContainers implementation, the Envoy API gateway forwarded incoming HTTP requests directly to aggregator or backend services. In the new eShopOnDapr, the Envoy proxy forwards the request to a Dapr sidecar.",
    "In the original eShopOnContainers implementation, the Envoy API gateway forwarded incoming HTTP requests directly to aggregator or backend services. In the new eShopOnDapr, the Envoy proxy forwards the request to a Dapr sidecar.",
    "Envoy is configured using a YAML definition file to control the proxy",
    "Envoy is configured using a YAML definition file to control the proxy",
    "The Envoy route configuration is updated to rewrite incoming requests as calls to the Dapr sidecar (pay close attention to the prefix",
    "The Envoy route configuration is updated to rewrite incoming requests as calls to the Dapr sidecar (pay close attention to the prefix",
    "Consider a scenario where the frontend client wants to retrieve a list of catalog items. The Catalog API provides an endpoint for getting the catalog items:",
    "Consider a scenario where the frontend client wants to retrieve a list of catalog items. The Catalog API provides an endpoint for getting the catalog items:",
    "First, the frontend makes a direct HTTP call to the Envoy API gateway.",
    "First, the frontend makes a direct HTTP call to the Envoy API gateway.",
    "The Envoy proxy matches the route, rewrites the HTTP request, and forwards it to the invoke API of its Dapr sidecar:",
    "The Envoy proxy matches the route, rewrites the HTTP request, and forwards it to the invoke API of its Dapr sidecar:",
    "Frontend update basket",
    "Frontend update basket",
    "API gateway",
    "API gateway",
    "Web shopping update basket",
    "Web shopping update basket",
    "The sidecar handles service discovery and routes the request to the Catalog API sidecar. Finally, the sidecar calls the Catalog API to execute the request, fetch catalog items, and return a response:",
    "The sidecar handles service discovery and routes the request to the Catalog API sidecar. Finally, the sidecar calls the Catalog API to execute the request, fetch catalog items, and return a response:",
    "GET http://localhost/api/v1/catalog/items save basket",
    "GET http://localhost/api/v1/catalog/items save basket",
    "Most calls from the eShop frontend are simple CRUD calls. The API gateway forwards them to a single service for processing. Some scenarios, however, require multiple backend services to work together to complete a request. For the more complex calls, the web shopping aggregator service mediates the cross service workflow. Figure 12-7 show the processing sequence of adding an item to your shopping basket:",
    "Most calls from the eShop frontend are simple CRUD calls. The API gateway forwards them to a single service for processing. Some scenarios, however, require multiple backend services to work together to complete a request. For the more complex calls, the web shopping aggregator service mediates the cross service workflow. Figure 12-7 show the processing sequence of adding an item to your shopping basket:",
    "Figure 12-7. Backend call requiring multiple services.",
    "Figure 12-7. Backend call requiring multiple services.",
    "The aggregator service first retrieves catalog items from the Catalog API. It then validates item availability and pricing. Finally, the aggregator service updates the shopping basket by calling the Basket API.",
    "The aggregator service first retrieves catalog items from the Catalog API. It then validates item availability and pricing. Finally, the aggregator service updates the shopping basket by calling the Basket API.",
    "The aggregator service contains a BasketController that provides an endpoint for updating the shopping basket:",
    "The aggregator service contains a BasketController that provides an endpoint for updating the shopping basket:",
    "aggregator",
    "aggregator",
    "Catalog API",
    "Catalog API",
    "Basket API",
    "Basket API",
    "The UpdateAllBasketAsync method gets the Authorization header of the incoming request using a FromHeader attribute. The Authorization header contains the access token that is needed to call protected backend services.",
    "The UpdateAllBasketAsync method gets the Authorization header of the incoming request using a FromHeader attribute. The Authorization header contains the access token that is needed to call protected backend services.",
    "After receiving a request to update the basket, the aggregator service calls the Catalog API to get the item details. The Basket controller uses an injected ICatalogService object to make that call and communicate with the Catalog API. The original implementation of the interface used gRPC to make the call. The updated implementation uses Dapr service invocation with HttpClient support:",
    "After receiving a request to update the basket, the aggregator service calls the Catalog API to get the item details. The Basket controller uses an injected ICatalogService object to make that call and communicate with the Catalog API. The original implementation of the interface used gRPC to make the call. The updated implementation uses Dapr service invocation with HttpClient support:",
    "Notice how no Dapr-specific code is required to make the service invocation call. All communication is done using the standard HttpClient object.",
    "Notice how no Dapr-specific code is required to make the service invocation call. All communication is done using the standard HttpClient object.",
    "The Dapr HttpClient is configured for the CatalogService class on program startup:",
    "The Dapr HttpClient is configured for the CatalogService class on program startup:",
    "The other call made by the aggregator service is to the Basket API. It only allows authorized requests. The access token is passed along in an Authorization request header to ensure the call succeeds:",
    "The other call made by the aggregator service is to the Basket API. It only allows authorized requests. The access token is passed along in an Authorization request header to ensure the call succeeds:",
    "In this example too, only standard HttpClient functionality is used to call the service. This allows developers who are already familiar with HttpClient to reuse their existing skills. It even enables existing HttpClient code to use Dapr service invocation without making any changes.",
    "In this example too, only standard HttpClient functionality is used to call the service. This allows developers who are already familiar with HttpClient to reuse their existing skills. It even enables existing HttpClient code to use Dapr service invocation without making any changes.",
    "Both eShopOnContainers and eShopOnDapr use the pub/sub pattern for communicating integration events across microservices. Integration events include:",
    "Both eShopOnContainers and eShopOnDapr use the pub/sub pattern for communicating integration events across microservices. Integration events include:",
    "When a user checks-out a shopping basket.",
    "When a user checks-out a shopping basket.",
    "When a payment for an order has succeeded.",
    "When a payment for an order has succeeded.",
    "When the grace-period of a purchase has expired.",
    "When the grace-period of a purchase has expired.",
    "Note Think of an Integration Event as an event that takes place across multiple services.",
    "Note Think of an Integration Event as an event that takes place across multiple services.",
    "Eventing in eShopOnContainers is based on the following IEventBus interface:",
    "Eventing in eShopOnContainers is based on the following IEventBus interface:",
    "Concrete implementations of this interface for both RabbitMQ and Azure Service Bus are found in eShopOnContainers. Each implementation included a large amount of custom plumbing code that was complex to understand and difficult to maintain.",
    "Concrete implementations of this interface for both RabbitMQ and Azure Service Bus are found in eShopOnContainers. Each implementation included a large amount of custom plumbing code that was complex to understand and difficult to maintain.",
    "The newer eShopOnDapr significantly simplifies pub/sub behavior by using Dapr. To start, the IEventBus interface was reduced to a single method:",
    "The newer eShopOnDapr significantly simplifies pub/sub behavior by using Dapr. To start, the IEventBus interface was reduced to a single method:",
    "In eShopOnDapr, a single DaprEventBus implementation can support any Dapr-supported message broker. The following code block shows the simplified Publish method. Note how the PublishAsync method uses the Dapr client to publish an event:",
    "In eShopOnDapr, a single DaprEventBus implementation can support any Dapr-supported message broker. The following code block shows the simplified Publish method. Note how the PublishAsync method uses the Dapr client to publish an event:",
    "As you can see in the code snippet, the topic name is derived from event type",
    "As you can see in the code snippet, the topic name is derived from event type",
    "The Dapr SDK uses System.Text.Json to serialize/deserialize messages. However, System.Text.Json doesn",
    "The Dapr SDK uses System.Text.Json to serialize/deserialize messages. However, System.Text.Json doesn",
    "With Dapr, pub/sub infrastructure code is dramatically simplified . The application doesn",
    "With Dapr, pub/sub infrastructure code is dramatically simplified . The application doesn",
    "The earlier eShopOnContainers app contains SubscriptionManagers to handle the subscription implementation for each message broker. Each manager contains complex message broker-specific code for handling subscription events. To receive events, each service has to explicitly register a handler for each event-type.",
    "The earlier eShopOnContainers app contains SubscriptionManagers to handle the subscription implementation for each message broker. Each manager contains complex message broker-specific code for handling subscription events. To receive events, each service has to explicitly register a handler for each event-type.",
    "eShopOnDapr streamlines the plumbing for event subscriptions by using Dapr ASP.NET Core integration. Each event is handled by an action method in a controller. A Topic attribute decorates the action method with the name of the corresponding topic. Here",
    "eShopOnDapr streamlines the plumbing for event subscriptions by using Dapr ASP.NET Core integration. Each event is handled by an action method in a controller. A Topic attribute decorates the action method with the name of the corresponding topic. Here",
    "In the Topic attribute, the name of the .NET type of the event is used as the topic name. For handling the event, an event handler that already existed in the earlier eShopOnContainers code base is resolved using dependency injection and invoked. In the previous example, messages received from the OrderStatusChangedToValidatedIntegrationEvent topic invoke the existing OrderStatusChangedToValidatedIntegrationEventHandler event handler. Because Dapr implements the underlying plumbing for subscriptions and message brokers, a large amount of original code became obsolete and was removed from the code-base. Much of this code was complex to understand and challenging to maintain.",
    "In the Topic attribute, the name of the .NET type of the event is used as the topic name. For handling the event, an event handler that already existed in the earlier eShopOnContainers code base is resolved using dependency injection and invoked. In the previous example, messages received from the OrderStatusChangedToValidatedIntegrationEvent topic invoke the existing OrderStatusChangedToValidatedIntegrationEventHandler event handler. Because Dapr implements the underlying plumbing for subscriptions and message brokers, a large amount of original code became obsolete and was removed from the code-base. Much of this code was complex to understand and challenging to maintain.",
    "Within the eShopOnDapr repository, a deployment folder contains files for deploying the application using different deployment modes: Docker Compose and Kubernetes . A dapr folder exists within each of these folders that holds a components folder. This folder holds a file eshop-pubsub.yaml . It specifies the Dapr pub/sub component that the application will use for pub/sub behavior. As you saw in the earlier code snippets, the name of the pub/sub component used is pubsub . Here",
    "Within the eShopOnDapr repository, a deployment folder contains files for deploying the application using different deployment modes: Docker Compose and Kubernetes . A dapr folder exists within each of these folders that holds a components folder. This folder holds a file eshop-pubsub.yaml . It specifies the Dapr pub/sub component that the application will use for pub/sub behavior. As you saw in the earlier code snippets, the name of the pub/sub component used is pubsub . Here",
    "The configuration specifies RabbitMQ as the underlying infrastructure. To change message brokers, you need only to configure a different message broker, such as NATS or Azure Service Bus and update the yaml file. With Dapr, there are no changes to your mainline service code when switching message brokers.",
    "The configuration specifies RabbitMQ as the underlying infrastructure. To change message brokers, you need only to configure a different message broker, such as NATS or Azure Service Bus and update the yaml file. With Dapr, there are no changes to your mainline service code when switching message brokers.",
    "You can also easily use multiple message brokers in a single application. Many times a system will handle workloads with different characteristics. One event may occur 10 times a day, but another event occurs 5,000 times per second. You may benefit by partitioning messaging traffic to different message brokers. With Dapr, you can add multiple pub/sub component configurations, each with a different name.",
    "You can also easily use multiple message brokers in a single application. Many times a system will handle workloads with different characteristics. One event may occur 10 times a day, but another event occurs 5,000 times per second. You may benefit by partitioning messaging traffic to different message brokers. With Dapr, you can add multiple pub/sub component configurations, each with a different name.",
    "eShopOnDapr uses the bindings building block for sending e-mails. When a user places an order, the application sends an order confirmation e-mail using the SMTP output binding. You can find this binding in the eshop-email.yaml file in the components folder:",
    "eShopOnDapr uses the bindings building block for sending e-mails. When a user places an order, the application sends an order confirmation e-mail using the SMTP output binding. You can find this binding in the eshop-email.yaml file in the components folder:",
    "Dapr gets the username and password for connecting to the SMTP server from a secret reference. This approach keeps secrets outside of the configuration file. To learn more about Dapr secrets, read the secrets building block chapter.",
    "Dapr gets the username and password for connecting to the SMTP server from a secret reference. This approach keeps secrets outside of the configuration file. To learn more about Dapr secrets, read the secrets building block chapter.",
    "The binding configuration specifies a binding component that can be invoked using the /sendmail endpoint on the Dapr sidecar. Here",
    "The binding configuration specifies a binding component that can be invoked using the /sendmail endpoint on the Dapr sidecar. Here",
    "As you can see in this example, message contains the message body. The CreateEmailBody method simply formats a string with the body text. The name of the binding to invoke is sendmail and the operation is create . The metadata specifies the email sender, recipient, and subject for the email message. If these values are static, they can also be included in the metadata fields in the configuration file.",
    "As you can see in this example, message contains the message body. The CreateEmailBody method simply formats a string with the body text. The name of the binding to invoke is sendmail and the operation is create . The metadata specifies the email sender, recipient, and subject for the email message. If these values are static, they can also be included in the metadata fields in the configuration file.",
    "In the original eShopOnContainers solution, the Ordering service provides a great example of how to use DDD design patterns in a .NET microservice. As the updated eShopOnDapr focuses on Dapr, the Ordering service now uses the actors building block to implement its business logic.",
    "In the original eShopOnContainers solution, the Ordering service provides a great example of how to use DDD design patterns in a .NET microservice. As the updated eShopOnDapr focuses on Dapr, the Ordering service now uses the actors building block to implement its business logic.",
    "The ordering process consists of the following steps:",
    "The ordering process consists of the following steps:",
    "The customer submits the order. There",
    "The customer submits the order. There",
    "The system checks that there",
    "The system checks that there",
    "The system processes the payment.",
    "The system processes the payment.",
    "The system ships the order.",
    "The system ships the order.",
    "The process is implemented using a single OrderingProcessActor actor type. Here",
    "The process is implemented using a single OrderingProcessActor actor type. Here",
    "The process is started when a customer checks out some products. Upon checkout, the Basket service publishes a UserCheckoutAcceptedIntegrationEvent message using the Dapr pub/sub building block. The Ordering service handles the message in the OrderingProcessEventController class and calls the SubmitAsync method of the actor:",
    "The process is started when a customer checks out some products. Upon checkout, the Basket service publishes a UserCheckoutAcceptedIntegrationEvent message using the Dapr pub/sub building block. The Ordering service handles the message in the OrderingProcessEventController class and calls the SubmitAsync method of the actor:",
    "In the example above, the Ordering service first uses the original request ID from the UserCheckoutAcceptedIntegrationEvent message as the actor ID. The handler uses the ActorId to create an actor proxy and invokes the SubmitAsync method. The following snippet shows the implementation of the SubmitAsync method:",
    "In the example above, the Ordering service first uses the original request ID from the UserCheckoutAcceptedIntegrationEvent message as the actor ID. The handler uses the ActorId to create an actor proxy and invokes the SubmitAsync method. The following snippet shows the implementation of the SubmitAsync method:",
    "There",
    "There",
    "The method takes the given arguments to create an OrderState object and saves it in the actor state.",
    "The method takes the given arguments to create an OrderState object and saves it in the actor state.",
    "The method saves the current status of the process ( OrderStatus.Submitted ) in the actor state.",
    "The method saves the current status of the process ( OrderStatus.Submitted ) in the actor state.",
    "The method registers a reminder to signal the end of the grace period. Order processing is delayed until the end of the grace period to deal with customers changing their mind.",
    "The method registers a reminder to signal the end of the grace period. Order processing is delayed until the end of the grace period to deal with customers changing their mind.",
    "Lastly, the method publishes an OrderStatusChangedToSubmittedIntegrationEvent to notify other services of the status change.",
    "Lastly, the method publishes an OrderStatusChangedToSubmittedIntegrationEvent to notify other services of the status change.",
    "When the reminder for the grace period ending fires, the actor runtime calls the ReceiveReminderAsync method:",
    "When the reminder for the grace period ending fires, the actor runtime calls the ReceiveReminderAsync method:",
    "As shown in the snippet above, the ReceiveReminderAsync method handles not just the grace period reminder. The actor also uses reminders to simulate background work and introduce some delays in the ordering process. This makes the process easier to follow in the eShopOnDapr UI where notifications are shown for each status update. The ReceiveReminderAsync method uses the reminder name to determine which method handles the reminder. The grace period reminder is handled by the OnGracePeriodElapsedAsync method:",
    "As shown in the snippet above, the ReceiveReminderAsync method handles not just the grace period reminder. The actor also uses reminders to simulate background work and introduce some delays in the ordering process. This makes the process easier to follow in the eShopOnDapr UI where notifications are shown for each status update. The ReceiveReminderAsync method uses the reminder name to determine which method handles the reminder. The grace period reminder is handled by the OnGracePeriodElapsedAsync method:",
    "The OnGracePeriodElapsedAsync method first tries to update the order status to the new AwaitingStockValidation status. If that succeeds, it retrieves the order details from state and publishes an OrderStatusChangedToAwaitingStockValidationIntegrationEvent to inform other service of the status change. For example, the Category service subscribes to this event to check the available stock.",
    "The OnGracePeriodElapsedAsync method first tries to update the order status to the new AwaitingStockValidation status. If that succeeds, it retrieves the order details from state and publishes an OrderStatusChangedToAwaitingStockValidationIntegrationEvent to inform other service of the status change. For example, the Category service subscribes to this event to check the available stock.",
    "Let",
    "Let",
    "First, the TryUpdateOrderStatusAsync method checks whether there even is a current order status. If there isn",
    "First, the TryUpdateOrderStatusAsync method checks whether there even is a current order status. If there isn",
    "The other steps in the ordering process are all implemented in a very similar way to the grace period step. In the next sections, we",
    "The other steps in the ordering process are all implemented in a very similar way to the grace period step. In the next sections, we",
    "Customers are allowed to cancel any order that has not been paid or shipped yet. The OrdersController class handles incoming order cancellations. It invokes the CancelAsync method on the OrderingProcessActor instance for the given order.",
    "Customers are allowed to cancel any order that has not been paid or shipped yet. The OrdersController class handles incoming order cancellations. It invokes the CancelAsync method on the OrderingProcessActor instance for the given order.",
    "The CancelAsync method consists of the following steps:",
    "The CancelAsync method consists of the following steps:",
    "First, the method ensures that the order exists by retrieving the current order status.",
    "First, the method ensures that the order exists by retrieving the current order status.",
    "If the order exists, the method checks wheth er it",
    "If the order exists, the method checks wheth er it",
    "If the order can be cancelled, the order status is changed to Cancelled .",
    "If the order can be cancelled, the order status is changed to Cancelled .",
    "Lastly, the order details are retrieved from state and used to publish an OrderStatusChangedToCancelledIntegrationEvent to inform the other services.",
    "Lastly, the order details are retrieved from state and used to publish an OrderStatusChangedToCancelledIntegrationEvent to inform the other services.",
    "The CancelAsync method is a great example of the usefulness of the turn-based access model of actors. Nowhere in the method do we need to worry about multiple threads running at the same time. Therefore, the method does not require any explicit locking mechanisms to be correct.",
    "The CancelAsync method is a great example of the usefulness of the turn-based access model of actors. Nowhere in the method do we need to worry about multiple threads running at the same time. Therefore, the method does not require any explicit locking mechanisms to be correct.",
    "Customers can check the status and details of their order in the eShopOnDapr UI. They can also view a complete history of past orders. Directly querying actor instances for this information is a bad idea because of two reasons:",
    "Customers can check the status and details of their order in the eShopOnDapr UI. They can also view a complete history of past orders. Directly querying actor instances for this information is a bad idea because of two reasons:",
    "Low-latency reads cannot be guaranteed because actor operations execute serially.",
    "Low-latency reads cannot be guaranteed because actor operations execute serially.",
    "Querying across actors is inefficient because each actor",
    "Querying across actors is inefficient because each actor",
    "To fix this issue, eShopOnDapr uses a separate read model for any queries on order data. The read model is stored in a separate SQL database. An ASP.NET Core controller class named UpdateOrderStatusEventController subscribes to the order status events and builds up the view model. The same UpdateOrderStatusEventController class also sends push notifications to the UI to inform the customer of order status updates.",
    "To fix this issue, eShopOnDapr uses a separate read model for any queries on order data. The read model is stored in a separate SQL database. An ASP.NET Core controller class named UpdateOrderStatusEventController subscribes to the order status events and builds up the view model. The same UpdateOrderStatusEventController class also sends push notifications to the UI to inform the customer of order status updates.",
    "The following snippet shows the code for handling the OrderStatusChangedToSubmittedIntegrationEvent message:",
    "The following snippet shows the code for handling the OrderStatusChangedToSubmittedIntegrationEvent message:",
    "The handler contains the code for all the actions that must occur after an order is submitted successfully. Because the events originate from the OrderingProcessActor , we can be sure that any validations performed by the actor have succeeded.",
    "The handler contains the code for all the actions that must occur after an order is submitted successfully. Because the events originate from the OrderingProcessActor , we can be sure that any validations performed by the actor have succeeded.",
    "The handler performs the following steps:",
    "The handler performs the following steps:",
    "First, the method creates an actor proxy and uses it to retrieve the order details from the actor instance.",
    "First, the method creates an actor proxy and uses it to retrieve the order details from the actor instance.",
    "The method maps the order details to the read model and stores it in the database. Due to the at-least-once semantics of the Dapr pub/sub building block, the order may already exist in the database. In that case, it will not be overwritten.",
    "The method maps the order details to the read model and stores it in the database. Due to the at-least-once semantics of the Dapr pub/sub building block, the order may already exist in the database. In that case, it will not be overwritten.",
    "The method publishes a push notification for the status update using SignalR.",
    "The method publishes a push notification for the status update using SignalR.",
    "Lastly, if enabled, the method sends a confirmation e-mail to the customer.",
    "Lastly, if enabled, the method sends a confirmation e-mail to the customer.",
    "Subsequent order status updates are all handled equally to each other. The following snippet shows what happens when the order status is updated to AwaitingStockValidation :",
    "Subsequent order status updates are all handled equally to each other. The following snippet shows what happens when the order status is updated to AwaitingStockValidation :",
    "In the snippet, the handler calls the UpdateReadModelAndSendNotificationAsync helper method to handle the status update:",
    "In the snippet, the handler calls the UpdateReadModelAndSendNotificationAsync helper method to handle the status update:",
    "The helper method first loads the current order from the database.",
    "The helper method first loads the current order from the database.",
    "If that succeeds, it updates the OrderStatus and Description fields and saves the updated model back to the database.",
    "If that succeeds, it updates the OrderStatus and Description fields and saves the updated model back to the database.",
    "Lastly, it sends a push notification to notify the client UI.",
    "Lastly, it sends a push notification to notify the client UI.",
    "eShopOnDapr uses Zipkin to visualize distributed traces collected by Dapr. Seq aggregates the eShopOnDapr application logs. The various services emit structured logging using the SeriLog logging library. Serilog publishes log events to a construct called a sink . A sink is simply a target platform to which Serilog writes its logging events. Many Serilog sinks are available, including one for Seq. Seq is the Serilog sink used in eShopOnDapr.",
    "eShopOnDapr uses Zipkin to visualize distributed traces collected by Dapr. Seq aggregates the eShopOnDapr application logs. The various services emit structured logging using the SeriLog logging library. Serilog publishes log events to a construct called a sink . A sink is simply a target platform to which Serilog writes its logging events. Many Serilog sinks are available, including one for Seq. Seq is the Serilog sink used in eShopOnDapr.",
    "eShopOnDapr also includes a custom health dashboard that gives insight into the health of the eShop services. This dashboard uses the built-in health checks mechanism of ASP.NET Core. The dashboard not only provides the health status of the services, but also the health of the dependencies of the services, including the Dapr sidecars.",
    "eShopOnDapr also includes a custom health dashboard that gives insight into the health of the eShop services. This dashboard uses the built-in health checks mechanism of ASP.NET Core. The dashboard not only provides the health status of the services, but also the health of the dependencies of the services, including the Dapr sidecars.",
    "The eShopOnDapr reference application uses the secrets building block for various secrets:",
    "The eShopOnDapr reference application uses the secrets building block for various secrets:",
    "The password for connecting to the Redis cache.",
    "The password for connecting to the Redis cache.",
    "The username and password for the SMTP server.",
    "The username and password for the SMTP server.",
    "The connection strings for the SQL databases.",
    "The connection strings for the SQL databases.",
    "When running the application using Docker Compose, the local file secret store is used. The component configuration file eshop-secretstore.yaml is found in the dapr/components folder of the eShopOnDapr repository:",
    "When running the application using Docker Compose, the local file secret store is used. The component configuration file eshop-secretstore.yaml is found in the dapr/components folder of the eShopOnDapr repository:",
    "The configuration file references the local store file eshop-secretstore.json located in the same folder:",
    "The configuration file references the local store file eshop-secretstore.json located in the same folder:",
    "The components folder is specified in the command-line and mounted as a local folder inside the Dapr sidecar container. Here",
    "The components folder is specified in the command-line and mounted as a local folder inside the Dapr sidecar container. Here",
    "The /components volume mount and --components-path command-line argument are passed into the daprd startup command.",
    "The /components volume mount and --components-path command-line argument are passed into the daprd startup command.",
    "Once configured, other component configuration files can also reference the secrets. Here",
    "Once configured, other component configuration files can also reference the secrets. Here",
    "In general, the use of Dapr building blocks adds observability and flexibility to the application:",
    "In general, the use of Dapr building blocks adds observability and flexibility to the application:",
    "Observability: By using the Dapr building blocks, you gain rich distributed tracing for calls between services and to Dapr components without having to write any code. In eShopOnContainers, a large amount of custom logging is used to provide insight.",
    "Observability: By using the Dapr building blocks, you gain rich distributed tracing for calls between services and to Dapr components without having to write any code. In eShopOnContainers, a large amount of custom logging is used to provide insight.",
    "Flexibility: You can now swap out infrastructure simply by changing a component configuration file. No code changes are necessary.",
    "Flexibility: You can now swap out infrastructure simply by changing a component configuration file. No code changes are necessary.",
    "Here are some more examples of benefits offered by specific building blocks:",
    "Here are some more examples of benefits offered by specific building blocks:",
    "-With Dapr",
    "-With Dapr",
    "-When transient errors occur, service calls are automatically retried.",
    "-When transient errors occur, service calls are automatically retried.",
    "-Automatic service discovery reduces the amount of configuration needed for services to find each other.",
    "-Automatic service discovery reduces the amount of configuration needed for services to find each other.",
    "Publish/Subscribe",
    "Publish/Subscribe",
    "-eShopOnContainers included a large amount of custom code to support both Azure Service Bus and RabbitMQ. Developers used Azure Service Bus for production and RabbitMQ for local development and testing. An IEventBus abstraction layer was created to enable swapping between these message brokers. This layer consisted of approximately 700 lines of error-prone code . The updated implementation with Dapr requires only 35 lines of code . That",
    "-eShopOnContainers included a large amount of custom code to support both Azure Service Bus and RabbitMQ. Developers used Azure Service Bus for production and RabbitMQ for local development and testing. An IEventBus abstraction layer was created to enable swapping between these message brokers. This layer consisted of approximately 700 lines of error-prone code . The updated implementation with Dapr requires only 35 lines of code . That",
    "-eShopOnDapr uses Dapr",
    "-eShopOnDapr uses Dapr",
    "-Messages routed to the service as HTTP calls enable the use of ASP.NET Core middleware to add functionality, without introducing new concepts or SDKs to learn.",
    "-Messages routed to the service as HTTP calls enable the use of ASP.NET Core middleware to add functionality, without introducing new concepts or SDKs to learn.",
    "Bindings",
    "Bindings",
    "-The eShopOnContainers solution contained a to-do item for e-mailing an order confirmation to the customer. With Dapr, implementing email notification was as easy as configuring a resource binding.",
    "-The eShopOnContainers solution contained a to-do item for e-mailing an order confirmation to the customer. With Dapr, implementing email notification was as easy as configuring a resource binding.",
    "Actors",
    "Actors",
    "-The actors building block makes it easy to create long running, stateful workflows. Thanks to the turnbased access model, there",
    "-The actors building block makes it easy to create long running, stateful workflows. Thanks to the turnbased access model, there",
    "-The complexity of the grace period implementation is greatly reduced by using actor reminders instead of polling on the database.",
    "-The complexity of the grace period implementation is greatly reduced by using actor reminders instead of polling on the database.",
    "In this chapter, you",
    "In this chapter, you",
    "eShopOnDapr",
    "eShopOnDapr",
    "eShopOnContainers",
    "eShopOnContainers",
    ".NET Microservices for Containerized .NET Applications",
    ".NET Microservices for Containerized .NET Applications",
    "Architecting Cloud-Native .NET Apps for Azure",
    "Architecting Cloud-Native .NET Apps for Azure",
    "We",
    "We",
    "As the plane taxis to the gate, let",
    "As the plane taxis to the gate, let",
    "Dapr - Dapr is a Distributed Application Runtime that streamlines how you build distributed applications. It exposes an architecture of building blocks and pluggable components. Dapr provides a dynamic glue that binds your application with infrastructure capabilities that exist in the Dapr runtime. Instead of building infrastructure plumbing, you and your team focus on delivering business features to customers.",
    "Dapr - Dapr is a Distributed Application Runtime that streamlines how you build distributed applications. It exposes an architecture of building blocks and pluggable components. Dapr provides a dynamic glue that binds your application with infrastructure capabilities that exist in the Dapr runtime. Instead of building infrastructure plumbing, you and your team focus on delivering business features to customers.",
    "Open source and cross-platform - The native Dapr API can be consumed by any platform that supports HTTP or gRPC. Dapr also provides language-specific SDKs for popular development platforms. Dapr v1.0 supports Go, Python, .NET, Java, PHP, and JavaScript.",
    "Open source and cross-platform - The native Dapr API can be consumed by any platform that supports HTTP or gRPC. Dapr also provides language-specific SDKs for popular development platforms. Dapr v1.0 supports Go, Python, .NET, Java, PHP, and JavaScript.",
    "Building blocks - Dapr building blocks encapsulate distributed application functionality. At the time of this writing, Dapr supports the seven building blocks shown in figure 13-1.",
    "Building blocks - Dapr building blocks encapsulate distributed application functionality. At the time of this writing, Dapr supports the seven building blocks shown in figure 13-1.",
    "State management",
    "State management",
    "Publish ",
    "Publish ",
    "subscribe",
    "subscribe",
    "Bindings",
    "Bindings",
    "Extensibility",
    "Extensibility",
    "Figure 13-1. Dapr building blocks.",
    "Figure 13-1. Dapr building blocks.",
    "Components - Dapr components provide the concrete implementation for each Dapr building block capability. They expose a common interface that enables developers to swap out component implementations without changing application code. Figure 13-2 shows the relationship among components, building blocks, and your service.",
    "Components - Dapr components provide the concrete implementation for each Dapr building block capability. They expose a common interface that enables developers to swap out component implementations without changing application code. Figure 13-2 shows the relationship among components, building blocks, and your service.",
    "Service invocation",
    "Service invocation",
    "Dapr API",
    "Dapr API",
    "Sidecar",
    "Sidecar",
    "Dapr API",
    "Dapr API",
    "dapr dapr",
    "dapr dapr",
    "Component",
    "Component",
    "(Redis Cache)",
    "(Redis Cache)",
    "Component",
    "Component",
    "(Redis Cache)",
    "(Redis Cache)",
    "HTTP /",
    "HTTP /",
    "gRPC",
    "gRPC",
    "Your",
    "Your",
    "Primary service service",
    "Primary service service",
    "Figure 13-2. Dapr building block integration.",
    "Figure 13-2. Dapr building block integration.",
    "Sidecars - Dapr runs alongside your application in a sidecar architecture, either as a separate process of a container. Your application communicates with the Dapr APIs over HTTP and gRPC. Sidecars provide isolation and encapsulation as they aren",
    "Sidecars - Dapr runs alongside your application in a sidecar architecture, either as a separate process of a container. Your application communicates with the Dapr APIs over HTTP and gRPC. Sidecars provide isolation and encapsulation as they aren",
    "Figure 13-3. Sidecar architecture.",
    "Figure 13-3. Sidecar architecture.",
    "Hosting environments Dapr has cross-platform support and can run in multiple environments. At the time of this writing, the environments include a local self-hosted mode and Kubernetes.",
    "Hosting environments Dapr has cross-platform support and can run in multiple environments. At the time of this writing, the environments include a local self-hosted mode and Kubernetes.",
    "eShopOnDapr - This book includes an accompanying reference application entitled eShopOnDapr. Using a popular e-commerce application domain, the reference application demonstrates the usage of each build ing block. It",
    "eShopOnDapr - This book includes an accompanying reference application entitled eShopOnDapr. Using a popular e-commerce application domain, the reference application demonstrates the usage of each build ing block. It",
    "Looking forward, Dapr has the potential to have a profound impact on distributed application development. What can you expect from the Dapr team and its open-source contributors?",
    "Looking forward, Dapr has the potential to have a profound impact on distributed application development. What can you expect from the Dapr team and its open-source contributors?",
    "At the time of writing, the list of proposed enhancements for Dapr include:",
    "At the time of writing, the list of proposed enhancements for Dapr include:",
    "Feature enhancements to existing building blocks:",
    "Feature enhancements to existing building blocks:",
    "-Query capabilities in state management enabling you to retrieve multiple values.",
    "-Query capabilities in state management enabling you to retrieve multiple values.",
    "-Topic filtering in pub/sub enabling you to filter topics based on their content.",
    "-Topic filtering in pub/sub enabling you to filter topics based on their content.",
    "-An application tracing API in observability that provides tracing in the application directly without having to bind to specific libraries.",
    "-An application tracing API in observability that provides tracing in the application directly without having to bind to specific libraries.",
    "-Binding and pub/sub support for actors providing event driven capabilities to the actor programming model. Bound components will trigger events and messages invoke methods in the actor.",
    "-Binding and pub/sub support for actors providing event driven capabilities to the actor programming model. Bound components will trigger events and messages invoke methods in the actor.",
    "New building blocks:",
    "New building blocks:",
    "-Configuration API building block for reading and writing configuration data. The block will bind to providers that include Azure Configuration Manager or GCP Configuration Management.",
    "-Configuration API building block for reading and writing configuration data. The block will bind to providers that include Azure Configuration Manager or GCP Configuration Management.",
    "-Http scale-to-zero autoscale.",
    "-Http scale-to-zero autoscale.",
    "-Leader election building block to provide singleton instances and locking semantic capabilities.",
    "-Leader election building block to provide singleton instances and locking semantic capabilities.",
    "-Transparent proxying building block for service invocation, enabling you to route messages based on URLs or DNS addresses at the network level.",
    "-Transparent proxying building block for service invocation, enabling you to route messages based on URLs or DNS addresses at the network level.",
    "-Resiliency building block (circuit breakers, bulkheads ",
    "-Resiliency building block (circuit breakers, bulkheads ",
    "Integration with frameworks and cloud native technologies. Some examples include:",
    "Integration with frameworks and cloud native technologies. Some examples include:",
    "-Django",
    "-Django",
    "-Nodejs",
    "-Nodejs",
    "-Express",
    "-Express",
    "-Kyma",
    "-Kyma",
    "-Midway",
    "-Midway",
    "New language SDKs:",
    "New language SDKs:",
    "-JavaScript",
    "-JavaScript",
    "-RUST",
    "-RUST",
    "-C++",
    "-C++",
    "New hosting platforms:",
    "New hosting platforms:",
    "-VMs",
    "-VMs",
    "-Azure IoT Edge",
    "-Azure IoT Edge",
    "-Azure Stack Edge",
    "-Azure Stack Edge",
    "-Azure Service Fabric",
    "-Azure Service Fabric",
    "Developer and operator productivity tooling:",
    "Developer and operator productivity tooling:",
    "-VS Code extension.",
    "-VS Code extension.",
    "-Remote Dev Containers for local debugging a DevOps pipeline development.",
    "-Remote Dev Containers for local debugging a DevOps pipeline development.",
    "-Dapr operational dashboard enhancements that will provide deeper visibility into the operational concerns of managing Dapr applications.",
    "-Dapr operational dashboard enhancements that will provide deeper visibility into the operational concerns of managing Dapr applications.",
    "Dapr version 1.0 provides developers with a compelling toolbox for building distributed applications. As the proposed enhancement list shows, Dapr is under active development with many new capabilities to come. Stay tuned to the Dapr site and Dapr announcement blog for future updates.",
    "Dapr version 1.0 provides developers with a compelling toolbox for building distributed applications. As the proposed enhancement list shows, Dapr is under active development with many new capabilities to come. Stay tuned to the Dapr site and Dapr announcement blog for future updates."
]