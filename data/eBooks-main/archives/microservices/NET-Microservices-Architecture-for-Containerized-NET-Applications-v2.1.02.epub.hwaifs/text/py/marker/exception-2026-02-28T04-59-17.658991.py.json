Exception reading tables from EPUB document source = ../../../../../../../data/eBooks-main/archives/microservices/NET-Microservices-Architecture-for-Containerized-NET-Applications-v2.1.02.epub : index 8192 is out of bounds: 2, range 0 to 4756Traceback (most recent call last):
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/api_text_extraction_marker_PdfConverter.py", line 31, in extract_text_to_file_from_epub_document
    rendered = converter(source)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/marker/converters/pdf.py", line 195, in __call__
    document = self.build_document(temp_path)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/marker/converters/pdf.py", line 182, in build_document
    document = DocumentBuilder(self.config)(
        provider, layout_builder, line_builder, ocr_builder
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/marker/builders/document.py", line 33, in __call__
    layout_builder(document, provider)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/marker/builders/layout.py", line 56, in __call__
    layout_results = self.surya_layout(document.pages)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/marker/builders/layout.py", line 88, in surya_layout
    layout_results = self.layout_model(
        [p.get_image(highres=False) for p in pages],
        batch_size=int(self.get_batch_size()),
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/surya/layout/__init__.py", line 51, in __call__
    self.foundation_predictor.prediction_loop(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        images=images,
        ^^^^^^^^^^^^^^
    ...<7 lines>...
        tqdm_desc="Recognizing Layout"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/surya/foundation/__init__.py", line 780, in prediction_loop
    updated_inputs, outputs, merge_idxs = self.prefill(
                                          ~~~~~~~~~~~~^
        current_inputs, max_lookahead_tokens=0
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/surya/foundation/__init__.py", line 565, in prefill
    outputs = self.model(
        input_ids=input_ids,
    ...<13 lines>...
        logits_to_keep=1,
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/surya/common/surya/__init__.py", line 440, in forward
    inputs_embeds = self.embed_ids_boxes_images(
        input_ids, image_embeddings, encoder_chunk_size, valid_batch_size, input_boxes, embed_boxes
    )
  File "/Users/Shared/Projects/d/Samples-Playgrounds/gh/Python/samples/ds-ml-ai--data-science-machine-learning-artificial-intelligence/11-etl-extract-transform-load/extractions/text-from-documents/epub/marker/.venv/lib/python3.14/site-packages/surya/common/surya/__init__.py", line 311, in embed_ids_boxes_images
    if inputs_embeds[special_image_mask].numel() != image_embeddings.numel():
       ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
torch.AcceleratorError: index 8192 is out of bounds: 2, range 0 to 4756
