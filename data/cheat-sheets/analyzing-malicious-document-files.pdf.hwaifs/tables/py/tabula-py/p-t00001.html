<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ANALYZING MALICIOUS DOCUMENTS oledump.py</th>
      <th>List all OLE2 streams present</th>
      <th>Unnamed: 0</th>
      <th>/XObject can embed an image for phishing.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>in file.xls. This cheat sheet outlines tips and tools for analyzing file.xls -i</td>
      <td></td>
      <td></td>
      <td>Be mindful of obfuscation with hex codes, such as</td>
    </tr>
    <tr>
      <th>1</th>
      <td>malicious documents, such as Microsoft Office, RTF, oledump.py</td>
      <td>Extract VBA source code</td>
      <td></td>
      <td>/JavaScript vs. /J#61vaScript. (See examples.)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>and PDF files. file.xls -s 3 -v</td>
      <td>from stream 3 in file.xls.</td>
      <td></td>
      <td>Useful PDF File Analysis Commands</td>
    </tr>
    <tr>
      <th>3</th>
      <td>General Approach to Document Analysis xmldump.py pretty</td>
      <td>Format XML file supplied via</td>
      <td></td>
      <td>pdfid.py&nbsp;&nbsp;Display risky keywords present in</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>STDIN for easier analysis.</td>
      <td></td>
      <td>file.pdf -n file file.pdf.</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1. Examine the document for anomalies, such as</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>risky tags, scripts, and embedded artifacts. oledump.py file.xls -p</td>
      <td>Find obfuscated URLs</td>
      <td></td>
      <td>pdf-parser.py Show stats about keywords. Add</td>
    </tr>
    <tr>
      <th>7</th>
      <td>plugin_http_heuristics</td>
      <td>in file.xls macros.</td>
      <td></td>
      <td>file.pdf -a “-O” to include object streams.</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2. Locate embedded code, such as shellcode,</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>macros, JavaScript, or other suspicious objects. vmonkey</td>
      <td>Emulate the execution of macros</td>
      <td></td>
      <td>pdf-parser.py Display contents of object id. Add</td>
    </tr>
    <tr>
      <th>10</th>
      <td>file.doc</td>
      <td>in file.doc to analyze them.</td>
      <td></td>
      <td>file.pdf -o id “-d” to dump object’s stream.</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3. Extract suspicious code or objects from the file.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>evilclippy -uu</td>
      <td>Remove the password prompt</td>
      <td></td>
      <td>pdf-parser.py Display objects that</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4. If relevant, deobfuscate and examine macros, file.ppt</td>
      <td>from macros in file.ppt.</td>
      <td></td>
      <td>file.pdf -r id reference object id.</td>
    </tr>
    <tr>
      <th>14</th>
      <td>JavaScript, or other embedded code.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td>msoffcrypto-tool</td>
      <td>Decrypt outfile.docm using</td>
      <td></td>
      <td>qpdf --password=pass Decrypt infile.pdf using</td>
    </tr>
    <tr>
      <th>16</th>
      <td>5. If relevant, emulate, disassemble and/or debug</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>17</th>
      <td>infile.docm</td>
      <td>specified password to create</td>
      <td></td>
      <td>--decrypt infile.pdf password pass to create</td>
    </tr>
    <tr>
      <th>18</th>
      <td>shellcode that you extracted from the document. outfile.docm -p</td>
      <td>outfile.docm.</td>
      <td></td>
      <td>outfile.pdf outfile.pdf.</td>
    </tr>
    <tr>
      <th>19</th>
      <td>6. Understand the next steps in the infection chain.&nbsp;&nbsp;pcodedmp</td>
      <td>Disassemble VBA-stomped</td>
      <td></td>
      <td>Shellcode and Other Analysis Commands</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Microsoft Office Format Notes file.doc</td>
      <td>p-code macro from file.doc.</td>
      <td></td>
      <td>xorsearch -W&nbsp;&nbsp;Locate shellcode patterns inside</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Binary Microsoft Office document files (.doc, .xls, pcode2code</td>
      <td>Decompile VBA-stomped</td>
      <td></td>
      <td>-d 3 file.bin the binary file file.bin.</td>
    </tr>
    <tr>
      <th>22</th>
      <td>etc.) use the OLE2 (a.k.a. Structured Storage) format. file.doc</td>
      <td>p-code macro from file.doc.</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>23</th>
      <td></td>
      <td></td>
      <td></td>
      <td>scdbgc /f Emulate execution of shellcode in</td>
    </tr>
    <tr>
      <th>24</th>
      <td>SRP streams in OLE2 documents sometimes store a rtfobj.py</td>
      <td>Extract objects embedded</td>
      <td></td>
      <td>file.bin file.bin. Use “/off” to specify offset.</td>
    </tr>
    <tr>
      <th>25</th>
      <td>cached version of earlier VBA macro code. file.rtf</td>
      <td>into RTF file.rtf.</td>
      <td></td>
      <td>runsc32 -f Execute shellcode in file.bin to</td>
    </tr>
    <tr>
      <th>26</th>
      <td>OOXML document files (.docx, .xlsm, etc.) supported rtfdump.py</td>
      <td>List groups and structure of</td>
      <td></td>
      <td>file.bin -n observe behavior in an isolated lab.</td>
    </tr>
    <tr>
      <th>27</th>
      <td>file.rtf by Microsoft Office are compressed zip archives.</td>
      <td>RTF file file.rtf.</td>
      <td></td>
      <td>base64dump.py List Base64-encoded strings</td>
    </tr>
    <tr>
      <th>28</th>
      <td>VBA macros in OOXML documents are stored inside rtfdump.py</td>
      <td>Examine objects in RTF file</td>
      <td></td>
      <td>file.txt present in file file.txt.</td>
    </tr>
    <tr>
      <th>29</th>
      <td>file.rtf -O</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>30</th>
      <td>an OLE2 binary file, which is within the zip archive.</td>
      <td>file.rtf.</td>
      <td></td>
      <td>numbers-to- Convert numbers that represent</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Excel supports XLM macros that are embedded as rtfdump.py file.rtf</td>
      <td>Extract hex contents from</td>
      <td></td>
      <td>string.py file characters in file to a string.</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-s 5 -H -d</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>33</th>
      <td>formulas in sheets without the OLE2 binary file.</td>
      <td>group in RTF file file.rtf.</td>
      <td></td>
      <td>Additional Document Analysis Tools</td>
    </tr>
    <tr>
      <th>34</th>
      <td>RTF documents don’t support macros but can contain xlmdeobfuscator</td>
      <td>Deobfuscate XLM (Excel 4)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>35</th>
      <td>--file file.xlsm malicious embedded files and objects.</td>
      <td>macros in file.xlsm.</td>
      <td></td>
      <td>SpiderMonkey, cscript, and box-js help deobfuscate JavaScript that you extract from document files.</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Useful MS Office File Analysis Commands Risky PDF Keywords</td>
      <td></td>
      <td></td>
      <td>Use the debugger built into Microsoft Office to</td>
    </tr>
    <tr>
      <th>37</th>
      <td>zipdump.py Examine contents of OOXML /OpenAction and /AA specify the script or action to</td>
      <td></td>
      <td></td>
      <td>deobfuscate macros in an isolated lab.</td>
    </tr>
    <tr>
      <th>38</th>
      <td>file.pptx file file.pptx. run automatically.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>39</th>
      <td></td>
      <td></td>
      <td></td>
      <td>Use AMSIScriptContentRetrieval.ps1 to observe</td>
    </tr>
    <tr>
      <th>40</th>
      <td>zipdump.py Extract file with index 3 from /JavaScript, /JS, /AcroForm, and /XFA can specify</td>
      <td></td>
      <td></td>
      <td>Microsoft Office execute macros in an isolated lab.</td>
    </tr>
    <tr>
      <th>41</th>
      <td>file.pptx -s 3 -d file.pptx to STDOUT. JavaScript to run.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>42</th>
      <td></td>
      <td></td>
      <td></td>
      <td>Some automated analysis sandboxes can analyze</td>
    </tr>
    <tr>
      <th>43</th>
      <td>olevba file.xlsm Locate and extract macros /URI accesses a URL, perhaps for phishing.</td>
      <td></td>
      <td></td>
      <td>aspects of malicious document files.</td>
    </tr>
    <tr>
      <th>44</th>
      <td>from file.xlsm. /SubmitForm and /GoToR can send data to URL.</td>
      <td></td>
      <td></td>
      <td>REMnux distro includes many of the free document</td>
    </tr>
  </tbody>
</table>